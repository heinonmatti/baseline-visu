<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title>Baseline analysis supplement</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; background-color: #f8f8f8; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
pre, code { background-color: #f8f8f8; }
code > span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code > span.dt { color: #204a87; } /* DataType */
code > span.dv { color: #0000cf; } /* DecVal */
code > span.bn { color: #0000cf; } /* BaseN */
code > span.fl { color: #0000cf; } /* Float */
code > span.ch { color: #4e9a06; } /* Char */
code > span.st { color: #4e9a06; } /* String */
code > span.co { color: #8f5902; font-style: italic; } /* Comment */
code > span.ot { color: #8f5902; } /* Other */
code > span.al { color: #ef2929; } /* Alert */
code > span.fu { color: #000000; } /* Function */
code > span.er { color: #a40000; font-weight: bold; } /* Error */
code > span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #000000; } /* Constant */
code > span.sc { color: #000000; } /* SpecialChar */
code > span.vs { color: #4e9a06; } /* VerbatimString */
code > span.ss { color: #4e9a06; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #000000; } /* Variable */
code > span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code > span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code > span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code > span.ex { } /* Extension */
code > span.at { color: #c4a000; } /* Attribute */
code > span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code > span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
div.sourceCode {
  overflow-x: visible;
}
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>


</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 66px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 71px;
  margin-top: -71px;
}

.section h2 {
  padding-top: 71px;
  margin-top: -71px;
}
.section h3 {
  padding-top: 71px;
  margin-top: -71px;
}
.section h4 {
  padding-top: 71px;
  margin-top: -71px;
}
.section h5 {
  padding-top: 71px;
  margin-top: -71px;
}
.section h6 {
  padding-top: 71px;
  margin-top: -71px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>




<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
  padding-left: 25px;
  text-indent: 0;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>

<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Visualising baseline characteristics</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">About</a>
</li>
<li>
  <a href="manuscript/baseline-manuscript.pdf">Manuscript</a>
</li>
<li>
  <a href="baseline-supplement.html">Descriptives</a>
</li>
<li>
  <a href="baseline-networks.html">Networks</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">

<div class="btn-group pull-right">
<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Baseline analysis supplement</h1>

</div>


<p>Welcome to the LMI baseline supplement! This supplement will walk you through the paper and provides additional graphs.</p>
<p>Measures used in the study</p>
<p>Clicking the “Code”-buttons on the right shows code for each chunk.</p>
<p>To start data analysis, we set up the basics to enable compiling the document:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">source</span>(<span class="st">&quot;baseline-datasetup.R&quot;</span>)</code></pre></div>
<div id="estimating-means-with-cis-taking-clustering-into-account" class="section level1">
<h1>Estimating means with CIs taking clustering into account</h1>
<p>The code chunks create linear models for all variables. The results are used to estimate confidence intervals and intra-class correlations (ICC).</p>
<p>Browse throught the tabs above to see different information.</p>
<p>Code chunk below shows how the values are calculated.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Create a vector with all names of the variables we want. Exclude T3 variables.</span>
names &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>id, <span class="op">-</span>intervention, <span class="op">-</span>group, <span class="op">-</span>school, <span class="op">-</span>girl, <span class="op">-</span>track, <span class="op">-</span>trackSchool, <span class="op">-</span><span class="kw">contains</span>(<span class="st">&quot;_T3&quot;</span>), <span class="op">-</span><span class="kw">contains</span>(<span class="st">&quot;_diff&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">names</span>(.)

<span class="co"># Create empty soon-to-be-filled objects</span>
m &lt;-<span class="st"> </span><span class="ot">NA</span>
mean &lt;-<span class="st"> </span><span class="ot">NA</span>
m_p &lt;-<span class="st"> </span><span class="ot">NA</span>
ci_low &lt;-<span class="st"> </span><span class="ot">NA</span>
ci_high &lt;-<span class="st"> </span><span class="ot">NA</span>
ICC_group &lt;-<span class="st"> </span><span class="ot">NA</span>
ICC_School &lt;-<span class="st"> </span><span class="ot">NA</span>
nonmissings &lt;-<span class="st"> </span><span class="ot">NA</span>

## Use this to test a single variable:
<span class="co"># dftest &lt;- df #%&gt;% na.omit()</span>
<span class="co"># m &lt;- lme4::lmer(sitLieAccelerometer_diff ~ (1|school) + (1|group), data=dftest)</span>
<span class="co"># mean &lt;- lme4::fixef(m)</span>
<span class="co"># m_p &lt;- profile(m, which = &quot;beta_&quot;)</span>
<span class="co"># ci_low &lt;- confint(m_p)[, 1]</span>
<span class="co"># ci_high &lt;- confint(m_p)[, 2]</span>
<span class="co"># ICC_group &lt;- icc(m)[1]</span>
<span class="co"># ICC_School &lt;- icc(m)[2]</span>
<span class="co"># nonmissings &lt;- length(m@resp$y)</span>


<span class="co"># Loop over each variable name, extract statistics: </span>

<span class="co"># all participants</span>
<span class="co"># for (i in names){</span>
<span class="co"># m &lt;- lme4::lmer(paste0(i,&quot; ~ (1|school) + (1|group)&quot;), data=df)</span>
<span class="co"># mean[i] &lt;- lme4::fixef(m)</span>
<span class="co"># m_p &lt;- profile(m, which = &quot;beta_&quot;)</span>
<span class="co"># ci_low[i] &lt;- confint(m_p)[, 1]</span>
<span class="co"># ci_high[i] &lt;- confint(m_p)[, 2]</span>
<span class="co"># ICC_group[i] &lt;- sjstats::icc(m)[1]</span>
<span class="co"># ICC_School[i] &lt;- sjstats::icc(m)[2]</span>
<span class="co"># nonmissings[i] &lt;- length(m@resp$y)</span>
<span class="co"># }</span>
<span class="co">#</span>
<span class="co">#</span>
<span class="co"># vardatatable &lt;- data_frame(</span>
<span class="co">#   Variable = stringr::str_sub(names(mean), end = -4), #remove &quot;_T1&quot; from names</span>
<span class="co">#   &quot;Mean&quot; = round(mean, 1),</span>
<span class="co">#   &quot;CI95&quot; = paste(round(ci_low, 1), &quot; - &quot;, round(ci_high, 2)),</span>
<span class="co">#   &quot;ICC class&quot; =ifelse(round(ICC_group, 3) == 0, &quot;&lt; 0.001&quot;, round(ICC_group, 3)),</span>
<span class="co">#   &quot;ICC school&quot; = ifelse(round(ICC_School, 3) == 0, &quot;&lt; 0.001&quot;, round(ICC_School, 3)),</span>
<span class="co">#   n = nonmissings) %&gt;%</span>
<span class="co">#   dplyr::arrange(Variable) %&gt;%</span>
<span class="co">#   dplyr::filter(Variable != &quot;&quot;) %&gt;% #remove first row, which is empty</span>
<span class="co">#   dplyr::mutate(`ICC class` = as.numeric(`ICC class`)) %&gt;%</span>
<span class="co">#   as.data.frame()</span>
<span class="co">#</span>
<span class="co"># ci_total &lt;- data_frame(</span>
<span class="co">#   &quot;ciLo&quot; = ci_low,</span>
<span class="co">#   &quot;mean&quot; = mean,</span>
<span class="co">#   &quot;ciHi&quot; = ci_high,</span>
<span class="co">#   &quot;diamondlabels&quot; = names(mean)) %&gt;%</span>
<span class="co">#   dplyr::filter(diamondlabels != &quot;&quot;) %&gt;% #remove first row, which is empty</span>
<span class="co">#   as.data.frame()</span>

<span class="co"># save(vardatatable, file = &quot;vardatatable.Rdata&quot;)</span>
<span class="co"># save(ci_total, file = &quot;ci_total.Rdata&quot;)</span>
<span class="kw">load</span>(<span class="st">&quot;vardatatable.Rdata&quot;</span>)
<span class="kw">load</span>(<span class="st">&quot;ci_total.Rdata&quot;</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">options</span>(<span class="dt">tibble.print_max =</span> <span class="dv">1000</span>)

vardatatable2 &lt;-<span class="st"> </span>vardatatable
vardatatable2<span class="op">$</span>Variable &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&quot;paAccelerometer&quot;</span>, <span class="st">&quot;MVPA minutes (accelerometer)&quot;</span>, vardatatable2<span class="op">$</span>Variable)
vardatatable2<span class="op">$</span>Variable &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&quot;padaysLastweek&quot;</span>, <span class="st">&quot;Number of MVPA days last week (self-report)&quot;</span>, vardatatable2<span class="op">$</span>Variable)
vardatatable2<span class="op">$</span>Variable &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&quot;sitLieAccelerometer&quot;</span>, <span class="st">&quot;Minutes spent sitting or lying down (accelerometer)&quot;</span>, vardatatable2<span class="op">$</span>Variable)
vardatatable2<span class="op">$</span>Variable &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&quot;sitBreaks&quot;</span>, <span class="st">&quot;Number of times sitting was interrupted (accelerometer)&quot;</span>, vardatatable2<span class="op">$</span>Variable)

vardatatable2 <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(Variable <span class="op">==</span><span class="st"> &quot;MVPA minutes (accelerometer)&quot;</span> <span class="op">|</span><span class="st"> </span>
<span class="st">           </span>Variable <span class="op">==</span><span class="st"> &quot;Number of MVPA days last week (self-report)&quot;</span> <span class="op">|</span><span class="st"> </span>
<span class="st">           </span>Variable <span class="op">==</span><span class="st"> &quot;Minutes spent sitting or lying down (accelerometer)&quot;</span> <span class="op">|</span><span class="st"> </span>
<span class="st">           </span>Variable <span class="op">==</span><span class="st"> &quot;Number of times sitting was interrupted (accelerometer)&quot;</span> ) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span>papaja<span class="op">::</span><span class="kw">apa_table</span>(
        <span class="dt">caption =</span> <span class="st">&quot;Primary outcome variables with their class and school ICCs&quot;</span>,
        <span class="dt">escape =</span> T,
        <span class="dt">format.args =</span> <span class="kw">list</span>(<span class="dt">digits =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">0</span>), <span class="dt">margin =</span> <span class="dv">2</span>))</code></pre></div>
<caption>
(#tab:primary-outcome-vars-table-total)
</caption>
<caption>
<em>Primary outcome variables with their class and school ICCs</em>
</caption>
<table>
<thead>
<tr class="header">
<th align="left">Variable</th>
<th align="left">Mean</th>
<th align="left">CI95</th>
<th align="left">ICC class</th>
<th align="left">ICC school</th>
<th align="left">n</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">MVPA minutes (accelerometer)</td>
<td align="left">183.1</td>
<td align="left">166  -  200.45</td>
<td align="left">0.072</td>
<td align="left">0.096</td>
<td align="left">706</td>
</tr>
<tr class="even">
<td align="left">Number of MVPA days last week (self-report)</td>
<td align="left">2.8</td>
<td align="left">2.6  -  2.95</td>
<td align="left">0.047</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,082</td>
</tr>
<tr class="odd">
<td align="left">Number of times sitting was interrupted (accelerometer)</td>
<td align="left">28.0</td>
<td align="left">24.7  -  31.37</td>
<td align="left">0.058</td>
<td align="left">0.085</td>
<td align="left">706</td>
</tr>
<tr class="even">
<td align="left">Minutes spent sitting or lying down (accelerometer)</td>
<td align="left">573.9</td>
<td align="left">535.5  -  611.8</td>
<td align="left">0.086</td>
<td align="left">0.145</td>
<td align="left">706</td>
</tr>
</tbody>
</table>
<div id="all-main-variables-their-means-cis-and-iccs." class="section level2">
<h2>All main variables, their means, CIs and ICCs.</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">options</span>(<span class="dt">tibble.print_max =</span> <span class="dv">1000</span>)
 
vardatatable <span class="op">%&gt;%</span>
<span class="st">    </span>papaja<span class="op">::</span><span class="kw">apa_table</span>(
        <span class="dt">caption =</span> <span class="st">&quot;All variables with their class and school ICCs&quot;</span>,
        <span class="dt">escape =</span> T,
        <span class="dt">format.args =</span> <span class="kw">list</span>(<span class="dt">digits =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">0</span>), <span class="dt">margin =</span> <span class="dv">2</span>))</code></pre></div>
<caption>
(#tab:allvars-total)
</caption>
<caption>
<em>All variables with their class and school ICCs</em>
</caption>
<table>
<thead>
<tr class="header">
<th align="left">Variable</th>
<th align="left">Mean</th>
<th align="left">CI95</th>
<th align="left">ICC class</th>
<th align="left">ICC school</th>
<th align="left">n</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">b5agr</td>
<td align="left">5.3</td>
<td align="left">5.2  -  5.5</td>
<td align="left">0.033</td>
<td align="left">0.012</td>
<td align="left">1,068</td>
</tr>
<tr class="even">
<td align="left">b5agr_01</td>
<td align="left">5.5</td>
<td align="left">5.4  -  5.66</td>
<td align="left">0.045</td>
<td align="left">0.002</td>
<td align="left">1,061</td>
</tr>
<tr class="odd">
<td align="left">b5agrReverseCoded_02</td>
<td align="left">5.2</td>
<td align="left">5  -  5.37</td>
<td align="left">0.005</td>
<td align="left">0.01</td>
<td align="left">1,064</td>
</tr>
<tr class="even">
<td align="left">b5cons</td>
<td align="left">5.0</td>
<td align="left">4.9  -  5.17</td>
<td align="left">NA</td>
<td align="left">0.007</td>
<td align="left">1,067</td>
</tr>
<tr class="odd">
<td align="left">b5cons_01</td>
<td align="left">5.4</td>
<td align="left">5.2  -  5.65</td>
<td align="left">0.014</td>
<td align="left">0.015</td>
<td align="left">1,059</td>
</tr>
<tr class="even">
<td align="left">b5consReverseCoded_02</td>
<td align="left">4.6</td>
<td align="left">4.5  -  4.78</td>
<td align="left">NA</td>
<td align="left">0.002</td>
<td align="left">1,065</td>
</tr>
<tr class="odd">
<td align="left">b5ext</td>
<td align="left">4.5</td>
<td align="left">4.3  -  4.77</td>
<td align="left">0.020</td>
<td align="left">0.022</td>
<td align="left">1,068</td>
</tr>
<tr class="even">
<td align="left">b5ext_01</td>
<td align="left">5.0</td>
<td align="left">4.7  -  5.24</td>
<td align="left">0.048</td>
<td align="left">0.013</td>
<td align="left">1,063</td>
</tr>
<tr class="odd">
<td align="left">b5extReverseCoded_02</td>
<td align="left">4.1</td>
<td align="left">3.8  -  4.32</td>
<td align="left">0.002</td>
<td align="left">0.012</td>
<td align="left">1,062</td>
</tr>
<tr class="even">
<td align="left">b5neur</td>
<td align="left">3.8</td>
<td align="left">3.6  -  4</td>
<td align="left">0.014</td>
<td align="left">0.012</td>
<td align="left">1,068</td>
</tr>
<tr class="odd">
<td align="left">b5neur_01</td>
<td align="left">4.1</td>
<td align="left">3.8  -  4.39</td>
<td align="left">0.017</td>
<td align="left">0.014</td>
<td align="left">1,064</td>
</tr>
<tr class="even">
<td align="left">b5neurReverseCoded_02</td>
<td align="left">3.5</td>
<td align="left">3.4  -  3.67</td>
<td align="left">0.011</td>
<td align="left">0.002</td>
<td align="left">1,061</td>
</tr>
<tr class="odd">
<td align="left">b5open</td>
<td align="left">4.9</td>
<td align="left">4.7  -  5.12</td>
<td align="left">0.010</td>
<td align="left">0.03</td>
<td align="left">1,068</td>
</tr>
<tr class="even">
<td align="left">b5open_01</td>
<td align="left">5.4</td>
<td align="left">5.1  -  5.59</td>
<td align="left">0.025</td>
<td align="left">0.016</td>
<td align="left">1,062</td>
</tr>
<tr class="odd">
<td align="left">b5openReverseCoded_02</td>
<td align="left">4.4</td>
<td align="left">4.2  -  4.67</td>
<td align="left">NA</td>
<td align="left">0.016</td>
<td align="left">1,066</td>
</tr>
<tr class="even">
<td align="left">fatpct</td>
<td align="left">25.5</td>
<td align="left">22.4  -  28.67</td>
<td align="left">0.003</td>
<td align="left">0.123</td>
<td align="left">942</td>
</tr>
<tr class="odd">
<td align="left">PA_actCop</td>
<td align="left">2.6</td>
<td align="left">2.6  -  2.69</td>
<td align="left">0.035</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,073</td>
</tr>
<tr class="even">
<td align="left">PA_actionplan</td>
<td align="left">2.8</td>
<td align="left">2.7  -  2.83</td>
<td align="left">0.038</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,073</td>
</tr>
<tr class="odd">
<td align="left">PA_actplan_01</td>
<td align="left">2.6</td>
<td align="left">2.5  -  2.68</td>
<td align="left">0.032</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,073</td>
</tr>
<tr class="even">
<td align="left">PA_actplan_02</td>
<td align="left">2.8</td>
<td align="left">2.7  -  2.88</td>
<td align="left">0.028</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,073</td>
</tr>
<tr class="odd">
<td align="left">PA_actplan_03</td>
<td align="left">2.9</td>
<td align="left">2.8  -  2.93</td>
<td align="left">0.037</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,073</td>
</tr>
<tr class="even">
<td align="left">PA_actplan_04</td>
<td align="left">2.8</td>
<td align="left">2.7  -  2.86</td>
<td align="left">0.038</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,073</td>
</tr>
<tr class="odd">
<td align="left">PA_agrbct</td>
<td align="left">3.1</td>
<td align="left">3  -  3.23</td>
<td align="left">0.052</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,071</td>
</tr>
<tr class="even">
<td align="left">PA_agrbct_01</td>
<td align="left">3.7</td>
<td align="left">3.5  -  3.85</td>
<td align="left">0.061</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,071</td>
</tr>
<tr class="odd">
<td align="left">PA_agrbct_02</td>
<td align="left">3.2</td>
<td align="left">3  -  3.33</td>
<td align="left">0.025</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,071</td>
</tr>
<tr class="even">
<td align="left">PA_agrbct_03</td>
<td align="left">2.4</td>
<td align="left">2.3  -  2.57</td>
<td align="left">0.009</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,071</td>
</tr>
<tr class="odd">
<td align="left">PA_agrbct_04</td>
<td align="left">2.5</td>
<td align="left">2.4  -  2.67</td>
<td align="left">0.035</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,071</td>
</tr>
<tr class="even">
<td align="left">PA_agrbct_05</td>
<td align="left">2.6</td>
<td align="left">2.5  -  2.78</td>
<td align="left">0.055</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,071</td>
</tr>
<tr class="odd">
<td align="left">PA_agrbct_06</td>
<td align="left">3.2</td>
<td align="left">3.1  -  3.38</td>
<td align="left">0.028</td>
<td align="left">0.001</td>
<td align="left">1,071</td>
</tr>
<tr class="even">
<td align="left">PA_agrbct_07</td>
<td align="left">3.0</td>
<td align="left">2.9  -  3.16</td>
<td align="left">0.022</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,071</td>
</tr>
<tr class="odd">
<td align="left">PA_agrbct_08</td>
<td align="left">3.1</td>
<td align="left">3  -  3.25</td>
<td align="left">0.023</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,071</td>
</tr>
<tr class="even">
<td align="left">PA_agrbct_09</td>
<td align="left">3.7</td>
<td align="left">3.5  -  3.85</td>
<td align="left">0.032</td>
<td align="left">0.001</td>
<td align="left">1,071</td>
</tr>
<tr class="odd">
<td align="left">PA_agrbct_10</td>
<td align="left">3.6</td>
<td align="left">3.5  -  3.79</td>
<td align="left">0.044</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,071</td>
</tr>
<tr class="even">
<td align="left">PA_amotivation</td>
<td align="left">1.5</td>
<td align="left">1.5  -  1.61</td>
<td align="left">0.035</td>
<td align="left">0.002</td>
<td align="left">1,072</td>
</tr>
<tr class="odd">
<td align="left">PA_amotivation_01</td>
<td align="left">1.5</td>
<td align="left">1.4  -  1.59</td>
<td align="left">0.031</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,062</td>
</tr>
<tr class="even">
<td align="left">PA_amotivation_02</td>
<td align="left">1.5</td>
<td align="left">1.4  -  1.63</td>
<td align="left">0.026</td>
<td align="left">0.005</td>
<td align="left">1,057</td>
</tr>
<tr class="odd">
<td align="left">PA_amotivation_03</td>
<td align="left">1.6</td>
<td align="left">1.5  -  1.69</td>
<td align="left">0.032</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,067</td>
</tr>
<tr class="even">
<td align="left">PA_amotivation_04</td>
<td align="left">1.5</td>
<td align="left">1.4  -  1.55</td>
<td align="left">0.027</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,066</td>
</tr>
<tr class="odd">
<td align="left">PA_autonomous</td>
<td align="left">3.4</td>
<td align="left">3.3  -  3.52</td>
<td align="left">0.073</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,078</td>
</tr>
<tr class="even">
<td align="left">PA_autonomous_01</td>
<td align="left">3.1</td>
<td align="left">3  -  3.29</td>
<td align="left">0.002</td>
<td align="left">0.012</td>
<td align="left">1,063</td>
</tr>
<tr class="odd">
<td align="left">PA_autonomous_02</td>
<td align="left">3.8</td>
<td align="left">3.7  -  3.86</td>
<td align="left">0.031</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,063</td>
</tr>
<tr class="even">
<td align="left">PA_autonomous_03</td>
<td align="left">3.4</td>
<td align="left">3.2  -  3.51</td>
<td align="left">0.058</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,070</td>
</tr>
<tr class="odd">
<td align="left">PA_autonomous_04</td>
<td align="left">3.3</td>
<td align="left">3.2  -  3.47</td>
<td align="left">0.059</td>
<td align="left">0.004</td>
<td align="left">1,070</td>
</tr>
<tr class="even">
<td align="left">PA_autonomous_05</td>
<td align="left">3.3</td>
<td align="left">3.1  -  3.39</td>
<td align="left">0.048</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,062</td>
</tr>
<tr class="odd">
<td align="left">PA_autonomous_06</td>
<td align="left">3.1</td>
<td align="left">3  -  3.22</td>
<td align="left">0.072</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,066</td>
</tr>
<tr class="even">
<td align="left">PA_autonomous_07</td>
<td align="left">3.7</td>
<td align="left">3.6  -  3.88</td>
<td align="left">0.072</td>
<td align="left">0.005</td>
<td align="left">1,070</td>
</tr>
<tr class="odd">
<td align="left">PA_autonomous_08</td>
<td align="left">3.6</td>
<td align="left">3.5  -  3.76</td>
<td align="left">0.057</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,066</td>
</tr>
<tr class="even">
<td align="left">PA_autonomous_09</td>
<td align="left">3.5</td>
<td align="left">3.4  -  3.62</td>
<td align="left">0.055</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,057</td>
</tr>
<tr class="odd">
<td align="left">PA_controlled</td>
<td align="left">1.8</td>
<td align="left">1.8  -  1.9</td>
<td align="left">0.005</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,073</td>
</tr>
<tr class="even">
<td align="left">PA_controlled_01</td>
<td align="left">1.7</td>
<td align="left">1.6  -  1.73</td>
<td align="left">0.010</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,068</td>
</tr>
<tr class="odd">
<td align="left">PA_controlled_02</td>
<td align="left">1.5</td>
<td align="left">1.4  -  1.55</td>
<td align="left">0.024</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,069</td>
</tr>
<tr class="even">
<td align="left">PA_controlled_03</td>
<td align="left">1.5</td>
<td align="left">1.5  -  1.61</td>
<td align="left">0.011</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,064</td>
</tr>
<tr class="odd">
<td align="left">PA_controlled_04</td>
<td align="left">2.2</td>
<td align="left">2.1  -  2.28</td>
<td align="left">NA</td>
<td align="left">0.001</td>
<td align="left">1,068</td>
</tr>
<tr class="even">
<td align="left">PA_controlled_05</td>
<td align="left">2.3</td>
<td align="left">2.2  -  2.4</td>
<td align="left">0.006</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,066</td>
</tr>
<tr class="odd">
<td align="left">PA_copingplan</td>
<td align="left">2.5</td>
<td align="left">2.4  -  2.56</td>
<td align="left">0.023</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,073</td>
</tr>
<tr class="even">
<td align="left">PA_copplan_01</td>
<td align="left">2.4</td>
<td align="left">2.3  -  2.47</td>
<td align="left">0.007</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,073</td>
</tr>
<tr class="odd">
<td align="left">PA_copplan_02</td>
<td align="left">2.4</td>
<td align="left">2.4  -  2.5</td>
<td align="left">0.004</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,073</td>
</tr>
<tr class="even">
<td align="left">PA_copplan_03</td>
<td align="left">2.5</td>
<td align="left">2.4  -  2.54</td>
<td align="left">0.035</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,073</td>
</tr>
<tr class="odd">
<td align="left">PA_copplan_04</td>
<td align="left">2.7</td>
<td align="left">2.6  -  2.77</td>
<td align="left">0.035</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,073</td>
</tr>
<tr class="even">
<td align="left">PA_dnorm</td>
<td align="left">4.4</td>
<td align="left">4.2  -  4.58</td>
<td align="left">0.050</td>
<td align="left">0.003</td>
<td align="left">1,073</td>
</tr>
<tr class="odd">
<td align="left">PA_dnorm_01</td>
<td align="left">4.5</td>
<td align="left">4.3  -  4.71</td>
<td align="left">0.050</td>
<td align="left">0.004</td>
<td align="left">1,073</td>
</tr>
<tr class="even">
<td align="left">PA_dnorm_02</td>
<td align="left">4.3</td>
<td align="left">4.1  -  4.52</td>
<td align="left">0.027</td>
<td align="left">0.004</td>
<td align="left">1,073</td>
</tr>
<tr class="odd">
<td align="left">PA_extrinsic</td>
<td align="left">1.6</td>
<td align="left">1.5  -  1.62</td>
<td align="left">0.022</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,069</td>
</tr>
<tr class="even">
<td align="left">PA_extrinsic_01</td>
<td align="left">1.7</td>
<td align="left">1.6  -  1.73</td>
<td align="left">0.010</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,068</td>
</tr>
<tr class="odd">
<td align="left">PA_extrinsic_02</td>
<td align="left">1.5</td>
<td align="left">1.4  -  1.55</td>
<td align="left">0.024</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,069</td>
</tr>
<tr class="even">
<td align="left">PA_extrinsic_03</td>
<td align="left">1.5</td>
<td align="left">1.5  -  1.61</td>
<td align="left">0.011</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,064</td>
</tr>
<tr class="odd">
<td align="left">PA_frqbct</td>
<td align="left">2.5</td>
<td align="left">2.4  -  2.62</td>
<td align="left">0.027</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,070</td>
</tr>
<tr class="even">
<td align="left">PA_frqbct_01</td>
<td align="left">3.7</td>
<td align="left">3.6  -  3.84</td>
<td align="left">0.014</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,070</td>
</tr>
<tr class="odd">
<td align="left">PA_frqbct_02</td>
<td align="left">1.9</td>
<td align="left">1.8  -  1.98</td>
<td align="left">0.024</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,070</td>
</tr>
<tr class="even">
<td align="left">PA_frqbct_03</td>
<td align="left">2.0</td>
<td align="left">1.9  -  2.13</td>
<td align="left">0.007</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,070</td>
</tr>
<tr class="odd">
<td align="left">PA_frqbct_04</td>
<td align="left">1.9</td>
<td align="left">1.8  -  2.02</td>
<td align="left">0.035</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,070</td>
</tr>
<tr class="even">
<td align="left">PA_frqbct_05</td>
<td align="left">2.5</td>
<td align="left">2.4  -  2.64</td>
<td align="left">0.033</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,070</td>
</tr>
<tr class="odd">
<td align="left">PA_frqbct_06</td>
<td align="left">3.4</td>
<td align="left">3.3  -  3.54</td>
<td align="left">0.016</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,070</td>
</tr>
<tr class="even">
<td align="left">PA_frqbct_07</td>
<td align="left">2.2</td>
<td align="left">2.1  -  2.3</td>
<td align="left">0.003</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,070</td>
</tr>
<tr class="odd">
<td align="left">PA_frqbct_08</td>
<td align="left">2.4</td>
<td align="left">2.3  -  2.5</td>
<td align="left">0.014</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,070</td>
</tr>
<tr class="even">
<td align="left">PA_frqbct_09</td>
<td align="left">2.8</td>
<td align="left">2.7  -  2.9</td>
<td align="left">0.007</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,070</td>
</tr>
<tr class="odd">
<td align="left">PA_goal</td>
<td align="left">0.6</td>
<td align="left">0.5  -  0.59</td>
<td align="left">0.046</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,061</td>
</tr>
<tr class="even">
<td align="left">PA_goal_01</td>
<td align="left">0.6</td>
<td align="left">0.5  -  0.59</td>
<td align="left">0.046</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,061</td>
</tr>
<tr class="odd">
<td align="left">PA_identified</td>
<td align="left">3.4</td>
<td align="left">3.3  -  3.54</td>
<td align="left">0.040</td>
<td align="left">0.004</td>
<td align="left">1,074</td>
</tr>
<tr class="even">
<td align="left">PA_identified_01</td>
<td align="left">3.1</td>
<td align="left">3  -  3.29</td>
<td align="left">0.002</td>
<td align="left">0.012</td>
<td align="left">1,063</td>
</tr>
<tr class="odd">
<td align="left">PA_identified_02</td>
<td align="left">3.8</td>
<td align="left">3.7  -  3.86</td>
<td align="left">0.031</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,063</td>
</tr>
<tr class="even">
<td align="left">PA_identified_03</td>
<td align="left">3.4</td>
<td align="left">3.2  -  3.51</td>
<td align="left">0.058</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,070</td>
</tr>
<tr class="odd">
<td align="left">PA_inorm</td>
<td align="left">4.7</td>
<td align="left">4.5  -  4.84</td>
<td align="left">0.006</td>
<td align="left">0.003</td>
<td align="left">1,073</td>
</tr>
<tr class="even">
<td align="left">PA_inorm_01</td>
<td align="left">4.7</td>
<td align="left">4.5  -  4.84</td>
<td align="left">0.006</td>
<td align="left">0.003</td>
<td align="left">1,073</td>
</tr>
<tr class="odd">
<td align="left">PA_integrated</td>
<td align="left">3.2</td>
<td align="left">3.1  -  3.34</td>
<td align="left">0.071</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,073</td>
</tr>
<tr class="even">
<td align="left">PA_integrated_01</td>
<td align="left">3.3</td>
<td align="left">3.2  -  3.47</td>
<td align="left">0.059</td>
<td align="left">0.004</td>
<td align="left">1,070</td>
</tr>
<tr class="odd">
<td align="left">PA_integrated_02</td>
<td align="left">3.3</td>
<td align="left">3.1  -  3.39</td>
<td align="left">0.048</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,062</td>
</tr>
<tr class="even">
<td align="left">PA_integrated_03</td>
<td align="left">3.1</td>
<td align="left">3  -  3.22</td>
<td align="left">0.072</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,066</td>
</tr>
<tr class="odd">
<td align="left">PA_intention</td>
<td align="left">5.4</td>
<td align="left">5.2  -  5.57</td>
<td align="left">0.105</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,073</td>
</tr>
<tr class="even">
<td align="left">PA_intention_01</td>
<td align="left">5.4</td>
<td align="left">5.2  -  5.55</td>
<td align="left">0.088</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,073</td>
</tr>
<tr class="odd">
<td align="left">PA_intention_02</td>
<td align="left">5.4</td>
<td align="left">5.2  -  5.61</td>
<td align="left">0.111</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,073</td>
</tr>
<tr class="even">
<td align="left">PA_intrinsic</td>
<td align="left">3.6</td>
<td align="left">3.5  -  3.74</td>
<td align="left">0.074</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,074</td>
</tr>
<tr class="odd">
<td align="left">PA_intrinsic_01</td>
<td align="left">3.7</td>
<td align="left">3.6  -  3.88</td>
<td align="left">0.072</td>
<td align="left">0.005</td>
<td align="left">1,070</td>
</tr>
<tr class="even">
<td align="left">PA_intrinsic_02</td>
<td align="left">3.6</td>
<td align="left">3.5  -  3.76</td>
<td align="left">0.057</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,066</td>
</tr>
<tr class="odd">
<td align="left">PA_intrinsic_03</td>
<td align="left">3.5</td>
<td align="left">3.4  -  3.62</td>
<td align="left">0.055</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,057</td>
</tr>
<tr class="even">
<td align="left">PA_introjected</td>
<td align="left">2.2</td>
<td align="left">2.2  -  2.33</td>
<td align="left">NA</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,073</td>
</tr>
<tr class="odd">
<td align="left">PA_introjected_01</td>
<td align="left">2.2</td>
<td align="left">2.1  -  2.28</td>
<td align="left">NA</td>
<td align="left">0.001</td>
<td align="left">1,068</td>
</tr>
<tr class="even">
<td align="left">PA_introjected_02</td>
<td align="left">2.3</td>
<td align="left">2.2  -  2.4</td>
<td align="left">0.006</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,066</td>
</tr>
<tr class="odd">
<td align="left">PA_opportunities</td>
<td align="left">5.1</td>
<td align="left">5.1  -  5.19</td>
<td align="left">0.018</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,075</td>
</tr>
<tr class="even">
<td align="left">PA_opportunities_01</td>
<td align="left">4.7</td>
<td align="left">4.3  -  4.98</td>
<td align="left">0.037</td>
<td align="left">0.02</td>
<td align="left">1,070</td>
</tr>
<tr class="odd">
<td align="left">PA_opportunities_02</td>
<td align="left">5.5</td>
<td align="left">5.4  -  5.62</td>
<td align="left">0.018</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,067</td>
</tr>
<tr class="even">
<td align="left">PA_opportunities_04</td>
<td align="left">5.6</td>
<td align="left">5.4  -  5.75</td>
<td align="left">0.021</td>
<td align="left">0.008</td>
<td align="left">1,070</td>
</tr>
<tr class="odd">
<td align="left">PA_opportunities_05</td>
<td align="left">5.3</td>
<td align="left">5.2  -  5.43</td>
<td align="left">NA</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,064</td>
</tr>
<tr class="even">
<td align="left">PA_opportunities_07</td>
<td align="left">4.6</td>
<td align="left">4.5  -  4.77</td>
<td align="left">0.009</td>
<td align="left">0.001</td>
<td align="left">1,068</td>
</tr>
<tr class="odd">
<td align="left">PA_opportunitiesReverseCoded_03</td>
<td align="left">5.1</td>
<td align="left">5  -  5.23</td>
<td align="left">NA</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,065</td>
</tr>
<tr class="even">
<td align="left">PA_opportunitiesReverseCoded_06</td>
<td align="left">3.6</td>
<td align="left">3.3  -  3.95</td>
<td align="left">NA</td>
<td align="left">0.024</td>
<td align="left">1,059</td>
</tr>
<tr class="odd">
<td align="left">PA_opportunitiesReverseCoded_08</td>
<td align="left">6.6</td>
<td align="left">6.5  -  6.68</td>
<td align="left">0.020</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,066</td>
</tr>
<tr class="even">
<td align="left">PA_outcomeExpectations</td>
<td align="left">4.6</td>
<td align="left">4.5  -  4.74</td>
<td align="left">0.034</td>
<td align="left">0.013</td>
<td align="left">1,078</td>
</tr>
<tr class="odd">
<td align="left">PA_outcomeExpectations_01</td>
<td align="left">5.5</td>
<td align="left">5.3  -  5.7</td>
<td align="left">0.042</td>
<td align="left">0.011</td>
<td align="left">1,071</td>
</tr>
<tr class="even">
<td align="left">PA_outcomeExpectations_03</td>
<td align="left">5.2</td>
<td align="left">4.9  -  5.47</td>
<td align="left">0.008</td>
<td align="left">0.018</td>
<td align="left">1,064</td>
</tr>
<tr class="odd">
<td align="left">PA_outcomeExpectations_04</td>
<td align="left">5.5</td>
<td align="left">5.3  -  5.65</td>
<td align="left">0.009</td>
<td align="left">0.007</td>
<td align="left">1,071</td>
</tr>
<tr class="even">
<td align="left">PA_outcomeExpectations_05</td>
<td align="left">5.2</td>
<td align="left">5  -  5.39</td>
<td align="left">0.023</td>
<td align="left">0.011</td>
<td align="left">1,067</td>
</tr>
<tr class="odd">
<td align="left">PA_outcomeExpectations_06</td>
<td align="left">5.4</td>
<td align="left">5.2  -  5.63</td>
<td align="left">0.030</td>
<td align="left">0.016</td>
<td align="left">1,071</td>
</tr>
<tr class="even">
<td align="left">PA_outcomeExpectations_07</td>
<td align="left">4.9</td>
<td align="left">4.7  -  5.13</td>
<td align="left">0.039</td>
<td align="left">0.008</td>
<td align="left">1,062</td>
</tr>
<tr class="odd">
<td align="left">PA_outcomeExpectations_10</td>
<td align="left">5.4</td>
<td align="left">5.2  -  5.54</td>
<td align="left">0.019</td>
<td align="left">0.006</td>
<td align="left">1,069</td>
</tr>
<tr class="even">
<td align="left">PA_outcomeExpectations_11</td>
<td align="left">5.1</td>
<td align="left">4.9  -  5.38</td>
<td align="left">0.055</td>
<td align="left">0.011</td>
<td align="left">1,063</td>
</tr>
<tr class="odd">
<td align="left">PA_outcomeExpectations_12</td>
<td align="left">5.2</td>
<td align="left">4.9  -  5.45</td>
<td align="left">0.042</td>
<td align="left">0.014</td>
<td align="left">1,070</td>
</tr>
<tr class="even">
<td align="left">PA_outcomeExpectationsNegative_02</td>
<td align="left">2.9</td>
<td align="left">2.7  -  3.02</td>
<td align="left">0.046</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,066</td>
</tr>
<tr class="odd">
<td align="left">PA_outcomeExpectationsNegative_08</td>
<td align="left">2.5</td>
<td align="left">2.3  -  2.69</td>
<td align="left">0.038</td>
<td align="left">0.004</td>
<td align="left">1,063</td>
</tr>
<tr class="even">
<td align="left">PA_outcomeExpectationsNegative_09</td>
<td align="left">2.6</td>
<td align="left">2.5  -  2.68</td>
<td align="left">0.023</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,064</td>
</tr>
<tr class="odd">
<td align="left">PA_pbc</td>
<td align="left">5.3</td>
<td align="left">5.2  -  5.45</td>
<td align="left">0.028</td>
<td align="left">0.004</td>
<td align="left">1,071</td>
</tr>
<tr class="even">
<td align="left">PA_pbc_01</td>
<td align="left">5.9</td>
<td align="left">5.7  -  5.98</td>
<td align="left">0.032</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,069</td>
</tr>
<tr class="odd">
<td align="left">PA_pbc_03</td>
<td align="left">5.2</td>
<td align="left">5  -  5.4</td>
<td align="left">0.014</td>
<td align="left">0.01</td>
<td align="left">1,066</td>
</tr>
<tr class="even">
<td align="left">PA_pbcReverseCoded_02</td>
<td align="left">4.9</td>
<td align="left">4.7  -  5.11</td>
<td align="left">0.005</td>
<td align="left">0.005</td>
<td align="left">1,063</td>
</tr>
<tr class="odd">
<td align="left">PA_selfefficacy</td>
<td align="left">5.2</td>
<td align="left">5.1  -  5.35</td>
<td align="left">0.007</td>
<td align="left">0.005</td>
<td align="left">1,071</td>
</tr>
<tr class="even">
<td align="left">PA_selfefficacy_01</td>
<td align="left">5.9</td>
<td align="left">5.8  -  5.96</td>
<td align="left">0.009</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,071</td>
</tr>
<tr class="odd">
<td align="left">PA_selfefficacyReverseCoded_02</td>
<td align="left">4.6</td>
<td align="left">4.4  -  4.77</td>
<td align="left">0.002</td>
<td align="left">0.005</td>
<td align="left">1,071</td>
</tr>
<tr class="even">
<td align="left">PA_sePbc</td>
<td align="left">5.3</td>
<td align="left">5.1  -  5.4</td>
<td align="left">0.028</td>
<td align="left">0.007</td>
<td align="left">1,071</td>
</tr>
<tr class="odd">
<td align="left">paAccelerometer</td>
<td align="left">183.1</td>
<td align="left">166  -  200.45</td>
<td align="left">0.072</td>
<td align="left">0.096</td>
<td align="left">706</td>
</tr>
<tr class="even">
<td align="left">padaysLastweek</td>
<td align="left">2.8</td>
<td align="left">2.6  -  2.95</td>
<td align="left">0.047</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,082</td>
</tr>
<tr class="odd">
<td align="left">pafreqUsually</td>
<td align="left">2.6</td>
<td align="left">2.4  -  2.73</td>
<td align="left">0.094</td>
<td align="left">0.003</td>
<td align="left">1,082</td>
</tr>
<tr class="even">
<td align="left">pahrsLastweek</td>
<td align="left">5.4</td>
<td align="left">4.7  -  6.16</td>
<td align="left">0.024</td>
<td align="left">0.007</td>
<td align="left">1,082</td>
</tr>
<tr class="odd">
<td align="left">pahrsUsually</td>
<td align="left">3.1</td>
<td align="left">2.9  -  3.36</td>
<td align="left">0.085</td>
<td align="left">0.005</td>
<td align="left">1,082</td>
</tr>
<tr class="even">
<td align="left">paLastweek</td>
<td align="left">339.7</td>
<td align="left">296  -  382.07</td>
<td align="left">0.024</td>
<td align="left">0.006</td>
<td align="left">1,082</td>
</tr>
<tr class="odd">
<td align="left">paminLastweek</td>
<td align="left">1.4</td>
<td align="left">1.4  -  1.5</td>
<td align="left">NA</td>
<td align="left">0.01</td>
<td align="left">1,082</td>
</tr>
<tr class="even">
<td align="left">SB_dnorm</td>
<td align="left">3.2</td>
<td align="left">3.1  -  3.41</td>
<td align="left">0.003</td>
<td align="left">0.007</td>
<td align="left">1,062</td>
</tr>
<tr class="odd">
<td align="left">SB_dnorm_01</td>
<td align="left">3.1</td>
<td align="left">2.9  -  3.22</td>
<td align="left">NA</td>
<td align="left">0.004</td>
<td align="left">1,059</td>
</tr>
<tr class="even">
<td align="left">SB_dnorm_02</td>
<td align="left">3.4</td>
<td align="left">3.2  -  3.59</td>
<td align="left">0.010</td>
<td align="left">0.007</td>
<td align="left">1,060</td>
</tr>
<tr class="odd">
<td align="left">SB_inorm</td>
<td align="left">4.0</td>
<td align="left">3.9  -  4.14</td>
<td align="left">0.012</td>
<td align="left">0.004</td>
<td align="left">1,064</td>
</tr>
<tr class="even">
<td align="left">SB_inorm_01</td>
<td align="left">3.9</td>
<td align="left">3.8  -  4.11</td>
<td align="left">NA</td>
<td align="left">0.008</td>
<td align="left">1,056</td>
</tr>
<tr class="odd">
<td align="left">SB_inorm_02</td>
<td align="left">4.1</td>
<td align="left">3.9  -  4.28</td>
<td align="left">0.030</td>
<td align="left">0.005</td>
<td align="left">1,053</td>
</tr>
<tr class="even">
<td align="left">SB_intention</td>
<td align="left">3.7</td>
<td align="left">3.4  -  4.06</td>
<td align="left">0.014</td>
<td align="left">0.035</td>
<td align="left">1,064</td>
</tr>
<tr class="odd">
<td align="left">SB_intention_01</td>
<td align="left">3.3</td>
<td align="left">3  -  3.64</td>
<td align="left">NA</td>
<td align="left">0.025</td>
<td align="left">1,059</td>
</tr>
<tr class="even">
<td align="left">SB_intention_02</td>
<td align="left">3.5</td>
<td align="left">3.2  -  3.81</td>
<td align="left">NA</td>
<td align="left">0.034</td>
<td align="left">1,056</td>
</tr>
<tr class="odd">
<td align="left">SB_intention_03</td>
<td align="left">4.0</td>
<td align="left">3.7  -  4.37</td>
<td align="left">0.023</td>
<td align="left">0.027</td>
<td align="left">1,054</td>
</tr>
<tr class="even">
<td align="left">SB_intention_04</td>
<td align="left">4.1</td>
<td align="left">3.8  -  4.43</td>
<td align="left">0.028</td>
<td align="left">0.027</td>
<td align="left">1,055</td>
</tr>
<tr class="odd">
<td align="left">SB_outcomeExpectations</td>
<td align="left">4.4</td>
<td align="left">4.3  -  4.53</td>
<td align="left">0.029</td>
<td align="left">0.005</td>
<td align="left">1,064</td>
</tr>
<tr class="even">
<td align="left">SB_outcomeExpectations_02</td>
<td align="left">4.8</td>
<td align="left">4.6  -  5.06</td>
<td align="left">0.017</td>
<td align="left">0.014</td>
<td align="left">1,056</td>
</tr>
<tr class="odd">
<td align="left">SB_outcomeExpectations_03</td>
<td align="left">4.6</td>
<td align="left">4.4  -  4.88</td>
<td align="left">0.024</td>
<td align="left">0.014</td>
<td align="left">1,058</td>
</tr>
<tr class="even">
<td align="left">SB_outcomeExpectations_04</td>
<td align="left">4.9</td>
<td align="left">4.7  -  5.12</td>
<td align="left">0.038</td>
<td align="left">0.005</td>
<td align="left">1,063</td>
</tr>
<tr class="odd">
<td align="left">SB_outcomeExpectations_05</td>
<td align="left">4.9</td>
<td align="left">4.7  -  5.09</td>
<td align="left">0.040</td>
<td align="left">0.004</td>
<td align="left">1,060</td>
</tr>
<tr class="even">
<td align="left">SB_outcomeExpectations_06</td>
<td align="left">4.9</td>
<td align="left">4.7  -  5.11</td>
<td align="left">0.047</td>
<td align="left">0.011</td>
<td align="left">1,058</td>
</tr>
<tr class="odd">
<td align="left">SB_outcomeExpectationsNegative_01</td>
<td align="left">3.4</td>
<td align="left">3.3  -  3.51</td>
<td align="left">0.008</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,063</td>
</tr>
<tr class="even">
<td align="left">SB_outcomeExpectationsNegative_07</td>
<td align="left">3.3</td>
<td align="left">3.2  -  3.51</td>
<td align="left">0.012</td>
<td align="left">0.003</td>
<td align="left">1,057</td>
</tr>
<tr class="odd">
<td align="left">SB_sePbc</td>
<td align="left">5.0</td>
<td align="left">4.8  -  5.14</td>
<td align="left">0.015</td>
<td align="left">0.011</td>
<td align="left">1,064</td>
</tr>
<tr class="even">
<td align="left">SB_sePbc_01</td>
<td align="left">4.4</td>
<td align="left">4.1  -  4.6</td>
<td align="left">0.010</td>
<td align="left">0.014</td>
<td align="left">1,062</td>
</tr>
<tr class="odd">
<td align="left">SB_sePbc_02</td>
<td align="left">4.3</td>
<td align="left">4.1  -  4.54</td>
<td align="left">0.003</td>
<td align="left">0.015</td>
<td align="left">1,061</td>
</tr>
<tr class="even">
<td align="left">SB_sePbc_03</td>
<td align="left">5.7</td>
<td align="left">5.6  -  5.87</td>
<td align="left">0.026</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,060</td>
</tr>
<tr class="odd">
<td align="left">SB_sePbc_04</td>
<td align="left">5.7</td>
<td align="left">5.6  -  5.88</td>
<td align="left">0.034</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,060</td>
</tr>
<tr class="even">
<td align="left">SB_sePbc_05</td>
<td align="left">4.7</td>
<td align="left">4.5  -  4.91</td>
<td align="left">0.005</td>
<td align="left">0.012</td>
<td align="left">1,054</td>
</tr>
<tr class="odd">
<td align="left">sitBreaks</td>
<td align="left">28.0</td>
<td align="left">24.7  -  31.37</td>
<td align="left">0.058</td>
<td align="left">0.085</td>
<td align="left">706</td>
</tr>
<tr class="even">
<td align="left">sitLieAccelerometer</td>
<td align="left">573.9</td>
<td align="left">535.5  -  611.8</td>
<td align="left">0.086</td>
<td align="left">0.145</td>
<td align="left">706</td>
</tr>
<tr class="odd">
<td align="left">symptom</td>
<td align="left">2.0</td>
<td align="left">1.8  -  2.11</td>
<td align="left">0.023</td>
<td align="left">0.039</td>
<td align="left">1,084</td>
</tr>
<tr class="even">
<td align="left">symptom_headAche</td>
<td align="left">2.0</td>
<td align="left">1.8  -  2.16</td>
<td align="left">0.007</td>
<td align="left">0.027</td>
<td align="left">1,055</td>
</tr>
<tr class="odd">
<td align="left">symptom_irritabilityAngerbursts</td>
<td align="left">1.9</td>
<td align="left">1.8  -  2.04</td>
<td align="left">0.026</td>
<td align="left">0.01</td>
<td align="left">1,039</td>
</tr>
<tr class="even">
<td align="left">symptom_lowerBackPain</td>
<td align="left">1.8</td>
<td align="left">1.7  -  1.85</td>
<td align="left">0.004</td>
<td align="left">0.005</td>
<td align="left">1,053</td>
</tr>
<tr class="odd">
<td align="left">symptom_neckShoulderPain</td>
<td align="left">2.0</td>
<td align="left">1.8  -  2.17</td>
<td align="left">0.011</td>
<td align="left">0.033</td>
<td align="left">1,047</td>
</tr>
<tr class="even">
<td align="left">symptom_sleepDifficulty</td>
<td align="left">2.1</td>
<td align="left">1.9  -  2.27</td>
<td align="left">0.010</td>
<td align="left">0.023</td>
<td align="left">1,052</td>
</tr>
<tr class="odd">
<td align="left">symptom_stomachAche</td>
<td align="left">1.7</td>
<td align="left">1.6  -  1.86</td>
<td align="left">0.015</td>
<td align="left">0.023</td>
<td align="left">1,026</td>
</tr>
<tr class="even">
<td align="left">symptom_tensionNervousness</td>
<td align="left">1.9</td>
<td align="left">1.8  -  2.08</td>
<td align="left">0.007</td>
<td align="left">0.024</td>
<td align="left">1,051</td>
</tr>
<tr class="odd">
<td align="left">symptom_tirednessFaintness</td>
<td align="left">2.3</td>
<td align="left">2.2  -  2.4</td>
<td align="left">0.025</td>
<td align="left">0.009</td>
<td align="left">1,058</td>
</tr>
</tbody>
</table>
<div id="icc-top-20-items-sorted-by-classroom-icc" class="section level3">
<h3>ICC top 20 items, sorted by classroom ICC</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
vardatatable <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(Variable, <span class="st">`</span><span class="dt">ICC class</span><span class="st">`</span>, <span class="st">`</span><span class="dt">ICC school</span><span class="st">`</span>, n) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">arrange</span>(<span class="kw">desc</span>(<span class="st">`</span><span class="dt">ICC class</span><span class="st">`</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">slice</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">20</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">as.tbl</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>papaja<span class="op">::</span><span class="kw">apa_table</span>(<span class="dt">caption =</span> <span class="st">&quot;Intra-class correlations sorted by classroom ICC&quot;</span>,
        <span class="dt">format.args =</span> <span class="kw">list</span>(<span class="dt">digits =</span> <span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">0</span>), <span class="dt">margin =</span> <span class="dv">2</span>))</code></pre></div>
<caption>
(#tab:icc-school-class-sortbyclass)
</caption>
<caption>
<em>Intra-class correlations sorted by classroom ICC</em>
</caption>
<table>
<thead>
<tr class="header">
<th align="left">Variable</th>
<th align="left">ICC class</th>
<th align="left">ICC school</th>
<th align="left">n</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">PA_intention_02</td>
<td align="left">0.111</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,073</td>
</tr>
<tr class="even">
<td align="left">PA_intention</td>
<td align="left">0.105</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,073</td>
</tr>
<tr class="odd">
<td align="left">pafreqUsually</td>
<td align="left">0.094</td>
<td align="left">0.003</td>
<td align="left">1,082</td>
</tr>
<tr class="even">
<td align="left">PA_intention_01</td>
<td align="left">0.088</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,073</td>
</tr>
<tr class="odd">
<td align="left">sitLieAccelerometer</td>
<td align="left">0.086</td>
<td align="left">0.145</td>
<td align="left">706</td>
</tr>
<tr class="even">
<td align="left">pahrsUsually</td>
<td align="left">0.085</td>
<td align="left">0.005</td>
<td align="left">1,082</td>
</tr>
<tr class="odd">
<td align="left">PA_intrinsic</td>
<td align="left">0.074</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,074</td>
</tr>
<tr class="even">
<td align="left">PA_autonomous</td>
<td align="left">0.073</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,078</td>
</tr>
<tr class="odd">
<td align="left">PA_autonomous_06</td>
<td align="left">0.072</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,066</td>
</tr>
<tr class="even">
<td align="left">PA_autonomous_07</td>
<td align="left">0.072</td>
<td align="left">0.005</td>
<td align="left">1,070</td>
</tr>
<tr class="odd">
<td align="left">PA_integrated_03</td>
<td align="left">0.072</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,066</td>
</tr>
<tr class="even">
<td align="left">PA_intrinsic_01</td>
<td align="left">0.072</td>
<td align="left">0.005</td>
<td align="left">1,070</td>
</tr>
<tr class="odd">
<td align="left">paAccelerometer</td>
<td align="left">0.072</td>
<td align="left">0.096</td>
<td align="left">706</td>
</tr>
<tr class="even">
<td align="left">PA_integrated</td>
<td align="left">0.071</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,073</td>
</tr>
<tr class="odd">
<td align="left">PA_agrbct_01</td>
<td align="left">0.061</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,071</td>
</tr>
<tr class="even">
<td align="left">PA_autonomous_04</td>
<td align="left">0.059</td>
<td align="left">0.004</td>
<td align="left">1,070</td>
</tr>
<tr class="odd">
<td align="left">PA_integrated_01</td>
<td align="left">0.059</td>
<td align="left">0.004</td>
<td align="left">1,070</td>
</tr>
<tr class="even">
<td align="left">PA_autonomous_03</td>
<td align="left">0.058</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,070</td>
</tr>
<tr class="odd">
<td align="left">PA_identified_03</td>
<td align="left">0.058</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,070</td>
</tr>
<tr class="even">
<td align="left">sitBreaks</td>
<td align="left">0.058</td>
<td align="left">0.085</td>
<td align="left">706</td>
</tr>
</tbody>
</table>
</div>
<div id="icc-top-20-items-sorted-by-school-icc" class="section level3">
<h3>ICC top 20 items, sorted by school ICC</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
vardatatable <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(Variable, <span class="st">`</span><span class="dt">ICC class</span><span class="st">`</span>, <span class="st">`</span><span class="dt">ICC school</span><span class="st">`</span>, n) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">arrange</span>(<span class="kw">desc</span>(<span class="st">`</span><span class="dt">ICC school</span><span class="st">`</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">slice</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">20</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>papaja<span class="op">::</span><span class="kw">apa_table</span>(<span class="dt">caption =</span> <span class="st">&quot;Intra-class correlations sorted by school ICC&quot;</span>,
        <span class="dt">format.args =</span> <span class="kw">list</span>(<span class="dt">digits =</span> <span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">0</span>), <span class="dt">margin =</span> <span class="dv">2</span>))</code></pre></div>
<caption>
(#tab:icc-school-class-sortbyschool)
</caption>
<caption>
<em>Intra-class correlations sorted by school ICC</em>
</caption>
<table>
<thead>
<tr class="header">
<th align="left">Variable</th>
<th align="left">ICC class</th>
<th align="left">ICC school</th>
<th align="left">n</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">sitLieAccelerometer</td>
<td align="left">0.086</td>
<td align="left">0.145</td>
<td align="left">706</td>
</tr>
<tr class="even">
<td align="left">fatpct</td>
<td align="left">0.003</td>
<td align="left">0.123</td>
<td align="left">942</td>
</tr>
<tr class="odd">
<td align="left">paAccelerometer</td>
<td align="left">0.072</td>
<td align="left">0.096</td>
<td align="left">706</td>
</tr>
<tr class="even">
<td align="left">sitBreaks</td>
<td align="left">0.058</td>
<td align="left">0.085</td>
<td align="left">706</td>
</tr>
<tr class="odd">
<td align="left">symptom</td>
<td align="left">0.023</td>
<td align="left">0.039</td>
<td align="left">1,084</td>
</tr>
<tr class="even">
<td align="left">SB_intention</td>
<td align="left">0.014</td>
<td align="left">0.035</td>
<td align="left">1,064</td>
</tr>
<tr class="odd">
<td align="left">SB_intention_02</td>
<td align="left">NA</td>
<td align="left">0.034</td>
<td align="left">1,056</td>
</tr>
<tr class="even">
<td align="left">symptom_neckShoulderPain</td>
<td align="left">0.011</td>
<td align="left">0.033</td>
<td align="left">1,047</td>
</tr>
<tr class="odd">
<td align="left">b5open</td>
<td align="left">0.010</td>
<td align="left">0.03</td>
<td align="left">1,068</td>
</tr>
<tr class="even">
<td align="left">SB_intention_03</td>
<td align="left">0.023</td>
<td align="left">0.027</td>
<td align="left">1,054</td>
</tr>
<tr class="odd">
<td align="left">SB_intention_04</td>
<td align="left">0.028</td>
<td align="left">0.027</td>
<td align="left">1,055</td>
</tr>
<tr class="even">
<td align="left">symptom_headAche</td>
<td align="left">0.007</td>
<td align="left">0.027</td>
<td align="left">1,055</td>
</tr>
<tr class="odd">
<td align="left">SB_intention_01</td>
<td align="left">NA</td>
<td align="left">0.025</td>
<td align="left">1,059</td>
</tr>
<tr class="even">
<td align="left">PA_opportunitiesReverseCoded_06</td>
<td align="left">NA</td>
<td align="left">0.024</td>
<td align="left">1,059</td>
</tr>
<tr class="odd">
<td align="left">symptom_tensionNervousness</td>
<td align="left">0.007</td>
<td align="left">0.024</td>
<td align="left">1,051</td>
</tr>
<tr class="even">
<td align="left">symptom_sleepDifficulty</td>
<td align="left">0.010</td>
<td align="left">0.023</td>
<td align="left">1,052</td>
</tr>
<tr class="odd">
<td align="left">symptom_stomachAche</td>
<td align="left">0.015</td>
<td align="left">0.023</td>
<td align="left">1,026</td>
</tr>
<tr class="even">
<td align="left">b5ext</td>
<td align="left">0.020</td>
<td align="left">0.022</td>
<td align="left">1,068</td>
</tr>
<tr class="odd">
<td align="left">PA_opportunities_01</td>
<td align="left">0.037</td>
<td align="left">0.02</td>
<td align="left">1,070</td>
</tr>
<tr class="even">
<td align="left">PA_outcomeExpectations_03</td>
<td align="left">0.008</td>
<td align="left">0.018</td>
<td align="left">1,064</td>
</tr>
</tbody>
</table>
<p>Model with educational track</p>
<p>The model below is the same as the one above, except it adds educational track.</p>
<p>As before, we create a table with all variables, their means, CIs and ICCs.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#library(sjstats)</span>
<span class="co">#library(lme4)</span>

names &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>id, <span class="op">-</span>intervention, <span class="op">-</span>group, <span class="op">-</span>school, <span class="op">-</span>girl, <span class="op">-</span>track, <span class="op">-</span>trackSchool, <span class="op">-</span><span class="kw">contains</span>(<span class="st">&quot;_T3&quot;</span>), <span class="op">-</span><span class="kw">contains</span>(<span class="st">&quot;_diff&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">names</span>(.)

<span class="co"># Create empty soon-to-be-filled objects</span>
m &lt;-<span class="st"> </span><span class="ot">NA</span>
mean &lt;-<span class="st"> </span><span class="ot">NA</span>
m_p &lt;-<span class="st"> </span><span class="ot">NA</span>
ci_low &lt;-<span class="st"> </span><span class="ot">NA</span>
ci_high &lt;-<span class="st"> </span><span class="ot">NA</span>
ICC_group &lt;-<span class="st"> </span><span class="ot">NA</span>
ICC_School &lt;-<span class="st"> </span><span class="ot">NA</span>
nonmissings &lt;-<span class="st"> </span><span class="ot">NA</span>
ICC_track &lt;-<span class="st"> </span><span class="ot">NA</span>


## To test the code with a single variable:
<span class="co"># dftest &lt;- df #%&gt;% na.omit()</span>
<span class="co"># m &lt;- lme4::lmer(sitLieAccelerometer_T1 ~ (1|school) + (1|group) + (1|track), data=df)</span>
<span class="co"># mean &lt;- lme4::fixef(m)</span>
<span class="co"># m_p &lt;- profile(m)</span>
<span class="co"># ci_low &lt;- confint(m_p)[5]</span>
<span class="co"># ci_high &lt;- confint(m_p)[10]</span>
<span class="co"># ICC_group &lt;- icc(m)[1]</span>
<span class="co"># ICC_School &lt;- icc(m)[2]</span>
<span class="co"># nonmissings &lt;- length(m@resp$y)</span>

<span class="co"># Loop over each variable name, extract statistics: </span>

<span class="co"># all participants  </span>
<span class="co"># for (i in names){</span>
<span class="co"># m &lt;- lme4::lmer(paste0(i,&quot; ~ (1|school) + (1|group) + (1|track)&quot;), data=df)</span>
<span class="co"># mean[i] &lt;- lme4::fixef(m)</span>
<span class="co"># m_p &lt;- profile(m, which = &quot;beta_&quot;)</span>
<span class="co"># ci_low[i] &lt;- confint(m_p)[1]</span>
<span class="co"># ci_high[i] &lt;- confint(m_p)[2]</span>
<span class="co"># ICC_group[i] &lt;- sjstats::icc(m)[1]</span>
<span class="co"># ICC_School[i] &lt;- sjstats::icc(m)[3]</span>
<span class="co"># ICC_track[i] &lt;- sjstats::icc(m)[2]</span>
<span class="co"># nonmissings[i] &lt;- length(m@resp$y)</span>
<span class="co"># }</span>
<span class="co"># </span>
<span class="co"># vardatatable_containing_edutrack &lt;- data_frame(</span>
<span class="co">#   Variable = stringr::str_sub(names(mean), end = -4), #remove &quot;_T1&quot; from names</span>
<span class="co">#   Mean = round(mean, 1), </span>
<span class="co">#   CI95 = paste(round(ci_low, 2), &quot;-&quot;, round(ci_high, 2)), </span>
<span class="co">#   &quot;ICC class&quot; =ifelse(round(ICC_group, 3) == 0, &quot;&lt; 0.001&quot;, round(ICC_group, 3)), </span>
<span class="co">#   &quot;ICC school&quot; = ifelse(round(ICC_School, 3) == 0, &quot;&lt; 0.001&quot;, round(ICC_School, 3)),</span>
<span class="co">#   &quot;ICC educational track&quot; = ifelse(round(ICC_track, 3) == 0, &quot;&lt; 0.001&quot;, round(ICC_track, 3)),</span>
<span class="co">#   n = nonmissings) %&gt;% </span>
<span class="co">#   dplyr::arrange(Variable) %&gt;% </span>
<span class="co">#   dplyr::filter(Variable != &quot;&quot;) #remove first row, which is empty</span>
<span class="co"># </span>
<span class="co"># save(vardatatable_containing_edutrack, file = &quot;vardatatable_containing_edutrack.Rdata&quot;)</span>
<span class="kw">load</span>(<span class="st">&quot;vardatatable_containing_edutrack.Rdata&quot;</span>)

<span class="co"># ci_edutrack &lt;- data_frame(</span>
<span class="co">#   &quot;ciLo&quot; = ci_low,</span>
<span class="co">#   &quot;mean&quot; = mean,</span>
<span class="co">#   &quot;ciHi&quot; = ci_high,</span>
<span class="co">#   &quot;diamondlabels&quot; = names(mean)) %&gt;%</span>
<span class="co">#   dplyr::filter(diamondlabels != &quot;&quot;) %&gt;% #remove first row, which is empty</span>
<span class="co">#   as.data.frame()</span>
<span class="co"># </span>
<span class="co"># save(ci_edutrack, file = &quot;ci_edutrack.Rdata&quot;)</span>
<span class="kw">load</span>(<span class="st">&quot;ci_edutrack.Rdata&quot;</span>)</code></pre></div>
</div>
<div id="top-20-items-sorted-by-school" class="section level3">
<h3>Top 20 items, sorted by school</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
vardatatable_containing_edutrack <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(Variable, <span class="st">`</span><span class="dt">ICC educational track</span><span class="st">`</span>, <span class="st">`</span><span class="dt">ICC class</span><span class="st">`</span>, <span class="st">`</span><span class="dt">ICC school</span><span class="st">`</span>, n) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">arrange</span>(<span class="kw">desc</span>(<span class="st">`</span><span class="dt">ICC school</span><span class="st">`</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">top_n</span>(<span class="dv">20</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>papaja<span class="op">::</span><span class="kw">apa_table</span>(<span class="dt">caption =</span> <span class="st">&quot;Intra-class correlations sorted by school ICC&quot;</span>,
        <span class="dt">format.args =</span> <span class="kw">list</span>(<span class="dt">digits =</span> <span class="kw">c</span>(<span class="dv">0</span>), <span class="dt">margin =</span> <span class="dv">2</span>))
## Selecting by n</code></pre></div>
<caption>
(#tab:icc-school-class-track-sortbyschool)
</caption>
<caption>
<em>Intra-class correlations sorted by school ICC</em>
</caption>
<table>
<thead>
<tr class="header">
<th align="left">Variable</th>
<th align="left">ICC educational track</th>
<th align="left">ICC class</th>
<th align="left">ICC school</th>
<th align="left">n</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">PA_dnorm_01</td>
<td align="left">0.054</td>
<td align="left">&lt; 0.001</td>
<td align="left">0.012</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">paminLastweek</td>
<td align="left">0.005</td>
<td align="left">&lt; 0.001</td>
<td align="left">0.011</td>
<td align="left">1082</td>
</tr>
<tr class="odd">
<td align="left">PA_integrated</td>
<td align="left">0.082</td>
<td align="left">&lt; 0.001</td>
<td align="left">0.008</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">PA_autonomous</td>
<td align="left">0.073</td>
<td align="left">0.005</td>
<td align="left">0.006</td>
<td align="left">1078</td>
</tr>
<tr class="odd">
<td align="left">PA_intrinsic</td>
<td align="left">0.071</td>
<td align="left">0.009</td>
<td align="left">0.006</td>
<td align="left">1074</td>
</tr>
<tr class="even">
<td align="left">pafreqUsually</td>
<td align="left">0.069</td>
<td align="left">0.023</td>
<td align="left">0.005</td>
<td align="left">1082</td>
</tr>
<tr class="odd">
<td align="left">PA_dnorm</td>
<td align="left">0.052</td>
<td align="left">0.005</td>
<td align="left">0.004</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">pahrsUsually</td>
<td align="left">0.051</td>
<td align="left">0.033</td>
<td align="left">0.004</td>
<td align="left">1082</td>
</tr>
<tr class="odd">
<td align="left">PA_inorm</td>
<td align="left">&lt; 0.001</td>
<td align="left">0.006</td>
<td align="left">0.003</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">PA_inorm_01</td>
<td align="left">&lt; 0.001</td>
<td align="left">0.006</td>
<td align="left">0.003</td>
<td align="left">1073</td>
</tr>
<tr class="odd">
<td align="left">PA_outcomeExpectations</td>
<td align="left">0.024</td>
<td align="left">0.029</td>
<td align="left">0.003</td>
<td align="left">1078</td>
</tr>
<tr class="even">
<td align="left">PA_actCop</td>
<td align="left">0.036</td>
<td align="left">0.006</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="odd">
<td align="left">PA_actionplan</td>
<td align="left">0.031</td>
<td align="left">0.013</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">PA_actplan_01</td>
<td align="left">0.033</td>
<td align="left">0.006</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="odd">
<td align="left">PA_actplan_02</td>
<td align="left">0.018</td>
<td align="left">0.015</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">PA_actplan_03</td>
<td align="left">0.02</td>
<td align="left">0.021</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="odd">
<td align="left">PA_actplan_04</td>
<td align="left">0.038</td>
<td align="left">0.008</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">PA_controlled</td>
<td align="left">0.051</td>
<td align="left">0.004</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="odd">
<td align="left">PA_copingplan</td>
<td align="left">0.034</td>
<td align="left">&lt; 0.001</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">PA_copplan_01</td>
<td align="left">0.022</td>
<td align="left">&lt; 0.001</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="odd">
<td align="left">PA_copplan_02</td>
<td align="left">0.015</td>
<td align="left">&lt; 0.001</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">PA_copplan_03</td>
<td align="left">0.034</td>
<td align="left">0.011</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="odd">
<td align="left">PA_copplan_04</td>
<td align="left">0.033</td>
<td align="left">0.01</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">PA_dnorm_02</td>
<td align="left">0.023</td>
<td align="left">0.013</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="odd">
<td align="left">PA_identified</td>
<td align="left">0.044</td>
<td align="left">0.006</td>
<td align="left">&lt; 0.001</td>
<td align="left">1074</td>
</tr>
<tr class="even">
<td align="left">PA_intention</td>
<td align="left">0.064</td>
<td align="left">0.039</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="odd">
<td align="left">PA_intention_01</td>
<td align="left">0.061</td>
<td align="left">0.027</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">PA_intention_02</td>
<td align="left">0.064</td>
<td align="left">0.044</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="odd">
<td align="left">PA_introjected</td>
<td align="left">0.001</td>
<td align="left">&lt; 0.001</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">PA_opportunities</td>
<td align="left">&lt; 0.001</td>
<td align="left">0.018</td>
<td align="left">&lt; 0.001</td>
<td align="left">1075</td>
</tr>
<tr class="odd">
<td align="left">padaysLastweek</td>
<td align="left">0.04</td>
<td align="left">0.006</td>
<td align="left">&lt; 0.001</td>
<td align="left">1082</td>
</tr>
<tr class="even">
<td align="left">pahrsLastweek</td>
<td align="left">0.036</td>
<td align="left">0.004</td>
<td align="left">&lt; 0.001</td>
<td align="left">1082</td>
</tr>
<tr class="odd">
<td align="left">paLastweek</td>
<td align="left">0.037</td>
<td align="left">0.004</td>
<td align="left">&lt; 0.001</td>
<td align="left">1082</td>
</tr>
<tr class="even">
<td align="left">symptom</td>
<td align="left">0.066</td>
<td align="left">0.013</td>
<td align="left">&lt; 0.001</td>
<td align="left">1084</td>
</tr>
</tbody>
</table>
</div>
<div id="top-20-items-sorted-by-classroom" class="section level3">
<h3>Top 20 items, sorted by classroom</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
vardatatable_containing_edutrack <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(Variable, <span class="st">`</span><span class="dt">ICC educational track</span><span class="st">`</span>, <span class="st">`</span><span class="dt">ICC class</span><span class="st">`</span>, <span class="st">`</span><span class="dt">ICC school</span><span class="st">`</span>, n) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">arrange</span>(<span class="kw">desc</span>(<span class="st">`</span><span class="dt">ICC class</span><span class="st">`</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">top_n</span>(<span class="dv">20</span>) <span class="op">%&gt;%</span><span class="st"> </span>papaja<span class="op">::</span><span class="kw">apa_table</span>(<span class="dt">caption =</span> <span class="st">&quot;Intra-class correlations sorted by classroom ICC&quot;</span>,
        <span class="dt">format.args =</span> <span class="kw">list</span>(<span class="dt">digits =</span> <span class="kw">c</span>(<span class="dv">0</span>), <span class="dt">margin =</span> <span class="dv">2</span>))
## Selecting by n</code></pre></div>
<caption>
(#tab:icc-school-class-track-sortbyclass)
</caption>
<caption>
<em>Intra-class correlations sorted by classroom ICC</em>
</caption>
<table>
<thead>
<tr class="header">
<th align="left">Variable</th>
<th align="left">ICC educational track</th>
<th align="left">ICC class</th>
<th align="left">ICC school</th>
<th align="left">n</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">PA_intention_02</td>
<td align="left">0.064</td>
<td align="left">0.044</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">PA_intention</td>
<td align="left">0.064</td>
<td align="left">0.039</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="odd">
<td align="left">pahrsUsually</td>
<td align="left">0.051</td>
<td align="left">0.033</td>
<td align="left">0.004</td>
<td align="left">1082</td>
</tr>
<tr class="even">
<td align="left">PA_outcomeExpectations</td>
<td align="left">0.024</td>
<td align="left">0.029</td>
<td align="left">0.003</td>
<td align="left">1078</td>
</tr>
<tr class="odd">
<td align="left">PA_intention_01</td>
<td align="left">0.061</td>
<td align="left">0.027</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">pafreqUsually</td>
<td align="left">0.069</td>
<td align="left">0.023</td>
<td align="left">0.005</td>
<td align="left">1082</td>
</tr>
<tr class="odd">
<td align="left">PA_actplan_03</td>
<td align="left">0.02</td>
<td align="left">0.021</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">PA_opportunities</td>
<td align="left">&lt; 0.001</td>
<td align="left">0.018</td>
<td align="left">&lt; 0.001</td>
<td align="left">1075</td>
</tr>
<tr class="odd">
<td align="left">PA_actplan_02</td>
<td align="left">0.018</td>
<td align="left">0.015</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">PA_actionplan</td>
<td align="left">0.031</td>
<td align="left">0.013</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="odd">
<td align="left">PA_dnorm_02</td>
<td align="left">0.023</td>
<td align="left">0.013</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">symptom</td>
<td align="left">0.066</td>
<td align="left">0.013</td>
<td align="left">&lt; 0.001</td>
<td align="left">1084</td>
</tr>
<tr class="odd">
<td align="left">PA_copplan_03</td>
<td align="left">0.034</td>
<td align="left">0.011</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">PA_copplan_04</td>
<td align="left">0.033</td>
<td align="left">0.01</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="odd">
<td align="left">PA_intrinsic</td>
<td align="left">0.071</td>
<td align="left">0.009</td>
<td align="left">0.006</td>
<td align="left">1074</td>
</tr>
<tr class="even">
<td align="left">PA_actplan_04</td>
<td align="left">0.038</td>
<td align="left">0.008</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="odd">
<td align="left">PA_actCop</td>
<td align="left">0.036</td>
<td align="left">0.006</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">PA_actplan_01</td>
<td align="left">0.033</td>
<td align="left">0.006</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="odd">
<td align="left">PA_identified</td>
<td align="left">0.044</td>
<td align="left">0.006</td>
<td align="left">&lt; 0.001</td>
<td align="left">1074</td>
</tr>
<tr class="even">
<td align="left">PA_inorm</td>
<td align="left">&lt; 0.001</td>
<td align="left">0.006</td>
<td align="left">0.003</td>
<td align="left">1073</td>
</tr>
<tr class="odd">
<td align="left">PA_inorm_01</td>
<td align="left">&lt; 0.001</td>
<td align="left">0.006</td>
<td align="left">0.003</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">padaysLastweek</td>
<td align="left">0.04</td>
<td align="left">0.006</td>
<td align="left">&lt; 0.001</td>
<td align="left">1082</td>
</tr>
<tr class="odd">
<td align="left">PA_autonomous</td>
<td align="left">0.073</td>
<td align="left">0.005</td>
<td align="left">0.006</td>
<td align="left">1078</td>
</tr>
<tr class="even">
<td align="left">PA_dnorm</td>
<td align="left">0.052</td>
<td align="left">0.005</td>
<td align="left">0.004</td>
<td align="left">1073</td>
</tr>
<tr class="odd">
<td align="left">PA_controlled</td>
<td align="left">0.051</td>
<td align="left">0.004</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">pahrsLastweek</td>
<td align="left">0.036</td>
<td align="left">0.004</td>
<td align="left">&lt; 0.001</td>
<td align="left">1082</td>
</tr>
<tr class="odd">
<td align="left">paLastweek</td>
<td align="left">0.037</td>
<td align="left">0.004</td>
<td align="left">&lt; 0.001</td>
<td align="left">1082</td>
</tr>
<tr class="even">
<td align="left">PA_copingplan</td>
<td align="left">0.034</td>
<td align="left">&lt; 0.001</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="odd">
<td align="left">PA_copplan_01</td>
<td align="left">0.022</td>
<td align="left">&lt; 0.001</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">PA_copplan_02</td>
<td align="left">0.015</td>
<td align="left">&lt; 0.001</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="odd">
<td align="left">PA_dnorm_01</td>
<td align="left">0.054</td>
<td align="left">&lt; 0.001</td>
<td align="left">0.012</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">PA_integrated</td>
<td align="left">0.082</td>
<td align="left">&lt; 0.001</td>
<td align="left">0.008</td>
<td align="left">1073</td>
</tr>
<tr class="odd">
<td align="left">PA_introjected</td>
<td align="left">0.001</td>
<td align="left">&lt; 0.001</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">paminLastweek</td>
<td align="left">0.005</td>
<td align="left">&lt; 0.001</td>
<td align="left">0.011</td>
<td align="left">1082</td>
</tr>
</tbody>
</table>
</div>
<div id="top-20-items-sorted-by-educational-track" class="section level3">
<h3>Top 20 items, sorted by educational track</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
vardatatable_containing_edutrack <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(Variable, <span class="st">`</span><span class="dt">ICC educational track</span><span class="st">`</span>, <span class="st">`</span><span class="dt">ICC class</span><span class="st">`</span>, <span class="st">`</span><span class="dt">ICC school</span><span class="st">`</span>, n) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">arrange</span>(<span class="kw">desc</span>(<span class="st">`</span><span class="dt">ICC educational track</span><span class="st">`</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">top_n</span>(<span class="dv">20</span>) <span class="op">%&gt;%</span><span class="st"> </span>papaja<span class="op">::</span><span class="kw">apa_table</span>(<span class="dt">caption =</span> <span class="st">&quot;Intra-class correlations sorted by educational track ICC&quot;</span>,
        <span class="dt">format.args =</span> <span class="kw">list</span>(<span class="dt">digits =</span> <span class="kw">c</span>(<span class="dv">0</span>), <span class="dt">margin =</span> <span class="dv">2</span>))
## Selecting by n</code></pre></div>
<caption>
(#tab:icc-school-class-track-sortbytrack)
</caption>
<caption>
<em>Intra-class correlations sorted by educational track ICC</em>
</caption>
<table>
<thead>
<tr class="header">
<th align="left">Variable</th>
<th align="left">ICC educational track</th>
<th align="left">ICC class</th>
<th align="left">ICC school</th>
<th align="left">n</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">PA_integrated</td>
<td align="left">0.082</td>
<td align="left">&lt; 0.001</td>
<td align="left">0.008</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">PA_autonomous</td>
<td align="left">0.073</td>
<td align="left">0.005</td>
<td align="left">0.006</td>
<td align="left">1078</td>
</tr>
<tr class="odd">
<td align="left">PA_intrinsic</td>
<td align="left">0.071</td>
<td align="left">0.009</td>
<td align="left">0.006</td>
<td align="left">1074</td>
</tr>
<tr class="even">
<td align="left">pafreqUsually</td>
<td align="left">0.069</td>
<td align="left">0.023</td>
<td align="left">0.005</td>
<td align="left">1082</td>
</tr>
<tr class="odd">
<td align="left">symptom</td>
<td align="left">0.066</td>
<td align="left">0.013</td>
<td align="left">&lt; 0.001</td>
<td align="left">1084</td>
</tr>
<tr class="even">
<td align="left">PA_intention</td>
<td align="left">0.064</td>
<td align="left">0.039</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="odd">
<td align="left">PA_intention_02</td>
<td align="left">0.064</td>
<td align="left">0.044</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">PA_intention_01</td>
<td align="left">0.061</td>
<td align="left">0.027</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="odd">
<td align="left">PA_dnorm_01</td>
<td align="left">0.054</td>
<td align="left">&lt; 0.001</td>
<td align="left">0.012</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">PA_dnorm</td>
<td align="left">0.052</td>
<td align="left">0.005</td>
<td align="left">0.004</td>
<td align="left">1073</td>
</tr>
<tr class="odd">
<td align="left">PA_controlled</td>
<td align="left">0.051</td>
<td align="left">0.004</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">pahrsUsually</td>
<td align="left">0.051</td>
<td align="left">0.033</td>
<td align="left">0.004</td>
<td align="left">1082</td>
</tr>
<tr class="odd">
<td align="left">PA_identified</td>
<td align="left">0.044</td>
<td align="left">0.006</td>
<td align="left">&lt; 0.001</td>
<td align="left">1074</td>
</tr>
<tr class="even">
<td align="left">padaysLastweek</td>
<td align="left">0.04</td>
<td align="left">0.006</td>
<td align="left">&lt; 0.001</td>
<td align="left">1082</td>
</tr>
<tr class="odd">
<td align="left">PA_actplan_04</td>
<td align="left">0.038</td>
<td align="left">0.008</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">paLastweek</td>
<td align="left">0.037</td>
<td align="left">0.004</td>
<td align="left">&lt; 0.001</td>
<td align="left">1082</td>
</tr>
<tr class="odd">
<td align="left">PA_actCop</td>
<td align="left">0.036</td>
<td align="left">0.006</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">pahrsLastweek</td>
<td align="left">0.036</td>
<td align="left">0.004</td>
<td align="left">&lt; 0.001</td>
<td align="left">1082</td>
</tr>
<tr class="odd">
<td align="left">PA_copingplan</td>
<td align="left">0.034</td>
<td align="left">&lt; 0.001</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">PA_copplan_03</td>
<td align="left">0.034</td>
<td align="left">0.011</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="odd">
<td align="left">PA_actplan_01</td>
<td align="left">0.033</td>
<td align="left">0.006</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">PA_copplan_04</td>
<td align="left">0.033</td>
<td align="left">0.01</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="odd">
<td align="left">PA_actionplan</td>
<td align="left">0.031</td>
<td align="left">0.013</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">PA_outcomeExpectations</td>
<td align="left">0.024</td>
<td align="left">0.029</td>
<td align="left">0.003</td>
<td align="left">1078</td>
</tr>
<tr class="odd">
<td align="left">PA_dnorm_02</td>
<td align="left">0.023</td>
<td align="left">0.013</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">PA_copplan_01</td>
<td align="left">0.022</td>
<td align="left">&lt; 0.001</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="odd">
<td align="left">PA_actplan_03</td>
<td align="left">0.02</td>
<td align="left">0.021</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">PA_actplan_02</td>
<td align="left">0.018</td>
<td align="left">0.015</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="odd">
<td align="left">PA_copplan_02</td>
<td align="left">0.015</td>
<td align="left">&lt; 0.001</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">paminLastweek</td>
<td align="left">0.005</td>
<td align="left">&lt; 0.001</td>
<td align="left">0.011</td>
<td align="left">1082</td>
</tr>
<tr class="odd">
<td align="left">PA_introjected</td>
<td align="left">0.001</td>
<td align="left">&lt; 0.001</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">PA_inorm</td>
<td align="left">&lt; 0.001</td>
<td align="left">0.006</td>
<td align="left">0.003</td>
<td align="left">1073</td>
</tr>
<tr class="odd">
<td align="left">PA_inorm_01</td>
<td align="left">&lt; 0.001</td>
<td align="left">0.006</td>
<td align="left">0.003</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">PA_opportunities</td>
<td align="left">&lt; 0.001</td>
<td align="left">0.018</td>
<td align="left">&lt; 0.001</td>
<td align="left">1075</td>
</tr>
</tbody>
</table>
<p>Model with educational track only</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#library(sjstats)</span>
<span class="co">#library(lme4)</span>

names &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>id, <span class="op">-</span>intervention, <span class="op">-</span>group, <span class="op">-</span>school, <span class="op">-</span>girl, <span class="op">-</span>track, <span class="op">-</span>trackSchool, <span class="op">-</span><span class="kw">contains</span>(<span class="st">&quot;_T3&quot;</span>), <span class="op">-</span><span class="kw">contains</span>(<span class="st">&quot;_diff&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">names</span>(.)

<span class="co"># Create empty soon-to-be-filled objects</span>
m &lt;-<span class="st"> </span><span class="ot">NA</span>
mean &lt;-<span class="st"> </span><span class="ot">NA</span>
m_p &lt;-<span class="st"> </span><span class="ot">NA</span>
ci_low &lt;-<span class="st"> </span><span class="ot">NA</span>
ci_high &lt;-<span class="st"> </span><span class="ot">NA</span>
ICC_group &lt;-<span class="st"> </span><span class="ot">NA</span>
ICC_School &lt;-<span class="st"> </span><span class="ot">NA</span>
nonmissings &lt;-<span class="st"> </span><span class="ot">NA</span>
ICC_track &lt;-<span class="st"> </span><span class="ot">NA</span>


## To test the code with a single variable:
<span class="co"># dftest &lt;- df #%&gt;% na.omit()</span>
<span class="co"># m &lt;- lme4::lmer(sitLieAccelerometer_T1 ~ (1|track), data=df)</span>
<span class="co"># mean &lt;- lme4::fixef(m)</span>
<span class="co"># m_p &lt;- profile(m)</span>
<span class="co"># ci_low &lt;- confint(m_p)[3]</span>
<span class="co"># ci_high &lt;- confint(m_p)[6]</span>
<span class="co"># ICC_group &lt;- sjstats::icc(m)[1]</span>
<span class="co"># nonmissings &lt;- length(m@resp$y)</span>

<span class="co"># Loop over each variable name, extract statistics: </span>

<span class="co"># all participants  </span>
<span class="co"># for (i in names){</span>
<span class="co"># m &lt;- lme4::lmer(paste0(i,&quot; ~ (1|track)&quot;), data=df)</span>
<span class="co"># mean[i] &lt;- lme4::fixef(m)</span>
<span class="co"># m_p &lt;- profile(m, which = &quot;beta_&quot;)</span>
<span class="co"># ci_low[i] &lt;- confint(m_p)[1]</span>
<span class="co"># ci_high[i] &lt;- confint(m_p)[2]</span>
<span class="co"># ICC_track[i] &lt;- sjstats::icc(m)[1]</span>
<span class="co"># nonmissings[i] &lt;- length(m@resp$y)</span>
<span class="co"># }</span>
<span class="co"># </span>
<span class="co"># vardatatable_edutrack_only &lt;- data_frame(</span>
<span class="co">#   Variable = stringr::str_sub(names(mean), end = -4), #remove &quot;_T1&quot; from names</span>
<span class="co">#   Mean = round(mean, 1),</span>
<span class="co">#   CI95 = paste(round(ci_low, 1), &quot;-&quot;, round(ci_high, 1)),</span>
<span class="co">#   &quot;ICC educational track&quot; = ifelse(round(ICC_track, 3) == 0, &quot;&lt; 0.001&quot;, round(ICC_track, 3)),</span>
<span class="co">#   n = nonmissings) %&gt;%</span>
<span class="co">#   dplyr::arrange(Variable) %&gt;%</span>
<span class="co">#   dplyr::filter(Variable != &quot;&quot;) #remove first row, which is empty</span>
<span class="co"># </span>
<span class="co"># save(vardatatable_edutrack_only, file = &quot;vardatatable_edutrack_only.Rdata&quot;)</span>
<span class="kw">load</span>(<span class="st">&quot;vardatatable_edutrack_only.Rdata&quot;</span>)

<span class="co"># ci_edutrack_only &lt;- data_frame(</span>
<span class="co">#   &quot;ciLo&quot; = ci_low,</span>
<span class="co">#   &quot;mean&quot; = mean,</span>
<span class="co">#   &quot;ciHi&quot; = ci_high,</span>
<span class="co">#   &quot;diamondlabels&quot; = names(mean)) %&gt;%</span>
<span class="co">#   dplyr::filter(diamondlabels != &quot;&quot;) %&gt;% #remove first row, which is empty</span>
<span class="co">#   as.data.frame()</span>
<span class="co"># </span>
<span class="co"># save(ci_edutrack_only, file = &quot;ci_edutrack_only.Rdata&quot;)</span>
<span class="kw">load</span>(<span class="st">&quot;ci_edutrack_only.Rdata&quot;</span>)</code></pre></div>
</div>
<div id="top-20-items-sorted-by-icc-educational-track" class="section level3">
<h3>Top 20 items, sorted by ICC educational track</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
vardatatable_containing_edutrack <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(Variable, <span class="st">`</span><span class="dt">ICC educational track</span><span class="st">`</span>, n) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">arrange</span>(<span class="kw">desc</span>(<span class="st">`</span><span class="dt">ICC educational track</span><span class="st">`</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">top_n</span>(<span class="dv">20</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>papaja<span class="op">::</span><span class="kw">apa_table</span>(<span class="dt">caption =</span> <span class="st">&quot;Intra-class correlations sorted by educational track ICC&quot;</span>,
        <span class="dt">format.args =</span> <span class="kw">list</span>(<span class="dt">digits =</span> <span class="kw">c</span>(<span class="dv">0</span>), <span class="dt">margin =</span> <span class="dv">2</span>))
## Selecting by n</code></pre></div>
<caption>
(#tab:icc-edu-track-only)
</caption>
<caption>
<em>Intra-class correlations sorted by educational track ICC</em>
</caption>
<table>
<thead>
<tr class="header">
<th align="left">Variable</th>
<th align="left">ICC educational track</th>
<th align="left">n</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">PA_integrated</td>
<td align="left">0.082</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">PA_autonomous</td>
<td align="left">0.073</td>
<td align="left">1078</td>
</tr>
<tr class="odd">
<td align="left">PA_intrinsic</td>
<td align="left">0.071</td>
<td align="left">1074</td>
</tr>
<tr class="even">
<td align="left">pafreqUsually</td>
<td align="left">0.069</td>
<td align="left">1082</td>
</tr>
<tr class="odd">
<td align="left">symptom</td>
<td align="left">0.066</td>
<td align="left">1084</td>
</tr>
<tr class="even">
<td align="left">PA_intention</td>
<td align="left">0.064</td>
<td align="left">1073</td>
</tr>
<tr class="odd">
<td align="left">PA_intention_02</td>
<td align="left">0.064</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">PA_intention_01</td>
<td align="left">0.061</td>
<td align="left">1073</td>
</tr>
<tr class="odd">
<td align="left">PA_dnorm_01</td>
<td align="left">0.054</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">PA_dnorm</td>
<td align="left">0.052</td>
<td align="left">1073</td>
</tr>
<tr class="odd">
<td align="left">PA_controlled</td>
<td align="left">0.051</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">pahrsUsually</td>
<td align="left">0.051</td>
<td align="left">1082</td>
</tr>
<tr class="odd">
<td align="left">PA_identified</td>
<td align="left">0.044</td>
<td align="left">1074</td>
</tr>
<tr class="even">
<td align="left">padaysLastweek</td>
<td align="left">0.04</td>
<td align="left">1082</td>
</tr>
<tr class="odd">
<td align="left">PA_actplan_04</td>
<td align="left">0.038</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">paLastweek</td>
<td align="left">0.037</td>
<td align="left">1082</td>
</tr>
<tr class="odd">
<td align="left">PA_actCop</td>
<td align="left">0.036</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">pahrsLastweek</td>
<td align="left">0.036</td>
<td align="left">1082</td>
</tr>
<tr class="odd">
<td align="left">PA_copingplan</td>
<td align="left">0.034</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">PA_copplan_03</td>
<td align="left">0.034</td>
<td align="left">1073</td>
</tr>
<tr class="odd">
<td align="left">PA_actplan_01</td>
<td align="left">0.033</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">PA_copplan_04</td>
<td align="left">0.033</td>
<td align="left">1073</td>
</tr>
<tr class="odd">
<td align="left">PA_actionplan</td>
<td align="left">0.031</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">PA_outcomeExpectations</td>
<td align="left">0.024</td>
<td align="left">1078</td>
</tr>
<tr class="odd">
<td align="left">PA_dnorm_02</td>
<td align="left">0.023</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">PA_copplan_01</td>
<td align="left">0.022</td>
<td align="left">1073</td>
</tr>
<tr class="odd">
<td align="left">PA_actplan_03</td>
<td align="left">0.02</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">PA_actplan_02</td>
<td align="left">0.018</td>
<td align="left">1073</td>
</tr>
<tr class="odd">
<td align="left">PA_copplan_02</td>
<td align="left">0.015</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">paminLastweek</td>
<td align="left">0.005</td>
<td align="left">1082</td>
</tr>
<tr class="odd">
<td align="left">PA_introjected</td>
<td align="left">0.001</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">PA_inorm</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="odd">
<td align="left">PA_inorm_01</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">PA_opportunities</td>
<td align="left">&lt; 0.001</td>
<td align="left">1075</td>
</tr>
</tbody>
</table>
<p>CIs using the sandwich estimator</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Basic instructions are from https://web.archive.org/web/20180206180739/http://thestatsgeek.com/2014/02/14/the-robust-sandwich-variance-estimator-for-linear-regression-using-r/</span>

names &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>id, <span class="op">-</span>intervention, <span class="op">-</span>group, <span class="op">-</span>school, <span class="op">-</span>girl, <span class="op">-</span>track, <span class="op">-</span>trackSchool, <span class="op">-</span><span class="kw">contains</span>(<span class="st">&quot;_T3&quot;</span>), <span class="op">-</span><span class="kw">contains</span>(<span class="st">&quot;_diff&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">names</span>(.)

<span class="co"># Create empty soon-to-be-filled objects</span>
m &lt;-<span class="st"> </span><span class="ot">NA</span>
sandwich_se &lt;-<span class="st"> </span><span class="ot">NA</span>
mean &lt;-<span class="st"> </span><span class="ot">NA</span>
ci_low &lt;-<span class="st"> </span><span class="ot">NA</span>
ci_high &lt;-<span class="st"> </span><span class="ot">NA</span>
nonmissings &lt;-<span class="st"> </span><span class="ot">NA</span>

## To test the code with a single variable:
<span class="co"># df_for_sandwich &lt;- df %&gt;% dplyr::select(group, school, track, sitLieAccelerometer_T1) %&gt;% na.omit()</span>
<span class="co"># sandwich_clusters &lt;- df_for_sandwich %&gt;% dplyr::select(group, school, track)</span>
<span class="co"># m &lt;- lm(sitLieAccelerometer_T1 ~ 1, data=df_for_sandwich)</span>
<span class="co"># sandwich_se &lt;- diag(sandwich::vcovCL(m, type = &quot;HC1&quot;, cluster = sandwich_clusters))^0.5</span>
<span class="co"># mean &lt;- m$coefficients[[1]]</span>
<span class="co"># ci_low &lt;- coef(m) - 1.96 * sandwich_se</span>
<span class="co"># ci_high &lt;- coef(m) + 1.96 * sandwich_se</span>
<span class="co"># nonmissings &lt;- nrow(m$model)</span>


<span class="co"># # Loop over each variable name, extract statistics:</span>
<span class="co"># for (i in names){</span>
<span class="co"># df_for_sandwich &lt;- df %&gt;% dplyr::select(</span>
<span class="co">#   group, school, track, i) %&gt;%</span>
<span class="co">#   na.omit()</span>
<span class="co"># sandwich_clusters &lt;- df_for_sandwich %&gt;% dplyr::select(group, school, track)</span>
<span class="co"># m &lt;- lm(paste0(i,&quot; ~ 1&quot;), data = df_for_sandwich)</span>
<span class="co"># sandwich_se &lt;- diag(sandwich::vcovCL(m, type = &quot;HC1&quot;, cluster = sandwich_clusters))^0.5</span>
<span class="co"># mean[i] &lt;- m$coefficients[[1]]</span>
<span class="co"># ci_low[i] &lt;- coef(m) - 1.96 * sandwich_se</span>
<span class="co"># ci_high[i] &lt;- coef(m) + 1.96 * sandwich_se</span>
<span class="co"># nonmissings[i] &lt;- nrow(m$model)</span>
<span class="co"># }</span>
<span class="co"># </span>
<span class="co"># vardatatable_sandwich &lt;- data_frame(</span>
<span class="co">#   Variable = stringr::str_sub(names(mean), end = -4), #remove &quot;_T1&quot; from names</span>
<span class="co">#   Mean = round(mean, 1),</span>
<span class="co">#   CI95 = paste(round(ci_low, 1), &quot;-&quot;, round(ci_high, 1)),</span>
<span class="co">#   n = nonmissings) %&gt;%</span>
<span class="co">#   dplyr::arrange(Variable) %&gt;%</span>
<span class="co">#   dplyr::filter(Variable != &quot;&quot;) #remove first row, which is empty</span>
<span class="co"># </span>
<span class="co"># save(vardatatable_sandwich, file = &quot;vardatatable_sandwich.Rdata&quot;)</span>
<span class="kw">load</span>(<span class="st">&quot;vardatatable_sandwich.Rdata&quot;</span>)

<span class="co"># ci_sandwich &lt;- data_frame(</span>
<span class="co">#   &quot;ciLo&quot; = ci_low,</span>
<span class="co">#   &quot;mean&quot; = mean,</span>
<span class="co">#   &quot;ciHi&quot; = ci_high,</span>
<span class="co">#   &quot;diamondlabels&quot; = names(mean)) %&gt;%</span>
<span class="co">#   dplyr::filter(diamondlabels != &quot;&quot;) %&gt;% #remove first row, which is empty</span>
<span class="co">#   as.data.frame()</span>
<span class="co"># </span>
<span class="co"># save(ci_sandwich, file = &quot;ci_sandwich.Rdata&quot;)</span>
<span class="kw">load</span>(<span class="st">&quot;ci_sandwich.Rdata&quot;</span>)</code></pre></div>
<p>Observed means and CIs, without clustering</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
df_for_uncorrected &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>id, <span class="op">-</span>intervention, <span class="op">-</span>group, <span class="op">-</span>school, <span class="op">-</span>girl, <span class="op">-</span>track, <span class="op">-</span>trackSchool, <span class="op">-</span><span class="kw">contains</span>(<span class="st">&quot;_T3&quot;</span>), <span class="op">-</span><span class="kw">contains</span>(<span class="st">&quot;_diff&quot;</span>))

<span class="co"># Create empty soon-to-be-filled objects</span>
mean_uncorrected &lt;-<span class="st"> </span><span class="ot">NA</span>
ci_low &lt;-<span class="st"> </span><span class="ot">NA</span>
ci_high &lt;-<span class="st"> </span><span class="ot">NA</span>
nonmissings &lt;-<span class="st"> </span><span class="ot">NA</span>

ci_uncorrected &lt;-<span class="st"> </span><span class="kw">rbind</span>(
  df_for_uncorrected <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">summarise_all</span>(<span class="kw">funs</span>(<span class="kw">t.test</span>(.)<span class="op">$</span>conf.int[<span class="dv">1</span>])),
  df_for_uncorrected <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">summarise_all</span>(<span class="kw">funs</span>(<span class="kw">mean</span>(., <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))),
  df_for_uncorrected <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">summarise_all</span>(<span class="kw">funs</span>(<span class="kw">t.test</span>(.)<span class="op">$</span>conf.int[<span class="dv">2</span>]))) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">t</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>data.frame

<span class="kw">names</span>(ci_uncorrected) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;ciLo&quot;</span>, <span class="st">&quot;mean&quot;</span>, <span class="st">&quot;ciHi&quot;</span>)</code></pre></div>
</div>
</div>
</div>
<div id="compare-mean--and-ci-estimates-visually" class="section level1">
<h1>Compare mean- and CI-estimates visually</h1>
<p>This section contains diamond plots comparing different estimates for means and CIs.</p>
<div id="high-mean-variables" class="section level2">
<h2>High-mean variables</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ci_total_big &lt;-<span class="st"> </span>ci_total <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(mean <span class="op">&gt;</span><span class="st"> </span><span class="dv">10</span>)
ci_edutrack_big &lt;-<span class="st"> </span>ci_edutrack <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(mean <span class="op">&gt;</span><span class="st"> </span><span class="dv">10</span>)
ci_uncorrected_big &lt;-<span class="st"> </span>ci_uncorrected <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(mean <span class="op">&gt;</span><span class="st"> </span><span class="dv">10</span>)
ci_sandwich_big &lt;-<span class="st"> </span>ci_sandwich <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(mean <span class="op">&gt;</span><span class="st"> </span><span class="dv">10</span>)


<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>){
plot1 &lt;-<span class="st"> </span>userfriendlyscience<span class="op">::</span><span class="kw">diamondPlot</span>(ci_total_big[i, ], 
                                          <span class="dt">color =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>)[<span class="dv">1</span>], 
                                          <span class="dt">alpha=</span>.<span class="dv">15</span>, 
                                          <span class="dt">yLabels =</span> ci_total_big[i, ]<span class="op">$</span>diamondlabels, 
                                          <span class="dt">fixedSize =</span> <span class="fl">0.3</span>, 
                                          <span class="dt">xlab =</span> <span class="ot">NULL</span>) <span class="op">+</span>
<span class="st">  </span>userfriendlyscience<span class="op">::</span><span class="kw">diamondPlot</span>(ci_edutrack_big[i, ], 
                                   <span class="dt">returnLayerOnly =</span> <span class="ot">TRUE</span>,
                                   <span class="dt">color =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>)[<span class="dv">2</span>], 
                                   <span class="dt">alpha=</span>.<span class="dv">15</span>, 
                                   <span class="dt">yLabels =</span> ci_edutrack_big[i, ]<span class="op">$</span>diamondlabels, 
                                   <span class="dt">fixedSize =</span> <span class="fl">0.5</span>, 
                                   <span class="dt">xlab =</span> <span class="ot">NULL</span>) <span class="op">+</span>
<span class="st">  </span>userfriendlyscience<span class="op">::</span><span class="kw">diamondPlot</span>(ci_uncorrected_big[i, ], 
                                   <span class="dt">returnLayerOnly =</span> <span class="ot">TRUE</span>,
                                   <span class="dt">color =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>)[<span class="dv">3</span>], 
                                   <span class="dt">alpha=</span>.<span class="dv">15</span>, 
                                   <span class="dt">yLabels =</span> ci_uncorrected_big[i, ]<span class="op">$</span>diamondlabels, 
                                   <span class="dt">fixedSize =</span> <span class="fl">0.3</span>, 
                                   <span class="dt">xlab =</span> <span class="ot">NULL</span>) <span class="op">+</span>
<span class="st">  </span>userfriendlyscience<span class="op">::</span><span class="kw">diamondPlot</span>(ci_sandwich_big[i, ], 
                                   <span class="dt">returnLayerOnly =</span> <span class="ot">TRUE</span>,
                                   <span class="dt">color =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>)[<span class="dv">4</span>], 
                                   <span class="dt">alpha=</span>.<span class="dv">15</span>, 
                                   <span class="dt">yLabels =</span> ci_uncorrected_big[i, ]<span class="op">$</span>diamondlabels, 
                                   <span class="dt">fixedSize =</span> <span class="fl">0.3</span>, 
                                   <span class="dt">xlab =</span> <span class="ot">NULL</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_rect</span>(<span class="kw">aes</span>(<span class="dt">xmin=</span><span class="ot">Inf</span>, <span class="dt">xmax=</span><span class="ot">Inf</span>, <span class="dt">ymin=</span><span class="ot">Inf</span>, <span class="dt">ymax=</span><span class="ot">Inf</span>, <span class="dt">fill =</span> <span class="st">&quot;Classroom &amp; school&quot;</span>), 
            <span class="dt">colour=</span><span class="ot">NA</span>, <span class="dt">alpha=</span><span class="fl">0.05</span>) <span class="op">+</span><span class="st"> </span><span class="co"># Create invisible rectangle for legend</span>
<span class="st">  </span><span class="kw">geom_rect</span>(<span class="kw">aes</span>(<span class="dt">xmin=</span><span class="ot">Inf</span>, <span class="dt">xmax=</span><span class="ot">Inf</span>, <span class="dt">ymin=</span><span class="ot">Inf</span>, <span class="dt">ymax=</span><span class="ot">Inf</span>, <span class="dt">fill =</span> <span class="st">&quot;Classroom, school &amp; track&quot;</span>), 
            <span class="dt">colour=</span><span class="ot">NA</span>, <span class="dt">alpha=</span><span class="fl">0.05</span>) <span class="op">+</span><span class="st"> </span><span class="co"># Create invisible rectangle for legend</span>
<span class="st">  </span><span class="kw">geom_rect</span>(<span class="kw">aes</span>(<span class="dt">xmin=</span><span class="ot">Inf</span>, <span class="dt">xmax=</span><span class="ot">Inf</span>, <span class="dt">ymin=</span><span class="ot">Inf</span>, <span class="dt">ymax=</span><span class="ot">Inf</span>, <span class="dt">fill =</span> <span class="st">&quot;Uncorrected&quot;</span>), 
            <span class="dt">colour=</span><span class="ot">NA</span>, <span class="dt">alpha=</span><span class="fl">0.05</span>) <span class="op">+</span><span class="st"> </span><span class="co"># Create invisible rectangle for legend</span>
<span class="st">  </span><span class="kw">geom_rect</span>(<span class="kw">aes</span>(<span class="dt">xmin=</span><span class="ot">Inf</span>, <span class="dt">xmax=</span><span class="ot">Inf</span>, <span class="dt">ymin=</span><span class="ot">Inf</span>, <span class="dt">ymax=</span><span class="ot">Inf</span>, <span class="dt">fill =</span> <span class="st">&quot;Sandwich&quot;</span>), 
            <span class="dt">colour=</span><span class="ot">NA</span>, <span class="dt">alpha=</span><span class="fl">0.05</span>) <span class="op">+</span><span class="st"> </span><span class="co"># Create invisible rectangle for legend</span>
<span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="st">&#39;Model&#39;</span>,
                    <span class="dt">values =</span> <span class="kw">c</span>(viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>)[<span class="dv">1</span>], 
                               viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>)[<span class="dv">2</span>], 
                               viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>)[<span class="dv">4</span>], 
                               viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>)[<span class="dv">3</span>]),
                    <span class="dt">guide =</span> <span class="kw">guide_legend</span>(<span class="dt">override.aes =</span> <span class="kw">list</span>(<span class="dt">alpha =</span> <span class="dv">1</span>), <span class="dt">ncol =</span> <span class="dv">2</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">&quot;right&quot;</span>) 
  <span class="kw">plot</span>(plot1)
}</code></pre></div>
<p><img src="baseline-supplement_files/figure-html/parameter-comparison-highmean-plots-1.png" width="672" /><img src="baseline-supplement_files/figure-html/parameter-comparison-highmean-plots-2.png" width="672" /><img src="baseline-supplement_files/figure-html/parameter-comparison-highmean-plots-3.png" width="672" /><img src="baseline-supplement_files/figure-html/parameter-comparison-highmean-plots-4.png" width="672" /></p>
</div>
<div id="other-variables" class="section level2">
<h2>Other variables</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Take the high-mean variables out, because otherwise you&#39;d have something with a mean of 200 </span>
<span class="co"># and a mean of 2 in the same plot, and scaling of the x-axis would smudge differences between the</span>
<span class="co"># diamonds, which indicate the estimates</span>

ci_total_small &lt;-<span class="st"> </span>ci_total <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(mean <span class="op">&lt;=</span><span class="st"> </span><span class="dv">10</span>)
ci_edutrack_small &lt;-<span class="st"> </span>ci_edutrack <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(mean <span class="op">&lt;=</span><span class="st"> </span><span class="dv">10</span>)
ci_uncorrected_small &lt;-<span class="st"> </span>ci_uncorrected <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(mean <span class="op">&lt;=</span><span class="st"> </span><span class="dv">10</span>)
ci_sandwich_small &lt;-<span class="st"> </span>ci_sandwich <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(mean <span class="op">&lt;=</span><span class="st"> </span><span class="dv">10</span>)

<span class="co"># Now, four data frames contain columns ciLo, mean, ciHi, and variable name, for each variable (i.e. row).</span>
<span class="co"># Make a diamondPlot layer from each of these data frames, so that i number of variables are in the same plot: </span>

<span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">c</span>(<span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">1</span>, <span class="dt">to =</span> <span class="dv">171</span>, <span class="dt">by =</span> <span class="dv">8</span>))) {
plot1 &lt;-<span class="st"> </span>userfriendlyscience<span class="op">::</span><span class="kw">diamondPlot</span>(ci_total_small[i<span class="op">:</span>(i <span class="op">+</span><span class="st"> </span><span class="dv">8</span>), ], 
                                          <span class="dt">color =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>)[<span class="dv">1</span>], 
                                          <span class="dt">alpha=</span>.<span class="dv">15</span>, 
                                          <span class="dt">yLabels =</span> ci_total_small[i<span class="op">:</span>(i <span class="op">+</span><span class="st"> </span><span class="dv">8</span>), ]<span class="op">$</span>diamondlabels, 
                                          <span class="dt">fixedSize =</span> <span class="fl">0.3</span>, 
                                          <span class="dt">xlab =</span> <span class="ot">NULL</span>) <span class="op">+</span>
<span class="st">  </span>userfriendlyscience<span class="op">::</span><span class="kw">diamondPlot</span>(ci_edutrack_small[i<span class="op">:</span>(i <span class="op">+</span><span class="st"> </span><span class="dv">8</span>), ], 
                                   <span class="dt">returnLayerOnly =</span> <span class="ot">TRUE</span>,
                                   <span class="dt">color =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>)[<span class="dv">2</span>], 
                                   <span class="dt">alpha=</span>.<span class="dv">15</span>, 
                                   <span class="dt">yLabels =</span> ci_edutrack_small[i<span class="op">:</span>(i <span class="op">+</span><span class="st"> </span><span class="dv">8</span>), ]<span class="op">$</span>diamondlabels, 
                                   <span class="dt">fixedSize =</span> <span class="fl">0.5</span>, 
                                   <span class="dt">xlab =</span> <span class="ot">NULL</span>) <span class="op">+</span>
<span class="st">  </span>userfriendlyscience<span class="op">::</span><span class="kw">diamondPlot</span>(ci_uncorrected_small[i<span class="op">:</span>(i <span class="op">+</span><span class="st"> </span><span class="dv">8</span>), ], 
                                   <span class="dt">returnLayerOnly =</span> <span class="ot">TRUE</span>,
                                   <span class="dt">color =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>)[<span class="dv">3</span>], 
                                   <span class="dt">alpha=</span>.<span class="dv">15</span>, 
                                   <span class="dt">yLabels =</span> ci_uncorrected_small[i<span class="op">:</span>(i <span class="op">+</span><span class="st"> </span><span class="dv">8</span>), ]<span class="op">$</span>diamondlabels, 
                                   <span class="dt">fixedSize =</span> <span class="fl">0.3</span>, 
                                   <span class="dt">xlab =</span> <span class="ot">NULL</span>) <span class="op">+</span>
<span class="st">  </span>userfriendlyscience<span class="op">::</span><span class="kw">diamondPlot</span>(ci_sandwich_small[i<span class="op">:</span>(i <span class="op">+</span><span class="st"> </span><span class="dv">8</span>), ], 
                                   <span class="dt">returnLayerOnly =</span> <span class="ot">TRUE</span>,
                                   <span class="dt">color =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>)[<span class="dv">4</span>], 
                                   <span class="dt">alpha=</span>.<span class="dv">15</span>, 
                                   <span class="dt">yLabels =</span> ci_uncorrected_small[i<span class="op">:</span>(i <span class="op">+</span><span class="st"> </span><span class="dv">8</span>), ]<span class="op">$</span>diamondlabels, 
                                   <span class="dt">fixedSize =</span> <span class="fl">0.3</span>, 
                                   <span class="dt">xlab =</span> <span class="ot">NULL</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_rect</span>(<span class="kw">aes</span>(<span class="dt">xmin=</span><span class="ot">Inf</span>, <span class="dt">xmax=</span><span class="ot">Inf</span>, <span class="dt">ymin=</span><span class="ot">Inf</span>, <span class="dt">ymax=</span><span class="ot">Inf</span>, <span class="dt">fill =</span> <span class="st">&quot;Classroom &amp; school&quot;</span>), 
            <span class="dt">colour=</span><span class="ot">NA</span>, <span class="dt">alpha=</span><span class="fl">0.05</span>) <span class="op">+</span><span class="st"> </span><span class="co"># Create invisible rectangle for legend</span>
<span class="st">  </span><span class="kw">geom_rect</span>(<span class="kw">aes</span>(<span class="dt">xmin=</span><span class="ot">Inf</span>, <span class="dt">xmax=</span><span class="ot">Inf</span>, <span class="dt">ymin=</span><span class="ot">Inf</span>, <span class="dt">ymax=</span><span class="ot">Inf</span>, <span class="dt">fill =</span> <span class="st">&quot;Classroom, school &amp; track&quot;</span>), 
            <span class="dt">colour=</span><span class="ot">NA</span>, <span class="dt">alpha=</span><span class="fl">0.05</span>) <span class="op">+</span><span class="st"> </span><span class="co"># Create invisible rectangle for legend</span>
<span class="st">  </span><span class="kw">geom_rect</span>(<span class="kw">aes</span>(<span class="dt">xmin=</span><span class="ot">Inf</span>, <span class="dt">xmax=</span><span class="ot">Inf</span>, <span class="dt">ymin=</span><span class="ot">Inf</span>, <span class="dt">ymax=</span><span class="ot">Inf</span>, <span class="dt">fill =</span> <span class="st">&quot;Uncorrected&quot;</span>), 
            <span class="dt">colour=</span><span class="ot">NA</span>, <span class="dt">alpha=</span><span class="fl">0.05</span>) <span class="op">+</span><span class="st"> </span><span class="co"># Create invisible rectangle for legend</span>
<span class="st">  </span><span class="kw">geom_rect</span>(<span class="kw">aes</span>(<span class="dt">xmin=</span><span class="ot">Inf</span>, <span class="dt">xmax=</span><span class="ot">Inf</span>, <span class="dt">ymin=</span><span class="ot">Inf</span>, <span class="dt">ymax=</span><span class="ot">Inf</span>, <span class="dt">fill =</span> <span class="st">&quot;Sandwich&quot;</span>), 
            <span class="dt">colour=</span><span class="ot">NA</span>, <span class="dt">alpha=</span><span class="fl">0.05</span>) <span class="op">+</span><span class="st"> </span><span class="co"># Create invisible rectangle for legend</span>
<span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="st">&#39;Model: &#39;</span>,
                    <span class="dt">values =</span> <span class="kw">c</span>(viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>)[<span class="dv">1</span>], 
                               viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>)[<span class="dv">2</span>], 
                               viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>)[<span class="dv">4</span>], 
                               viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>)[<span class="dv">3</span>]),
                    <span class="dt">guide =</span> <span class="kw">guide_legend</span>(<span class="dt">override.aes =</span> <span class="kw">list</span>(<span class="dt">alpha =</span> <span class="dv">1</span>), <span class="dt">ncol =</span> <span class="dv">2</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">&quot;bottom&quot;</span>) 
<span class="co">#  cat(&#39;\n\n####&#39;, i, &#39;\n\n  &#39;) </span>
  <span class="kw">print</span>(plot1)
}</code></pre></div>
<p><img src="baseline-supplement_files/figure-html/estimates%20for%20other%20variables-1.png" width="672" /><img src="baseline-supplement_files/figure-html/estimates%20for%20other%20variables-2.png" width="672" /><img src="baseline-supplement_files/figure-html/estimates%20for%20other%20variables-3.png" width="672" /><img src="baseline-supplement_files/figure-html/estimates%20for%20other%20variables-4.png" width="672" /><img src="baseline-supplement_files/figure-html/estimates%20for%20other%20variables-5.png" width="672" /><img src="baseline-supplement_files/figure-html/estimates%20for%20other%20variables-6.png" width="672" /><img src="baseline-supplement_files/figure-html/estimates%20for%20other%20variables-7.png" width="672" /><img src="baseline-supplement_files/figure-html/estimates%20for%20other%20variables-8.png" width="672" /><img src="baseline-supplement_files/figure-html/estimates%20for%20other%20variables-9.png" width="672" /><img src="baseline-supplement_files/figure-html/estimates%20for%20other%20variables-10.png" width="672" /><img src="baseline-supplement_files/figure-html/estimates%20for%20other%20variables-11.png" width="672" /><img src="baseline-supplement_files/figure-html/estimates%20for%20other%20variables-12.png" width="672" /><img src="baseline-supplement_files/figure-html/estimates%20for%20other%20variables-13.png" width="672" /><img src="baseline-supplement_files/figure-html/estimates%20for%20other%20variables-14.png" width="672" /><img src="baseline-supplement_files/figure-html/estimates%20for%20other%20variables-15.png" width="672" /><img src="baseline-supplement_files/figure-html/estimates%20for%20other%20variables-16.png" width="672" /><img src="baseline-supplement_files/figure-html/estimates%20for%20other%20variables-17.png" width="672" /><img src="baseline-supplement_files/figure-html/estimates%20for%20other%20variables-18.png" width="672" /><img src="baseline-supplement_files/figure-html/estimates%20for%20other%20variables-19.png" width="672" /><img src="baseline-supplement_files/figure-html/estimates%20for%20other%20variables-20.png" width="672" /><img src="baseline-supplement_files/figure-html/estimates%20for%20other%20variables-21.png" width="672" /><img src="baseline-supplement_files/figure-html/estimates%20for%20other%20variables-22.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">

CI_widths &lt;-<span class="st"> </span><span class="kw">data.frame</span>(
  <span class="st">&quot;Label&quot;</span> =<span class="st"> </span>ci_total<span class="op">$</span>diamondlabels,
  <span class="st">&quot;Classroom &amp; school&quot;</span> =<span class="st"> </span>(ci_total<span class="op">$</span>ciHi <span class="op">-</span><span class="st"> </span>ci_total<span class="op">$</span>ciLo), 
  <span class="st">&quot;Classroom, school &amp; track&quot;</span> =<span class="st"> </span>(ci_edutrack<span class="op">$</span>ciHi <span class="op">-</span><span class="st"> </span>ci_edutrack<span class="op">$</span>ciLo), 
  <span class="st">&quot;Uncorrected&quot;</span> =<span class="st"> </span>(ci_uncorrected<span class="op">$</span>ciHi <span class="op">-</span><span class="st"> </span>ci_uncorrected<span class="op">$</span>ciLo),
  <span class="st">&quot;Sandwich&quot;</span> =<span class="st"> </span>(ci_sandwich<span class="op">$</span>ciHi <span class="op">-</span><span class="st"> </span>ci_sandwich<span class="op">$</span>ciLo)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">arrange</span>(Sandwich)

CI_widths <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">Label =</span> <span class="kw">as.numeric</span>(<span class="kw">as.factor</span>(ci_total<span class="op">$</span>diamondlabels)))  <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>tidyr<span class="op">::</span><span class="kw">gather</span>(estimator, value, <span class="dv">2</span><span class="op">:</span>Sandwich) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>ggplot2<span class="op">::</span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Label, <span class="dt">y =</span> value, <span class="dt">group =</span> estimator)) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">color =</span> estimator)) <span class="op">+</span>
<span class="st">    </span><span class="kw">ggtitle</span>(<span class="st">&quot;All variables&quot;</span>)</code></pre></div>
<p><img src="baseline-supplement_files/figure-html/ci-widths-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
CI_widths <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">Label =</span> <span class="kw">paste</span>(ci_total<span class="op">$</span>diamondlabels,
                              <span class="kw">as.numeric</span>(<span class="kw">as.factor</span>(ci_total<span class="op">$</span>diamondlabels))))  <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>tidyr<span class="op">::</span><span class="kw">gather</span>(estimator, value, <span class="dv">2</span><span class="op">:</span>Sandwich) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>ggplot2<span class="op">::</span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Label, <span class="dt">y =</span> value, <span class="dt">group =</span> estimator)) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">color =</span> estimator)) <span class="op">+</span>
<span class="st">    </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">75</span>, <span class="dv">100</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">100</span>)) <span class="op">+</span>
<span class="st">    </span><span class="kw">theme</span>(<span class="dt">axis.text.x=</span><span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">45</span>, <span class="dt">hjust =</span> <span class="dv">1</span>)) <span class="op">+</span>
<span class="st">    </span><span class="kw">ggtitle</span>(<span class="st">&quot;Zoomed into bumps&quot;</span>)</code></pre></div>
<p><img src="baseline-supplement_files/figure-html/ci-widths-2.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
CI_widths <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">Label =</span> (ci_total<span class="op">$</span>diamondlabels))  <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>tidyr<span class="op">::</span><span class="kw">gather</span>(estimator, value, <span class="dv">2</span><span class="op">:</span>Sandwich) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>ggplot2<span class="op">::</span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Label, <span class="dt">y =</span> value, <span class="dt">group =</span> estimator)) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">color =</span> estimator)) <span class="op">+</span>
<span class="st">    </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">81</span>, <span class="dv">83</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">100</span>)) <span class="op">+</span>
<span class="st">    </span><span class="kw">theme</span>(<span class="dt">axis.text.x=</span><span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">45</span>, <span class="dt">hjust =</span> <span class="dv">1</span>)) <span class="op">+</span>
<span class="st">    </span><span class="kw">ggtitle</span>(<span class="st">&quot;Zoomed into first bump&quot;</span>)</code></pre></div>
<p><img src="baseline-supplement_files/figure-html/ci-widths-3.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
CI_widths <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">Label =</span> (ci_total<span class="op">$</span>diamondlabels))  <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>tidyr<span class="op">::</span><span class="kw">gather</span>(estimator, value, <span class="dv">2</span><span class="op">:</span>Sandwich) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>ggplot2<span class="op">::</span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Label, <span class="dt">y =</span> value, <span class="dt">group =</span> estimator)) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">color =</span> estimator)) <span class="op">+</span>
<span class="st">    </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">87</span>, <span class="dv">89</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">100</span>)) <span class="op">+</span>
<span class="st">    </span><span class="kw">theme</span>(<span class="dt">axis.text.x=</span><span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">45</span>, <span class="dt">hjust =</span> <span class="dv">1</span>)) <span class="op">+</span>
<span class="st">    </span><span class="kw">ggtitle</span>(<span class="st">&quot;Zoomed into second bump&quot;</span>)</code></pre></div>
<p><img src="baseline-supplement_files/figure-html/ci-widths-4.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
CI_widths <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">Label =</span> (ci_total<span class="op">$</span>diamondlabels))  <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>tidyr<span class="op">::</span><span class="kw">gather</span>(estimator, value, <span class="dv">2</span><span class="op">:</span>Sandwich) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>ggplot2<span class="op">::</span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Label, <span class="dt">y =</span> value, <span class="dt">group =</span> estimator)) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">color =</span> estimator)) <span class="op">+</span>
<span class="st">    </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">92</span>, <span class="dv">96</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">100</span>)) <span class="op">+</span>
<span class="st">    </span><span class="kw">theme</span>(<span class="dt">axis.text.x=</span><span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">45</span>, <span class="dt">hjust =</span> <span class="dv">1</span>)) <span class="op">+</span>
<span class="st">    </span><span class="kw">ggtitle</span>(<span class="st">&quot;Zoomed into third bump&quot;</span>)</code></pre></div>
<p><img src="baseline-supplement_files/figure-html/ci-widths-5.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
CI_widths <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">Label =</span> (ci_total<span class="op">$</span>diamondlabels))  <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>tidyr<span class="op">::</span><span class="kw">gather</span>(estimator, value, <span class="dv">2</span><span class="op">:</span>Sandwich) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>ggplot2<span class="op">::</span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Label, <span class="dt">y =</span> value, <span class="dt">group =</span> estimator)) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">color =</span> estimator)) <span class="op">+</span>
<span class="st">    </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">97</span>, <span class="dv">99</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">100</span>)) <span class="op">+</span>
<span class="st">    </span><span class="kw">theme</span>(<span class="dt">axis.text.x=</span><span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">45</span>, <span class="dt">hjust =</span> <span class="dv">1</span>)) <span class="op">+</span>
<span class="st">    </span><span class="kw">ggtitle</span>(<span class="st">&quot;Zoomed into fourth bump&quot;</span>)</code></pre></div>
<p><img src="baseline-supplement_files/figure-html/ci-widths-6.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># # test to see all labels are in the right order</span>
<span class="co"># data.frame(</span>
<span class="co">#   Label = ci_total$diamondlabels,</span>
<span class="co">#   label2 = ci_edutrack$diamondlabels,</span>
<span class="co">#   label3 = ci_uncorrected$diamondlabels,</span>
<span class="co">#   label4 = ci_sandwich) %&gt;% rowwise %&gt;% </span>
<span class="co">#   dplyr::mutate(test1 = ifelse(Label == label2, &quot;OK&quot;,</span>
<span class="co">#                         ifelse(label2 == label3, &quot;OK&quot;, </span>
<span class="co">#                                ifelse(label3 == label4, &quot;OK&quot;, &quot;DISCREPANCY&quot;))))</span></code></pre></div>
<p>Create confidence bounds for all items by gender and intervention allocation</p>
<p>These numbers are visualised with diamond plots later.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># names &lt;- df %&gt;% dplyr::select(-id, -intervention, -group, -school, -girl, -track, -trackSchool, -contains(&quot;_T3&quot;), -contains(&quot;_diff&quot;)) %&gt;% names(.)</span>
<span class="co"># </span>
<span class="co"># # Intercepts for boys; when boy is 1, girl is 0, but boy is a factor, so intercept is for boys even though boy is 1 for boys and 0 for girls.</span>
<span class="co"># m.boys &lt;- NA</span>
<span class="co"># mean.boys &lt;- NA</span>
<span class="co"># m_p.boys &lt;- NA</span>
<span class="co"># ci_low.boys &lt;- NA</span>
<span class="co"># ci_high.boys &lt;- NA</span>
<span class="co"># ICC_group.boys &lt;- NA</span>
<span class="co"># ICC_School.boys &lt;- NA</span>
<span class="co"># nonmissings.boys &lt;- NA</span>
<span class="co"># </span>
<span class="co"># df.boys &lt;- df %&gt;% dplyr::mutate(boy = factor(ifelse(girl == &quot;girl&quot;, 0, 1), levels = c(1, 0)))</span>
<span class="co"># </span>
<span class="co"># for (i in names){</span>
<span class="co"># m.boys &lt;- lme4::lmer(paste0(i,&quot; ~ (1|school) + (1|group) + boy&quot;), data=df.boys)</span>
<span class="co"># mean.boys[i] &lt;- lme4::fixef(m.boys)[1]</span>
<span class="co"># m_p.boys &lt;- profile(m.boys, which = &quot;beta_&quot;)</span>
<span class="co"># ci_low.boys[i] &lt;- confint(m_p.boys)[1, 1]</span>
<span class="co"># ci_high.boys[i] &lt;- confint(m_p.boys)[1, 2]</span>
<span class="co"># ICC_group.boys[i] &lt;- sjstats::icc(m.boys)[1]</span>
<span class="co"># ICC_School.boys[i] &lt;- sjstats::icc(m.boys)[2]</span>
<span class="co"># nonmissings.boys[i] &lt;- length(m.boys@resp$y)</span>
<span class="co"># }</span>
<span class="co"># </span>
<span class="co"># cat(&quot;The labels are arranged such that intercept is not for girls:&quot;, labels(lme4::fixef(m.boys))[2] == &quot;boy0&quot;)</span>
<span class="co"># </span>
<span class="co"># ci_boys &lt;- data.frame(ciLo = ci_low.boys, mean = mean.boys, ciHi = ci_high.boys)</span>
<span class="co"># diamondlabels &lt;- labels(ci_boys)[[1]]</span>
<span class="co"># ci_boys &lt;- data.frame(ci_boys, diamondlabels)</span>
<span class="co"># </span>
<span class="co"># # Intercepts for girls; when boy is 1, girl is 0, but boy is a factor, so intercept is for girls even though girl is 1 for girls and 0 for boys.</span>
<span class="co"># m.girls &lt;- NA</span>
<span class="co"># mean.girls &lt;- NA</span>
<span class="co"># m_p.girls &lt;- NA</span>
<span class="co"># ci_low.girls &lt;- NA</span>
<span class="co"># ci_high.girls &lt;- NA</span>
<span class="co"># ICC_group.girls &lt;- NA</span>
<span class="co"># ICC_School.girls &lt;- NA</span>
<span class="co"># nonmissings.girls &lt;- NA</span>
<span class="co"># </span>
<span class="co"># for (i in names){</span>
<span class="co"># m.girls &lt;- lme4::lmer(paste0(i,&quot; ~ (1|school) + (1|group) + girl&quot;), data=df)</span>
<span class="co"># mean.girls[i] &lt;- lme4::fixef(m.girls)[1]</span>
<span class="co"># m_p.girls &lt;- profile(m.girls, which = &quot;beta_&quot;)</span>
<span class="co"># ci_low.girls[i] &lt;- confint(m_p.girls)[1, 1]</span>
<span class="co"># ci_high.girls[i] &lt;- confint(m_p.girls)[1, 2]</span>
<span class="co"># ICC_group.girls[i] &lt;- sjstats::icc(m.girls)[1]</span>
<span class="co"># ICC_School.girls[i] &lt;- sjstats::icc(m.girls)[2]</span>
<span class="co"># nonmissings.girls[i] &lt;- length(m.girls@resp$y)</span>
<span class="co"># }</span>
<span class="co"># </span>
<span class="co"># cat(&quot;The labels are arranged such that intercept is not for boys:&quot;, labels(lme4::fixef(m.girls))[2] == &quot;girl0&quot;)</span>
<span class="co"># </span>
<span class="co"># ci_girls &lt;- data.frame(ciLo = ci_low.girls, mean = mean.girls, ciHi = ci_high.girls)</span>
<span class="co"># diamondlabels &lt;- labels(ci_girls)[[1]]</span>
<span class="co"># ci_girls &lt;- data.frame(ci_girls, diamondlabels)</span>
<span class="co"># </span>
<span class="co"># </span>
<span class="co"># # Intercepts for intervention</span>
<span class="co"># m.intervention &lt;- NA</span>
<span class="co"># mean.intervention &lt;- NA</span>
<span class="co"># m_p.intervention &lt;- NA</span>
<span class="co"># ci_low.intervention &lt;- NA</span>
<span class="co"># ci_high.intervention &lt;- NA</span>
<span class="co"># ICC_group.intervention &lt;- NA</span>
<span class="co"># ICC_School.intervention &lt;- NA</span>
<span class="co"># nonmissings.intervention &lt;- NA</span>
<span class="co"># </span>
<span class="co"># ## change &quot;intervention&quot; to be consistent regarding level order with &quot;girl&quot;.</span>
<span class="co"># df.intervention &lt;- df %&gt;% dplyr::mutate(intervention = factor(intervention, levels = c(1, 0)))</span>
<span class="co"># </span>
<span class="co"># for (i in names){</span>
<span class="co"># m.intervention &lt;- lme4::lmer(paste0(i,&quot; ~ (1|school) + (1|group) + intervention&quot;), data=df.intervention)</span>
<span class="co"># mean.intervention[i] &lt;- lme4::fixef(m.intervention)[1]</span>
<span class="co"># m_p.intervention &lt;- profile(m.intervention, which = &quot;beta_&quot;)</span>
<span class="co"># ci_low.intervention[i] &lt;- confint(m_p.intervention)[1, 1]</span>
<span class="co"># ci_high.intervention[i] &lt;- confint(m_p.intervention)[1, 2]</span>
<span class="co"># ICC_group.intervention[i] &lt;- sjstats::icc(m.intervention)[1]</span>
<span class="co"># ICC_School.intervention[i] &lt;- sjstats::icc(m.intervention)[2]</span>
<span class="co"># nonmissings.intervention[i] &lt;- length(m.intervention@resp$y)</span>
<span class="co"># }</span>
<span class="co"># </span>
<span class="co"># cat(&quot;The labels are arranged such that intercept is not for control:&quot;, labels(lme4::fixef(m.intervention))[2] == &quot;intervention0&quot;)</span>
<span class="co"># </span>
<span class="co"># ci_intervention &lt;- data.frame(ciLo = ci_low.intervention, mean = mean.intervention, ciHi = ci_high.intervention)</span>
<span class="co"># diamondlabels &lt;- labels(ci_intervention)[[1]]</span>
<span class="co"># ci_intervention &lt;- data.frame(ci_intervention, diamondlabels)</span>
<span class="co"># </span>
<span class="co"># # Intercepts for control</span>
<span class="co"># </span>
<span class="co"># m.control &lt;- NA</span>
<span class="co"># mean.control &lt;- NA</span>
<span class="co"># m_p.control &lt;- NA</span>
<span class="co"># ci_low.control &lt;- NA</span>
<span class="co"># ci_high.control &lt;- NA</span>
<span class="co"># ICC_group.control &lt;- NA</span>
<span class="co"># ICC_School.control &lt;- NA</span>
<span class="co"># nonmissings.control &lt;- NA</span>
<span class="co"># </span>
<span class="co"># df.control &lt;- df %&gt;% dplyr::mutate(control = factor(ifelse(intervention == 1, 0, 1), levels = c(1, 0)))</span>
<span class="co"># </span>
<span class="co"># for (i in names){</span>
<span class="co"># m.control &lt;- lme4::lmer(paste0(i,&quot; ~ (1|school) + (1|group) + control&quot;), data=df.control)</span>
<span class="co"># mean.control[i] &lt;- lme4::fixef(m.control)[1]</span>
<span class="co"># m_p.control &lt;- profile(m.control, which = &quot;beta_&quot;)</span>
<span class="co"># ci_low.control[i] &lt;- confint(m_p.control)[1, 1]</span>
<span class="co"># ci_high.control[i] &lt;- confint(m_p.control)[1, 2]</span>
<span class="co"># ICC_group.control[i] &lt;- sjstats::icc(m.control)[1]</span>
<span class="co"># ICC_School.control[i] &lt;- sjstats::icc(m.control)[2]</span>
<span class="co"># nonmissings.control[i] &lt;- length(m.control@resp$y)</span>
<span class="co"># }</span>
<span class="co"># </span>
<span class="co"># cat(&quot;The labels are arranged such that intercept is not for intervention:&quot;, labels(lme4::fixef(m.control))[2] == &quot;control0&quot;)</span>
<span class="co"># </span>
<span class="co"># ci_control &lt;- data.frame(ciLo = ci_low.control, mean = mean.control, ciHi = ci_high.control)</span>
<span class="co"># diamondlabels &lt;- labels(ci_control)[[1]]</span>
<span class="co"># ci_control &lt;- data.frame(ci_control, diamondlabels)</span>

<span class="co"># # # Same ICC results you&#39;d get with e.g.:</span>
<span class="co"># # m1 &lt;- as.data.frame(VarCorr(m))</span>
<span class="co"># # m1$vcov[1] / (m1$vcov[1] + m1$vcov[3])</span>
<span class="co"># </span>
<span class="co"># # Or from broom:</span>
<span class="co"># # tidy(m)$estimate[2]^2 / (tidy(m)$estimate[2]^2 + tidy(m)$estimate[4]^2)</span>
<span class="co"># </span>
<span class="co"># # Or from sjstats:</span>
<span class="co"># # sum(get_re_var(m)) / (sum(get_re_var(m)) + get_re_var(m, &quot;sigma_2&quot;))</span>
<span class="co"># </span>
<span class="co"># # save(ci_control, file = &quot;ci_control.Rdata&quot;)</span>
<span class="co"># # save(ci_intervention, file = &quot;ci_intervention.Rdata&quot;)</span>
<span class="co"># # save(ci_girls, file = &quot;ci_girls.Rdata&quot;)</span>
<span class="co"># # save(ci_boys, file = &quot;ci_boys.Rdata&quot;)</span>

<span class="kw">load</span>(<span class="st">&quot;ci_control.Rdata&quot;</span>)
<span class="kw">load</span>(<span class="st">&quot;ci_intervention.Rdata&quot;</span>)
<span class="kw">load</span>(<span class="st">&quot;ci_girls.Rdata&quot;</span>)
<span class="kw">load</span>(<span class="st">&quot;ci_boys.Rdata&quot;</span>)</code></pre></div>
<!-- ### Gender and intervention group CIs with sandwich estimator -->
<!-- NOT INCLUDED, because the line beginning with "sandwich_se <- diag(..." gives a negative sandwich variance estimate, which can't be square-rooted -->
</div>
</div>
<div id="descriptive-tables" class="section level1">
<h1>Descriptive tables</h1>
<p>Next code chunk prepares data.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
demographics &lt;-<span class="st"> </span>lmi <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="dt">id =</span> ID,
  <span class="dt">birthYear =</span> Kys0004.<span class="dv">1</span>,
  <span class="dt">surveyDate =</span> StartDateTime.<span class="dv">1</span>,
  <span class="dt">intervention =</span> ryhma,
  <span class="dt">school =</span> Aineisto.<span class="dv">1</span>,
  <span class="dt">girl =</span> Kys0013.<span class="dv">1</span>,
  <span class="dt">ethnicity =</span> Kys0005.<span class="dv">1</span>,
  <span class="dt">studyYear =</span> Kys0014.<span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(
    <span class="dt">surveyYear =</span> lubridate<span class="op">::</span><span class="kw">year</span>(surveyDate),
    <span class="dt">age =</span> <span class="kw">as.numeric</span>(surveyYear) <span class="op">-</span><span class="st"> </span><span class="kw">as.numeric</span>(birthYear),
    <span class="dt">intervention =</span> <span class="kw">ifelse</span>(intervention <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>),
    <span class="dt">intervention =</span> <span class="kw">as.numeric</span>(intervention, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;0&quot;</span>, <span class="st">&quot;1&quot;</span>)),
    <span class="dt">girl =</span> <span class="kw">ifelse</span>(girl <span class="op">==</span><span class="st"> &quot;2&quot;</span>, <span class="dv">1</span>, <span class="dv">0</span>),
    <span class="dt">girl =</span> <span class="kw">as.numeric</span>(girl, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;1&quot;</span>, <span class="st">&quot;0&quot;</span>)),
    <span class="dt">school =</span> <span class="kw">factor</span>(school, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;1&quot;</span>, <span class="st">&quot;2&quot;</span>, <span class="st">&quot;3&quot;</span>, <span class="st">&quot;4&quot;</span>, <span class="st">&quot;5&quot;</span>)),
    <span class="dt">bornInFinland =</span> <span class="kw">as.numeric</span>(<span class="kw">ifelse</span>(ethnicity <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>)),
    <span class="dt">studyYear =</span> <span class="kw">ifelse</span>(<span class="kw">as.numeric</span>(studyYear) <span class="op">==</span><span class="st"> </span><span class="dv">0</span>, <span class="ot">NA</span>, <span class="kw">as.numeric</span>(studyYear))) <span class="op">%&gt;%</span><span class="st">  </span><span class="co"># Remove &quot;other&quot; from study year</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>surveyDate, <span class="op">-</span>surveyYear)

<span class="co"># Insert track variable with those who answered &quot;other&quot; with one of the actual category labels given the appropriate category:</span>
Track &lt;-<span class="st"> </span>lmi <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(Kys0016.<span class="dv">1</span>, Kys0017.<span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(
  <span class="dt">Kys0016.1 =</span> <span class="kw">as.character</span>(Kys0016.<span class="dv">1</span>), <span class="co"># Because I had an Evaluation error: `x` and `labels` must be same type.</span>
  <span class="dt">Kys0017.1 =</span> <span class="kw">as.character</span>(Kys0017.<span class="dv">1</span>),
  <span class="dt">Kys0016.1 =</span> <span class="kw">ifelse</span>(Kys0017.<span class="dv">1</span> <span class="op">==</span><span class="st"> &quot;Merkonomi&quot;</span> <span class="op">|</span><span class="st"> </span>Kys0017.<span class="dv">1</span> <span class="op">==</span><span class="st"> &quot;merkonomi&quot;</span>, <span class="dv">3</span>,
                     <span class="kw">ifelse</span>(Kys0017.<span class="dv">1</span> <span class="op">==</span><span class="st"> &quot;Datanomi&quot;</span> <span class="op">|</span><span class="st"> </span>Kys0017.<span class="dv">1</span> <span class="op">==</span><span class="st"> &quot;datanomi&quot;</span>, <span class="dv">2</span>, Kys0016.<span class="dv">1</span>)),
  <span class="dt">Track =</span> <span class="kw">factor</span>(Kys0016.<span class="dv">1</span>, <span class="co"># Fix track labels first</span>
                 <span class="dt">levels =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>),
                 <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Other&quot;</span>, <span class="st">&quot;IT&quot;</span>, <span class="st">&quot;BA&quot;</span>, <span class="st">&quot;HRC&quot;</span>, <span class="st">&quot;Nur&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>Kys0016.<span class="dv">1</span>, <span class="op">-</span>Kys0017.<span class="dv">1</span>)

demographics &lt;-<span class="st"> </span><span class="kw">bind_cols</span>(demographics, Track)</code></pre></div>
<div id="create-demographic-tables" class="section level2">
<h2>Create demographic tables</h2>
<div id="by-educational-track" class="section level3">
<h3>By educational track</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">demotable &lt;-<span class="st"> </span>demographics <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">!=</span><span class="st"> &quot;Other&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">group_by</span>(Track) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">summarise</span>(<span class="st">&quot;Mean age (range)&quot;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(age, <span class="dt">na.rm =</span> T), <span class="dv">1</span>),<span class="st">&quot; (&quot;</span>, 
                                        <span class="kw">range</span>(age, <span class="dt">na.rm =</span> T)[<span class="dv">1</span>], <span class="st">&quot;-&quot;</span>,
                                        <span class="kw">range</span>(age, <span class="dt">na.rm =</span> T)[<span class="dv">2</span>], <span class="st">&quot;)&quot;</span>),
            <span class="st">&quot;Mean study year (sd)&quot;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(studyYear, <span class="dt">na.rm =</span> T), <span class="dv">1</span>),<span class="st">&quot; (&quot;</span>, 
                                               <span class="kw">round</span>(<span class="kw">sd</span>(studyYear, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&quot;)&quot;</span>),
            <span class="st">&quot;% girl&quot;</span> =<span class="st"> </span><span class="kw">round</span>(<span class="kw">mean</span>(girl, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)<span class="op">*</span><span class="dv">100</span>, <span class="dv">1</span>),
            <span class="st">&quot;% intervention&quot;</span> =<span class="st"> </span><span class="kw">round</span>(<span class="kw">mean</span>(intervention, <span class="dt">na.rm =</span> T)<span class="op">*</span><span class="dv">100</span>, <span class="dv">1</span>),
            <span class="st">&quot;% born in Finland&quot;</span> =<span class="st"> </span><span class="kw">round</span>(<span class="kw">mean</span>(bornInFinland, <span class="dt">na.rm =</span> T)<span class="op">*</span><span class="dv">100</span>, <span class="dv">1</span>),
            <span class="dt">n =</span> <span class="kw">n</span>()) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="kw">complete.cases</span>(.)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">arrange</span>(<span class="kw">desc</span>(Track)) 

demotable_total &lt;-<span class="st"> </span>demographics <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarise</span>(<span class="st">&quot;Track&quot;</span> =<span class="st"> &quot;Full sample&quot;</span>,
            <span class="st">&quot;Mean age (range)&quot;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(age, <span class="dt">na.rm =</span> T), <span class="dv">1</span>),<span class="st">&quot; (&quot;</span>, 
                                        <span class="kw">range</span>(age, <span class="dt">na.rm =</span> T)[<span class="dv">1</span>], <span class="st">&quot;-&quot;</span>,
                                        <span class="kw">range</span>(age, <span class="dt">na.rm =</span> T)[<span class="dv">2</span>], <span class="st">&quot;)&quot;</span>),
            <span class="st">&quot;Mean study year (sd)&quot;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(studyYear, <span class="dt">na.rm =</span> T), <span class="dv">1</span>),<span class="st">&quot; (&quot;</span>, 
                                               <span class="kw">round</span>(<span class="kw">sd</span>(studyYear, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&quot;)&quot;</span>),
            <span class="st">&quot;% girl&quot;</span> =<span class="st"> </span><span class="kw">round</span>(<span class="kw">mean</span>(girl, <span class="dt">na.rm =</span> T)<span class="op">*</span><span class="dv">100</span>, <span class="dv">1</span>),
            <span class="st">&quot;% intervention&quot;</span> =<span class="st"> </span><span class="kw">round</span>(<span class="kw">mean</span>(intervention, <span class="dt">na.rm =</span> T)<span class="op">*</span><span class="dv">100</span>, <span class="dv">1</span>),
            <span class="st">&quot;% born in Finland&quot;</span> =<span class="st"> </span><span class="kw">round</span>(<span class="kw">mean</span>(bornInFinland, <span class="dt">na.rm =</span> T)<span class="op">*</span><span class="dv">100</span>, <span class="dv">1</span>),
            <span class="dt">n =</span> <span class="kw">n</span>())

demotable &lt;-<span class="st"> </span><span class="kw">bind_rows</span>(demotable, demotable_total)
## Warning in bind_rows_(x, .id): binding factor and character vector,
## coercing into character vector
## Warning in bind_rows_(x, .id): binding character and factor vector,
## coercing into character vector

demotable &lt;-<span class="st"> </span>demotable <span class="op">%&gt;%</span><span class="st"> </span>tidyr<span class="op">::</span><span class="kw">gather</span>(Variable, val, <span class="dv">2</span><span class="op">:</span><span class="kw">ncol</span>(demotable)) <span class="op">%&gt;%</span><span class="st"> </span>tidyr<span class="op">::</span><span class="kw">spread</span>(Track, val)

<span class="co"># For some reason, sum of n&#39;s of all tracks is 1084.</span>

papaja<span class="op">::</span><span class="kw">apa_table</span>(demotable, <span class="dt">caption =</span> <span class="st">&quot;Baseline demographics of educational tracks&quot;</span>, <span class="dt">digits =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>))</code></pre></div>
<caption>
(#tab:demographics-table-track)
</caption>
<caption>
<em>Baseline demographics of educational tracks</em>
</caption>
<table>
<thead>
<tr class="header">
<th align="left">Variable</th>
<th align="left">BA</th>
<th align="left">Full sample</th>
<th align="left">HRC</th>
<th align="left">IT</th>
<th align="left">Nur</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">% born in Finland</td>
<td align="left">87.1</td>
<td align="left">83.1</td>
<td align="left">88.2</td>
<td align="left">87.9</td>
<td align="left">80</td>
</tr>
<tr class="even">
<td align="left">% girl</td>
<td align="left">39</td>
<td align="left">56.5</td>
<td align="left">60.6</td>
<td align="left">16</td>
<td align="left">82.3</td>
</tr>
<tr class="odd">
<td align="left">% intervention</td>
<td align="left">53.5</td>
<td align="left">53.6</td>
<td align="left">31.5</td>
<td align="left">46.6</td>
<td align="left">68.9</td>
</tr>
<tr class="even">
<td align="left">Mean age (range)</td>
<td align="left">18 (16-35)</td>
<td align="left">18.5 (16-49)</td>
<td align="left">18.5 (17-27)</td>
<td align="left">18.5 (17-43)</td>
<td align="left">18.8 (16-49)</td>
</tr>
<tr class="odd">
<td align="left">Mean study year (sd)</td>
<td align="left">1.7 (0.9)</td>
<td align="left">1.7 (0.9)</td>
<td align="left">1.9 (0.7)</td>
<td align="left">1.7 (0.9)</td>
<td align="left">1.7 (0.9)</td>
</tr>
<tr class="even">
<td align="left">n</td>
<td align="left">282</td>
<td align="left">1165</td>
<td align="left">213</td>
<td align="left">163</td>
<td align="left">402</td>
</tr>
</tbody>
</table>
</div>
<div id="by-gender" class="section level3">
<h3>By gender</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">demographics<span class="op">$</span>Girl &lt;-<span class="st"> </span><span class="kw">factor</span>(demographics<span class="op">$</span>girl)

demotable &lt;-<span class="st"> </span>demographics <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(Girl) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarise</span>(<span class="st">&quot;Mean age (range)&quot;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(age, <span class="dt">na.rm =</span> T), <span class="dv">1</span>),<span class="st">&quot; (&quot;</span>, 
                                        <span class="kw">range</span>(age, <span class="dt">na.rm =</span> T)[<span class="dv">1</span>], <span class="st">&quot;-&quot;</span>,
                                        <span class="kw">range</span>(age, <span class="dt">na.rm =</span> T)[<span class="dv">2</span>], <span class="st">&quot;)&quot;</span>),
            <span class="st">&quot;Mean study year (sd)&quot;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(studyYear, <span class="dt">na.rm =</span> T), <span class="dv">1</span>),<span class="st">&quot; (&quot;</span>, 
                                               <span class="kw">round</span>(<span class="kw">sd</span>(studyYear, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&quot;)&quot;</span>),
            <span class="st">&quot;% intervention&quot;</span> =<span class="st"> </span><span class="kw">round</span>(<span class="kw">mean</span>(<span class="kw">as.numeric</span>(intervention), <span class="dt">na.rm =</span> T)<span class="op">*</span><span class="dv">100</span>, <span class="dv">1</span>),
            <span class="st">&quot;% born in Finland&quot;</span> =<span class="st"> </span><span class="kw">round</span>(<span class="kw">mean</span>(bornInFinland, <span class="dt">na.rm =</span> T)<span class="op">*</span><span class="dv">100</span>, <span class="dv">1</span>),
            <span class="dt">n =</span> <span class="kw">n</span>()) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="kw">complete.cases</span>(.)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">arrange</span>(<span class="kw">desc</span>(Girl)) 
## Warning in min(x): no non-missing arguments to min; returning Inf
## Warning in max(x): no non-missing arguments to max; returning -Inf
## Warning in min(x): no non-missing arguments to min; returning Inf
## Warning in max(x): no non-missing arguments to max; returning -Inf

demotable_total &lt;-<span class="st"> </span>demographics <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarise</span>(<span class="st">&quot;Girl&quot;</span> =<span class="st"> &quot;Full sample&quot;</span>,
            <span class="st">&quot;Mean age (range)&quot;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(age, <span class="dt">na.rm =</span> T), <span class="dv">1</span>),<span class="st">&quot; (&quot;</span>, 
                                        <span class="kw">range</span>(age, <span class="dt">na.rm =</span> T)[<span class="dv">1</span>], <span class="st">&quot;-&quot;</span>,
                                        <span class="kw">range</span>(age, <span class="dt">na.rm =</span> T)[<span class="dv">2</span>], <span class="st">&quot;)&quot;</span>),
            <span class="st">&quot;Mean study year (sd)&quot;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(studyYear, <span class="dt">na.rm =</span> T), <span class="dv">1</span>),<span class="st">&quot; (&quot;</span>, 
                                               <span class="kw">round</span>(<span class="kw">sd</span>(studyYear, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&quot;)&quot;</span>),
            <span class="st">&quot;% intervention&quot;</span> =<span class="st"> </span><span class="kw">round</span>(<span class="kw">mean</span>(intervention, <span class="dt">na.rm =</span> T)<span class="op">*</span><span class="dv">100</span>, <span class="dv">1</span>),
            <span class="st">&quot;% born in Finland&quot;</span> =<span class="st"> </span><span class="kw">round</span>(<span class="kw">mean</span>(bornInFinland, <span class="dt">na.rm =</span> T)<span class="op">*</span><span class="dv">100</span>, <span class="dv">1</span>),
            <span class="dt">n =</span> <span class="kw">n</span>())

demotable &lt;-<span class="st"> </span><span class="kw">bind_rows</span>(demotable, demotable_total)
## Warning in bind_rows_(x, .id): binding factor and character vector,
## coercing into character vector
## Warning in bind_rows_(x, .id): binding character and factor vector,
## coercing into character vector

demotable &lt;-<span class="st"> </span>demotable <span class="op">%&gt;%</span><span class="st"> </span>tidyr<span class="op">::</span><span class="kw">gather</span>(Variable, val, <span class="dv">2</span><span class="op">:</span><span class="kw">ncol</span>(demotable)) <span class="op">%&gt;%</span><span class="st"> </span>tidyr<span class="op">::</span><span class="kw">spread</span>(Girl, val)

<span class="kw">names</span>(demotable) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;&quot;</span>, <span class="st">&quot;Boy&quot;</span>, <span class="st">&quot;Girl&quot;</span>, <span class="st">&quot;Full sample&quot;</span>)

<span class="co"># For some reason, sum of n&#39;s of all tracks is 1084.</span>

papaja<span class="op">::</span><span class="kw">apa_table</span>(demotable, <span class="dt">caption =</span> <span class="st">&quot;Baseline demographics of educational tracks&quot;</span>, <span class="dt">digits =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>))</code></pre></div>
<caption>
(#tab:demographics-table-gender)
</caption>
<caption>
<em>Baseline demographics of educational tracks</em>
</caption>
<table>
<thead>
<tr class="header">
<th></th>
<th align="left">Boy</th>
<th align="left">Girl</th>
<th align="left">Full sample</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>% born in Finland</td>
<td align="left">88.2</td>
<td align="left">80.1</td>
<td align="left">83.1</td>
</tr>
<tr class="even">
<td>% intervention</td>
<td align="left">50.5</td>
<td align="left">56</td>
<td align="left">53.6</td>
</tr>
<tr class="odd">
<td>Mean age (range)</td>
<td align="left">18.2 (16-35)</td>
<td align="left">18.7 (16-49)</td>
<td align="left">18.5 (16-49)</td>
</tr>
<tr class="even">
<td>Mean study year (sd)</td>
<td align="left">1.7 (0.9)</td>
<td align="left">1.7 (0.8)</td>
<td align="left">1.7 (0.9)</td>
</tr>
<tr class="odd">
<td>n</td>
<td align="left">471</td>
<td align="left">613</td>
<td align="left">1165</td>
</tr>
</tbody>
</table>
</div>
<div id="by-intervention-participation" class="section level3">
<h3>By intervention participation</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">demographics<span class="op">$</span>intervention &lt;-<span class="st"> </span><span class="kw">factor</span>(demographics<span class="op">$</span>intervention)
demographics<span class="op">$</span>girl &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(demographics<span class="op">$</span>girl)

demotable &lt;-<span class="st"> </span>demographics <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(intervention) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarise</span>(<span class="st">&quot;Mean age (range)&quot;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(age, <span class="dt">na.rm =</span> T), <span class="dv">1</span>),<span class="st">&quot; (&quot;</span>, 
                                        <span class="kw">range</span>(age, <span class="dt">na.rm =</span> T)[<span class="dv">1</span>], <span class="st">&quot;-&quot;</span>,
                                        <span class="kw">range</span>(age, <span class="dt">na.rm =</span> T)[<span class="dv">2</span>], <span class="st">&quot;)&quot;</span>),
            <span class="st">&quot;Mean study year (sd)&quot;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(studyYear, <span class="dt">na.rm =</span> T), <span class="dv">1</span>),<span class="st">&quot; (&quot;</span>, 
                                               <span class="kw">round</span>(<span class="kw">sd</span>(studyYear, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&quot;)&quot;</span>),
            <span class="st">&quot;% girl&quot;</span> =<span class="st"> </span><span class="kw">round</span>(<span class="kw">mean</span>(girl, <span class="dt">na.rm =</span> T)<span class="op">*</span><span class="dv">100</span>, <span class="dv">1</span>),
            <span class="st">&quot;% born in Finland&quot;</span> =<span class="st"> </span><span class="kw">round</span>(<span class="kw">mean</span>(bornInFinland, <span class="dt">na.rm =</span> T)<span class="op">*</span><span class="dv">100</span>, <span class="dv">1</span>),
            <span class="dt">n =</span> <span class="kw">n</span>()) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="kw">complete.cases</span>(.)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">arrange</span>(<span class="kw">desc</span>(intervention)) 
## Warning in min(x): no non-missing arguments to min; returning Inf
## Warning in max(x): no non-missing arguments to max; returning -Inf
## Warning in min(x): no non-missing arguments to min; returning Inf
## Warning in max(x): no non-missing arguments to max; returning -Inf

demotable_total &lt;-<span class="st"> </span>demographics <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarise</span>(<span class="st">&quot;intervention&quot;</span> =<span class="st"> &quot;Full sample&quot;</span>,
            <span class="st">&quot;Mean age (range)&quot;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(age, <span class="dt">na.rm =</span> T), <span class="dv">1</span>),<span class="st">&quot; (&quot;</span>, 
                                        <span class="kw">range</span>(age, <span class="dt">na.rm =</span> T)[<span class="dv">1</span>], <span class="st">&quot;-&quot;</span>,
                                        <span class="kw">range</span>(age, <span class="dt">na.rm =</span> T)[<span class="dv">2</span>], <span class="st">&quot;)&quot;</span>),
            <span class="st">&quot;Mean study year (sd)&quot;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(studyYear, <span class="dt">na.rm =</span> T), <span class="dv">1</span>),<span class="st">&quot; (&quot;</span>, 
                                               <span class="kw">round</span>(<span class="kw">sd</span>(studyYear, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&quot;)&quot;</span>),
            <span class="st">&quot;% girl&quot;</span> =<span class="st"> </span><span class="kw">round</span>(<span class="kw">mean</span>(girl, <span class="dt">na.rm =</span> T)<span class="op">*</span><span class="dv">100</span>, <span class="dv">1</span>),
            <span class="st">&quot;% born in Finland&quot;</span> =<span class="st"> </span><span class="kw">round</span>(<span class="kw">mean</span>(bornInFinland, <span class="dt">na.rm =</span> T)<span class="op">*</span><span class="dv">100</span>, <span class="dv">1</span>),
            <span class="dt">n =</span> <span class="kw">n</span>())

demotable &lt;-<span class="st"> </span><span class="kw">bind_rows</span>(demotable, demotable_total)
## Warning in bind_rows_(x, .id): binding factor and character vector,
## coercing into character vector
## Warning in bind_rows_(x, .id): binding character and factor vector,
## coercing into character vector

demotable &lt;-<span class="st"> </span>demotable <span class="op">%&gt;%</span><span class="st"> </span>tidyr<span class="op">::</span><span class="kw">gather</span>(Variable, val, <span class="dv">2</span><span class="op">:</span><span class="kw">ncol</span>(demotable)) <span class="op">%&gt;%</span><span class="st"> </span>tidyr<span class="op">::</span><span class="kw">spread</span>(intervention, val)

<span class="kw">names</span>(demotable) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;&quot;</span>, <span class="st">&quot;Control&quot;</span>, <span class="st">&quot;Intervention&quot;</span>, <span class="st">&quot;Full sample&quot;</span>)

<span class="co"># For some reason, sum of n&#39;s of all tracks is 1084.</span>

papaja<span class="op">::</span><span class="kw">apa_table</span>(demotable, <span class="dt">caption =</span> <span class="st">&quot;Baseline demographics of educational tracks&quot;</span>, <span class="dt">digits =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>))</code></pre></div>
<caption>
(#tab:demographics-table-intervention)
</caption>
<caption>
<em>Baseline demographics of educational tracks</em>
</caption>
<table>
<thead>
<tr class="header">
<th></th>
<th align="left">Control</th>
<th align="left">Intervention</th>
<th align="left">Full sample</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>% born in Finland</td>
<td align="left">87.5</td>
<td align="left">79.6</td>
<td align="left">83.1</td>
</tr>
<tr class="even">
<td>% girl</td>
<td align="left">53.7</td>
<td align="left">59</td>
<td align="left">56.5</td>
</tr>
<tr class="odd">
<td>Mean age (range)</td>
<td align="left">18.3 (16-38)</td>
<td align="left">18.7 (16-49)</td>
<td align="left">18.5 (16-49)</td>
</tr>
<tr class="even">
<td>Mean study year (sd)</td>
<td align="left">1.7 (0.9)</td>
<td align="left">1.7 (0.9)</td>
<td align="left">1.7 (0.9)</td>
</tr>
<tr class="odd">
<td>n</td>
<td align="left">503</td>
<td align="left">581</td>
<td align="left">1165</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="create-outcome-tables" class="section level2">
<h2>Create outcome tables</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
outtable_track &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(paAccelerometer_T1, sitLieAccelerometer_T1, sitBreaks_T1, <span class="co"># Main outcomes </span>
          PA_actionplan_T1,
          PA_copingplan_T1,
          PA_agrbct_T1,
          PA_frqbct_T1,
          PA_amotivation_T1,
          PA_autonomous_T1,
          PA_controlled_T1,
          PA_goal_T1,
          PA_inorm_T1,
          PA_dnorm_T1,
          PA_intention_T1,
          PA_outcomeExpectations_T1,
          PA_opportunities_T1,
          PA_pbc_T1,
          PA_selfefficacy_T1,
          SB_dnorm_T1,
          SB_inorm_T1,
          SB_intention_T1,
          SB_outcomeExpectations_T1,
          SB_sePbc_T1,
         track, girl, intervention) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(track) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarise</span>(
            <span class="st">&#39;PA action planning&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(PA_actionplan_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&quot; (&quot;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(PA_actionplan_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&quot;)&quot;</span>),
            <span class="st">&#39;PA coping planning&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(PA_copingplan_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(PA_copingplan_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),
            <span class="st">&#39;PA agreement-BCTs&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(PA_agrbct_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(PA_agrbct_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),
            <span class="st">&#39;PA frequency-BCTs&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(PA_frqbct_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(PA_frqbct_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),
            <span class="st">&#39;PA amotivation&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(PA_amotivation_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(PA_amotivation_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),
            <span class="st">&#39;PA autonomous regulation&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(PA_autonomous_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(PA_autonomous_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),
            <span class="st">&#39;PA controlled regulation&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(PA_controlled_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(PA_controlled_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),
            <span class="st">&#39;PA injunctive norm&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(PA_inorm_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(PA_inorm_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),
            <span class="st">&#39;PA descriptive norm&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(PA_dnorm_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(PA_dnorm_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),
            <span class="st">&#39;PA intention&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(PA_intention_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(PA_intention_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),
            <span class="st">&#39;PA outcome expectations&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(PA_outcomeExpectations_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(PA_outcomeExpectations_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),
            <span class="st">&#39;PA opportunities&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(PA_opportunities_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(PA_opportunities_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),
            <span class="st">&#39;PA perceived behavioural control&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(PA_pbc_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(PA_pbc_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),
            <span class="st">&#39;PA self-efficacy&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(PA_selfefficacy_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(PA_selfefficacy_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),
            <span class="st">&#39;SB descriptive norm&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(SB_dnorm_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(SB_dnorm_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),
            <span class="st">&#39;SB injunctive norm&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(SB_inorm_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(SB_inorm_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),
            <span class="st">&#39;SB intention&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(SB_intention_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(SB_intention_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),
            <span class="st">&#39;SB outcome expectations&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(SB_outcomeExpectations_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(SB_outcomeExpectations_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),
            <span class="st">&#39;SB self-efficacy &amp; perceived behavioural control&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(SB_sePbc_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(SB_sePbc_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),

            <span class="st">&quot;Mean daily MVPA minutes&quot;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(paAccelerometer_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>),<span class="st">&quot; (&quot;</span>, 
                                        <span class="kw">round</span>(<span class="kw">sd</span>(paAccelerometer_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&quot;)&quot;</span>),
            <span class="st">&quot;Mean daily minutes spent sitting or lying down&quot;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(sitLieAccelerometer_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>),<span class="st">&quot; (&quot;</span>, 
                                        <span class="kw">round</span>(<span class="kw">sd</span>(sitLieAccelerometer_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&quot;)&quot;</span>),
            <span class="st">&quot;Mean daily breaks in sitting&quot;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(sitBreaks_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>),<span class="st">&quot; (&quot;</span>, 
                                        <span class="kw">round</span>(<span class="kw">sd</span>(sitBreaks_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&quot;)&quot;</span>),
            <span class="dt">n =</span> <span class="kw">n</span>()) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="kw">complete.cases</span>(.)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">arrange</span>(<span class="kw">desc</span>(track)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">!=</span><span class="st"> &quot;Other&quot;</span>)

outtable_intervention &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(paAccelerometer_T1, sitLieAccelerometer_T1, sitBreaks_T1, <span class="co"># Main outcomes </span>
          PA_actionplan_T1,
          PA_copingplan_T1,
          PA_agrbct_T1,
          PA_frqbct_T1,
          PA_amotivation_T1,
          PA_autonomous_T1,
          PA_controlled_T1,
          PA_goal_T1,
          PA_inorm_T1,
          PA_dnorm_T1,
          PA_intention_T1,
          PA_outcomeExpectations_T1,
          PA_opportunities_T1,
          PA_pbc_T1,
          PA_selfefficacy_T1,
          SB_dnorm_T1,
          SB_inorm_T1,
          SB_intention_T1,
          SB_outcomeExpectations_T1,
          SB_sePbc_T1,
         track, girl, intervention) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(intervention) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarise</span>(
            <span class="st">&#39;PA action planning&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(PA_actionplan_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&quot; (&quot;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(PA_actionplan_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&quot;)&quot;</span>),
            <span class="st">&#39;PA coping planning&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(PA_copingplan_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(PA_copingplan_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),
            <span class="st">&#39;PA agreement-BCTs&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(PA_agrbct_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(PA_agrbct_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),
            <span class="st">&#39;PA frequency-BCTs&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(PA_frqbct_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(PA_frqbct_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),
            <span class="st">&#39;PA amotivation&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(PA_amotivation_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(PA_amotivation_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),
            <span class="st">&#39;PA autonomous regulation&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(PA_autonomous_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(PA_autonomous_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),
            <span class="st">&#39;PA controlled regulation&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(PA_controlled_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(PA_controlled_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),
            <span class="st">&#39;PA injunctive norm&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(PA_inorm_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(PA_inorm_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),
            <span class="st">&#39;PA descriptive norm&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(PA_dnorm_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(PA_dnorm_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),
            <span class="st">&#39;PA intention&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(PA_intention_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(PA_intention_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),
            <span class="st">&#39;PA outcome expectations&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(PA_outcomeExpectations_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(PA_outcomeExpectations_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),
            <span class="st">&#39;PA opportunities&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(PA_opportunities_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(PA_opportunities_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),
            <span class="st">&#39;PA perceived behavioural control&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(PA_pbc_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(PA_pbc_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),
            <span class="st">&#39;PA self-efficacy&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(PA_selfefficacy_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(PA_selfefficacy_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),
            <span class="st">&#39;SB descriptive norm&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(SB_dnorm_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(SB_dnorm_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),
            <span class="st">&#39;SB injunctive norm&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(SB_inorm_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(SB_inorm_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),
            <span class="st">&#39;SB intention&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(SB_intention_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(SB_intention_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),
            <span class="st">&#39;SB outcome expectations&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(SB_outcomeExpectations_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(SB_outcomeExpectations_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),
            <span class="st">&#39;SB self-efficacy &amp; perceived behavioural control&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(SB_sePbc_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(SB_sePbc_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),

            <span class="st">&quot;Mean daily MVPA minutes&quot;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(paAccelerometer_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>),<span class="st">&quot; (&quot;</span>, 
                                        <span class="kw">round</span>(<span class="kw">sd</span>(paAccelerometer_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&quot;)&quot;</span>),
            <span class="st">&quot;Mean daily minutes spent sitting or lying down&quot;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(sitLieAccelerometer_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>),<span class="st">&quot; (&quot;</span>, 
                                        <span class="kw">round</span>(<span class="kw">sd</span>(sitLieAccelerometer_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&quot;)&quot;</span>),
            <span class="st">&quot;Mean daily breaks in sitting&quot;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(sitBreaks_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>),<span class="st">&quot; (&quot;</span>, 
                                        <span class="kw">round</span>(<span class="kw">sd</span>(sitBreaks_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&quot;)&quot;</span>),
            <span class="dt">n =</span> <span class="kw">n</span>()) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="kw">complete.cases</span>(.))

outtable_girl &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(paAccelerometer_T1, sitLieAccelerometer_T1, sitBreaks_T1, <span class="co"># Main outcomes </span>
          PA_actionplan_T1,
          PA_copingplan_T1,
          PA_agrbct_T1,
          PA_frqbct_T1,
          PA_amotivation_T1,
          PA_autonomous_T1,
          PA_controlled_T1,
          PA_goal_T1,
          PA_inorm_T1,
          PA_dnorm_T1,
          PA_intention_T1,
          PA_outcomeExpectations_T1,
          PA_opportunities_T1,
          PA_pbc_T1,
          PA_selfefficacy_T1,
          SB_dnorm_T1,
          SB_inorm_T1,
          SB_intention_T1,
          SB_outcomeExpectations_T1,
          SB_sePbc_T1,
         track, girl, intervention) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(girl) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarise</span>(
            <span class="st">&#39;PA action planning&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(PA_actionplan_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&quot; (&quot;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(PA_actionplan_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&quot;)&quot;</span>),
            <span class="st">&#39;PA coping planning&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(PA_copingplan_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(PA_copingplan_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),
            <span class="st">&#39;PA agreement-BCTs&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(PA_agrbct_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(PA_agrbct_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),
            <span class="st">&#39;PA frequency-BCTs&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(PA_frqbct_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(PA_frqbct_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),
            <span class="st">&#39;PA amotivation&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(PA_amotivation_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(PA_amotivation_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),
            <span class="st">&#39;PA autonomous regulation&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(PA_autonomous_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(PA_autonomous_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),
            <span class="st">&#39;PA controlled regulation&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(PA_controlled_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(PA_controlled_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),
            <span class="st">&#39;PA injunctive norm&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(PA_inorm_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(PA_inorm_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),
            <span class="st">&#39;PA descriptive norm&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(PA_dnorm_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(PA_dnorm_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),
            <span class="st">&#39;PA intention&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(PA_intention_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(PA_intention_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),
            <span class="st">&#39;PA outcome expectations&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(PA_outcomeExpectations_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(PA_outcomeExpectations_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),
            <span class="st">&#39;PA opportunities&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(PA_opportunities_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(PA_opportunities_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),
            <span class="st">&#39;PA perceived behavioural control&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(PA_pbc_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(PA_pbc_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),
            <span class="st">&#39;PA self-efficacy&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(PA_selfefficacy_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(PA_selfefficacy_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),
            <span class="st">&#39;SB descriptive norm&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(SB_dnorm_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(SB_dnorm_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),
            <span class="st">&#39;SB injunctive norm&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(SB_inorm_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(SB_inorm_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),
            <span class="st">&#39;SB intention&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(SB_intention_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(SB_intention_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),
            <span class="st">&#39;SB outcome expectations&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(SB_outcomeExpectations_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(SB_outcomeExpectations_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),
            <span class="st">&#39;SB self-efficacy &amp; perceived behavioural control&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(SB_sePbc_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(SB_sePbc_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),

            <span class="st">&quot;Mean daily MVPA minutes&quot;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(paAccelerometer_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>),<span class="st">&quot; (&quot;</span>, 
                                        <span class="kw">round</span>(<span class="kw">sd</span>(paAccelerometer_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&quot;)&quot;</span>),
            <span class="st">&quot;Mean daily minutes spent sitting or lying down&quot;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(sitLieAccelerometer_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>),<span class="st">&quot; (&quot;</span>, 
                                        <span class="kw">round</span>(<span class="kw">sd</span>(sitLieAccelerometer_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&quot;)&quot;</span>),
            <span class="st">&quot;Mean daily breaks in sitting&quot;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(sitBreaks_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>),<span class="st">&quot; (&quot;</span>, 
                                        <span class="kw">round</span>(<span class="kw">sd</span>(sitBreaks_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&quot;)&quot;</span>),
            <span class="dt">n =</span> <span class="kw">n</span>()) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="kw">complete.cases</span>(.))

outtable_total &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarise</span>(<span class="st">&#39;girl&#39;</span> =<span class="st"> &quot;Full sample&quot;</span>,
            <span class="st">&#39;PA action planning&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(PA_actionplan_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&quot; (&quot;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(PA_actionplan_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&quot;)&quot;</span>),
            <span class="st">&#39;PA coping planning&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(PA_copingplan_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(PA_copingplan_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),
            <span class="st">&#39;PA agreement-BCTs&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(PA_agrbct_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(PA_agrbct_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),
            <span class="st">&#39;PA frequency-BCTs&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(PA_frqbct_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(PA_frqbct_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),
            <span class="st">&#39;PA amotivation&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(PA_amotivation_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(PA_amotivation_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),
            <span class="st">&#39;PA autonomous regulation&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(PA_autonomous_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(PA_autonomous_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),
            <span class="st">&#39;PA controlled regulation&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(PA_controlled_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(PA_controlled_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),
            <span class="st">&#39;PA injunctive norm&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(PA_inorm_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(PA_inorm_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),
            <span class="st">&#39;PA descriptive norm&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(PA_dnorm_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(PA_dnorm_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),
            <span class="st">&#39;PA intention&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(PA_intention_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(PA_intention_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),
            <span class="st">&#39;PA outcome expectations&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(PA_outcomeExpectations_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(PA_outcomeExpectations_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),
            <span class="st">&#39;PA opportunities&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(PA_opportunities_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(PA_opportunities_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),
            <span class="st">&#39;PA perceived behavioural control&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(PA_pbc_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(PA_pbc_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),
            <span class="st">&#39;PA self-efficacy&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(PA_selfefficacy_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(PA_selfefficacy_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),
            <span class="st">&#39;SB descriptive norm&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(SB_dnorm_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(SB_dnorm_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),
            <span class="st">&#39;SB injunctive norm&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(SB_inorm_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(SB_inorm_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),
            <span class="st">&#39;SB intention&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(SB_intention_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(SB_intention_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),
            <span class="st">&#39;SB outcome expectations&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(SB_outcomeExpectations_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(SB_outcomeExpectations_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),
            <span class="st">&#39;SB self-efficacy &amp; perceived behavioural control&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(SB_sePbc_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(SB_sePbc_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),

            <span class="st">&quot;Mean daily MVPA minutes&quot;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(paAccelerometer_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>),<span class="st">&quot; (&quot;</span>, 
                                        <span class="kw">round</span>(<span class="kw">sd</span>(paAccelerometer_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&quot;)&quot;</span>),
            <span class="st">&quot;Mean daily minutes spent sitting or lying down&quot;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(sitLieAccelerometer_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>),<span class="st">&quot; (&quot;</span>, 
                                        <span class="kw">round</span>(<span class="kw">sd</span>(sitLieAccelerometer_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&quot;)&quot;</span>),
            <span class="st">&quot;Mean daily breaks in sitting&quot;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(sitBreaks_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>),<span class="st">&quot; (&quot;</span>, 
                                        <span class="kw">round</span>(<span class="kw">sd</span>(sitBreaks_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&quot;)&quot;</span>),
            <span class="dt">n =</span> <span class="kw">n</span>())



<span class="co"># Transpose each table</span>
outtable_track &lt;-<span class="st"> </span>outtable_track <span class="op">%&gt;%</span><span class="st"> </span>tidyr<span class="op">::</span><span class="kw">gather</span>(Variable, val, <span class="dv">2</span><span class="op">:</span><span class="kw">ncol</span>(.)) <span class="op">%&gt;%</span><span class="st"> </span>tidyr<span class="op">::</span><span class="kw">spread</span>(track, val)

outtable_intervention &lt;-<span class="st"> </span>outtable_intervention <span class="op">%&gt;%</span><span class="st"> </span>tidyr<span class="op">::</span><span class="kw">gather</span>(Variable, val, <span class="dv">2</span><span class="op">:</span><span class="kw">ncol</span>(.)) <span class="op">%&gt;%</span><span class="st"> </span>tidyr<span class="op">::</span><span class="kw">spread</span>(intervention, val)
<span class="kw">names</span>(outtable_intervention) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Variable&quot;</span>, <span class="st">&quot;Control&quot;</span>, <span class="st">&quot;Intervention&quot;</span>)

## In the last table, have a column for total before transposing
outtable_girl &lt;-<span class="st"> </span><span class="kw">bind_rows</span>(outtable_girl, outtable_total)
## Warning in bind_rows_(x, .id): binding factor and character vector,
## coercing into character vector
## Warning in bind_rows_(x, .id): binding character and factor vector,
## coercing into character vector
outtable_girl &lt;-<span class="st"> </span>outtable_girl <span class="op">%&gt;%</span><span class="st"> </span>tidyr<span class="op">::</span><span class="kw">gather</span>(Variable, val, <span class="dv">2</span><span class="op">:</span><span class="kw">ncol</span>(.)) <span class="op">%&gt;%</span><span class="st"> </span>tidyr<span class="op">::</span><span class="kw">spread</span>(girl, val)
<span class="kw">names</span>(outtable_girl) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Variable&quot;</span>, <span class="st">&quot;Boy&quot;</span>, <span class="st">&quot;Girl&quot;</span>, <span class="st">&quot;Full sample&quot;</span>)

<span class="co"># Are all variables the same?</span>
<span class="kw">identical</span>(outtable_track<span class="op">$</span>Variable, outtable_girl<span class="op">$</span>Variable)</code></pre></div>
<p>[1] TRUE</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">identical</span>(outtable_track<span class="op">$</span>Variable, outtable_intervention<span class="op">$</span>Variable)</code></pre></div>
<p>[1] TRUE</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># Create large table with all variables</span>
outtable_mega &lt;-<span class="st"> </span><span class="kw">bind_cols</span>(outtable_track, outtable_intervention, outtable_girl) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>Variable1, <span class="op">-</span>Variable2) 

<span class="co"># Move n to be the first row</span>
out1 &lt;-<span class="st"> </span>outtable_mega <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(Variable <span class="op">==</span><span class="st"> &quot;n&quot;</span>)
out2 &lt;-<span class="st"> </span>outtable_mega <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(Variable <span class="op">!=</span><span class="st"> &quot;n&quot;</span>)
outtable_mega &lt;-<span class="st"> </span><span class="kw">bind_rows</span>(out1, out2)

<span class="co"># Fix names: leave first blank, have the rest as they were</span>
<span class="kw">names</span>(outtable_mega) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;&quot;</span>, <span class="kw">names</span>(outtable_mega)[<span class="dv">2</span><span class="op">:</span>(<span class="kw">length</span>(<span class="kw">names</span>(outtable_mega)))])

papaja<span class="op">::</span><span class="kw">apa_table</span>(outtable_mega, <span class="dt">caption =</span> <span class="st">&quot;Baseline demographics of educational tracks&quot;</span>)</code></pre></div>
<caption>
(#tab:outcome-table)
</caption>
<caption>
<em>Baseline demographics of educational tracks</em>
</caption>
<table>
<thead>
<tr class="header">
<th></th>
<th align="left">IT</th>
<th align="left">BA</th>
<th align="left">HRC</th>
<th align="left">Nur</th>
<th align="left">Control</th>
<th align="left">Intervention</th>
<th align="left">Boy</th>
<th align="left">Girl</th>
<th align="left">Full sample</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>n</td>
<td align="left">163</td>
<td align="left">282</td>
<td align="left">213</td>
<td align="left">402</td>
<td align="left">503</td>
<td align="left">581</td>
<td align="left">471</td>
<td align="left">1165</td>
<td align="left">613</td>
</tr>
<tr class="even">
<td>Mean daily breaks in sitting</td>
<td align="left">20 (9)</td>
<td align="left">27.5 (10)</td>
<td align="left">27.5 (9.6)</td>
<td align="left">31.7 (11.3)</td>
<td align="left">27.2 (10.4)</td>
<td align="left">29 (11.6)</td>
<td align="left">23.4 (9.5)</td>
<td align="left">28.2 (11.1)</td>
<td align="left">31.3 (11)</td>
</tr>
<tr class="odd">
<td>Mean daily minutes spent sitting or lying down</td>
<td align="left">652.8 (86.3)</td>
<td align="left">586.8 (93)</td>
<td align="left">557.8 (101.2)</td>
<td align="left">554.4 (82.1)</td>
<td align="left">568.5 (100.9)</td>
<td align="left">585.9 (92.7)</td>
<td align="left">612.5 (95.6)</td>
<td align="left">578.2 (97.2)</td>
<td align="left">554.9 (90.9)</td>
</tr>
<tr class="even">
<td>Mean daily MVPA minutes</td>
<td align="left">141.3 (51.6)</td>
<td align="left">179.6 (48.4)</td>
<td align="left">183.1 (52.2)</td>
<td align="left">201.2 (49.2)</td>
<td align="left">179.5 (52)</td>
<td align="left">187.3 (55.1)</td>
<td align="left">173.5 (59.4)</td>
<td align="left">183.8 (53.8)</td>
<td align="left">190.4 (48.6)</td>
</tr>
<tr class="odd">
<td>PA action planning</td>
<td align="left">2.4 (1.1)</td>
<td align="left">2.9 (0.9)</td>
<td align="left">2.8 (0.9)</td>
<td align="left">2.8 (0.9)</td>
<td align="left">2.8 (1)</td>
<td align="left">2.7 (0.9)</td>
<td align="left">2.8 (1)</td>
<td align="left">2.8 (0.9)</td>
<td align="left">2.7 (0.9)</td>
</tr>
<tr class="even">
<td>PA agreement-BCTs</td>
<td align="left">2.6 (1.3)</td>
<td align="left">3.5 (1.2)</td>
<td align="left">3.1 (1.3)</td>
<td align="left">3 (1.3)</td>
<td align="left">3.2 (1.3)</td>
<td align="left">3 (1.3)</td>
<td align="left">3.1 (1.4)</td>
<td align="left">3.1 (1.3)</td>
<td align="left">3.1 (1.3)</td>
</tr>
<tr class="odd">
<td>PA amotivation</td>
<td align="left">1.8 (1)</td>
<td align="left">1.5 (0.8)</td>
<td align="left">1.5 (0.8)</td>
<td align="left">1.4 (0.7)</td>
<td align="left">1.6 (0.8)</td>
<td align="left">1.5 (0.8)</td>
<td align="left">1.6 (0.9)</td>
<td align="left">1.5 (0.8)</td>
<td align="left">1.5 (0.7)</td>
</tr>
<tr class="even">
<td>PA autonomous regulation</td>
<td align="left">2.9 (1.1)</td>
<td align="left">3.6 (1)</td>
<td align="left">3.4 (1.1)</td>
<td align="left">3.5 (1)</td>
<td align="left">3.5 (1)</td>
<td align="left">3.4 (1.1)</td>
<td align="left">3.5 (1.1)</td>
<td align="left">3.4 (1.1)</td>
<td align="left">3.4 (1)</td>
</tr>
<tr class="odd">
<td>PA controlled regulation</td>
<td align="left">1.9 (0.8)</td>
<td align="left">1.8 (0.8)</td>
<td align="left">1.8 (0.9)</td>
<td align="left">1.8 (0.8)</td>
<td align="left">1.9 (0.9)</td>
<td align="left">1.8 (0.8)</td>
<td align="left">1.8 (0.8)</td>
<td align="left">1.8 (0.8)</td>
<td align="left">1.9 (0.8)</td>
</tr>
<tr class="even">
<td>PA coping planning</td>
<td align="left">2.2 (0.9)</td>
<td align="left">2.7 (0.8)</td>
<td align="left">2.5 (0.9)</td>
<td align="left">2.5 (0.9)</td>
<td align="left">2.5 (0.9)</td>
<td align="left">2.5 (0.9)</td>
<td align="left">2.6 (0.9)</td>
<td align="left">2.5 (0.9)</td>
<td align="left">2.5 (0.8)</td>
</tr>
<tr class="odd">
<td>PA descriptive norm</td>
<td align="left">3.8 (1.6)</td>
<td align="left">4.8 (1.5)</td>
<td align="left">4.5 (1.5)</td>
<td align="left">4.2 (1.6)</td>
<td align="left">4.5 (1.6)</td>
<td align="left">4.3 (1.6)</td>
<td align="left">4.5 (1.6)</td>
<td align="left">4.4 (1.6)</td>
<td align="left">4.3 (1.6)</td>
</tr>
<tr class="even">
<td>PA frequency-BCTs</td>
<td align="left">2.2 (1.1)</td>
<td align="left">2.8 (1.2)</td>
<td align="left">2.5 (1.1)</td>
<td align="left">2.5 (1.1)</td>
<td align="left">2.6 (1.1)</td>
<td align="left">2.5 (1.1)</td>
<td align="left">2.6 (1.2)</td>
<td align="left">2.5 (1.1)</td>
<td align="left">2.5 (1.1)</td>
</tr>
<tr class="odd">
<td>PA injunctive norm</td>
<td align="left">4.7 (2)</td>
<td align="left">4.8 (2)</td>
<td align="left">4.7 (2)</td>
<td align="left">4.5 (2)</td>
<td align="left">4.8 (2)</td>
<td align="left">4.5 (2)</td>
<td align="left">4.8 (2)</td>
<td align="left">4.6 (2)</td>
<td align="left">4.6 (2)</td>
</tr>
<tr class="even">
<td>PA intention</td>
<td align="left">4.3 (2.1)</td>
<td align="left">5.7 (1.7)</td>
<td align="left">5.5 (1.8)</td>
<td align="left">5.5 (1.7)</td>
<td align="left">5.4 (1.9)</td>
<td align="left">5.4 (1.8)</td>
<td align="left">5.3 (1.9)</td>
<td align="left">5.4 (1.8)</td>
<td align="left">5.4 (1.8)</td>
</tr>
<tr class="odd">
<td>PA opportunities</td>
<td align="left">5.1 (0.9)</td>
<td align="left">5.2 (1)</td>
<td align="left">5.1 (0.9)</td>
<td align="left">5.1 (1)</td>
<td align="left">5.2 (0.9)</td>
<td align="left">5.1 (1)</td>
<td align="left">5.2 (0.9)</td>
<td align="left">5.1 (0.9)</td>
<td align="left">5.1 (1)</td>
</tr>
<tr class="even">
<td>PA outcome expectations</td>
<td align="left">4.3 (0.9)</td>
<td align="left">4.6 (0.9)</td>
<td align="left">4.6 (0.9)</td>
<td align="left">4.7 (0.9)</td>
<td align="left">4.6 (0.9)</td>
<td align="left">4.6 (0.9)</td>
<td align="left">4.5 (0.9)</td>
<td align="left">4.6 (0.9)</td>
<td align="left">4.7 (0.9)</td>
</tr>
<tr class="odd">
<td>PA perceived behavioural control</td>
<td align="left">5.3 (1.3)</td>
<td align="left">5.5 (1.2)</td>
<td align="left">5.2 (1.3)</td>
<td align="left">5.3 (1.3)</td>
<td align="left">5.3 (1.3)</td>
<td align="left">5.3 (1.3)</td>
<td align="left">5.5 (1.2)</td>
<td align="left">5.3 (1.3)</td>
<td align="left">5.2 (1.3)</td>
</tr>
<tr class="even">
<td>PA self-efficacy</td>
<td align="left">5.2 (1.3)</td>
<td align="left">5.4 (1.4)</td>
<td align="left">5.1 (1.2)</td>
<td align="left">5.2 (1.3)</td>
<td align="left">5.3 (1.3)</td>
<td align="left">5.2 (1.3)</td>
<td align="left">5.3 (1.3)</td>
<td align="left">5.2 (1.3)</td>
<td align="left">5.1 (1.3)</td>
</tr>
<tr class="odd">
<td>SB descriptive norm</td>
<td align="left">2.8 (1.5)</td>
<td align="left">3.2 (1.4)</td>
<td align="left">3.4 (1.4)</td>
<td align="left">3.4 (1.5)</td>
<td align="left">3.3 (1.4)</td>
<td align="left">3.2 (1.5)</td>
<td align="left">3.3 (1.5)</td>
<td align="left">3.2 (1.5)</td>
<td align="left">3.2 (1.4)</td>
</tr>
<tr class="even">
<td>SB injunctive norm</td>
<td align="left">4 (1.1)</td>
<td align="left">3.8 (1.3)</td>
<td align="left">4 (1.2)</td>
<td align="left">4.1 (1.3)</td>
<td align="left">4.1 (1.2)</td>
<td align="left">3.9 (1.3)</td>
<td align="left">4 (1.2)</td>
<td align="left">4 (1.3)</td>
<td align="left">4 (1.3)</td>
</tr>
<tr class="odd">
<td>SB intention</td>
<td align="left">3 (1.6)</td>
<td align="left">3.6 (1.5)</td>
<td align="left">3.7 (1.6)</td>
<td align="left">4 (1.6)</td>
<td align="left">3.7 (1.6)</td>
<td align="left">3.7 (1.6)</td>
<td align="left">3.5 (1.7)</td>
<td align="left">3.7 (1.6)</td>
<td align="left">3.9 (1.6)</td>
</tr>
<tr class="even">
<td>SB outcome expectations</td>
<td align="left">4.1 (1.1)</td>
<td align="left">4.4 (1)</td>
<td align="left">4.4 (1)</td>
<td align="left">4.5 (1)</td>
<td align="left">4.4 (1)</td>
<td align="left">4.4 (1.1)</td>
<td align="left">4.3 (1.1)</td>
<td align="left">4.4 (1)</td>
<td align="left">4.5 (1)</td>
</tr>
<tr class="odd">
<td>SB self-efficacy &amp; perceived behavioural control</td>
<td align="left">5 (1.3)</td>
<td align="left">4.9 (1.2)</td>
<td align="left">5.1 (1.2)</td>
<td align="left">4.9 (1.3)</td>
<td align="left">5.1 (1.2)</td>
<td align="left">4.9 (1.3)</td>
<td align="left">5 (1.3)</td>
<td align="left">4.9 (1.3)</td>
<td align="left">4.9 (1.2)</td>
</tr>
</tbody>
</table>
</div>
<div id="mediator-table-with-cis" class="section level2">
<h2>Mediator table with CIs</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
mediatortable_intervention &lt;-<span class="st"> </span>ci_intervention <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="kw">grepl</span>(<span class="st">&#39;PA_actionplan_T1|PA_copingplan_T1|PA_agrbct_T1|PA_frqbct_T1|PA_amotivation_T1|PA_autonomous_T1|PA_controlled_T1|PA_goal_T1|PA_inorm_T1|PA_dnorm_T1|PA_intention_T1|PA_outcomeExpectations_T1|PA_opportunities_T1|PA_pbc_T1|PA_selfefficacy_T1|SB_dnorm_T1|SB_inorm_T1|SB_intention_T1|SB_outcomeExpectations_T1&#39;</span>, ci_intervention<span class="op">$</span>diamondlabels)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(diamondlabels <span class="op">!=</span><span class="st"> &quot;PA_goal_T1&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="st">&quot;CI95&quot;</span> =<span class="st"> </span><span class="kw">paste</span>(<span class="kw">round</span>(ciLo, <span class="dv">1</span>), <span class="st">&quot;-&quot;</span>, <span class="kw">round</span>(ciHi, <span class="dv">1</span>)),
         <span class="dt">mean =</span> <span class="kw">round</span>(mean, <span class="dv">1</span>))

mediatortable_intervention<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_actionplan_T1&#39;</span>, <span class="st">&#39;PA action planning&#39;</span>, mediatortable_intervention<span class="op">$</span>diamondlabels)
mediatortable_intervention<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_copingplan_T1&#39;</span>, <span class="st">&#39;PA coping planning&#39;</span>, mediatortable_intervention<span class="op">$</span>diamondlabels)
mediatortable_intervention<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_agrbct_T1&#39;</span>, <span class="st">&#39;PA agreement-BCTs&#39;</span>, mediatortable_intervention<span class="op">$</span>diamondlabels)
mediatortable_intervention<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_frqbct_T1&#39;</span>, <span class="st">&#39;PA frequency-BCTs&#39;</span>, mediatortable_intervention<span class="op">$</span>diamondlabels)
mediatortable_intervention<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_amotivation_T1&#39;</span>, <span class="st">&#39;PA amotivation&#39;</span>, mediatortable_intervention<span class="op">$</span>diamondlabels)
mediatortable_intervention<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_autonomous_T1&#39;</span>, <span class="st">&#39;PA autonomous regulation&#39;</span>, mediatortable_intervention<span class="op">$</span>diamondlabels)
mediatortable_intervention<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_controlled_T1&#39;</span>, <span class="st">&#39;PA controlled regulation&#39;</span>, mediatortable_intervention<span class="op">$</span>diamondlabels)
mediatortable_intervention<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_inorm_T1&#39;</span>, <span class="st">&#39;PA injunctive norm&#39;</span>, mediatortable_intervention<span class="op">$</span>diamondlabels)
mediatortable_intervention<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_dnorm_T1&#39;</span>, <span class="st">&#39;PA descriptive norm&#39;</span>, mediatortable_intervention<span class="op">$</span>diamondlabels)
mediatortable_intervention<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_intention_T1&#39;</span>, <span class="st">&#39;PA intention&#39;</span>, mediatortable_intervention<span class="op">$</span>diamondlabels)
mediatortable_intervention<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_outcomeExpectations_T1&#39;</span>, <span class="st">&#39;PA outcome expectations&#39;</span>, mediatortable_intervention<span class="op">$</span>diamondlabels)
mediatortable_intervention<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_opportunities_T1&#39;</span>, <span class="st">&#39;PA opportunities&#39;</span>, mediatortable_intervention<span class="op">$</span>diamondlabels)
mediatortable_intervention<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_pbc_T1&#39;</span>, <span class="st">&#39;PA perceived behavioural control&#39;</span>, mediatortable_intervention<span class="op">$</span>diamondlabels)
mediatortable_intervention<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_selfefficacy_T1&#39;</span>, <span class="st">&#39;PA self-efficacy&#39;</span>, mediatortable_intervention<span class="op">$</span>diamondlabels)
mediatortable_intervention<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;SB_dnorm_T1&#39;</span>, <span class="st">&#39;SB descriptive norm&#39;</span>, mediatortable_intervention<span class="op">$</span>diamondlabels)
mediatortable_intervention<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;SB_inorm_T1&#39;</span>, <span class="st">&#39;SB injunctive norm&#39;</span>, mediatortable_intervention<span class="op">$</span>diamondlabels)
mediatortable_intervention<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;SB_intention_T1&#39;</span>, <span class="st">&#39;SB intention&#39;</span>, mediatortable_intervention<span class="op">$</span>diamondlabels)
mediatortable_intervention<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;SB_outcomeExpectations_T1&#39;</span>, <span class="st">&#39;SB outcome expectations&#39;</span>, mediatortable_intervention<span class="op">$</span>diamondlabels)

mediatortable_control &lt;-<span class="st"> </span>ci_control <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="kw">grepl</span>(<span class="st">&#39;PA_actionplan_T1|PA_copingplan_T1|PA_agrbct_T1|PA_frqbct_T1|PA_amotivation_T1|PA_autonomous_T1|PA_controlled_T1|PA_goal_T1|PA_inorm_T1|PA_dnorm_T1|PA_intention_T1|PA_outcomeExpectations_T1|PA_opportunities_T1|PA_pbc_T1|PA_selfefficacy_T1|SB_dnorm_T1|SB_inorm_T1|SB_intention_T1|SB_outcomeExpectations_T1&#39;</span>, ci_control<span class="op">$</span>diamondlabels)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(diamondlabels <span class="op">!=</span><span class="st"> &quot;PA_goal_T1&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="st">&quot;CI95&quot;</span> =<span class="st"> </span><span class="kw">paste</span>(<span class="kw">round</span>(ciLo, <span class="dv">1</span>), <span class="st">&quot;-&quot;</span>, <span class="kw">round</span>(ciHi, <span class="dv">1</span>)),
         <span class="dt">mean =</span> <span class="kw">round</span>(mean, <span class="dv">1</span>))

mediatortable_control<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_actionplan_T1&#39;</span>, <span class="st">&#39;PA action planning&#39;</span>, mediatortable_control<span class="op">$</span>diamondlabels)
mediatortable_control<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_copingplan_T1&#39;</span>, <span class="st">&#39;PA coping planning&#39;</span>, mediatortable_control<span class="op">$</span>diamondlabels)
mediatortable_control<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_agrbct_T1&#39;</span>, <span class="st">&#39;PA agreement-BCTs&#39;</span>, mediatortable_control<span class="op">$</span>diamondlabels)
mediatortable_control<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_frqbct_T1&#39;</span>, <span class="st">&#39;PA frequency-BCTs&#39;</span>, mediatortable_control<span class="op">$</span>diamondlabels)
mediatortable_control<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_amotivation_T1&#39;</span>, <span class="st">&#39;PA amotivation&#39;</span>, mediatortable_control<span class="op">$</span>diamondlabels)
mediatortable_control<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_autonomous_T1&#39;</span>, <span class="st">&#39;PA autonomous regulation&#39;</span>, mediatortable_control<span class="op">$</span>diamondlabels)
mediatortable_control<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_controlled_T1&#39;</span>, <span class="st">&#39;PA controlled regulation&#39;</span>, mediatortable_control<span class="op">$</span>diamondlabels)
mediatortable_control<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_inorm_T1&#39;</span>, <span class="st">&#39;PA injunctive norm&#39;</span>, mediatortable_control<span class="op">$</span>diamondlabels)
mediatortable_control<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_dnorm_T1&#39;</span>, <span class="st">&#39;PA descriptive norm&#39;</span>, mediatortable_control<span class="op">$</span>diamondlabels)
mediatortable_control<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_intention_T1&#39;</span>, <span class="st">&#39;PA intention&#39;</span>, mediatortable_control<span class="op">$</span>diamondlabels)
mediatortable_control<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_outcomeExpectations_T1&#39;</span>, <span class="st">&#39;PA outcome expectations&#39;</span>, mediatortable_control<span class="op">$</span>diamondlabels)
mediatortable_control<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_opportunities_T1&#39;</span>, <span class="st">&#39;PA opportunities&#39;</span>, mediatortable_control<span class="op">$</span>diamondlabels)
mediatortable_control<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_pbc_T1&#39;</span>, <span class="st">&#39;PA perceived behavioural control&#39;</span>, mediatortable_control<span class="op">$</span>diamondlabels)
mediatortable_control<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_selfefficacy_T1&#39;</span>, <span class="st">&#39;PA self-efficacy&#39;</span>, mediatortable_control<span class="op">$</span>diamondlabels)
mediatortable_control<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;SB_dnorm_T1&#39;</span>, <span class="st">&#39;SB descriptive norm&#39;</span>, mediatortable_control<span class="op">$</span>diamondlabels)
mediatortable_control<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;SB_inorm_T1&#39;</span>, <span class="st">&#39;SB injunctive norm&#39;</span>, mediatortable_control<span class="op">$</span>diamondlabels)
mediatortable_control<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;SB_intention_T1&#39;</span>, <span class="st">&#39;SB intention&#39;</span>, mediatortable_control<span class="op">$</span>diamondlabels)
mediatortable_control<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;SB_outcomeExpectations_T1&#39;</span>, <span class="st">&#39;SB outcome expectations&#39;</span>, mediatortable_control<span class="op">$</span>diamondlabels)

mediatortable_girls &lt;-<span class="st"> </span>ci_girls <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="kw">grepl</span>(<span class="st">&#39;PA_actionplan_T1|PA_copingplan_T1|PA_agrbct_T1|PA_frqbct_T1|PA_amotivation_T1|PA_autonomous_T1|PA_controlled_T1|PA_goal_T1|PA_inorm_T1|PA_dnorm_T1|PA_intention_T1|PA_outcomeExpectations_T1|PA_opportunities_T1|PA_pbc_T1|PA_selfefficacy_T1|SB_dnorm_T1|SB_inorm_T1|SB_intention_T1|SB_outcomeExpectations_T1&#39;</span>, ci_girls<span class="op">$</span>diamondlabels)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(diamondlabels <span class="op">!=</span><span class="st"> &quot;PA_goal_T1&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="st">&quot;CI95&quot;</span> =<span class="st"> </span><span class="kw">paste</span>(<span class="kw">round</span>(ciLo, <span class="dv">1</span>), <span class="st">&quot;-&quot;</span>, <span class="kw">round</span>(ciHi, <span class="dv">1</span>)),
         <span class="dt">mean =</span> <span class="kw">round</span>(mean, <span class="dv">1</span>))

mediatortable_girls<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_actionplan_T1&#39;</span>, <span class="st">&#39;PA action planning&#39;</span>, mediatortable_girls<span class="op">$</span>diamondlabels)
mediatortable_girls<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_copingplan_T1&#39;</span>, <span class="st">&#39;PA coping planning&#39;</span>, mediatortable_girls<span class="op">$</span>diamondlabels)
mediatortable_girls<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_agrbct_T1&#39;</span>, <span class="st">&#39;PA agreement-BCTs&#39;</span>, mediatortable_girls<span class="op">$</span>diamondlabels)
mediatortable_girls<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_frqbct_T1&#39;</span>, <span class="st">&#39;PA frequency-BCTs&#39;</span>, mediatortable_girls<span class="op">$</span>diamondlabels)
mediatortable_girls<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_amotivation_T1&#39;</span>, <span class="st">&#39;PA amotivation&#39;</span>, mediatortable_girls<span class="op">$</span>diamondlabels)
mediatortable_girls<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_autonomous_T1&#39;</span>, <span class="st">&#39;PA autonomous regulation&#39;</span>, mediatortable_girls<span class="op">$</span>diamondlabels)
mediatortable_girls<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_controlled_T1&#39;</span>, <span class="st">&#39;PA controlled regulation&#39;</span>, mediatortable_girls<span class="op">$</span>diamondlabels)
mediatortable_girls<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_inorm_T1&#39;</span>, <span class="st">&#39;PA injunctive norm&#39;</span>, mediatortable_girls<span class="op">$</span>diamondlabels)
mediatortable_girls<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_dnorm_T1&#39;</span>, <span class="st">&#39;PA descriptive norm&#39;</span>, mediatortable_girls<span class="op">$</span>diamondlabels)
mediatortable_girls<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_intention_T1&#39;</span>, <span class="st">&#39;PA intention&#39;</span>, mediatortable_girls<span class="op">$</span>diamondlabels)
mediatortable_girls<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_outcomeExpectations_T1&#39;</span>, <span class="st">&#39;PA outcome expectations&#39;</span>, mediatortable_girls<span class="op">$</span>diamondlabels)
mediatortable_girls<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_opportunities_T1&#39;</span>, <span class="st">&#39;PA opportunities&#39;</span>, mediatortable_girls<span class="op">$</span>diamondlabels)
mediatortable_girls<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_pbc_T1&#39;</span>, <span class="st">&#39;PA perceived behavioural control&#39;</span>, mediatortable_girls<span class="op">$</span>diamondlabels)
mediatortable_girls<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_selfefficacy_T1&#39;</span>, <span class="st">&#39;PA self-efficacy&#39;</span>, mediatortable_girls<span class="op">$</span>diamondlabels)
mediatortable_girls<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;SB_dnorm_T1&#39;</span>, <span class="st">&#39;SB descriptive norm&#39;</span>, mediatortable_girls<span class="op">$</span>diamondlabels)
mediatortable_girls<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;SB_inorm_T1&#39;</span>, <span class="st">&#39;SB injunctive norm&#39;</span>, mediatortable_girls<span class="op">$</span>diamondlabels)
mediatortable_girls<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;SB_intention_T1&#39;</span>, <span class="st">&#39;SB intention&#39;</span>, mediatortable_girls<span class="op">$</span>diamondlabels)
mediatortable_girls<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;SB_outcomeExpectations_T1&#39;</span>, <span class="st">&#39;SB outcome expectations&#39;</span>, mediatortable_girls<span class="op">$</span>diamondlabels)

mediatortable_boys &lt;-<span class="st"> </span>ci_boys <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="kw">grepl</span>(<span class="st">&#39;PA_actionplan_T1|PA_copingplan_T1|PA_agrbct_T1|PA_frqbct_T1|PA_amotivation_T1|PA_autonomous_T1|PA_controlled_T1|PA_goal_T1|PA_inorm_T1|PA_dnorm_T1|PA_intention_T1|PA_outcomeExpectations_T1|PA_opportunities_T1|PA_pbc_T1|PA_selfefficacy_T1|SB_dnorm_T1|SB_inorm_T1|SB_intention_T1|SB_outcomeExpectations_T1&#39;</span>, ci_boys<span class="op">$</span>diamondlabels)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(diamondlabels <span class="op">!=</span><span class="st"> &quot;PA_goal_T1&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="st">&quot;CI95&quot;</span> =<span class="st"> </span><span class="kw">paste</span>(<span class="kw">round</span>(ciLo, <span class="dv">1</span>), <span class="st">&quot;-&quot;</span>, <span class="kw">round</span>(ciHi, <span class="dv">1</span>)),
         <span class="dt">mean =</span> <span class="kw">round</span>(mean, <span class="dv">1</span>))

mediatortable_boys<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_actionplan_T1&#39;</span>, <span class="st">&#39;PA action planning&#39;</span>, mediatortable_boys<span class="op">$</span>diamondlabels)
mediatortable_boys<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_copingplan_T1&#39;</span>, <span class="st">&#39;PA coping planning&#39;</span>, mediatortable_boys<span class="op">$</span>diamondlabels)
mediatortable_boys<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_agrbct_T1&#39;</span>, <span class="st">&#39;PA agreement-BCTs&#39;</span>, mediatortable_boys<span class="op">$</span>diamondlabels)
mediatortable_boys<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_frqbct_T1&#39;</span>, <span class="st">&#39;PA frequency-BCTs&#39;</span>, mediatortable_boys<span class="op">$</span>diamondlabels)
mediatortable_boys<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_amotivation_T1&#39;</span>, <span class="st">&#39;PA amotivation&#39;</span>, mediatortable_boys<span class="op">$</span>diamondlabels)
mediatortable_boys<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_autonomous_T1&#39;</span>, <span class="st">&#39;PA autonomous regulation&#39;</span>, mediatortable_boys<span class="op">$</span>diamondlabels)
mediatortable_boys<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_controlled_T1&#39;</span>, <span class="st">&#39;PA controlled regulation&#39;</span>, mediatortable_boys<span class="op">$</span>diamondlabels)
mediatortable_boys<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_inorm_T1&#39;</span>, <span class="st">&#39;PA injunctive norm&#39;</span>, mediatortable_boys<span class="op">$</span>diamondlabels)
mediatortable_boys<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_dnorm_T1&#39;</span>, <span class="st">&#39;PA descriptive norm&#39;</span>, mediatortable_boys<span class="op">$</span>diamondlabels)
mediatortable_boys<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_intention_T1&#39;</span>, <span class="st">&#39;PA intention&#39;</span>, mediatortable_boys<span class="op">$</span>diamondlabels)
mediatortable_boys<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_outcomeExpectations_T1&#39;</span>, <span class="st">&#39;PA outcome expectations&#39;</span>, mediatortable_boys<span class="op">$</span>diamondlabels)
mediatortable_boys<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_opportunities_T1&#39;</span>, <span class="st">&#39;PA opportunities&#39;</span>, mediatortable_boys<span class="op">$</span>diamondlabels)
mediatortable_boys<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_pbc_T1&#39;</span>, <span class="st">&#39;PA perceived behavioural control&#39;</span>, mediatortable_boys<span class="op">$</span>diamondlabels)
mediatortable_boys<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_selfefficacy_T1&#39;</span>, <span class="st">&#39;PA self-efficacy&#39;</span>, mediatortable_boys<span class="op">$</span>diamondlabels)
mediatortable_boys<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;SB_dnorm_T1&#39;</span>, <span class="st">&#39;SB descriptive norm&#39;</span>, mediatortable_boys<span class="op">$</span>diamondlabels)
mediatortable_boys<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;SB_inorm_T1&#39;</span>, <span class="st">&#39;SB injunctive norm&#39;</span>, mediatortable_boys<span class="op">$</span>diamondlabels)
mediatortable_boys<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;SB_intention_T1&#39;</span>, <span class="st">&#39;SB intention&#39;</span>, mediatortable_boys<span class="op">$</span>diamondlabels)
mediatortable_boys<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;SB_outcomeExpectations_T1&#39;</span>, <span class="st">&#39;SB outcome expectations&#39;</span>, mediatortable_boys<span class="op">$</span>diamondlabels)

mediatortable_total &lt;-<span class="st"> </span>ci_total <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="kw">grepl</span>(<span class="st">&#39;PA_actionplan_T1|PA_copingplan_T1|PA_agrbct_T1|PA_frqbct_T1|PA_amotivation_T1|PA_autonomous_T1|PA_controlled_T1|PA_goal_T1|PA_inorm_T1|PA_dnorm_T1|PA_intention_T1|PA_outcomeExpectations_T1|PA_opportunities_T1|PA_pbc_T1|PA_selfefficacy_T1|SB_dnorm_T1|SB_inorm_T1|SB_intention_T1|SB_outcomeExpectations_T1&#39;</span>, ci_total<span class="op">$</span>diamondlabels)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(diamondlabels <span class="op">!=</span><span class="st"> &quot;PA_goal_T1&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="st">&quot;CI95&quot;</span> =<span class="st"> </span><span class="kw">paste</span>(<span class="kw">round</span>(ciLo, <span class="dv">1</span>), <span class="st">&quot;-&quot;</span>, <span class="kw">round</span>(ciHi, <span class="dv">1</span>)),
         <span class="dt">mean =</span> <span class="kw">round</span>(mean, <span class="dv">1</span>))

mediatortable_total<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_actionplan_T1&#39;</span>, <span class="st">&#39;PA action planning&#39;</span>, mediatortable_total<span class="op">$</span>diamondlabels)
mediatortable_total<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_copingplan_T1&#39;</span>, <span class="st">&#39;PA coping planning&#39;</span>, mediatortable_total<span class="op">$</span>diamondlabels)
mediatortable_total<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_agrbct_T1&#39;</span>, <span class="st">&#39;PA agreement-BCTs&#39;</span>, mediatortable_total<span class="op">$</span>diamondlabels)
mediatortable_total<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_frqbct_T1&#39;</span>, <span class="st">&#39;PA frequency-BCTs&#39;</span>, mediatortable_total<span class="op">$</span>diamondlabels)
mediatortable_total<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_amotivation_T1&#39;</span>, <span class="st">&#39;PA amotivation&#39;</span>, mediatortable_total<span class="op">$</span>diamondlabels)
mediatortable_total<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_autonomous_T1&#39;</span>, <span class="st">&#39;PA autonomous regulation&#39;</span>, mediatortable_total<span class="op">$</span>diamondlabels)
mediatortable_total<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_controlled_T1&#39;</span>, <span class="st">&#39;PA controlled regulation&#39;</span>, mediatortable_total<span class="op">$</span>diamondlabels)
mediatortable_total<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_inorm_T1&#39;</span>, <span class="st">&#39;PA injunctive norm&#39;</span>, mediatortable_total<span class="op">$</span>diamondlabels)
mediatortable_total<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_dnorm_T1&#39;</span>, <span class="st">&#39;PA descriptive norm&#39;</span>, mediatortable_total<span class="op">$</span>diamondlabels)
mediatortable_total<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_intention_T1&#39;</span>, <span class="st">&#39;PA intention&#39;</span>, mediatortable_total<span class="op">$</span>diamondlabels)
mediatortable_total<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_outcomeExpectations_T1&#39;</span>, <span class="st">&#39;PA outcome expectations&#39;</span>, mediatortable_total<span class="op">$</span>diamondlabels)
mediatortable_total<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_opportunities_T1&#39;</span>, <span class="st">&#39;PA opportunities&#39;</span>, mediatortable_total<span class="op">$</span>diamondlabels)
mediatortable_total<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_pbc_T1&#39;</span>, <span class="st">&#39;PA perceived behavioural control&#39;</span>, mediatortable_total<span class="op">$</span>diamondlabels)
mediatortable_total<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_selfefficacy_T1&#39;</span>, <span class="st">&#39;PA self-efficacy&#39;</span>, mediatortable_total<span class="op">$</span>diamondlabels)
mediatortable_total<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;SB_dnorm_T1&#39;</span>, <span class="st">&#39;SB descriptive norm&#39;</span>, mediatortable_total<span class="op">$</span>diamondlabels)
mediatortable_total<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;SB_inorm_T1&#39;</span>, <span class="st">&#39;SB injunctive norm&#39;</span>, mediatortable_total<span class="op">$</span>diamondlabels)
mediatortable_total<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;SB_intention_T1&#39;</span>, <span class="st">&#39;SB intention&#39;</span>, mediatortable_total<span class="op">$</span>diamondlabels)
mediatortable_total<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;SB_outcomeExpectations_T1&#39;</span>, <span class="st">&#39;SB outcome expectations&#39;</span>, mediatortable_total<span class="op">$</span>diamondlabels)

mega_mediatortable &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">Variable =</span> mediatortable_girls<span class="op">$</span>diamondlabels, 
                                 <span class="st">&quot;Girls&quot;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(mediatortable_girls<span class="op">$</span>mean, <span class="dv">2</span>), <span class="st">&quot; (&quot;</span>, mediatortable_girls<span class="op">$</span>CI95, <span class="st">&quot;)&quot;</span>),
                                 <span class="st">&quot;Boys&quot;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(mediatortable_boys<span class="op">$</span>mean, <span class="dv">2</span>), <span class="st">&quot; (&quot;</span>, mediatortable_boys<span class="op">$</span>CI95, <span class="st">&quot;)&quot;</span>),
                                 <span class="st">&quot;Intervention&quot;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(mediatortable_intervention<span class="op">$</span>mean, <span class="dv">2</span>), <span class="st">&quot; (&quot;</span>, mediatortable_intervention<span class="op">$</span>CI95, <span class="st">&quot;)&quot;</span>),
                                 <span class="st">&quot;Control&quot;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(mediatortable_control<span class="op">$</span>mean, <span class="dv">2</span>), <span class="st">&quot; (&quot;</span>, mediatortable_control<span class="op">$</span>CI95, <span class="st">&quot;)&quot;</span>),
                                 <span class="st">&quot;Total&quot;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(mediatortable_total<span class="op">$</span>mean, <span class="dv">2</span>), <span class="st">&quot; (&quot;</span>, mediatortable_total<span class="op">$</span>CI95, <span class="st">&quot;)&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">arrange</span>(Variable)

papaja<span class="op">::</span><span class="kw">apa_table</span>(mega_mediatortable, <span class="dt">caption =</span> <span class="st">&quot;Main mediating variables of PA and SB&quot;</span>)</code></pre></div>
<caption>
(#tab:outcome-table2)
</caption>
<caption>
<em>Main mediating variables of PA and SB</em>
</caption>
<table>
<thead>
<tr class="header">
<th align="left">Variable</th>
<th align="left">Girls</th>
<th align="left">Boys</th>
<th align="left">Intervention</th>
<th align="left">Control</th>
<th align="left">Total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">PA action planning</td>
<td align="left">2.7 (2.6 - 2.8)</td>
<td align="left">2.8 (2.7 - 2.9)</td>
<td align="left">2.7 (2.6 - 2.8)</td>
<td align="left">2.8 (2.7 - 2.9)</td>
<td align="left">2.8 (2.7 - 2.8)</td>
</tr>
<tr class="even">
<td align="left">PA agreement-BCTs</td>
<td align="left">3.1 (2.9 - 3.2)</td>
<td align="left">3.1 (3 - 3.3)</td>
<td align="left">3 (2.9 - 3.2)</td>
<td align="left">3.2 (3 - 3.4)</td>
<td align="left">3.1 (3 - 3.2)</td>
</tr>
<tr class="odd">
<td align="left">PA amotivation</td>
<td align="left">1.5 (1.4 - 1.5)</td>
<td align="left">1.6 (1.5 - 1.7)</td>
<td align="left">1.5 (1.4 - 1.6)</td>
<td align="left">1.5 (1.4 - 1.7)</td>
<td align="left">1.5 (1.5 - 1.6)</td>
</tr>
<tr class="even">
<td align="left">PA autonomous regulation</td>
<td align="left">3.3 (3.2 - 3.5)</td>
<td align="left">3.6 (3.4 - 3.7)</td>
<td align="left">3.3 (3.2 - 3.5)</td>
<td align="left">3.5 (3.3 - 3.6)</td>
<td align="left">3.4 (3.3 - 3.5)</td>
</tr>
<tr class="odd">
<td align="left">PA controlled regulation</td>
<td align="left">1.9 (1.8 - 2)</td>
<td align="left">1.8 (1.7 - 1.8)</td>
<td align="left">1.8 (1.7 - 1.9)</td>
<td align="left">1.9 (1.8 - 1.9)</td>
<td align="left">1.8 (1.8 - 1.9)</td>
</tr>
<tr class="even">
<td align="left">PA coping planning</td>
<td align="left">2.4 (2.4 - 2.5)</td>
<td align="left">2.6 (2.5 - 2.7)</td>
<td align="left">2.5 (2.4 - 2.6)</td>
<td align="left">2.5 (2.4 - 2.6)</td>
<td align="left">2.5 (2.4 - 2.6)</td>
</tr>
<tr class="odd">
<td align="left">PA descriptive norm</td>
<td align="left">4.3 (4.1 - 4.5)</td>
<td align="left">4.5 (4.4 - 4.7)</td>
<td align="left">4.3 (4.1 - 4.5)</td>
<td align="left">4.5 (4.3 - 4.7)</td>
<td align="left">4.4 (4.2 - 4.6)</td>
</tr>
<tr class="even">
<td align="left">PA frequency-BCTs</td>
<td align="left">2.5 (2.4 - 2.6)</td>
<td align="left">2.6 (2.5 - 2.7)</td>
<td align="left">2.5 (2.4 - 2.6)</td>
<td align="left">2.6 (2.4 - 2.7)</td>
<td align="left">2.5 (2.4 - 2.6)</td>
</tr>
<tr class="odd">
<td align="left">PA injunctive norm</td>
<td align="left">4.6 (4.4 - 4.8)</td>
<td align="left">4.8 (4.5 - 5)</td>
<td align="left">4.5 (4.3 - 4.7)</td>
<td align="left">4.8 (4.6 - 5)</td>
<td align="left">4.7 (4.5 - 4.8)</td>
</tr>
<tr class="even">
<td align="left">PA intention</td>
<td align="left">5.3 (5.1 - 5.5)</td>
<td align="left">5.5 (5.2 - 5.7)</td>
<td align="left">5.4 (5.1 - 5.7)</td>
<td align="left">5.4 (5.1 - 5.7)</td>
<td align="left">5.4 (5.2 - 5.6)</td>
</tr>
<tr class="odd">
<td align="left">PA opportunities</td>
<td align="left">5.1 (5 - 5.1)</td>
<td align="left">5.2 (5.1 - 5.3)</td>
<td align="left">5.1 (5 - 5.2)</td>
<td align="left">5.2 (5.1 - 5.3)</td>
<td align="left">5.1 (5.1 - 5.2)</td>
</tr>
<tr class="even">
<td align="left">PA outcome expectations</td>
<td align="left">4.7 (4.6 - 4.8)</td>
<td align="left">4.5 (4.4 - 4.6)</td>
<td align="left">4.6 (4.4 - 4.7)</td>
<td align="left">4.7 (4.5 - 4.8)</td>
<td align="left">4.6 (4.5 - 4.7)</td>
</tr>
<tr class="odd">
<td align="left">PA perceived behavioural control</td>
<td align="left">5.2 (5.1 - 5.3)</td>
<td align="left">5.5 (5.4 - 5.6)</td>
<td align="left">5.3 (5.1 - 5.5)</td>
<td align="left">5.3 (5.1 - 5.5)</td>
<td align="left">5.3 (5.2 - 5.5)</td>
</tr>
<tr class="even">
<td align="left">PA self-efficacy</td>
<td align="left">5.1 (5 - 5.3)</td>
<td align="left">5.3 (5.2 - 5.5)</td>
<td align="left">5.2 (5 - 5.3)</td>
<td align="left">5.3 (5.1 - 5.4)</td>
<td align="left">5.2 (5.1 - 5.4)</td>
</tr>
<tr class="odd">
<td align="left">SB descriptive norm</td>
<td align="left">3.2 (3 - 3.4)</td>
<td align="left">3.4 (3.1 - 3.6)</td>
<td align="left">3.2 (3 - 3.4)</td>
<td align="left">3.3 (3.1 - 3.5)</td>
<td align="left">3.2 (3.1 - 3.4)</td>
</tr>
<tr class="even">
<td align="left">SB injunctive norm</td>
<td align="left">4 (3.8 - 4.1)</td>
<td align="left">4.1 (3.9 - 4.3)</td>
<td align="left">3.9 (3.8 - 4.1)</td>
<td align="left">4.1 (4 - 4.2)</td>
<td align="left">4 (3.9 - 4.1)</td>
</tr>
<tr class="odd">
<td align="left">SB intention</td>
<td align="left">3.8 (3.5 - 4.1)</td>
<td align="left">3.6 (3.3 - 3.9)</td>
<td align="left">3.7 (3.2 - 4.2)</td>
<td align="left">3.7 (3.3 - 4.2)</td>
<td align="left">3.7 (3.4 - 4.1)</td>
</tr>
<tr class="even">
<td align="left">SB outcome expectations</td>
<td align="left">4.5 (4.4 - 4.6)</td>
<td align="left">4.3 (4.2 - 4.4)</td>
<td align="left">4.4 (4.2 - 4.6)</td>
<td align="left">4.4 (4.3 - 4.6)</td>
<td align="left">4.4 (4.3 - 4.5)</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="visualising-random-effects-using-full-posterior" class="section level1">
<h1>Visualising random effects using full posterior</h1>
<!-- TODO: Delete this section? -->
<div id="using-rstanarm" class="section level2">
<h2>Using rstanarm</h2>
<p>Plot below shows credible intervals deviations</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># grep(&quot;PA_&quot;, names(df), value = TRUE)</span>

<span class="co"># Centre the variable:</span>
df_randeff_plot_rstanarm &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">paAccelerometer_T1_centred =</span> paAccelerometer_T1 <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(paAccelerometer_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))

m_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">stan_glmer</span>(paAccelerometer_T1_centred <span class="op">~</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>group), <span class="dt">data =</span> df_randeff_plot_rstanarm, <span class="dt">chains =</span> <span class="dv">2</span>, <span class="dt">iter =</span> <span class="dv">2000</span>) 
## Found more than one class &quot;family&quot; in cache; using the first, from namespace &#39;lme4&#39;
## Also defined by &#39;MatrixModels&#39;
## Found more than one class &quot;family&quot; in cache; using the first, from namespace &#39;lme4&#39;
## Also defined by &#39;MatrixModels&#39;
## 
## SAMPLING FOR MODEL &#39;continuous&#39; NOW (CHAIN 1).
## 
## Gradient evaluation took 0 seconds
## 1000 transitions using 10 leapfrog steps per transition would take 0 seconds.
## Adjust your expectations accordingly!
## 
## 
## Iteration:    1 / 2000 [  0%]  (Warmup)
## Iteration:  200 / 2000 [ 10%]  (Warmup)
## Iteration:  400 / 2000 [ 20%]  (Warmup)
## Iteration:  600 / 2000 [ 30%]  (Warmup)
## Iteration:  800 / 2000 [ 40%]  (Warmup)
## Iteration: 1000 / 2000 [ 50%]  (Warmup)
## Iteration: 1001 / 2000 [ 50%]  (Sampling)
## Iteration: 1200 / 2000 [ 60%]  (Sampling)
## Iteration: 1400 / 2000 [ 70%]  (Sampling)
## Iteration: 1600 / 2000 [ 80%]  (Sampling)
## Iteration: 1800 / 2000 [ 90%]  (Sampling)
## Iteration: 2000 / 2000 [100%]  (Sampling)
## 
##  Elapsed Time: 1.829 seconds (Warm-up)
##                0.893 seconds (Sampling)
##                2.722 seconds (Total)
## 
## 
## SAMPLING FOR MODEL &#39;continuous&#39; NOW (CHAIN 2).
## 
## Gradient evaluation took 0 seconds
## 1000 transitions using 10 leapfrog steps per transition would take 0 seconds.
## Adjust your expectations accordingly!
## 
## 
## Iteration:    1 / 2000 [  0%]  (Warmup)
## Iteration:  200 / 2000 [ 10%]  (Warmup)
## Iteration:  400 / 2000 [ 20%]  (Warmup)
## Iteration:  600 / 2000 [ 30%]  (Warmup)
## Iteration:  800 / 2000 [ 40%]  (Warmup)
## Iteration: 1000 / 2000 [ 50%]  (Warmup)
## Iteration: 1001 / 2000 [ 50%]  (Sampling)
## Iteration: 1200 / 2000 [ 60%]  (Sampling)
## Iteration: 1400 / 2000 [ 70%]  (Sampling)
## Iteration: 1600 / 2000 [ 80%]  (Sampling)
## Iteration: 1800 / 2000 [ 90%]  (Sampling)
## Iteration: 2000 / 2000 [100%]  (Sampling)
## 
##  Elapsed Time: 1.773 seconds (Warm-up)
##                0.878 seconds (Sampling)
##                2.651 seconds (Total)
pt &lt;-<span class="st"> </span><span class="kw">ranef</span>(m_<span class="dv">1</span>) 
posteriors &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">posterior_interval</span>(m_<span class="dv">1</span>, <span class="dt">prob =</span> <span class="fl">0.90</span>)) 
school_int &lt;-<span class="st"> </span>posteriors[<span class="op">-</span><span class="kw">c</span>(<span class="dv">1</span>, <span class="kw">nrow</span>(posteriors)<span class="op">-</span><span class="dv">1</span>, <span class="kw">nrow</span>(posteriors)),] <span class="co">#remove intercept and sigma parameters, leaving only class intervals </span>

<span class="co"># This not needed any more:</span>
<span class="co"># groupmeans &lt;- df %&gt;% dplyr::select(paAccelerometer_T1, group) %&gt;% group_by(group) %&gt;% </span>
<span class="co">#   summarise(mean = mean(paAccelerometer_T1, na.rm = T)) %&gt;% dplyr::filter(complete.cases(.))</span>

dat_plt &lt;-<span class="st"> </span><span class="kw">data.frame</span>(pt<span class="op">$</span>group, school_int) 
<span class="kw">colnames</span>(dat_plt) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;pt&quot;</span>, <span class="st">&quot;low&quot;</span>, <span class="st">&quot;up&quot;</span>) 
dat_plt &lt;-<span class="st"> </span>dat_plt <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">arrange</span>(pt) 
dat_plt<span class="op">$</span>index &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(dat_plt) 
dat_plt <span class="op">%&gt;%</span><span class="st"> </span>ggplot2<span class="op">::</span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> index, <span class="dt">y =</span> pt)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_errorbar</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> low, <span class="dt">ymax =</span> up)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">4</span>, <span class="dt">shape =</span> <span class="dv">18</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="fl">2.5</span>, <span class="dt">shape =</span> <span class="dv">18</span>, <span class="dt">color =</span> <span class="st">&quot;white&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme_bw</span>()</code></pre></div>
<p><img src="baseline-supplement_files/figure-html/randeff-plot-rstanarm-1.png" width="672" /></p>
</div>
<div id="using-brms-and-diamondplot" class="section level2">
<h2>Using brms and diamondPlot</h2>
<p>Set Rtools folder, if not in C:/Rtools/:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># For some reason, having BINPREF in .Renviron doesn&#39;t work and I keep needing this:</span>
<span class="kw">Sys.setenv</span>(<span class="st">&quot;BINPREF&quot;</span> =<span class="st"> &quot;C:/HYApp/Rtools3.4/mingw_$(WIN)/bin/&quot;</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># Centre the variable:</span>
df_randeff_plot_brms &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">paAccelerometer_T1_centred =</span> 
                      paAccelerometer_T1 <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(paAccelerometer_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))

m_<span class="dv">1</span> &lt;-<span class="st"> </span>brms<span class="op">::</span><span class="kw">bf</span>(paAccelerometer_T1_centred <span class="op">~</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>group)) 
<span class="kw">get_prior</span>(m_<span class="dv">1</span>, <span class="dt">data =</span> df_randeff_plot_brms)

fit_<span class="dv">1</span> &lt;-<span class="st"> </span>brms<span class="op">::</span><span class="kw">brm</span>(m_<span class="dv">1</span>, df_randeff_plot_brms)

pt &lt;-<span class="st"> </span>brms<span class="op">::</span><span class="kw">ranef</span>(fit_<span class="dv">1</span>, <span class="dt">robust =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>data.frame <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="dt">credintLow =</span> group.<span class="fl">2.5</span>.ile.Intercept,
         <span class="dt">intercept =</span> group.Estimate.Intercept, 
         <span class="dt">credintHigh =</span> group.<span class="fl">97.5</span>.ile.Intercept) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">arrange</span>(intercept)


plot1 &lt;-<span class="st"> </span>userfriendlyscience<span class="op">::</span><span class="kw">diamondPlot</span>(pt, <span class="dt">color =</span> <span class="st">&#39;green&#39;</span>, <span class="dt">alpha=</span>.<span class="dv">3</span>, <span class="dt">yLabels =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">58</span>, <span class="dt">fixedSize =</span> <span class="fl">0.3</span>, <span class="dt">xlab =</span> <span class="ot">NULL</span>) <span class="op">+</span>
<span class="st">  </span>ggplot2<span class="op">::</span><span class="kw">coord_flip</span>(<span class="dt">expand =</span> <span class="ot">TRUE</span>) <span class="op">+</span>
<span class="st">  </span>ggplot2<span class="op">::</span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Deviance from average MVPA&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Group&quot;</span>)


df <span class="op">%&gt;%</span><span class="st"> </span>ggplot2<span class="op">::</span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> group, <span class="dt">y =</span> paAccelerometer_T1_centred)) <span class="op">+</span>
<span class="st">  </span>userfriendlyscience<span class="op">::</span><span class="kw">diamondPlot</span>(pt, <span class="dt">color =</span> <span class="st">&#39;green&#39;</span>, <span class="dt">alpha=</span>.<span class="dv">3</span>, <span class="dt">yLabels =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">58</span>, <span class="dt">fixedSize =</span> <span class="fl">0.3</span>, <span class="dt">xlab =</span> <span class="ot">NULL</span>, <span class="dt">returnLayerOnly =</span> <span class="ot">TRUE</span>) <span class="op">+</span>
<span class="st">  </span>ggplot2<span class="op">::</span><span class="kw">coord_flip</span>(<span class="dt">expand =</span> <span class="ot">TRUE</span>) <span class="op">+</span>
<span class="st">  </span>ggplot2<span class="op">::</span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Deviance from average MVPA&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Group&quot;</span>)
   
<span class="co"># brmstools::forest(fit_1)</span></code></pre></div>
</div>
<div id="random-effects-in-autonomous-motivation" class="section level2">
<h2>Random effects in autonomous motivation</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># Centre the variable:</span>
df_randeff_plot_brms_autonomous &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">PA_autonomous_T1_centred =</span> PA_autonomous_T1 <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(PA_autonomous_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))

m_<span class="dv">1</span> &lt;-<span class="st"> </span>brms<span class="op">::</span><span class="kw">bf</span>(PA_autonomous_T1_centred <span class="op">~</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>group)) 
<span class="kw">get_prior</span>(m_<span class="dv">1</span>, <span class="dt">data =</span> df_randeff_plot_brms_autonomous)
## Found more than one class &quot;family&quot; in cache; using the first, from namespace &#39;lme4&#39;
## Also defined by &#39;MatrixModels&#39;
## Warning: Rows containing NAs were excluded from the model</code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["bound"],"name":[8],"type":["chr"],"align":["left"]}],"data":[{"1":"student_t(3, 0, 10)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","_rn_":"1"},{"1":"student_t(3, 0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"","_rn_":"2"},{"1":"","2":"sd","3":"","4":"group","5":"","6":"","7":"","8":"","_rn_":"3"},{"1":"","2":"sd","3":"Intercept","4":"group","5":"","6":"","7":"","8":"","_rn_":"4"},{"1":"student_t(3, 0, 10)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"","_rn_":"5"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
fit_<span class="dv">1</span> &lt;-<span class="st"> </span>brms<span class="op">::</span><span class="kw">brm</span>(m_<span class="dv">1</span>, df_randeff_plot_brms_autonomous)
## Found more than one class &quot;family&quot; in cache; using the first, from namespace &#39;lme4&#39;
## Also defined by &#39;MatrixModels&#39;
## Warning: Rows containing NAs were excluded from the model
## Compiling the C++ model
## Start sampling
## 
## SAMPLING FOR MODEL &#39;gaussian brms-model&#39; NOW (CHAIN 1).
## 
## Gradient evaluation took 0 seconds
## 1000 transitions using 10 leapfrog steps per transition would take 0 seconds.
## Adjust your expectations accordingly!
## 
## 
## Iteration:    1 / 2000 [  0%]  (Warmup)
## Iteration:  200 / 2000 [ 10%]  (Warmup)
## Iteration:  400 / 2000 [ 20%]  (Warmup)
## Iteration:  600 / 2000 [ 30%]  (Warmup)
## Iteration:  800 / 2000 [ 40%]  (Warmup)
## Iteration: 1000 / 2000 [ 50%]  (Warmup)
## Iteration: 1001 / 2000 [ 50%]  (Sampling)
## Iteration: 1200 / 2000 [ 60%]  (Sampling)
## Iteration: 1400 / 2000 [ 70%]  (Sampling)
## Iteration: 1600 / 2000 [ 80%]  (Sampling)
## Iteration: 1800 / 2000 [ 90%]  (Sampling)
## Iteration: 2000 / 2000 [100%]  (Sampling)
## 
##  Elapsed Time: 1.094 seconds (Warm-up)
##                1.121 seconds (Sampling)
##                2.215 seconds (Total)
## 
## 
## SAMPLING FOR MODEL &#39;gaussian brms-model&#39; NOW (CHAIN 2).
## 
## Gradient evaluation took 0 seconds
## 1000 transitions using 10 leapfrog steps per transition would take 0 seconds.
## Adjust your expectations accordingly!
## 
## 
## Iteration:    1 / 2000 [  0%]  (Warmup)
## Iteration:  200 / 2000 [ 10%]  (Warmup)
## Iteration:  400 / 2000 [ 20%]  (Warmup)
## Iteration:  600 / 2000 [ 30%]  (Warmup)
## Iteration:  800 / 2000 [ 40%]  (Warmup)
## Iteration: 1000 / 2000 [ 50%]  (Warmup)
## Iteration: 1001 / 2000 [ 50%]  (Sampling)
## Iteration: 1200 / 2000 [ 60%]  (Sampling)
## Iteration: 1400 / 2000 [ 70%]  (Sampling)
## Iteration: 1600 / 2000 [ 80%]  (Sampling)
## Iteration: 1800 / 2000 [ 90%]  (Sampling)
## Iteration: 2000 / 2000 [100%]  (Sampling)
## 
##  Elapsed Time: 1.254 seconds (Warm-up)
##                1.044 seconds (Sampling)
##                2.298 seconds (Total)
## 
## 
## SAMPLING FOR MODEL &#39;gaussian brms-model&#39; NOW (CHAIN 3).
## 
## Gradient evaluation took 0 seconds
## 1000 transitions using 10 leapfrog steps per transition would take 0 seconds.
## Adjust your expectations accordingly!
## 
## 
## Iteration:    1 / 2000 [  0%]  (Warmup)
## Iteration:  200 / 2000 [ 10%]  (Warmup)
## Iteration:  400 / 2000 [ 20%]  (Warmup)
## Iteration:  600 / 2000 [ 30%]  (Warmup)
## Iteration:  800 / 2000 [ 40%]  (Warmup)
## Iteration: 1000 / 2000 [ 50%]  (Warmup)
## Iteration: 1001 / 2000 [ 50%]  (Sampling)
## Iteration: 1200 / 2000 [ 60%]  (Sampling)
## Iteration: 1400 / 2000 [ 70%]  (Sampling)
## Iteration: 1600 / 2000 [ 80%]  (Sampling)
## Iteration: 1800 / 2000 [ 90%]  (Sampling)
## Iteration: 2000 / 2000 [100%]  (Sampling)
## 
##  Elapsed Time: 1.107 seconds (Warm-up)
##                0.717 seconds (Sampling)
##                1.824 seconds (Total)
## 
## 
## SAMPLING FOR MODEL &#39;gaussian brms-model&#39; NOW (CHAIN 4).
## 
## Gradient evaluation took 0 seconds
## 1000 transitions using 10 leapfrog steps per transition would take 0 seconds.
## Adjust your expectations accordingly!
## 
## 
## Iteration:    1 / 2000 [  0%]  (Warmup)
## Iteration:  200 / 2000 [ 10%]  (Warmup)
## Iteration:  400 / 2000 [ 20%]  (Warmup)
## Iteration:  600 / 2000 [ 30%]  (Warmup)
## Iteration:  800 / 2000 [ 40%]  (Warmup)
## Iteration: 1000 / 2000 [ 50%]  (Warmup)
## Iteration: 1001 / 2000 [ 50%]  (Sampling)
## Iteration: 1200 / 2000 [ 60%]  (Sampling)
## Iteration: 1400 / 2000 [ 70%]  (Sampling)
## Iteration: 1600 / 2000 [ 80%]  (Sampling)
## Iteration: 1800 / 2000 [ 90%]  (Sampling)
## Iteration: 2000 / 2000 [100%]  (Sampling)
## 
##  Elapsed Time: 1.2 seconds (Warm-up)
##                1.079 seconds (Sampling)
##                2.279 seconds (Total)

pt &lt;-<span class="st"> </span>brms<span class="op">::</span><span class="kw">ranef</span>(fit_<span class="dv">1</span>, <span class="dt">robust =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>data.frame <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="dt">credintLow =</span> group.<span class="fl">2.5</span>.ile.Intercept,
         <span class="dt">intercept =</span> group.Estimate.Intercept, 
         <span class="dt">credintHigh =</span> group.<span class="fl">97.5</span>.ile.Intercept) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">arrange</span>(intercept)


plot1 &lt;-<span class="st"> </span>userfriendlyscience<span class="op">::</span><span class="kw">diamondPlot</span>(pt, <span class="dt">color =</span> <span class="st">&#39;blue&#39;</span>, <span class="dt">alpha=</span>.<span class="dv">3</span>, <span class="dt">yLabels =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">59</span>, <span class="dt">fixedSize =</span> <span class="fl">0.3</span>, <span class="dt">xlab =</span> <span class="ot">NULL</span>) <span class="op">+</span>
<span class="st">  </span>ggplot2<span class="op">::</span><span class="kw">coord_flip</span>(<span class="dt">expand =</span> <span class="ot">TRUE</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Deviance from average motivation&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Group&quot;</span>)


df_randeff_plot_brms_autonomous <span class="op">%&gt;%</span><span class="st"> </span>ggplot2<span class="op">::</span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> group, <span class="dt">y =</span> PA_autonomous_T1_centred)) <span class="op">+</span>
<span class="st">  </span>userfriendlyscience<span class="op">::</span><span class="kw">diamondPlot</span>(pt, <span class="dt">color =</span> <span class="st">&#39;blue&#39;</span>, <span class="dt">alpha=</span>.<span class="dv">3</span>, <span class="dt">yLabels =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">59</span>, <span class="dt">fixedSize =</span> <span class="fl">0.3</span>, <span class="dt">xlab =</span> <span class="ot">NULL</span>, <span class="dt">returnLayerOnly =</span> <span class="ot">TRUE</span>) <span class="op">+</span>
<span class="st">  </span>ggplot2<span class="op">::</span><span class="kw">coord_flip</span>(<span class="dt">expand =</span> <span class="ot">TRUE</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Deviance from average motivation&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Group&quot;</span>)</code></pre></div>
<p><img src="baseline-supplement_files/figure-html/randeff-plot-brms-autonomous-1.png" width="1152" /></p>
</div>
</div>
<div id="primary-outcome-variables" class="section level1">
<h1>Primary outcome variables</h1>
<div id="plot-of-self-reported-and-accelerometer-measured-mvpa-variables" class="section level2">
<h2>Plot of self-reported and accelerometer-measured MVPA-variables</h2>
<!-- TODO: Change Red line for the decided cutoff -->
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
lmi <span class="op">%&gt;%</span><span class="st"> </span>ggplot2<span class="op">::</span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> LiikuntaT1_ka, <span class="dt">y =</span> Kys0045.<span class="dv">1</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;loess&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="dv">120</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;accelerometer-measured MVPA&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;self-reported MVPA days last week&quot;</span>)
## Don&#39;t know how to automatically pick scale for object of type labelled. Defaulting to continuous.
## Warning: Removed 459 rows containing non-finite values (stat_smooth).
## Warning: Removed 459 rows containing missing values (geom_point).</code></pre></div>
<p><img src="baseline-supplement_files/figure-html/mvpa-accelerometer-selfreport-scatterplot-1.png" width="672" /></p>
<p>This section reports the primary outcome variables.</p>
</div>
<div id="accelerometer-measured-mvpa" class="section level2">
<h2>Accelerometer-measured MVPA</h2>
<p>Get credibility intervals track:school</p>
<p>Contrary to some other findings, in our sample girls were more active than boys.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
MVPAgirl_df &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(girl) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(girl, paAccelerometer_T1) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarise</span>(<span class="st">`</span><span class="dt">mean accelerometer-measured MVPA difference between girls and boys</span><span class="st">`</span> =<span class="st"> </span><span class="kw">mean</span>(paAccelerometer_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dt">median =</span> <span class="kw">median</span>(paAccelerometer_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))
MVPAgirl_df[<span class="dv">1</span>, <span class="dv">2</span>] <span class="op">-</span><span class="st"> </span>MVPAgirl_df[<span class="dv">2</span>, <span class="dv">2</span>]</code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["mean accelerometer-measured MVPA difference between girls and boys"],"name":[1],"type":["dbl"],"align":["right"]}],"data":[{"1":"16.81268"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">MVPAgirl_df[<span class="dv">1</span>, <span class="dv">3</span>] <span class="op">-</span><span class="st"> </span>MVPAgirl_df[<span class="dv">2</span>, <span class="dv">3</span>]</code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["median"],"name":[1],"type":["dbl"],"align":["right"]}],"data":[{"1":"24.52857"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
userfriendlyscience<span class="op">::</span><span class="kw">meanDiff</span>(df<span class="op">$</span>girl, df<span class="op">$</span>paAccelerometer_T1)
## Input variables:
## 
##   girl (grouping variable)
##   paAccelerometer_T1 (dependent variable)
##   Mean 1 (girl) = 190.36, sd = 48.6, n = 425
##   Mean 2 (boy)= 173.55, sd = 59.39, n = 281
## 
## Independent samples t-test (tested for equal variances, p &lt; .001, so unequal variances)
##   (standard deviation used of largest sample, 48.6)
## 
## 95% confidence intervals:
##   Absolute mean difference: [8.45, 25.17] (Absolute mean difference: 16.81)
##   Cohen&#39;s d for difference: [0.19, 0.5] (Cohen&#39;s d point estimate: 0.35)
##   Hedges g for difference:  [0.19, 0.5] (Hedges g point estimate:  0.35)
## 
## Achieved power for d=0.35: 0.9957 (for small: 0.756; medium: 1; large: 1)
## 
## (secondary information (NHST): t[516] = 3.95, p &lt; .001)
## 
## 
## <span class="al">NOTE</span>: because the t-test is based on unequal variances, the NHST p-value may be inconsistent with the confidence interval. Although this is not a problem, if you wish to ensure consistency, you can use parameter &quot;var.equal = &#39;yes&#39;&quot; to force equal variances.</code></pre></div>
<div id="density-plot-intervention-gender" class="section level3">
<h3>Density plot intervention / gender</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># Create data frame</span>
densplot &lt;-<span class="st"> </span>d
<span class="kw">levels</span>(densplot<span class="op">$</span>intervention) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Control&quot;</span>, <span class="st">&quot;Intervention&quot;</span>)
<span class="kw">levels</span>(densplot<span class="op">$</span>girl) &lt;-<span class="st"> </span><span class="kw">recode</span>(densplot<span class="op">$</span>girl, <span class="st">&quot;boy&quot;</span> =<span class="st"> &quot;Boys&quot;</span>, <span class="st">&quot;girl&quot;</span> =<span class="st"> &quot;Girls&quot;</span>)

<span class="co"># This gives side-by-side plots. There&#39;s a third plot below the two, which is fake to include x-axis text.</span>
<span class="kw">layout</span>(<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">3</span>), <span class="dt">nrow =</span> <span class="dv">2</span>, <span class="dt">ncol =</span> <span class="dv">2</span>, <span class="dt">byrow =</span> <span class="ot">TRUE</span>),
       <span class="dt">widths =</span> <span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>),<span class="dt">heights =</span> <span class="kw">c</span>(<span class="fl">0.45</span>,<span class="fl">0.05</span>))

<span class="co"># Minimise whitespace; see https://stackoverflow.com/questions/15848942/how-to-reduce-space-gap-between-multiple-graphs-in-r</span>
<span class="kw">par</span>(<span class="dt">mai =</span> <span class="kw">c</span>(<span class="fl">0.3</span>, <span class="fl">0.3</span>, <span class="fl">0.1</span>, <span class="fl">0.0</span>)) 

## Girls vs. boys
<span class="co"># Choose only the variables needed and drop NA</span>
dens &lt;-<span class="st"> </span>densplot <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(paAccelerometer_T1, girl) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="kw">complete.cases</span>(.))

<span class="co"># Set random number generator for reproducibility of bootstrap test of equal densities</span>
<span class="kw">set.seed</span>(<span class="dv">10</span>)

<span class="co"># Make plot</span>
sm.paAccelerometer_T1_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">sm.density.compare2</span>(<span class="kw">as.numeric</span>(dens<span class="op">$</span>paAccelerometer_T1), 
                                               <span class="kw">as.factor</span>(dens<span class="op">$</span>girl), 
                                               <span class="dt">model =</span> <span class="st">&quot;equal&quot;</span>,
                                               <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>,
                                               <span class="dt">col =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end  =</span>  <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">1</span>)], 
                                               <span class="dt">lty =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>), <span class="dt">yaxt =</span> <span class="st">&quot;n&quot;</span>,
                                               <span class="dt">bandcol =</span> <span class="st">&#39;LightGray&#39;</span>, 
                                               <span class="dt">lwd =</span> (<span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>)))
## 
## Test of equal densities:  p-value =  0
<span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="kw">levels</span>(dens<span class="op">$</span>girl), <span class="dt">col =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>)], <span class="dt">lty =</span> <span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">1</span>), <span class="dt">lwd =</span> (<span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>)))
<span class="kw">mtext</span>(<span class="dt">side =</span> <span class="dv">2</span>, <span class="st">&quot;Density&quot;</span>, <span class="dt">line =</span> <span class="fl">0.5</span>)

## Intervention vs. control
<span class="co"># Choose only the variables needed and drop NA</span>
dens &lt;-<span class="st"> </span>densplot <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(paAccelerometer_T1, intervention) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="kw">complete.cases</span>(.))

<span class="co"># Set random number generator for reproducibility of bootstrap test of equal densities</span>
<span class="kw">set.seed</span>(<span class="dv">10</span>)
<span class="co"># Make plot</span>
sm.paAccelerometer_T1_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">sm.density.compare2</span>(<span class="kw">as.numeric</span>(dens<span class="op">$</span>paAccelerometer_T1), 
                                               <span class="kw">as.factor</span>(dens<span class="op">$</span>intervention), 
                                               <span class="dt">model =</span> <span class="st">&quot;equal&quot;</span>, 
                                               <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>,
                                               <span class="dt">col =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">4</span>)], 
                                               <span class="dt">lty =</span> <span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">1</span>), <span class="dt">yaxt =</span> <span class="st">&quot;n&quot;</span>,
                                               <span class="dt">bandcol =</span> <span class="st">&#39;LightGray&#39;</span>, 
                                               <span class="dt">lwd =</span> (<span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>)))
## 
## Test of equal densities:  p-value =  0.25
<span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="kw">levels</span>(dens<span class="op">$</span>intervention), <span class="dt">col =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">4</span>)], <span class="dt">lty=</span><span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">1</span>), <span class="dt">lwd=</span>(<span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>)))

<span class="co"># Create x-axis label. See https://stackoverflow.com/questions/11198767/how-to-annotate-across-or-between-plots-in-multi-plot-panels-in-r</span>
<span class="kw">par</span>(<span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>)) 
<span class="kw">plot</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dt">type =</span> <span class="st">&quot;n&quot;</span>, <span class="dt">frame.plot =</span> <span class="ot">FALSE</span>,<span class="dt">axes =</span> <span class="ot">FALSE</span>) <span class="co"># Fake plot</span>
<span class="kw">text</span>(<span class="dt">x =</span> <span class="fl">1.02</span>, <span class="dt">y =</span> <span class="fl">1.3</span>, <span class="dt">labels =</span> <span class="st">&quot;MVPA minutes&quot;</span>, <span class="dt">pos =</span> <span class="dv">1</span>)</code></pre></div>
<p><img src="baseline-supplement_files/figure-html/MVPA-accelerometer-sm-1.png" width="672" /></p>
<p>Prepare data</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m_paAccelerometer_trackgirl &lt;-<span class="st"> </span>brms<span class="op">::</span><span class="kw">bf</span>(paAccelerometer_T1 <span class="op">~</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>track<span class="op">:</span>girl)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>brms<span class="op">::</span><span class="kw">brm</span>(., <span class="dt">data =</span> df, <span class="dt">chains =</span> <span class="dv">4</span>, <span class="dt">iter =</span> <span class="dv">4000</span>, <span class="dt">control =</span> <span class="kw">list</span>(<span class="dt">adapt_delta =</span> <span class="fl">0.95</span>))
## Found more than one class &quot;family&quot; in cache; using the first, from namespace &#39;lme4&#39;
## Also defined by &#39;MatrixModels&#39;
## Warning: Rows containing NAs were excluded from the model
## Compiling the C++ model
## Start sampling
## 
## SAMPLING FOR MODEL &#39;gaussian brms-model&#39; NOW (CHAIN 1).
## 
## Gradient evaluation took 0.001 seconds
## 1000 transitions using 10 leapfrog steps per transition would take 10 seconds.
## Adjust your expectations accordingly!
## 
## 
## Iteration:    1 / 4000 [  0%]  (Warmup)
## Iteration:  400 / 4000 [ 10%]  (Warmup)
## Iteration:  800 / 4000 [ 20%]  (Warmup)
## Iteration: 1200 / 4000 [ 30%]  (Warmup)
## Iteration: 1600 / 4000 [ 40%]  (Warmup)
## Iteration: 2000 / 4000 [ 50%]  (Warmup)
## Iteration: 2001 / 4000 [ 50%]  (Sampling)
## Iteration: 2400 / 4000 [ 60%]  (Sampling)
## Iteration: 2800 / 4000 [ 70%]  (Sampling)
## Iteration: 3200 / 4000 [ 80%]  (Sampling)
## Iteration: 3600 / 4000 [ 90%]  (Sampling)
## Iteration: 4000 / 4000 [100%]  (Sampling)
## 
##  Elapsed Time: 2.339 seconds (Warm-up)
##                2.043 seconds (Sampling)
##                4.382 seconds (Total)
## 
## 
## SAMPLING FOR MODEL &#39;gaussian brms-model&#39; NOW (CHAIN 2).
## 
## Gradient evaluation took 0 seconds
## 1000 transitions using 10 leapfrog steps per transition would take 0 seconds.
## Adjust your expectations accordingly!
## 
## 
## Iteration:    1 / 4000 [  0%]  (Warmup)
## Iteration:  400 / 4000 [ 10%]  (Warmup)
## Iteration:  800 / 4000 [ 20%]  (Warmup)
## Iteration: 1200 / 4000 [ 30%]  (Warmup)
## Iteration: 1600 / 4000 [ 40%]  (Warmup)
## Iteration: 2000 / 4000 [ 50%]  (Warmup)
## Iteration: 2001 / 4000 [ 50%]  (Sampling)
## Iteration: 2400 / 4000 [ 60%]  (Sampling)
## Iteration: 2800 / 4000 [ 70%]  (Sampling)
## Iteration: 3200 / 4000 [ 80%]  (Sampling)
## Iteration: 3600 / 4000 [ 90%]  (Sampling)
## Iteration: 4000 / 4000 [100%]  (Sampling)
## 
##  Elapsed Time: 2.406 seconds (Warm-up)
##                1.672 seconds (Sampling)
##                4.078 seconds (Total)
## 
## 
## SAMPLING FOR MODEL &#39;gaussian brms-model&#39; NOW (CHAIN 3).
## 
## Gradient evaluation took 0 seconds
## 1000 transitions using 10 leapfrog steps per transition would take 0 seconds.
## Adjust your expectations accordingly!
## 
## 
## Iteration:    1 / 4000 [  0%]  (Warmup)
## Iteration:  400 / 4000 [ 10%]  (Warmup)
## Iteration:  800 / 4000 [ 20%]  (Warmup)
## Iteration: 1200 / 4000 [ 30%]  (Warmup)
## Iteration: 1600 / 4000 [ 40%]  (Warmup)
## Iteration: 2000 / 4000 [ 50%]  (Warmup)
## Iteration: 2001 / 4000 [ 50%]  (Sampling)
## Iteration: 2400 / 4000 [ 60%]  (Sampling)
## Iteration: 2800 / 4000 [ 70%]  (Sampling)
## Iteration: 3200 / 4000 [ 80%]  (Sampling)
## Iteration: 3600 / 4000 [ 90%]  (Sampling)
## Iteration: 4000 / 4000 [100%]  (Sampling)
## 
##  Elapsed Time: 2.359 seconds (Warm-up)
##                2.148 seconds (Sampling)
##                4.507 seconds (Total)
## 
## 
## SAMPLING FOR MODEL &#39;gaussian brms-model&#39; NOW (CHAIN 4).
## 
## Gradient evaluation took 0 seconds
## 1000 transitions using 10 leapfrog steps per transition would take 0 seconds.
## Adjust your expectations accordingly!
## 
## 
## Iteration:    1 / 4000 [  0%]  (Warmup)
## Iteration:  400 / 4000 [ 10%]  (Warmup)
## Iteration:  800 / 4000 [ 20%]  (Warmup)
## Iteration: 1200 / 4000 [ 30%]  (Warmup)
## Iteration: 1600 / 4000 [ 40%]  (Warmup)
## Iteration: 2000 / 4000 [ 50%]  (Warmup)
## Iteration: 2001 / 4000 [ 50%]  (Sampling)
## Iteration: 2400 / 4000 [ 60%]  (Sampling)
## Iteration: 2800 / 4000 [ 70%]  (Sampling)
## Iteration: 3200 / 4000 [ 80%]  (Sampling)
## Iteration: 3600 / 4000 [ 90%]  (Sampling)
## Iteration: 4000 / 4000 [100%]  (Sampling)
## 
##  Elapsed Time: 2.475 seconds (Warm-up)
##                1.585 seconds (Sampling)
##                4.06 seconds (Total)

brms<span class="op">::</span><span class="kw">prior_summary</span>(m_paAccelerometer_trackgirl, <span class="dt">data =</span> df)</code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["bound"],"name":[8],"type":["chr"],"align":["left"]}],"data":[{"1":"student_t(3, 181, 54)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":""},{"1":"student_t(3, 0, 54)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":""},{"1":"","2":"sd","3":"","4":"track:girl","5":"","6":"","7":"","8":""},{"1":"","2":"sd","3":"Intercept","4":"track:girl","5":"","6":"","7":"","8":""},{"1":"student_t(3, 0, 54)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":""}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
m_paAccelerometer_trackgirl
##  Family: gaussian 
##   Links: mu = identity; sigma = identity 
## Formula: paAccelerometer_T1 ~ (1 | track:girl) 
##    Data: df (Number of observations: 706) 
## Samples: 4 chains, each with iter = 4000; warmup = 2000; thin = 1; 
##          total post-warmup samples = 8000
##     ICs: LOO = NA; WAIC = NA; R2 = NA
##  
## Group-Level Effects: 
## ~track:girl (Number of levels: 10) 
##               Estimate Est.Error l-95% CI u-95% CI Eff.Sample Rhat
## sd(Intercept)    25.94      8.25    14.71    46.12       1535 1.00
## 
## Population-Level Effects: 
##           Estimate Est.Error l-95% CI u-95% CI Eff.Sample Rhat
## Intercept   176.79      8.65   159.52   193.31       1617 1.00
## 
## Family Specific Parameters: 
##       Estimate Est.Error l-95% CI u-95% CI Eff.Sample Rhat
## sigma    50.26      1.35    47.73    53.04       6165 1.00
## 
## Samples were drawn using sampling(NUTS). For each parameter, Eff.Sample 
## is a crude measure of effective sample size, and Rhat is the potential 
## scale reduction factor on split chains (at convergence, Rhat = 1).

b_intercept &lt;-<span class="st"> </span>brms<span class="op">::</span><span class="kw">fixef</span>(m_paAccelerometer_trackgirl)[<span class="dv">1</span>]

<span class="co"># This gives estimates only:</span>
PA_trackgirl_estimates &lt;-<span class="st"> </span>brms<span class="op">::</span><span class="kw">ranef</span>(m_paAccelerometer_trackgirl)[[<span class="dv">1</span>]][<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]

<span class="co"># The 2.5%ile:</span>
PA_trackgirl_CIL &lt;-<span class="st"> </span>brms<span class="op">::</span><span class="kw">ranef</span>(m_paAccelerometer_trackgirl)[[<span class="dv">1</span>]][<span class="dv">21</span><span class="op">:</span><span class="dv">30</span>]

<span class="co"># The 97.5%ile:</span>
PA_trackgirl_CIH &lt;-<span class="st"> </span>brms<span class="op">::</span><span class="kw">ranef</span>(m_paAccelerometer_trackgirl)[[<span class="dv">1</span>]][<span class="dv">31</span><span class="op">:</span><span class="dv">40</span>]

PA_trackgirl_ci &lt;-<span class="st"> </span><span class="kw">data.frame</span>(PA_trackgirl_CIL, PA_trackgirl_estimates, PA_trackgirl_CIH, <span class="dt">Variable =</span> <span class="kw">labels</span>(brms<span class="op">::</span><span class="kw">ranef</span>(m_paAccelerometer_trackgirl))) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">b_intercept =</span> <span class="kw">rep</span>(b_intercept, <span class="dv">10</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">PA_trackgirl_CIL =</span> PA_trackgirl_CIL <span class="op">+</span><span class="st"> </span>b_intercept,
         <span class="dt">PA_trackgirl_estimates =</span> PA_trackgirl_estimates <span class="op">+</span><span class="st"> </span>b_intercept,
         <span class="dt">PA_trackgirl_CIH =</span> PA_trackgirl_CIH <span class="op">+</span><span class="st"> </span>b_intercept,
         <span class="dt">track =</span> <span class="kw">c</span>(<span class="st">&#39;BA_boy&#39;</span>,
                   <span class="st">&#39;BA_girl&#39;</span>,
                   <span class="st">&#39;HRC_boy&#39;</span>,
                   <span class="st">&#39;HRC_girl&#39;</span>,
                   <span class="st">&#39;IT_boy&#39;</span>,
                   <span class="st">&#39;IT_girl&#39;</span>,
                   <span class="st">&#39;Nur_boy&#39;</span>,
                   <span class="st">&#39;Nur_girl&#39;</span>,
                   <span class="st">&#39;Other_boy&#39;</span>,
                   <span class="st">&#39;Other_girl&#39;</span>
))

PA_trackgirl_diamonds_girl &lt;-<span class="st"> </span><span class="kw">rbind</span>(
PA_trackgirl_ci <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;Nur_girl&quot;</span>),
PA_trackgirl_ci <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;HRC_girl&quot;</span>),
PA_trackgirl_ci <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;BA_girl&quot;</span>),
PA_trackgirl_ci <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;IT_girl&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">arrange</span>(<span class="op">-</span><span class="kw">row_number</span>()) <span class="co"># reverse order of rows to make them right for the plot to come</span>

PA_trackgirl_diamonds_boy &lt;-<span class="st"> </span><span class="kw">rbind</span>(
PA_trackgirl_ci <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;Nur_boy&quot;</span>),
PA_trackgirl_ci <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;HRC_boy&quot;</span>),
PA_trackgirl_ci <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;BA_boy&quot;</span>),
PA_trackgirl_ci <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;IT_boy&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">arrange</span>(<span class="op">-</span><span class="kw">row_number</span>()) <span class="co"># reverse order of rows to make them right for the plot to come</span>


m_paAccelerometer_trackintervention &lt;-<span class="st"> </span>brms<span class="op">::</span><span class="kw">bf</span>(paAccelerometer_T1 <span class="op">~</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>track<span class="op">:</span>intervention)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>brms<span class="op">::</span><span class="kw">brm</span>(., <span class="dt">data =</span> df, <span class="dt">chains =</span> <span class="dv">4</span>, <span class="dt">iter =</span> <span class="dv">4000</span>, <span class="dt">control =</span> <span class="kw">list</span>(<span class="dt">adapt_delta =</span> <span class="fl">0.95</span>))
## Found more than one class &quot;family&quot; in cache; using the first, from namespace &#39;lme4&#39;
## Also defined by &#39;MatrixModels&#39;
## Warning: Rows containing NAs were excluded from the model
## Compiling the C++ model
## Start sampling
## 
## SAMPLING FOR MODEL &#39;gaussian brms-model&#39; NOW (CHAIN 1).
## 
## Gradient evaluation took 0 seconds
## 1000 transitions using 10 leapfrog steps per transition would take 0 seconds.
## Adjust your expectations accordingly!
## 
## 
## Iteration:    1 / 4000 [  0%]  (Warmup)
## Iteration:  400 / 4000 [ 10%]  (Warmup)
## Iteration:  800 / 4000 [ 20%]  (Warmup)
## Iteration: 1200 / 4000 [ 30%]  (Warmup)
## Iteration: 1600 / 4000 [ 40%]  (Warmup)
## Iteration: 2000 / 4000 [ 50%]  (Warmup)
## Iteration: 2001 / 4000 [ 50%]  (Sampling)
## Iteration: 2400 / 4000 [ 60%]  (Sampling)
## Iteration: 2800 / 4000 [ 70%]  (Sampling)
## Iteration: 3200 / 4000 [ 80%]  (Sampling)
## Iteration: 3600 / 4000 [ 90%]  (Sampling)
## Iteration: 4000 / 4000 [100%]  (Sampling)
## 
##  Elapsed Time: 2.439 seconds (Warm-up)
##                1.629 seconds (Sampling)
##                4.068 seconds (Total)
## 
## 
## SAMPLING FOR MODEL &#39;gaussian brms-model&#39; NOW (CHAIN 2).
## 
## Gradient evaluation took 0 seconds
## 1000 transitions using 10 leapfrog steps per transition would take 0 seconds.
## Adjust your expectations accordingly!
## 
## 
## Iteration:    1 / 4000 [  0%]  (Warmup)
## Iteration:  400 / 4000 [ 10%]  (Warmup)
## Iteration:  800 / 4000 [ 20%]  (Warmup)
## Iteration: 1200 / 4000 [ 30%]  (Warmup)
## Iteration: 1600 / 4000 [ 40%]  (Warmup)
## Iteration: 2000 / 4000 [ 50%]  (Warmup)
## Iteration: 2001 / 4000 [ 50%]  (Sampling)
## Iteration: 2400 / 4000 [ 60%]  (Sampling)
## Iteration: 2800 / 4000 [ 70%]  (Sampling)
## Iteration: 3200 / 4000 [ 80%]  (Sampling)
## Iteration: 3600 / 4000 [ 90%]  (Sampling)
## Iteration: 4000 / 4000 [100%]  (Sampling)
## 
##  Elapsed Time: 2.454 seconds (Warm-up)
##                1.803 seconds (Sampling)
##                4.257 seconds (Total)
## 
## 
## SAMPLING FOR MODEL &#39;gaussian brms-model&#39; NOW (CHAIN 3).
## 
## Gradient evaluation took 0 seconds
## 1000 transitions using 10 leapfrog steps per transition would take 0 seconds.
## Adjust your expectations accordingly!
## 
## 
## Iteration:    1 / 4000 [  0%]  (Warmup)
## Iteration:  400 / 4000 [ 10%]  (Warmup)
## Iteration:  800 / 4000 [ 20%]  (Warmup)
## Iteration: 1200 / 4000 [ 30%]  (Warmup)
## Iteration: 1600 / 4000 [ 40%]  (Warmup)
## Iteration: 2000 / 4000 [ 50%]  (Warmup)
## Iteration: 2001 / 4000 [ 50%]  (Sampling)
## Iteration: 2400 / 4000 [ 60%]  (Sampling)
## Iteration: 2800 / 4000 [ 70%]  (Sampling)
## Iteration: 3200 / 4000 [ 80%]  (Sampling)
## Iteration: 3600 / 4000 [ 90%]  (Sampling)
## Iteration: 4000 / 4000 [100%]  (Sampling)
## 
##  Elapsed Time: 2.471 seconds (Warm-up)
##                1.776 seconds (Sampling)
##                4.247 seconds (Total)
## 
## 
## SAMPLING FOR MODEL &#39;gaussian brms-model&#39; NOW (CHAIN 4).
## 
## Gradient evaluation took 0 seconds
## 1000 transitions using 10 leapfrog steps per transition would take 0 seconds.
## Adjust your expectations accordingly!
## 
## 
## Iteration:    1 / 4000 [  0%]  (Warmup)
## Iteration:  400 / 4000 [ 10%]  (Warmup)
## Iteration:  800 / 4000 [ 20%]  (Warmup)
## Iteration: 1200 / 4000 [ 30%]  (Warmup)
## Iteration: 1600 / 4000 [ 40%]  (Warmup)
## Iteration: 2000 / 4000 [ 50%]  (Warmup)
## Iteration: 2001 / 4000 [ 50%]  (Sampling)
## Iteration: 2400 / 4000 [ 60%]  (Sampling)
## Iteration: 2800 / 4000 [ 70%]  (Sampling)
## Iteration: 3200 / 4000 [ 80%]  (Sampling)
## Iteration: 3600 / 4000 [ 90%]  (Sampling)
## Iteration: 4000 / 4000 [100%]  (Sampling)
## 
##  Elapsed Time: 2.071 seconds (Warm-up)
##                2.078 seconds (Sampling)
##                4.149 seconds (Total)

brms<span class="op">::</span><span class="kw">prior_summary</span>(m_paAccelerometer_trackintervention, <span class="dt">data =</span> df)</code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["bound"],"name":[8],"type":["chr"],"align":["left"]}],"data":[{"1":"student_t(3, 181, 54)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":""},{"1":"student_t(3, 0, 54)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":""},{"1":"","2":"sd","3":"","4":"track:intervention","5":"","6":"","7":"","8":""},{"1":"","2":"sd","3":"Intercept","4":"track:intervention","5":"","6":"","7":"","8":""},{"1":"student_t(3, 0, 54)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":""}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
m_paAccelerometer_trackintervention
##  Family: gaussian 
##   Links: mu = identity; sigma = identity 
## Formula: paAccelerometer_T1 ~ (1 | track:intervention) 
##    Data: df (Number of observations: 706) 
## Samples: 4 chains, each with iter = 4000; warmup = 2000; thin = 1; 
##          total post-warmup samples = 8000
##     ICs: LOO = NA; WAIC = NA; R2 = NA
##  
## Group-Level Effects: 
## ~track:intervention (Number of levels: 10) 
##               Estimate Est.Error l-95% CI u-95% CI Eff.Sample Rhat
## sd(Intercept)    23.33      7.01    13.49    40.93       1881 1.00
## 
## Population-Level Effects: 
##           Estimate Est.Error l-95% CI u-95% CI Eff.Sample Rhat
## Intercept   177.54      8.10   161.48   194.09       1741 1.00
## 
## Family Specific Parameters: 
##       Estimate Est.Error l-95% CI u-95% CI Eff.Sample Rhat
## sigma    50.29      1.32    47.83    53.01       6980 1.00
## 
## Samples were drawn using sampling(NUTS). For each parameter, Eff.Sample 
## is a crude measure of effective sample size, and Rhat is the potential 
## scale reduction factor on split chains (at convergence, Rhat = 1).

b_intercept &lt;-<span class="st"> </span>brms<span class="op">::</span><span class="kw">fixef</span>(m_paAccelerometer_trackintervention)[<span class="dv">1</span>]

<span class="co"># This gives estimates only:</span>
PA_trackintervention_estimates &lt;-<span class="st"> </span>brms<span class="op">::</span><span class="kw">ranef</span>(m_paAccelerometer_trackintervention)[[<span class="dv">1</span>]][<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]


<span class="co"># The 2.5%ile:</span>
PA_trackintervention_CIL &lt;-<span class="st"> </span>brms<span class="op">::</span><span class="kw">ranef</span>(m_paAccelerometer_trackintervention)[[<span class="dv">1</span>]][<span class="dv">21</span><span class="op">:</span><span class="dv">30</span>]

<span class="co"># The 97.5%ile:</span>
PA_trackintervention_CIH &lt;-<span class="st"> </span>brms<span class="op">::</span><span class="kw">ranef</span>(m_paAccelerometer_trackintervention)[[<span class="dv">1</span>]][<span class="dv">31</span><span class="op">:</span><span class="dv">40</span>]

PA_trackintervention_ci &lt;-<span class="st"> </span><span class="kw">data.frame</span>(PA_trackintervention_CIL, PA_trackintervention_estimates, PA_trackintervention_CIH, <span class="dt">Variable =</span> <span class="kw">labels</span>(brms<span class="op">::</span><span class="kw">ranef</span>(m_paAccelerometer_trackintervention))) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">b_intercept =</span> <span class="kw">rep</span>(b_intercept, <span class="dv">10</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">PA_trackintervention_CIL =</span> PA_trackintervention_CIL <span class="op">+</span><span class="st"> </span>b_intercept,
         <span class="dt">PA_trackintervention_estimates =</span> PA_trackintervention_estimates <span class="op">+</span><span class="st"> </span>b_intercept,
         <span class="dt">PA_trackintervention_CIH =</span> PA_trackintervention_CIH <span class="op">+</span><span class="st"> </span>b_intercept,
         <span class="dt">track =</span> <span class="kw">c</span>(<span class="st">&#39;BA_control&#39;</span>,
                   <span class="st">&#39;BA_intervention&#39;</span>,
                   <span class="st">&#39;HRC_control&#39;</span>,
                   <span class="st">&#39;HRC_intervention&#39;</span>,
                   <span class="st">&#39;IT_control&#39;</span>,
                   <span class="st">&#39;IT_intervention&#39;</span>,
                   <span class="st">&#39;Nur_control&#39;</span>,
                   <span class="st">&#39;Nur_intervention&#39;</span>,
                   <span class="st">&#39;Other_control&#39;</span>,
                   <span class="st">&#39;Other_intervention&#39;</span>
))

PA_trackintervention_diamonds_intervention &lt;-<span class="st"> </span><span class="kw">rbind</span>(
PA_trackintervention_ci <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;Nur_intervention&quot;</span>),
PA_trackintervention_ci <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;HRC_intervention&quot;</span>),
PA_trackintervention_ci <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;BA_intervention&quot;</span>),
PA_trackintervention_ci <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;IT_intervention&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">arrange</span>(<span class="op">-</span><span class="kw">row_number</span>()) <span class="co"># reverse order of rows to make them right for the plot to come</span>

PA_trackintervention_diamonds_control &lt;-<span class="st"> </span><span class="kw">rbind</span>(
PA_trackintervention_ci <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;Nur_control&quot;</span>),
PA_trackintervention_ci <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;HRC_control&quot;</span>),
PA_trackintervention_ci <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;BA_control&quot;</span>),
PA_trackintervention_ci <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;IT_control&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">arrange</span>(<span class="op">-</span><span class="kw">row_number</span>()) <span class="co"># reverse order of rows to make them right for the plot to come</span>

PA_trackgirl_diamonds_girl</code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["PA_trackgirl_CIL"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["PA_trackgirl_estimates"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["PA_trackgirl_CIH"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Variable"],"name":[4],"type":["fctr"],"align":["left"]},{"label":["b_intercept"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["track"],"name":[6],"type":["chr"],"align":["left"]}],"data":[{"1":"105.5471","2":"132.8555","3":"157.9176","4":"track:girl","5":"176.7904","6":"IT_girl"},{"1":"159.2175","2":"178.9665","3":"198.7743","4":"track:girl","5":"176.7904","6":"BA_girl"},{"1":"166.1264","2":"184.8487","3":"204.7322","4":"track:girl","5":"176.7904","6":"HRC_girl"},{"1":"183.3733","2":"200.8111","3":"219.2797","4":"track:girl","5":"176.7904","6":"Nur_girl"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">PA_trackgirl_diamonds_boy</code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["PA_trackgirl_CIL"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["PA_trackgirl_estimates"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["PA_trackgirl_CIH"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Variable"],"name":[4],"type":["fctr"],"align":["left"]},{"label":["b_intercept"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["track"],"name":[6],"type":["chr"],"align":["left"]}],"data":[{"1":"127.6467","2":"147.3353","3":"166.5418","4":"track:girl","5":"176.7904","6":"IT_boy"},{"1":"160.9974","2":"179.9456","3":"199.8028","4":"track:girl","5":"176.7904","6":"BA_boy"},{"1":"158.8907","2":"179.2224","3":"200.0122","4":"track:girl","5":"176.7904","6":"HRC_boy"},{"1":"179.0103","2":"198.8156","3":"220.7299","4":"track:girl","5":"176.7904","6":"Nur_boy"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">PA_trackintervention_diamonds_intervention</code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["PA_trackintervention_CIL"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["PA_trackintervention_estimates"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["PA_trackintervention_CIH"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Variable"],"name":[4],"type":["fctr"],"align":["left"]},{"label":["b_intercept"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["track"],"name":[6],"type":["chr"],"align":["left"]}],"data":[{"1":"126.7626","2":"147.3696","3":"167.3386","4":"track:intervention","5":"177.5356","6":"IT_intervention"},{"1":"161.4760","2":"180.3106","3":"198.8826","4":"track:intervention","5":"177.5356","6":"BA_intervention"},{"1":"156.0911","2":"176.8814","3":"197.1322","4":"track:intervention","5":"177.5356","6":"HRC_intervention"},{"1":"185.7530","2":"202.8198","3":"220.0423","4":"track:intervention","5":"177.5356","6":"Nur_intervention"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">PA_trackintervention_diamonds_control</code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["PA_trackintervention_CIL"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["PA_trackintervention_estimates"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["PA_trackintervention_CIH"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Variable"],"name":[4],"type":["fctr"],"align":["left"]},{"label":["b_intercept"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["track"],"name":[6],"type":["chr"],"align":["left"]}],"data":[{"1":"121.9087","2":"142.5302","3":"161.4225","4":"track:intervention","5":"177.5356","6":"IT_control"},{"1":"160.0507","2":"178.6380","3":"196.6874","4":"track:intervention","5":"177.5356","6":"BA_control"},{"1":"166.9929","2":"185.2400","3":"202.8831","4":"track:intervention","5":"177.5356","6":"HRC_control"},{"1":"176.2124","2":"194.7435","3":"213.3496","4":"track:intervention","5":"177.5356","6":"Nur_control"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="accelerometer-measured-mvpa-density-plot" class="section level3">
<h3>Accelerometer-measured MVPA density plot:</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
plot1 &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(id,
                              <span class="dt">track =</span> track,
                              girl,
                              <span class="dt">PA =</span> paAccelerometer_T1)  <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(track), track <span class="op">!=</span><span class="st"> &quot;Other&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># Drop category &quot;Other&quot;</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">track =</span> <span class="kw">factor</span>(track, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;IT&quot;</span>, <span class="st">&quot;BA&quot;</span>, <span class="st">&quot;HRC&quot;</span>, <span class="st">&quot;Nur&quot;</span>)),
                <span class="dt">track =</span> <span class="kw">recode_factor</span>(track, <span class="st">&quot;IT&quot;</span> =<span class="st"> &quot;IT&quot;</span>, <span class="st">&quot;BA&quot;</span> =<span class="st"> &quot;BA&quot;</span>, 
                                      <span class="st">&quot;HRC&quot;</span> =<span class="st"> &quot;HRC&quot;</span>, <span class="st">&quot;Nur&quot;</span> =<span class="st"> &quot;Nur&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>ggplot2<span class="op">::</span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">y =</span> track)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">geom_density_ridges2</span>(<span class="kw">aes</span>(<span class="dt">x =</span> PA, <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>, 
                                    <span class="dt">fill =</span> <span class="kw">paste</span>(track, girl),
                                    <span class="dt">point_color =</span> girl,
                                    <span class="dt">point_fill =</span> girl,
                                    <span class="dt">point_shape =</span> girl),
                                  <span class="dt">scale =</span> .<span class="dv">75</span>, <span class="dt">alpha =</span> <span class="fl">0.6</span>, <span class="dt">size =</span> <span class="fl">0.25</span>,
                                  <span class="dt">position =</span> <span class="kw">position_raincloud</span>(<span class="dt">width =</span> <span class="fl">0.05</span>, <span class="dt">height =</span> <span class="fl">0.15</span>),
                                  <span class="co"># from = 0, to = 450,</span>
                                  <span class="dt">jittered_points =</span> <span class="ot">TRUE</span>,
                                  <span class="dt">point_size =</span> <span class="dv">1</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="ot">NULL</span>,
       <span class="dt">y =</span> <span class="ot">NULL</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_discrete</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.1</span>, <span class="dv">0</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_fill_cyclical</span>(
                                <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&#39;BA boy&#39;</span> =<span class="st"> &quot;Boy&quot;</span>, <span class="st">&#39;BA girl&#39;</span> =<span class="st"> &quot;Girl&quot;</span>),
                                <span class="dt">values =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>)],
                                <span class="dt">name =</span> <span class="st">&quot;&quot;</span>, 
                                <span class="dt">guide =</span> <span class="kw">guide_legend</span>(<span class="dt">override.aes =</span> <span class="kw">list</span>(<span class="dt">alpha =</span> <span class="dv">1</span>, 
                                                                         <span class="dt">point_shape =</span> <span class="kw">c</span>(<span class="dv">24</span>, <span class="dv">4</span>),
                                                                         <span class="dt">point_size =</span> <span class="dv">2</span>))) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_colour_cyclical</span>(<span class="dt">values =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">theme_ridges</span>(<span class="dt">grid =</span> <span class="ot">FALSE</span>) <span class="op">+</span>
<span class="st">  </span><span class="co"># ggplot2::scale_fill_manual(values = c(&quot;#A0FFA0&quot;, &quot;#A0A0FF&quot;)) +</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_discrete_manual</span>(<span class="dt">aesthetics =</span> <span class="st">&quot;point_color&quot;</span>, 
                                  <span class="dt">values =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">1</span>)],
                                  <span class="dt">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_discrete_manual</span>(<span class="dt">aesthetics =</span> <span class="st">&quot;point_fill&quot;</span>,
                                  <span class="dt">values =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">1</span>)],
                                  <span class="dt">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_discrete_manual</span>(<span class="dt">aesthetics =</span> <span class="st">&quot;point_shape&quot;</span>, 
                                  <span class="dt">values =</span> <span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">24</span>),
                                  <span class="dt">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>papaja<span class="op">::</span><span class="kw">theme_apa</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)

plot1 &lt;-<span class="st"> </span>plot1 <span class="op">+</span><span class="st"> </span>
<span class="st">  </span>userfriendlyscience<span class="op">::</span><span class="kw">diamondPlot</span>(PA_trackgirl_diamonds_girl, 
                                   <span class="dt">returnLayerOnly =</span> <span class="ot">TRUE</span>, 
                                   <span class="dt">lineColor =</span> <span class="st">&quot;black&quot;</span>, 
                                   <span class="dt">color=</span>viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">3</span>],
                                   <span class="dt">alpha=</span>.<span class="dv">6</span>, 
                                   <span class="dt">fixedSize =</span> <span class="fl">0.1</span>, 
                                   <span class="dt">otherAxisCol =</span> (<span class="dv">1</span><span class="op">:</span><span class="dv">4</span> <span class="op">+</span><span class="st"> </span>.<span class="dv">15</span>)) <span class="op">+</span><span class="st"> </span><span class="co"># specify y-position; option to move the diamond </span>
<span class="st">  </span>userfriendlyscience<span class="op">::</span><span class="kw">diamondPlot</span>(PA_trackgirl_diamonds_boy, 
                                   <span class="dt">returnLayerOnly =</span> <span class="ot">TRUE</span>, 
                                   <span class="dt">lineColor =</span> <span class="st">&quot;black&quot;</span>, 
                                   <span class="dt">linetype =</span> <span class="st">&quot;solid&quot;</span>, 
                                   <span class="dt">color=</span>viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">1</span>],
                                   <span class="dt">alpha=</span>.<span class="dv">6</span>, 
                                   <span class="dt">fixedSize =</span> <span class="fl">0.1</span>, 
                                   <span class="dt">otherAxisCol =</span> (<span class="dv">1</span><span class="op">:</span><span class="dv">4</span> <span class="op">+</span><span class="st"> </span>.<span class="dv">15</span>))

<span class="co"># Draw plot with intervention and control densities</span>

plot2 &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(id,
                              <span class="dt">track =</span> track,
                              intervention,
                              <span class="dt">PA =</span> paAccelerometer_T1)  <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(track), track <span class="op">!=</span><span class="st"> &quot;Other&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># Drop category &quot;Other&quot;</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">track =</span> <span class="kw">factor</span>(track, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;IT&quot;</span>, <span class="st">&quot;BA&quot;</span>, <span class="st">&quot;HRC&quot;</span>, <span class="st">&quot;Nur&quot;</span>)),
                <span class="dt">track =</span> <span class="kw">recode_factor</span>(track, <span class="st">&quot;IT&quot;</span> =<span class="st"> &quot;IT&quot;</span>, <span class="st">&quot;BA&quot;</span> =<span class="st"> &quot;BA&quot;</span>, 
                                      <span class="st">&quot;HRC&quot;</span> =<span class="st"> &quot;HRC&quot;</span>, <span class="st">&quot;Nur&quot;</span> =<span class="st"> &quot;Nur&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>ggplot2<span class="op">::</span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">y =</span> track)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">geom_density_ridges2</span>(<span class="kw">aes</span>(<span class="dt">x =</span> PA, <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>, 
                                    <span class="dt">fill =</span> <span class="kw">paste</span>(track, intervention),
                                    <span class="dt">point_color =</span> intervention,
                                    <span class="dt">point_fill =</span> intervention,
                                    <span class="dt">point_shape =</span> intervention),
                                  <span class="dt">scale =</span> .<span class="dv">75</span>, <span class="dt">alpha =</span> <span class="fl">0.6</span>, <span class="dt">size =</span> <span class="fl">0.25</span>,
                                  <span class="dt">position =</span> <span class="kw">position_raincloud</span>(<span class="dt">width =</span> <span class="fl">0.05</span>, <span class="dt">height =</span> <span class="fl">0.15</span>),
                                  <span class="co"># from = 0, to = 450,</span>
                                  <span class="dt">jittered_points =</span> <span class="ot">TRUE</span>,
                                  <span class="dt">point_size =</span> <span class="dv">1</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="ot">NULL</span>,
       <span class="dt">y =</span> <span class="ot">NULL</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_discrete</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.1</span>, <span class="dv">0</span>), <span class="dt">labels =</span> <span class="ot">NULL</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_fill_cyclical</span>(
                                <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&#39;BA 0&#39;</span> =<span class="st"> &quot;Control&quot;</span>, <span class="st">&#39;BA 1&#39;</span> =<span class="st"> &quot;Intervention&quot;</span>),
                                <span class="dt">values =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">4</span>)],
                                <span class="dt">name =</span> <span class="st">&quot;&quot;</span>, 
                                <span class="dt">guide =</span> <span class="kw">guide_legend</span>(<span class="dt">override.aes =</span> <span class="kw">list</span>(<span class="dt">alpha =</span> <span class="dv">1</span>, 
                                                                         <span class="dt">point_shape =</span> <span class="kw">c</span>(<span class="dv">21</span>, <span class="dv">3</span>),
                                                                         <span class="dt">point_size =</span> <span class="dv">2</span>))) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_colour_cyclical</span>(<span class="dt">values =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">theme_ridges</span>(<span class="dt">grid =</span> <span class="ot">FALSE</span>) <span class="op">+</span>
<span class="st">  </span><span class="co"># ggplot2::scale_fill_manual(values = c(&quot;#A0FFA0&quot;, &quot;#A0A0FF&quot;)) +</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_discrete_manual</span>(<span class="dt">aesthetics =</span> <span class="st">&quot;point_color&quot;</span>, 
                                  <span class="dt">values =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">4</span>)],
                                  <span class="dt">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_discrete_manual</span>(<span class="dt">aesthetics =</span> <span class="st">&quot;point_fill&quot;</span>,
                                  <span class="dt">values =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">4</span>)],
                                  <span class="dt">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_discrete_manual</span>(<span class="dt">aesthetics =</span> <span class="st">&quot;point_shape&quot;</span>, 
                                  <span class="dt">values =</span> <span class="kw">c</span>(<span class="dv">21</span>, <span class="dv">3</span>),
                                  <span class="dt">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>papaja<span class="op">::</span><span class="kw">theme_apa</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)

plot2 &lt;-<span class="st"> </span>plot2 <span class="op">+</span><span class="st"> </span>
<span class="st">  </span>userfriendlyscience<span class="op">::</span><span class="kw">diamondPlot</span>(PA_trackintervention_diamonds_intervention, 
                                   <span class="dt">returnLayerOnly =</span> <span class="ot">TRUE</span>, 
                                   <span class="dt">lineColor =</span> <span class="st">&quot;black&quot;</span>,  
                                   <span class="dt">color=</span>viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">4</span>],
                                   <span class="dt">alpha=</span>.<span class="dv">6</span>, 
                                   <span class="dt">fixedSize =</span> <span class="fl">0.1</span>, 
                                   <span class="dt">otherAxisCol =</span> (<span class="dv">1</span><span class="op">:</span><span class="dv">4</span> <span class="op">+</span><span class="st"> </span>.<span class="dv">15</span>)) <span class="op">+</span>
<span class="st">  </span>userfriendlyscience<span class="op">::</span><span class="kw">diamondPlot</span>(PA_trackintervention_diamonds_control, 
                                   <span class="dt">returnLayerOnly =</span> <span class="ot">TRUE</span>, 
                                   <span class="dt">lineColor =</span> <span class="st">&quot;black&quot;</span>,  
                                   <span class="dt">color=</span>viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">2</span>],
                                   <span class="dt">alpha=</span>.<span class="dv">6</span>, 
                                   <span class="dt">fixedSize =</span> <span class="fl">0.1</span>, 
                                   <span class="dt">otherAxisCol =</span> (<span class="dv">1</span><span class="op">:</span><span class="dv">4</span> <span class="op">+</span><span class="st"> </span>.<span class="dv">15</span>))

plot1 <span class="op">+</span><span class="st"> </span>plot2
## Picking joint bandwidth of 18.1
## Warning: Removed 370 rows containing non-finite values
## (stat_density_ridges).
## Picking joint bandwidth of 17.4
## Warning: Removed 370 rows containing non-finite values
## (stat_density_ridges).</code></pre></div>
<p><img src="baseline-supplement_files/figure-html/MVPA-accelerometer-plot-1.png" width="672" /></p>
</div>
</div>
<div id="self-reported-mvpa-days-previous-week" class="section level2">
<h2>Self-reported MVPA days, previous week</h2>
<p>Description</p>
<p>This section reports the question on how many days the participants did MVPA during the previous week.</p>
<p>Code chunk below prepares data.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m_padaysLastweek_trackgirl &lt;-<span class="st"> </span>brms<span class="op">::</span><span class="kw">bf</span>(padaysLastweek_T1 <span class="op">~</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>track<span class="op">:</span>girl)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>brms<span class="op">::</span><span class="kw">brm</span>(., <span class="dt">data =</span> df, <span class="dt">chains =</span> <span class="dv">4</span>, <span class="dt">iter =</span> <span class="dv">4000</span>, <span class="dt">control =</span> <span class="kw">list</span>(<span class="dt">adapt_delta =</span> <span class="fl">0.95</span>))
## Found more than one class &quot;family&quot; in cache; using the first, from namespace &#39;lme4&#39;
## Also defined by &#39;MatrixModels&#39;
## Warning: Rows containing NAs were excluded from the model
## Compiling the C++ model
## Start sampling
## 
## SAMPLING FOR MODEL &#39;gaussian brms-model&#39; NOW (CHAIN 1).
## 
## Gradient evaluation took 0 seconds
## 1000 transitions using 10 leapfrog steps per transition would take 0 seconds.
## Adjust your expectations accordingly!
## 
## 
## Iteration:    1 / 4000 [  0%]  (Warmup)
## Iteration:  400 / 4000 [ 10%]  (Warmup)
## Iteration:  800 / 4000 [ 20%]  (Warmup)
## Iteration: 1200 / 4000 [ 30%]  (Warmup)
## Iteration: 1600 / 4000 [ 40%]  (Warmup)
## Iteration: 2000 / 4000 [ 50%]  (Warmup)
## Iteration: 2001 / 4000 [ 50%]  (Sampling)
## Iteration: 2400 / 4000 [ 60%]  (Sampling)
## Iteration: 2800 / 4000 [ 70%]  (Sampling)
## Iteration: 3200 / 4000 [ 80%]  (Sampling)
## Iteration: 3600 / 4000 [ 90%]  (Sampling)
## Iteration: 4000 / 4000 [100%]  (Sampling)
## 
##  Elapsed Time: 2.212 seconds (Warm-up)
##                2.223 seconds (Sampling)
##                4.435 seconds (Total)
## 
## 
## SAMPLING FOR MODEL &#39;gaussian brms-model&#39; NOW (CHAIN 2).
## 
## Gradient evaluation took 0 seconds
## 1000 transitions using 10 leapfrog steps per transition would take 0 seconds.
## Adjust your expectations accordingly!
## 
## 
## Iteration:    1 / 4000 [  0%]  (Warmup)
## Iteration:  400 / 4000 [ 10%]  (Warmup)
## Iteration:  800 / 4000 [ 20%]  (Warmup)
## Iteration: 1200 / 4000 [ 30%]  (Warmup)
## Iteration: 1600 / 4000 [ 40%]  (Warmup)
## Iteration: 2000 / 4000 [ 50%]  (Warmup)
## Iteration: 2001 / 4000 [ 50%]  (Sampling)
## Iteration: 2400 / 4000 [ 60%]  (Sampling)
## Iteration: 2800 / 4000 [ 70%]  (Sampling)
## Iteration: 3200 / 4000 [ 80%]  (Sampling)
## Iteration: 3600 / 4000 [ 90%]  (Sampling)
## Iteration: 4000 / 4000 [100%]  (Sampling)
## 
##  Elapsed Time: 2.347 seconds (Warm-up)
##                2.042 seconds (Sampling)
##                4.389 seconds (Total)
## 
## 
## SAMPLING FOR MODEL &#39;gaussian brms-model&#39; NOW (CHAIN 3).
## 
## Gradient evaluation took 0 seconds
## 1000 transitions using 10 leapfrog steps per transition would take 0 seconds.
## Adjust your expectations accordingly!
## 
## 
## Iteration:    1 / 4000 [  0%]  (Warmup)
## Iteration:  400 / 4000 [ 10%]  (Warmup)
## Iteration:  800 / 4000 [ 20%]  (Warmup)
## Iteration: 1200 / 4000 [ 30%]  (Warmup)
## Iteration: 1600 / 4000 [ 40%]  (Warmup)
## Iteration: 2000 / 4000 [ 50%]  (Warmup)
## Iteration: 2001 / 4000 [ 50%]  (Sampling)
## Iteration: 2400 / 4000 [ 60%]  (Sampling)
## Iteration: 2800 / 4000 [ 70%]  (Sampling)
## Iteration: 3200 / 4000 [ 80%]  (Sampling)
## Iteration: 3600 / 4000 [ 90%]  (Sampling)
## Iteration: 4000 / 4000 [100%]  (Sampling)
## 
##  Elapsed Time: 2.21 seconds (Warm-up)
##                1.617 seconds (Sampling)
##                3.827 seconds (Total)
## 
## 
## SAMPLING FOR MODEL &#39;gaussian brms-model&#39; NOW (CHAIN 4).
## 
## Gradient evaluation took 0 seconds
## 1000 transitions using 10 leapfrog steps per transition would take 0 seconds.
## Adjust your expectations accordingly!
## 
## 
## Iteration:    1 / 4000 [  0%]  (Warmup)
## Iteration:  400 / 4000 [ 10%]  (Warmup)
## Iteration:  800 / 4000 [ 20%]  (Warmup)
## Iteration: 1200 / 4000 [ 30%]  (Warmup)
## Iteration: 1600 / 4000 [ 40%]  (Warmup)
## Iteration: 2000 / 4000 [ 50%]  (Warmup)
## Iteration: 2001 / 4000 [ 50%]  (Sampling)
## Iteration: 2400 / 4000 [ 60%]  (Sampling)
## Iteration: 2800 / 4000 [ 70%]  (Sampling)
## Iteration: 3200 / 4000 [ 80%]  (Sampling)
## Iteration: 3600 / 4000 [ 90%]  (Sampling)
## Iteration: 4000 / 4000 [100%]  (Sampling)
## 
##  Elapsed Time: 2.315 seconds (Warm-up)
##                1.963 seconds (Sampling)
##                4.278 seconds (Total)

brms<span class="op">::</span><span class="kw">prior_summary</span>(m_padaysLastweek_trackgirl, <span class="dt">data =</span> df)</code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["bound"],"name":[8],"type":["chr"],"align":["left"]}],"data":[{"1":"student_t(3, 3, 10)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":""},{"1":"student_t(3, 0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":""},{"1":"","2":"sd","3":"","4":"track:girl","5":"","6":"","7":"","8":""},{"1":"","2":"sd","3":"Intercept","4":"track:girl","5":"","6":"","7":"","8":""},{"1":"student_t(3, 0, 10)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":""}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
m_padaysLastweek_trackgirl
##  Family: gaussian 
##   Links: mu = identity; sigma = identity 
## Formula: padaysLastweek_T1 ~ (1 | track:girl) 
##    Data: df (Number of observations: 1082) 
## Samples: 4 chains, each with iter = 4000; warmup = 2000; thin = 1; 
##          total post-warmup samples = 8000
##     ICs: LOO = NA; WAIC = NA; R2 = NA
##  
## Group-Level Effects: 
## ~track:girl (Number of levels: 10) 
##               Estimate Est.Error l-95% CI u-95% CI Eff.Sample Rhat
## sd(Intercept)     0.59      0.20     0.32     1.08       2020 1.00
## 
## Population-Level Effects: 
##           Estimate Est.Error l-95% CI u-95% CI Eff.Sample Rhat
## Intercept     2.82      0.22     2.41     3.27       2088 1.00
## 
## Family Specific Parameters: 
##       Estimate Est.Error l-95% CI u-95% CI Eff.Sample Rhat
## sigma     1.84      0.04     1.76     1.92       6616 1.00
## 
## Samples were drawn using sampling(NUTS). For each parameter, Eff.Sample 
## is a crude measure of effective sample size, and Rhat is the potential 
## scale reduction factor on split chains (at convergence, Rhat = 1).

b_intercept &lt;-<span class="st"> </span>brms<span class="op">::</span><span class="kw">fixef</span>(m_padaysLastweek_trackgirl)[<span class="dv">1</span>]

<span class="co"># This gives estimates only:</span>
padaysLastweek_trackgirl_estimates &lt;-<span class="st"> </span>brms<span class="op">::</span><span class="kw">ranef</span>(m_padaysLastweek_trackgirl)[[<span class="dv">1</span>]][<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]

<span class="co"># The 2.5%ile:</span>
padaysLastweek_trackgirl_CIL &lt;-<span class="st"> </span>brms<span class="op">::</span><span class="kw">ranef</span>(m_padaysLastweek_trackgirl)[[<span class="dv">1</span>]][<span class="dv">21</span><span class="op">:</span><span class="dv">30</span>]

<span class="co"># The 97.5%ile:</span>
padaysLastweek_trackgirl_CIH &lt;-<span class="st"> </span>brms<span class="op">::</span><span class="kw">ranef</span>(m_padaysLastweek_trackgirl)[[<span class="dv">1</span>]][<span class="dv">31</span><span class="op">:</span><span class="dv">40</span>]

padaysLastweek_trackgirl_ci &lt;-<span class="st"> </span><span class="kw">data.frame</span>(padaysLastweek_trackgirl_CIL, padaysLastweek_trackgirl_estimates, padaysLastweek_trackgirl_CIH, <span class="dt">Variable =</span> <span class="kw">labels</span>(brms<span class="op">::</span><span class="kw">ranef</span>(m_padaysLastweek_trackgirl))) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">b_intercept =</span> <span class="kw">rep</span>(b_intercept, <span class="dv">10</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">padaysLastweek_trackgirl_CIL =</span> padaysLastweek_trackgirl_CIL <span class="op">+</span><span class="st"> </span>b_intercept,
         <span class="dt">padaysLastweek_trackgirl_estimates =</span> padaysLastweek_trackgirl_estimates <span class="op">+</span><span class="st"> </span>b_intercept,
         <span class="dt">padaysLastweek_trackgirl_CIH =</span> padaysLastweek_trackgirl_CIH <span class="op">+</span><span class="st"> </span>b_intercept,
         <span class="dt">track =</span> <span class="kw">c</span>(<span class="st">&#39;BA_boy&#39;</span>,
                   <span class="st">&#39;BA_girl&#39;</span>,
                   <span class="st">&#39;HRC_boy&#39;</span>,
                   <span class="st">&#39;HRC_girl&#39;</span>,
                   <span class="st">&#39;IT_boy&#39;</span>,
                   <span class="st">&#39;IT_girl&#39;</span>,
                   <span class="st">&#39;Nur_boy&#39;</span>,
                   <span class="st">&#39;Nur_girl&#39;</span>,
                   <span class="st">&#39;Other_boy&#39;</span>,
                   <span class="st">&#39;Other_girl&#39;</span>
))

padaysLastweek_trackgirl_diamonds_girl &lt;-<span class="st"> </span><span class="kw">rbind</span>(
padaysLastweek_trackgirl_ci <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;Nur_girl&quot;</span>),
padaysLastweek_trackgirl_ci <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;HRC_girl&quot;</span>),
padaysLastweek_trackgirl_ci <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;BA_girl&quot;</span>),
padaysLastweek_trackgirl_ci <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;IT_girl&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">arrange</span>(<span class="op">-</span><span class="kw">row_number</span>()) <span class="co"># reverse order of rows to make them right for the plot to come</span>

padaysLastweek_trackgirl_diamonds_boy &lt;-<span class="st"> </span><span class="kw">rbind</span>(
padaysLastweek_trackgirl_ci <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;Nur_boy&quot;</span>),
padaysLastweek_trackgirl_ci <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;HRC_boy&quot;</span>),
padaysLastweek_trackgirl_ci <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;BA_boy&quot;</span>),
padaysLastweek_trackgirl_ci <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;IT_boy&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">arrange</span>(<span class="op">-</span><span class="kw">row_number</span>()) <span class="co"># reverse order of rows to make them right for the plot to come</span>


m_padaysLastweek_trackintervention &lt;-<span class="st"> </span>brms<span class="op">::</span><span class="kw">bf</span>(padaysLastweek_T1 <span class="op">~</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>track<span class="op">:</span>intervention)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>brms<span class="op">::</span><span class="kw">brm</span>(., <span class="dt">data =</span> df, <span class="dt">chains =</span> <span class="dv">4</span>, <span class="dt">iter =</span> <span class="dv">4000</span>, <span class="dt">control =</span> <span class="kw">list</span>(<span class="dt">adapt_delta =</span> <span class="fl">0.95</span>))
## Found more than one class &quot;family&quot; in cache; using the first, from namespace &#39;lme4&#39;
## Also defined by &#39;MatrixModels&#39;
## Warning: Rows containing NAs were excluded from the model
## Compiling the C++ model
## Start sampling
## 
## SAMPLING FOR MODEL &#39;gaussian brms-model&#39; NOW (CHAIN 1).
## 
## Gradient evaluation took 0 seconds
## 1000 transitions using 10 leapfrog steps per transition would take 0 seconds.
## Adjust your expectations accordingly!
## 
## 
## Iteration:    1 / 4000 [  0%]  (Warmup)
## Iteration:  400 / 4000 [ 10%]  (Warmup)
## Iteration:  800 / 4000 [ 20%]  (Warmup)
## Iteration: 1200 / 4000 [ 30%]  (Warmup)
## Iteration: 1600 / 4000 [ 40%]  (Warmup)
## Iteration: 2000 / 4000 [ 50%]  (Warmup)
## Iteration: 2001 / 4000 [ 50%]  (Sampling)
## Iteration: 2400 / 4000 [ 60%]  (Sampling)
## Iteration: 2800 / 4000 [ 70%]  (Sampling)
## Iteration: 3200 / 4000 [ 80%]  (Sampling)
## Iteration: 3600 / 4000 [ 90%]  (Sampling)
## Iteration: 4000 / 4000 [100%]  (Sampling)
## 
##  Elapsed Time: 2.07 seconds (Warm-up)
##                1.459 seconds (Sampling)
##                3.529 seconds (Total)
## 
## 
## SAMPLING FOR MODEL &#39;gaussian brms-model&#39; NOW (CHAIN 2).
## 
## Gradient evaluation took 0 seconds
## 1000 transitions using 10 leapfrog steps per transition would take 0 seconds.
## Adjust your expectations accordingly!
## 
## 
## Iteration:    1 / 4000 [  0%]  (Warmup)
## Iteration:  400 / 4000 [ 10%]  (Warmup)
## Iteration:  800 / 4000 [ 20%]  (Warmup)
## Iteration: 1200 / 4000 [ 30%]  (Warmup)
## Iteration: 1600 / 4000 [ 40%]  (Warmup)
## Iteration: 2000 / 4000 [ 50%]  (Warmup)
## Iteration: 2001 / 4000 [ 50%]  (Sampling)
## Iteration: 2400 / 4000 [ 60%]  (Sampling)
## Iteration: 2800 / 4000 [ 70%]  (Sampling)
## Iteration: 3200 / 4000 [ 80%]  (Sampling)
## Iteration: 3600 / 4000 [ 90%]  (Sampling)
## Iteration: 4000 / 4000 [100%]  (Sampling)
## 
##  Elapsed Time: 2.039 seconds (Warm-up)
##                1.776 seconds (Sampling)
##                3.815 seconds (Total)
## 
## 
## SAMPLING FOR MODEL &#39;gaussian brms-model&#39; NOW (CHAIN 3).
## 
## Gradient evaluation took 0 seconds
## 1000 transitions using 10 leapfrog steps per transition would take 0 seconds.
## Adjust your expectations accordingly!
## 
## 
## Iteration:    1 / 4000 [  0%]  (Warmup)
## Iteration:  400 / 4000 [ 10%]  (Warmup)
## Iteration:  800 / 4000 [ 20%]  (Warmup)
## Iteration: 1200 / 4000 [ 30%]  (Warmup)
## Iteration: 1600 / 4000 [ 40%]  (Warmup)
## Iteration: 2000 / 4000 [ 50%]  (Warmup)
## Iteration: 2001 / 4000 [ 50%]  (Sampling)
## Iteration: 2400 / 4000 [ 60%]  (Sampling)
## Iteration: 2800 / 4000 [ 70%]  (Sampling)
## Iteration: 3200 / 4000 [ 80%]  (Sampling)
## Iteration: 3600 / 4000 [ 90%]  (Sampling)
## Iteration: 4000 / 4000 [100%]  (Sampling)
## 
##  Elapsed Time: 2.193 seconds (Warm-up)
##                1.72 seconds (Sampling)
##                3.913 seconds (Total)
## 
## 
## SAMPLING FOR MODEL &#39;gaussian brms-model&#39; NOW (CHAIN 4).
## 
## Gradient evaluation took 0 seconds
## 1000 transitions using 10 leapfrog steps per transition would take 0 seconds.
## Adjust your expectations accordingly!
## 
## 
## Iteration:    1 / 4000 [  0%]  (Warmup)
## Iteration:  400 / 4000 [ 10%]  (Warmup)
## Iteration:  800 / 4000 [ 20%]  (Warmup)
## Iteration: 1200 / 4000 [ 30%]  (Warmup)
## Iteration: 1600 / 4000 [ 40%]  (Warmup)
## Iteration: 2000 / 4000 [ 50%]  (Warmup)
## Iteration: 2001 / 4000 [ 50%]  (Sampling)
## Iteration: 2400 / 4000 [ 60%]  (Sampling)
## Iteration: 2800 / 4000 [ 70%]  (Sampling)
## Iteration: 3200 / 4000 [ 80%]  (Sampling)
## Iteration: 3600 / 4000 [ 90%]  (Sampling)
## Iteration: 4000 / 4000 [100%]  (Sampling)
## 
##  Elapsed Time: 1.97 seconds (Warm-up)
##                1.315 seconds (Sampling)
##                3.285 seconds (Total)

brms<span class="op">::</span><span class="kw">prior_summary</span>(m_padaysLastweek_trackintervention, <span class="dt">data =</span> df)</code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["bound"],"name":[8],"type":["chr"],"align":["left"]}],"data":[{"1":"student_t(3, 3, 10)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":""},{"1":"student_t(3, 0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":""},{"1":"","2":"sd","3":"","4":"track:intervention","5":"","6":"","7":"","8":""},{"1":"","2":"sd","3":"Intercept","4":"track:intervention","5":"","6":"","7":"","8":""},{"1":"student_t(3, 0, 10)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":""}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
m_padaysLastweek_trackintervention
##  Family: gaussian 
##   Links: mu = identity; sigma = identity 
## Formula: padaysLastweek_T1 ~ (1 | track:intervention) 
##    Data: df (Number of observations: 1082) 
## Samples: 4 chains, each with iter = 4000; warmup = 2000; thin = 1; 
##          total post-warmup samples = 8000
##     ICs: LOO = NA; WAIC = NA; R2 = NA
##  
## Group-Level Effects: 
## ~track:intervention (Number of levels: 10) 
##               Estimate Est.Error l-95% CI u-95% CI Eff.Sample Rhat
## sd(Intercept)     0.46      0.17     0.23     0.87       2130 1.00
## 
## Population-Level Effects: 
##           Estimate Est.Error l-95% CI u-95% CI Eff.Sample Rhat
## Intercept     2.78      0.18     2.43     3.13       1613 1.00
## 
## Family Specific Parameters: 
##       Estimate Est.Error l-95% CI u-95% CI Eff.Sample Rhat
## sigma     1.87      0.04     1.79     1.95       8000 1.00
## 
## Samples were drawn using sampling(NUTS). For each parameter, Eff.Sample 
## is a crude measure of effective sample size, and Rhat is the potential 
## scale reduction factor on split chains (at convergence, Rhat = 1).

b_intercept &lt;-<span class="st"> </span>brms<span class="op">::</span><span class="kw">fixef</span>(m_padaysLastweek_trackintervention)[<span class="dv">1</span>]

<span class="co"># This gives estimates only:</span>
padaysLastweek_trackintervention_estimates &lt;-<span class="st"> </span>brms<span class="op">::</span><span class="kw">ranef</span>(m_padaysLastweek_trackintervention)[[<span class="dv">1</span>]][<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]

<span class="co"># The 2.5%ile:</span>
padaysLastweek_trackintervention_CIL &lt;-<span class="st"> </span>brms<span class="op">::</span><span class="kw">ranef</span>(m_padaysLastweek_trackintervention)[[<span class="dv">1</span>]][<span class="dv">21</span><span class="op">:</span><span class="dv">30</span>]

<span class="co"># The 97.5%ile:</span>
padaysLastweek_trackintervention_CIH &lt;-<span class="st"> </span>brms<span class="op">::</span><span class="kw">ranef</span>(m_padaysLastweek_trackintervention)[[<span class="dv">1</span>]][<span class="dv">31</span><span class="op">:</span><span class="dv">40</span>]

padaysLastweek_trackintervention_ci &lt;-<span class="st"> </span><span class="kw">data.frame</span>(padaysLastweek_trackintervention_CIL, padaysLastweek_trackintervention_estimates, padaysLastweek_trackintervention_CIH, <span class="dt">Variable =</span> <span class="kw">labels</span>(brms<span class="op">::</span><span class="kw">ranef</span>(m_padaysLastweek_trackintervention))) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">b_intercept =</span> <span class="kw">rep</span>(b_intercept, <span class="dv">10</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">padaysLastweek_trackintervention_CIL =</span> padaysLastweek_trackintervention_CIL <span class="op">+</span><span class="st"> </span>b_intercept,
         <span class="dt">padaysLastweek_trackintervention_estimates =</span> padaysLastweek_trackintervention_estimates <span class="op">+</span><span class="st"> </span>b_intercept,
         <span class="dt">padaysLastweek_trackintervention_CIH =</span> padaysLastweek_trackintervention_CIH <span class="op">+</span><span class="st"> </span>b_intercept,
         <span class="dt">track =</span> <span class="kw">c</span>(<span class="st">&#39;BA_control&#39;</span>,
                   <span class="st">&#39;BA_intervention&#39;</span>,
                   <span class="st">&#39;HRC_control&#39;</span>,
                   <span class="st">&#39;HRC_intervention&#39;</span>,
                   <span class="st">&#39;IT_control&#39;</span>,
                   <span class="st">&#39;IT_intervention&#39;</span>,
                   <span class="st">&#39;Nur_control&#39;</span>,
                   <span class="st">&#39;Nur_intervention&#39;</span>,
                   <span class="st">&#39;Other_control&#39;</span>,
                   <span class="st">&#39;Other_intervention&#39;</span>
))

padaysLastweek_trackintervention_diamonds_intervention &lt;-<span class="st"> </span><span class="kw">rbind</span>(
padaysLastweek_trackintervention_ci <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;Nur_intervention&quot;</span>),
padaysLastweek_trackintervention_ci <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;HRC_intervention&quot;</span>),
padaysLastweek_trackintervention_ci <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;BA_intervention&quot;</span>),
padaysLastweek_trackintervention_ci <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;IT_intervention&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">arrange</span>(<span class="op">-</span><span class="kw">row_number</span>()) <span class="co"># reverse order of rows to make them right for the plot to come</span>

padaysLastweek_trackintervention_diamonds_control &lt;-<span class="st"> </span><span class="kw">rbind</span>(
padaysLastweek_trackintervention_ci <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;Nur_control&quot;</span>),
padaysLastweek_trackintervention_ci <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;HRC_control&quot;</span>),
padaysLastweek_trackintervention_ci <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;BA_control&quot;</span>),
padaysLastweek_trackintervention_ci <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;IT_control&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">arrange</span>(<span class="op">-</span><span class="kw">row_number</span>()) <span class="co"># reverse order of rows to make them right for the plot to come</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
padaysLastweek_trackgirl_diamonds_girl <span class="op">%&gt;%</span><span class="st"> </span>papaja<span class="op">::</span><span class="kw">apa_table</span>()</code></pre></div>
<caption>
(#tab:padaysLastweek-tables)
</caption>
<caption>
**
</caption>
<table>
<thead>
<tr class="header">
<th align="left">padaysLastweek_trackgirl_CIL</th>
<th align="left">padaysLastweek_trackgirl_estimates</th>
<th align="left">padaysLastweek_trackgirl_CIH</th>
<th align="left">Variable</th>
<th align="left">b_intercept</th>
<th align="left">track</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">1.68</td>
<td align="left">2.41</td>
<td align="left">3.07</td>
<td align="left">track:girl</td>
<td align="left">2.82</td>
<td align="left">IT_girl</td>
</tr>
<tr class="even">
<td align="left">2.24</td>
<td align="left">2.75</td>
<td align="left">3.24</td>
<td align="left">track:girl</td>
<td align="left">2.82</td>
<td align="left">BA_girl</td>
</tr>
<tr class="odd">
<td align="left">1.81</td>
<td align="left">2.35</td>
<td align="left">2.83</td>
<td align="left">track:girl</td>
<td align="left">2.82</td>
<td align="left">HRC_girl</td>
</tr>
<tr class="even">
<td align="left">2.10</td>
<td align="left">2.57</td>
<td align="left">3.01</td>
<td align="left">track:girl</td>
<td align="left">2.82</td>
<td align="left">Nur_girl</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">padaysLastweek_trackgirl_diamonds_boy <span class="op">%&gt;%</span><span class="st"> </span>papaja<span class="op">::</span><span class="kw">apa_table</span>()</code></pre></div>
<caption>
(#tab:padaysLastweek-tables)
</caption>
<caption>
**
</caption>
<table>
<thead>
<tr class="header">
<th align="left">padaysLastweek_trackgirl_CIL</th>
<th align="left">padaysLastweek_trackgirl_estimates</th>
<th align="left">padaysLastweek_trackgirl_CIH</th>
<th align="left">Variable</th>
<th align="left">b_intercept</th>
<th align="left">track</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">1.86</td>
<td align="left">2.37</td>
<td align="left">2.85</td>
<td align="left">track:girl</td>
<td align="left">2.82</td>
<td align="left">IT_boy</td>
</tr>
<tr class="even">
<td align="left">3.23</td>
<td align="left">3.72</td>
<td align="left">4.21</td>
<td align="left">track:girl</td>
<td align="left">2.82</td>
<td align="left">BA_boy</td>
</tr>
<tr class="odd">
<td align="left">2.46</td>
<td align="left">3.01</td>
<td align="left">3.54</td>
<td align="left">track:girl</td>
<td align="left">2.82</td>
<td align="left">HRC_boy</td>
</tr>
<tr class="even">
<td align="left">2.72</td>
<td align="left">3.26</td>
<td align="left">3.82</td>
<td align="left">track:girl</td>
<td align="left">2.82</td>
<td align="left">Nur_boy</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">padaysLastweek_trackintervention_diamonds_intervention <span class="op">%&gt;%</span><span class="st"> </span>papaja<span class="op">::</span><span class="kw">apa_table</span>()</code></pre></div>
<caption>
(#tab:padaysLastweek-tables)
</caption>
<caption>
**
</caption>
<table>
<thead>
<tr class="header">
<th align="left">padaysLastweek_trackintervention_CIL</th>
<th align="left">padaysLastweek_trackintervention_estimates</th>
<th align="left">padaysLastweek_trackintervention_CIH</th>
<th align="left">Variable</th>
<th align="left">b_intercept</th>
<th align="left">track</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">2.00</td>
<td align="left">2.51</td>
<td align="left">2.98</td>
<td align="left">track:intervention</td>
<td align="left">2.78</td>
<td align="left">IT_intervention</td>
</tr>
<tr class="even">
<td align="left">2.85</td>
<td align="left">3.26</td>
<td align="left">3.71</td>
<td align="left">track:intervention</td>
<td align="left">2.78</td>
<td align="left">BA_intervention</td>
</tr>
<tr class="odd">
<td align="left">2.00</td>
<td align="left">2.51</td>
<td align="left">3.00</td>
<td align="left">track:intervention</td>
<td align="left">2.78</td>
<td align="left">HRC_intervention</td>
</tr>
<tr class="even">
<td align="left">2.22</td>
<td align="left">2.61</td>
<td align="left">3.00</td>
<td align="left">track:intervention</td>
<td align="left">2.78</td>
<td align="left">Nur_intervention</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">padaysLastweek_trackintervention_diamonds_control <span class="op">%&gt;%</span><span class="st"> </span>papaja<span class="op">::</span><span class="kw">apa_table</span>()</code></pre></div>
<caption>
(#tab:padaysLastweek-tables)
</caption>
<caption>
**
</caption>
<table>
<thead>
<tr class="header">
<th align="left">padaysLastweek_trackintervention_CIL</th>
<th align="left">padaysLastweek_trackintervention_estimates</th>
<th align="left">padaysLastweek_trackintervention_CIH</th>
<th align="left">Variable</th>
<th align="left">b_intercept</th>
<th align="left">track</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">1.82</td>
<td align="left">2.31</td>
<td align="left">2.76</td>
<td align="left">track:intervention</td>
<td align="left">2.78</td>
<td align="left">IT_control</td>
</tr>
<tr class="even">
<td align="left">2.93</td>
<td align="left">3.34</td>
<td align="left">3.80</td>
<td align="left">track:intervention</td>
<td align="left">2.78</td>
<td align="left">BA_control</td>
</tr>
<tr class="odd">
<td align="left">2.25</td>
<td align="left">2.68</td>
<td align="left">3.12</td>
<td align="left">track:intervention</td>
<td align="left">2.78</td>
<td align="left">HRC_control</td>
</tr>
<tr class="even">
<td align="left">2.49</td>
<td align="left">2.91</td>
<td align="left">3.35</td>
<td align="left">track:intervention</td>
<td align="left">2.78</td>
<td align="left">Nur_control</td>
</tr>
</tbody>
</table>
<div id="density-plot-by-intervention-and-gender" class="section level3">
<h3>Density plot by intervention and gender</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># Create data frame</span>
densplot &lt;-<span class="st"> </span>d
<span class="kw">levels</span>(densplot<span class="op">$</span>intervention) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Control&quot;</span>, <span class="st">&quot;Intervention&quot;</span>)
<span class="kw">levels</span>(densplot<span class="op">$</span>girl) &lt;-<span class="st"> </span><span class="kw">recode</span>(densplot<span class="op">$</span>girl, <span class="st">&quot;boy&quot;</span> =<span class="st"> &quot;Boys&quot;</span>, <span class="st">&quot;girl&quot;</span> =<span class="st"> &quot;Girls&quot;</span>)

<span class="co"># This gives side-by-side plots. There&#39;s a third plot below the two, which is fake to include x-axis text.</span>
<span class="kw">layout</span>(<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">3</span>), <span class="dt">nrow =</span> <span class="dv">2</span>, <span class="dt">ncol =</span> <span class="dv">2</span>, <span class="dt">byrow =</span> <span class="ot">TRUE</span>),
       <span class="dt">widths =</span> <span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>),<span class="dt">heights =</span> <span class="kw">c</span>(<span class="fl">0.45</span>,<span class="fl">0.05</span>))

<span class="co"># Minimise whitespace; see https://stackoverflow.com/questions/15848942/how-to-reduce-space-gap-between-multiple-graphs-in-r</span>
<span class="kw">par</span>(<span class="dt">mai =</span> <span class="kw">c</span>(<span class="fl">0.3</span>, <span class="fl">0.3</span>, <span class="fl">0.1</span>, <span class="fl">0.0</span>)) 

## Girls vs. boys
<span class="co"># Choose only the variables needed and drop NA</span>
dens &lt;-<span class="st"> </span>densplot <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(padaysLastweek_T1, girl) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="kw">complete.cases</span>(.))

<span class="co"># Set random number generator for reproducibility of bootstrap test of equal densities</span>
<span class="kw">set.seed</span>(<span class="dv">10</span>)

<span class="co"># Make plot</span>
sm.padaysLastweek_T1_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">sm.density.compare2</span>(<span class="kw">as.numeric</span>(dens<span class="op">$</span>padaysLastweek_T1), 
                                               <span class="kw">as.factor</span>(dens<span class="op">$</span>girl), 
                                               <span class="dt">model =</span> <span class="st">&quot;equal&quot;</span>,
                                               <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>,
                                               <span class="dt">col =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end  =</span>  <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">1</span>)], 
                                               <span class="dt">lty =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>), <span class="dt">yaxt =</span> <span class="st">&quot;n&quot;</span>,
                                               <span class="dt">bandcol =</span> <span class="st">&#39;LightGray&#39;</span>, 
                                               <span class="dt">lwd =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>),
                                               <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">7</span>))
## 
## Test of equal densities:  p-value =  0
<span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="kw">levels</span>(dens<span class="op">$</span>girl), <span class="dt">col =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>)], <span class="dt">lty =</span> <span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">1</span>), <span class="dt">lwd =</span> (<span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>)))
<span class="kw">mtext</span>(<span class="dt">side =</span> <span class="dv">2</span>, <span class="st">&quot;Density&quot;</span>, <span class="dt">line =</span> <span class="fl">0.5</span>)

## Intervention vs. control
<span class="co"># Choose only the variables needed and drop NA</span>
dens &lt;-<span class="st"> </span>densplot <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(padaysLastweek_T1, intervention) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="kw">complete.cases</span>(.))

<span class="co"># Set random number generator for reproducibility of bootstrap test of equal densities</span>
<span class="kw">set.seed</span>(<span class="dv">10</span>)
<span class="co"># Make plot</span>
sm.padaysLastweek_T1_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">sm.density.compare2</span>(<span class="kw">as.numeric</span>(dens<span class="op">$</span>padaysLastweek_T1), 
                                               <span class="kw">as.factor</span>(dens<span class="op">$</span>intervention), 
                                               <span class="dt">model =</span> <span class="st">&quot;equal&quot;</span>, 
                                               <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>,
                                               <span class="dt">col =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">4</span>)], 
                                               <span class="dt">lty =</span> <span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">1</span>), <span class="dt">yaxt =</span> <span class="st">&quot;n&quot;</span>,
                                               <span class="dt">bandcol =</span> <span class="st">&#39;LightGray&#39;</span>, 
                                               <span class="dt">lwd =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>),
                                               <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">7</span>))
## 
## Test of equal densities:  p-value =  0.09
<span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="kw">levels</span>(dens<span class="op">$</span>intervention), <span class="dt">col =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">4</span>)], <span class="dt">lty=</span><span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">1</span>), <span class="dt">lwd=</span>(<span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>)))

<span class="co"># Create x-axis label. See https://stackoverflow.com/questions/11198767/how-to-annotate-across-or-between-plots-in-multi-plot-panels-in-r</span>
<span class="kw">par</span>(<span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>)) 
<span class="kw">plot</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dt">type =</span> <span class="st">&quot;n&quot;</span>, <span class="dt">frame.plot =</span> <span class="ot">FALSE</span>,<span class="dt">axes =</span> <span class="ot">FALSE</span>) <span class="co"># Fake plot</span>
<span class="kw">text</span>(<span class="dt">x =</span> <span class="fl">1.02</span>, <span class="dt">y =</span> <span class="fl">1.3</span>, <span class="dt">labels =</span> <span class="st">&quot;Self-reported number of MVPA days previous week&quot;</span>, <span class="dt">pos =</span> <span class="dv">1</span>)</code></pre></div>
<p><img src="baseline-supplement_files/figure-html/padaysLastweek-sm-1.png" width="672" /></p>
</div>
<div id="density-plot-by-track" class="section level3">
<h3>Density plot by track</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
plot1 &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(id,
                              <span class="dt">track =</span> track,
                              girl,
                              <span class="dt">PA =</span> padaysLastweek_T1)  <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(track), track <span class="op">!=</span><span class="st"> &quot;Other&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># Drop category &quot;Other&quot;</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">track =</span> <span class="kw">factor</span>(track, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;IT&quot;</span>, <span class="st">&quot;BA&quot;</span>, <span class="st">&quot;HRC&quot;</span>, <span class="st">&quot;Nur&quot;</span>)),
                <span class="dt">track =</span> <span class="kw">recode_factor</span>(track, <span class="st">&quot;IT&quot;</span> =<span class="st"> &quot;IT&quot;</span>, <span class="st">&quot;BA&quot;</span> =<span class="st"> &quot;BA&quot;</span>, 
                                      <span class="st">&quot;HRC&quot;</span> =<span class="st"> &quot;HRC&quot;</span>, <span class="st">&quot;Nur&quot;</span> =<span class="st"> &quot;Nur&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>ggplot2<span class="op">::</span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">y =</span> track)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">geom_density_ridges2</span>(<span class="kw">aes</span>(<span class="dt">x =</span> PA, <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>, 
                                    <span class="dt">fill =</span> <span class="kw">paste</span>(track, girl),
                                    <span class="dt">point_color =</span> girl,
                                    <span class="dt">point_fill =</span> girl,
                                    <span class="dt">point_shape =</span> girl),
                                  <span class="dt">scale =</span> .<span class="dv">6</span>, <span class="dt">alpha =</span> <span class="fl">0.6</span>, <span class="dt">size =</span> <span class="fl">0.25</span>,
                                  <span class="dt">position =</span> <span class="kw">position_raincloud</span>(<span class="dt">width =</span> <span class="fl">0.2</span>, <span class="dt">height =</span> <span class="fl">0.4</span>),
                                  <span class="co"># from = 0, to = 450,</span>
                                  <span class="dt">jittered_points =</span> <span class="ot">TRUE</span>,
                                  <span class="dt">point_size =</span> <span class="dv">1</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="ot">NULL</span>,
       <span class="dt">y =</span> <span class="ot">NULL</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_discrete</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.1</span>, <span class="dv">0</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_fill_cyclical</span>(
                                <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&#39;BA boy&#39;</span> =<span class="st"> &quot;Boy&quot;</span>, <span class="st">&#39;BA girl&#39;</span> =<span class="st"> &quot;Girl&quot;</span>),
                                <span class="dt">values =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>)],
                                <span class="dt">name =</span> <span class="st">&quot;&quot;</span>, 
                                <span class="dt">guide =</span> <span class="kw">guide_legend</span>(<span class="dt">override.aes =</span> <span class="kw">list</span>(<span class="dt">alpha =</span> <span class="dv">1</span>, 
                                                                         <span class="dt">point_shape =</span> <span class="kw">c</span>(<span class="dv">24</span>, <span class="dv">4</span>),
                                                                         <span class="dt">point_size =</span> <span class="dv">2</span>))) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_colour_cyclical</span>(<span class="dt">values =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">theme_ridges</span>(<span class="dt">grid =</span> <span class="ot">FALSE</span>) <span class="op">+</span>
<span class="st">  </span><span class="co"># ggplot2::scale_fill_manual(values = c(&quot;#A0FFA0&quot;, &quot;#A0A0FF&quot;)) +</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_discrete_manual</span>(<span class="dt">aesthetics =</span> <span class="st">&quot;point_color&quot;</span>, 
                                  <span class="dt">values =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">1</span>)],
                                  <span class="dt">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_discrete_manual</span>(<span class="dt">aesthetics =</span> <span class="st">&quot;point_fill&quot;</span>,
                                  <span class="dt">values =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">1</span>)],
                                  <span class="dt">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_discrete_manual</span>(<span class="dt">aesthetics =</span> <span class="st">&quot;point_shape&quot;</span>, 
                                  <span class="dt">values =</span> <span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">24</span>),
                                  <span class="dt">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>papaja<span class="op">::</span><span class="kw">theme_apa</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)

plot1 &lt;-<span class="st"> </span>plot1 <span class="op">+</span><span class="st"> </span>
<span class="st">  </span>userfriendlyscience<span class="op">::</span><span class="kw">diamondPlot</span>(padaysLastweek_trackgirl_diamonds_girl, 
                                   <span class="dt">returnLayerOnly =</span> <span class="ot">TRUE</span>, 
                                   <span class="dt">lineColor =</span> <span class="st">&quot;black&quot;</span>, 
                                   <span class="dt">color=</span>viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">3</span>],
                                   <span class="dt">alpha=</span>.<span class="dv">6</span>, 
                                   <span class="dt">fixedSize =</span> <span class="fl">0.1</span>, 
                                   <span class="dt">otherAxisCol =</span> (<span class="dv">1</span><span class="op">:</span><span class="dv">4</span> <span class="op">+</span><span class="st"> </span>.<span class="dv">15</span>)) <span class="op">+</span><span class="st"> </span><span class="co"># specify y-position; option to move the diamond </span>
<span class="st">  </span>userfriendlyscience<span class="op">::</span><span class="kw">diamondPlot</span>(padaysLastweek_trackgirl_diamonds_boy, 
                                   <span class="dt">returnLayerOnly =</span> <span class="ot">TRUE</span>, 
                                   <span class="dt">lineColor =</span> <span class="st">&quot;black&quot;</span>, 
                                   <span class="dt">linetype =</span> <span class="st">&quot;solid&quot;</span>, 
                                   <span class="dt">color=</span>viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">1</span>],
                                   <span class="dt">alpha=</span>.<span class="dv">6</span>, 
                                   <span class="dt">fixedSize =</span> <span class="fl">0.1</span>, 
                                   <span class="dt">otherAxisCol =</span> (<span class="dv">1</span><span class="op">:</span><span class="dv">4</span> <span class="op">+</span><span class="st"> </span>.<span class="dv">15</span>))

<span class="co"># Draw plot with intervention and control densities</span>

plot2 &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(id,
                              <span class="dt">track =</span> track,
                              intervention,
                              <span class="dt">PA =</span> padaysLastweek_T1)  <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(track), track <span class="op">!=</span><span class="st"> &quot;Other&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># Drop category &quot;Other&quot;</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">track =</span> <span class="kw">factor</span>(track, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;IT&quot;</span>, <span class="st">&quot;BA&quot;</span>, <span class="st">&quot;HRC&quot;</span>, <span class="st">&quot;Nur&quot;</span>)),
                <span class="dt">track =</span> <span class="kw">recode_factor</span>(track, <span class="st">&quot;IT&quot;</span> =<span class="st"> &quot;IT&quot;</span>, <span class="st">&quot;BA&quot;</span> =<span class="st"> &quot;BA&quot;</span>, 
                                      <span class="st">&quot;HRC&quot;</span> =<span class="st"> &quot;HRC&quot;</span>, <span class="st">&quot;Nur&quot;</span> =<span class="st"> &quot;Nur&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>ggplot2<span class="op">::</span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">y =</span> track)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">geom_density_ridges2</span>(<span class="kw">aes</span>(<span class="dt">x =</span> PA, <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>, 
                                    <span class="dt">fill =</span> <span class="kw">paste</span>(track, intervention),
                                    <span class="dt">point_color =</span> intervention,
                                    <span class="dt">point_fill =</span> intervention,
                                    <span class="dt">point_shape =</span> intervention),
                                  <span class="dt">scale =</span> .<span class="dv">6</span>, <span class="dt">alpha =</span> <span class="fl">0.6</span>, <span class="dt">size =</span> <span class="fl">0.25</span>,
                                  <span class="dt">position =</span> <span class="kw">position_raincloud</span>(<span class="dt">width =</span> <span class="fl">0.2</span>, <span class="dt">height =</span> <span class="fl">0.4</span>),
                                  <span class="co"># from = 0, to = 450,</span>
                                  <span class="dt">jittered_points =</span> <span class="ot">TRUE</span>,
                                  <span class="dt">point_size =</span> <span class="dv">1</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="ot">NULL</span>,
       <span class="dt">y =</span> <span class="ot">NULL</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_discrete</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.1</span>, <span class="dv">0</span>), <span class="dt">labels =</span> <span class="ot">NULL</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_fill_cyclical</span>(
                                <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&#39;BA 0&#39;</span> =<span class="st"> &quot;Control&quot;</span>, <span class="st">&#39;BA 1&#39;</span> =<span class="st"> &quot;Intervention&quot;</span>),
                                <span class="dt">values =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">4</span>)],
                                <span class="dt">name =</span> <span class="st">&quot;&quot;</span>, 
                                <span class="dt">guide =</span> <span class="kw">guide_legend</span>(<span class="dt">override.aes =</span> <span class="kw">list</span>(<span class="dt">alpha =</span> <span class="dv">1</span>, 
                                                                         <span class="dt">point_shape =</span> <span class="kw">c</span>(<span class="dv">21</span>, <span class="dv">3</span>),
                                                                         <span class="dt">point_size =</span> <span class="dv">2</span>))) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_colour_cyclical</span>(<span class="dt">values =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">theme_ridges</span>(<span class="dt">grid =</span> <span class="ot">FALSE</span>) <span class="op">+</span>
<span class="st">  </span><span class="co"># ggplot2::scale_fill_manual(values = c(&quot;#A0FFA0&quot;, &quot;#A0A0FF&quot;)) +</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_discrete_manual</span>(<span class="dt">aesthetics =</span> <span class="st">&quot;point_color&quot;</span>, 
                                  <span class="dt">values =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">4</span>)],
                                  <span class="dt">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_discrete_manual</span>(<span class="dt">aesthetics =</span> <span class="st">&quot;point_fill&quot;</span>,
                                  <span class="dt">values =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">4</span>)],
                                  <span class="dt">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_discrete_manual</span>(<span class="dt">aesthetics =</span> <span class="st">&quot;point_shape&quot;</span>, 
                                  <span class="dt">values =</span> <span class="kw">c</span>(<span class="dv">21</span>, <span class="dv">3</span>),
                                  <span class="dt">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>papaja<span class="op">::</span><span class="kw">theme_apa</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)

plot2 &lt;-<span class="st"> </span>plot2 <span class="op">+</span><span class="st"> </span>
<span class="st">  </span>userfriendlyscience<span class="op">::</span><span class="kw">diamondPlot</span>(padaysLastweek_trackintervention_diamonds_intervention, 
                                   <span class="dt">returnLayerOnly =</span> <span class="ot">TRUE</span>, 
                                   <span class="dt">lineColor =</span> <span class="st">&quot;black&quot;</span>,  
                                   <span class="dt">color=</span>viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">4</span>],
                                   <span class="dt">alpha=</span>.<span class="dv">6</span>, 
                                   <span class="dt">fixedSize =</span> <span class="fl">0.1</span>, 
                                   <span class="dt">otherAxisCol =</span> (<span class="dv">1</span><span class="op">:</span><span class="dv">4</span> <span class="op">+</span><span class="st"> </span>.<span class="dv">15</span>)) <span class="op">+</span>
<span class="st">  </span>userfriendlyscience<span class="op">::</span><span class="kw">diamondPlot</span>(padaysLastweek_trackintervention_diamonds_control, 
                                   <span class="dt">returnLayerOnly =</span> <span class="ot">TRUE</span>, 
                                   <span class="dt">lineColor =</span> <span class="st">&quot;black&quot;</span>,  
                                   <span class="dt">color=</span>viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">2</span>],
                                   <span class="dt">alpha=</span>.<span class="dv">6</span>, 
                                   <span class="dt">fixedSize =</span> <span class="fl">0.1</span>, 
                                   <span class="dt">otherAxisCol =</span> (<span class="dv">1</span><span class="op">:</span><span class="dv">4</span> <span class="op">+</span><span class="st"> </span>.<span class="dv">15</span>))

plot1 <span class="op">+</span><span class="st"> </span>plot2
## Picking joint bandwidth of 0.604
## Warning: Removed 2 rows containing non-finite values (stat_density_ridges).
## Picking joint bandwidth of 0.614
## Warning: Removed 2 rows containing non-finite values (stat_density_ridges).</code></pre></div>
<p><img src="baseline-supplement_files/figure-html/padaysLastweek-densityplot-1.png" width="672" /></p>
</div>
<div id="histogram-1" class="section level3">
<h3>Histogram 1</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">plotboys &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(id,
                                 <span class="dt">track =</span> track,
                                 girl,
                                 padaysLastweek_T1)  <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(track), track <span class="op">!=</span><span class="st"> &quot;Other&quot;</span>, girl <span class="op">==</span><span class="st"> &quot;boy&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># Drop category &quot;Other&quot;</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">track =</span> <span class="kw">factor</span>(track, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;IT&quot;</span>, <span class="st">&quot;BA&quot;</span>, <span class="st">&quot;HRC&quot;</span>, <span class="st">&quot;Nur&quot;</span>)),
                <span class="dt">track =</span> <span class="kw">recode_factor</span>(track, <span class="st">&quot;IT&quot;</span> =<span class="st"> &quot;IT&quot;</span>, <span class="st">&quot;BA&quot;</span> =<span class="st"> &quot;BA&quot;</span>, 
                                      <span class="st">&quot;HRC&quot;</span> =<span class="st"> &quot;HRC&quot;</span>, <span class="st">&quot;Nur&quot;</span> =<span class="st"> &quot;Nur&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>ggplot2<span class="op">::</span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">y =</span> track)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">geom_density_ridges2</span>(<span class="kw">aes</span>(<span class="dt">x =</span> padaysLastweek_T1, <span class="dt">fill =</span> girl), <span class="dt">stat =</span> <span class="st">&quot;binline&quot;</span>, <span class="dt">binwidth =</span> <span class="dv">1</span>, <span class="dt">scale =</span> <span class="fl">0.95</span>, <span class="dt">alpha =</span> <span class="fl">0.6</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">7</span>), <span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="dt">name =</span> <span class="ot">NULL</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_discrete</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>), <span class="dt">name =</span> <span class="st">&quot;&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_fill_cyclical</span>(<span class="dt">values =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">1</span>]) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Boys&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">guides</span>(<span class="dt">y =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">theme_ridges</span>(<span class="dt">grid =</span> <span class="ot">FALSE</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>),
        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>),
        <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>, <span class="dt">size =</span> <span class="dv">10</span>),
        <span class="dt">axis.text=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">10</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">0.5</span>, <span class="fl">7.5</span>))

plotboys &lt;-<span class="st"> </span>plotboys <span class="op">+</span><span class="st"> </span>
<span class="st">  </span>userfriendlyscience<span class="op">::</span><span class="kw">diamondPlot</span>(padaysLastweek_trackgirl_diamonds_girl, 
                                   <span class="dt">returnLayerOnly =</span> <span class="ot">TRUE</span>, 
                                   <span class="dt">lineColor =</span> <span class="st">&quot;black&quot;</span>, 
                                   <span class="dt">color=</span>viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">3</span>],
                                   <span class="dt">alpha=</span>.<span class="dv">6</span>, 
                                   <span class="dt">fixedSize =</span> <span class="fl">0.1</span>, 
                                   <span class="dt">otherAxisCol =</span> (<span class="dv">1</span><span class="op">:</span><span class="dv">4</span> <span class="op">+</span><span class="st"> </span>.<span class="dv">15</span>)) <span class="op">+</span><span class="st"> </span><span class="co"># specify y-position; option to move the diamond </span>
<span class="st">  </span>userfriendlyscience<span class="op">::</span><span class="kw">diamondPlot</span>(padaysLastweek_trackgirl_diamonds_boy, 
                                   <span class="dt">returnLayerOnly =</span> <span class="ot">TRUE</span>, 
                                   <span class="dt">lineColor =</span> <span class="st">&quot;black&quot;</span>, 
                                   <span class="dt">linetype =</span> <span class="st">&quot;solid&quot;</span>, 
                                   <span class="dt">color=</span>viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">1</span>],
                                   <span class="dt">alpha=</span>.<span class="dv">6</span>, 
                                   <span class="dt">fixedSize =</span> <span class="fl">0.1</span>, 
                                   <span class="dt">otherAxisCol =</span> (<span class="dv">1</span><span class="op">:</span><span class="dv">4</span> <span class="op">+</span><span class="st"> </span>.<span class="dv">15</span>))

plotgirls &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(id,
                                 <span class="dt">track =</span> track,
                                 girl,
                                 padaysLastweek_T1)  <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(track), track <span class="op">!=</span><span class="st"> &quot;Other&quot;</span>, girl <span class="op">==</span><span class="st"> &quot;girl&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># Drop category &quot;Other&quot;</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">track =</span> <span class="kw">factor</span>(track, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;IT&quot;</span>, <span class="st">&quot;BA&quot;</span>, <span class="st">&quot;HRC&quot;</span>, <span class="st">&quot;Nur&quot;</span>)),
                <span class="dt">track =</span> <span class="kw">recode_factor</span>(track, <span class="st">&quot;IT&quot;</span> =<span class="st"> &quot;IT&quot;</span>, <span class="st">&quot;BA&quot;</span> =<span class="st"> &quot;BA&quot;</span>, 
                                      <span class="st">&quot;HRC&quot;</span> =<span class="st"> &quot;HRC&quot;</span>, <span class="st">&quot;Nur&quot;</span> =<span class="st"> &quot;Nur&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>ggplot2<span class="op">::</span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">y =</span> track)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">geom_density_ridges2</span>(<span class="kw">aes</span>(<span class="dt">x =</span> padaysLastweek_T1, <span class="dt">fill =</span> girl), <span class="dt">stat =</span> <span class="st">&quot;binline&quot;</span>, <span class="dt">binwidth =</span> <span class="dv">1</span>, <span class="dt">scale =</span> <span class="fl">0.95</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">7</span>), <span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="dt">name =</span> <span class="ot">NULL</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_discrete</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>), <span class="dt">name =</span> <span class="st">&quot;&quot;</span>, <span class="dt">labels =</span> <span class="ot">NULL</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_fill_cyclical</span>(<span class="dt">values =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">3</span>]) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Girls&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">guides</span>(<span class="dt">y =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">theme_ridges</span>(<span class="dt">grid =</span> <span class="ot">FALSE</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>),
        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>),
        <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>, <span class="dt">size =</span> <span class="dv">10</span>),
        <span class="dt">axis.text=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">10</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">0.5</span>, <span class="fl">7.5</span>))

plotgirls &lt;-<span class="st"> </span>plotgirls <span class="op">+</span><span class="st"> </span>
<span class="st">  </span>userfriendlyscience<span class="op">::</span><span class="kw">diamondPlot</span>(padaysLastweek_trackgirl_diamonds_girl, 
                                   <span class="dt">returnLayerOnly =</span> <span class="ot">TRUE</span>, 
                                   <span class="dt">lineColor =</span> <span class="st">&quot;black&quot;</span>, 
                                   <span class="dt">color=</span>viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">3</span>],
                                   <span class="dt">alpha=</span>.<span class="dv">6</span>, 
                                   <span class="dt">fixedSize =</span> <span class="fl">0.1</span>, 
                                   <span class="dt">otherAxisCol =</span> (<span class="dv">1</span><span class="op">:</span><span class="dv">4</span> <span class="op">+</span><span class="st"> </span>.<span class="dv">15</span>)) <span class="op">+</span><span class="st"> </span><span class="co"># specify y-position; option to move the diamond </span>
<span class="st">  </span>userfriendlyscience<span class="op">::</span><span class="kw">diamondPlot</span>(padaysLastweek_trackgirl_diamonds_boy, 
                                   <span class="dt">returnLayerOnly =</span> <span class="ot">TRUE</span>, 
                                   <span class="dt">lineColor =</span> <span class="st">&quot;black&quot;</span>, 
                                   <span class="dt">linetype =</span> <span class="st">&quot;solid&quot;</span>, 
                                   <span class="dt">color=</span>viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">1</span>],
                                   <span class="dt">alpha=</span>.<span class="dv">6</span>, 
                                   <span class="dt">fixedSize =</span> <span class="fl">0.1</span>, 
                                   <span class="dt">otherAxisCol =</span> (<span class="dv">1</span><span class="op">:</span><span class="dv">4</span> <span class="op">+</span><span class="st"> </span>.<span class="dv">15</span>))


plotcontrol &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(id,
                                 <span class="dt">track =</span> track,
                                 intervention,
                                 padaysLastweek_T1)  <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(track), track <span class="op">!=</span><span class="st"> &quot;Other&quot;</span>, intervention <span class="op">==</span><span class="st"> &quot;0&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># Drop category &quot;Other&quot;</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">track =</span> <span class="kw">factor</span>(track, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;IT&quot;</span>, <span class="st">&quot;BA&quot;</span>, <span class="st">&quot;HRC&quot;</span>, <span class="st">&quot;Nur&quot;</span>)),
                <span class="dt">track =</span> <span class="kw">recode_factor</span>(track, <span class="st">&quot;IT&quot;</span> =<span class="st"> &quot;IT&quot;</span>, <span class="st">&quot;BA&quot;</span> =<span class="st"> &quot;BA&quot;</span>, 
                                      <span class="st">&quot;HRC&quot;</span> =<span class="st"> &quot;HRC&quot;</span>, <span class="st">&quot;Nur&quot;</span> =<span class="st"> &quot;Nur&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>ggplot2<span class="op">::</span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">y =</span> track)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">geom_density_ridges2</span>(<span class="kw">aes</span>(<span class="dt">x =</span> padaysLastweek_T1, <span class="dt">fill =</span> intervention), <span class="dt">stat =</span> <span class="st">&quot;binline&quot;</span>, <span class="dt">binwidth =</span> <span class="dv">1</span>, <span class="dt">scale =</span> <span class="fl">0.95</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">7</span>), <span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="dt">name =</span> <span class="ot">NULL</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_discrete</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>), <span class="dt">name =</span> <span class="st">&quot;&quot;</span>, <span class="dt">labels =</span> <span class="ot">NULL</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_fill_cyclical</span>(<span class="dt">values =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">2</span>]) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Control&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">guides</span>(<span class="dt">y =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">theme_ridges</span>(<span class="dt">grid =</span> <span class="ot">FALSE</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>),
        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>),
        <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>, <span class="dt">size =</span> <span class="dv">10</span>),
        <span class="dt">axis.text=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">10</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">0.5</span>, <span class="fl">7.5</span>))

plotcontrol &lt;-<span class="st"> </span>plotcontrol <span class="op">+</span><span class="st"> </span>
<span class="st">  </span>userfriendlyscience<span class="op">::</span><span class="kw">diamondPlot</span>(padaysLastweek_trackintervention_diamonds_intervention, 
                                   <span class="dt">returnLayerOnly =</span> <span class="ot">TRUE</span>, 
                                   <span class="dt">lineColor =</span> <span class="st">&quot;black&quot;</span>,  
                                   <span class="dt">color=</span>viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">4</span>],
                                   <span class="dt">alpha=</span>.<span class="dv">6</span>, 
                                   <span class="dt">fixedSize =</span> <span class="fl">0.1</span>, 
                                   <span class="dt">otherAxisCol =</span> (<span class="dv">1</span><span class="op">:</span><span class="dv">4</span> <span class="op">+</span><span class="st"> </span>.<span class="dv">15</span>)) <span class="op">+</span>
<span class="st">  </span>userfriendlyscience<span class="op">::</span><span class="kw">diamondPlot</span>(padaysLastweek_trackintervention_diamonds_control, 
                                   <span class="dt">returnLayerOnly =</span> <span class="ot">TRUE</span>, 
                                   <span class="dt">lineColor =</span> <span class="st">&quot;black&quot;</span>,  
                                   <span class="dt">color=</span>viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">2</span>],
                                   <span class="dt">alpha=</span>.<span class="dv">6</span>, 
                                   <span class="dt">fixedSize =</span> <span class="fl">0.1</span>, 
                                   <span class="dt">otherAxisCol =</span> (<span class="dv">1</span><span class="op">:</span><span class="dv">4</span> <span class="op">+</span><span class="st"> </span>.<span class="dv">15</span>))

plotintervention &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(id,
                                 <span class="dt">track =</span> track,
                                 intervention,
                                 padaysLastweek_T1)  <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(track), track <span class="op">!=</span><span class="st"> &quot;Other&quot;</span>, intervention <span class="op">==</span><span class="st"> &quot;1&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># Drop category &quot;Other&quot;</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">track =</span> <span class="kw">factor</span>(track, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;IT&quot;</span>, <span class="st">&quot;BA&quot;</span>, <span class="st">&quot;HRC&quot;</span>, <span class="st">&quot;Nur&quot;</span>)),
                <span class="dt">track =</span> <span class="kw">recode_factor</span>(track, <span class="st">&quot;IT&quot;</span> =<span class="st"> &quot;IT&quot;</span>, <span class="st">&quot;BA&quot;</span> =<span class="st"> &quot;BA&quot;</span>, 
                                      <span class="st">&quot;HRC&quot;</span> =<span class="st"> &quot;HRC&quot;</span>, <span class="st">&quot;Nur&quot;</span> =<span class="st"> &quot;Nur&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>ggplot2<span class="op">::</span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">y =</span> track)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">geom_density_ridges2</span>(<span class="kw">aes</span>(<span class="dt">x =</span> padaysLastweek_T1, <span class="dt">fill =</span> intervention), <span class="dt">stat =</span> <span class="st">&quot;binline&quot;</span>, <span class="dt">binwidth =</span> <span class="dv">1</span>, <span class="dt">scale =</span> <span class="fl">0.95</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">7</span>), <span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="dt">name =</span> <span class="ot">NULL</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_discrete</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>), <span class="dt">name =</span> <span class="st">&quot;&quot;</span>, <span class="dt">labels =</span> <span class="ot">NULL</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_fill_cyclical</span>(<span class="dt">values =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">4</span>]) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Intervention&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">guides</span>(<span class="dt">y =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">theme_ridges</span>(<span class="dt">grid =</span> <span class="ot">FALSE</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>),
        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>),
        <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>, <span class="dt">size =</span> <span class="dv">10</span>),
        <span class="dt">axis.text=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">10</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">0.5</span>, <span class="fl">7.5</span>))

plotintervention &lt;-<span class="st"> </span>plotintervention <span class="op">+</span><span class="st"> </span>
<span class="st">  </span>userfriendlyscience<span class="op">::</span><span class="kw">diamondPlot</span>(padaysLastweek_trackintervention_diamonds_intervention, 
                                   <span class="dt">returnLayerOnly =</span> <span class="ot">TRUE</span>, 
                                   <span class="dt">lineColor =</span> <span class="st">&quot;black&quot;</span>,  
                                   <span class="dt">color=</span>viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">4</span>],
                                   <span class="dt">alpha=</span>.<span class="dv">6</span>, 
                                   <span class="dt">fixedSize =</span> <span class="fl">0.1</span>, 
                                   <span class="dt">otherAxisCol =</span> (<span class="dv">1</span><span class="op">:</span><span class="dv">4</span> <span class="op">+</span><span class="st"> </span>.<span class="dv">15</span>)) <span class="op">+</span>
<span class="st">  </span>userfriendlyscience<span class="op">::</span><span class="kw">diamondPlot</span>(padaysLastweek_trackintervention_diamonds_control, 
                                   <span class="dt">returnLayerOnly =</span> <span class="ot">TRUE</span>, 
                                   <span class="dt">lineColor =</span> <span class="st">&quot;black&quot;</span>,  
                                   <span class="dt">color=</span>viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">2</span>],
                                   <span class="dt">alpha=</span>.<span class="dv">6</span>, 
                                   <span class="dt">fixedSize =</span> <span class="fl">0.1</span>, 
                                   <span class="dt">otherAxisCol =</span> (<span class="dv">1</span><span class="op">:</span><span class="dv">4</span> <span class="op">+</span><span class="st"> </span>.<span class="dv">15</span>))

plotboys <span class="op">+</span><span class="st"> </span>plotgirls <span class="op">+</span><span class="st"> </span>plotcontrol <span class="op">+</span><span class="st"> </span>plotintervention <span class="op">+</span><span class="st"> </span><span class="kw">plot_layout</span>(<span class="dt">ncol =</span> <span class="dv">4</span>)
## Warning: Removed 1 rows containing non-finite values (stat_binline).

## Warning: Removed 1 rows containing non-finite values (stat_binline).

## Warning: Removed 1 rows containing non-finite values (stat_binline).

## Warning: Removed 1 rows containing non-finite values (stat_binline).</code></pre></div>
<p><img src="baseline-supplement_files/figure-html/padaysLastweek-histogram1-1.png" width="672" /></p>
</div>
<div id="histogram-2" class="section level3">
<h3>Histogram 2</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">hist_padaysLastweek_girl_count &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(id,
                                 <span class="dt">track =</span> track,
                                 girl,
                                 padaysLastweek_T1)  <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(track), track <span class="op">!=</span><span class="st"> &quot;Other&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># Drop category &quot;Other&quot;</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">track =</span> <span class="kw">factor</span>(track, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;IT&quot;</span>, <span class="st">&quot;BA&quot;</span>, <span class="st">&quot;HRC&quot;</span>, <span class="st">&quot;Nur&quot;</span>)),
                <span class="dt">track =</span> <span class="kw">recode_factor</span>(track, <span class="st">&quot;IT&quot;</span> =<span class="st"> &quot;IT&quot;</span>, <span class="st">&quot;BA&quot;</span> =<span class="st"> &quot;BA&quot;</span>, 
                                      <span class="st">&quot;HRC&quot;</span> =<span class="st"> &quot;HRC&quot;</span>, <span class="st">&quot;Nur&quot;</span> =<span class="st"> &quot;Nur&quot;</span>),
                <span class="dt">padaysLastweek_T1 =</span> <span class="kw">as.integer</span>(padaysLastweek_T1)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>padaysLastweek_T1, <span class="dt">fill=</span>girl)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth=</span><span class="dv">1</span>, <span class="dt">position=</span><span class="st">&quot;dodge&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">7</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="ot">NULL</span>) <span class="op">+</span><span class="st">   </span>
<span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">1</span>)], 
                    <span class="dt">name =</span> <span class="ot">NULL</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">facet_wrap</span>(<span class="st">&quot;track&quot;</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)

hist_padaysLastweek_girl_density &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(id,
                                 <span class="dt">track =</span> track,
                                 girl,
                                 padaysLastweek_T1)  <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(track), track <span class="op">!=</span><span class="st"> &quot;Other&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># Drop category &quot;Other&quot;</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">track =</span> <span class="kw">factor</span>(track, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;IT&quot;</span>, <span class="st">&quot;BA&quot;</span>, <span class="st">&quot;HRC&quot;</span>, <span class="st">&quot;Nur&quot;</span>)),
                <span class="dt">track =</span> <span class="kw">recode_factor</span>(track, <span class="st">&quot;IT&quot;</span> =<span class="st"> &quot;IT&quot;</span>, <span class="st">&quot;BA&quot;</span> =<span class="st"> &quot;BA&quot;</span>, 
                                      <span class="st">&quot;HRC&quot;</span> =<span class="st"> &quot;HRC&quot;</span>, <span class="st">&quot;Nur&quot;</span> =<span class="st"> &quot;Nur&quot;</span>),
                <span class="dt">padaysLastweek_T1 =</span> <span class="kw">as.integer</span>(padaysLastweek_T1)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>padaysLastweek_T1, <span class="dt">y =</span> ..density.., <span class="dt">fill=</span>girl)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth=</span><span class="dv">1</span>, <span class="dt">position=</span><span class="st">&quot;dodge&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">7</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="ot">NULL</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">1</span>)], <span class="dt">name =</span> <span class="ot">NULL</span>,
                    <span class="dt">guide =</span> <span class="ot">FALSE</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">facet_wrap</span>(<span class="st">&quot;track&quot;</span>)

hist_padaysLastweek_girl_count <span class="op">+</span><span class="st"> </span>hist_padaysLastweek_girl_density
## Warning: Removed 2 rows containing non-finite values (stat_bin).

## Warning: Removed 2 rows containing non-finite values (stat_bin).</code></pre></div>
<p><img src="baseline-supplement_files/figure-html/padaysLastweek-histogram2-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
hist_padaysLastweek_intervention_count &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(id,
                                 <span class="dt">track =</span> track,
                                 intervention,
                                 padaysLastweek_T1)  <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(track), track <span class="op">!=</span><span class="st"> &quot;Other&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># Drop category &quot;Other&quot;</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">track =</span> <span class="kw">factor</span>(track, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;IT&quot;</span>, <span class="st">&quot;BA&quot;</span>, <span class="st">&quot;HRC&quot;</span>, <span class="st">&quot;Nur&quot;</span>)),
                <span class="dt">track =</span> <span class="kw">recode_factor</span>(track, <span class="st">&quot;IT&quot;</span> =<span class="st"> &quot;IT&quot;</span>, <span class="st">&quot;BA&quot;</span> =<span class="st"> &quot;BA&quot;</span>, 
                                      <span class="st">&quot;HRC&quot;</span> =<span class="st"> &quot;HRC&quot;</span>, <span class="st">&quot;Nur&quot;</span> =<span class="st"> &quot;Nur&quot;</span>),
                <span class="dt">padaysLastweek_T1 =</span> <span class="kw">as.integer</span>(padaysLastweek_T1)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>padaysLastweek_T1, <span class="dt">fill=</span>intervention)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="dv">1</span>, <span class="dt">position =</span> <span class="st">&quot;dodge&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">7</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="ot">NULL</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">4</span>)], 
                    <span class="dt">name =</span> <span class="ot">NULL</span>, 
                    <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;0&quot;</span> =<span class="st"> &quot;control&quot;</span>, <span class="st">&quot;1&quot;</span> =<span class="st"> &quot;intervention&quot;</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">facet_wrap</span>(<span class="st">&quot;track&quot;</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)

hist_padaysLastweek_intervention_density &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(id,
                                 <span class="dt">track =</span> track,
                                 intervention,
                                 padaysLastweek_T1)  <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(track), track <span class="op">!=</span><span class="st"> &quot;Other&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># Drop category &quot;Other&quot;</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">track =</span> <span class="kw">factor</span>(track, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;IT&quot;</span>, <span class="st">&quot;BA&quot;</span>, <span class="st">&quot;HRC&quot;</span>, <span class="st">&quot;Nur&quot;</span>)),
                <span class="dt">track =</span> <span class="kw">recode_factor</span>(track, <span class="st">&quot;IT&quot;</span> =<span class="st"> &quot;IT&quot;</span>, <span class="st">&quot;BA&quot;</span> =<span class="st"> &quot;BA&quot;</span>, 
                                      <span class="st">&quot;HRC&quot;</span> =<span class="st"> &quot;HRC&quot;</span>, <span class="st">&quot;Nur&quot;</span> =<span class="st"> &quot;Nur&quot;</span>),
                <span class="dt">padaysLastweek_T1 =</span> <span class="kw">as.integer</span>(padaysLastweek_T1)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>padaysLastweek_T1, <span class="dt">y =</span> ..density.., <span class="dt">fill=</span>intervention)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="dv">1</span>, <span class="dt">position =</span> <span class="st">&quot;dodge&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">7</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="ot">NULL</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">4</span>)], 
                    <span class="dt">guide =</span> <span class="ot">FALSE</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">facet_wrap</span>(<span class="st">&quot;track&quot;</span>)

hist_padaysLastweek_intervention_count <span class="op">+</span><span class="st"> </span>hist_padaysLastweek_intervention_density
## Warning: Removed 2 rows containing non-finite values (stat_bin).

## Warning: Removed 2 rows containing non-finite values (stat_bin).</code></pre></div>
<p><img src="baseline-supplement_files/figure-html/padaysLastweek-histogram2-2.png" width="672" /></p>
</div>
</div>
<div id="number-of-average-interruptions-to-sitting" class="section level2">
<h2>Number of average interruptions to sitting</h2>
<p>This section reports the accelerometer-measured number of breaks to sitting time.</p>
<p>Code chunk below prepares data.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m_sitBreaks_trackgirl &lt;-<span class="st"> </span>brms<span class="op">::</span><span class="kw">bf</span>(sitBreaks_T1 <span class="op">~</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>track<span class="op">:</span>girl)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>brms<span class="op">::</span><span class="kw">brm</span>(., <span class="dt">data =</span> df, <span class="dt">chains =</span> <span class="dv">4</span>, <span class="dt">iter =</span> <span class="dv">4000</span>, <span class="dt">control =</span> <span class="kw">list</span>(<span class="dt">adapt_delta =</span> <span class="fl">0.95</span>))
## Found more than one class &quot;family&quot; in cache; using the first, from namespace &#39;lme4&#39;
## Also defined by &#39;MatrixModels&#39;
## Warning: Rows containing NAs were excluded from the model
## Compiling the C++ model
## Start sampling
## 
## SAMPLING FOR MODEL &#39;gaussian brms-model&#39; NOW (CHAIN 1).
## 
## Gradient evaluation took 0 seconds
## 1000 transitions using 10 leapfrog steps per transition would take 0 seconds.
## Adjust your expectations accordingly!
## 
## 
## Iteration:    1 / 4000 [  0%]  (Warmup)
## Iteration:  400 / 4000 [ 10%]  (Warmup)
## Iteration:  800 / 4000 [ 20%]  (Warmup)
## Iteration: 1200 / 4000 [ 30%]  (Warmup)
## Iteration: 1600 / 4000 [ 40%]  (Warmup)
## Iteration: 2000 / 4000 [ 50%]  (Warmup)
## Iteration: 2001 / 4000 [ 50%]  (Sampling)
## Iteration: 2400 / 4000 [ 60%]  (Sampling)
## Iteration: 2800 / 4000 [ 70%]  (Sampling)
## Iteration: 3200 / 4000 [ 80%]  (Sampling)
## Iteration: 3600 / 4000 [ 90%]  (Sampling)
## Iteration: 4000 / 4000 [100%]  (Sampling)
## 
##  Elapsed Time: 1.884 seconds (Warm-up)
##                1.861 seconds (Sampling)
##                3.745 seconds (Total)
## 
## 
## SAMPLING FOR MODEL &#39;gaussian brms-model&#39; NOW (CHAIN 2).
## 
## Gradient evaluation took 0 seconds
## 1000 transitions using 10 leapfrog steps per transition would take 0 seconds.
## Adjust your expectations accordingly!
## 
## 
## Iteration:    1 / 4000 [  0%]  (Warmup)
## Iteration:  400 / 4000 [ 10%]  (Warmup)
## Iteration:  800 / 4000 [ 20%]  (Warmup)
## Iteration: 1200 / 4000 [ 30%]  (Warmup)
## Iteration: 1600 / 4000 [ 40%]  (Warmup)
## Iteration: 2000 / 4000 [ 50%]  (Warmup)
## Iteration: 2001 / 4000 [ 50%]  (Sampling)
## Iteration: 2400 / 4000 [ 60%]  (Sampling)
## Iteration: 2800 / 4000 [ 70%]  (Sampling)
## Iteration: 3200 / 4000 [ 80%]  (Sampling)
## Iteration: 3600 / 4000 [ 90%]  (Sampling)
## Iteration: 4000 / 4000 [100%]  (Sampling)
## 
##  Elapsed Time: 1.994 seconds (Warm-up)
##                1.496 seconds (Sampling)
##                3.49 seconds (Total)
## 
## 
## SAMPLING FOR MODEL &#39;gaussian brms-model&#39; NOW (CHAIN 3).
## 
## Gradient evaluation took 0 seconds
## 1000 transitions using 10 leapfrog steps per transition would take 0 seconds.
## Adjust your expectations accordingly!
## 
## 
## Iteration:    1 / 4000 [  0%]  (Warmup)
## Iteration:  400 / 4000 [ 10%]  (Warmup)
## Iteration:  800 / 4000 [ 20%]  (Warmup)
## Iteration: 1200 / 4000 [ 30%]  (Warmup)
## Iteration: 1600 / 4000 [ 40%]  (Warmup)
## Iteration: 2000 / 4000 [ 50%]  (Warmup)
## Iteration: 2001 / 4000 [ 50%]  (Sampling)
## Iteration: 2400 / 4000 [ 60%]  (Sampling)
## Iteration: 2800 / 4000 [ 70%]  (Sampling)
## Iteration: 3200 / 4000 [ 80%]  (Sampling)
## Iteration: 3600 / 4000 [ 90%]  (Sampling)
## Iteration: 4000 / 4000 [100%]  (Sampling)
## 
##  Elapsed Time: 2.031 seconds (Warm-up)
##                2.519 seconds (Sampling)
##                4.55 seconds (Total)
## 
## 
## SAMPLING FOR MODEL &#39;gaussian brms-model&#39; NOW (CHAIN 4).
## 
## Gradient evaluation took 0 seconds
## 1000 transitions using 10 leapfrog steps per transition would take 0 seconds.
## Adjust your expectations accordingly!
## 
## 
## Iteration:    1 / 4000 [  0%]  (Warmup)
## Iteration:  400 / 4000 [ 10%]  (Warmup)
## Iteration:  800 / 4000 [ 20%]  (Warmup)
## Iteration: 1200 / 4000 [ 30%]  (Warmup)
## Iteration: 1600 / 4000 [ 40%]  (Warmup)
## Iteration: 2000 / 4000 [ 50%]  (Warmup)
## Iteration: 2001 / 4000 [ 50%]  (Sampling)
## Iteration: 2400 / 4000 [ 60%]  (Sampling)
## Iteration: 2800 / 4000 [ 70%]  (Sampling)
## Iteration: 3200 / 4000 [ 80%]  (Sampling)
## Iteration: 3600 / 4000 [ 90%]  (Sampling)
## Iteration: 4000 / 4000 [100%]  (Sampling)
## 
##  Elapsed Time: 2.608 seconds (Warm-up)
##                1.823 seconds (Sampling)
##                4.431 seconds (Total)

brms<span class="op">::</span><span class="kw">prior_summary</span>(m_sitBreaks_trackgirl, <span class="dt">data =</span> df)</code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["bound"],"name":[8],"type":["chr"],"align":["left"]}],"data":[{"1":"student_t(3, 27, 11)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":""},{"1":"student_t(3, 0, 11)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":""},{"1":"","2":"sd","3":"","4":"track:girl","5":"","6":"","7":"","8":""},{"1":"","2":"sd","3":"Intercept","4":"track:girl","5":"","6":"","7":"","8":""},{"1":"student_t(3, 0, 11)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":""}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
m_sitBreaks_trackgirl
##  Family: gaussian 
##   Links: mu = identity; sigma = identity 
## Formula: sitBreaks_T1 ~ (1 | track:girl) 
##    Data: df (Number of observations: 706) 
## Samples: 4 chains, each with iter = 4000; warmup = 2000; thin = 1; 
##          total post-warmup samples = 8000
##     ICs: LOO = NA; WAIC = NA; R2 = NA
##  
## Group-Level Effects: 
## ~track:girl (Number of levels: 10) 
##               Estimate Est.Error l-95% CI u-95% CI Eff.Sample Rhat
## sd(Intercept)     4.80      1.44     2.78     8.41       1885 1.00
## 
## Population-Level Effects: 
##           Estimate Est.Error l-95% CI u-95% CI Eff.Sample Rhat
## Intercept    26.58      1.73    23.07    29.90       1285 1.00
## 
## Family Specific Parameters: 
##       Estimate Est.Error l-95% CI u-95% CI Eff.Sample Rhat
## sigma    10.15      0.27     9.63    10.70       7163 1.00
## 
## Samples were drawn using sampling(NUTS). For each parameter, Eff.Sample 
## is a crude measure of effective sample size, and Rhat is the potential 
## scale reduction factor on split chains (at convergence, Rhat = 1).

b_intercept &lt;-<span class="st"> </span>brms<span class="op">::</span><span class="kw">fixef</span>(m_sitBreaks_trackgirl)[<span class="dv">1</span>]

<span class="co"># This gives estimates only:</span>
sitBreaks_trackgirl_estimates &lt;-<span class="st"> </span>brms<span class="op">::</span><span class="kw">ranef</span>(m_sitBreaks_trackgirl)[[<span class="dv">1</span>]][<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]

<span class="co"># The 2.5%ile:</span>
sitBreaks_trackgirl_CIL &lt;-<span class="st"> </span>brms<span class="op">::</span><span class="kw">ranef</span>(m_sitBreaks_trackgirl)[[<span class="dv">1</span>]][<span class="dv">21</span><span class="op">:</span><span class="dv">30</span>]

<span class="co"># The 97.5%ile:</span>
sitBreaks_trackgirl_CIH &lt;-<span class="st"> </span>brms<span class="op">::</span><span class="kw">ranef</span>(m_sitBreaks_trackgirl)[[<span class="dv">1</span>]][<span class="dv">31</span><span class="op">:</span><span class="dv">40</span>]

sitBreaks_trackgirl_ci &lt;-<span class="st"> </span><span class="kw">data.frame</span>(sitBreaks_trackgirl_CIL, sitBreaks_trackgirl_estimates, sitBreaks_trackgirl_CIH, <span class="dt">Variable =</span> <span class="kw">labels</span>(brms<span class="op">::</span><span class="kw">ranef</span>(m_sitBreaks_trackgirl))) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">b_intercept =</span> <span class="kw">rep</span>(b_intercept, <span class="dv">10</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">sitBreaks_trackgirl_CIL =</span> sitBreaks_trackgirl_CIL <span class="op">+</span><span class="st"> </span>b_intercept,
         <span class="dt">sitBreaks_trackgirl_estimates =</span> sitBreaks_trackgirl_estimates <span class="op">+</span><span class="st"> </span>b_intercept,
         <span class="dt">sitBreaks_trackgirl_CIH =</span> sitBreaks_trackgirl_CIH <span class="op">+</span><span class="st"> </span>b_intercept,
         <span class="dt">track =</span> <span class="kw">c</span>(<span class="st">&#39;BA_boy&#39;</span>,
                   <span class="st">&#39;BA_girl&#39;</span>,
                   <span class="st">&#39;HRC_boy&#39;</span>,
                   <span class="st">&#39;HRC_girl&#39;</span>,
                   <span class="st">&#39;IT_boy&#39;</span>,
                   <span class="st">&#39;IT_girl&#39;</span>,
                   <span class="st">&#39;Nur_boy&#39;</span>,
                   <span class="st">&#39;Nur_girl&#39;</span>,
                   <span class="st">&#39;Other_boy&#39;</span>,
                   <span class="st">&#39;Other_girl&#39;</span>
))

sitBreaks_trackgirl_diamonds_girl &lt;-<span class="st"> </span><span class="kw">rbind</span>(
sitBreaks_trackgirl_ci <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;Nur_girl&quot;</span>),
sitBreaks_trackgirl_ci <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;HRC_girl&quot;</span>),
sitBreaks_trackgirl_ci <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;BA_girl&quot;</span>),
sitBreaks_trackgirl_ci <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;IT_girl&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">arrange</span>(<span class="op">-</span><span class="kw">row_number</span>()) <span class="co"># reverse order of rows to make them right for the plot to come</span>

sitBreaks_trackgirl_diamonds_boy &lt;-<span class="st"> </span><span class="kw">rbind</span>(
sitBreaks_trackgirl_ci <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;Nur_boy&quot;</span>),
sitBreaks_trackgirl_ci <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;HRC_boy&quot;</span>),
sitBreaks_trackgirl_ci <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;BA_boy&quot;</span>),
sitBreaks_trackgirl_ci <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;IT_boy&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">arrange</span>(<span class="op">-</span><span class="kw">row_number</span>()) <span class="co"># reverse order of rows to make them right for the plot to come</span>


m_sitBreaks_trackintervention &lt;-<span class="st"> </span>brms<span class="op">::</span><span class="kw">bf</span>(sitBreaks_T1 <span class="op">~</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>track<span class="op">:</span>intervention)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>brms<span class="op">::</span><span class="kw">brm</span>(., <span class="dt">data =</span> df, <span class="dt">chains =</span> <span class="dv">4</span>, <span class="dt">iter =</span> <span class="dv">4000</span>, <span class="dt">control =</span> <span class="kw">list</span>(<span class="dt">adapt_delta =</span> <span class="fl">0.95</span>))
## Found more than one class &quot;family&quot; in cache; using the first, from namespace &#39;lme4&#39;
## Also defined by &#39;MatrixModels&#39;
## Warning: Rows containing NAs were excluded from the model
## Compiling the C++ model
## Start sampling
## 
## SAMPLING FOR MODEL &#39;gaussian brms-model&#39; NOW (CHAIN 1).
## 
## Gradient evaluation took 0 seconds
## 1000 transitions using 10 leapfrog steps per transition would take 0 seconds.
## Adjust your expectations accordingly!
## 
## 
## Iteration:    1 / 4000 [  0%]  (Warmup)
## Iteration:  400 / 4000 [ 10%]  (Warmup)
## Iteration:  800 / 4000 [ 20%]  (Warmup)
## Iteration: 1200 / 4000 [ 30%]  (Warmup)
## Iteration: 1600 / 4000 [ 40%]  (Warmup)
## Iteration: 2000 / 4000 [ 50%]  (Warmup)
## Iteration: 2001 / 4000 [ 50%]  (Sampling)
## Iteration: 2400 / 4000 [ 60%]  (Sampling)
## Iteration: 2800 / 4000 [ 70%]  (Sampling)
## Iteration: 3200 / 4000 [ 80%]  (Sampling)
## Iteration: 3600 / 4000 [ 90%]  (Sampling)
## Iteration: 4000 / 4000 [100%]  (Sampling)
## 
##  Elapsed Time: 1.789 seconds (Warm-up)
##                1.541 seconds (Sampling)
##                3.33 seconds (Total)
## 
## 
## SAMPLING FOR MODEL &#39;gaussian brms-model&#39; NOW (CHAIN 2).
## 
## Gradient evaluation took 0.001 seconds
## 1000 transitions using 10 leapfrog steps per transition would take 10 seconds.
## Adjust your expectations accordingly!
## 
## 
## Iteration:    1 / 4000 [  0%]  (Warmup)
## Iteration:  400 / 4000 [ 10%]  (Warmup)
## Iteration:  800 / 4000 [ 20%]  (Warmup)
## Iteration: 1200 / 4000 [ 30%]  (Warmup)
## Iteration: 1600 / 4000 [ 40%]  (Warmup)
## Iteration: 2000 / 4000 [ 50%]  (Warmup)
## Iteration: 2001 / 4000 [ 50%]  (Sampling)
## Iteration: 2400 / 4000 [ 60%]  (Sampling)
## Iteration: 2800 / 4000 [ 70%]  (Sampling)
## Iteration: 3200 / 4000 [ 80%]  (Sampling)
## Iteration: 3600 / 4000 [ 90%]  (Sampling)
## Iteration: 4000 / 4000 [100%]  (Sampling)
## 
##  Elapsed Time: 1.883 seconds (Warm-up)
##                1.405 seconds (Sampling)
##                3.288 seconds (Total)
## 
## 
## SAMPLING FOR MODEL &#39;gaussian brms-model&#39; NOW (CHAIN 3).
## 
## Gradient evaluation took 0 seconds
## 1000 transitions using 10 leapfrog steps per transition would take 0 seconds.
## Adjust your expectations accordingly!
## 
## 
## Iteration:    1 / 4000 [  0%]  (Warmup)
## Iteration:  400 / 4000 [ 10%]  (Warmup)
## Iteration:  800 / 4000 [ 20%]  (Warmup)
## Iteration: 1200 / 4000 [ 30%]  (Warmup)
## Iteration: 1600 / 4000 [ 40%]  (Warmup)
## Iteration: 2000 / 4000 [ 50%]  (Warmup)
## Iteration: 2001 / 4000 [ 50%]  (Sampling)
## Iteration: 2400 / 4000 [ 60%]  (Sampling)
## Iteration: 2800 / 4000 [ 70%]  (Sampling)
## Iteration: 3200 / 4000 [ 80%]  (Sampling)
## Iteration: 3600 / 4000 [ 90%]  (Sampling)
## Iteration: 4000 / 4000 [100%]  (Sampling)
## 
##  Elapsed Time: 1.718 seconds (Warm-up)
##                1.348 seconds (Sampling)
##                3.066 seconds (Total)
## 
## 
## SAMPLING FOR MODEL &#39;gaussian brms-model&#39; NOW (CHAIN 4).
## 
## Gradient evaluation took 0 seconds
## 1000 transitions using 10 leapfrog steps per transition would take 0 seconds.
## Adjust your expectations accordingly!
## 
## 
## Iteration:    1 / 4000 [  0%]  (Warmup)
## Iteration:  400 / 4000 [ 10%]  (Warmup)
## Iteration:  800 / 4000 [ 20%]  (Warmup)
## Iteration: 1200 / 4000 [ 30%]  (Warmup)
## Iteration: 1600 / 4000 [ 40%]  (Warmup)
## Iteration: 2000 / 4000 [ 50%]  (Warmup)
## Iteration: 2001 / 4000 [ 50%]  (Sampling)
## Iteration: 2400 / 4000 [ 60%]  (Sampling)
## Iteration: 2800 / 4000 [ 70%]  (Sampling)
## Iteration: 3200 / 4000 [ 80%]  (Sampling)
## Iteration: 3600 / 4000 [ 90%]  (Sampling)
## Iteration: 4000 / 4000 [100%]  (Sampling)
## 
##  Elapsed Time: 1.662 seconds (Warm-up)
##                1.414 seconds (Sampling)
##                3.076 seconds (Total)

brms<span class="op">::</span><span class="kw">prior_summary</span>(m_sitBreaks_trackintervention, <span class="dt">data =</span> df)</code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["bound"],"name":[8],"type":["chr"],"align":["left"]}],"data":[{"1":"student_t(3, 27, 11)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":""},{"1":"student_t(3, 0, 11)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":""},{"1":"","2":"sd","3":"","4":"track:intervention","5":"","6":"","7":"","8":""},{"1":"","2":"sd","3":"Intercept","4":"track:intervention","5":"","6":"","7":"","8":""},{"1":"student_t(3, 0, 11)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":""}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
m_sitBreaks_trackintervention
##  Family: gaussian 
##   Links: mu = identity; sigma = identity 
## Formula: sitBreaks_T1 ~ (1 | track:intervention) 
##    Data: df (Number of observations: 706) 
## Samples: 4 chains, each with iter = 4000; warmup = 2000; thin = 1; 
##          total post-warmup samples = 8000
##     ICs: LOO = NA; WAIC = NA; R2 = NA
##  
## Group-Level Effects: 
## ~track:intervention (Number of levels: 10) 
##               Estimate Est.Error l-95% CI u-95% CI Eff.Sample Rhat
## sd(Intercept)     4.57      1.39     2.62     7.97       2112 1.00
## 
## Population-Level Effects: 
##           Estimate Est.Error l-95% CI u-95% CI Eff.Sample Rhat
## Intercept    26.95      1.53    23.86    29.93       1766 1.00
## 
## Family Specific Parameters: 
##       Estimate Est.Error l-95% CI u-95% CI Eff.Sample Rhat
## sigma    10.46      0.28     9.92    11.03       5522 1.00
## 
## Samples were drawn using sampling(NUTS). For each parameter, Eff.Sample 
## is a crude measure of effective sample size, and Rhat is the potential 
## scale reduction factor on split chains (at convergence, Rhat = 1).

b_intercept &lt;-<span class="st"> </span>brms<span class="op">::</span><span class="kw">fixef</span>(m_sitBreaks_trackintervention)[<span class="dv">1</span>]

<span class="co"># This gives estimates only:</span>
sitBreaks_trackintervention_estimates &lt;-<span class="st"> </span>brms<span class="op">::</span><span class="kw">ranef</span>(m_sitBreaks_trackintervention)[[<span class="dv">1</span>]][<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]

<span class="co"># The 2.5%ile:</span>
sitBreaks_trackintervention_CIL &lt;-<span class="st"> </span>brms<span class="op">::</span><span class="kw">ranef</span>(m_sitBreaks_trackintervention)[[<span class="dv">1</span>]][<span class="dv">21</span><span class="op">:</span><span class="dv">30</span>]

<span class="co"># The 97.5%ile:</span>
sitBreaks_trackintervention_CIH &lt;-<span class="st"> </span>brms<span class="op">::</span><span class="kw">ranef</span>(m_sitBreaks_trackintervention)[[<span class="dv">1</span>]][<span class="dv">31</span><span class="op">:</span><span class="dv">40</span>]

sitBreaks_trackintervention_ci &lt;-<span class="st"> </span><span class="kw">data.frame</span>(sitBreaks_trackintervention_CIL, sitBreaks_trackintervention_estimates, sitBreaks_trackintervention_CIH, <span class="dt">Variable =</span> <span class="kw">labels</span>(brms<span class="op">::</span><span class="kw">ranef</span>(m_sitBreaks_trackintervention))) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">b_intercept =</span> <span class="kw">rep</span>(b_intercept, <span class="dv">10</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">sitBreaks_trackintervention_CIL =</span> sitBreaks_trackintervention_CIL <span class="op">+</span><span class="st"> </span>b_intercept,
         <span class="dt">sitBreaks_trackintervention_estimates =</span> sitBreaks_trackintervention_estimates <span class="op">+</span><span class="st"> </span>b_intercept,
         <span class="dt">sitBreaks_trackintervention_CIH =</span> sitBreaks_trackintervention_CIH <span class="op">+</span><span class="st"> </span>b_intercept,
         <span class="dt">track =</span> <span class="kw">c</span>(<span class="st">&#39;BA_control&#39;</span>,
                   <span class="st">&#39;BA_intervention&#39;</span>,
                   <span class="st">&#39;HRC_control&#39;</span>,
                   <span class="st">&#39;HRC_intervention&#39;</span>,
                   <span class="st">&#39;IT_control&#39;</span>,
                   <span class="st">&#39;IT_intervention&#39;</span>,
                   <span class="st">&#39;Nur_control&#39;</span>,
                   <span class="st">&#39;Nur_intervention&#39;</span>,
                   <span class="st">&#39;Other_control&#39;</span>,
                   <span class="st">&#39;Other_intervention&#39;</span>
))

sitBreaks_trackintervention_diamonds_intervention &lt;-<span class="st"> </span><span class="kw">rbind</span>(
sitBreaks_trackintervention_ci <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;Nur_intervention&quot;</span>),
sitBreaks_trackintervention_ci <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;HRC_intervention&quot;</span>),
sitBreaks_trackintervention_ci <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;BA_intervention&quot;</span>),
sitBreaks_trackintervention_ci <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;IT_intervention&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">arrange</span>(<span class="op">-</span><span class="kw">row_number</span>()) <span class="co"># reverse order of rows to make them right for the plot to come</span>

sitBreaks_trackintervention_diamonds_control &lt;-<span class="st"> </span><span class="kw">rbind</span>(
sitBreaks_trackintervention_ci <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;Nur_control&quot;</span>),
sitBreaks_trackintervention_ci <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;HRC_control&quot;</span>),
sitBreaks_trackintervention_ci <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;BA_control&quot;</span>),
sitBreaks_trackintervention_ci <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;IT_control&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">arrange</span>(<span class="op">-</span><span class="kw">row_number</span>()) <span class="co"># reverse order of rows to make them right for the plot to come</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
sitBreaks_trackgirl_diamonds_girl <span class="op">%&gt;%</span><span class="st"> </span>papaja<span class="op">::</span><span class="kw">apa_table</span>()</code></pre></div>
<caption>
(#tab:sitBreaks-tables)
</caption>
<caption>
**
</caption>
<table>
<thead>
<tr class="header">
<th align="left">sitBreaks_trackgirl_CIL</th>
<th align="left">sitBreaks_trackgirl_estimates</th>
<th align="left">sitBreaks_trackgirl_CIH</th>
<th align="left">Variable</th>
<th align="left">b_intercept</th>
<th align="left">track</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">18.03</td>
<td align="left">23.22</td>
<td align="left">28.21</td>
<td align="left">track:girl</td>
<td align="left">26.58</td>
<td align="left">IT_girl</td>
</tr>
<tr class="even">
<td align="left">26.68</td>
<td align="left">30.60</td>
<td align="left">34.77</td>
<td align="left">track:girl</td>
<td align="left">26.58</td>
<td align="left">BA_girl</td>
</tr>
<tr class="odd">
<td align="left">25.46</td>
<td align="left">29.21</td>
<td align="left">33.12</td>
<td align="left">track:girl</td>
<td align="left">26.58</td>
<td align="left">HRC_girl</td>
</tr>
<tr class="even">
<td align="left">29.45</td>
<td align="left">32.89</td>
<td align="left">36.56</td>
<td align="left">track:girl</td>
<td align="left">26.58</td>
<td align="left">Nur_girl</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sitBreaks_trackgirl_diamonds_boy <span class="op">%&gt;%</span><span class="st"> </span>papaja<span class="op">::</span><span class="kw">apa_table</span>()</code></pre></div>
<caption>
(#tab:sitBreaks-tables)
</caption>
<caption>
**
</caption>
<table>
<thead>
<tr class="header">
<th align="left">sitBreaks_trackgirl_CIL</th>
<th align="left">sitBreaks_trackgirl_estimates</th>
<th align="left">sitBreaks_trackgirl_CIH</th>
<th align="left">Variable</th>
<th align="left">b_intercept</th>
<th align="left">track</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">15.98</td>
<td align="left">19.98</td>
<td align="left">23.79</td>
<td align="left">track:girl</td>
<td align="left">26.58</td>
<td align="left">IT_boy</td>
</tr>
<tr class="even">
<td align="left">21.22</td>
<td align="left">25.01</td>
<td align="left">28.92</td>
<td align="left">track:girl</td>
<td align="left">26.58</td>
<td align="left">BA_boy</td>
</tr>
<tr class="odd">
<td align="left">20.58</td>
<td align="left">24.62</td>
<td align="left">28.72</td>
<td align="left">track:girl</td>
<td align="left">26.58</td>
<td align="left">HRC_boy</td>
</tr>
<tr class="even">
<td align="left">21.72</td>
<td align="left">25.73</td>
<td align="left">29.96</td>
<td align="left">track:girl</td>
<td align="left">26.58</td>
<td align="left">Nur_boy</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sitBreaks_trackintervention_diamonds_intervention <span class="op">%&gt;%</span><span class="st"> </span>papaja<span class="op">::</span><span class="kw">apa_table</span>()</code></pre></div>
<caption>
(#tab:sitBreaks-tables)
</caption>
<caption>
**
</caption>
<table>
<thead>
<tr class="header">
<th align="left">sitBreaks_trackintervention_CIL</th>
<th align="left">sitBreaks_trackintervention_estimates</th>
<th align="left">sitBreaks_trackintervention_CIH</th>
<th align="left">Variable</th>
<th align="left">b_intercept</th>
<th align="left">track</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">17.94</td>
<td align="left">21.96</td>
<td align="left">25.77</td>
<td align="left">track:intervention</td>
<td align="left">26.95</td>
<td align="left">IT_intervention</td>
</tr>
<tr class="even">
<td align="left">23.96</td>
<td align="left">27.54</td>
<td align="left">31.15</td>
<td align="left">track:intervention</td>
<td align="left">26.95</td>
<td align="left">BA_intervention</td>
</tr>
<tr class="odd">
<td align="left">22.65</td>
<td align="left">26.68</td>
<td align="left">30.55</td>
<td align="left">track:intervention</td>
<td align="left">26.95</td>
<td align="left">HRC_intervention</td>
</tr>
<tr class="even">
<td align="left">28.73</td>
<td align="left">31.94</td>
<td align="left">35.27</td>
<td align="left">track:intervention</td>
<td align="left">26.95</td>
<td align="left">Nur_intervention</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sitBreaks_trackintervention_diamonds_control <span class="op">%&gt;%</span><span class="st"> </span>papaja<span class="op">::</span><span class="kw">apa_table</span>()</code></pre></div>
<caption>
(#tab:sitBreaks-tables)
</caption>
<caption>
**
</caption>
<table>
<thead>
<tr class="header">
<th align="left">sitBreaks_trackintervention_CIL</th>
<th align="left">sitBreaks_trackintervention_estimates</th>
<th align="left">sitBreaks_trackintervention_CIH</th>
<th align="left">Variable</th>
<th align="left">b_intercept</th>
<th align="left">track</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">15.61</td>
<td align="left">19.60</td>
<td align="left">23.40</td>
<td align="left">track:intervention</td>
<td align="left">26.95</td>
<td align="left">IT_control</td>
</tr>
<tr class="even">
<td align="left">23.81</td>
<td align="left">27.43</td>
<td align="left">31.02</td>
<td align="left">track:intervention</td>
<td align="left">26.95</td>
<td align="left">BA_control</td>
</tr>
<tr class="odd">
<td align="left">24.37</td>
<td align="left">27.86</td>
<td align="left">31.29</td>
<td align="left">track:intervention</td>
<td align="left">26.95</td>
<td align="left">HRC_control</td>
</tr>
<tr class="even">
<td align="left">27.05</td>
<td align="left">30.57</td>
<td align="left">34.22</td>
<td align="left">track:intervention</td>
<td align="left">26.95</td>
<td align="left">Nur_control</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># Create data frame</span>
densplot &lt;-<span class="st"> </span>d
<span class="kw">levels</span>(densplot<span class="op">$</span>intervention) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Control&quot;</span>, <span class="st">&quot;Intervention&quot;</span>)
<span class="kw">levels</span>(densplot<span class="op">$</span>girl) &lt;-<span class="st"> </span><span class="kw">recode</span>(densplot<span class="op">$</span>girl, <span class="st">&quot;boy&quot;</span> =<span class="st"> &quot;Boys&quot;</span>, <span class="st">&quot;girl&quot;</span> =<span class="st"> &quot;Girls&quot;</span>)

<span class="co"># This gives side-by-side plots. There&#39;s a third plot below the two, which is fake to include x-axis text.</span>
<span class="kw">layout</span>(<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">3</span>), <span class="dt">nrow =</span> <span class="dv">2</span>, <span class="dt">ncol =</span> <span class="dv">2</span>, <span class="dt">byrow =</span> <span class="ot">TRUE</span>),
       <span class="dt">widths =</span> <span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>),<span class="dt">heights =</span> <span class="kw">c</span>(<span class="fl">0.45</span>,<span class="fl">0.05</span>))

<span class="co"># Minimise whitespace; see https://stackoverflow.com/questions/15848942/how-to-reduce-space-gap-between-multiple-graphs-in-r</span>
<span class="kw">par</span>(<span class="dt">mai =</span> <span class="kw">c</span>(<span class="fl">0.3</span>, <span class="fl">0.3</span>, <span class="fl">0.1</span>, <span class="fl">0.0</span>)) 

## Girls vs. boys
<span class="co"># Choose only the variables needed and drop NA</span>
dens &lt;-<span class="st"> </span>densplot <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(sitBreaks_T1, girl) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="kw">complete.cases</span>(.))

<span class="co"># Set random number generator for reproducibility of bootstrap test of equal densities</span>
<span class="kw">set.seed</span>(<span class="dv">10</span>)

<span class="co"># Make plot</span>
sm.sitBreaks_T1_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">sm.density.compare2</span>(<span class="kw">as.numeric</span>(dens<span class="op">$</span>sitBreaks_T1), 
                                               <span class="kw">as.factor</span>(dens<span class="op">$</span>girl), 
                                               <span class="dt">model =</span> <span class="st">&quot;equal&quot;</span>,
                                               <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>,
                                               <span class="dt">col =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end  =</span>  <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">1</span>)], 
                                               <span class="dt">lty =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>), <span class="dt">yaxt =</span> <span class="st">&quot;n&quot;</span>,
                                               <span class="dt">bandcol =</span> <span class="st">&#39;LightGray&#39;</span>, 
                                               <span class="dt">lwd =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))
## 
## Test of equal densities:  p-value =  0
<span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="kw">levels</span>(dens<span class="op">$</span>girl), <span class="dt">col =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>)], <span class="dt">lty =</span> <span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">1</span>), <span class="dt">lwd =</span> (<span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>)))
<span class="kw">mtext</span>(<span class="dt">side =</span> <span class="dv">2</span>, <span class="st">&quot;Density&quot;</span>, <span class="dt">line =</span> <span class="fl">0.5</span>)

## Intervention vs. control
<span class="co"># Choose only the variables needed and drop NA</span>
dens &lt;-<span class="st"> </span>densplot <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(sitBreaks_T1, intervention) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="kw">complete.cases</span>(.))

<span class="co"># Set random number generator for reproducibility of bootstrap test of equal densities</span>
<span class="kw">set.seed</span>(<span class="dv">10</span>)
<span class="co"># Make plot</span>
sm.sitBreaks_T1_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">sm.density.compare2</span>(<span class="kw">as.numeric</span>(dens<span class="op">$</span>sitBreaks_T1), 
                                               <span class="kw">as.factor</span>(dens<span class="op">$</span>intervention), 
                                               <span class="dt">model =</span> <span class="st">&quot;equal&quot;</span>, 
                                               <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>,
                                               <span class="dt">col =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">4</span>)], 
                                               <span class="dt">lty =</span> <span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">1</span>), <span class="dt">yaxt =</span> <span class="st">&quot;n&quot;</span>,
                                               <span class="dt">bandcol =</span> <span class="st">&#39;LightGray&#39;</span>, 
                                               <span class="dt">lwd =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))
## 
## Test of equal densities:  p-value =  0.2
<span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="kw">levels</span>(dens<span class="op">$</span>intervention), <span class="dt">col =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">4</span>)], <span class="dt">lty=</span><span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">1</span>), <span class="dt">lwd=</span>(<span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>)))

<span class="co"># Create x-axis label. See https://stackoverflow.com/questions/11198767/how-to-annotate-across-or-between-plots-in-multi-plot-panels-in-r</span>
<span class="kw">par</span>(<span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>)) 
<span class="kw">plot</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dt">type =</span> <span class="st">&quot;n&quot;</span>, <span class="dt">frame.plot =</span> <span class="ot">FALSE</span>,<span class="dt">axes =</span> <span class="ot">FALSE</span>) <span class="co"># Fake plot</span>
<span class="kw">text</span>(<span class="dt">x =</span> <span class="fl">1.02</span>, <span class="dt">y =</span> <span class="fl">1.3</span>, <span class="dt">labels =</span> <span class="st">&quot;Average number of breaks in daily sitting&quot;</span>, <span class="dt">pos =</span> <span class="dv">1</span>)</code></pre></div>
<p><img src="baseline-supplement_files/figure-html/sitBreaks-sm-1.png" width="672" /></p>
<div id="density-plot" class="section level3">
<h3>Density plot</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
plot1 &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(id,
                              <span class="dt">track =</span> track,
                              girl,
                              <span class="dt">PA =</span> sitBreaks_T1)  <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(track), track <span class="op">!=</span><span class="st"> &quot;Other&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># Drop category &quot;Other&quot;</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">track =</span> <span class="kw">factor</span>(track, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;IT&quot;</span>, <span class="st">&quot;BA&quot;</span>, <span class="st">&quot;HRC&quot;</span>, <span class="st">&quot;Nur&quot;</span>)),
                <span class="dt">track =</span> <span class="kw">recode_factor</span>(track, <span class="st">&quot;IT&quot;</span> =<span class="st"> &quot;IT&quot;</span>, <span class="st">&quot;BA&quot;</span> =<span class="st"> &quot;BA&quot;</span>, 
                                      <span class="st">&quot;HRC&quot;</span> =<span class="st"> &quot;HRC&quot;</span>, <span class="st">&quot;Nur&quot;</span> =<span class="st"> &quot;Nur&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>ggplot2<span class="op">::</span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">y =</span> track)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">geom_density_ridges2</span>(<span class="kw">aes</span>(<span class="dt">x =</span> PA, <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>, 
                                    <span class="dt">fill =</span> <span class="kw">paste</span>(track, girl),
                                    <span class="dt">point_color =</span> girl,
                                    <span class="dt">point_fill =</span> girl,
                                    <span class="dt">point_shape =</span> girl),
                                  <span class="dt">scale =</span> .<span class="dv">6</span>, <span class="dt">alpha =</span> <span class="fl">0.6</span>, <span class="dt">size =</span> <span class="fl">0.25</span>,
                                  <span class="dt">position =</span> <span class="kw">position_raincloud</span>(<span class="dt">width =</span> <span class="fl">0.2</span>, <span class="dt">height =</span> <span class="fl">0.15</span>),
                                  <span class="co"># from = 0, to = 450,</span>
                                  <span class="dt">jittered_points =</span> <span class="ot">TRUE</span>,
                                  <span class="dt">point_size =</span> <span class="dv">1</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="ot">NULL</span>,
       <span class="dt">y =</span> <span class="ot">NULL</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_discrete</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.1</span>, <span class="dv">0</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_fill_cyclical</span>(
                                <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&#39;BA boy&#39;</span> =<span class="st"> &quot;Boy&quot;</span>, <span class="st">&#39;BA girl&#39;</span> =<span class="st"> &quot;Girl&quot;</span>),
                                <span class="dt">values =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>)],
                                <span class="dt">name =</span> <span class="st">&quot;&quot;</span>, 
                                <span class="dt">guide =</span> <span class="kw">guide_legend</span>(<span class="dt">override.aes =</span> <span class="kw">list</span>(<span class="dt">alpha =</span> <span class="dv">1</span>, 
                                                                         <span class="dt">point_shape =</span> <span class="kw">c</span>(<span class="dv">24</span>, <span class="dv">4</span>),
                                                                         <span class="dt">point_size =</span> <span class="dv">2</span>))) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_colour_cyclical</span>(<span class="dt">values =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">theme_ridges</span>(<span class="dt">grid =</span> <span class="ot">FALSE</span>) <span class="op">+</span>
<span class="st">  </span><span class="co"># ggplot2::scale_fill_manual(values = c(&quot;#A0FFA0&quot;, &quot;#A0A0FF&quot;)) +</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_discrete_manual</span>(<span class="dt">aesthetics =</span> <span class="st">&quot;point_color&quot;</span>, 
                                  <span class="dt">values =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">1</span>)],
                                  <span class="dt">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_discrete_manual</span>(<span class="dt">aesthetics =</span> <span class="st">&quot;point_fill&quot;</span>,
                                  <span class="dt">values =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">1</span>)],
                                  <span class="dt">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_discrete_manual</span>(<span class="dt">aesthetics =</span> <span class="st">&quot;point_shape&quot;</span>, 
                                  <span class="dt">values =</span> <span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">24</span>),
                                  <span class="dt">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>papaja<span class="op">::</span><span class="kw">theme_apa</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)

plot1 &lt;-<span class="st"> </span>plot1 <span class="op">+</span><span class="st"> </span>
<span class="st">  </span>userfriendlyscience<span class="op">::</span><span class="kw">diamondPlot</span>(sitBreaks_trackgirl_diamonds_girl, 
                                   <span class="dt">returnLayerOnly =</span> <span class="ot">TRUE</span>, 
                                   <span class="dt">lineColor =</span> <span class="st">&quot;black&quot;</span>, 
                                   <span class="dt">color=</span>viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">3</span>],
                                   <span class="dt">alpha=</span>.<span class="dv">6</span>, 
                                   <span class="dt">fixedSize =</span> <span class="fl">0.1</span>, 
                                   <span class="dt">otherAxisCol =</span> (<span class="dv">1</span><span class="op">:</span><span class="dv">4</span> <span class="op">+</span><span class="st"> </span>.<span class="dv">15</span>)) <span class="op">+</span><span class="st"> </span><span class="co"># specify y-position; option to move the diamond </span>
<span class="st">  </span>userfriendlyscience<span class="op">::</span><span class="kw">diamondPlot</span>(sitBreaks_trackgirl_diamonds_boy, 
                                   <span class="dt">returnLayerOnly =</span> <span class="ot">TRUE</span>, 
                                   <span class="dt">lineColor =</span> <span class="st">&quot;black&quot;</span>, 
                                   <span class="dt">linetype =</span> <span class="st">&quot;solid&quot;</span>, 
                                   <span class="dt">color=</span>viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">1</span>],
                                   <span class="dt">alpha=</span>.<span class="dv">6</span>, 
                                   <span class="dt">fixedSize =</span> <span class="fl">0.1</span>, 
                                   <span class="dt">otherAxisCol =</span> (<span class="dv">1</span><span class="op">:</span><span class="dv">4</span> <span class="op">+</span><span class="st"> </span>.<span class="dv">15</span>))

<span class="co"># Draw plot with intervention and control densities</span>

plot2 &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(id,
                              <span class="dt">track =</span> track,
                              intervention,
                              <span class="dt">PA =</span> sitBreaks_T1)  <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(track), track <span class="op">!=</span><span class="st"> &quot;Other&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># Drop category &quot;Other&quot;</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">track =</span> <span class="kw">factor</span>(track, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;IT&quot;</span>, <span class="st">&quot;BA&quot;</span>, <span class="st">&quot;HRC&quot;</span>, <span class="st">&quot;Nur&quot;</span>)),
                <span class="dt">track =</span> <span class="kw">recode_factor</span>(track, <span class="st">&quot;IT&quot;</span> =<span class="st"> &quot;IT&quot;</span>, <span class="st">&quot;BA&quot;</span> =<span class="st"> &quot;BA&quot;</span>, 
                                      <span class="st">&quot;HRC&quot;</span> =<span class="st"> &quot;HRC&quot;</span>, <span class="st">&quot;Nur&quot;</span> =<span class="st"> &quot;Nur&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>ggplot2<span class="op">::</span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">y =</span> track)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">geom_density_ridges2</span>(<span class="kw">aes</span>(<span class="dt">x =</span> PA, <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>, 
                                    <span class="dt">fill =</span> <span class="kw">paste</span>(track, intervention),
                                    <span class="dt">point_color =</span> intervention,
                                    <span class="dt">point_fill =</span> intervention,
                                    <span class="dt">point_shape =</span> intervention),
                                  <span class="dt">scale =</span> .<span class="dv">6</span>, <span class="dt">alpha =</span> <span class="fl">0.6</span>, <span class="dt">size =</span> <span class="fl">0.25</span>,
                                  <span class="dt">position =</span> <span class="kw">position_raincloud</span>(<span class="dt">width =</span> <span class="fl">0.2</span>, <span class="dt">height =</span> <span class="fl">0.15</span>),
                                  <span class="co"># from = 0, to = 450,</span>
                                  <span class="dt">jittered_points =</span> <span class="ot">TRUE</span>,
                                  <span class="dt">point_size =</span> <span class="dv">1</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="ot">NULL</span>,
       <span class="dt">y =</span> <span class="ot">NULL</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_discrete</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.1</span>, <span class="dv">0</span>), <span class="dt">labels =</span> <span class="ot">NULL</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_fill_cyclical</span>(
                                <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&#39;BA 0&#39;</span> =<span class="st"> &quot;Control&quot;</span>, <span class="st">&#39;BA 1&#39;</span> =<span class="st"> &quot;Intervention&quot;</span>),
                                <span class="dt">values =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">4</span>)],
                                <span class="dt">name =</span> <span class="st">&quot;&quot;</span>, 
                                <span class="dt">guide =</span> <span class="kw">guide_legend</span>(<span class="dt">override.aes =</span> <span class="kw">list</span>(<span class="dt">alpha =</span> <span class="dv">1</span>, 
                                                                         <span class="dt">point_shape =</span> <span class="kw">c</span>(<span class="dv">21</span>, <span class="dv">3</span>),
                                                                         <span class="dt">point_size =</span> <span class="dv">2</span>))) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_colour_cyclical</span>(<span class="dt">values =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">theme_ridges</span>(<span class="dt">grid =</span> <span class="ot">FALSE</span>) <span class="op">+</span>
<span class="st">  </span><span class="co"># ggplot2::scale_fill_manual(values = c(&quot;#A0FFA0&quot;, &quot;#A0A0FF&quot;)) +</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_discrete_manual</span>(<span class="dt">aesthetics =</span> <span class="st">&quot;point_color&quot;</span>, 
                                  <span class="dt">values =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">4</span>)],
                                  <span class="dt">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_discrete_manual</span>(<span class="dt">aesthetics =</span> <span class="st">&quot;point_fill&quot;</span>,
                                  <span class="dt">values =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">4</span>)],
                                  <span class="dt">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_discrete_manual</span>(<span class="dt">aesthetics =</span> <span class="st">&quot;point_shape&quot;</span>, 
                                  <span class="dt">values =</span> <span class="kw">c</span>(<span class="dv">21</span>, <span class="dv">3</span>),
                                  <span class="dt">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>papaja<span class="op">::</span><span class="kw">theme_apa</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)

plot2 &lt;-<span class="st"> </span>plot2 <span class="op">+</span><span class="st"> </span>
<span class="st">  </span>userfriendlyscience<span class="op">::</span><span class="kw">diamondPlot</span>(sitBreaks_trackintervention_diamonds_intervention, 
                                   <span class="dt">returnLayerOnly =</span> <span class="ot">TRUE</span>, 
                                   <span class="dt">lineColor =</span> <span class="st">&quot;black&quot;</span>,  
                                   <span class="dt">color=</span>viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">4</span>],
                                   <span class="dt">alpha=</span>.<span class="dv">6</span>, 
                                   <span class="dt">fixedSize =</span> <span class="fl">0.1</span>, 
                                   <span class="dt">otherAxisCol =</span> (<span class="dv">1</span><span class="op">:</span><span class="dv">4</span> <span class="op">+</span><span class="st"> </span>.<span class="dv">15</span>)) <span class="op">+</span>
<span class="st">  </span>userfriendlyscience<span class="op">::</span><span class="kw">diamondPlot</span>(sitBreaks_trackintervention_diamonds_control, 
                                   <span class="dt">returnLayerOnly =</span> <span class="ot">TRUE</span>, 
                                   <span class="dt">lineColor =</span> <span class="st">&quot;black&quot;</span>,  
                                   <span class="dt">color=</span>viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">2</span>],
                                   <span class="dt">alpha=</span>.<span class="dv">6</span>, 
                                   <span class="dt">fixedSize =</span> <span class="fl">0.1</span>, 
                                   <span class="dt">otherAxisCol =</span> (<span class="dv">1</span><span class="op">:</span><span class="dv">4</span> <span class="op">+</span><span class="st"> </span>.<span class="dv">15</span>))

plot1 <span class="op">+</span><span class="st"> </span>plot2
## Picking joint bandwidth of 3.67
## Warning: Removed 370 rows containing non-finite values
## (stat_density_ridges).
## Picking joint bandwidth of 3.51
## Warning: Removed 370 rows containing non-finite values
## (stat_density_ridges).</code></pre></div>
<p><img src="baseline-supplement_files/figure-html/sitBreaks-densityplot-1.png" width="672" /></p>
</div>
</div>
<div id="sb-accelerometer-measured" class="section level2">
<h2>SB, Accelerometer-measured</h2>
<div id="density-plot-by-intervention-and-gender-1" class="section level3">
<h3>Density plot by intervention and gender</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># Create data frame</span>
densplot &lt;-<span class="st"> </span>d
<span class="kw">levels</span>(densplot<span class="op">$</span>intervention) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Control&quot;</span>, <span class="st">&quot;Intervention&quot;</span>)
<span class="kw">levels</span>(densplot<span class="op">$</span>girl) &lt;-<span class="st"> </span><span class="kw">recode</span>(densplot<span class="op">$</span>girl, <span class="st">&quot;boy&quot;</span> =<span class="st"> &quot;Boys&quot;</span>, <span class="st">&quot;girl&quot;</span> =<span class="st"> &quot;Girls&quot;</span>)

<span class="co"># This gives side-by-side plots. There&#39;s a third plot below the two, which is fake to include x-axis text.</span>
<span class="kw">layout</span>(<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">3</span>), <span class="dt">nrow =</span> <span class="dv">2</span>, <span class="dt">ncol =</span> <span class="dv">2</span>, <span class="dt">byrow =</span> <span class="ot">TRUE</span>),
       <span class="dt">widths =</span> <span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>),<span class="dt">heights =</span> <span class="kw">c</span>(<span class="fl">0.45</span>,<span class="fl">0.05</span>))

<span class="co"># Minimise whitespace; see https://stackoverflow.com/questions/15848942/how-to-reduce-space-gap-between-multiple-graphs-in-r</span>
<span class="kw">par</span>(<span class="dt">mai =</span> <span class="kw">c</span>(<span class="fl">0.3</span>, <span class="fl">0.3</span>, <span class="fl">0.1</span>, <span class="fl">0.0</span>)) 

## Girls vs. boys
<span class="co"># Choose only the variables needed and drop NA</span>
dens &lt;-<span class="st"> </span>densplot <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(sitLieAccelerometer_T1, girl) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="kw">complete.cases</span>(.))

<span class="co"># Set random number generator for reproducibility of bootstrap test of equal densities</span>
<span class="kw">set.seed</span>(<span class="dv">10</span>)

<span class="co"># Make plot</span>
sm.sitLieAccelerometer_T1_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">sm.density.compare2</span>(<span class="kw">as.numeric</span>(dens<span class="op">$</span>sitLieAccelerometer_T1), 
                                               <span class="kw">as.factor</span>(dens<span class="op">$</span>girl), 
                                               <span class="dt">model =</span> <span class="st">&quot;equal&quot;</span>,
                                               <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>,
                                               <span class="dt">col =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end  =</span>  <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">1</span>)], 
                                               <span class="dt">lty =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>), <span class="dt">yaxt =</span> <span class="st">&quot;n&quot;</span>,
                                               <span class="dt">bandcol =</span> <span class="st">&#39;LightGray&#39;</span>, 
                                               <span class="dt">lwd =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))
## 
## Test of equal densities:  p-value =  0
<span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="kw">levels</span>(dens<span class="op">$</span>girl), <span class="dt">col =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>)], <span class="dt">lty =</span> <span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">1</span>), <span class="dt">lwd =</span> (<span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>)))
<span class="kw">mtext</span>(<span class="dt">side =</span> <span class="dv">2</span>, <span class="st">&quot;Density&quot;</span>, <span class="dt">line =</span> <span class="fl">0.5</span>)

## Intervention vs. control
<span class="co"># Choose only the variables needed and drop NA</span>
dens &lt;-<span class="st"> </span>densplot <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(sitLieAccelerometer_T1, intervention) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="kw">complete.cases</span>(.))

<span class="co"># Set random number generator for reproducibility of bootstrap test of equal densities</span>
<span class="kw">set.seed</span>(<span class="dv">10</span>)
<span class="co"># Make plot</span>
sm.sitLieAccelerometer_T1_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">sm.density.compare2</span>(<span class="kw">as.numeric</span>(dens<span class="op">$</span>sitLieAccelerometer_T1), 
                                               <span class="kw">as.factor</span>(dens<span class="op">$</span>intervention), 
                                               <span class="dt">model =</span> <span class="st">&quot;equal&quot;</span>, 
                                               <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>,
                                               <span class="dt">col =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">4</span>)], 
                                               <span class="dt">lty =</span> <span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">1</span>), <span class="dt">yaxt =</span> <span class="st">&quot;n&quot;</span>,
                                               <span class="dt">bandcol =</span> <span class="st">&#39;LightGray&#39;</span>, 
                                               <span class="dt">lwd =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))
## 
## Test of equal densities:  p-value =  0.12
<span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="kw">levels</span>(dens<span class="op">$</span>intervention), <span class="dt">col =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">4</span>)], <span class="dt">lty=</span><span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">1</span>), <span class="dt">lwd=</span>(<span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>)))

<span class="co"># Create x-axis label. See https://stackoverflow.com/questions/11198767/how-to-annotate-across-or-between-plots-in-multi-plot-panels-in-r</span>
<span class="kw">par</span>(<span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>)) 
<span class="kw">plot</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dt">type =</span> <span class="st">&quot;n&quot;</span>, <span class="dt">frame.plot =</span> <span class="ot">FALSE</span>,<span class="dt">axes =</span> <span class="ot">FALSE</span>) <span class="co"># Fake plot</span>
<span class="kw">text</span>(<span class="dt">x =</span> <span class="fl">1.02</span>, <span class="dt">y =</span> <span class="fl">1.3</span>, <span class="dt">labels =</span> <span class="st">&quot;Average daily minutes spent sitting or lying down&quot;</span>, <span class="dt">pos =</span> <span class="dv">1</span>)</code></pre></div>
<p><img src="baseline-supplement_files/figure-html/sitLieAccelerometer-sm-1.png" width="672" /></p>
<p>Prepare data: time spent sitting &amp; lying down</p>
<p>Get credibility intervals track:school</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m_sitLieAccelerometer_trackgirl &lt;-<span class="st"> </span>brms<span class="op">::</span><span class="kw">bf</span>(sitLieAccelerometer_T1 <span class="op">~</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>track<span class="op">:</span>girl)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>brms<span class="op">::</span><span class="kw">brm</span>(., <span class="dt">data =</span> df, <span class="dt">chains =</span> <span class="dv">4</span>, <span class="dt">iter =</span> <span class="dv">4000</span>, <span class="dt">control =</span> <span class="kw">list</span>(<span class="dt">adapt_delta =</span> <span class="fl">0.95</span>))
## Found more than one class &quot;family&quot; in cache; using the first, from namespace &#39;lme4&#39;
## Also defined by &#39;MatrixModels&#39;
## Warning: Rows containing NAs were excluded from the model
## Compiling the C++ model
## Start sampling
## 
## SAMPLING FOR MODEL &#39;gaussian brms-model&#39; NOW (CHAIN 1).
## 
## Gradient evaluation took 0 seconds
## 1000 transitions using 10 leapfrog steps per transition would take 0 seconds.
## Adjust your expectations accordingly!
## 
## 
## Iteration:    1 / 4000 [  0%]  (Warmup)
## Iteration:  400 / 4000 [ 10%]  (Warmup)
## Iteration:  800 / 4000 [ 20%]  (Warmup)
## Iteration: 1200 / 4000 [ 30%]  (Warmup)
## Iteration: 1600 / 4000 [ 40%]  (Warmup)
## Iteration: 2000 / 4000 [ 50%]  (Warmup)
## Iteration: 2001 / 4000 [ 50%]  (Sampling)
## Iteration: 2400 / 4000 [ 60%]  (Sampling)
## Iteration: 2800 / 4000 [ 70%]  (Sampling)
## Iteration: 3200 / 4000 [ 80%]  (Sampling)
## Iteration: 3600 / 4000 [ 90%]  (Sampling)
## Iteration: 4000 / 4000 [100%]  (Sampling)
## 
##  Elapsed Time: 3.092 seconds (Warm-up)
##                2.077 seconds (Sampling)
##                5.169 seconds (Total)
## 
## 
## SAMPLING FOR MODEL &#39;gaussian brms-model&#39; NOW (CHAIN 2).
## 
## Gradient evaluation took 0 seconds
## 1000 transitions using 10 leapfrog steps per transition would take 0 seconds.
## Adjust your expectations accordingly!
## 
## 
## Iteration:    1 / 4000 [  0%]  (Warmup)
## Iteration:  400 / 4000 [ 10%]  (Warmup)
## Iteration:  800 / 4000 [ 20%]  (Warmup)
## Iteration: 1200 / 4000 [ 30%]  (Warmup)
## Iteration: 1600 / 4000 [ 40%]  (Warmup)
## Iteration: 2000 / 4000 [ 50%]  (Warmup)
## Iteration: 2001 / 4000 [ 50%]  (Sampling)
## Iteration: 2400 / 4000 [ 60%]  (Sampling)
## Iteration: 2800 / 4000 [ 70%]  (Sampling)
## Iteration: 3200 / 4000 [ 80%]  (Sampling)
## Iteration: 3600 / 4000 [ 90%]  (Sampling)
## Iteration: 4000 / 4000 [100%]  (Sampling)
## 
##  Elapsed Time: 3.393 seconds (Warm-up)
##                1.728 seconds (Sampling)
##                5.121 seconds (Total)
## 
## 
## SAMPLING FOR MODEL &#39;gaussian brms-model&#39; NOW (CHAIN 3).
## 
## Gradient evaluation took 0 seconds
## 1000 transitions using 10 leapfrog steps per transition would take 0 seconds.
## Adjust your expectations accordingly!
## 
## 
## Iteration:    1 / 4000 [  0%]  (Warmup)
## Iteration:  400 / 4000 [ 10%]  (Warmup)
## Iteration:  800 / 4000 [ 20%]  (Warmup)
## Iteration: 1200 / 4000 [ 30%]  (Warmup)
## Iteration: 1600 / 4000 [ 40%]  (Warmup)
## Iteration: 2000 / 4000 [ 50%]  (Warmup)
## Iteration: 2001 / 4000 [ 50%]  (Sampling)
## Iteration: 2400 / 4000 [ 60%]  (Sampling)
## Iteration: 2800 / 4000 [ 70%]  (Sampling)
## Iteration: 3200 / 4000 [ 80%]  (Sampling)
## Iteration: 3600 / 4000 [ 90%]  (Sampling)
## Iteration: 4000 / 4000 [100%]  (Sampling)
## 
##  Elapsed Time: 2.725 seconds (Warm-up)
##                1.857 seconds (Sampling)
##                4.582 seconds (Total)
## 
## 
## SAMPLING FOR MODEL &#39;gaussian brms-model&#39; NOW (CHAIN 4).
## 
## Gradient evaluation took 0 seconds
## 1000 transitions using 10 leapfrog steps per transition would take 0 seconds.
## Adjust your expectations accordingly!
## 
## 
## Iteration:    1 / 4000 [  0%]  (Warmup)
## Iteration:  400 / 4000 [ 10%]  (Warmup)
## Iteration:  800 / 4000 [ 20%]  (Warmup)
## Iteration: 1200 / 4000 [ 30%]  (Warmup)
## Iteration: 1600 / 4000 [ 40%]  (Warmup)
## Iteration: 2000 / 4000 [ 50%]  (Warmup)
## Iteration: 2001 / 4000 [ 50%]  (Sampling)
## Iteration: 2400 / 4000 [ 60%]  (Sampling)
## Iteration: 2800 / 4000 [ 70%]  (Sampling)
## Iteration: 3200 / 4000 [ 80%]  (Sampling)
## Iteration: 3600 / 4000 [ 90%]  (Sampling)
## Iteration: 4000 / 4000 [100%]  (Sampling)
## 
##  Elapsed Time: 3.188 seconds (Warm-up)
##                2.309 seconds (Sampling)
##                5.497 seconds (Total)

brms<span class="op">::</span><span class="kw">prior_summary</span>(m_sitLieAccelerometer_trackgirl, <span class="dt">data =</span> df)</code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["bound"],"name":[8],"type":["chr"],"align":["left"]}],"data":[{"1":"student_t(3, 568, 97)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":""},{"1":"student_t(3, 0, 97)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":""},{"1":"","2":"sd","3":"","4":"track:girl","5":"","6":"","7":"","8":""},{"1":"","2":"sd","3":"Intercept","4":"track:girl","5":"","6":"","7":"","8":""},{"1":"student_t(3, 0, 97)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":""}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
m_sitLieAccelerometer_trackgirl
##  Family: gaussian 
##   Links: mu = identity; sigma = identity 
## Formula: sitLieAccelerometer_T1 ~ (1 | track:girl) 
##    Data: df (Number of observations: 706) 
## Samples: 4 chains, each with iter = 4000; warmup = 2000; thin = 1; 
##          total post-warmup samples = 8000
##     ICs: LOO = NA; WAIC = NA; R2 = NA
##  
## Group-Level Effects: 
## ~track:girl (Number of levels: 10) 
##               Estimate Est.Error l-95% CI u-95% CI Eff.Sample Rhat
## sd(Intercept)    45.40     14.36    25.22    81.06       1708 1.00
## 
## Population-Level Effects: 
##           Estimate Est.Error l-95% CI u-95% CI Eff.Sample Rhat
## Intercept   592.97     15.73   562.65   624.88       1386 1.00
## 
## Family Specific Parameters: 
##       Estimate Est.Error l-95% CI u-95% CI Eff.Sample Rhat
## sigma    89.82      2.40    85.33    94.62       7188 1.00
## 
## Samples were drawn using sampling(NUTS). For each parameter, Eff.Sample 
## is a crude measure of effective sample size, and Rhat is the potential 
## scale reduction factor on split chains (at convergence, Rhat = 1).

b_intercept &lt;-<span class="st"> </span>brms<span class="op">::</span><span class="kw">fixef</span>(m_sitLieAccelerometer_trackgirl)[<span class="dv">1</span>]

<span class="co"># This gives estimates only:</span>
sitLie_trackgirl_estimates &lt;-<span class="st"> </span>brms<span class="op">::</span><span class="kw">ranef</span>(m_sitLieAccelerometer_trackgirl)[[<span class="dv">1</span>]][<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]

<span class="co"># The 2.5%ile:</span>
sitLie_trackgirl_CIL &lt;-<span class="st"> </span>brms<span class="op">::</span><span class="kw">ranef</span>(m_sitLieAccelerometer_trackgirl)[[<span class="dv">1</span>]][<span class="dv">21</span><span class="op">:</span><span class="dv">30</span>]

<span class="co"># The 97.5%ile:</span>
sitLie_trackgirl_CIH &lt;-<span class="st"> </span>brms<span class="op">::</span><span class="kw">ranef</span>(m_sitLieAccelerometer_trackgirl)[[<span class="dv">1</span>]][<span class="dv">31</span><span class="op">:</span><span class="dv">40</span>]

sitLie_trackgirl_ci &lt;-<span class="st"> </span><span class="kw">data.frame</span>(sitLie_trackgirl_CIL, sitLie_trackgirl_estimates, sitLie_trackgirl_CIH, <span class="dt">Variable =</span> <span class="kw">labels</span>(brms<span class="op">::</span><span class="kw">ranef</span>(m_sitLieAccelerometer_trackgirl))) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">b_intercept =</span> <span class="kw">rep</span>(b_intercept, <span class="dv">10</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">sitLie_trackgirl_CIL =</span> sitLie_trackgirl_CIL <span class="op">+</span><span class="st"> </span>b_intercept,
         <span class="dt">sitLie_trackgirl_estimates =</span> sitLie_trackgirl_estimates <span class="op">+</span><span class="st"> </span>b_intercept,
         <span class="dt">sitLie_trackgirl_CIH =</span> sitLie_trackgirl_CIH <span class="op">+</span><span class="st"> </span>b_intercept,
         <span class="dt">track =</span> <span class="kw">c</span>(<span class="st">&#39;BA_boy&#39;</span>,
                   <span class="st">&#39;BA_girl&#39;</span>,
                   <span class="st">&#39;HRC_boy&#39;</span>,
                   <span class="st">&#39;HRC_girl&#39;</span>,
                   <span class="st">&#39;IT_boy&#39;</span>,
                   <span class="st">&#39;IT_girl&#39;</span>,
                   <span class="st">&#39;Nur_boy&#39;</span>,
                   <span class="st">&#39;Nur_girl&#39;</span>,
                   <span class="st">&#39;Other_boy&#39;</span>,
                   <span class="st">&#39;Other_girl&#39;</span>
))

sitLie_trackgirl_diamonds_girl &lt;-<span class="st"> </span><span class="kw">rbind</span>(
sitLie_trackgirl_ci <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;Nur_girl&quot;</span>),
sitLie_trackgirl_ci <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;HRC_girl&quot;</span>),
sitLie_trackgirl_ci <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;BA_girl&quot;</span>),
sitLie_trackgirl_ci <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;IT_girl&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">arrange</span>(<span class="op">-</span><span class="kw">row_number</span>()) <span class="co"># reverse order of rows to make them right for the plot to come</span>

sitLie_trackgirl_diamonds_boy &lt;-<span class="st"> </span><span class="kw">rbind</span>(
sitLie_trackgirl_ci <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;Nur_boy&quot;</span>),
sitLie_trackgirl_ci <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;HRC_boy&quot;</span>),
sitLie_trackgirl_ci <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;BA_boy&quot;</span>),
sitLie_trackgirl_ci <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;IT_boy&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">arrange</span>(<span class="op">-</span><span class="kw">row_number</span>()) <span class="co"># reverse order of rows to make them right for the plot to come</span>


m_sitLieAccelerometer_trackintervention &lt;-<span class="st"> </span>brms<span class="op">::</span><span class="kw">bf</span>(sitLieAccelerometer_T1 <span class="op">~</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>track<span class="op">:</span>intervention)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>brms<span class="op">::</span><span class="kw">brm</span>(., <span class="dt">data =</span> df, <span class="dt">chains =</span> <span class="dv">4</span>, <span class="dt">iter =</span> <span class="dv">4000</span>, <span class="dt">control =</span> <span class="kw">list</span>(<span class="dt">adapt_delta =</span> <span class="fl">0.95</span>))
## Found more than one class &quot;family&quot; in cache; using the first, from namespace &#39;lme4&#39;
## Also defined by &#39;MatrixModels&#39;
## Warning: Rows containing NAs were excluded from the model
## Compiling the C++ model
## Start sampling
## 
## SAMPLING FOR MODEL &#39;gaussian brms-model&#39; NOW (CHAIN 1).
## 
## Gradient evaluation took 0 seconds
## 1000 transitions using 10 leapfrog steps per transition would take 0 seconds.
## Adjust your expectations accordingly!
## 
## 
## Iteration:    1 / 4000 [  0%]  (Warmup)
## Iteration:  400 / 4000 [ 10%]  (Warmup)
## Iteration:  800 / 4000 [ 20%]  (Warmup)
## Iteration: 1200 / 4000 [ 30%]  (Warmup)
## Iteration: 1600 / 4000 [ 40%]  (Warmup)
## Iteration: 2000 / 4000 [ 50%]  (Warmup)
## Iteration: 2001 / 4000 [ 50%]  (Sampling)
## Iteration: 2400 / 4000 [ 60%]  (Sampling)
## Iteration: 2800 / 4000 [ 70%]  (Sampling)
## Iteration: 3200 / 4000 [ 80%]  (Sampling)
## Iteration: 3600 / 4000 [ 90%]  (Sampling)
## Iteration: 4000 / 4000 [100%]  (Sampling)
## 
##  Elapsed Time: 3.484 seconds (Warm-up)
##                1.694 seconds (Sampling)
##                5.178 seconds (Total)
## 
## 
## SAMPLING FOR MODEL &#39;gaussian brms-model&#39; NOW (CHAIN 2).
## 
## Gradient evaluation took 0 seconds
## 1000 transitions using 10 leapfrog steps per transition would take 0 seconds.
## Adjust your expectations accordingly!
## 
## 
## Iteration:    1 / 4000 [  0%]  (Warmup)
## Iteration:  400 / 4000 [ 10%]  (Warmup)
## Iteration:  800 / 4000 [ 20%]  (Warmup)
## Iteration: 1200 / 4000 [ 30%]  (Warmup)
## Iteration: 1600 / 4000 [ 40%]  (Warmup)
## Iteration: 2000 / 4000 [ 50%]  (Warmup)
## Iteration: 2001 / 4000 [ 50%]  (Sampling)
## Iteration: 2400 / 4000 [ 60%]  (Sampling)
## Iteration: 2800 / 4000 [ 70%]  (Sampling)
## Iteration: 3200 / 4000 [ 80%]  (Sampling)
## Iteration: 3600 / 4000 [ 90%]  (Sampling)
## Iteration: 4000 / 4000 [100%]  (Sampling)
## 
##  Elapsed Time: 2.884 seconds (Warm-up)
##                1.88 seconds (Sampling)
##                4.764 seconds (Total)
## 
## 
## SAMPLING FOR MODEL &#39;gaussian brms-model&#39; NOW (CHAIN 3).
## 
## Gradient evaluation took 0 seconds
## 1000 transitions using 10 leapfrog steps per transition would take 0 seconds.
## Adjust your expectations accordingly!
## 
## 
## Iteration:    1 / 4000 [  0%]  (Warmup)
## Iteration:  400 / 4000 [ 10%]  (Warmup)
## Iteration:  800 / 4000 [ 20%]  (Warmup)
## Iteration: 1200 / 4000 [ 30%]  (Warmup)
## Iteration: 1600 / 4000 [ 40%]  (Warmup)
## Iteration: 2000 / 4000 [ 50%]  (Warmup)
## Iteration: 2001 / 4000 [ 50%]  (Sampling)
## Iteration: 2400 / 4000 [ 60%]  (Sampling)
## Iteration: 2800 / 4000 [ 70%]  (Sampling)
## Iteration: 3200 / 4000 [ 80%]  (Sampling)
## Iteration: 3600 / 4000 [ 90%]  (Sampling)
## Iteration: 4000 / 4000 [100%]  (Sampling)
## 
##  Elapsed Time: 3.265 seconds (Warm-up)
##                1.899 seconds (Sampling)
##                5.164 seconds (Total)
## 
## 
## SAMPLING FOR MODEL &#39;gaussian brms-model&#39; NOW (CHAIN 4).
## 
## Gradient evaluation took 0 seconds
## 1000 transitions using 10 leapfrog steps per transition would take 0 seconds.
## Adjust your expectations accordingly!
## 
## 
## Iteration:    1 / 4000 [  0%]  (Warmup)
## Iteration:  400 / 4000 [ 10%]  (Warmup)
## Iteration:  800 / 4000 [ 20%]  (Warmup)
## Iteration: 1200 / 4000 [ 30%]  (Warmup)
## Iteration: 1600 / 4000 [ 40%]  (Warmup)
## Iteration: 2000 / 4000 [ 50%]  (Warmup)
## Iteration: 2001 / 4000 [ 50%]  (Sampling)
## Iteration: 2400 / 4000 [ 60%]  (Sampling)
## Iteration: 2800 / 4000 [ 70%]  (Sampling)
## Iteration: 3200 / 4000 [ 80%]  (Sampling)
## Iteration: 3600 / 4000 [ 90%]  (Sampling)
## Iteration: 4000 / 4000 [100%]  (Sampling)
## 
##  Elapsed Time: 3.208 seconds (Warm-up)
##                1.772 seconds (Sampling)
##                4.98 seconds (Total)

brms<span class="op">::</span><span class="kw">prior_summary</span>(m_sitLieAccelerometer_trackintervention, <span class="dt">data =</span> df)</code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["bound"],"name":[8],"type":["chr"],"align":["left"]}],"data":[{"1":"student_t(3, 568, 97)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":""},{"1":"student_t(3, 0, 97)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":""},{"1":"","2":"sd","3":"","4":"track:intervention","5":"","6":"","7":"","8":""},{"1":"","2":"sd","3":"Intercept","4":"track:intervention","5":"","6":"","7":"","8":""},{"1":"student_t(3, 0, 97)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":""}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
m_sitLieAccelerometer_trackintervention
##  Family: gaussian 
##   Links: mu = identity; sigma = identity 
## Formula: sitLieAccelerometer_T1 ~ (1 | track:intervention) 
##    Data: df (Number of observations: 706) 
## Samples: 4 chains, each with iter = 4000; warmup = 2000; thin = 1; 
##          total post-warmup samples = 8000
##     ICs: LOO = NA; WAIC = NA; R2 = NA
##  
## Group-Level Effects: 
## ~track:intervention (Number of levels: 10) 
##               Estimate Est.Error l-95% CI u-95% CI Eff.Sample Rhat
## sd(Intercept)    47.96     14.11    28.14    82.40       1472 1.00
## 
## Population-Level Effects: 
##           Estimate Est.Error l-95% CI u-95% CI Eff.Sample Rhat
## Intercept   591.56     15.87   560.36   622.91       1518 1.00
## 
## Family Specific Parameters: 
##       Estimate Est.Error l-95% CI u-95% CI Eff.Sample Rhat
## sigma    89.74      2.36    85.25    94.49       6460 1.00
## 
## Samples were drawn using sampling(NUTS). For each parameter, Eff.Sample 
## is a crude measure of effective sample size, and Rhat is the potential 
## scale reduction factor on split chains (at convergence, Rhat = 1).

b_intercept &lt;-<span class="st"> </span>brms<span class="op">::</span><span class="kw">fixef</span>(m_sitLieAccelerometer_trackintervention)[<span class="dv">1</span>]

<span class="co"># This gives estimates only:</span>
sitLie_trackintervention_estimates &lt;-<span class="st"> </span>brms<span class="op">::</span><span class="kw">ranef</span>(m_sitLieAccelerometer_trackintervention)[[<span class="dv">1</span>]][<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]


<span class="co"># The 2.5%ile:</span>
sitLie_trackintervention_CIL &lt;-<span class="st"> </span>brms<span class="op">::</span><span class="kw">ranef</span>(m_sitLieAccelerometer_trackintervention)[[<span class="dv">1</span>]][<span class="dv">21</span><span class="op">:</span><span class="dv">30</span>]

<span class="co"># The 97.5%ile:</span>
sitLie_trackintervention_CIH &lt;-<span class="st"> </span>brms<span class="op">::</span><span class="kw">ranef</span>(m_sitLieAccelerometer_trackintervention)[[<span class="dv">1</span>]][<span class="dv">31</span><span class="op">:</span><span class="dv">40</span>]

sitLie_trackintervention_ci &lt;-<span class="st"> </span><span class="kw">data.frame</span>(sitLie_trackintervention_CIL, sitLie_trackintervention_estimates, sitLie_trackintervention_CIH, <span class="dt">Variable =</span> <span class="kw">labels</span>(brms<span class="op">::</span><span class="kw">ranef</span>(m_sitLieAccelerometer_trackintervention))) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">b_intercept =</span> <span class="kw">rep</span>(b_intercept, <span class="dv">10</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">sitLie_trackintervention_CIL =</span> sitLie_trackintervention_CIL <span class="op">+</span><span class="st"> </span>b_intercept,
         <span class="dt">sitLie_trackintervention_estimates =</span> sitLie_trackintervention_estimates <span class="op">+</span><span class="st"> </span>b_intercept,
         <span class="dt">sitLie_trackintervention_CIH =</span> sitLie_trackintervention_CIH <span class="op">+</span><span class="st"> </span>b_intercept,
         <span class="dt">track =</span> <span class="kw">c</span>(<span class="st">&#39;BA_control&#39;</span>,
                   <span class="st">&#39;BA_intervention&#39;</span>,
                   <span class="st">&#39;HRC_control&#39;</span>,
                   <span class="st">&#39;HRC_intervention&#39;</span>,
                   <span class="st">&#39;IT_control&#39;</span>,
                   <span class="st">&#39;IT_intervention&#39;</span>,
                   <span class="st">&#39;Nur_control&#39;</span>,
                   <span class="st">&#39;Nur_intervention&#39;</span>,
                   <span class="st">&#39;Other_control&#39;</span>,
                   <span class="st">&#39;Other_intervention&#39;</span>
))

sitLie_trackintervention_diamonds_intervention &lt;-<span class="st"> </span><span class="kw">rbind</span>(
sitLie_trackintervention_ci <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;Nur_intervention&quot;</span>),
sitLie_trackintervention_ci <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;HRC_intervention&quot;</span>),
sitLie_trackintervention_ci <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;BA_intervention&quot;</span>),
sitLie_trackintervention_ci <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;IT_intervention&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">arrange</span>(<span class="op">-</span><span class="kw">row_number</span>()) <span class="co"># reverse order of rows to make them right for the plot to come</span>

sitLie_trackintervention_diamonds_control &lt;-<span class="st"> </span><span class="kw">rbind</span>(
sitLie_trackintervention_ci <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;Nur_control&quot;</span>),
sitLie_trackintervention_ci <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;HRC_control&quot;</span>),
sitLie_trackintervention_ci <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;BA_control&quot;</span>),
sitLie_trackintervention_ci <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;IT_control&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">arrange</span>(<span class="op">-</span><span class="kw">row_number</span>()) <span class="co"># reverse order of rows to make them right for the plot to come</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
sitLie_trackgirl_diamonds_girl <span class="op">%&gt;%</span><span class="st"> </span>papaja<span class="op">::</span><span class="kw">apa_table</span>()</code></pre></div>
<caption>
(#tab:sitLie-tables)
</caption>
<caption>
**
</caption>
<table>
<thead>
<tr class="header">
<th align="left">sitLie_trackgirl_CIL</th>
<th align="left">sitLie_trackgirl_estimates</th>
<th align="left">sitLie_trackgirl_CIH</th>
<th align="left">Variable</th>
<th align="left">b_intercept</th>
<th align="left">track</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">578.97</td>
<td align="left">623.67</td>
<td align="left">669.74</td>
<td align="left">track:girl</td>
<td align="left">592.97</td>
<td align="left">IT_girl</td>
</tr>
<tr class="even">
<td align="left">532.40</td>
<td align="left">570.34</td>
<td align="left">606.63</td>
<td align="left">track:girl</td>
<td align="left">592.97</td>
<td align="left">BA_girl</td>
</tr>
<tr class="odd">
<td align="left">507.67</td>
<td align="left">544.82</td>
<td align="left">578.69</td>
<td align="left">track:girl</td>
<td align="left">592.97</td>
<td align="left">HRC_girl</td>
</tr>
<tr class="even">
<td align="left">515.06</td>
<td align="left">549.52</td>
<td align="left">580.69</td>
<td align="left">track:girl</td>
<td align="left">592.97</td>
<td align="left">Nur_girl</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sitLie_trackgirl_diamonds_boy <span class="op">%&gt;%</span><span class="st"> </span>papaja<span class="op">::</span><span class="kw">apa_table</span>()</code></pre></div>
<caption>
(#tab:sitLie-tables)
</caption>
<caption>
**
</caption>
<table>
<thead>
<tr class="header">
<th align="left">sitLie_trackgirl_CIL</th>
<th align="left">sitLie_trackgirl_estimates</th>
<th align="left">sitLie_trackgirl_CIH</th>
<th align="left">Variable</th>
<th align="left">b_intercept</th>
<th align="left">track</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">618.87</td>
<td align="left">654.05</td>
<td align="left">690.07</td>
<td align="left">track:girl</td>
<td align="left">592.97</td>
<td align="left">IT_boy</td>
</tr>
<tr class="even">
<td align="left">564.03</td>
<td align="left">600.34</td>
<td align="left">634.38</td>
<td align="left">track:girl</td>
<td align="left">592.97</td>
<td align="left">BA_boy</td>
</tr>
<tr class="odd">
<td align="left">546.72</td>
<td align="left">585.05</td>
<td align="left">622.35</td>
<td align="left">track:girl</td>
<td align="left">592.97</td>
<td align="left">HRC_boy</td>
</tr>
<tr class="even">
<td align="left">544.03</td>
<td align="left">581.98</td>
<td align="left">619.62</td>
<td align="left">track:girl</td>
<td align="left">592.97</td>
<td align="left">Nur_boy</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sitLie_trackintervention_diamonds_intervention <span class="op">%&gt;%</span><span class="st"> </span>papaja<span class="op">::</span><span class="kw">apa_table</span>()</code></pre></div>
<caption>
(#tab:sitLie-tables)
</caption>
<caption>
**
</caption>
<table>
<thead>
<tr class="header">
<th align="left">sitLie_trackintervention_CIL</th>
<th align="left">sitLie_trackintervention_estimates</th>
<th align="left">sitLie_trackintervention_CIH</th>
<th align="left">Variable</th>
<th align="left">b_intercept</th>
<th align="left">track</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">606.92</td>
<td align="left">644.06</td>
<td align="left">683.47</td>
<td align="left">track:intervention</td>
<td align="left">591.56</td>
<td align="left">IT_intervention</td>
</tr>
<tr class="even">
<td align="left">551.77</td>
<td align="left">587.69</td>
<td align="left">623.31</td>
<td align="left">track:intervention</td>
<td align="left">591.56</td>
<td align="left">BA_intervention</td>
</tr>
<tr class="odd">
<td align="left">568.42</td>
<td align="left">607.23</td>
<td align="left">646.43</td>
<td align="left">track:intervention</td>
<td align="left">591.56</td>
<td align="left">HRC_intervention</td>
</tr>
<tr class="even">
<td align="left">529.46</td>
<td align="left">562.68</td>
<td align="left">595.36</td>
<td align="left">track:intervention</td>
<td align="left">591.56</td>
<td align="left">Nur_intervention</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sitLie_trackintervention_diamonds_control <span class="op">%&gt;%</span><span class="st"> </span>papaja<span class="op">::</span><span class="kw">apa_table</span>()</code></pre></div>
<caption>
(#tab:sitLie-tables)
</caption>
<caption>
**
</caption>
<table>
<thead>
<tr class="header">
<th align="left">sitLie_trackintervention_CIL</th>
<th align="left">sitLie_trackintervention_estimates</th>
<th align="left">sitLie_trackintervention_CIH</th>
<th align="left">Variable</th>
<th align="left">b_intercept</th>
<th align="left">track</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">615.85</td>
<td align="left">652.20</td>
<td align="left">690.52</td>
<td align="left">track:intervention</td>
<td align="left">591.56</td>
<td align="left">IT_control</td>
</tr>
<tr class="even">
<td align="left">550.30</td>
<td align="left">586.30</td>
<td align="left">622.04</td>
<td align="left">track:intervention</td>
<td align="left">591.56</td>
<td align="left">BA_control</td>
</tr>
<tr class="odd">
<td align="left">503.75</td>
<td align="left">539.06</td>
<td align="left">573.92</td>
<td align="left">track:intervention</td>
<td align="left">591.56</td>
<td align="left">HRC_control</td>
</tr>
<tr class="even">
<td align="left">503.82</td>
<td align="left">540.05</td>
<td align="left">575.35</td>
<td align="left">track:intervention</td>
<td align="left">591.56</td>
<td align="left">Nur_control</td>
</tr>
</tbody>
</table>
<div id="basic-observed-characteristics" class="section level4">
<h4>Basic observed characteristics</h4>
<p>NOTE: These values do not account for clustering.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(sitLieAccelerometer_T1, girl, track) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(girl, track) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarise</span>(<span class="dt">mean =</span> <span class="kw">mean</span>(sitLieAccelerometer_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),
            <span class="dt">median =</span> <span class="kw">median</span>(sitLieAccelerometer_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),
            <span class="dt">max =</span> <span class="kw">max</span>(sitLieAccelerometer_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),
            <span class="dt">min =</span> <span class="kw">min</span>(sitLieAccelerometer_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),
            <span class="dt">sd =</span> <span class="kw">sd</span>(sitLieAccelerometer_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),
            <span class="dt">n =</span> <span class="kw">n</span>()) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>papaja<span class="op">::</span><span class="kw">apa_table</span>()</code></pre></div>
<caption>
(#tab:uncorrected-means-cis)
</caption>
<caption>
**
</caption>
<table>
<thead>
<tr class="header">
<th align="left">girl</th>
<th align="left">track</th>
<th align="left">mean</th>
<th align="left">median</th>
<th align="left">max</th>
<th align="left">min</th>
<th align="left">sd</th>
<th align="left">n</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">girl</td>
<td align="left">Other</td>
<td align="left">578.02</td>
<td align="left">504.30</td>
<td align="left">936.09</td>
<td align="left">415.12</td>
<td align="left">150.09</td>
<td align="left">17.00</td>
</tr>
<tr class="even">
<td align="left">girl</td>
<td align="left">IT</td>
<td align="left">631.54</td>
<td align="left">610.68</td>
<td align="left">754.74</td>
<td align="left">508.93</td>
<td align="left">69.75</td>
<td align="left">26.00</td>
</tr>
<tr class="odd">
<td align="left">girl</td>
<td align="left">BA</td>
<td align="left">568.79</td>
<td align="left">558.01</td>
<td align="left">862.49</td>
<td align="left">406.08</td>
<td align="left">96.17</td>
<td align="left">110.00</td>
</tr>
<tr class="even">
<td align="left">girl</td>
<td align="left">HRC</td>
<td align="left">542.16</td>
<td align="left">538.65</td>
<td align="left">913.08</td>
<td align="left">304.76</td>
<td align="left">100.90</td>
<td align="left">129.00</td>
</tr>
<tr class="odd">
<td align="left">girl</td>
<td align="left">Nur</td>
<td align="left">548.65</td>
<td align="left">544.53</td>
<td align="left">827.02</td>
<td align="left">309.10</td>
<td align="left">79.65</td>
<td align="left">331.00</td>
</tr>
<tr class="even">
<td align="left">boy</td>
<td align="left">Other</td>
<td align="left">692.44</td>
<td align="left">722.80</td>
<td align="left">779.34</td>
<td align="left">591.00</td>
<td align="left">79.31</td>
<td align="left">7.00</td>
</tr>
<tr class="odd">
<td align="left">boy</td>
<td align="left">IT</td>
<td align="left">657.61</td>
<td align="left">653.40</td>
<td align="left">894.76</td>
<td align="left">419.27</td>
<td align="left">89.30</td>
<td align="left">137.00</td>
</tr>
<tr class="even">
<td align="left">boy</td>
<td align="left">BA</td>
<td align="left">600.69</td>
<td align="left">592.38</td>
<td align="left">806.06</td>
<td align="left">419.20</td>
<td align="left">88.61</td>
<td align="left">172.00</td>
</tr>
<tr class="odd">
<td align="left">boy</td>
<td align="left">HRC</td>
<td align="left">584.62</td>
<td align="left">564.38</td>
<td align="left">854.14</td>
<td align="left">371.42</td>
<td align="left">96.97</td>
<td align="left">84.00</td>
</tr>
<tr class="even">
<td align="left">boy</td>
<td align="left">Nur</td>
<td align="left">580.91</td>
<td align="left">563.03</td>
<td align="left">900.57</td>
<td align="left">411.67</td>
<td align="left">88.73</td>
<td align="left">71.00</td>
</tr>
<tr class="odd">
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">617.70</td>
<td align="left">643.89</td>
<td align="left">815.28</td>
<td align="left">420.07</td>
<td align="left">120.44</td>
<td align="left">81.00</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">  

df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(sitLieAccelerometer_T1, girl, track) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(girl) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarise</span>(<span class="dt">mean =</span> <span class="kw">mean</span>(sitLieAccelerometer_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),
            <span class="dt">median =</span> <span class="kw">median</span>(sitLieAccelerometer_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),
            <span class="dt">max =</span> <span class="kw">max</span>(sitLieAccelerometer_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),
            <span class="dt">min =</span> <span class="kw">min</span>(sitLieAccelerometer_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),
            <span class="dt">sd =</span> <span class="kw">sd</span>(sitLieAccelerometer_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),
            <span class="dt">n =</span> <span class="kw">n</span>()) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>papaja<span class="op">::</span><span class="kw">apa_table</span>()</code></pre></div>
<caption>
(#tab:uncorrected-means-cis)
</caption>
<caption>
**
</caption>
<table>
<thead>
<tr class="header">
<th align="left">girl</th>
<th align="left">mean</th>
<th align="left">median</th>
<th align="left">max</th>
<th align="left">min</th>
<th align="left">sd</th>
<th align="left">n</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">girl</td>
<td align="left">554.92</td>
<td align="left">548.92</td>
<td align="left">936.09</td>
<td align="left">304.76</td>
<td align="left">90.89</td>
<td align="left">613.00</td>
</tr>
<tr class="even">
<td align="left">boy</td>
<td align="left">612.46</td>
<td align="left">612.38</td>
<td align="left">900.57</td>
<td align="left">371.42</td>
<td align="left">95.62</td>
<td align="left">471.00</td>
</tr>
<tr class="odd">
<td align="left">NA</td>
<td align="left">617.70</td>
<td align="left">643.89</td>
<td align="left">815.28</td>
<td align="left">420.07</td>
<td align="left">120.44</td>
<td align="left">81.00</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(sitLieAccelerometer_T1, intervention, track) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(intervention, track) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarise</span>(<span class="dt">mean =</span> <span class="kw">mean</span>(sitLieAccelerometer_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),
            <span class="dt">median =</span> <span class="kw">median</span>(sitLieAccelerometer_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),
            <span class="dt">max =</span> <span class="kw">max</span>(sitLieAccelerometer_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),
            <span class="dt">min =</span> <span class="kw">min</span>(sitLieAccelerometer_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),
            <span class="dt">sd =</span> <span class="kw">sd</span>(sitLieAccelerometer_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),
            <span class="dt">n =</span> <span class="kw">n</span>()) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>papaja<span class="op">::</span><span class="kw">apa_table</span>()</code></pre></div>
<caption>
(#tab:uncorrected-means-cis)
</caption>
<caption>
**
</caption>
<table>
<thead>
<tr class="header">
<th align="left">intervention</th>
<th align="left">track</th>
<th align="left">mean</th>
<th align="left">median</th>
<th align="left">max</th>
<th align="left">min</th>
<th align="left">sd</th>
<th align="left">n</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">0</td>
<td align="left">Other</td>
<td align="left">595.48</td>
<td align="left">591.00</td>
<td align="left">779.34</td>
<td align="left">470.94</td>
<td align="left">116.88</td>
<td align="left">14.00</td>
</tr>
<tr class="even">
<td align="left">0</td>
<td align="left">IT</td>
<td align="left">657.28</td>
<td align="left">651.21</td>
<td align="left">894.76</td>
<td align="left">480.84</td>
<td align="left">84.52</td>
<td align="left">87.00</td>
</tr>
<tr class="odd">
<td align="left">0</td>
<td align="left">BA</td>
<td align="left">585.96</td>
<td align="left">592.68</td>
<td align="left">862.49</td>
<td align="left">406.08</td>
<td align="left">89.37</td>
<td align="left">131.00</td>
</tr>
<tr class="even">
<td align="left">0</td>
<td align="left">HRC</td>
<td align="left">536.78</td>
<td align="left">536.66</td>
<td align="left">913.08</td>
<td align="left">304.76</td>
<td align="left">99.48</td>
<td align="left">146.00</td>
</tr>
<tr class="odd">
<td align="left">0</td>
<td align="left">Nur</td>
<td align="left">537.52</td>
<td align="left">531.78</td>
<td align="left">827.02</td>
<td align="left">309.10</td>
<td align="left">85.30</td>
<td align="left">125.00</td>
</tr>
<tr class="even">
<td align="left">1</td>
<td align="left">Other</td>
<td align="left">637.29</td>
<td align="left">652.88</td>
<td align="left">936.09</td>
<td align="left">415.12</td>
<td align="left">172.85</td>
<td align="left">10.00</td>
</tr>
<tr class="odd">
<td align="left">1</td>
<td align="left">IT</td>
<td align="left">648.41</td>
<td align="left">651.20</td>
<td align="left">828.09</td>
<td align="left">419.27</td>
<td align="left">88.55</td>
<td align="left">76.00</td>
</tr>
<tr class="even">
<td align="left">1</td>
<td align="left">BA</td>
<td align="left">587.59</td>
<td align="left">575.58</td>
<td align="left">806.06</td>
<td align="left">411.60</td>
<td align="left">97.05</td>
<td align="left">151.00</td>
</tr>
<tr class="odd">
<td align="left">1</td>
<td align="left">HRC</td>
<td align="left">608.51</td>
<td align="left">591.17</td>
<td align="left">854.14</td>
<td align="left">435.74</td>
<td align="left">87.38</td>
<td align="left">67.00</td>
</tr>
<tr class="even">
<td align="left">1</td>
<td align="left">Nur</td>
<td align="left">561.97</td>
<td align="left">551.82</td>
<td align="left">900.57</td>
<td align="left">395.25</td>
<td align="left">79.74</td>
<td align="left">277.00</td>
</tr>
<tr class="odd">
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">617.70</td>
<td align="left">643.89</td>
<td align="left">815.28</td>
<td align="left">420.07</td>
<td align="left">120.44</td>
<td align="left">81.00</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(sitLieAccelerometer_T1, intervention, track) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(intervention) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarise</span>(<span class="dt">mean =</span> <span class="kw">mean</span>(sitLieAccelerometer_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),
            <span class="dt">median =</span> <span class="kw">median</span>(sitLieAccelerometer_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),
            <span class="dt">max =</span> <span class="kw">max</span>(sitLieAccelerometer_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),
            <span class="dt">min =</span> <span class="kw">min</span>(sitLieAccelerometer_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),
            <span class="dt">sd =</span> <span class="kw">sd</span>(sitLieAccelerometer_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),
            <span class="dt">n =</span> <span class="kw">n</span>()) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>papaja<span class="op">::</span><span class="kw">apa_table</span>()</code></pre></div>
<caption>
(#tab:uncorrected-means-cis)
</caption>
<caption>
**
</caption>
<table>
<thead>
<tr class="header">
<th align="left">intervention</th>
<th align="left">mean</th>
<th align="left">median</th>
<th align="left">max</th>
<th align="left">min</th>
<th align="left">sd</th>
<th align="left">n</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">0</td>
<td align="left">568.50</td>
<td align="left">562.07</td>
<td align="left">913.08</td>
<td align="left">304.76</td>
<td align="left">100.94</td>
<td align="left">503.00</td>
</tr>
<tr class="even">
<td align="left">1</td>
<td align="left">585.91</td>
<td align="left">574.45</td>
<td align="left">936.09</td>
<td align="left">395.25</td>
<td align="left">92.67</td>
<td align="left">581.00</td>
</tr>
<tr class="odd">
<td align="left">NA</td>
<td align="left">617.70</td>
<td align="left">643.89</td>
<td align="left">815.28</td>
<td align="left">420.07</td>
<td align="left">120.44</td>
<td align="left">81.00</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="draw-plot-time-spent-sitting-or-lying-down" class="section level3">
<h3>Draw plot: time spent sitting or lying down</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
plot1 &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(id,
                              <span class="dt">track =</span> track,
                              girl,
                              <span class="dt">PA =</span> sitLieAccelerometer_T1)  <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(track), track <span class="op">!=</span><span class="st"> &quot;Other&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># Drop category &quot;Other&quot;</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">track =</span> <span class="kw">factor</span>(track, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;IT&quot;</span>, <span class="st">&quot;BA&quot;</span>, <span class="st">&quot;HRC&quot;</span>, <span class="st">&quot;Nur&quot;</span>)),
                <span class="dt">track =</span> <span class="kw">recode_factor</span>(track, <span class="st">&quot;IT&quot;</span> =<span class="st"> &quot;IT&quot;</span>, <span class="st">&quot;BA&quot;</span> =<span class="st"> &quot;BA&quot;</span>, 
                                      <span class="st">&quot;HRC&quot;</span> =<span class="st"> &quot;HRC&quot;</span>, <span class="st">&quot;Nur&quot;</span> =<span class="st"> &quot;Nur&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>ggplot2<span class="op">::</span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">y =</span> track)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">geom_density_ridges2</span>(<span class="kw">aes</span>(<span class="dt">x =</span> PA, <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>, 
                                    <span class="dt">fill =</span> <span class="kw">paste</span>(track, girl),
                                    <span class="dt">point_color =</span> girl,
                                    <span class="dt">point_fill =</span> girl,
                                    <span class="dt">point_shape =</span> girl),
                                  <span class="dt">scale =</span> .<span class="dv">75</span>, <span class="dt">alpha =</span> <span class="fl">0.6</span>, <span class="dt">size =</span> <span class="fl">0.25</span>,
                                  <span class="dt">position =</span> <span class="kw">position_raincloud</span>(<span class="dt">width =</span> <span class="fl">0.05</span>, <span class="dt">height =</span> <span class="fl">0.15</span>),
                                  <span class="co"># from = 0, to = 450,</span>
                                  <span class="dt">jittered_points =</span> <span class="ot">TRUE</span>,
                                  <span class="dt">point_size =</span> <span class="dv">1</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="ot">NULL</span>,
       <span class="dt">y =</span> <span class="ot">NULL</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_discrete</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.1</span>, <span class="dv">0</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_fill_cyclical</span>(
                                <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&#39;BA boy&#39;</span> =<span class="st"> &quot;Boy&quot;</span>, <span class="st">&#39;BA girl&#39;</span> =<span class="st"> &quot;Girl&quot;</span>),
                                <span class="dt">values =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>)],
                                <span class="dt">name =</span> <span class="st">&quot;&quot;</span>, 
                                <span class="dt">guide =</span> <span class="kw">guide_legend</span>(<span class="dt">override.aes =</span> <span class="kw">list</span>(<span class="dt">alpha =</span> <span class="dv">1</span>, 
                                                                         <span class="dt">point_shape =</span> <span class="kw">c</span>(<span class="dv">24</span>, <span class="dv">4</span>),
                                                                         <span class="dt">point_size =</span> <span class="dv">2</span>))) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_colour_cyclical</span>(<span class="dt">values =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">theme_ridges</span>(<span class="dt">grid =</span> <span class="ot">FALSE</span>) <span class="op">+</span>
<span class="st">  </span><span class="co"># ggplot2::scale_fill_manual(values = c(&quot;#A0FFA0&quot;, &quot;#A0A0FF&quot;)) +</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_discrete_manual</span>(<span class="dt">aesthetics =</span> <span class="st">&quot;point_color&quot;</span>, 
                                  <span class="dt">values =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">1</span>)],
                                  <span class="dt">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_discrete_manual</span>(<span class="dt">aesthetics =</span> <span class="st">&quot;point_fill&quot;</span>,
                                  <span class="dt">values =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">1</span>)],
                                  <span class="dt">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_discrete_manual</span>(<span class="dt">aesthetics =</span> <span class="st">&quot;point_shape&quot;</span>, 
                                  <span class="dt">values =</span> <span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">24</span>),
                                  <span class="dt">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>papaja<span class="op">::</span><span class="kw">theme_apa</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)

plot1 &lt;-<span class="st"> </span>plot1 <span class="op">+</span><span class="st"> </span>
<span class="st">  </span>userfriendlyscience<span class="op">::</span><span class="kw">diamondPlot</span>(sitLie_trackgirl_diamonds_girl, 
                                   <span class="dt">returnLayerOnly =</span> <span class="ot">TRUE</span>, 
                                   <span class="dt">lineColor =</span> <span class="st">&quot;black&quot;</span>, 
                                   <span class="dt">color=</span>viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">3</span>],
                                   <span class="dt">alpha=</span>.<span class="dv">6</span>, 
                                   <span class="dt">fixedSize =</span> <span class="fl">0.1</span>, 
                                   <span class="dt">otherAxisCol =</span> (<span class="dv">1</span><span class="op">:</span><span class="dv">4</span> <span class="op">+</span><span class="st"> </span>.<span class="dv">15</span>)) <span class="op">+</span><span class="st"> </span><span class="co"># specify y-position; option to move the diamond </span>
<span class="st">  </span>userfriendlyscience<span class="op">::</span><span class="kw">diamondPlot</span>(sitLie_trackgirl_diamonds_boy, 
                                   <span class="dt">returnLayerOnly =</span> <span class="ot">TRUE</span>, 
                                   <span class="dt">lineColor =</span> <span class="st">&quot;black&quot;</span>, 
                                   <span class="dt">linetype =</span> <span class="st">&quot;solid&quot;</span>, 
                                   <span class="dt">color=</span>viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">1</span>],
                                   <span class="dt">alpha=</span>.<span class="dv">6</span>, 
                                   <span class="dt">fixedSize =</span> <span class="fl">0.1</span>, 
                                   <span class="dt">otherAxisCol =</span> (<span class="dv">1</span><span class="op">:</span><span class="dv">4</span> <span class="op">+</span><span class="st"> </span>.<span class="dv">15</span>))

<span class="co"># Draw plot with intervention and control densities</span>

plot2 &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(id,
                              <span class="dt">track =</span> track,
                              intervention,
                              <span class="dt">PA =</span> sitLieAccelerometer_T1)  <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(track), track <span class="op">!=</span><span class="st"> &quot;Other&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># Drop category &quot;Other&quot;</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">track =</span> <span class="kw">factor</span>(track, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;IT&quot;</span>, <span class="st">&quot;BA&quot;</span>, <span class="st">&quot;HRC&quot;</span>, <span class="st">&quot;Nur&quot;</span>)),
                <span class="dt">track =</span> <span class="kw">recode_factor</span>(track, <span class="st">&quot;IT&quot;</span> =<span class="st"> &quot;IT&quot;</span>, <span class="st">&quot;BA&quot;</span> =<span class="st"> &quot;BA&quot;</span>, 
                                      <span class="st">&quot;HRC&quot;</span> =<span class="st"> &quot;HRC&quot;</span>, <span class="st">&quot;Nur&quot;</span> =<span class="st"> &quot;Nur&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>ggplot2<span class="op">::</span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">y =</span> track)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">geom_density_ridges2</span>(<span class="kw">aes</span>(<span class="dt">x =</span> PA, <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>, 
                                    <span class="dt">fill =</span> <span class="kw">paste</span>(track, intervention),
                                    <span class="dt">point_color =</span> intervention,
                                    <span class="dt">point_fill =</span> intervention,
                                    <span class="dt">point_shape =</span> intervention),
                                  <span class="dt">scale =</span> .<span class="dv">75</span>, <span class="dt">alpha =</span> <span class="fl">0.6</span>, <span class="dt">size =</span> <span class="fl">0.25</span>,
                                  <span class="dt">position =</span> <span class="kw">position_raincloud</span>(<span class="dt">width =</span> <span class="fl">0.05</span>, <span class="dt">height =</span> <span class="fl">0.15</span>),
                                  <span class="co"># from = 0, to = 450,</span>
                                  <span class="dt">jittered_points =</span> <span class="ot">TRUE</span>,
                                  <span class="dt">point_size =</span> <span class="dv">1</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="ot">NULL</span>,
       <span class="dt">y =</span> <span class="ot">NULL</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_discrete</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.1</span>, <span class="dv">0</span>), <span class="dt">labels =</span> <span class="ot">NULL</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_fill_cyclical</span>(
                                <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&#39;BA 0&#39;</span> =<span class="st"> &quot;Control&quot;</span>, <span class="st">&#39;BA 1&#39;</span> =<span class="st"> &quot;Intervention&quot;</span>),
                                <span class="dt">values =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">4</span>)],
                                <span class="dt">name =</span> <span class="st">&quot;&quot;</span>, 
                                <span class="dt">guide =</span> <span class="kw">guide_legend</span>(<span class="dt">override.aes =</span> <span class="kw">list</span>(<span class="dt">alpha =</span> <span class="dv">1</span>, 
                                                                         <span class="dt">point_shape =</span> <span class="kw">c</span>(<span class="dv">21</span>, <span class="dv">3</span>),
                                                                         <span class="dt">point_size =</span> <span class="dv">2</span>))) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_colour_cyclical</span>(<span class="dt">values =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">theme_ridges</span>(<span class="dt">grid =</span> <span class="ot">FALSE</span>) <span class="op">+</span>
<span class="st">  </span><span class="co"># ggplot2::scale_fill_manual(values = c(&quot;#A0FFA0&quot;, &quot;#A0A0FF&quot;)) +</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_discrete_manual</span>(<span class="dt">aesthetics =</span> <span class="st">&quot;point_color&quot;</span>, 
                                  <span class="dt">values =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">4</span>)],
                                  <span class="dt">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_discrete_manual</span>(<span class="dt">aesthetics =</span> <span class="st">&quot;point_fill&quot;</span>,
                                  <span class="dt">values =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">4</span>)],
                                  <span class="dt">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_discrete_manual</span>(<span class="dt">aesthetics =</span> <span class="st">&quot;point_shape&quot;</span>, 
                                  <span class="dt">values =</span> <span class="kw">c</span>(<span class="dv">21</span>, <span class="dv">3</span>),
                                  <span class="dt">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>papaja<span class="op">::</span><span class="kw">theme_apa</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)

plot2 &lt;-<span class="st"> </span>plot2 <span class="op">+</span><span class="st"> </span>
<span class="st">  </span>userfriendlyscience<span class="op">::</span><span class="kw">diamondPlot</span>(sitLie_trackintervention_diamonds_intervention, 
                                   <span class="dt">returnLayerOnly =</span> <span class="ot">TRUE</span>, 
                                   <span class="dt">lineColor =</span> <span class="st">&quot;black&quot;</span>,  
                                   <span class="dt">color=</span>viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">4</span>],
                                   <span class="dt">alpha=</span>.<span class="dv">6</span>, 
                                   <span class="dt">fixedSize =</span> <span class="fl">0.1</span>, 
                                   <span class="dt">otherAxisCol =</span> (<span class="dv">1</span><span class="op">:</span><span class="dv">4</span> <span class="op">+</span><span class="st"> </span>.<span class="dv">15</span>)) <span class="op">+</span>
<span class="st">  </span>userfriendlyscience<span class="op">::</span><span class="kw">diamondPlot</span>(sitLie_trackintervention_diamonds_control, 
                                   <span class="dt">returnLayerOnly =</span> <span class="ot">TRUE</span>, 
                                   <span class="dt">lineColor =</span> <span class="st">&quot;black&quot;</span>,  
                                   <span class="dt">color=</span>viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">2</span>],
                                   <span class="dt">alpha=</span>.<span class="dv">6</span>, 
                                   <span class="dt">fixedSize =</span> <span class="fl">0.1</span>, 
                                   <span class="dt">otherAxisCol =</span> (<span class="dv">1</span><span class="op">:</span><span class="dv">4</span> <span class="op">+</span><span class="st"> </span>.<span class="dv">15</span>))

plot1 <span class="op">+</span><span class="st"> </span>plot2
## Picking joint bandwidth of 29.7
## Warning: Removed 370 rows containing non-finite values
## (stat_density_ridges).
## Picking joint bandwidth of 29.5
## Warning: Removed 370 rows containing non-finite values
## (stat_density_ridges).</code></pre></div>
<p><img src="baseline-supplement_files/figure-html/sitLie-accelerometer-plot-1.png" width="672" /></p>
<div id="check-for-plot-correctness" class="section level4">
<h4>Check for plot correctness</h4>
<p>Show gender and group allocation of maximum and minimum values for each track.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(sitLieAccelerometer_T1, girl, intervention, track) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">group_by</span>(track) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">arrange</span>((sitLieAccelerometer_T1), <span class="dt">.by_group =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">na.omit</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">!=</span><span class="st"> &quot;Other&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(sitLieAccelerometer_T1 <span class="op">==</span><span class="st"> </span><span class="kw">max</span>(sitLieAccelerometer_T1) <span class="op">|</span><span class="st"> </span>sitLieAccelerometer_T1 <span class="op">==</span><span class="st"> </span><span class="kw">min</span>(sitLieAccelerometer_T1)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>papaja<span class="op">::</span><span class="kw">apa_table</span>()</code></pre></div>
<caption>
(#tab:sitLie-accelerometer-check)
</caption>
<caption>
**
</caption>
<table>
<thead>
<tr class="header">
<th align="left">sitLieAccelerometer_T1</th>
<th align="left">girl</th>
<th align="left">intervention</th>
<th align="left">track</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">419.27</td>
<td align="left">boy</td>
<td align="left">1</td>
<td align="left">IT</td>
</tr>
<tr class="even">
<td align="left">894.76</td>
<td align="left">boy</td>
<td align="left">0</td>
<td align="left">IT</td>
</tr>
<tr class="odd">
<td align="left">406.08</td>
<td align="left">girl</td>
<td align="left">0</td>
<td align="left">BA</td>
</tr>
<tr class="even">
<td align="left">862.49</td>
<td align="left">girl</td>
<td align="left">0</td>
<td align="left">BA</td>
</tr>
<tr class="odd">
<td align="left">304.76</td>
<td align="left">girl</td>
<td align="left">0</td>
<td align="left">HRC</td>
</tr>
<tr class="even">
<td align="left">913.08</td>
<td align="left">girl</td>
<td align="left">0</td>
<td align="left">HRC</td>
</tr>
<tr class="odd">
<td align="left">309.10</td>
<td align="left">girl</td>
<td align="left">0</td>
<td align="left">Nur</td>
</tr>
<tr class="even">
<td align="left">900.57</td>
<td align="left">boy</td>
<td align="left">1</td>
<td align="left">Nur</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="mvpa-girls-and-boys-in-different-educational-tracks-and-schools" class="section level3">
<h3>MVPA, girls and boys in different educational tracks and schools</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(paAccelerometer_T1, girl, trackSchool) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(girl, trackSchool) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarise</span>(<span class="dt">mean =</span> <span class="kw">mean</span>(paAccelerometer_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),
            <span class="dt">median =</span> <span class="kw">median</span>(paAccelerometer_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),
            <span class="dt">max =</span> <span class="kw">max</span>(paAccelerometer_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),
            <span class="dt">min =</span> <span class="kw">min</span>(paAccelerometer_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),
            <span class="dt">sd =</span> <span class="kw">sd</span>(paAccelerometer_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),
            <span class="dt">n =</span> <span class="kw">n</span>()) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>papaja<span class="op">::</span><span class="kw">apa_table</span>()
## &lt;caption&gt;(\#tab:mvpa-trackschool-tables)&lt;/caption&gt;
## 
## &lt;caption&gt;**&lt;/caption&gt;
## 
## 
## 
## girl   trackSchool   mean     median   max                         min                         sd      n      
## -----  ------------  -------  -------  --------------------------  --------------------------  ------  -------
## girl   BA1           179.11   171.72   284.48                      99.14                       42.69   56.00  
## girl   BA2           179.11   185.75   288.42                      71.20                       44.95   53.00  
## girl   BA4           NA       NA       \$\textbackslash{}infty\$   \$\textbackslash{}infty\$   NA      1.00   
## girl   HRC1          169.16   176.08   290.19                      76.04                       52.55   39.00  
## girl   HRC5          191.11   182.47   367.21                      106.15                      47.83   90.00  
## girl   IT1           134.11   135.48   197.40                      76.15                       48.38   12.00  
## girl   IT2           113.80   113.79   178.38                      75.67                       27.05   14.00  
## girl   Nur3          198.28   203.18   307.55                      92.13                       48.35   104.00 
## girl   Nur4          202.73   200.88   338.75                      103.65                      43.33   227.00 
## girl   Other1        141.59   141.59   141.59                      141.59                      NA      1.00   
## girl   Other3        193.62   186.85   243.79                      157.00                      39.27   7.00   
## girl   Other4        189.89   201.17   264.47                      101.65                      64.33   7.00   
## girl   Other5        197.85   197.85   197.85                      197.85                      NA      2.00   
## boy    BA1           181.62   193.66   284.19                      83.22                       53.56   93.00  
## boy    BA2           178.39   169.06   273.18                      91.70                       51.29   78.00  
## boy    BA4           NA       NA       \$\textbackslash{}infty\$   \$\textbackslash{}infty\$   NA      1.00   
## boy    HRC1          187.73   184.91   320.24                      109.12                      65.84   28.00  
## boy    HRC2          NA       NA       \$\textbackslash{}infty\$   \$\textbackslash{}infty\$   NA      1.00   
## boy    HRC5          175.26   174.41   297.56                      66.49                       51.45   55.00  
## boy    IT1           145.83   136.50   366.98                      69.84                       57.56   64.00  
## boy    IT2           145.48   139.87   284.10                      67.57                       49.30   73.00  
## boy    Nur2          210.41   210.41   210.41                      210.41                      NA      1.00   
## boy    Nur3          180.95   169.94   263.48                      85.78                       51.50   20.00  
## boy    Nur4          207.46   205.78   342.36                      61.52                       70.35   50.00  
## boy    Other2        104.48   104.48   135.57                      73.39                       43.97   3.00   
## boy    Other3        262.07   262.07   262.07                      262.07                      NA      1.00   
## boy    Other4        219.71   219.71   219.71                      219.71                      NA      2.00   
## boy    Other5        217.43   217.43   217.43                      217.43                      NA      1.00   
## NA     NANA          193.57   161.65   291.34                      137.60                      65.91   81.00

df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(paAccelerometer_T1, girl, trackSchool) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(girl) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarise</span>(<span class="dt">mean =</span> <span class="kw">mean</span>(paAccelerometer_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),
            <span class="dt">median =</span> <span class="kw">median</span>(paAccelerometer_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),
            <span class="dt">max =</span> <span class="kw">max</span>(paAccelerometer_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),
            <span class="dt">min =</span> <span class="kw">min</span>(paAccelerometer_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),
            <span class="dt">sd =</span> <span class="kw">sd</span>(paAccelerometer_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),
            <span class="dt">n =</span> <span class="kw">n</span>()) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>papaja<span class="op">::</span><span class="kw">apa_table</span>()
## &lt;caption&gt;(\#tab:mvpa-trackschool-tables)&lt;/caption&gt;
## 
## &lt;caption&gt;**&lt;/caption&gt;
## 
## 
## 
## girl   mean     median   max      min      sd      n      
## -----  -------  -------  -------  -------  ------  -------
## girl   190.36   189.19   367.21   71.20    48.60   613.00 
## boy    173.55   164.66   366.98   61.52    59.39   471.00 
## NA     193.57   161.65   291.34   137.60   65.91   81.00</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
plot1 &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(id,
                              <span class="dt">trackSchool =</span> trackSchool,
                              girl,
                              <span class="dt">PA =</span> paAccelerometer_T1)  <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(trackSchool), <span class="op">!</span><span class="kw">grepl</span>(<span class="st">&#39;Other|NANA|BA4|HRC2|Nur2&#39;</span>, trackSchool)) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># Drop categories with just few participants</span>
<span class="st">  </span>ggplot2<span class="op">::</span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">y =</span> trackSchool)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">geom_density_ridges2</span>(<span class="kw">aes</span>(<span class="dt">x =</span> PA, <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>, 
                                    <span class="dt">fill =</span> <span class="kw">paste</span>(trackSchool, girl)),
                                  <span class="dt">scale =</span> <span class="dv">1</span>,
                                  <span class="dt">alpha =</span> <span class="fl">0.6</span>, <span class="dt">size =</span> <span class="fl">0.25</span>,
                                  <span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">450</span>,
                                  <span class="dt">jittered_points=</span><span class="ot">TRUE</span>, <span class="dt">point_shape=</span><span class="dv">21</span>,
                                  <span class="dt">point_fill=</span><span class="st">&quot;black&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;&quot;</span>,
       <span class="dt">y =</span> <span class="st">&quot;&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_discrete</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_fill_cyclical</span>(
                                <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&#39;BA1 boy&#39;</span> =<span class="st"> &quot;Boy&quot;</span>, <span class="st">&#39;BA1 girl&#39;</span> =<span class="st"> &quot;Girl&quot;</span>),
                                <span class="dt">values =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>)],
                                <span class="dt">name =</span> <span class="st">&quot;&quot;</span>, <span class="dt">guide =</span> <span class="kw">guide_legend</span>(<span class="dt">override.aes =</span> <span class="kw">list</span>(<span class="dt">alpha =</span> <span class="dv">1</span>))) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_colour_cyclical</span>(<span class="dt">values =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">theme_ridges</span>(<span class="dt">grid =</span> <span class="ot">FALSE</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">&quot;bottom&quot;</span>, <span class="dt">axis.text=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">10</span>))

plot1
## Picking joint bandwidth of 20.3
## Warning: Removed 367 rows containing non-finite values
## (stat_density_ridges).</code></pre></div>
<p><img src="baseline-supplement_files/figure-html/mvpa-trackshool-density-1.png" width="672" /></p>
</div>
</div>
</div>
<div id="pa-determinants" class="section level1">
<h1>PA Determinants</h1>
<p>This section reports various hypothesised determinants of physical activity.</p>
<div id="simple-diamond-plots" class="section level2">
<h2>Simple diamond plots</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">PA_ci_girls &lt;-<span class="st"> </span>ci_girls <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(diamondlabels <span class="op">%in%</span><span class="st"> </span><span class="kw">names</span>(scales_T1) <span class="op">&amp;</span><span class="st"> </span><span class="kw">grepl</span>(<span class="st">&quot;PA_&quot;</span>, diamondlabels) <span class="op">&amp;</span><span class="st"> </span><span class="op">!</span><span class="kw">grepl</span>(<span class="st">&quot;bct&quot;</span>, diamondlabels))

PA_ci_boys &lt;-<span class="st"> </span>ci_boys <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(diamondlabels <span class="op">%in%</span><span class="st"> </span><span class="kw">names</span>(scales_T1) <span class="op">&amp;</span><span class="st"> </span><span class="kw">grepl</span>(<span class="st">&quot;PA_&quot;</span>, diamondlabels) <span class="op">&amp;</span><span class="st"> </span><span class="op">!</span><span class="kw">grepl</span>(<span class="st">&quot;bct&quot;</span>, diamondlabels))

PA_ci_intervention &lt;-<span class="st"> </span>ci_intervention <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(diamondlabels <span class="op">%in%</span><span class="st"> </span><span class="kw">names</span>(scales_T1) <span class="op">&amp;</span><span class="st"> </span><span class="kw">grepl</span>(<span class="st">&quot;PA_&quot;</span>, diamondlabels) <span class="op">&amp;</span><span class="st"> </span><span class="op">!</span><span class="kw">grepl</span>(<span class="st">&quot;bct&quot;</span>, diamondlabels))

PA_ci_control &lt;-<span class="st"> </span>ci_control <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(diamondlabels <span class="op">%in%</span><span class="st"> </span><span class="kw">names</span>(scales_T1) <span class="op">&amp;</span><span class="st"> </span><span class="kw">grepl</span>(<span class="st">&quot;PA_&quot;</span>, diamondlabels) <span class="op">&amp;</span><span class="st"> </span><span class="op">!</span><span class="kw">grepl</span>(<span class="st">&quot;bct&quot;</span>, diamondlabels))

ICClabels &lt;-<span class="st"> </span>vardatatable_containing_edutrack <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(Variable <span class="op">%in%</span><span class="st"> </span>PA_ci_control<span class="op">$</span>diamondlabels)

plot1 &lt;-<span class="st"> </span>userfriendlyscience<span class="op">::</span><span class="kw">diamondPlot</span>(PA_ci_girls, <span class="dt">color =</span> <span class="st">&#39;green&#39;</span>, <span class="dt">alpha=</span>.<span class="dv">3</span>, <span class="dt">yLabels =</span> PA_ci_girls<span class="op">$</span>diamondlabels, <span class="dt">fixedSize =</span> <span class="fl">0.3</span>, <span class="dt">xlab =</span> <span class="ot">NULL</span>) <span class="op">+</span>
<span class="st">  </span>userfriendlyscience<span class="op">::</span><span class="kw">diamondPlot</span>(PA_ci_boys, <span class="dt">returnLayerOnly =</span> <span class="ot">TRUE</span>, <span class="dt">color=</span><span class="st">&#39;blue&#39;</span>, <span class="dt">alpha=</span>.<span class="dv">3</span>, <span class="dt">fixedSize =</span> <span class="fl">0.3</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">7</span>), <span class="dt">breaks =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">7</span>)

plot2 &lt;-<span class="st"> </span>userfriendlyscience<span class="op">::</span><span class="kw">diamondPlot</span>(PA_ci_intervention, <span class="dt">color =</span> <span class="st">&#39;red&#39;</span>, <span class="dt">alpha=</span>.<span class="dv">3</span>, <span class="dt">yLabels =</span> <span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">&quot;&quot;</span>, <span class="kw">length</span>(PA_ci_girls<span class="op">$</span>diamondlabels))), <span class="dt">fixedSize =</span> <span class="fl">0.3</span>, <span class="dt">xlab =</span> <span class="ot">NULL</span>, <span class="dt">ylab =</span> <span class="ot">NULL</span>) <span class="op">+</span>
<span class="st">  </span>userfriendlyscience<span class="op">::</span><span class="kw">diamondPlot</span>(PA_ci_control, <span class="dt">returnLayerOnly =</span> <span class="ot">TRUE</span>, <span class="dt">color=</span><span class="st">&#39;black&#39;</span>, <span class="dt">alpha=</span>.<span class="dv">3</span>, <span class="dt">fixedSize =</span> <span class="fl">0.3</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">7</span>), <span class="dt">breaks =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">7</span>)

grid<span class="op">::</span><span class="kw">grid.newpage</span>()
grid<span class="op">::</span><span class="kw">grid.draw</span>(<span class="kw">cbind</span>(ggplot2<span class="op">::</span><span class="kw">ggplotGrob</span>(plot1), ggplot2<span class="op">::</span><span class="kw">ggplotGrob</span>(plot2), <span class="dt">size =</span> <span class="st">&quot;first&quot;</span>))</code></pre></div>
<p><img src="baseline-supplement_files/figure-html/selfrep-determinants-simple-diamondplot-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># dat2 &lt;- data.frame(ciLo = c(3, 2), mean = c(4, 2.5), ciHi = c(6, 3));</span>
<span class="co"># userfriendlyscience::diamondPlot(dat1, color = &#39;blue&#39;, alpha=.3, yLabels = dat1$diamondlabels) +</span>
<span class="co"># userfriendlyscience::diamondPlot(dat2, returnLayerOnly = TRUE, color=&#39;red&#39;, alpha=.3)</span>
 </code></pre></div>
<p>Note: action and coping planning on a scale from 1 to 4.</p>
</div>
<div id="pa-motivation" class="section level2">
<h2>PA motivation</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
plot1 &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(id,
  intervention,
  group,
  school,
  girl,
  <span class="st">&#39;PA autonomous</span><span class="ch">\n</span><span class="st">motivation&#39;</span> =<span class="st"> </span>PA_autonomous_T1,
<span class="st">&#39;PA controlled</span><span class="ch">\n</span><span class="st">motivation&#39;</span> =<span class="st"> </span>PA_controlled_T1,
<span class="st">&#39;PA amotivation&#39;</span> =<span class="st"> </span>PA_amotivation_T1)  <span class="op">%&gt;%</span>
<span class="st">  </span>tidyr<span class="op">::</span><span class="kw">gather</span>(<span class="dt">key =</span> Variable, <span class="dt">value =</span> Value, <span class="dv">6</span><span class="op">:</span><span class="kw">ncol</span>(.), <span class="dt">factor_key =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span>
<span class="st">  </span>ggplot2<span class="op">::</span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">y =</span> Variable)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">geom_density_ridges</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Value,
                                    <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>,
                                    <span class="dt">fill =</span> <span class="kw">paste</span>(Variable, girl),
                                    <span class="dt">point_color =</span> girl,
                                    <span class="dt">point_fill =</span> girl,
                                    <span class="dt">point_shape =</span> girl,
                                    <span class="dt">point_size =</span> girl,
                                    <span class="dt">point_alpha =</span> girl),
                                <span class="dt">scale =</span> <span class="fl">1.16</span>, <span class="dt">alpha =</span> .<span class="dv">6</span>, <span class="dt">size =</span> <span class="fl">0.25</span>,
                                <span class="dt">from =</span> <span class="dv">1</span>, <span class="dt">to =</span> <span class="dv">5</span>,
                                <span class="dt">position =</span> <span class="kw">position_raincloud</span>(<span class="dt">width =</span> <span class="fl">0.03</span>, <span class="dt">height =</span> <span class="fl">0.2</span>),
                                <span class="dt">jittered_points =</span> <span class="ot">TRUE</span>,
                                <span class="dt">point_size =</span> <span class="dv">1</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="ot">NULL</span>,
       <span class="dt">y =</span> <span class="ot">NULL</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_discrete</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_fill_cyclical</span>(
                      <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&#39;PA amotivation boy&#39;</span> =<span class="st"> &quot;Boy&quot;</span>, <span class="st">&#39;PA amotivation girl&#39;</span> =<span class="st"> &quot;Girl&quot;</span>),
                      <span class="dt">values =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>)],
                      <span class="dt">name =</span> <span class="st">&quot;&quot;</span>, 
                      <span class="dt">guide =</span> <span class="kw">guide_legend</span>(<span class="dt">override.aes =</span> <span class="kw">list</span>(<span class="dt">alpha =</span> <span class="dv">1</span>, 
                                                               <span class="dt">point_shape =</span> <span class="kw">c</span>(<span class="dv">24</span>, <span class="dv">25</span>),
                                                               <span class="dt">point_size =</span> <span class="dv">2</span>))) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_colour_cyclical</span>(<span class="dt">values =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">theme_ridges</span>(<span class="dt">grid =</span> <span class="ot">FALSE</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_discrete_manual</span>(<span class="dt">aesthetics =</span> <span class="st">&quot;point_color&quot;</span>, 
                                  <span class="dt">values =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>)],
                                  <span class="dt">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_discrete_manual</span>(<span class="dt">aesthetics =</span> <span class="st">&quot;point_fill&quot;</span>,
                                  <span class="dt">values =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>)],
                                  <span class="dt">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_discrete_manual</span>(<span class="dt">aesthetics =</span> <span class="st">&quot;point_shape&quot;</span>, 
                                  <span class="dt">values =</span> <span class="kw">c</span>(<span class="dv">24</span>, <span class="dv">25</span>),
                                  <span class="dt">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_discrete_manual</span>(<span class="dt">aesthetics =</span> <span class="st">&quot;point_size&quot;</span>, 
                                  <span class="dt">values =</span> <span class="kw">c</span>(.<span class="dv">75</span>, .<span class="dv">75</span>),
                                  <span class="dt">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_discrete_manual</span>(<span class="dt">aesthetics =</span> <span class="st">&quot;point_alpha&quot;</span>, 
                                  <span class="dt">values =</span> <span class="kw">c</span>(<span class="fl">0.3</span>, <span class="fl">0.3</span>),
                                  <span class="dt">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>papaja<span class="op">::</span><span class="kw">theme_apa</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)

target =<span class="st"> </span><span class="kw">c</span>(
<span class="st">&quot;PA_autonomous_T1&quot;</span>,
<span class="st">&quot;PA_controlled_T1&quot;</span>,
<span class="st">&quot;PA_amotivation_T1&quot;</span>)

PA_ci_girls &lt;-<span class="st"> </span>ci_girls <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(diamondlabels <span class="op">%in%</span><span class="st"> </span><span class="kw">names</span>(scales_T1) <span class="op">&amp;</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_autonomous_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_controlled_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_amotivation_T1&quot;</span>, diamondlabels))

PA_ci_girls &lt;-<span class="st"> </span>PA_ci_girls[<span class="kw">match</span>(target, PA_ci_girls<span class="op">$</span>diamondlabels), ]

PA_ci_boys &lt;-<span class="st"> </span>ci_boys <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(diamondlabels <span class="op">%in%</span><span class="st"> </span><span class="kw">names</span>(scales_T1) <span class="op">&amp;</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_autonomous_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_controlled_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_amotivation_T1&quot;</span>, diamondlabels))

PA_ci_boys &lt;-<span class="st"> </span>PA_ci_boys[<span class="kw">match</span>(target, PA_ci_boys<span class="op">$</span>diamondlabels), ]

plot1 &lt;-<span class="st"> </span>plot1 <span class="op">+</span><span class="st"> </span>userfriendlyscience<span class="op">::</span><span class="kw">diamondPlot</span>(PA_ci_girls, <span class="dt">returnLayerOnly =</span> <span class="ot">TRUE</span>, <span class="dt">lineColor =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">color=</span>viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">3</span>], 
                <span class="dt">alpha=</span>.<span class="dv">6</span>, <span class="dt">fixedSize =</span> <span class="fl">0.05</span>, <span class="dt">otherAxisCol =</span> (<span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(target) <span class="op">+</span><span class="st"> </span>.<span class="dv">07</span>)) <span class="op">+</span>
<span class="st">  </span>userfriendlyscience<span class="op">::</span><span class="kw">diamondPlot</span>(PA_ci_boys, <span class="dt">returnLayerOnly =</span> <span class="ot">TRUE</span>, <span class="dt">lineColor =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">linetype =</span> <span class="st">&quot;solid&quot;</span>, <span class="dt">color=</span>viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">1</span>],  
                <span class="dt">alpha=</span>.<span class="dv">6</span>, <span class="dt">fixedSize =</span> <span class="fl">0.05</span>, <span class="dt">otherAxisCol =</span> (<span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(target) <span class="op">+</span><span class="st"> </span>.<span class="dv">07</span>))

plot2 &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(id,
                              intervention,
                              group,
                              school,
                              girl,
                              <span class="st">&#39;PA autonomous</span><span class="ch">\n</span><span class="st">motivation&#39;</span> =<span class="st"> </span>PA_autonomous_T1,
                              <span class="st">&#39;PA controlled</span><span class="ch">\n</span><span class="st">motivation&#39;</span> =<span class="st"> </span>PA_controlled_T1,
                              <span class="st">&#39;PA amotivation&#39;</span> =<span class="st"> </span>PA_amotivation_T1)  <span class="op">%&gt;%</span>
<span class="st">  </span>tidyr<span class="op">::</span><span class="kw">gather</span>(<span class="dt">key =</span> Variable, <span class="dt">value =</span> Value, <span class="dv">6</span><span class="op">:</span><span class="kw">ncol</span>(.), <span class="dt">factor_key =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span>
<span class="st">  </span>ggplot2<span class="op">::</span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">y =</span> Variable)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">geom_density_ridges</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Value,
                                    <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>,
                                    <span class="dt">fill =</span> <span class="kw">paste</span>(Variable, intervention),
                                    <span class="dt">point_color =</span> intervention,
                                    <span class="dt">point_fill =</span> intervention,
                                    <span class="dt">point_shape =</span> intervention,
                                    <span class="dt">point_size =</span> intervention,
                                    <span class="dt">point_alpha =</span> intervention),
                                <span class="dt">scale =</span> <span class="fl">1.16</span>, <span class="dt">alpha =</span> .<span class="dv">6</span>, <span class="dt">size =</span> <span class="fl">0.25</span>,
                                <span class="dt">from =</span> <span class="dv">1</span>, <span class="dt">to =</span> <span class="dv">5</span>,
                                <span class="dt">position =</span> <span class="kw">position_raincloud</span>(<span class="dt">width =</span> <span class="fl">0.03</span>, <span class="dt">height =</span> <span class="fl">0.2</span>),
                                <span class="dt">jittered_points =</span> <span class="ot">TRUE</span>,
                                <span class="dt">point_size =</span> <span class="dv">1</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="ot">NULL</span>,
       <span class="dt">y =</span> <span class="ot">NULL</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_discrete</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_fill_cyclical</span>(
                      <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&#39;PA amotivation 0&#39;</span> =<span class="st"> &quot;Control&quot;</span>, <span class="st">&#39;PA amotivation 1&#39;</span> =<span class="st"> &quot;Intervention&quot;</span>),
                      <span class="dt">values =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">4</span>)],
                      <span class="dt">name =</span> <span class="st">&quot;&quot;</span>, 
                      <span class="dt">guide =</span> <span class="kw">guide_legend</span>(<span class="dt">override.aes =</span> <span class="kw">list</span>(<span class="dt">alpha =</span> <span class="dv">1</span>, 
                                                               <span class="dt">point_shape =</span> <span class="kw">c</span>(<span class="dv">22</span>, <span class="dv">23</span>),
                                                               <span class="dt">point_size =</span> <span class="dv">2</span>))) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_colour_cyclical</span>(<span class="dt">values =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">theme_ridges</span>(<span class="dt">grid =</span> <span class="ot">FALSE</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_discrete_manual</span>(<span class="dt">aesthetics =</span> <span class="st">&quot;point_color&quot;</span>, 
                                  <span class="dt">values =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">4</span>)],
                                  <span class="dt">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_discrete_manual</span>(<span class="dt">aesthetics =</span> <span class="st">&quot;point_fill&quot;</span>,
                                  <span class="dt">values =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">4</span>)],
                                  <span class="dt">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_discrete_manual</span>(<span class="dt">aesthetics =</span> <span class="st">&quot;point_shape&quot;</span>, 
                                  <span class="dt">values =</span> <span class="kw">c</span>(<span class="dv">22</span>, <span class="dv">23</span>),
                                  <span class="dt">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_discrete_manual</span>(<span class="dt">aesthetics =</span> <span class="st">&quot;point_size&quot;</span>, 
                                  <span class="dt">values =</span> <span class="kw">c</span>(.<span class="dv">75</span>, .<span class="dv">75</span>),
                                  <span class="dt">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_discrete_manual</span>(<span class="dt">aesthetics =</span> <span class="st">&quot;point_alpha&quot;</span>, 
                                  <span class="dt">values =</span> <span class="kw">c</span>(<span class="fl">0.3</span>, <span class="fl">0.3</span>),
                                  <span class="dt">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>papaja<span class="op">::</span><span class="kw">theme_apa</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)

PA_ci_intervention &lt;-<span class="st"> </span>ci_intervention <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(diamondlabels <span class="op">%in%</span><span class="st"> </span><span class="kw">names</span>(scales_T1) <span class="op">&amp;</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_autonomous_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_controlled_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_amotivation_T1&quot;</span>, diamondlabels))

PA_ci_intervention &lt;-<span class="st"> </span>PA_ci_intervention[<span class="kw">match</span>(target, PA_ci_intervention<span class="op">$</span>diamondlabels), ]

PA_ci_control &lt;-<span class="st"> </span>ci_control <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(diamondlabels <span class="op">%in%</span><span class="st"> </span><span class="kw">names</span>(scales_T1) <span class="op">&amp;</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_autonomous_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_controlled_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_amotivation_T1&quot;</span>, diamondlabels))

PA_ci_control &lt;-<span class="st"> </span>PA_ci_control[<span class="kw">match</span>(target, PA_ci_control<span class="op">$</span>diamondlabels), ]

plot2 &lt;-<span class="st"> </span>plot2 <span class="op">+</span><span class="st"> </span>
<span class="st">  </span>userfriendlyscience<span class="op">::</span><span class="kw">diamondPlot</span>(PA_ci_intervention, <span class="dt">returnLayerOnly =</span> <span class="ot">TRUE</span>, <span class="dt">lineColor =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">color=</span>viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">4</span>],
              <span class="dt">alpha=</span>.<span class="dv">6</span>, <span class="dt">fixedSize =</span> <span class="fl">0.05</span>, <span class="dt">otherAxisCol =</span> (<span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(target) <span class="op">+</span><span class="st"> </span>.<span class="dv">07</span>)) <span class="op">+</span>
<span class="st">  </span>userfriendlyscience<span class="op">::</span><span class="kw">diamondPlot</span>(PA_ci_control, <span class="dt">returnLayerOnly =</span> <span class="ot">TRUE</span>, <span class="dt">lineColor =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">color=</span>viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">2</span>], 
              <span class="dt">alpha=</span>.<span class="dv">6</span>, <span class="dt">fixedSize =</span> <span class="fl">0.05</span>, <span class="dt">otherAxisCol =</span> (<span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(target) <span class="op">+</span><span class="st"> </span>.<span class="dv">07</span>))

plot1 <span class="op">+</span><span class="st"> </span>plot2 
## Picking joint bandwidth of 0.216
## Warning: Removed 272 rows containing non-finite values
## (stat_density_ridges).
## Picking joint bandwidth of 0.216
## Warning: Removed 272 rows containing non-finite values
## (stat_density_ridges).</code></pre></div>
<p><img src="baseline-supplement_files/figure-html/pa-determinants-motivation-1.png" width="672" /></p>
<p>To check that the labels/colors in diamonds are right, here are means of the variables:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(
  intervention,
  girl,
  <span class="st">&#39;PA autonomous </span><span class="ch">\n</span><span class="st">motivation&#39;</span> =<span class="st"> </span>PA_autonomous_T1,
<span class="st">&#39;PA controlled </span><span class="ch">\n</span><span class="st">motivation&#39;</span> =<span class="st"> </span>PA_controlled_T1,
<span class="st">&#39;PA amotivation&#39;</span> =<span class="st"> </span>PA_amotivation_T1) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(girl) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarise_at</span>(<span class="kw">vars</span>(<span class="kw">contains</span>(<span class="st">&quot;PA&quot;</span>)), <span class="kw">funs</span>(<span class="kw">mean</span>(., <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>papaja<span class="op">::</span><span class="kw">apa_table</span>()</code></pre></div>
<caption>
(#tab:motivationmeans_by_gender_intervention)
</caption>
<caption>
**
</caption>
<p>girl PA autonomous motivation PA controlled motivation PA amotivation —– ————————– ————————– ————— girl 3.37 1.89 1.46<br />
boy 3.47 1.77 1.64<br />
NA NA NA NA</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(
  intervention,
  girl,
  <span class="st">&#39;PA autonomous </span><span class="ch">\n</span><span class="st">motivation&#39;</span> =<span class="st"> </span>PA_autonomous_T1,
<span class="st">&#39;PA controlled </span><span class="ch">\n</span><span class="st">motivation&#39;</span> =<span class="st"> </span>PA_controlled_T1,
<span class="st">&#39;PA amotivation&#39;</span> =<span class="st"> </span>PA_amotivation_T1) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(intervention) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">summarise_at</span>(<span class="kw">vars</span>(<span class="kw">contains</span>(<span class="st">&quot;PA&quot;</span>)), <span class="kw">funs</span>(<span class="kw">mean</span>(., <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>papaja<span class="op">::</span><span class="kw">apa_table</span>()</code></pre></div>
<caption>
(#tab:motivationmeans_by_gender_intervention)
</caption>
<caption>
**
</caption>
<p>intervention PA autonomous motivation PA controlled motivation PA amotivation ————- ————————– ————————– ————— 0 3.47 1.87 1.56<br />
1 3.35 1.80 1.52<br />
NA NA NA NA</p>
</div>
<div id="big-5-personality-traits" class="section level2">
<h2>Big 5 personality traits</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
plot1 &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(id,
  intervention,
  group,
  school,
  girl,
<span class="st">&#39;Agreeableness&#39;</span> =<span class="st"> </span>big5agreeableness_T1,
<span class="st">&#39;Conscientiousness&#39;</span> =<span class="st"> </span>big5conscientiousness_T1,
<span class="st">&#39;Extraversion&#39;</span> =<span class="st"> </span>big5extraversion_T1,
<span class="st">&#39;Neuroticism&#39;</span> =<span class="st"> </span>big5neuroticism_T1,
<span class="st">&#39;Openness&#39;</span> =<span class="st"> </span>big5openness_T1)  <span class="op">%&gt;%</span>
<span class="st">  </span><span class="co"># dplyr::select(noquote(order(colnames(.)))) %&gt;% # Orders columns alphabetically</span>
<span class="st">  </span>tidyr<span class="op">::</span><span class="kw">gather</span>(<span class="dt">key =</span> Variable, <span class="dt">value =</span> Value, <span class="dv">6</span><span class="op">:</span><span class="kw">ncol</span>(.)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>ggplot2<span class="op">::</span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">y =</span> Variable)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">geom_density_ridges</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Value, <span class="dt">fill =</span> <span class="kw">paste</span>(Variable, girl)), 
           <span class="dt">alpha =</span> .<span class="dv">6</span>, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">from =</span> <span class="dv">1</span>, <span class="dt">to =</span> <span class="dv">7</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;&quot;</span>,
       <span class="dt">y =</span> <span class="st">&quot;&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_discrete</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_fill_cyclical</span>(<span class="dt">breaks =</span> <span class="kw">c</span>(<span class="st">&quot;Agreeableness boy&quot;</span>, <span class="st">&quot;Agreeableness girl&quot;</span>),
                      <span class="dt">labels =</span> <span class="kw">c</span>( <span class="st">&#39;Agreeableness boy&#39;</span> =<span class="st"> &quot;Boy&quot;</span>, <span class="st">&#39;Agreeableness girl&#39;</span> =<span class="st"> &quot;Girl&quot;</span>),
                      <span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;#3bc600&quot;</span>, <span class="st">&quot;#0000ff&quot;</span>, <span class="st">&quot;#9cc68b&quot;</span>, <span class="st">&quot;#8080ff&quot;</span>),
                      <span class="dt">name =</span> <span class="st">&quot;&quot;</span>, <span class="dt">guide =</span> <span class="st">&quot;legend&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">theme_ridges</span>(<span class="dt">grid =</span> <span class="ot">FALSE</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">&quot;bottom&quot;</span>)

plot2 &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(id,
  intervention,
  group,
  school,
  girl,
<span class="st">&#39;Agreeableness&#39;</span> =<span class="st"> </span>big5agreeableness_T1,
<span class="st">&#39;Conscientiousness&#39;</span> =<span class="st"> </span>big5conscientiousness_T1,
<span class="st">&#39;Extraversion&#39;</span> =<span class="st"> </span>big5extraversion_T1,
<span class="st">&#39;Neuroticism&#39;</span> =<span class="st"> </span>big5neuroticism_T1,
<span class="st">&#39;Openness&#39;</span> =<span class="st"> </span>big5openness_T1) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="co"># dplyr::select(noquote(order(colnames(.)))) %&gt;% # Orders columns alphabetically</span>
<span class="st">  </span>tidyr<span class="op">::</span><span class="kw">gather</span>(<span class="dt">key =</span> Variable, <span class="dt">value =</span> Value, <span class="dv">6</span><span class="op">:</span><span class="kw">ncol</span>(.)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>ggplot2<span class="op">::</span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">y =</span> Variable)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">geom_density_ridges</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Value, <span class="dt">fill =</span> <span class="kw">paste</span>(Variable, intervention)), 
           <span class="dt">alpha =</span> .<span class="dv">6</span>, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">from =</span> <span class="dv">1</span>, <span class="dt">to =</span> <span class="dv">7</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;&quot;</span>,
       <span class="dt">y =</span> <span class="st">&quot;&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_discrete</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>), <span class="dt">labels =</span> <span class="ot">NULL</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_fill_cyclical</span>(<span class="dt">breaks =</span> <span class="kw">c</span>(<span class="st">&quot;Agreeableness 1&quot;</span>, <span class="st">&quot;Agreeableness 0&quot;</span>),
                      <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&#39;Agreeableness 1&#39;</span> =<span class="st"> &quot;Intervention&quot;</span>, <span class="st">&#39;Agreeableness 0&#39;</span> =<span class="st"> &quot;Control&quot;</span>),
                      <span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;#ff0000&quot;</span>, <span class="st">&quot;#0000ff&quot;</span>, <span class="st">&quot;#ff8080&quot;</span>, <span class="st">&quot;#8080ff&quot;</span>),
                      <span class="dt">name =</span> <span class="st">&quot;&quot;</span>, <span class="dt">guide =</span> <span class="st">&quot;legend&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">theme_ridges</span>(<span class="dt">grid =</span> <span class="ot">FALSE</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">&quot;bottom&quot;</span>)

plot1 <span class="op">+</span><span class="st"> </span>plot2
## Picking joint bandwidth of 0.315
## Warning: Removed 486 rows containing non-finite values
## (stat_density_ridges).
## Picking joint bandwidth of 0.305
## Warning: Removed 486 rows containing non-finite values
## (stat_density_ridges).</code></pre></div>
<p><img src="baseline-supplement_files/figure-html/big5-1.png" width="672" /></p>
</div>
<div id="bct-use" class="section level2">
<h2>BCT use</h2>
<div id="ridge-plots-for-means" class="section level3">
<h3>Ridge plots for means</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
plot1 &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(id,
  intervention,
  group,
  school,
  girl,
<span class="st">&#39;Frequency-</span><span class="ch">\n</span><span class="st">related BCTs&#39;</span> =<span class="st"> </span>PA_frqbct_T1,
<span class="st">&#39;Agreement-</span><span class="ch">\n</span><span class="st">related BCTs&#39;</span> =<span class="st"> </span>PA_agrbct_T1)  <span class="op">%&gt;%</span>
<span class="st">  </span><span class="co"># dplyr::select(noquote(order(colnames(.)))) %&gt;% # Orders columns alphabetically</span>
<span class="st">  </span>tidyr<span class="op">::</span><span class="kw">gather</span>(<span class="dt">key =</span> Variable, <span class="dt">value =</span> Value, <span class="dv">6</span><span class="op">:</span><span class="kw">ncol</span>(.)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>ggplot2<span class="op">::</span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">y =</span> Variable)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">geom_density_ridges</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Value, <span class="dt">fill =</span> <span class="kw">paste</span>(Variable, girl)), 
           <span class="dt">alpha =</span> .<span class="dv">6</span>, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">from =</span> <span class="dv">1</span>, <span class="dt">to =</span> <span class="dv">7</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;&quot;</span>,
       <span class="dt">y =</span> <span class="st">&quot;&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_discrete</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_fill_cyclical</span>(<span class="dt">breaks =</span> <span class="kw">c</span>(<span class="st">&quot;Agreement-</span><span class="ch">\n</span><span class="st">related BCTs boy&quot;</span>, <span class="st">&quot;Agreement-</span><span class="ch">\n</span><span class="st">related BCTs girl&quot;</span>),
                      <span class="dt">labels =</span> <span class="kw">c</span>( <span class="st">&#39;Agreement-</span><span class="ch">\n</span><span class="st">related BCTs boy&#39;</span> =<span class="st"> &quot;Boy&quot;</span>, <span class="st">&#39;Agreement-</span><span class="ch">\n</span><span class="st">related BCTs girl&#39;</span> =<span class="st"> &quot;Girl&quot;</span>),
                      <span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;#3bc600&quot;</span>, <span class="st">&quot;#0000ff&quot;</span>, <span class="st">&quot;#9cc68b&quot;</span>, <span class="st">&quot;#8080ff&quot;</span>),
                      <span class="dt">name =</span> <span class="st">&quot;&quot;</span>, <span class="dt">guide =</span> <span class="st">&quot;legend&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">theme_ridges</span>(<span class="dt">grid =</span> <span class="ot">FALSE</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">&quot;bottom&quot;</span>)

plot2 &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(id,
  intervention,
  group,
  school,
  girl,
<span class="st">&#39;Frequency-</span><span class="ch">\n</span><span class="st">related BCTs&#39;</span> =<span class="st"> </span>PA_frqbct_T1,
<span class="st">&#39;Agreement-</span><span class="ch">\n</span><span class="st">related BCTs&#39;</span> =<span class="st"> </span>PA_agrbct_T1) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="co"># dplyr::select(noquote(order(colnames(.)))) %&gt;% # Orders columns alphabetically</span>
<span class="st">  </span>tidyr<span class="op">::</span><span class="kw">gather</span>(<span class="dt">key =</span> Variable, <span class="dt">value =</span> Value, <span class="dv">6</span><span class="op">:</span><span class="kw">ncol</span>(.)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>ggplot2<span class="op">::</span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">y =</span> Variable)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">geom_density_ridges</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Value, <span class="dt">fill =</span> <span class="kw">paste</span>(Variable, intervention)), 
           <span class="dt">alpha =</span> .<span class="dv">6</span>, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">from =</span> <span class="dv">1</span>, <span class="dt">to =</span> <span class="dv">7</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;&quot;</span>,
       <span class="dt">y =</span> <span class="st">&quot;&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_discrete</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>), <span class="dt">labels =</span> <span class="ot">NULL</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_fill_cyclical</span>(<span class="dt">breaks =</span> <span class="kw">c</span>(<span class="st">&quot;Agreement-</span><span class="ch">\n</span><span class="st">related BCTs 1&quot;</span>, <span class="st">&quot;Agreement-</span><span class="ch">\n</span><span class="st">related BCTs 0&quot;</span>),
                      <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&#39;Agreement-</span><span class="ch">\n</span><span class="st">related BCTs 1&#39;</span> =<span class="st"> &quot;Intervention&quot;</span>, <span class="st">&#39;Agreement-</span><span class="ch">\n</span><span class="st">related BCTs 0&#39;</span> =<span class="st"> &quot;Control&quot;</span>),
                      <span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;#ff0000&quot;</span>, <span class="st">&quot;#0000ff&quot;</span>, <span class="st">&quot;#ff8080&quot;</span>, <span class="st">&quot;#8080ff&quot;</span>),
                      <span class="dt">name =</span> <span class="st">&quot;&quot;</span>, <span class="dt">guide =</span> <span class="st">&quot;legend&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">theme_ridges</span>(<span class="dt">grid =</span> <span class="ot">FALSE</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">&quot;bottom&quot;</span>)

plot1 <span class="op">+</span><span class="st"> </span>plot2
## Picking joint bandwidth of 0.319
## Warning: Removed 189 rows containing non-finite values
## (stat_density_ridges).
## Picking joint bandwidth of 0.318
## Warning: Removed 189 rows containing non-finite values
## (stat_density_ridges).</code></pre></div>
<p><img src="baseline-supplement_files/figure-html/bct-sumscore-density-plot-1.png" width="672" /></p>
</div>
<div id="sm-kernel-density-plots-for-means" class="section level3">
<h3>sm kernel density plots for means</h3>
<div id="frequency-measured-bcts" class="section level4">
<h4>Frequency-measured BCTs</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># Create data frame</span>
densplot &lt;-<span class="st"> </span>df
<span class="kw">levels</span>(densplot<span class="op">$</span>intervention) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Control&quot;</span>, <span class="st">&quot;Intervention&quot;</span>)
<span class="kw">levels</span>(densplot<span class="op">$</span>girl) &lt;-<span class="st"> </span><span class="kw">recode</span>(densplot<span class="op">$</span>girl, <span class="st">&quot;boy&quot;</span> =<span class="st"> &quot;Boys&quot;</span>, <span class="st">&quot;girl&quot;</span> =<span class="st"> &quot;Girls&quot;</span>)

<span class="co"># This gives side-by-side plots. There&#39;s a third plot below the two, which is fake to include x-axis text.</span>
<span class="kw">layout</span>(<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">3</span>), <span class="dt">nrow =</span> <span class="dv">2</span>, <span class="dt">ncol =</span> <span class="dv">2</span>, <span class="dt">byrow =</span> <span class="ot">TRUE</span>),
       <span class="dt">widths =</span> <span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>),<span class="dt">heights =</span> <span class="kw">c</span>(<span class="fl">0.45</span>,<span class="fl">0.05</span>))

<span class="co"># Minimise whitespace; see https://stackoverflow.com/questions/15848942/how-to-reduce-space-gap-between-multiple-graphs-in-r</span>
<span class="kw">par</span>(<span class="dt">mai =</span> <span class="kw">c</span>(<span class="fl">0.3</span>, <span class="fl">0.3</span>, <span class="fl">0.1</span>, <span class="fl">0.0</span>)) 

## Girls vs. boys
<span class="co"># Choose only the variables needed and drop NA</span>
dens &lt;-<span class="st"> </span>densplot <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(PA_frqbct_T1, girl) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="kw">complete.cases</span>(.))

<span class="co"># Set random number generator for reproducibility of bootstrap test of equal densities</span>
<span class="kw">set.seed</span>(<span class="dv">10</span>)

<span class="co"># Make plot</span>
sm.PA_frqbct_T1_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">sm.density.compare2</span>(<span class="kw">as.numeric</span>(dens<span class="op">$</span>PA_frqbct_T1), 
                                               <span class="kw">as.factor</span>(dens<span class="op">$</span>girl), 
                                               <span class="dt">model =</span> <span class="st">&quot;equal&quot;</span>,
                                               <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>,
                                               <span class="dt">col =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end  =</span>  <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">1</span>)], 
                                               <span class="dt">lty =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>), <span class="dt">yaxt =</span> <span class="st">&quot;n&quot;</span>,
                                               <span class="dt">bandcol =</span> <span class="st">&#39;LightGray&#39;</span>, 
                                               <span class="dt">lwd =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>),
                                               <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">6</span>))
## 
## Test of equal densities:  p-value =  0.22
<span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="kw">levels</span>(dens<span class="op">$</span>girl), <span class="dt">col =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>)], <span class="dt">lty =</span> <span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">1</span>), <span class="dt">lwd =</span> (<span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>)))
<span class="kw">mtext</span>(<span class="dt">side =</span> <span class="dv">2</span>, <span class="st">&quot;Density&quot;</span>, <span class="dt">line =</span> <span class="fl">0.5</span>)

## Intervention vs. control
<span class="co"># Choose only the variables needed and drop NA</span>
dens &lt;-<span class="st"> </span>densplot <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(PA_frqbct_T1, intervention) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="kw">complete.cases</span>(.))

<span class="co"># Set random number generator for reproducibility of bootstrap test of equal densities</span>
<span class="kw">set.seed</span>(<span class="dv">10</span>)
<span class="co"># Make plot</span>
sm.PA_frqbct_T1_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">sm.density.compare2</span>(<span class="kw">as.numeric</span>(dens<span class="op">$</span>PA_frqbct_T1), 
                                               <span class="kw">as.factor</span>(dens<span class="op">$</span>intervention), 
                                               <span class="dt">model =</span> <span class="st">&quot;equal&quot;</span>, 
                                               <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>,
                                               <span class="dt">col =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">4</span>)], 
                                               <span class="dt">lty =</span> <span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">1</span>), <span class="dt">yaxt =</span> <span class="st">&quot;n&quot;</span>,
                                               <span class="dt">bandcol =</span> <span class="st">&#39;LightGray&#39;</span>, 
                                               <span class="dt">lwd =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>),
                                               <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">6</span>))
## 
## Test of equal densities:  p-value =  0.35
<span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="kw">levels</span>(dens<span class="op">$</span>intervention), <span class="dt">col =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">4</span>)], <span class="dt">lty=</span><span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">1</span>), <span class="dt">lwd=</span>(<span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>)))

<span class="co"># Create x-axis label. See https://stackoverflow.com/questions/11198767/how-to-annotate-across-or-between-plots-in-multi-plot-panels-in-r</span>
<span class="kw">par</span>(<span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>)) 
<span class="kw">plot</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dt">type =</span> <span class="st">&quot;n&quot;</span>, <span class="dt">frame.plot =</span> <span class="ot">FALSE</span>,<span class="dt">axes =</span> <span class="ot">FALSE</span>) <span class="co"># Fake plot</span>
<span class="kw">text</span>(<span class="dt">x =</span> <span class="fl">1.02</span>, <span class="dt">y =</span> <span class="fl">1.3</span>, <span class="dt">labels =</span> <span class="st">&quot;Frequency-based BCT sumscore mean&quot;</span>, <span class="dt">pos =</span> <span class="dv">1</span>)</code></pre></div>
<p><img src="baseline-supplement_files/figure-html/sm-frqbct-1.png" width="672" /></p>
</div>
<div id="agreement-measured-bcts" class="section level4">
<h4>Agreement-measured BCTs</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># Create data frame</span>
densplot &lt;-<span class="st"> </span>df
<span class="kw">levels</span>(densplot<span class="op">$</span>intervention) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Control&quot;</span>, <span class="st">&quot;Intervention&quot;</span>)
<span class="kw">levels</span>(densplot<span class="op">$</span>girl) &lt;-<span class="st"> </span><span class="kw">recode</span>(densplot<span class="op">$</span>girl, <span class="st">&quot;boy&quot;</span> =<span class="st"> &quot;Boys&quot;</span>, <span class="st">&quot;girl&quot;</span> =<span class="st"> &quot;Girls&quot;</span>)

<span class="co"># This gives side-by-side plots. There&#39;s a third plot below the two, which is fake to include x-axis text.</span>
<span class="kw">layout</span>(<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">3</span>), <span class="dt">nrow =</span> <span class="dv">2</span>, <span class="dt">ncol =</span> <span class="dv">2</span>, <span class="dt">byrow =</span> <span class="ot">TRUE</span>),
       <span class="dt">widths =</span> <span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>),<span class="dt">heights =</span> <span class="kw">c</span>(<span class="fl">0.45</span>,<span class="fl">0.05</span>))

<span class="co"># Minimise whitespace; see https://stackoverflow.com/questions/15848942/how-to-reduce-space-gap-between-multiple-graphs-in-r</span>
<span class="kw">par</span>(<span class="dt">mai =</span> <span class="kw">c</span>(<span class="fl">0.3</span>, <span class="fl">0.3</span>, <span class="fl">0.1</span>, <span class="fl">0.0</span>)) 

## Girls vs. boys
<span class="co"># Choose only the variables needed and drop NA</span>
dens &lt;-<span class="st"> </span>densplot <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(PA_agrbct_T1, girl) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="kw">complete.cases</span>(.))

<span class="co"># Set random number generator for reproducibility of bootstrap test of equal densities</span>
<span class="kw">set.seed</span>(<span class="dv">10</span>)

<span class="co"># Make plot</span>
sm.PA_agrbct_T1_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">sm.density.compare2</span>(<span class="kw">as.numeric</span>(dens<span class="op">$</span>PA_agrbct_T1), 
                                               <span class="kw">as.factor</span>(dens<span class="op">$</span>girl), 
                                               <span class="dt">model =</span> <span class="st">&quot;equal&quot;</span>,
                                               <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>,
                                               <span class="dt">col =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end  =</span>  <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">1</span>)], 
                                               <span class="dt">lty =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>), <span class="dt">yaxt =</span> <span class="st">&quot;n&quot;</span>,
                                               <span class="dt">bandcol =</span> <span class="st">&#39;LightGray&#39;</span>, 
                                               <span class="dt">lwd =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>),
                                               <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">6</span>))
## 
## Test of equal densities:  p-value =  0.23
<span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="kw">levels</span>(dens<span class="op">$</span>girl), <span class="dt">col =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>)], <span class="dt">lty =</span> <span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">1</span>), <span class="dt">lwd =</span> (<span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>)))
<span class="kw">mtext</span>(<span class="dt">side =</span> <span class="dv">2</span>, <span class="st">&quot;Density&quot;</span>, <span class="dt">line =</span> <span class="fl">0.5</span>)

## Intervention vs. control
<span class="co"># Choose only the variables needed and drop NA</span>
dens &lt;-<span class="st"> </span>densplot <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(PA_agrbct_T1, intervention) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="kw">complete.cases</span>(.))

<span class="co"># Set random number generator for reproducibility of bootstrap test of equal densities</span>
<span class="kw">set.seed</span>(<span class="dv">10</span>)
<span class="co"># Make plot</span>
sm.PA_agrbct_T1_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">sm.density.compare2</span>(<span class="kw">as.numeric</span>(dens<span class="op">$</span>PA_agrbct_T1), 
                                               <span class="kw">as.factor</span>(dens<span class="op">$</span>intervention), 
                                               <span class="dt">model =</span> <span class="st">&quot;equal&quot;</span>, 
                                               <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>,
                                               <span class="dt">col =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">4</span>)], 
                                               <span class="dt">lty =</span> <span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">1</span>), <span class="dt">yaxt =</span> <span class="st">&quot;n&quot;</span>,
                                               <span class="dt">bandcol =</span> <span class="st">&#39;LightGray&#39;</span>, 
                                               <span class="dt">lwd =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>),
                                               <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">6</span>))
## 
## Test of equal densities:  p-value =  0
<span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="kw">levels</span>(dens<span class="op">$</span>intervention), <span class="dt">col =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">4</span>)], <span class="dt">lty=</span><span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">1</span>), <span class="dt">lwd=</span>(<span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>)))
<span class="kw">par</span>(<span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>)) 
<span class="kw">plot</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dt">type =</span> <span class="st">&quot;n&quot;</span>, <span class="dt">frame.plot =</span> <span class="ot">FALSE</span>,<span class="dt">axes =</span> <span class="ot">FALSE</span>) <span class="co"># Fake plot</span>
<span class="kw">text</span>(<span class="dt">x =</span> <span class="fl">1.02</span>, <span class="dt">y =</span> <span class="fl">1.3</span>, <span class="dt">labels =</span> <span class="st">&quot;Agreement-based BCT sumscore mean&quot;</span>, <span class="dt">pos =</span> <span class="dv">1</span>) <span class="co"># Create x-axis label. See https://stackoverflow.com/questions/11198767/how-to-annotate-across-or-between-plots-in-multi-plot-panels-in-r</span></code></pre></div>
<p><img src="baseline-supplement_files/figure-html/sm-agrbct-1.png" width="672" /></p>
</div>
</div>
<div id="histograms-for-individual-items" class="section level3">
<h3>Histograms for individual items</h3>
<div id="frequency-measured-bcts-1" class="section level4">
<h4>Frequency-measured BCTs</h4>
<p>These questions were asked with the lead “Have you done the following during the last three weeks?”.</p>
<p>The answer scale was as follows:</p>
<p>0 = not once 1 = once 2 = twice 3 = weekly 4 = about every second day 5 = daily</p>
<p>Items are as follows:</p>
<ol style="list-style-type: decimal">
<li>I have reminded myself even in my spare time, what kind of positive consequences frequent PA would have in my life.</li>
<li>I have monitored my PA by marking the PA occasions on an exercise log on paper.</li>
<li>I have monitored my PA by using a smart phone, e.g. the Moves-app.</li>
<li>I use mnemonic cues with which I remember to implement my PA intention.</li>
<li>I have compared my actualized PA with the PA goal I have set.</li>
<li>I have thought about which reasons to do PA are important to me personally.</li>
<li>I have made changes in my home (e.g. my room or my computer), so that starting PA would be easier.</li>
<li>I have asked my friends or family for support to reach my PA goals.</li>
<li>If I haven’t reached my PA goal, I have evaluated, what went wrong.</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">genderInterventionColors &lt;-<span class="st"> </span>viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">11</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)

bctGirls &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(id,
  intervention,
  group,
  school,
  girl,
<span class="st">&#39;Reminded self of positive consequences&#39;</span> =<span class="st"> </span>PA_frqbct_01_T1,
<span class="st">&#39;Has logged PA on paper&#39;</span> =<span class="st"> </span>PA_frqbct_02_T1,
<span class="st">&#39;Has monitored PA on smartphone&#39;</span> =<span class="st"> </span>PA_frqbct_03_T1,
<span class="st">&#39;Uses mnemonic cues&#39;</span> =<span class="st"> </span>PA_frqbct_04_T1,
<span class="st">&#39;Has compared actual with goal&#39;</span> =<span class="st"> </span>PA_frqbct_05_T1,
<span class="st">&#39;Has thought of relevance of PA&#39;</span> =<span class="st"> </span>PA_frqbct_06_T1,
<span class="st">&#39;Has made changes at home&#39;</span> =<span class="st"> </span>PA_frqbct_07_T1,
<span class="st">&#39;Has sought social support&#39;</span> =<span class="st"> </span>PA_frqbct_08_T1,
<span class="st">&#39;Has evaluated why goal not reached&#39;</span> =<span class="st"> </span>PA_frqbct_09_T1) <span class="op">%&gt;%</span>
<span class="st"> </span>tidyr<span class="op">::</span><span class="kw">gather</span>(<span class="dt">key =</span> Variable, <span class="dt">value =</span> Value, <span class="dv">6</span><span class="op">:</span><span class="kw">ncol</span>(.)) <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(girl <span class="op">==</span><span class="st"> &quot;girl&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st"> </span>ggplot2<span class="op">::</span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Value, <span class="dt">y =</span> Variable, <span class="dt">group =</span> Variable)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">geom_density_ridges2</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> Variable), <span class="dt">stat =</span> <span class="st">&quot;binline&quot;</span>, <span class="dt">binwidth =</span> <span class="dv">1</span>, <span class="dt">scale =</span> <span class="fl">0.95</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>), <span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>),
                     <span class="dt">name =</span> <span class="st">&quot;&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_discrete</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>), <span class="dt">name =</span> <span class="st">&quot;&quot;</span>, <span class="dt">labels =</span> <span class="ot">NULL</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_fill_cyclical</span>(<span class="dt">values =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">11</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">7</span><span class="op">:</span><span class="dv">8</span>]) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Girls&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">guides</span>(<span class="dt">y =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">theme_ridges</span>(<span class="dt">grid =</span> <span class="ot">FALSE</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>),
        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>),
        <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>),
        <span class="dt">axis.text=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">10</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">6.5</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">12</span>))
## Warning: attributes are not identical across measure variables;
## they will be dropped

bctBoys &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(id,
  intervention,
  group,
  school,
  girl,
<span class="st">&#39;Reminded self of positive consequences&#39;</span> =<span class="st"> </span>PA_frqbct_01_T1,
<span class="st">&#39;Has logged PA on paper&#39;</span> =<span class="st"> </span>PA_frqbct_02_T1,
<span class="st">&#39;Has monitored PA on smartphone&#39;</span> =<span class="st"> </span>PA_frqbct_03_T1,
<span class="st">&#39;Uses mnemonic cues&#39;</span> =<span class="st"> </span>PA_frqbct_04_T1,
<span class="st">&#39;Has compared actual with goal&#39;</span> =<span class="st"> </span>PA_frqbct_05_T1,
<span class="st">&#39;Has thought of relevance of PA&#39;</span> =<span class="st"> </span>PA_frqbct_06_T1,
<span class="st">&#39;Has made changes at home&#39;</span> =<span class="st"> </span>PA_frqbct_07_T1,
<span class="st">&#39;Has sought social support&#39;</span> =<span class="st"> </span>PA_frqbct_08_T1,
<span class="st">&#39;Has evaluated why goal not reached&#39;</span> =<span class="st"> </span>PA_frqbct_09_T1) <span class="op">%&gt;%</span>
<span class="st"> </span>tidyr<span class="op">::</span><span class="kw">gather</span>(<span class="dt">key =</span> Variable, <span class="dt">value =</span> Value, <span class="dv">6</span><span class="op">:</span><span class="kw">ncol</span>(.)) <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(girl <span class="op">==</span><span class="st"> &quot;boy&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st"> </span>ggplot2<span class="op">::</span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Value, <span class="dt">y =</span> Variable, <span class="dt">group =</span> Variable)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">geom_density_ridges2</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> Variable), <span class="dt">stat =</span> <span class="st">&quot;binline&quot;</span>, <span class="dt">binwidth =</span> <span class="dv">1</span>, <span class="dt">scale =</span> <span class="fl">0.95</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>), <span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>),
                     <span class="dt">name =</span> <span class="st">&quot;&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_discrete</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>), <span class="dt">name =</span> <span class="st">&quot;&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_fill_cyclical</span>(<span class="dt">values =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">11</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>]) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Boys&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">guides</span>(<span class="dt">y =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">theme_ridges</span>(<span class="dt">grid =</span> <span class="ot">FALSE</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>),
        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>),
        <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>),
        <span class="dt">axis.text=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">10</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">6.5</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">12</span>))
## Warning: attributes are not identical across measure variables;
## they will be dropped

bctInt &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(id,
  intervention,
  group,
  school,
  girl,
<span class="st">&#39;Reminded self of positive consequences&#39;</span> =<span class="st"> </span>PA_frqbct_01_T1,
<span class="st">&#39;Has logged PA on paper&#39;</span> =<span class="st"> </span>PA_frqbct_02_T1,
<span class="st">&#39;Has monitored PA on smartphone&#39;</span> =<span class="st"> </span>PA_frqbct_03_T1,
<span class="st">&#39;Uses mnemonic cues&#39;</span> =<span class="st"> </span>PA_frqbct_04_T1,
<span class="st">&#39;Has compared actual with goal&#39;</span> =<span class="st"> </span>PA_frqbct_05_T1,
<span class="st">&#39;Has thought of relevance of PA&#39;</span> =<span class="st"> </span>PA_frqbct_06_T1,
<span class="st">&#39;Has made changes at home&#39;</span> =<span class="st"> </span>PA_frqbct_07_T1,
<span class="st">&#39;Has sought social support&#39;</span> =<span class="st"> </span>PA_frqbct_08_T1,
<span class="st">&#39;Has evaluated why goal not reached&#39;</span> =<span class="st"> </span>PA_frqbct_09_T1) <span class="op">%&gt;%</span>
<span class="st"> </span>tidyr<span class="op">::</span><span class="kw">gather</span>(<span class="dt">key =</span> Variable, <span class="dt">value =</span> Value, <span class="dv">6</span><span class="op">:</span><span class="kw">ncol</span>(.)) <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(intervention <span class="op">==</span><span class="st"> &quot;1&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st"> </span>ggplot2<span class="op">::</span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Value, <span class="dt">y =</span> Variable, <span class="dt">group =</span> Variable)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">geom_density_ridges2</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> Variable), <span class="dt">stat =</span> <span class="st">&quot;binline&quot;</span>, <span class="dt">binwidth =</span> <span class="dv">1</span>, <span class="dt">scale =</span> <span class="fl">0.95</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>), <span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>),
                     <span class="dt">name =</span> <span class="st">&quot;&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_discrete</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>), <span class="dt">name =</span> <span class="st">&quot;&quot;</span>, <span class="dt">labels =</span> <span class="ot">NULL</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_fill_cyclical</span>(<span class="dt">values =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">11</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">10</span><span class="op">:</span><span class="dv">11</span>]) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Intervention&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">guides</span>(<span class="dt">y =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">theme_ridges</span>(<span class="dt">grid =</span> <span class="ot">FALSE</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>),
        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>),
        <span class="dt">axis.text=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">10</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">6.5</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">12</span>))
## Warning: attributes are not identical across measure variables;
## they will be dropped

bctCont &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(id,
  intervention,
  group,
  school,
  girl,
<span class="st">&#39;Reminded self of positive consequences&#39;</span> =<span class="st"> </span>PA_frqbct_01_T1,
<span class="st">&#39;Has logged PA on paper&#39;</span> =<span class="st"> </span>PA_frqbct_02_T1,
<span class="st">&#39;Has monitored PA on smartphone&#39;</span> =<span class="st"> </span>PA_frqbct_03_T1,
<span class="st">&#39;Uses mnemonic cues&#39;</span> =<span class="st"> </span>PA_frqbct_04_T1,
<span class="st">&#39;Has compared actual with goal&#39;</span> =<span class="st"> </span>PA_frqbct_05_T1,
<span class="st">&#39;Has thought of relevance of PA&#39;</span> =<span class="st"> </span>PA_frqbct_06_T1,
<span class="st">&#39;Has made changes at home&#39;</span> =<span class="st"> </span>PA_frqbct_07_T1,
<span class="st">&#39;Has sought social support&#39;</span> =<span class="st"> </span>PA_frqbct_08_T1,
<span class="st">&#39;Has evaluated why goal not reached&#39;</span> =<span class="st"> </span>PA_frqbct_09_T1) <span class="op">%&gt;%</span>
<span class="st"> </span>tidyr<span class="op">::</span><span class="kw">gather</span>(<span class="dt">key =</span> Variable, <span class="dt">value =</span> Value, <span class="dv">6</span><span class="op">:</span><span class="kw">ncol</span>(.)) <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(intervention <span class="op">==</span><span class="st"> &quot;0&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st"> </span>ggplot2<span class="op">::</span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Value, <span class="dt">y =</span> Variable, <span class="dt">group =</span> Variable)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">geom_density_ridges2</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> Variable), <span class="dt">stat =</span> <span class="st">&quot;binline&quot;</span>, <span class="dt">binwidth =</span> <span class="dv">1</span>, <span class="dt">scale =</span> <span class="fl">0.95</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>), <span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>),
                     <span class="dt">name =</span> <span class="st">&quot;&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_discrete</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>), <span class="dt">name =</span> <span class="st">&quot;&quot;</span>, <span class="dt">labels =</span> <span class="ot">NULL</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_fill_cyclical</span>(<span class="dt">values =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">11</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">4</span><span class="op">:</span><span class="dv">5</span>]) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Control&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">guides</span>(<span class="dt">y =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">theme_ridges</span>(<span class="dt">grid =</span> <span class="ot">FALSE</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>),
        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>),
        <span class="dt">axis.text=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">10</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">6.5</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">12</span>))
## Warning: attributes are not identical across measure variables;
## they will be dropped

bctBoys <span class="op">+</span><span class="st"> </span>bctGirls <span class="op">+</span><span class="st"> </span>bctInt <span class="op">+</span><span class="st"> </span>bctCont <span class="op">+</span><span class="st"> </span><span class="kw">plot_layout</span>(<span class="dt">nrow =</span> <span class="dv">1</span>) 
## Warning: Removed 72 rows containing non-finite values (stat_binline).
## Warning: Removed 54 rows containing non-finite values (stat_binline).

## Warning: Removed 54 rows containing non-finite values (stat_binline).
## Warning: Removed 72 rows containing non-finite values (stat_binline).</code></pre></div>
<p><img src="baseline-supplement_files/figure-html/histogram-frqbcts-1.png" width="672" /></p>
</div>
<div id="agreement-measured-bcts-1" class="section level4">
<h4>Agreement-measured BCTs</h4>
<p>These questions were asked with the lead “Have you done the following during the last three weeks?”.</p>
<p>The answer scale was as follows:</p>
<p>0 = not at all true 1 … 4 [unlabeled] 5 = completely true</p>
<p>Items are as follows:</p>
<ol style="list-style-type: decimal">
<li>I have set PA goals for myself.</li>
<li>I have personally made a specific plan (“what, where, how”) to implement my PA.</li>
<li>I have a PA plan, which has been made by someone else, e.g. my sports club (e.g. a workout schedule).</li>
<li>I have a way by which I remind myself of my PA plan, e.g. I write it down in the calendar.</li>
<li>I have cut larger PA goals to smaller subgoals.</li>
<li>I have tried out new ways for me to be physically active.</li>
<li>I have pondered, what kind of difficult situations or barriers prevent me from implementing my PA plan.</li>
<li>I have planned for ways to overcome barriers to doing PA.</li>
<li>I have thought about how PA fits my identity (self concept).</li>
<li>I have attempted to find ways to exercise so, that it won’t obstruct but instead helps actualise my other life values.</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
bctGirls &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(id,
  intervention,
  group,
  school,
  girl,
  <span class="st">&#39;Has set goals&#39;</span> =<span class="st"> </span>PA_agrbct_01_T1,
  <span class="st">&#39;Has made plan&#39;</span> =<span class="st"> </span>PA_agrbct_02_T1,
  <span class="st">&#39;Plan made by other&#39;</span> =<span class="st"> </span>PA_agrbct_03_T1,
  <span class="st">&#39;Has reminder of plan&#39;</span> =<span class="st"> </span>PA_agrbct_04_T1,
  <span class="st">&#39;Has cut goals to subgoals&#39;</span> =<span class="st"> </span>PA_agrbct_05_T1,
  <span class="st">&#39;Has tried new PA options&#39;</span> =<span class="st"> </span>PA_agrbct_06_T1,
  <span class="st">&#39;Has thought of barriers&#39;</span> =<span class="st"> </span>PA_agrbct_07_T1,
  <span class="st">&#39;Has planned for barriers&#39;</span> =<span class="st"> </span>PA_agrbct_08_T1,
  <span class="st">&#39;Has thought of PA identity&#39;</span> =<span class="st"> </span>PA_agrbct_09_T1,
  <span class="st">&#39;Has fitted PA to life values&#39;</span> =<span class="st"> </span>PA_agrbct_10_T1) <span class="op">%&gt;%</span>
<span class="st"> </span>tidyr<span class="op">::</span><span class="kw">gather</span>(<span class="dt">key =</span> Variable, <span class="dt">value =</span> Value, <span class="dv">6</span><span class="op">:</span><span class="kw">ncol</span>(.)) <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(girl <span class="op">==</span><span class="st"> &quot;girl&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st"> </span>ggplot2<span class="op">::</span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Value, <span class="dt">y =</span> Variable, <span class="dt">group =</span> Variable)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">geom_density_ridges2</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> Variable), <span class="dt">stat =</span> <span class="st">&quot;binline&quot;</span>, <span class="dt">binwidth =</span> <span class="dv">1</span>, <span class="dt">scale =</span> <span class="fl">0.95</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>), <span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>),
                     <span class="dt">name =</span> <span class="st">&quot;&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_discrete</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>), <span class="dt">name =</span> <span class="st">&quot;&quot;</span>, <span class="dt">labels =</span> <span class="ot">NULL</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_fill_cyclical</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;darkolivegreen2&quot;</span>, <span class="st">&quot;darkolivegreen4&quot;</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Girls&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">guides</span>(<span class="dt">y =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">theme_ridges</span>(<span class="dt">grid =</span> <span class="ot">FALSE</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>),
        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>),
        <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>),
        <span class="dt">axis.text=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">10</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">6.5</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">12</span>))
## Warning: attributes are not identical across measure variables;
## they will be dropped

bctBoys &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(id,
  intervention,
  group,
  school,
  girl,
  <span class="st">&#39;Has set goals&#39;</span> =<span class="st"> </span>PA_agrbct_01_T1,
  <span class="st">&#39;Has made plan&#39;</span> =<span class="st"> </span>PA_agrbct_02_T1,
  <span class="st">&#39;Plan made by other&#39;</span> =<span class="st"> </span>PA_agrbct_03_T1,
  <span class="st">&#39;Has reminder of plan&#39;</span> =<span class="st"> </span>PA_agrbct_04_T1,
  <span class="st">&#39;Has cut goals to subgoals&#39;</span> =<span class="st"> </span>PA_agrbct_05_T1,
  <span class="st">&#39;Has tried new PA options&#39;</span> =<span class="st"> </span>PA_agrbct_06_T1,
  <span class="st">&#39;Has thought of barriers&#39;</span> =<span class="st"> </span>PA_agrbct_07_T1,
  <span class="st">&#39;Has planned for barriers&#39;</span> =<span class="st"> </span>PA_agrbct_08_T1,
  <span class="st">&#39;Has thought of PA identity&#39;</span> =<span class="st"> </span>PA_agrbct_09_T1,
  <span class="st">&#39;Has fitted PA to life values&#39;</span> =<span class="st"> </span>PA_agrbct_10_T1) <span class="op">%&gt;%</span>
<span class="st">  </span>tidyr<span class="op">::</span><span class="kw">gather</span>(<span class="dt">key =</span> Variable, <span class="dt">value =</span> Value, <span class="dv">6</span><span class="op">:</span><span class="kw">ncol</span>(.)) <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(girl <span class="op">==</span><span class="st"> &quot;boy&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st"> </span>ggplot2<span class="op">::</span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Value, <span class="dt">y =</span> Variable, <span class="dt">group =</span> Variable)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">geom_density_ridges2</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> Variable), <span class="dt">stat =</span> <span class="st">&quot;binline&quot;</span>, <span class="dt">binwidth =</span> <span class="dv">1</span>, <span class="dt">scale =</span> <span class="fl">0.95</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>), <span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>),
                     <span class="dt">name =</span> <span class="st">&quot;&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_discrete</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>), <span class="dt">name =</span> <span class="st">&quot;&quot;</span>, <span class="dt">labels =</span> <span class="ot">NULL</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_fill_cyclical</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;darkolivegreen2&quot;</span>, <span class="st">&quot;darkolivegreen4&quot;</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Boys&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">guides</span>(<span class="dt">y =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">theme_ridges</span>(<span class="dt">grid =</span> <span class="ot">FALSE</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>),
        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>),
        <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>),
        <span class="dt">axis.text=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">10</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">6.5</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">12</span>))
## Warning: attributes are not identical across measure variables;
## they will be dropped

bctInt &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(id,
  intervention,
  group,
  school,
  girl,
  <span class="st">&#39;Has set goals&#39;</span> =<span class="st"> </span>PA_agrbct_01_T1,
  <span class="st">&#39;Has made plan&#39;</span> =<span class="st"> </span>PA_agrbct_02_T1,
  <span class="st">&#39;Plan made by other&#39;</span> =<span class="st"> </span>PA_agrbct_03_T1,
  <span class="st">&#39;Has reminder of plan&#39;</span> =<span class="st"> </span>PA_agrbct_04_T1,
  <span class="st">&#39;Has cut goals to subgoals&#39;</span> =<span class="st"> </span>PA_agrbct_05_T1,
  <span class="st">&#39;Has tried new PA options&#39;</span> =<span class="st"> </span>PA_agrbct_06_T1,
  <span class="st">&#39;Has thought of barriers&#39;</span> =<span class="st"> </span>PA_agrbct_07_T1,
  <span class="st">&#39;Has planned for barriers&#39;</span> =<span class="st"> </span>PA_agrbct_08_T1,
  <span class="st">&#39;Has thought of PA identity&#39;</span> =<span class="st"> </span>PA_agrbct_09_T1,
  <span class="st">&#39;Has fitted PA to life values&#39;</span> =<span class="st"> </span>PA_agrbct_10_T1) <span class="op">%&gt;%</span>
<span class="st"> </span>tidyr<span class="op">::</span><span class="kw">gather</span>(<span class="dt">key =</span> Variable, <span class="dt">value =</span> Value, <span class="dv">6</span><span class="op">:</span><span class="kw">ncol</span>(.)) <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(intervention <span class="op">==</span><span class="st"> &quot;1&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st"> </span>ggplot2<span class="op">::</span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Value, <span class="dt">y =</span> Variable, <span class="dt">group =</span> Variable)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">geom_density_ridges2</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> Variable), <span class="dt">stat =</span> <span class="st">&quot;binline&quot;</span>, <span class="dt">binwidth =</span> <span class="dv">1</span>, <span class="dt">scale =</span> <span class="fl">0.95</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>), <span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>),
                     <span class="dt">name =</span> <span class="st">&quot;&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_discrete</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>), <span class="dt">name =</span> <span class="st">&quot;&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_fill_cyclical</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;deepskyblue&quot;</span>, <span class="st">&quot;deepskyblue4&quot;</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Intervention&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">guides</span>(<span class="dt">y =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">theme_ridges</span>(<span class="dt">grid =</span> <span class="ot">FALSE</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>),
        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>),
        <span class="dt">axis.text=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">10</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">6.5</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">12</span>))
## Warning: attributes are not identical across measure variables;
## they will be dropped

bctCont &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(id,
  intervention,
  group,
  school,
  girl,
  <span class="st">&#39;Has set goals&#39;</span> =<span class="st"> </span>PA_agrbct_01_T1,
  <span class="st">&#39;Has made plan&#39;</span> =<span class="st"> </span>PA_agrbct_02_T1,
  <span class="st">&#39;Plan made by other&#39;</span> =<span class="st"> </span>PA_agrbct_03_T1,
  <span class="st">&#39;Has reminder of plan&#39;</span> =<span class="st"> </span>PA_agrbct_04_T1,
  <span class="st">&#39;Has cut goals to subgoals&#39;</span> =<span class="st"> </span>PA_agrbct_05_T1,
  <span class="st">&#39;Has tried new PA options&#39;</span> =<span class="st"> </span>PA_agrbct_06_T1,
  <span class="st">&#39;Has thought of barriers&#39;</span> =<span class="st"> </span>PA_agrbct_07_T1,
  <span class="st">&#39;Has planned for barriers&#39;</span> =<span class="st"> </span>PA_agrbct_08_T1,
  <span class="st">&#39;Has thought of PA identity&#39;</span> =<span class="st"> </span>PA_agrbct_09_T1,
  <span class="st">&#39;Has fitted PA to life values&#39;</span> =<span class="st"> </span>PA_agrbct_10_T1) <span class="op">%&gt;%</span>
<span class="st"> </span>tidyr<span class="op">::</span><span class="kw">gather</span>(<span class="dt">key =</span> Variable, <span class="dt">value =</span> Value, <span class="dv">6</span><span class="op">:</span><span class="kw">ncol</span>(.)) <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(intervention <span class="op">==</span><span class="st"> &quot;0&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st"> </span>ggplot2<span class="op">::</span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Value, <span class="dt">y =</span> Variable, <span class="dt">group =</span> Variable)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">geom_density_ridges2</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> Variable), <span class="dt">stat =</span> <span class="st">&quot;binline&quot;</span>, <span class="dt">binwidth =</span> <span class="dv">1</span>, <span class="dt">scale =</span> <span class="fl">0.95</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>), <span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>),
                     <span class="dt">name =</span> <span class="st">&quot;&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_discrete</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>), <span class="dt">name =</span> <span class="st">&quot;&quot;</span>, <span class="dt">labels =</span> <span class="ot">NULL</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_fill_cyclical</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;deepskyblue&quot;</span>, <span class="st">&quot;deepskyblue4&quot;</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Control&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">guides</span>(<span class="dt">y =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">theme_ridges</span>(<span class="dt">grid =</span> <span class="ot">FALSE</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>),
        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>),
        <span class="dt">axis.text=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">10</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">6.5</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">12</span>))
## Warning: attributes are not identical across measure variables;
## they will be dropped

bctInt <span class="op">+</span><span class="st"> </span>bctCont <span class="op">+</span><span class="st"> </span>bctGirls <span class="op">+</span><span class="st"> </span>bctBoys <span class="op">+</span><span class="st"> </span><span class="kw">plot_layout</span>(<span class="dt">nrow =</span> <span class="dv">1</span>) 
## Warning: Removed 60 rows containing non-finite values (stat_binline).
## Warning: Removed 70 rows containing non-finite values (stat_binline).
## Warning: Removed 60 rows containing non-finite values (stat_binline).
## Warning: Removed 70 rows containing non-finite values (stat_binline).</code></pre></div>
<p><img src="baseline-supplement_files/figure-html/histogram-agrbcts-1.png" width="672" /></p>
</div>
</div>
<div id="bct-plot-without-fill" class="section level3">
<h3>BCT Plot without fill</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">plot1 &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(id,
                              intervention,
                              group,
                              school,
                              girl,
                              <span class="st">&#39;PA intention&#39;</span> =<span class="st"> </span>PA_intention_T1,
                              <span class="st">&#39;PA outcome</span><span class="ch">\n</span><span class="st">expectations&#39;</span> =<span class="st"> </span>PA_outcomeExpectations_T1,
                              <span class="st">&#39;PA perceived</span><span class="ch">\n</span><span class="st">behavioural control&#39;</span> =<span class="st"> </span>PA_pbc_T1,
                              <span class="st">&#39;PA self efficacy&#39;</span> =<span class="st"> </span>PA_selfefficacy_T1,
                              <span class="st">&#39;PA perceived</span><span class="ch">\n</span><span class="st">opportunities&#39;</span> =<span class="st"> </span>PA_opportunities_T1,
                              <span class="st">&#39;PA descriptive</span><span class="ch">\n</span><span class="st">norm&#39;</span> =<span class="st"> </span>PA_dnorm_T1,
                              <span class="st">&#39;PA injunctive</span><span class="ch">\n</span><span class="st">norm&#39;</span> =<span class="st"> </span>PA_inorm_T1)  <span class="op">%&gt;%</span>
<span class="st">  </span><span class="co"># dplyr::select(noquote(order(colnames(.)))) %&gt;% # Orders columns alphabetically</span>
<span class="st">  </span>tidyr<span class="op">::</span><span class="kw">gather</span>(<span class="dt">key =</span> Variable, <span class="dt">value =</span> Value, <span class="dv">6</span><span class="op">:</span><span class="kw">ncol</span>(.), <span class="dt">factor_key =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span>
<span class="st">  </span>ggplot2<span class="op">::</span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">y =</span> Variable)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">geom_density_ridges</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Value, <span class="dt">colour =</span> <span class="kw">paste</span>(Variable, girl), 
                                    <span class="dt">fill =</span> <span class="kw">paste</span>(Variable, girl)), 
                                    <span class="dt">alpha =</span> <span class="dv">0</span>, <span class="dt">size =</span> <span class="fl">0.75</span>, <span class="dt">from =</span> <span class="dv">1</span>, <span class="dt">to =</span> <span class="dv">7</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;&quot;</span>,
       <span class="dt">y =</span> <span class="st">&quot;&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_discrete</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_fill_cyclical</span>(<span class="dt">breaks =</span> <span class="kw">c</span>(<span class="st">&quot;PA injunctive</span><span class="ch">\n</span><span class="st">norm boy&quot;</span>, <span class="st">&quot;PA injunctive</span><span class="ch">\n</span><span class="st">norm girl&quot;</span>),
                                <span class="dt">labels =</span> <span class="kw">c</span>( <span class="st">&#39;PA injunctive</span><span class="ch">\n</span><span class="st">norm boy&#39;</span> =<span class="st"> &quot;Boy&quot;</span>, <span class="st">&#39;PA injunctive</span><span class="ch">\n</span><span class="st">norm girl&#39;</span> =<span class="st"> &quot;Girl&quot;</span>),
                                <span class="dt">values =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>)], <span class="co">#c(&quot;#3bc600&quot;, &quot;#0000ff&quot;, &quot;#9cc68b&quot;, &quot;#8080ff&quot;),</span>
                                <span class="dt">name =</span> <span class="st">&quot;&quot;</span>, <span class="dt">guide =</span> <span class="kw">guide_legend</span>(<span class="dt">override.aes =</span> <span class="kw">list</span>(<span class="dt">alpha =</span> <span class="dv">1</span>))) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_colour_cyclical</span>(<span class="dt">values =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>, <span class="dt">alpha =</span> <span class="fl">0.9</span>)[<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>)]) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">theme_ridges</span>(<span class="dt">grid =</span> <span class="ot">FALSE</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">&quot;bottom&quot;</span>, <span class="dt">axis.text=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">10</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">7</span>)
## Warning: attributes are not identical across measure variables;
## they will be dropped

target =<span class="st"> </span><span class="kw">c</span>(
<span class="st">&quot;PA_intention_T1&quot;</span>,
<span class="st">&quot;PA_outcomeExpectations_T1&quot;</span>,
<span class="st">&quot;PA_pbc_T1&quot;</span>,
<span class="st">&quot;PA_selfefficacy_T1&quot;</span>,
<span class="st">&quot;PA_opportunities_T1&quot;</span>,
<span class="st">&quot;PA_dnorm_T1&quot;</span>,
<span class="st">&quot;PA_inorm_T1&quot;</span>)

PA_ci_girls &lt;-<span class="st"> </span>ci_girls <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(diamondlabels <span class="op">%in%</span><span class="st"> </span><span class="kw">names</span>(scales_T1) <span class="op">&amp;</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_intention_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_outcomeExpectations_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_pbc_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_selfefficacy_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_opportunities_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_dnorm_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_inorm_T1&quot;</span>, diamondlabels))

PA_ci_girls &lt;-<span class="st"> </span>PA_ci_girls[<span class="kw">match</span>(target, PA_ci_girls<span class="op">$</span>diamondlabels), ]

PA_ci_boys &lt;-<span class="st"> </span>ci_boys <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(diamondlabels <span class="op">%in%</span><span class="st"> </span><span class="kw">names</span>(scales_T1) <span class="op">&amp;</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_intention_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_outcomeExpectations_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_pbc_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_selfefficacy_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_opportunities_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_dnorm_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_inorm_T1&quot;</span>, diamondlabels))

PA_ci_boys &lt;-<span class="st"> </span>PA_ci_boys[<span class="kw">match</span>(target, PA_ci_boys<span class="op">$</span>diamondlabels), ]

plot1 &lt;-<span class="st"> </span>plot1 <span class="op">+</span><span class="st"> </span>userfriendlyscience<span class="op">::</span><span class="kw">diamondPlot</span>(PA_ci_girls, <span class="dt">returnLayerOnly =</span> <span class="ot">TRUE</span>, <span class="dt">color=</span>viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">3</span>)], 
                <span class="dt">alpha=</span>.<span class="dv">6</span>, <span class="dt">fixedSize =</span> <span class="fl">0.15</span>, <span class="dt">otherAxisCol =</span> (<span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(target) <span class="op">+</span><span class="st"> </span>.<span class="dv">2</span>)) <span class="op">+</span>
<span class="st">  </span>userfriendlyscience<span class="op">::</span><span class="kw">diamondPlot</span>(PA_ci_boys, <span class="dt">returnLayerOnly =</span> <span class="ot">TRUE</span>, <span class="dt">color=</span>viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">1</span>)],  
                <span class="dt">alpha=</span>.<span class="dv">6</span>, <span class="dt">fixedSize =</span> <span class="fl">0.15</span>, <span class="dt">otherAxisCol =</span> (<span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(target) <span class="op">+</span><span class="st"> </span>.<span class="dv">2</span>))

plot2 &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(id,
                              intervention,
                              group,
                              school,
                              girl,
                              <span class="st">&#39;PA intention&#39;</span> =<span class="st"> </span>PA_intention_T1,
                              <span class="st">&#39;PA outcome</span><span class="ch">\n</span><span class="st">expectations&#39;</span> =<span class="st"> </span>PA_outcomeExpectations_T1,
                              <span class="st">&#39;PA perceived</span><span class="ch">\n</span><span class="st">behavioural control&#39;</span> =<span class="st"> </span>PA_pbc_T1,
                              <span class="st">&#39;PA self efficacy&#39;</span> =<span class="st"> </span>PA_selfefficacy_T1,
                              <span class="st">&#39;PA perceived</span><span class="ch">\n</span><span class="st">opportunities&#39;</span> =<span class="st"> </span>PA_opportunities_T1,
                              <span class="st">&#39;PA descriptive</span><span class="ch">\n</span><span class="st">norm&#39;</span> =<span class="st"> </span>PA_dnorm_T1,
                              <span class="st">&#39;PA injunctive</span><span class="ch">\n</span><span class="st">norm&#39;</span> =<span class="st"> </span>PA_inorm_T1)  <span class="op">%&gt;%</span>
<span class="st">  </span><span class="co"># dplyr::select(noquote(order(colnames(.)))) %&gt;% # Orders columns alphabetically</span>
<span class="st">  </span>tidyr<span class="op">::</span><span class="kw">gather</span>(<span class="dt">key =</span> Variable, <span class="dt">value =</span> Value, <span class="dv">6</span><span class="op">:</span><span class="kw">ncol</span>(.), <span class="dt">factor_key =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span>
<span class="st">  </span>ggplot2<span class="op">::</span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">y =</span> Variable)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">geom_density_ridges</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Value, <span class="dt">colour =</span> <span class="kw">paste</span>(Variable, intervention), 
                                    <span class="dt">fill =</span> <span class="kw">paste</span>(Variable, intervention)), 
                                    <span class="dt">alpha =</span> <span class="dv">0</span>, <span class="dt">size =</span> <span class="fl">0.75</span>, <span class="dt">from =</span> <span class="dv">1</span>, <span class="dt">to =</span> <span class="dv">7</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;&quot;</span>,
       <span class="dt">y =</span> <span class="st">&quot;&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_discrete</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>), <span class="dt">labels =</span> <span class="ot">NULL</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_fill_cyclical</span>(<span class="dt">breaks =</span> <span class="kw">c</span>(<span class="st">&quot;PA injunctive</span><span class="ch">\n</span><span class="st">norm 0&quot;</span>, <span class="st">&quot;PA injunctive</span><span class="ch">\n</span><span class="st">norm 1&quot;</span>),
                                <span class="dt">labels =</span> <span class="kw">c</span>( <span class="st">&#39;PA injunctive</span><span class="ch">\n</span><span class="st">norm 0&#39;</span> =<span class="st"> &quot;Control&quot;</span>, <span class="st">&#39;PA injunctive</span><span class="ch">\n</span><span class="st">norm 1&#39;</span> =<span class="st"> &quot;Intervention&quot;</span>),
                                <span class="dt">values =</span> <span class="kw">c</span>(viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">4</span>)], viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">8</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">8</span>)]), <span class="co"># get 2 x 2 colors, close to each other</span>
                                <span class="dt">name =</span> <span class="st">&quot;&quot;</span>, <span class="dt">guide =</span> <span class="kw">guide_legend</span>(<span class="dt">override.aes =</span> <span class="kw">list</span>(<span class="dt">alpha =</span> <span class="dv">1</span>))) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_colour_cyclical</span>(<span class="dt">values =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>, <span class="dt">alpha =</span> <span class="fl">0.9</span>)[<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">4</span>)]) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">theme_ridges</span>(<span class="dt">grid =</span> <span class="ot">FALSE</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">&quot;bottom&quot;</span>, <span class="dt">axis.text=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">10</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">7</span>)
## Warning: attributes are not identical across measure variables;
## they will be dropped

PA_ci_intervention &lt;-<span class="st"> </span>ci_intervention <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(diamondlabels <span class="op">%in%</span><span class="st"> </span><span class="kw">names</span>(scales_T1) <span class="op">&amp;</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_intention_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_outcomeExpectations_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_pbc_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_selfefficacy_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_opportunities_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_dnorm_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_inorm_T1&quot;</span>, diamondlabels))

PA_ci_intervention &lt;-<span class="st"> </span>PA_ci_intervention[<span class="kw">match</span>(target, PA_ci_intervention<span class="op">$</span>diamondlabels), ]

PA_ci_control &lt;-<span class="st"> </span>ci_control <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(diamondlabels <span class="op">%in%</span><span class="st"> </span><span class="kw">names</span>(scales_T1) <span class="op">&amp;</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_intention_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_outcomeExpectations_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_pbc_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_selfefficacy_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_opportunities_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_dnorm_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_inorm_T1&quot;</span>, diamondlabels))

PA_ci_control &lt;-<span class="st"> </span>PA_ci_control[<span class="kw">match</span>(target, PA_ci_control<span class="op">$</span>diamondlabels), ]

plot2 &lt;-<span class="st"> </span>plot2 <span class="op">+</span><span class="st"> </span>
<span class="st">  </span>userfriendlyscience<span class="op">::</span><span class="kw">diamondPlot</span>(PA_ci_intervention, <span class="dt">returnLayerOnly =</span> <span class="ot">TRUE</span>, <span class="dt">color=</span>viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">4</span>)],
              <span class="dt">alpha=</span>.<span class="dv">6</span>, <span class="dt">fixedSize =</span> <span class="fl">0.15</span>, <span class="dt">otherAxisCol =</span> (<span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(target) <span class="op">+</span><span class="st"> </span>.<span class="dv">2</span>)) <span class="op">+</span>
<span class="st">  </span>userfriendlyscience<span class="op">::</span><span class="kw">diamondPlot</span>(PA_ci_control, <span class="dt">returnLayerOnly =</span> <span class="ot">TRUE</span>, <span class="dt">color=</span>viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">2</span>)], 
              <span class="dt">alpha=</span>.<span class="dv">6</span>, <span class="dt">fixedSize =</span> <span class="fl">0.15</span>, <span class="dt">otherAxisCol =</span> (<span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(target) <span class="op">+</span><span class="st"> </span>.<span class="dv">2</span>))

plot1 <span class="op">+</span><span class="st"> </span>plot2
## Picking joint bandwidth of 0.355
## Warning: Removed 641 rows containing non-finite values
## (stat_density_ridges).
## Picking joint bandwidth of 0.359
## Warning: Removed 641 rows containing non-finite values
## (stat_density_ridges).</code></pre></div>
<p><img src="baseline-supplement_files/figure-html/bct-determinants-nofill-1.png" width="672" /></p>
</div>
</div>
<div id="pa-psychosocial-mediators" class="section level2">
<h2>PA psychosocial mediators</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
plot1 &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(id,
                              intervention,
                              group,
                              school,
                              girl,
                              <span class="st">&#39;PA intention&#39;</span> =<span class="st"> </span>PA_intention_T1,
                              <span class="st">&#39;PA outcome</span><span class="ch">\n</span><span class="st">expectations&#39;</span> =<span class="st"> </span>PA_outcomeExpectations_T1,
                              <span class="st">&#39;PA perceived</span><span class="ch">\n</span><span class="st">behavioural control&#39;</span> =<span class="st"> </span>PA_pbc_T1,
                              <span class="st">&#39;PA self efficacy&#39;</span> =<span class="st"> </span>PA_selfefficacy_T1,
                              <span class="st">&#39;PA perceived</span><span class="ch">\n</span><span class="st">opportunities&#39;</span> =<span class="st"> </span>PA_opportunities_T1,
                              <span class="st">&#39;PA descriptive</span><span class="ch">\n</span><span class="st">norm&#39;</span> =<span class="st"> </span>PA_dnorm_T1)  <span class="op">%&gt;%</span>
<span class="st">  </span><span class="co"># dplyr::select(noquote(order(colnames(.)))) %&gt;% # Orders columns alphabetically</span>
<span class="st">  </span>tidyr<span class="op">::</span><span class="kw">gather</span>(<span class="dt">key =</span> Variable, <span class="dt">value =</span> Value, <span class="dv">6</span><span class="op">:</span><span class="kw">ncol</span>(.), <span class="dt">factor_key =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span>
<span class="st">  </span>ggplot2<span class="op">::</span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">y =</span> Variable)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">geom_density_ridges</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Value, <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>, 
                                    <span class="dt">fill =</span> <span class="kw">paste</span>(Variable, girl)), 
                                    <span class="dt">alpha =</span> <span class="fl">0.6</span>, <span class="dt">size =</span> <span class="fl">0.25</span>, 
                                    <span class="dt">from =</span> <span class="dv">1</span>, <span class="dt">to =</span> <span class="dv">7</span>, <span class="dt">scale =</span> <span class="dv">1</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;&quot;</span>,
       <span class="dt">y =</span> <span class="st">&quot;&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_discrete</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_fill_cyclical</span>(<span class="dt">breaks =</span> <span class="kw">c</span>(<span class="st">&quot;PA descriptive</span><span class="ch">\n</span><span class="st">norm boy&quot;</span>, <span class="st">&quot;PA descriptive</span><span class="ch">\n</span><span class="st">norm girl&quot;</span>),
                                <span class="dt">labels =</span> <span class="kw">c</span>( <span class="st">&#39;PA descriptive</span><span class="ch">\n</span><span class="st">norm boy&#39;</span> =<span class="st"> &quot;Boy&quot;</span>, <span class="st">&#39;PA descriptive</span><span class="ch">\n</span><span class="st">norm girl&#39;</span> =<span class="st"> &quot;Girl&quot;</span>),
                                <span class="dt">values =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>)],
                                <span class="dt">name =</span> <span class="st">&quot;&quot;</span>, <span class="dt">guide =</span> <span class="kw">guide_legend</span>(<span class="dt">override.aes =</span> <span class="kw">list</span>(<span class="dt">alpha =</span> <span class="dv">1</span>))) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_colour_cyclical</span>(<span class="dt">values =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">theme_ridges</span>(<span class="dt">grid =</span> <span class="ot">FALSE</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">&quot;bottom&quot;</span>, <span class="dt">axis.text=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">10</span>))

target =<span class="st"> </span><span class="kw">c</span>(
<span class="st">&quot;PA_intention_T1&quot;</span>,
<span class="st">&quot;PA_outcomeExpectations_T1&quot;</span>,
<span class="st">&quot;PA_pbc_T1&quot;</span>,
<span class="st">&quot;PA_selfefficacy_T1&quot;</span>,
<span class="st">&quot;PA_opportunities_T1&quot;</span>,
<span class="st">&quot;PA_dnorm_T1&quot;</span>)

PA_ci_girls &lt;-<span class="st"> </span>ci_girls <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(diamondlabels <span class="op">%in%</span><span class="st"> </span><span class="kw">names</span>(scales_T1) <span class="op">&amp;</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_intention_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_outcomeExpectations_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_pbc_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_selfefficacy_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_opportunities_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_dnorm_T1&quot;</span>, diamondlabels))

PA_ci_girls &lt;-<span class="st"> </span>PA_ci_girls[<span class="kw">match</span>(target, PA_ci_girls<span class="op">$</span>diamondlabels), ]

PA_ci_boys &lt;-<span class="st"> </span>ci_boys <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(diamondlabels <span class="op">%in%</span><span class="st"> </span><span class="kw">names</span>(scales_T1) <span class="op">&amp;</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_intention_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_outcomeExpectations_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_pbc_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_selfefficacy_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_opportunities_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_dnorm_T1&quot;</span>, diamondlabels))

PA_ci_boys &lt;-<span class="st"> </span>PA_ci_boys[<span class="kw">match</span>(target, PA_ci_boys<span class="op">$</span>diamondlabels), ]

plot1 &lt;-<span class="st"> </span>plot1 <span class="op">+</span><span class="st"> </span>userfriendlyscience<span class="op">::</span><span class="kw">diamondPlot</span>(PA_ci_girls, <span class="dt">returnLayerOnly =</span> <span class="ot">TRUE</span>, <span class="dt">lineColor =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">color=</span>viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">3</span>], 
                <span class="dt">alpha=</span>.<span class="dv">6</span>, <span class="dt">fixedSize =</span> <span class="fl">0.15</span>, <span class="dt">otherAxisCol =</span> (<span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(target) <span class="op">+</span><span class="st"> </span>.<span class="dv">2</span>)) <span class="op">+</span>
<span class="st">  </span>userfriendlyscience<span class="op">::</span><span class="kw">diamondPlot</span>(PA_ci_boys, <span class="dt">returnLayerOnly =</span> <span class="ot">TRUE</span>, <span class="dt">lineColor =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">linetype =</span> <span class="st">&quot;solid&quot;</span>, <span class="dt">color=</span>viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">1</span>],  
                <span class="dt">alpha=</span>.<span class="dv">6</span>, <span class="dt">fixedSize =</span> <span class="fl">0.15</span>, <span class="dt">otherAxisCol =</span> (<span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(target) <span class="op">+</span><span class="st"> </span>.<span class="dv">2</span>))

plot2 &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(id,
                              intervention,
                              group,
                              school,
                              girl,
                              <span class="st">&#39;PA intention&#39;</span> =<span class="st"> </span>PA_intention_T1,
                              <span class="st">&#39;PA outcome</span><span class="ch">\n</span><span class="st">expectations&#39;</span> =<span class="st"> </span>PA_outcomeExpectations_T1,
                              <span class="st">&#39;PA perceived</span><span class="ch">\n</span><span class="st">behavioural control&#39;</span> =<span class="st"> </span>PA_pbc_T1,
                              <span class="st">&#39;PA self efficacy&#39;</span> =<span class="st"> </span>PA_selfefficacy_T1,
                              <span class="st">&#39;PA perceived</span><span class="ch">\n</span><span class="st">opportunities&#39;</span> =<span class="st"> </span>PA_opportunities_T1,
                              <span class="st">&#39;PA descriptive</span><span class="ch">\n</span><span class="st">norm&#39;</span> =<span class="st"> </span>PA_dnorm_T1)  <span class="op">%&gt;%</span>
<span class="st">  </span><span class="co"># dplyr::select(noquote(order(colnames(.)))) %&gt;% # Orders columns alphabetically</span>
<span class="st">  </span>tidyr<span class="op">::</span><span class="kw">gather</span>(<span class="dt">key =</span> Variable, <span class="dt">value =</span> Value, <span class="dv">6</span><span class="op">:</span><span class="kw">ncol</span>(.), <span class="dt">factor_key =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span>
<span class="st">  </span>ggplot2<span class="op">::</span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">y =</span> Variable)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">geom_density_ridges</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Value, <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>, 
                                    <span class="dt">fill =</span> <span class="kw">paste</span>(Variable, intervention)), 
                                    <span class="dt">alpha =</span> <span class="fl">0.75</span>, <span class="dt">size =</span> <span class="fl">0.25</span>, <span class="dt">from =</span> <span class="dv">1</span>, <span class="dt">to =</span> <span class="dv">7</span>, <span class="dt">scale =</span> <span class="dv">1</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;&quot;</span>,
       <span class="dt">y =</span> <span class="st">&quot;&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_discrete</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>), <span class="dt">labels =</span> <span class="ot">NULL</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_fill_cyclical</span>(<span class="dt">breaks =</span> <span class="kw">c</span>(<span class="st">&quot;PA descriptive</span><span class="ch">\n</span><span class="st">norm 0&quot;</span>, <span class="st">&quot;PA descriptive</span><span class="ch">\n</span><span class="st">norm 1&quot;</span>),
                                <span class="dt">labels =</span> <span class="kw">c</span>( <span class="st">&#39;PA descriptive</span><span class="ch">\n</span><span class="st">norm 0&#39;</span> =<span class="st"> &quot;Control&quot;</span>, <span class="st">&#39;PA descriptive</span><span class="ch">\n</span><span class="st">norm 1&#39;</span> =<span class="st"> &quot;Intervention&quot;</span>),
                                <span class="dt">values =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">4</span>)],
                                <span class="dt">name =</span> <span class="st">&quot;&quot;</span>, <span class="dt">guide =</span> <span class="kw">guide_legend</span>(<span class="dt">override.aes =</span> <span class="kw">list</span>(<span class="dt">alpha =</span> <span class="dv">1</span>))) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_colour_cyclical</span>(<span class="dt">values =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">theme_ridges</span>(<span class="dt">grid =</span> <span class="ot">FALSE</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">&quot;bottom&quot;</span>, <span class="dt">axis.text=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">10</span>))

PA_ci_intervention &lt;-<span class="st"> </span>ci_intervention <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(diamondlabels <span class="op">%in%</span><span class="st"> </span><span class="kw">names</span>(scales_T1) <span class="op">&amp;</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_intention_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_outcomeExpectations_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_pbc_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_selfefficacy_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_opportunities_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_dnorm_T1&quot;</span>, diamondlabels))

PA_ci_intervention &lt;-<span class="st"> </span>PA_ci_intervention[<span class="kw">match</span>(target, PA_ci_intervention<span class="op">$</span>diamondlabels), ]

PA_ci_control &lt;-<span class="st"> </span>ci_control <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(diamondlabels <span class="op">%in%</span><span class="st"> </span><span class="kw">names</span>(scales_T1) <span class="op">&amp;</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_intention_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_outcomeExpectations_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_pbc_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_selfefficacy_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_opportunities_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_dnorm_T1&quot;</span>, diamondlabels))

PA_ci_control &lt;-<span class="st"> </span>PA_ci_control[<span class="kw">match</span>(target, PA_ci_control<span class="op">$</span>diamondlabels), ]

plot2 &lt;-<span class="st"> </span>plot2 <span class="op">+</span><span class="st"> </span>
<span class="st">  </span>userfriendlyscience<span class="op">::</span><span class="kw">diamondPlot</span>(PA_ci_intervention, <span class="dt">returnLayerOnly =</span> <span class="ot">TRUE</span>, <span class="dt">lineColor =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">color=</span>viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">4</span>],
              <span class="dt">alpha=</span>.<span class="dv">6</span>, <span class="dt">fixedSize =</span> <span class="fl">0.15</span>, <span class="dt">otherAxisCol =</span> (<span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(target) <span class="op">+</span><span class="st"> </span>.<span class="dv">2</span>)) <span class="op">+</span>
<span class="st">  </span>userfriendlyscience<span class="op">::</span><span class="kw">diamondPlot</span>(PA_ci_control, <span class="dt">returnLayerOnly =</span> <span class="ot">TRUE</span>, <span class="dt">lineColor =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">color=</span>viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">2</span>], 
              <span class="dt">alpha=</span>.<span class="dv">6</span>, <span class="dt">fixedSize =</span> <span class="fl">0.15</span>, <span class="dt">otherAxisCol =</span> (<span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(target) <span class="op">+</span><span class="st"> </span>.<span class="dv">2</span>))

plot1 <span class="op">+</span><span class="st"> </span>plot2 
## Picking joint bandwidth of 0.327
## Warning: Removed 549 rows containing non-finite values
## (stat_density_ridges).
## Picking joint bandwidth of 0.332
## Warning: Removed 549 rows containing non-finite values
## (stat_density_ridges).</code></pre></div>
<p><img src="baseline-supplement_files/figure-html/densityplot-intention-oexp-pbc-se-opp-norms-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># Test that the legend is right; descriptive norms are smaller for girls</span>
df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(girl) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarise</span>(<span class="dt">mean =</span> <span class="kw">mean</span>(PA_dnorm_T1, <span class="dt">na.rm =</span> T)) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(girl <span class="op">==</span><span class="st"> &quot;girl&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(mean) <span class="op">&lt;</span><span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(girl) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarise</span>(<span class="dt">mean =</span> <span class="kw">mean</span>(PA_dnorm_T1, <span class="dt">na.rm =</span> T)) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(girl <span class="op">==</span><span class="st"> &quot;boy&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(mean)
##      mean
## [1,] TRUE

df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(intervention) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarise</span>(<span class="dt">mean =</span> <span class="kw">mean</span>(PA_dnorm_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(intervention <span class="op">==</span><span class="st"> &quot;1&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(mean) <span class="op">&lt;</span><span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(intervention) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarise</span>(<span class="dt">mean =</span> <span class="kw">mean</span>(PA_dnorm_T1, <span class="dt">na.rm =</span> T)) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(intervention <span class="op">==</span><span class="st"> &quot;0&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(mean)
##      mean
## [1,] TRUE</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
plot1 &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(id,
  intervention,
  group,
  school,
  girl,
<span class="st">&#39;PA action and</span><span class="ch">\n</span><span class="st">coping planning&#39;</span> =<span class="st"> </span>PA_actCop_T1,
<span class="st">&#39;PA intention&#39;</span> =<span class="st"> </span>PA_intention_T1,
<span class="st">&#39;PA outcome</span><span class="ch">\n</span><span class="st">expectations&#39;</span> =<span class="st"> </span>PA_outcomeExpectations_T1,
<span class="st">&#39;PA perceived</span><span class="ch">\n</span><span class="st">behavioural control&#39;</span> =<span class="st"> </span>PA_pbc_T1,
<span class="st">&#39;PA self efficacy&#39;</span> =<span class="st"> </span>PA_selfefficacy_T1,
<span class="st">&#39;PA perceived</span><span class="ch">\n</span><span class="st">opportunities&#39;</span> =<span class="st"> </span>PA_opportunities_T1,
<span class="st">&#39;PA descriptive</span><span class="ch">\n</span><span class="st">norm&#39;</span> =<span class="st"> </span>PA_dnorm_T1,
<span class="st">&#39;PA injunctive</span><span class="ch">\n</span><span class="st">norm&#39;</span> =<span class="st"> </span>PA_inorm_T1)  <span class="op">%&gt;%</span>
<span class="st">  </span><span class="co"># dplyr::select(noquote(order(colnames(.)))) %&gt;% # Orders columns alphabetically</span>
<span class="st">  </span>tidyr<span class="op">::</span><span class="kw">gather</span>(<span class="dt">key =</span> Variable, <span class="dt">value =</span> Value, <span class="dv">6</span><span class="op">:</span><span class="kw">ncol</span>(.), <span class="dt">factor_key =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>ggplot2<span class="op">::</span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">y =</span> Variable)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">geom_density_ridges</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Value,
                                    <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>,
                                    <span class="dt">fill =</span> <span class="kw">paste</span>(Variable, girl),
                                    <span class="dt">point_color =</span> girl,
                                    <span class="dt">point_fill =</span> girl,
                                    <span class="dt">point_shape =</span> girl,
                                    <span class="dt">point_size =</span> girl,
                                    <span class="dt">point_alpha =</span> girl),
                                <span class="dt">scale =</span> .<span class="dv">5</span>, <span class="dt">alpha =</span> .<span class="dv">6</span>, <span class="dt">size =</span> <span class="fl">0.25</span>,
                                <span class="dt">from =</span> <span class="dv">1</span>, <span class="dt">to =</span> <span class="dv">7</span>,
                                <span class="dt">position =</span> <span class="kw">position_raincloud</span>(<span class="dt">width =</span> <span class="fl">0.03</span>, <span class="dt">height =</span> <span class="fl">0.5</span>),
                                <span class="dt">jittered_points =</span> <span class="ot">TRUE</span>,
                                <span class="dt">point_size =</span> <span class="dv">1</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="ot">NULL</span>,
       <span class="dt">y =</span> <span class="ot">NULL</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_discrete</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_fill_cyclical</span>(
                      <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&#39;PA action and</span><span class="ch">\n</span><span class="st">coping planning boy&#39;</span> =<span class="st"> &quot;Boy&quot;</span>, <span class="st">&#39;PA action and</span><span class="ch">\n</span><span class="st">coping planning girl&#39;</span> =<span class="st"> &quot;Girl&quot;</span>),
                      <span class="dt">values =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>)],
                      <span class="dt">name =</span> <span class="st">&quot;&quot;</span>, 
                      <span class="dt">guide =</span> <span class="kw">guide_legend</span>(<span class="dt">override.aes =</span> <span class="kw">list</span>(<span class="dt">alpha =</span> <span class="dv">1</span>, 
                                                               <span class="dt">point_shape =</span> <span class="kw">c</span>(<span class="dv">24</span>, <span class="dv">25</span>),
                                                               <span class="dt">point_size =</span> <span class="dv">2</span>))) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_colour_cyclical</span>(<span class="dt">values =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">theme_ridges</span>(<span class="dt">grid =</span> <span class="ot">FALSE</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_discrete_manual</span>(<span class="dt">aesthetics =</span> <span class="st">&quot;point_color&quot;</span>, 
                                  <span class="dt">values =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>)],
                                  <span class="dt">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_discrete_manual</span>(<span class="dt">aesthetics =</span> <span class="st">&quot;point_fill&quot;</span>,
                                  <span class="dt">values =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>)],
                                  <span class="dt">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_discrete_manual</span>(<span class="dt">aesthetics =</span> <span class="st">&quot;point_shape&quot;</span>, 
                                  <span class="dt">values =</span> <span class="kw">c</span>(<span class="dv">24</span>, <span class="dv">25</span>),
                                  <span class="dt">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_discrete_manual</span>(<span class="dt">aesthetics =</span> <span class="st">&quot;point_size&quot;</span>, 
                                  <span class="dt">values =</span> <span class="kw">c</span>(.<span class="dv">75</span>, .<span class="dv">75</span>),
                                  <span class="dt">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_discrete_manual</span>(<span class="dt">aesthetics =</span> <span class="st">&quot;point_alpha&quot;</span>, 
                                  <span class="dt">values =</span> <span class="kw">c</span>(<span class="fl">0.1</span>, <span class="fl">0.1</span>),
                                  <span class="dt">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>papaja<span class="op">::</span><span class="kw">theme_apa</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)
## Warning: attributes are not identical across measure variables;
## they will be dropped

plot2 &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(id,
  intervention,
  group,
  school,
  girl,
<span class="st">&#39;PA action and</span><span class="ch">\n</span><span class="st">coping planning&#39;</span> =<span class="st"> </span>PA_actCop_T1,
<span class="st">&#39;PA intention&#39;</span> =<span class="st"> </span>PA_intention_T1,
<span class="st">&#39;PA outcome</span><span class="ch">\n</span><span class="st">expectations&#39;</span> =<span class="st"> </span>PA_outcomeExpectations_T1,
<span class="st">&#39;PA perceived</span><span class="ch">\n</span><span class="st">behavioural control&#39;</span> =<span class="st"> </span>PA_pbc_T1,
<span class="st">&#39;PA self efficacy&#39;</span> =<span class="st"> </span>PA_selfefficacy_T1,
<span class="st">&#39;PA perceived</span><span class="ch">\n</span><span class="st">opportunities&#39;</span> =<span class="st"> </span>PA_opportunities_T1,
<span class="st">&#39;PA descriptive</span><span class="ch">\n</span><span class="st">norm&#39;</span> =<span class="st"> </span>PA_dnorm_T1,
<span class="st">&#39;PA injunctive</span><span class="ch">\n</span><span class="st">norm&#39;</span> =<span class="st"> </span>PA_inorm_T1) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="co"># dplyr::select(noquote(order(colnames(.)))) %&gt;% # Orders columns alphabetically</span>
<span class="st">  </span>tidyr<span class="op">::</span><span class="kw">gather</span>(<span class="dt">key =</span> Variable, <span class="dt">value =</span> Value, <span class="dv">6</span><span class="op">:</span><span class="kw">ncol</span>(.), <span class="dt">factor_key =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>ggplot2<span class="op">::</span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">y =</span> Variable)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">geom_density_ridges</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Value,
                                    <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>,
                                    <span class="dt">fill =</span> <span class="kw">paste</span>(Variable, intervention),
                                    <span class="dt">point_color =</span> intervention,
                                    <span class="dt">point_fill =</span> intervention,
                                    <span class="dt">point_shape =</span> intervention,
                                    <span class="dt">point_size =</span> intervention,
                                    <span class="dt">point_alpha =</span> intervention),
                                <span class="dt">scale =</span> .<span class="dv">5</span>, <span class="dt">alpha =</span> .<span class="dv">6</span>, <span class="dt">size =</span> <span class="fl">0.25</span>,
                                <span class="dt">from =</span> <span class="dv">1</span>, <span class="dt">to =</span> <span class="dv">7</span>,
                                <span class="dt">position =</span> <span class="kw">position_raincloud</span>(<span class="dt">width =</span> <span class="fl">0.03</span>, <span class="dt">height =</span> <span class="fl">0.5</span>),
                                <span class="dt">jittered_points =</span> <span class="ot">TRUE</span>,
                                <span class="dt">point_size =</span> <span class="dv">1</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="ot">NULL</span>,
       <span class="dt">y =</span> <span class="ot">NULL</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_discrete</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>), <span class="dt">labels =</span> <span class="ot">NULL</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_fill_cyclical</span>(
                      <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&#39;PA action and</span><span class="ch">\n</span><span class="st">coping planning 0&#39;</span> =<span class="st"> &quot;Control&quot;</span>, <span class="st">&#39;PA action and</span><span class="ch">\n</span><span class="st">coping planning 1&#39;</span> =<span class="st"> &quot;intervention&quot;</span>),
                      <span class="dt">values =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">4</span>)],
                      <span class="dt">name =</span> <span class="st">&quot;&quot;</span>, 
                      <span class="dt">guide =</span> <span class="kw">guide_legend</span>(<span class="dt">override.aes =</span> <span class="kw">list</span>(<span class="dt">alpha =</span> <span class="dv">1</span>, 
                                                               <span class="dt">point_shape =</span> <span class="kw">c</span>(<span class="dv">21</span>, <span class="dv">22</span>),
                                                               <span class="dt">point_size =</span> <span class="dv">2</span>))) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_colour_cyclical</span>(<span class="dt">values =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">theme_ridges</span>(<span class="dt">grid =</span> <span class="ot">FALSE</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_discrete_manual</span>(<span class="dt">aesthetics =</span> <span class="st">&quot;point_color&quot;</span>, 
                                  <span class="dt">values =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">4</span>)],
                                  <span class="dt">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_discrete_manual</span>(<span class="dt">aesthetics =</span> <span class="st">&quot;point_fill&quot;</span>,
                                  <span class="dt">values =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">4</span>)],
                                  <span class="dt">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_discrete_manual</span>(<span class="dt">aesthetics =</span> <span class="st">&quot;point_shape&quot;</span>, 
                                  <span class="dt">values =</span> <span class="kw">c</span>(<span class="dv">21</span>, <span class="dv">22</span>),
                                  <span class="dt">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_discrete_manual</span>(<span class="dt">aesthetics =</span> <span class="st">&quot;point_size&quot;</span>, 
                                  <span class="dt">values =</span> <span class="kw">c</span>(.<span class="dv">75</span>, .<span class="dv">75</span>),
                                  <span class="dt">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_discrete_manual</span>(<span class="dt">aesthetics =</span> <span class="st">&quot;point_alpha&quot;</span>, 
                                  <span class="dt">values =</span> <span class="kw">c</span>(<span class="fl">0.1</span>, <span class="fl">0.1</span>),
                                  <span class="dt">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>papaja<span class="op">::</span><span class="kw">theme_apa</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)
## Warning: attributes are not identical across measure variables;
## they will be dropped

target =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;PA_actCop_T1&quot;</span>,
<span class="st">&quot;PA_intention_T1&quot;</span>,
<span class="st">&quot;PA_outcomeExpectations_T1&quot;</span>,
<span class="st">&quot;PA_pbc_T1&quot;</span>,
<span class="st">&quot;PA_selfefficacy_T1&quot;</span>,
<span class="st">&quot;PA_opportunities_T1&quot;</span>,
<span class="st">&quot;PA_dnorm_T1&quot;</span>,
<span class="st">&quot;PA_inorm_T1&quot;</span>)

PA_ci_girls &lt;-<span class="st"> </span>ci_girls <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(diamondlabels <span class="op">%in%</span><span class="st"> </span><span class="kw">names</span>(scales_T1) <span class="op">&amp;</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_actCop_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_intention_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_outcomeExpectations_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_pbc_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_selfefficacy_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_opportunities_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_dnorm_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_inorm_T1&quot;</span>, diamondlabels))

PA_ci_girls &lt;-<span class="st"> </span>PA_ci_girls[<span class="kw">match</span>(target, PA_ci_girls<span class="op">$</span>diamondlabels), ]

PA_ci_boys &lt;-<span class="st"> </span>ci_boys <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(diamondlabels <span class="op">%in%</span><span class="st"> </span><span class="kw">names</span>(scales_T1) <span class="op">&amp;</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_actCop_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_intention_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_outcomeExpectations_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_pbc_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_selfefficacy_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_opportunities_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_dnorm_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_inorm_T1&quot;</span>, diamondlabels))

PA_ci_boys &lt;-<span class="st"> </span>PA_ci_boys[<span class="kw">match</span>(target, PA_ci_boys<span class="op">$</span>diamondlabels), ]

plot1 &lt;-<span class="st"> </span>plot1 <span class="op">+</span><span class="st"> </span>
<span class="st">  </span>userfriendlyscience<span class="op">::</span><span class="kw">diamondPlot</span>(PA_ci_girls, <span class="dt">returnLayerOnly =</span> <span class="ot">TRUE</span>, <span class="dt">linecolor =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">color=</span>viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">1</span>],<span class="co"># &#39;blue&#39;, </span>
                <span class="dt">alpha=</span>.<span class="dv">95</span>, <span class="dt">fixedSize =</span> <span class="fl">0.15</span>, <span class="dt">otherAxisCol =</span> (<span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(target) <span class="op">+</span><span class="st"> </span>.<span class="dv">2</span>)) <span class="op">+</span>
<span class="st">  </span>userfriendlyscience<span class="op">::</span><span class="kw">diamondPlot</span>(PA_ci_boys, <span class="dt">returnLayerOnly =</span> <span class="ot">TRUE</span>, <span class="dt">lineColor =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">color=</span>viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">3</span>], <span class="co">#&#39;green&#39;, </span>
                <span class="dt">alpha=</span>.<span class="dv">95</span>, <span class="dt">fixedSize =</span> <span class="fl">0.15</span>, <span class="dt">otherAxisCol =</span> (<span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(target) <span class="op">+</span><span class="st"> </span>.<span class="dv">2</span>))
## Warning: Ignoring unknown parameters: linecolor
## Warning: Ignoring unknown parameters: linecolor

## Warning: Ignoring unknown parameters: linecolor

## Warning: Ignoring unknown parameters: linecolor

## Warning: Ignoring unknown parameters: linecolor

## Warning: Ignoring unknown parameters: linecolor

## Warning: Ignoring unknown parameters: linecolor

## Warning: Ignoring unknown parameters: linecolor

PA_ci_intervention &lt;-<span class="st"> </span>ci_intervention <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(diamondlabels <span class="op">%in%</span><span class="st"> </span><span class="kw">names</span>(scales_T1) <span class="op">&amp;</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_actCop_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_intention_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_outcomeExpectations_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_pbc_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_selfefficacy_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_opportunities_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_dnorm_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_inorm_T1&quot;</span>, diamondlabels))

PA_ci_intervention &lt;-<span class="st"> </span>PA_ci_intervention[<span class="kw">match</span>(target, PA_ci_intervention<span class="op">$</span>diamondlabels), ]

PA_ci_control &lt;-<span class="st"> </span>ci_control <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(diamondlabels <span class="op">%in%</span><span class="st"> </span><span class="kw">names</span>(scales_T1) <span class="op">&amp;</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_actCop_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_intention_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_outcomeExpectations_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_pbc_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_selfefficacy_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_opportunities_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_dnorm_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_inorm_T1&quot;</span>, diamondlabels))

PA_ci_control &lt;-<span class="st"> </span>PA_ci_control[<span class="kw">match</span>(target, PA_ci_control<span class="op">$</span>diamondlabels), ]

plot2 &lt;-<span class="st"> </span>plot2 <span class="op">+</span><span class="st"> </span>
<span class="st">  </span>userfriendlyscience<span class="op">::</span><span class="kw">diamondPlot</span>(PA_ci_intervention, <span class="dt">returnLayerOnly =</span> <span class="ot">TRUE</span>, <span class="dt">lineColor =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">color=</span>viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">4</span>],<span class="co"># &#39;blue&#39;,</span>
              <span class="dt">alpha=</span>.<span class="dv">95</span>, <span class="dt">fixedSize =</span> <span class="fl">0.15</span>, <span class="dt">otherAxisCol =</span> (<span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(target) <span class="op">+</span><span class="st"> </span>.<span class="dv">2</span>)) <span class="op">+</span>
<span class="st">  </span>userfriendlyscience<span class="op">::</span><span class="kw">diamondPlot</span>(PA_ci_control, <span class="dt">returnLayerOnly =</span> <span class="ot">TRUE</span>, <span class="dt">lineColor =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">color=</span>viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">2</span>], <span class="co">#&#39;red&#39;, </span>
              <span class="dt">alpha=</span>.<span class="dv">95</span>, <span class="dt">fixedSize =</span> <span class="fl">0.15</span>, <span class="dt">otherAxisCol =</span> (<span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(target) <span class="op">+</span><span class="st"> </span>.<span class="dv">2</span>))

plot1 <span class="op">+</span><span class="st"> </span>plot2
## Picking joint bandwidth of 0.337
## Warning: Removed 733 rows containing non-finite values
## (stat_density_ridges).
## Picking joint bandwidth of 0.341
## Warning: Removed 733 rows containing non-finite values
## (stat_density_ridges).</code></pre></div>
<p><img src="baseline-supplement_files/figure-html/bct-determinants-showdata-1.png" width="672" /></p>
</div>
<div id="sb-determinants" class="section level2">
<h2>SB determinants</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># Draw plot with gender densities</span>

plot1 &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(id,
  intervention,
  group,
  school,
  girl,
<span class="st">&#39;SB intention&#39;</span> =<span class="st"> </span>SB_intention_T1,
<span class="st">&#39;SB outcome</span><span class="ch">\n</span><span class="st">expectations&#39;</span> =<span class="st"> </span>SB_outcomeExpectations_T1,
<span class="st">&#39;SB self-efficacy</span><span class="ch">\n</span><span class="st">and perceived</span><span class="ch">\n</span><span class="st">behavioural control&#39;</span> =<span class="st"> </span>SB_sePbc_T1,
<span class="st">&#39;SB descriptive</span><span class="ch">\n</span><span class="st">norm&#39;</span> =<span class="st"> </span>SB_dnorm_T1,
<span class="st">&#39;SB injunctive</span><span class="ch">\n</span><span class="st">norm&#39;</span> =<span class="st"> </span>SB_inorm_T1)  <span class="op">%&gt;%</span>
<span class="st">  </span><span class="co"># dplyr::select(noquote(order(colnames(.)))) %&gt;% # Orders columns alphabetically</span>
<span class="st">  </span>tidyr<span class="op">::</span><span class="kw">gather</span>(<span class="dt">key =</span> Variable, <span class="dt">value =</span> Value, <span class="dv">6</span><span class="op">:</span><span class="kw">ncol</span>(.)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>ggplot2<span class="op">::</span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">y =</span> Variable)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">geom_density_ridges</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Value,
                                    <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>,
                                    <span class="dt">fill =</span> <span class="kw">paste</span>(Variable, girl),
                                    <span class="dt">point_color =</span> girl,
                                    <span class="dt">point_fill =</span> girl,
                                    <span class="dt">point_shape =</span> girl,
                                    <span class="dt">point_size =</span> girl,
                                    <span class="dt">point_alpha =</span> girl),
                                <span class="dt">scale =</span> .<span class="dv">5</span>, <span class="dt">alpha =</span> .<span class="dv">6</span>, <span class="dt">size =</span> <span class="fl">0.25</span>,
                                <span class="dt">from =</span> <span class="dv">1</span>, <span class="dt">to =</span> <span class="dv">7</span>,
                                <span class="dt">position =</span> <span class="kw">position_raincloud</span>(<span class="dt">width =</span> <span class="fl">0.03</span>, <span class="dt">height =</span> <span class="fl">0.5</span>),
                                <span class="dt">jittered_points =</span> <span class="ot">TRUE</span>,
                                <span class="dt">point_size =</span> <span class="dv">1</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="ot">NULL</span>,
       <span class="dt">y =</span> <span class="ot">NULL</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_discrete</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_fill_cyclical</span>(
                      <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&#39;SB descriptive</span><span class="ch">\n</span><span class="st">norm boy&#39;</span> =<span class="st"> &quot;Boy&quot;</span>, <span class="st">&#39;SB descriptive</span><span class="ch">\n</span><span class="st">norm girl&#39;</span> =<span class="st"> &quot;Girl&quot;</span>),
                      <span class="dt">values =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>)],
                      <span class="dt">name =</span> <span class="st">&quot;&quot;</span>, 
                      <span class="dt">guide =</span> <span class="kw">guide_legend</span>(<span class="dt">override.aes =</span> <span class="kw">list</span>(<span class="dt">alpha =</span> <span class="dv">1</span>, 
                                                               <span class="dt">point_shape =</span> <span class="kw">c</span>(<span class="dv">24</span>, <span class="dv">25</span>),
                                                               <span class="dt">point_size =</span> <span class="dv">2</span>))) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_colour_cyclical</span>(<span class="dt">values =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">theme_ridges</span>(<span class="dt">grid =</span> <span class="ot">FALSE</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_discrete_manual</span>(<span class="dt">aesthetics =</span> <span class="st">&quot;point_color&quot;</span>, 
                                  <span class="dt">values =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>)],
                                  <span class="dt">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_discrete_manual</span>(<span class="dt">aesthetics =</span> <span class="st">&quot;point_fill&quot;</span>,
                                  <span class="dt">values =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>)],
                                  <span class="dt">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_discrete_manual</span>(<span class="dt">aesthetics =</span> <span class="st">&quot;point_shape&quot;</span>, 
                                  <span class="dt">values =</span> <span class="kw">c</span>(<span class="dv">24</span>, <span class="dv">25</span>),
                                  <span class="dt">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_discrete_manual</span>(<span class="dt">aesthetics =</span> <span class="st">&quot;point_size&quot;</span>, 
                                  <span class="dt">values =</span> <span class="kw">c</span>(.<span class="dv">75</span>, .<span class="dv">75</span>),
                                  <span class="dt">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_discrete_manual</span>(<span class="dt">aesthetics =</span> <span class="st">&quot;point_alpha&quot;</span>, 
                                  <span class="dt">values =</span> <span class="kw">c</span>(<span class="fl">0.1</span>, <span class="fl">0.1</span>),
                                  <span class="dt">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>papaja<span class="op">::</span><span class="kw">theme_apa</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)

plot2 &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(id,
  intervention,
  group,
  school,
  girl,
<span class="st">&#39;SB intention&#39;</span> =<span class="st"> </span>SB_intention_T1,
<span class="st">&#39;SB outcome</span><span class="ch">\n</span><span class="st">expectations&#39;</span> =<span class="st"> </span>SB_outcomeExpectations_T1,
<span class="st">&#39;SB self-efficacy</span><span class="ch">\n</span><span class="st">and perceived</span><span class="ch">\n</span><span class="st">behavioural control&#39;</span> =<span class="st"> </span>SB_sePbc_T1,
<span class="st">&#39;SB descriptive</span><span class="ch">\n</span><span class="st">norm&#39;</span> =<span class="st"> </span>SB_dnorm_T1,
<span class="st">&#39;SB injunctive</span><span class="ch">\n</span><span class="st">norm&#39;</span> =<span class="st"> </span>SB_inorm_T1)  <span class="op">%&gt;%</span>
<span class="st">  </span><span class="co"># dplyr::select(noquote(order(colnames(.)))) %&gt;% # Orders columns alphabetically</span>
<span class="st">  </span>tidyr<span class="op">::</span><span class="kw">gather</span>(<span class="dt">key =</span> Variable, <span class="dt">value =</span> Value, <span class="dv">6</span><span class="op">:</span><span class="kw">ncol</span>(.)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>ggplot2<span class="op">::</span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">y =</span> Variable)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">geom_density_ridges</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Value,
                                    <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>,
                                    <span class="dt">fill =</span> <span class="kw">paste</span>(Variable, intervention),
                                    <span class="dt">point_color =</span> intervention,
                                    <span class="dt">point_fill =</span> intervention,
                                    <span class="dt">point_shape =</span> intervention,
                                    <span class="dt">point_size =</span> intervention,
                                    <span class="dt">point_alpha =</span> intervention),
                                <span class="dt">scale =</span> .<span class="dv">5</span>, <span class="dt">alpha =</span> .<span class="dv">6</span>, <span class="dt">size =</span> <span class="fl">0.25</span>,
                                <span class="dt">from =</span> <span class="dv">1</span>, <span class="dt">to =</span> <span class="dv">7</span>,
                                <span class="dt">position =</span> <span class="kw">position_raincloud</span>(<span class="dt">width =</span> <span class="fl">0.03</span>, <span class="dt">height =</span> <span class="fl">0.5</span>),
                                <span class="dt">jittered_points =</span> <span class="ot">TRUE</span>,
                                <span class="dt">point_size =</span> <span class="dv">1</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="ot">NULL</span>,
       <span class="dt">y =</span> <span class="ot">NULL</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_discrete</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>), <span class="dt">labels =</span> <span class="ot">NULL</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_fill_cyclical</span>(
                      <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&#39;SB descriptive</span><span class="ch">\n</span><span class="st">norm 0&#39;</span> =<span class="st"> &quot;Control&quot;</span>, <span class="st">&#39;SB descriptive</span><span class="ch">\n</span><span class="st">norm 1&#39;</span> =<span class="st"> &quot;intervention&quot;</span>),
                      <span class="dt">values =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">4</span>)],
                      <span class="dt">name =</span> <span class="st">&quot;&quot;</span>, 
                      <span class="dt">guide =</span> <span class="kw">guide_legend</span>(<span class="dt">override.aes =</span> <span class="kw">list</span>(<span class="dt">alpha =</span> <span class="dv">1</span>, 
                                                               <span class="dt">point_shape =</span> <span class="kw">c</span>(<span class="dv">21</span>, <span class="dv">22</span>),
                                                               <span class="dt">point_size =</span> <span class="dv">2</span>))) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_colour_cyclical</span>(<span class="dt">values =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">theme_ridges</span>(<span class="dt">grid =</span> <span class="ot">FALSE</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_discrete_manual</span>(<span class="dt">aesthetics =</span> <span class="st">&quot;point_color&quot;</span>, 
                                  <span class="dt">values =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">4</span>)],
                                  <span class="dt">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_discrete_manual</span>(<span class="dt">aesthetics =</span> <span class="st">&quot;point_fill&quot;</span>,
                                  <span class="dt">values =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">4</span>)],
                                  <span class="dt">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_discrete_manual</span>(<span class="dt">aesthetics =</span> <span class="st">&quot;point_shape&quot;</span>, 
                                  <span class="dt">values =</span> <span class="kw">c</span>(<span class="dv">21</span>, <span class="dv">22</span>),
                                  <span class="dt">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_discrete_manual</span>(<span class="dt">aesthetics =</span> <span class="st">&quot;point_size&quot;</span>, 
                                  <span class="dt">values =</span> <span class="kw">c</span>(.<span class="dv">75</span>, .<span class="dv">75</span>),
                                  <span class="dt">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_discrete_manual</span>(<span class="dt">aesthetics =</span> <span class="st">&quot;point_alpha&quot;</span>, 
                                  <span class="dt">values =</span> <span class="kw">c</span>(<span class="fl">0.1</span>, <span class="fl">0.1</span>),
                                  <span class="dt">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>papaja<span class="op">::</span><span class="kw">theme_apa</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)

plot1 <span class="op">+</span><span class="st"> </span>plot2
## Picking joint bandwidth of 0.311
## Warning: Removed 507 rows containing non-finite values
## (stat_density_ridges).
## Picking joint bandwidth of 0.317
## Warning: Removed 507 rows containing non-finite values
## (stat_density_ridges).</code></pre></div>
<p><img src="baseline-supplement_files/figure-html/sb-determinants-1.png" width="672" /></p>
</div>
</div>
<div id="informativeness-of-averages" class="section level1">
<h1>Informativeness of averages</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># total_n &lt;- df %&gt;% select(paAccelerometer_T1, sitLieAccelerometer_T1, padaysLastweek_T1, sitBreaks_T1) %&gt;% </span>
<span class="co">#   na.omit(.) %&gt;% </span>
<span class="co">#   summarise(n = n())</span>
                     
middle_x_percentile &lt;-<span class="st"> </span><span class="cf">function</span>(middle_percentile) {
  df <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>((df<span class="op">$</span>paAccelerometer_T1 <span class="op">&gt;</span><span class="st"> </span><span class="kw">quantile</span>(df<span class="op">$</span>paAccelerometer_T1, <span class="dt">probs =</span> <span class="kw">c</span>(<span class="fl">0.5</span> <span class="op">-</span><span class="st"> </span>middle_percentile<span class="op">/</span><span class="dv">2</span>, <span class="fl">0.5</span> <span class="op">+</span><span class="st"> </span>middle_percentile<span class="op">/</span><span class="dv">2</span>), <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)[[<span class="dv">1</span>]]) <span class="op">&amp;</span>
<span class="st">                  </span>(df<span class="op">$</span>paAccelerometer_T1 <span class="op">&lt;</span><span class="st"> </span><span class="kw">quantile</span>(df<span class="op">$</span>paAccelerometer_T1, <span class="dt">probs =</span> <span class="kw">c</span>(<span class="fl">0.5</span> <span class="op">-</span><span class="st"> </span>middle_percentile<span class="op">/</span><span class="dv">2</span>, <span class="fl">0.5</span> <span class="op">+</span><span class="st"> </span>middle_percentile<span class="op">/</span><span class="dv">2</span>), <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)[[<span class="dv">2</span>]]) <span class="op">&amp;</span>
<span class="st">                </span>(df<span class="op">$</span>sitLieAccelerometer_T1 <span class="op">&gt;</span><span class="st"> </span><span class="kw">quantile</span>(df<span class="op">$</span>sitLieAccelerometer_T1, <span class="dt">probs =</span> <span class="kw">c</span>(<span class="fl">0.5</span> <span class="op">-</span><span class="st"> </span>middle_percentile<span class="op">/</span><span class="dv">2</span>, <span class="fl">0.5</span> <span class="op">+</span><span class="st"> </span>middle_percentile<span class="op">/</span><span class="dv">2</span>), <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)[[<span class="dv">1</span>]]) <span class="op">&amp;</span>
<span class="st">                 </span>(df<span class="op">$</span>sitLieAccelerometer_T1 <span class="op">&lt;</span><span class="st"> </span><span class="kw">quantile</span>(df<span class="op">$</span>sitLieAccelerometer_T1, <span class="dt">probs =</span> <span class="kw">c</span>(<span class="fl">0.5</span> <span class="op">-</span><span class="st"> </span>middle_percentile<span class="op">/</span><span class="dv">2</span>, <span class="fl">0.5</span> <span class="op">+</span><span class="st"> </span>middle_percentile<span class="op">/</span><span class="dv">2</span>), <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)[[<span class="dv">2</span>]]) <span class="op">&amp;</span><span class="st"> </span>
<span class="st">                </span>(df<span class="op">$</span>padaysLastweek_T1 <span class="op">&gt;</span><span class="st"> </span><span class="kw">quantile</span>(df<span class="op">$</span>padaysLastweek_T1, <span class="dt">probs =</span> <span class="kw">c</span>(<span class="fl">0.5</span> <span class="op">-</span><span class="st"> </span>middle_percentile<span class="op">/</span><span class="dv">2</span>, <span class="fl">0.5</span> <span class="op">+</span><span class="st"> </span>middle_percentile<span class="op">/</span><span class="dv">2</span>), <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)[[<span class="dv">1</span>]]) <span class="op">&amp;</span>
<span class="st">                  </span>(df<span class="op">$</span>padaysLastweek_T1 <span class="op">&lt;</span><span class="st"> </span><span class="kw">quantile</span>(df<span class="op">$</span>padaysLastweek_T1, <span class="dt">probs =</span> <span class="kw">c</span>(<span class="fl">0.5</span> <span class="op">-</span><span class="st"> </span>middle_percentile<span class="op">/</span><span class="dv">2</span>, <span class="fl">0.5</span> <span class="op">+</span><span class="st"> </span>middle_percentile<span class="op">/</span><span class="dv">2</span>), <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)[[<span class="dv">2</span>]]) <span class="op">&amp;</span>
<span class="st">                </span>(df<span class="op">$</span>sitBreaks_T1 <span class="op">&gt;</span><span class="st"> </span><span class="kw">quantile</span>(df<span class="op">$</span>sitBreaks_T1, <span class="dt">probs =</span> <span class="kw">c</span>(<span class="fl">0.5</span> <span class="op">-</span><span class="st"> </span>middle_percentile<span class="op">/</span><span class="dv">2</span>, <span class="fl">0.5</span> <span class="op">+</span><span class="st"> </span>middle_percentile<span class="op">/</span><span class="dv">2</span>), <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)[[<span class="dv">1</span>]]) <span class="op">&amp;</span>
<span class="st">                  </span>(df<span class="op">$</span>sitBreaks_T1 <span class="op">&lt;</span><span class="st"> </span><span class="kw">quantile</span>(df<span class="op">$</span>sitBreaks_T1, <span class="dt">probs =</span> <span class="kw">c</span>(<span class="fl">0.5</span> <span class="op">-</span><span class="st"> </span>middle_percentile<span class="op">/</span><span class="dv">2</span>, <span class="fl">0.5</span> <span class="op">+</span><span class="st"> </span>middle_percentile<span class="op">/</span><span class="dv">2</span>), <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)[[<span class="dv">2</span>]])) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span><span class="kw">nrow</span>(.)
}
  

getmiddle &lt;-<span class="st"> </span><span class="cf">function</span>(middlePerc) {                                       
df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(paAccelerometer_T1, padaysLastweek_T1, sitLieAccelerometer_T1, sitBreaks_T1) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">na.omit</span>(.) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">summarise</span>(<span class="dt">n =</span> <span class="kw">n</span>(), 
                   <span class="dt">middle =</span> <span class="kw">sum</span>((paAccelerometer_T1 <span class="op">&gt;</span><span class="st"> </span>
<span class="st">                                       </span>(<span class="kw">quantile</span>(paAccelerometer_T1, <span class="dt">probs =</span> <span class="kw">c</span>(<span class="fl">0.5</span> <span class="op">-</span><span class="st"> </span>middlePerc<span class="op">/</span><span class="dv">2</span>, <span class="fl">0.5</span> <span class="op">+</span><span class="st"> </span>middlePerc<span class="op">/</span><span class="dv">2</span>))[[<span class="dv">1</span>]])) <span class="op">&amp;</span><span class="st"> </span>
<span class="st">                                      </span>(paAccelerometer_T1 <span class="op">&lt;</span><span class="st"> </span>
<span class="st">                                       </span>(<span class="kw">quantile</span>(paAccelerometer_T1, <span class="dt">probs =</span> <span class="kw">c</span>(<span class="fl">0.5</span> <span class="op">-</span><span class="st"> </span>middlePerc<span class="op">/</span><span class="dv">2</span>, <span class="fl">0.5</span> <span class="op">+</span><span class="st"> </span>middlePerc<span class="op">/</span><span class="dv">2</span>))[[<span class="dv">2</span>]])) <span class="op">&amp;</span>
<span class="st">                                      </span>(padaysLastweek_T1 <span class="op">&gt;</span><span class="st"> </span>
<span class="st">                                       </span>(<span class="kw">quantile</span>(padaysLastweek_T1, <span class="dt">probs =</span> <span class="kw">c</span>(<span class="fl">0.5</span> <span class="op">-</span><span class="st"> </span>middlePerc<span class="op">/</span><span class="dv">2</span>, <span class="fl">0.5</span> <span class="op">+</span><span class="st"> </span>middlePerc<span class="op">/</span><span class="dv">2</span>))[[<span class="dv">1</span>]])) <span class="op">&amp;</span><span class="st"> </span>
<span class="st">                                      </span>(padaysLastweek_T1 <span class="op">&lt;</span><span class="st"> </span>
<span class="st">                                       </span>(<span class="kw">quantile</span>(padaysLastweek_T1, <span class="dt">probs =</span> <span class="kw">c</span>(<span class="fl">0.5</span> <span class="op">-</span><span class="st"> </span>middlePerc<span class="op">/</span><span class="dv">2</span>, <span class="fl">0.5</span> <span class="op">+</span><span class="st"> </span>middlePerc<span class="op">/</span><span class="dv">2</span>))[[<span class="dv">2</span>]])) <span class="op">&amp;</span>
<span class="st">                                      </span>(sitLieAccelerometer_T1 <span class="op">&gt;</span><span class="st"> </span>
<span class="st">                                       </span>(<span class="kw">quantile</span>(sitLieAccelerometer_T1, <span class="dt">probs =</span> <span class="kw">c</span>(<span class="fl">0.5</span> <span class="op">-</span><span class="st"> </span>middlePerc<span class="op">/</span><span class="dv">2</span>, <span class="fl">0.5</span> <span class="op">+</span><span class="st"> </span>middlePerc<span class="op">/</span><span class="dv">2</span>))[[<span class="dv">1</span>]])) <span class="op">&amp;</span><span class="st"> </span>
<span class="st">                                      </span>(sitLieAccelerometer_T1 <span class="op">&lt;</span><span class="st"> </span>
<span class="st">                                       </span>(<span class="kw">quantile</span>(sitLieAccelerometer_T1, <span class="dt">probs =</span> <span class="kw">c</span>(<span class="fl">0.5</span> <span class="op">-</span><span class="st"> </span>middlePerc<span class="op">/</span><span class="dv">2</span>, <span class="fl">0.5</span> <span class="op">+</span><span class="st"> </span>middlePerc<span class="op">/</span><span class="dv">2</span>))[[<span class="dv">2</span>]])) <span class="op">&amp;</span>
<span class="st">                                      </span>(sitBreaks_T1 <span class="op">&gt;</span><span class="st"> </span>
<span class="st">                                       </span>(<span class="kw">quantile</span>(sitBreaks_T1, <span class="dt">probs =</span> <span class="kw">c</span>(<span class="fl">0.5</span> <span class="op">-</span><span class="st"> </span>middlePerc<span class="op">/</span><span class="dv">2</span>, <span class="fl">0.5</span> <span class="op">+</span><span class="st"> </span>middlePerc<span class="op">/</span><span class="dv">2</span>))[[<span class="dv">1</span>]])) <span class="op">&amp;</span><span class="st"> </span>
<span class="st">                                      </span>(sitBreaks_T1 <span class="op">&lt;</span><span class="st"> </span>
<span class="st">                                       </span>(<span class="kw">quantile</span>(sitBreaks_T1, <span class="dt">probs =</span> <span class="kw">c</span>(<span class="fl">0.5</span> <span class="op">-</span><span class="st"> </span>middlePerc<span class="op">/</span><span class="dv">2</span>, <span class="fl">0.5</span> <span class="op">+</span><span class="st"> </span>middlePerc<span class="op">/</span><span class="dv">2</span>))[[<span class="dv">2</span>]]))
                                     )) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span><span class="kw">mutate</span>(<span class="dt">perc =</span> middle<span class="op">/</span>n)
}


middleprobs &lt;-<span class="st"> </span><span class="cf">function</span>(prob1, prob2) {
<span class="kw">sum</span>(df<span class="op">$</span>paAccelerometer_T1 <span class="op">&gt;=</span><span class="st"> </span><span class="kw">quantile</span>(df<span class="op">$</span>paAccelerometer_T1, <span class="dt">probs =</span> <span class="kw">c</span>(prob1, prob2), <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)[[<span class="dv">1</span>]] <span class="op">&amp;</span>
<span class="st">      </span>df<span class="op">$</span>paAccelerometer_T1 <span class="op">&lt;=</span><span class="st"> </span><span class="kw">quantile</span>(df<span class="op">$</span>paAccelerometer_T1, <span class="dt">probs =</span> <span class="kw">c</span>(prob1, prob2), <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)[[<span class="dv">2</span>]] <span class="op">&amp;</span>
<span class="st">    </span>df<span class="op">$</span>padaysLastweek_T1 <span class="op">&gt;=</span><span class="st"> </span><span class="kw">quantile</span>(df<span class="op">$</span>padaysLastweek_T1, <span class="dt">probs =</span> <span class="kw">c</span>(prob1, prob2), <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)[[<span class="dv">1</span>]] <span class="op">&amp;</span>
<span class="st">      </span>df<span class="op">$</span>padaysLastweek_T1 <span class="op">&lt;=</span><span class="st"> </span><span class="kw">quantile</span>(df<span class="op">$</span>padaysLastweek_T1, <span class="dt">probs =</span> <span class="kw">c</span>(prob1, prob2), <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)[[<span class="dv">2</span>]] <span class="op">&amp;</span>
<span class="st">    </span>df<span class="op">$</span>sitLieAccelerometer_T1 <span class="op">&gt;=</span><span class="st"> </span><span class="kw">quantile</span>(df<span class="op">$</span>sitLieAccelerometer_T1, <span class="dt">probs =</span> <span class="kw">c</span>(prob1, prob2), <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)[[<span class="dv">1</span>]] <span class="op">&amp;</span>
<span class="st">      </span>df<span class="op">$</span>sitLieAccelerometer_T1 <span class="op">&lt;=</span><span class="st"> </span><span class="kw">quantile</span>(df<span class="op">$</span>sitLieAccelerometer_T1, <span class="dt">probs =</span> <span class="kw">c</span>(prob1, prob2), <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)[[<span class="dv">2</span>]] <span class="op">&amp;</span>
<span class="st">    </span>df<span class="op">$</span>sitBreaks_T1 <span class="op">&gt;=</span><span class="st"> </span><span class="kw">quantile</span>(df<span class="op">$</span>sitBreaks_T1, <span class="dt">probs =</span> <span class="kw">c</span>(prob1, prob2), <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)[[<span class="dv">1</span>]] <span class="op">&amp;</span>
<span class="st">      </span>df<span class="op">$</span>sitBreaks_T1 <span class="op">&lt;=</span><span class="st"> </span><span class="kw">quantile</span>(df<span class="op">$</span>sitBreaks_T1, <span class="dt">probs =</span> <span class="kw">c</span>(prob1, prob2), <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)[[<span class="dv">2</span>]],
    <span class="dt">na.rm=</span> <span class="ot">TRUE</span>) 
}    

<span class="co"># # How to use these functions:</span>
<span class="co"># middleprobs(1/3, 2/3) </span>
<span class="co"># middle_x_percentile(1/3)</span>
<span class="co"># getmiddle(1/3)</span>

<span class="co"># # the gettmiddle function doesn&#39;t work like the others. Because it omits na from the start?</span>

<span class="co"># # middle_x_percentile(1) gives a number != total, because it&#39;s exclusive of the ends. See difference between</span>

<span class="co"># sum(df$paAccelerometer_T1 &gt;= min(df$paAccelerometer_T1, na.rm = TRUE) &amp;</span>
<span class="co">#       df$paAccelerometer_T1 &lt;= max(df$paAccelerometer_T1, na.rm = TRUE) &amp;</span>
<span class="co">#     df$padaysLastweek_T1 &gt;= min(df$padaysLastweek_T1, na.rm = TRUE) &amp;</span>
<span class="co">#       df$padaysLastweek_T1 &lt;= max(df$padaysLastweek_T1, na.rm = TRUE) &amp;</span>
<span class="co">#     df$sitLieAccelerometer_T1 &gt;= min(df$sitLieAccelerometer_T1, na.rm = TRUE) &amp;</span>
<span class="co">#       df$sitLieAccelerometer_T1 &lt;= max(df$sitLieAccelerometer_T1, na.rm = TRUE) &amp;</span>
<span class="co">#     df$sitBreaks_T1 &gt;= min(df$sitBreaks_T1, na.rm = TRUE) &amp;</span>
<span class="co">#       df$sitBreaks_T1 &lt;= max(df$sitBreaks_T1, na.rm = TRUE),</span>
<span class="co">#     na.rm= TRUE) </span>

<span class="co"># # and</span>

<span class="co"># sum(df$paAccelerometer_T1 &gt; min(df$paAccelerometer_T1, na.rm = TRUE) &amp;</span>
<span class="co">#       df$paAccelerometer_T1 &lt; max(df$paAccelerometer_T1, na.rm = TRUE) &amp;</span>
<span class="co">#     df$padaysLastweek_T1 &gt; min(df$padaysLastweek_T1, na.rm = TRUE) &amp;</span>
<span class="co">#       df$padaysLastweek_T1 &lt; max(df$padaysLastweek_T1, na.rm = TRUE) &amp;</span>
<span class="co">#     df$sitLieAccelerometer_T1 &gt; min(df$sitLieAccelerometer_T1, na.rm = TRUE) &amp;</span>
<span class="co">#       df$sitLieAccelerometer_T1 &lt; max(df$sitLieAccelerometer_T1, na.rm = TRUE) &amp;</span>
<span class="co">#     df$sitBreaks_T1 &gt; min(df$sitBreaks_T1, na.rm = TRUE) &amp;</span>
<span class="co">#       df$sitBreaks_T1 &lt; max(df$sitBreaks_T1, na.rm = TRUE),</span>
<span class="co">#     na.rm= TRUE) </span>

middle_df &lt;-<span class="st"> </span><span class="ot">NA</span>
  
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">100</span>) {
middle_df[i] &lt;-<span class="st"> </span><span class="kw">middleprobs</span>(<span class="fl">0.5</span> <span class="op">-</span><span class="st"> </span>i<span class="op">/</span><span class="dv">2</span><span class="op">/</span><span class="dv">100</span>, <span class="fl">0.5</span> <span class="op">+</span><span class="st"> </span>i<span class="op">/</span><span class="dv">2</span><span class="op">/</span><span class="dv">100</span>) <span class="op">/</span><span class="st"> </span><span class="dv">706</span>   
}

meansplot_df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">middle_band_width_perc =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">100</span>, <span class="dt">perc_of_participants_included =</span> middle_df)

meansplot_df <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">y =</span> <span class="dv">100</span> <span class="op">*</span><span class="st"> </span>perc_of_participants_included, <span class="dt">x =</span> middle_band_width_perc)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;The Stereotypical Participant?&quot;</span>, 
       <span class="dt">y =</span> <span class="st">&quot;% of participants included&quot;</span>, 
       <span class="dt">x =</span> <span class="st">&quot;Middle x percent (width of band around the median on all primary outcome variables)&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">100</span>, <span class="dt">by =</span> <span class="dv">10</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">100</span>, <span class="dt">by =</span> <span class="dv">10</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> <span class="dv">0</span>, <span class="dt">ymax =</span> <span class="dv">100</span> <span class="op">*</span><span class="st"> </span>perc_of_participants_included), <span class="dt">fill=</span><span class="st">&quot;blue&quot;</span>, <span class="dt">alpha=</span><span class="st">&quot;0.5&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme_light</span>()</code></pre></div>
<p><img src="baseline-supplement_files/figure-html/average-coverage-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># # This makes an inferior plot:</span>
<span class="co">#</span>
<span class="co"># middle_df2 &lt;- NA</span>
<span class="co"># </span>
<span class="co"># for(i in 1:100) {</span>
<span class="co"># middle_df2[i] &lt;- middleprobs(0.5 - i/2/100, 0.5 + i/2/100) / 706   </span>
<span class="co"># }</span>
<span class="co"># </span>
<span class="co"># meansplot_df2 &lt;- data.frame(middle_band_width_perc = c(1:100), hi = 0.5 + middle_df2/2, lo = 0.5 - middle_df2/2)</span>
<span class="co"># </span>
<span class="co"># meansplot_df &lt;- data.frame(middle_band_width_perc = 1:100, perc_of_participants_included = middle_df)</span>
<span class="co">#</span>
<span class="co"># meansplot_df2 %&gt;% </span>
<span class="co">#   ggplot(aes(y = 100 * hi, x = middle_band_width_perc)) +</span>
<span class="co">#   geom_line() +</span>
<span class="co">#   # geom_line(aes(y = 100 * lo, x = middle_band_width_perc)) +</span>
<span class="co">#   labs(title = &quot;The Stereotypical Participant?&quot;, </span>
<span class="co">#        y = &quot;% of participants covered&quot;, </span>
<span class="co">#        x = &quot;Definition of average (\&quot;middle x percent\&quot;, or \&quot;width of band around the median on all the variables\&quot;)&quot;) +</span>
<span class="co">#   # geom_ribbon(aes(ymin = 0, ymax = 100 * hi), fill=&quot;blue&quot;, alpha=&quot;0.5&quot;) +</span>
<span class="co">#   scale_y_continuous(breaks = seq(0, 100, by = 10)) +</span>
<span class="co">#   scale_x_continuous(breaks = seq(0, 100, by = 10)) +</span>
<span class="co">#   theme_light()</span></code></pre></div>
<p>2 percent of participants fell in the middle 30% of all four outcome variables.</p>
</div>
<div id="types-of-self-reported-exercise" class="section level1">
<h1>Types of self-reported exercise</h1>
<p>This section describes the proportions of participants reporting they did a certain type of activity during the last month.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
exerciseTypes_df &lt;-<span class="st"> </span>lmi <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(Kys0051.<span class="dv">1</span><span class="op">:</span>Kys0064.<span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="kw">contains</span>(<span class="st">&quot;.1&quot;</span>))
exerciseTypes_df<span class="op">$</span>track &lt;-<span class="st"> </span>df<span class="op">$</span>track
exerciseTypes_df<span class="op">$</span>girl &lt;-<span class="st"> </span>df<span class="op">$</span>girl

<span class="kw">names</span>(exerciseTypes_df) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Team ball games&quot;</span>, 
                             <span class="st">&quot;Other ball games&quot;</span>,
                             <span class="st">&quot;Gym training&quot;</span>,
                             <span class="st">&quot;Combat sports&quot;</span>,
                             <span class="st">&quot;Fitness classes&quot;</span>,
                             <span class="st">&quot;Home workout&quot;</span>,
                             <span class="st">&quot;Cycling&quot;</span>,
                             <span class="st">&quot;Swimming&quot;</span>,
                             <span class="st">&quot;Walking&quot;</span>,
                             <span class="st">&quot;Running&quot;</span>,
                             <span class="st">&quot;Skiing&quot;</span>,
                             <span class="st">&quot;Roller skating&quot;</span>,
                             <span class="st">&quot;Horseback riding&quot;</span>,
                             <span class="st">&quot;Other&quot;</span>,
                             <span class="st">&quot;track&quot;</span>,
                             <span class="st">&quot;girl&quot;</span>
                             )

<span class="co"># For educational tracks</span>

exerciseTypes_proportions &lt;-<span class="st"> </span>exerciseTypes_df <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(track), track <span class="op">!=</span><span class="st"> &quot;Other&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate_at</span>(<span class="kw">vars</span>(<span class="st">`</span><span class="dt">Team ball games</span><span class="st">`</span><span class="op">:</span><span class="st">`</span><span class="dt">Other</span><span class="st">`</span>), <span class="kw">funs</span>(<span class="kw">replace_na</span>(., <span class="dv">0</span>))) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># replace NA&#39;s with 0</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">group_by</span>(track) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">summarise_at</span>(<span class="kw">vars</span>(<span class="st">`</span><span class="dt">Team ball games</span><span class="st">`</span><span class="op">:</span><span class="st">`</span><span class="dt">Other</span><span class="st">`</span>), <span class="kw">funs</span>(<span class="kw">mean</span>(., <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)))

exerciseTypes_cases &lt;-<span class="st"> </span>exerciseTypes_df <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(track), track <span class="op">!=</span><span class="st"> &quot;Other&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate_at</span>(<span class="kw">vars</span>(<span class="st">`</span><span class="dt">Team ball games</span><span class="st">`</span><span class="op">:</span><span class="st">`</span><span class="dt">Other</span><span class="st">`</span>), <span class="kw">funs</span>(<span class="kw">replace_na</span>(., <span class="dv">0</span>))) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># replace NA&#39;s with 0</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">group_by</span>(track) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">summarise_at</span>(<span class="kw">vars</span>(<span class="st">`</span><span class="dt">Team ball games</span><span class="st">`</span><span class="op">:</span><span class="st">`</span><span class="dt">Other</span><span class="st">`</span>), sum) 

exerciseTypes_totals &lt;-<span class="st"> </span>exerciseTypes_df <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(track), track <span class="op">!=</span><span class="st"> &quot;Other&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate_at</span>(<span class="kw">vars</span>(<span class="st">`</span><span class="dt">Team ball games</span><span class="st">`</span><span class="op">:</span><span class="st">`</span><span class="dt">Other</span><span class="st">`</span>), <span class="kw">funs</span>(<span class="kw">replace_na</span>(., <span class="dv">0</span>))) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># replace NA&#39;s with 0</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">group_by</span>(track) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">summarise_at</span>(<span class="kw">vars</span>(<span class="st">`</span><span class="dt">Team ball games</span><span class="st">`</span><span class="op">:</span><span class="st">`</span><span class="dt">Other</span><span class="st">`</span>), <span class="kw">funs</span>(<span class="kw">sum</span>(<span class="op">!</span><span class="kw">is.na</span>(.))))

exerciseTypes_pvals &lt;-<span class="st"> </span><span class="ot">NA</span> <span class="co"># Empty vector to be filled</span>

<span class="cf">for</span> (i <span class="cf">in</span> (<span class="dv">2</span><span class="op">:</span><span class="dv">15</span>)) {
exerciseTypes_test &lt;-<span class="st"> </span><span class="kw">data.frame</span>(exerciseTypes_cases[ , i], exerciseTypes_totals[ , i])
exerciseTypes_pvals[i<span class="op">-</span><span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">prop.test</span>(exerciseTypes_test[, <span class="dv">1</span>], exerciseTypes_test[, <span class="dv">2</span>])<span class="op">$</span>p.value <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">round</span>(., <span class="dv">5</span>)
}
## Warning in prop.test(exerciseTypes_test[, 1], exerciseTypes_test[, 2]):
## Chi-squared approximation may be incorrect

<span class="kw">data.frame</span>(<span class="st">&quot;Exercise type&quot;</span> =<span class="st"> </span><span class="kw">names</span>(exerciseTypes_df)[<span class="dv">1</span><span class="op">:</span><span class="dv">14</span>], <span class="st">&quot;p-values: educational tracks&quot;</span> =<span class="st"> </span>exerciseTypes_pvals) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>papaja<span class="op">::</span><span class="kw">apa_table</span>()</code></pre></div>
<caption>
(#tab:exerciseTypes)
</caption>
<caption>
**
</caption>
<table>
<thead>
<tr class="header">
<th align="left">Exercise.type</th>
<th align="left">p.values..educational.tracks</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Team ball games</td>
<td align="left">0.00</td>
</tr>
<tr class="even">
<td align="left">Other ball games</td>
<td align="left">0.33</td>
</tr>
<tr class="odd">
<td align="left">Gym training</td>
<td align="left">0.00</td>
</tr>
<tr class="even">
<td align="left">Combat sports</td>
<td align="left">0.25</td>
</tr>
<tr class="odd">
<td align="left">Fitness classes</td>
<td align="left">0.02</td>
</tr>
<tr class="even">
<td align="left">Home workout</td>
<td align="left">0.00</td>
</tr>
<tr class="odd">
<td align="left">Cycling</td>
<td align="left">0.00</td>
</tr>
<tr class="even">
<td align="left">Swimming</td>
<td align="left">0.00</td>
</tr>
<tr class="odd">
<td align="left">Walking</td>
<td align="left">0.00</td>
</tr>
<tr class="even">
<td align="left">Running</td>
<td align="left">0.00</td>
</tr>
<tr class="odd">
<td align="left">Skiing</td>
<td align="left">0.00</td>
</tr>
<tr class="even">
<td align="left">Roller skating</td>
<td align="left">0.30</td>
</tr>
<tr class="odd">
<td align="left">Horseback riding</td>
<td align="left">0.47</td>
</tr>
<tr class="even">
<td align="left">Other</td>
<td align="left">0.94</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
exerciseTypes_proportions <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>papaja<span class="op">::</span><span class="kw">apa_table</span>()</code></pre></div>
<caption>
(#tab:exerciseTypes)
</caption>
<caption>
**
</caption>
<table>
<thead>
<tr class="header">
<th align="left">track</th>
<th align="left">Team ball games</th>
<th align="left">Other ball games</th>
<th align="left">Gym training</th>
<th align="left">Combat sports</th>
<th align="left">Fitness classes</th>
<th align="left">Home workout</th>
<th align="left">Cycling</th>
<th align="left">Swimming</th>
<th align="left">Walking</th>
<th align="left">Running</th>
<th align="left">Skiing</th>
<th align="left">Roller skating</th>
<th align="left">Horseback riding</th>
<th align="left">Other</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">IT</td>
<td align="left">0.16</td>
<td align="left">0.07</td>
<td align="left">0.29</td>
<td align="left">0.09</td>
<td align="left">0.01</td>
<td align="left">0.07</td>
<td align="left">0.15</td>
<td align="left">0.05</td>
<td align="left">0.52</td>
<td align="left">0.13</td>
<td align="left">0.04</td>
<td align="left">0.00</td>
<td align="left">0.02</td>
<td align="left">0.10</td>
</tr>
<tr class="even">
<td align="left">BA</td>
<td align="left">0.30</td>
<td align="left">0.06</td>
<td align="left">0.45</td>
<td align="left">0.09</td>
<td align="left">0.07</td>
<td align="left">0.22</td>
<td align="left">0.08</td>
<td align="left">0.04</td>
<td align="left">0.39</td>
<td align="left">0.26</td>
<td align="left">0.05</td>
<td align="left">0.00</td>
<td align="left">0.04</td>
<td align="left">0.10</td>
</tr>
<tr class="odd">
<td align="left">HRC</td>
<td align="left">0.16</td>
<td align="left">0.03</td>
<td align="left">0.41</td>
<td align="left">0.07</td>
<td align="left">0.05</td>
<td align="left">0.23</td>
<td align="left">0.08</td>
<td align="left">0.05</td>
<td align="left">0.52</td>
<td align="left">0.27</td>
<td align="left">0.08</td>
<td align="left">0.00</td>
<td align="left">0.02</td>
<td align="left">0.11</td>
</tr>
<tr class="even">
<td align="left">Nur</td>
<td align="left">0.19</td>
<td align="left">0.07</td>
<td align="left">0.35</td>
<td align="left">0.05</td>
<td align="left">0.06</td>
<td align="left">0.23</td>
<td align="left">0.24</td>
<td align="left">0.16</td>
<td align="left">0.66</td>
<td align="left">0.31</td>
<td align="left">0.01</td>
<td align="left">0.01</td>
<td align="left">0.04</td>
<td align="left">0.11</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># For girls and boys</span>

exerciseTypes_girlboy_proportions &lt;-<span class="st"> </span>exerciseTypes_df <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(girl)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate_at</span>(<span class="kw">vars</span>(<span class="st">`</span><span class="dt">Team ball games</span><span class="st">`</span><span class="op">:</span><span class="st">`</span><span class="dt">Other</span><span class="st">`</span>), <span class="kw">funs</span>(<span class="kw">replace_na</span>(., <span class="dv">0</span>))) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># replace NA&#39;s with 0</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">group_by</span>(girl) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">summarise_at</span>(<span class="kw">vars</span>(<span class="st">`</span><span class="dt">Team ball games</span><span class="st">`</span><span class="op">:</span><span class="st">`</span><span class="dt">Other</span><span class="st">`</span>), <span class="kw">funs</span>(<span class="kw">mean</span>(., <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))) 

exerciseTypes_girlboy_cases &lt;-<span class="st"> </span>exerciseTypes_df <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(girl)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate_at</span>(<span class="kw">vars</span>(<span class="st">`</span><span class="dt">Team ball games</span><span class="st">`</span><span class="op">:</span><span class="st">`</span><span class="dt">Other</span><span class="st">`</span>), <span class="kw">funs</span>(<span class="kw">replace_na</span>(., <span class="dv">0</span>))) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># replace NA&#39;s with 0</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">group_by</span>(girl) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">summarise_at</span>(<span class="kw">vars</span>(<span class="st">`</span><span class="dt">Team ball games</span><span class="st">`</span><span class="op">:</span><span class="st">`</span><span class="dt">Other</span><span class="st">`</span>), sum)

exerciseTypes_girlboy_totals &lt;-<span class="st"> </span>exerciseTypes_df <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(girl)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate_at</span>(<span class="kw">vars</span>(<span class="st">`</span><span class="dt">Team ball games</span><span class="st">`</span><span class="op">:</span><span class="st">`</span><span class="dt">Other</span><span class="st">`</span>), <span class="kw">funs</span>(<span class="kw">replace_na</span>(., <span class="dv">0</span>))) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># replace NA&#39;s with 0</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">group_by</span>(girl) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">summarise_at</span>(<span class="kw">vars</span>(<span class="st">`</span><span class="dt">Team ball games</span><span class="st">`</span><span class="op">:</span><span class="st">`</span><span class="dt">Other</span><span class="st">`</span>), <span class="kw">funs</span>(<span class="kw">sum</span>(<span class="op">!</span><span class="kw">is.na</span>(.))))

exerciseTypes_girlboy_pvals &lt;-<span class="st"> </span><span class="ot">NA</span> <span class="co"># Empty vector to be filled</span>

<span class="cf">for</span> (i <span class="cf">in</span> (<span class="dv">2</span><span class="op">:</span><span class="dv">15</span>)) {
exerciseTypes_girlboy_test &lt;-<span class="st"> </span><span class="kw">data.frame</span>(exerciseTypes_girlboy_cases[ , i], exerciseTypes_girlboy_totals[ , i])
exerciseTypes_girlboy_pvals[i<span class="op">-</span><span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">prop.test</span>(exerciseTypes_girlboy_test[, <span class="dv">1</span>], exerciseTypes_girlboy_test[, <span class="dv">2</span>])<span class="op">$</span>p.value <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">round</span>(., <span class="dv">5</span>)
}
## Warning in prop.test(exerciseTypes_girlboy_test[, 1],
## exerciseTypes_girlboy_test[, : Chi-squared approximation may be incorrect

<span class="kw">data.frame</span>(<span class="st">&quot;Exercise type&quot;</span> =<span class="st"> </span><span class="kw">names</span>(exerciseTypes_girlboy_cases)[<span class="dv">2</span><span class="op">:</span><span class="dv">15</span>], <span class="st">&quot;p-values: boys vs. girls&quot;</span> =<span class="st"> </span>exerciseTypes_girlboy_pvals)  <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>papaja<span class="op">::</span><span class="kw">apa_table</span>()</code></pre></div>
<caption>
(#tab:exerciseTypes)
</caption>
<caption>
**
</caption>
<table>
<thead>
<tr class="header">
<th align="left">Exercise.type</th>
<th align="left">p.values..boys.vs..girls</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Team ball games</td>
<td align="left">0.00</td>
</tr>
<tr class="even">
<td align="left">Other ball games</td>
<td align="left">0.06</td>
</tr>
<tr class="odd">
<td align="left">Gym training</td>
<td align="left">0.00</td>
</tr>
<tr class="even">
<td align="left">Combat sports</td>
<td align="left">0.00</td>
</tr>
<tr class="odd">
<td align="left">Fitness classes</td>
<td align="left">0.00</td>
</tr>
<tr class="even">
<td align="left">Home workout</td>
<td align="left">0.00</td>
</tr>
<tr class="odd">
<td align="left">Cycling</td>
<td align="left">0.36</td>
</tr>
<tr class="even">
<td align="left">Swimming</td>
<td align="left">0.01</td>
</tr>
<tr class="odd">
<td align="left">Walking</td>
<td align="left">0.00</td>
</tr>
<tr class="even">
<td align="left">Running</td>
<td align="left">0.00</td>
</tr>
<tr class="odd">
<td align="left">Skiing</td>
<td align="left">1.00</td>
</tr>
<tr class="even">
<td align="left">Roller skating</td>
<td align="left">0.15</td>
</tr>
<tr class="odd">
<td align="left">Horseback riding</td>
<td align="left">0.00</td>
</tr>
<tr class="even">
<td align="left">Other</td>
<td align="left">0.97</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
exerciseTypes_girlboy_proportions <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>papaja<span class="op">::</span><span class="kw">apa_table</span>()</code></pre></div>
<caption>
(#tab:exerciseTypes)
</caption>
<caption>
**
</caption>
<table>
<thead>
<tr class="header">
<th align="left">girl</th>
<th align="left">Team ball games</th>
<th align="left">Other ball games</th>
<th align="left">Gym training</th>
<th align="left">Combat sports</th>
<th align="left">Fitness classes</th>
<th align="left">Home workout</th>
<th align="left">Cycling</th>
<th align="left">Swimming</th>
<th align="left">Walking</th>
<th align="left">Running</th>
<th align="left">Skiing</th>
<th align="left">Roller skating</th>
<th align="left">Horseback riding</th>
<th align="left">Other</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">girl</td>
<td align="left">0.11</td>
<td align="left">0.05</td>
<td align="left">0.34</td>
<td align="left">0.03</td>
<td align="left">0.09</td>
<td align="left">0.28</td>
<td align="left">0.16</td>
<td align="left">0.11</td>
<td align="left">0.65</td>
<td align="left">0.30</td>
<td align="left">0.04</td>
<td align="left">0.00</td>
<td align="left">0.06</td>
<td align="left">0.11</td>
</tr>
<tr class="even">
<td align="left">boy</td>
<td align="left">0.34</td>
<td align="left">0.08</td>
<td align="left">0.43</td>
<td align="left">0.12</td>
<td align="left">0.01</td>
<td align="left">0.10</td>
<td align="left">0.14</td>
<td align="left">0.06</td>
<td align="left">0.41</td>
<td align="left">0.21</td>
<td align="left">0.04</td>
<td align="left">0.01</td>
<td align="left">0.00</td>
<td align="left">0.11</td>
</tr>
</tbody>
</table>
<p>CIBER (not included for now)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#p_install(&quot;userfriendlyscience&quot;)</span>

<span class="co"># cat(names(df), sep = &quot;\&quot;,\n\&quot;&quot;)</span>

<span class="co"># Make variables numeric, and d as data frame</span>
d_num &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate_all</span>(as.numeric) 
d_num &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(d_num)

userfriendlyscience<span class="op">::</span><span class="kw">CIBER</span>(<span class="dt">data =</span> d_num,
      <span class="dt">determinants =</span> <span class="kw">c</span>(
        <span class="st">&quot;actCop_T1&quot;</span>,
        <span class="st">&quot;agrbct_T1&quot;</span>,
        <span class="st">&quot;amotivation_T1&quot;</span>,
        <span class="st">&quot;autonomous_T1&quot;</span>,
        <span class="st">&quot;big5_agreeableness_T1.1&quot;</span>,
        <span class="st">&quot;big5_conscientiousness_T1.1&quot;</span>,
        <span class="st">&quot;big5_extraversion_T1.1&quot;</span>,
        <span class="st">&quot;big5_neuroticism_T1.1&quot;</span>,
        <span class="st">&quot;big5_openness_T1.1&quot;</span>,
        <span class="st">&quot;controlled_T1&quot;</span>,
        <span class="st">&quot;dnorm_T1&quot;</span>,
        <span class="st">&quot;frqbct_T1&quot;</span>,
        <span class="st">&quot;goal_T1&quot;</span>,
        <span class="st">&quot;inorm_T1&quot;</span>,
        <span class="st">&quot;intention_T1&quot;</span>,
        <span class="st">&quot;outcomeExpectations_T1&quot;</span>,
        <span class="st">&quot;opportunities_T1&quot;</span>,
        <span class="st">&quot;pbc_T1&quot;</span>,
        <span class="st">&quot;selfefficacy_T1&quot;</span>),
      <span class="dt">targets =</span> <span class="kw">c</span>(<span class="st">&quot;paT1&quot;</span>, <span class="st">&quot;fatpct_T1&quot;</span>),
      <span class="dt">conf.level =</span> <span class="kw">list</span>(<span class="dt">means =</span> <span class="fl">0.9999</span>,
                        <span class="dt">associations =</span> <span class="fl">0.99</span>)
      )

userfriendlyscience<span class="op">::</span><span class="kw">CIBER</span>(<span class="dt">data =</span> d_num,
      <span class="dt">determinants =</span> <span class="kw">c</span>(
        <span class="st">&quot;actCop_T1&quot;</span>,
        <span class="st">&quot;agrbct_T1&quot;</span>,
        <span class="st">&quot;frqbct_T1&quot;</span>,
        <span class="st">&quot;amotivation_T1&quot;</span>,
        <span class="st">&quot;autonomous_T1&quot;</span>,
        <span class="st">&quot;controlled_T1&quot;</span>,
        <span class="st">&quot;dnorm_T1&quot;</span>,
        <span class="st">&quot;intention_T1&quot;</span>,
        <span class="st">&quot;outcomeExpectations_T1&quot;</span>,
        <span class="st">&quot;opportunities_T1&quot;</span>,
        <span class="st">&quot;sePbc_T1&quot;</span>),
      <span class="dt">targets =</span> <span class="kw">c</span>(<span class="st">&quot;paT1&quot;</span>, <span class="st">&quot;fatpct_T1&quot;</span>),
      <span class="dt">conf.level =</span> <span class="kw">list</span>(<span class="dt">means =</span> <span class="fl">0.9999</span>,
                        <span class="dt">associations =</span> <span class="fl">0.99</span>)
      )

<span class="co"># to create variable list for CIBER:</span>
<span class="co"># cat(names(d), sep = &quot;\&quot;,\n\&quot;&quot;)</span>

userfriendlyscience<span class="op">::</span><span class="kw">CIBER</span>(<span class="dt">data =</span> d_num,
  <span class="dt">determinants =</span> <span class="kw">c</span>(
  <span class="st">&quot;agrbct_01_T1&quot;</span>,
  <span class="st">&quot;agrbct_02_T1&quot;</span>,
  <span class="st">&quot;agrbct_03_T1&quot;</span>,
  <span class="st">&quot;agrbct_04_T1&quot;</span>,
  <span class="st">&quot;agrbct_05_T1&quot;</span>,
  <span class="st">&quot;agrbct_06_T1&quot;</span>,
  <span class="st">&quot;agrbct_07_T1&quot;</span>,
  <span class="st">&quot;agrbct_08_T1&quot;</span>,
  <span class="st">&quot;agrbct_09_T1&quot;</span>,
  <span class="st">&quot;agrbct_10_T1&quot;</span>,
  <span class="st">&quot;frqbct_01_T1&quot;</span>,
  <span class="st">&quot;frqbct_02_T1&quot;</span>,
  <span class="st">&quot;frqbct_03_T1&quot;</span>,
  <span class="st">&quot;frqbct_04_T1&quot;</span>,
  <span class="st">&quot;frqbct_05_T1&quot;</span>,
  <span class="st">&quot;frqbct_06_T1&quot;</span>,
  <span class="st">&quot;frqbct_07_T1&quot;</span>,
  <span class="st">&quot;frqbct_08_T1&quot;</span>,
  <span class="st">&quot;frqbct_09_T1&quot;</span>),
   <span class="dt">targets =</span> <span class="kw">c</span>(<span class="st">&quot;MVPA&quot;</span>, <span class="st">&quot;SB&quot;</span>),
  <span class="dt">leftAnchors =</span> <span class="kw">rep</span>(<span class="st">&quot;&quot;</span>, <span class="dv">19</span>),
  <span class="dt">rightAnchors =</span> <span class="kw">rep</span>(<span class="st">&quot;&quot;</span>, <span class="dv">19</span>))

userfriendlyscience<span class="op">::</span><span class="kw">CIBER</span>(<span class="dt">data =</span> d_num,
  <span class="dt">determinants =</span> <span class="kw">c</span>(
  <span class="st">&quot;autonomous_01_T1&quot;</span>,
  <span class="st">&quot;autonomous_02_T1&quot;</span>,
  <span class="st">&quot;autonomous_03_T1&quot;</span>,
  <span class="st">&quot;autonomous_04_T1&quot;</span>,
  <span class="st">&quot;autonomous_05_T1&quot;</span>,
  <span class="st">&quot;autonomous_06_T1&quot;</span>,
  <span class="st">&quot;autonomous_07_T1&quot;</span>,
  <span class="st">&quot;autonomous_08_T1&quot;</span>,
  <span class="st">&quot;autonomous_09_T1&quot;</span>),
   <span class="dt">targets =</span> <span class="kw">c</span>(<span class="st">&quot;MVPA&quot;</span>, <span class="st">&quot;SB&quot;</span>),
  <span class="dt">leftAnchors =</span> <span class="kw">rep</span>(<span class="st">&quot;&quot;</span>, <span class="dv">9</span>),
  <span class="dt">rightAnchors =</span> <span class="kw">rep</span>(<span class="st">&quot;&quot;</span>, <span class="dv">9</span>))

userfriendlyscience<span class="op">::</span><span class="kw">CIBER</span>(<span class="dt">data =</span> d_num,
  <span class="dt">determinants =</span> <span class="kw">c</span>(
  <span class="st">&quot;intention_01_T1&quot;</span>,
  <span class="st">&quot;intention_02_T1&quot;</span>,
  <span class="st">&quot;selfefficacy_01_T1&quot;</span>,
  <span class="st">&quot;selfefficacy_02_T1&quot;</span>,
  <span class="st">&quot;pbc_01_T1&quot;</span>,
  <span class="st">&quot;pbc_02_T1&quot;</span>,
  <span class="st">&quot;pbc_03_T1&quot;</span>,
  <span class="st">&quot;norm_01_T1&quot;</span>,
  <span class="st">&quot;norm_02_T1&quot;</span>,
  <span class="st">&quot;outcomeExpectations_01_T1&quot;</span>,
  <span class="st">&quot;outcomeExpectations_02_T1&quot;</span>,
  <span class="st">&quot;outcomeExpectations_03_T1&quot;</span>,
  <span class="st">&quot;outcomeExpectations_04_T1&quot;</span>,
  <span class="st">&quot;outcomeExpectations_05_T1&quot;</span>,
  <span class="st">&quot;outcomeExpectations_06_T1&quot;</span>,
  <span class="st">&quot;outcomeExpectations_07_T1&quot;</span>,
  <span class="st">&quot;outcomeExpectations_08_T1&quot;</span>,
  <span class="st">&quot;outcomeExpectations_09_T1&quot;</span>,
  <span class="st">&quot;outcomeExpectations_10_T1&quot;</span>,
  <span class="st">&quot;outcomeExpectations_11_T1&quot;</span>,
  <span class="st">&quot;outcomeExpectations_12_T1&quot;</span>),
   <span class="dt">targets =</span> <span class="kw">c</span>(<span class="st">&quot;MVPA&quot;</span>, <span class="st">&quot;SB&quot;</span>),
  <span class="dt">leftAnchors =</span> <span class="kw">rep</span>(<span class="st">&quot;&quot;</span>, <span class="dv">21</span>),
  <span class="dt">rightAnchors =</span> <span class="kw">rep</span>(<span class="st">&quot;&quot;</span>, <span class="dv">21</span>))</code></pre></div>
</div>
<div id="symptoms" class="section level1">
<h1>Symptoms</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">

<span class="co"># Create data frame</span>
densplot &lt;-<span class="st"> </span>df
<span class="kw">levels</span>(densplot<span class="op">$</span>intervention) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Control&quot;</span>, <span class="st">&quot;Intervention&quot;</span>)
<span class="kw">levels</span>(densplot<span class="op">$</span>girl) &lt;-<span class="st"> </span><span class="kw">recode</span>(densplot<span class="op">$</span>girl, <span class="st">&quot;boy&quot;</span> =<span class="st"> &quot;Boys&quot;</span>, <span class="st">&quot;girl&quot;</span> =<span class="st"> &quot;Girls&quot;</span>)

<span class="co"># This gives side-by-side plots. There&#39;s a third plot below the two, which is fake to include x-axis text.</span>
<span class="kw">layout</span>(<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">3</span>), <span class="dt">nrow =</span> <span class="dv">2</span>, <span class="dt">ncol =</span> <span class="dv">2</span>, <span class="dt">byrow =</span> <span class="ot">TRUE</span>),
       <span class="dt">widths =</span> <span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>),<span class="dt">heights =</span> <span class="kw">c</span>(<span class="fl">0.45</span>,<span class="fl">0.05</span>))

<span class="co"># Minimise whitespace; see https://stackoverflow.com/questions/15848942/how-to-reduce-space-gap-between-multiple-graphs-in-r</span>
<span class="kw">par</span>(<span class="dt">mai =</span> <span class="kw">c</span>(<span class="fl">0.3</span>, <span class="fl">0.3</span>, <span class="fl">0.1</span>, <span class="fl">0.0</span>)) 

## Girls vs. boys
<span class="co"># Choose only the variables needed and drop NA</span>
dens &lt;-<span class="st"> </span>densplot <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(symptom_T1, girl) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="kw">complete.cases</span>(.))

<span class="co"># Set random number generator for reproducibility of bootstrap test of equal densities</span>
<span class="kw">set.seed</span>(<span class="dv">10</span>)

<span class="co"># Make plot</span>
sm.symptom_T1_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">sm.density.compare2</span>(<span class="kw">as.numeric</span>(dens<span class="op">$</span>symptom_T1), 
                                               <span class="kw">as.factor</span>(dens<span class="op">$</span>girl), 
                                               <span class="dt">model =</span> <span class="st">&quot;equal&quot;</span>,
                                               <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>,
                                               <span class="dt">col =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end  =</span>  <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">1</span>)], 
                                               <span class="dt">lty =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>), <span class="dt">yaxt =</span> <span class="st">&quot;n&quot;</span>,
                                               <span class="dt">bandcol =</span> <span class="st">&#39;LightGray&#39;</span>, 
                                               <span class="dt">lwd =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>),
                                               <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">4</span>))
## 
## Test of equal densities:  p-value =  0
<span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="kw">levels</span>(dens<span class="op">$</span>girl), <span class="dt">col =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>)], <span class="dt">lty =</span> <span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">1</span>), <span class="dt">lwd =</span> (<span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>)))
<span class="kw">mtext</span>(<span class="dt">side =</span> <span class="dv">2</span>, <span class="st">&quot;Density&quot;</span>, <span class="dt">line =</span> <span class="fl">0.5</span>)

## Intervention vs. control
<span class="co"># Choose only the variables needed and drop NA</span>
dens &lt;-<span class="st"> </span>densplot <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(symptom_T1, intervention) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="kw">complete.cases</span>(.))

<span class="co"># Set random number generator for reproducibility of bootstrap test of equal densities</span>
<span class="kw">set.seed</span>(<span class="dv">10</span>)
<span class="co"># Make plot</span>
sm.symptom_T1_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">sm.density.compare2</span>(<span class="kw">as.numeric</span>(dens<span class="op">$</span>symptom_T1), 
                                               <span class="kw">as.factor</span>(dens<span class="op">$</span>intervention), 
                                               <span class="dt">model =</span> <span class="st">&quot;equal&quot;</span>, 
                                               <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>,
                                               <span class="dt">col =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">4</span>)], 
                                               <span class="dt">lty =</span> <span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">1</span>), <span class="dt">yaxt =</span> <span class="st">&quot;n&quot;</span>,
                                               <span class="dt">bandcol =</span> <span class="st">&#39;LightGray&#39;</span>, 
                                               <span class="dt">lwd =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>),
                                               <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">4</span>))
## 
## Test of equal densities:  p-value =  0.64
<span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="kw">levels</span>(dens<span class="op">$</span>intervention), <span class="dt">col =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">4</span>)], <span class="dt">lty=</span><span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">1</span>), <span class="dt">lwd=</span>(<span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>)))

<span class="co"># Create x-axis label. See https://stackoverflow.com/questions/11198767/how-to-annotate-across-or-between-plots-in-multi-plot-panels-in-r</span>
<span class="kw">par</span>(<span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>)) 
<span class="kw">plot</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dt">type =</span> <span class="st">&quot;n&quot;</span>, <span class="dt">frame.plot =</span> <span class="ot">FALSE</span>,<span class="dt">axes =</span> <span class="ot">FALSE</span>) <span class="co"># Fake plot</span>
<span class="kw">text</span>(<span class="dt">x =</span> <span class="fl">1.02</span>, <span class="dt">y =</span> <span class="fl">1.3</span>, <span class="dt">labels =</span> <span class="st">&quot;Symptom sumscore mean&quot;</span>, <span class="dt">pos =</span> <span class="dv">1</span>)</code></pre></div>
<p><img src="baseline-supplement_files/figure-html/sm-symptoms-1.png" width="672" /></p>
<div id="symptom-histograms" class="section level2">
<h2>Symptom histograms</h2>
<div id="intervention-gender" class="section level3">
<h3>intervention / gender</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
sympGirls &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(id,
  intervention,
  group,
  school,
  girl,
  <span class="st">&quot;Neck and shoulder pain&quot;</span> =<span class="st"> </span>symptom_neckShoulderPain_T1,
  <span class="st">&quot;Lower back pain&quot;</span> =<span class="st"> </span>symptom_lowerBackPain_T1,
  <span class="st">&quot;Stomach ache&quot;</span> =<span class="st"> </span>symptom_stomachAche_T1,
  <span class="st">&quot;Tension or nervousness&quot;</span> =<span class="st"> </span>symptom_tensionNervousness_T1,
  <span class="st">&quot;Irritability or anger bursts&quot;</span> =<span class="st"> </span>symptom_irritabilityAngerbursts_T1,
  <span class="st">&quot;Difficulty with sleep&quot;</span> =<span class="st"> </span>symptom_sleepDifficulty_T1,
  <span class="st">&quot;Headache&quot;</span> =<span class="st"> </span>symptom_headAche_T1,
  <span class="st">&quot;Tiredness or faintness&quot;</span> =<span class="st"> </span>symptom_tirednessFaintness_T1) <span class="op">%&gt;%</span>
<span class="st"> </span>tidyr<span class="op">::</span><span class="kw">gather</span>(<span class="dt">key =</span> Variable, <span class="dt">value =</span> Value, <span class="dv">6</span><span class="op">:</span><span class="kw">ncol</span>(.)) <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(girl <span class="op">==</span><span class="st"> &quot;girl&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st"> </span>ggplot2<span class="op">::</span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Value, <span class="dt">y =</span> Variable, <span class="dt">group =</span> Variable)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">geom_density_ridges2</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> Variable), <span class="dt">stat =</span> <span class="st">&quot;binline&quot;</span>, <span class="dt">binwidth =</span> <span class="dv">1</span>, <span class="dt">scale =</span> <span class="fl">0.95</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>), <span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>),
                     <span class="dt">name =</span> <span class="st">&quot;&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_discrete</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>), <span class="dt">name =</span> <span class="st">&quot;&quot;</span>, <span class="dt">labels =</span> <span class="ot">NULL</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_fill_cyclical</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;darkolivegreen2&quot;</span>, <span class="st">&quot;darkolivegreen4&quot;</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Girls&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">guides</span>(<span class="dt">y =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">theme_ridges</span>(<span class="dt">grid =</span> <span class="ot">FALSE</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>),
        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>),
        <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>, <span class="dt">size =</span> <span class="dv">10</span>),
        <span class="dt">axis.text=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">10</span>, <span class="dt">face=</span><span class="st">&quot;bold&quot;</span>)) <span class="op">+</span>
<span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">4.5</span>))
## Warning: attributes are not identical across measure variables;
## they will be dropped

sympBoys &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(id,
  intervention,
  group,
  school,
  girl,
  <span class="st">&quot;Neck and shoulder pain&quot;</span> =<span class="st"> </span>symptom_neckShoulderPain_T1,
  <span class="st">&quot;Lower back pain&quot;</span> =<span class="st"> </span>symptom_lowerBackPain_T1,
  <span class="st">&quot;Stomach ache&quot;</span> =<span class="st"> </span>symptom_stomachAche_T1,
  <span class="st">&quot;Tension or nervousness&quot;</span> =<span class="st"> </span>symptom_tensionNervousness_T1,
  <span class="st">&quot;Irritability or anger bursts&quot;</span> =<span class="st"> </span>symptom_irritabilityAngerbursts_T1,
  <span class="st">&quot;Difficulty with sleep&quot;</span> =<span class="st"> </span>symptom_sleepDifficulty_T1,
  <span class="st">&quot;Headache&quot;</span> =<span class="st"> </span>symptom_headAche_T1,
  <span class="st">&quot;Tiredness or faintness&quot;</span> =<span class="st"> </span>symptom_tirednessFaintness_T1) <span class="op">%&gt;%</span>
<span class="st"> </span>tidyr<span class="op">::</span><span class="kw">gather</span>(<span class="dt">key =</span> Variable, <span class="dt">value =</span> Value, <span class="dv">6</span><span class="op">:</span><span class="kw">ncol</span>(.)) <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(girl <span class="op">==</span><span class="st"> &quot;boy&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st"> </span>ggplot2<span class="op">::</span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Value, <span class="dt">y =</span> Variable, <span class="dt">group =</span> Variable)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">geom_density_ridges2</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> Variable), <span class="dt">stat =</span> <span class="st">&quot;binline&quot;</span>, <span class="dt">binwidth =</span> <span class="dv">1</span>, <span class="dt">scale =</span> <span class="fl">0.95</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>), <span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>),
                     <span class="dt">name =</span> <span class="st">&quot;&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_discrete</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>), <span class="dt">name =</span> <span class="st">&quot;&quot;</span>, <span class="dt">labels =</span> <span class="ot">NULL</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_fill_cyclical</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;darkolivegreen2&quot;</span>, <span class="st">&quot;darkolivegreen4&quot;</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Boys&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">guides</span>(<span class="dt">y =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">theme_ridges</span>(<span class="dt">grid =</span> <span class="ot">FALSE</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>),
        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>),
        <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>, <span class="dt">size =</span> <span class="dv">10</span>),
        <span class="dt">axis.text=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">10</span>, <span class="dt">face=</span><span class="st">&quot;bold&quot;</span>)) <span class="op">+</span>
<span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">4.5</span>))
## Warning: attributes are not identical across measure variables;
## they will be dropped

sympInt &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(id,
  intervention,
  group,
  school,
  girl,
  <span class="st">&quot;Neck and shoulder pain&quot;</span> =<span class="st"> </span>symptom_neckShoulderPain_T1,
  <span class="st">&quot;Lower back pain&quot;</span> =<span class="st"> </span>symptom_lowerBackPain_T1,
  <span class="st">&quot;Stomach ache&quot;</span> =<span class="st"> </span>symptom_stomachAche_T1,
  <span class="st">&quot;Tension or nervousness&quot;</span> =<span class="st"> </span>symptom_tensionNervousness_T1,
  <span class="st">&quot;Irritability or anger bursts&quot;</span> =<span class="st"> </span>symptom_irritabilityAngerbursts_T1,
  <span class="st">&quot;Difficulty with sleep&quot;</span> =<span class="st"> </span>symptom_sleepDifficulty_T1,
  <span class="st">&quot;Headache&quot;</span> =<span class="st"> </span>symptom_headAche_T1,
  <span class="st">&quot;Tiredness or faintness&quot;</span> =<span class="st"> </span>symptom_tirednessFaintness_T1) <span class="op">%&gt;%</span>
<span class="st"> </span>tidyr<span class="op">::</span><span class="kw">gather</span>(<span class="dt">key =</span> Variable, <span class="dt">value =</span> Value, <span class="dv">6</span><span class="op">:</span><span class="kw">ncol</span>(.)) <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(intervention <span class="op">==</span><span class="st"> &quot;1&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st"> </span>ggplot2<span class="op">::</span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Value, <span class="dt">y =</span> Variable, <span class="dt">group =</span> Variable)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">geom_density_ridges2</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> Variable), <span class="dt">stat =</span> <span class="st">&quot;binline&quot;</span>, <span class="dt">binwidth =</span> <span class="dv">1</span>, <span class="dt">scale =</span> <span class="fl">0.95</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>), <span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>),
                     <span class="dt">name =</span> <span class="st">&quot;&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_discrete</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>), <span class="dt">name =</span> <span class="st">&quot;&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_fill_cyclical</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;deepskyblue&quot;</span>, <span class="st">&quot;deepskyblue4&quot;</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Intervention&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">guides</span>(<span class="dt">y =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">theme_ridges</span>(<span class="dt">grid =</span> <span class="ot">FALSE</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>),
        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>),
        <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>, <span class="dt">size =</span> <span class="dv">10</span>),
        <span class="dt">axis.text=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">10</span>)) <span class="op">+</span>
<span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">4.5</span>))
## Warning: attributes are not identical across measure variables;
## they will be dropped

sympCont &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(id,
  intervention,
  group,
  school,
  girl,
  <span class="st">&quot;Neck and shoulder pain&quot;</span> =<span class="st"> </span>symptom_neckShoulderPain_T1,
  <span class="st">&quot;Lower back pain&quot;</span> =<span class="st"> </span>symptom_lowerBackPain_T1,
  <span class="st">&quot;Stomach ache&quot;</span> =<span class="st"> </span>symptom_stomachAche_T1,
  <span class="st">&quot;Tension or nervousness&quot;</span> =<span class="st"> </span>symptom_tensionNervousness_T1,
  <span class="st">&quot;Irritability or anger bursts&quot;</span> =<span class="st"> </span>symptom_irritabilityAngerbursts_T1,
  <span class="st">&quot;Difficulty with sleep&quot;</span> =<span class="st"> </span>symptom_sleepDifficulty_T1,
  <span class="st">&quot;Headache&quot;</span> =<span class="st"> </span>symptom_headAche_T1,
  <span class="st">&quot;Tiredness or faintness&quot;</span> =<span class="st"> </span>symptom_tirednessFaintness_T1) <span class="op">%&gt;%</span>
<span class="st"> </span>tidyr<span class="op">::</span><span class="kw">gather</span>(<span class="dt">key =</span> Variable, <span class="dt">value =</span> Value, <span class="dv">6</span><span class="op">:</span><span class="kw">ncol</span>(.)) <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(intervention <span class="op">==</span><span class="st"> &quot;0&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st"> </span>ggplot2<span class="op">::</span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Value, <span class="dt">y =</span> Variable, <span class="dt">group =</span> Variable)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">geom_density_ridges2</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> Variable), <span class="dt">stat =</span> <span class="st">&quot;binline&quot;</span>, <span class="dt">binwidth =</span> <span class="dv">1</span>, <span class="dt">scale =</span> <span class="fl">0.95</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>), <span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>),
                     <span class="dt">name =</span> <span class="st">&quot;&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_discrete</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>), <span class="dt">name =</span> <span class="st">&quot;&quot;</span>, <span class="dt">labels =</span> <span class="ot">NULL</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_fill_cyclical</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;deepskyblue&quot;</span>, <span class="st">&quot;deepskyblue4&quot;</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Control&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">guides</span>(<span class="dt">y =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">theme_ridges</span>(<span class="dt">grid =</span> <span class="ot">FALSE</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>),
        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>),
        <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>, <span class="dt">size =</span> <span class="dv">10</span>),
        <span class="dt">axis.text=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">10</span>, <span class="dt">face=</span><span class="st">&quot;bold&quot;</span>)) <span class="op">+</span>
<span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">4.5</span>))
## Warning: attributes are not identical across measure variables;
## they will be dropped

<span class="co">#grid.arrange(sympInt, sympGirls, sympCont, sympBoys, ncol = 2)</span>

<span class="co"># (&quot;Seldom or never&quot;, &quot;About once a month&quot;, &quot;About once a week&quot;, &quot;Almost daily&quot;)</span>

<span class="co"># This draws all histograms next to each other:</span>
grid<span class="op">::</span><span class="kw">grid.newpage</span>()
grid<span class="op">::</span><span class="kw">grid.draw</span>(<span class="kw">cbind</span>(ggplot2<span class="op">::</span><span class="kw">ggplotGrob</span>(sympInt), ggplot2<span class="op">::</span><span class="kw">ggplotGrob</span>(sympCont), ggplot2<span class="op">::</span><span class="kw">ggplotGrob</span>(sympGirls), ggplot2<span class="op">::</span><span class="kw">ggplotGrob</span>(sympBoys), <span class="dt">size =</span> <span class="st">&quot;last&quot;</span>))
## Warning: Removed 198 rows containing non-finite values (stat_binline).
## Warning: Removed 93 rows containing non-finite values (stat_binline).
## Warning: Removed 197 rows containing non-finite values (stat_binline).
## Warning: Removed 94 rows containing non-finite values (stat_binline).</code></pre></div>
<p><img src="baseline-supplement_files/figure-html/symptom-histogram-ivgender-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># This draws 2 histograms per row:</span>
<span class="co">#grid.newpage()</span>
<span class="co">#grid.draw(rbind(cbind(ggplot2::ggplotGrob(sympInt), ggplot2::ggplotGrob(sympCont), size = &quot;last&quot;), cbind(ggplot2::ggplotGrob(sympGirls), ggplot2::ggplotGrob(sympBoys), size = &quot;last&quot;)))</span></code></pre></div>
</div>
<div id="educational-track" class="section level3">
<h3>educational track</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">trackColors &lt;-<span class="st"> </span>viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">13</span>)

sympHRC &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(id,
  intervention,
  track,
  school,
  girl,
  <span class="st">&quot;Neck and shoulder pain&quot;</span> =<span class="st"> </span>symptom_neckShoulderPain_T1,
  <span class="st">&quot;Lower back pain&quot;</span> =<span class="st"> </span>symptom_lowerBackPain_T1,
  <span class="st">&quot;Stomach ache&quot;</span> =<span class="st"> </span>symptom_stomachAche_T1,
  <span class="st">&quot;Tension or nervousness&quot;</span> =<span class="st"> </span>symptom_tensionNervousness_T1,
  <span class="st">&quot;Irritability or anger bursts&quot;</span> =<span class="st"> </span>symptom_irritabilityAngerbursts_T1,
  <span class="st">&quot;Difficulty with sleep&quot;</span> =<span class="st"> </span>symptom_sleepDifficulty_T1,
  <span class="st">&quot;Headache&quot;</span> =<span class="st"> </span>symptom_headAche_T1,
  <span class="st">&quot;Tiredness or faintness&quot;</span> =<span class="st"> </span>symptom_tirednessFaintness_T1) <span class="op">%&gt;%</span>
<span class="st"> </span>tidyr<span class="op">::</span><span class="kw">gather</span>(<span class="dt">key =</span> Variable, <span class="dt">value =</span> Value, <span class="dv">6</span><span class="op">:</span><span class="kw">ncol</span>(.)) <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;HRC&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st"> </span>ggplot2<span class="op">::</span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Value, <span class="dt">y =</span> Variable, <span class="dt">group =</span> Variable)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">geom_density_ridges2</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> Variable), <span class="dt">stat =</span> <span class="st">&quot;binline&quot;</span>, <span class="dt">binwidth =</span> <span class="dv">1</span>, <span class="dt">scale =</span> <span class="fl">0.95</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>), <span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>),
                     <span class="dt">name =</span> <span class="st">&quot;&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_discrete</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>), <span class="dt">name =</span> <span class="st">&quot;&quot;</span>, <span class="dt">labels =</span> <span class="ot">NULL</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_fill_cyclical</span>(<span class="dt">values =</span> trackColors[<span class="dv">4</span><span class="op">:</span><span class="dv">5</span>]) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;HRC&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">guides</span>(<span class="dt">y =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">theme_ridges</span>(<span class="dt">grid =</span> <span class="ot">FALSE</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>),
        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>),
        <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>, <span class="dt">size =</span> <span class="dv">10</span>),
        <span class="dt">axis.text=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">10</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">4.5</span>))
## Warning: attributes are not identical across measure variables;
## they will be dropped

sympNur &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(id,
  intervention,
  track,
  school,
  girl,
  <span class="st">&quot;Neck and shoulder pain&quot;</span> =<span class="st"> </span>symptom_neckShoulderPain_T1,
  <span class="st">&quot;Lower back pain&quot;</span> =<span class="st"> </span>symptom_lowerBackPain_T1,
  <span class="st">&quot;Stomach ache&quot;</span> =<span class="st"> </span>symptom_stomachAche_T1,
  <span class="st">&quot;Tension or nervousness&quot;</span> =<span class="st"> </span>symptom_tensionNervousness_T1,
  <span class="st">&quot;Irritability or anger bursts&quot;</span> =<span class="st"> </span>symptom_irritabilityAngerbursts_T1,
  <span class="st">&quot;Difficulty with sleep&quot;</span> =<span class="st"> </span>symptom_sleepDifficulty_T1,
  <span class="st">&quot;Headache&quot;</span> =<span class="st"> </span>symptom_headAche_T1,
  <span class="st">&quot;Tiredness or faintness&quot;</span> =<span class="st"> </span>symptom_tirednessFaintness_T1) <span class="op">%&gt;%</span>
<span class="st"> </span>tidyr<span class="op">::</span><span class="kw">gather</span>(<span class="dt">key =</span> Variable, <span class="dt">value =</span> Value, <span class="dv">6</span><span class="op">:</span><span class="kw">ncol</span>(.)) <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;Nur&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st"> </span>ggplot2<span class="op">::</span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Value, <span class="dt">y =</span> Variable, <span class="dt">group =</span> Variable)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">geom_density_ridges2</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> Variable), <span class="dt">stat =</span> <span class="st">&quot;binline&quot;</span>, <span class="dt">binwidth =</span> <span class="dv">1</span>, <span class="dt">scale =</span> <span class="fl">0.95</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>), <span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>),
                     <span class="dt">name =</span> <span class="st">&quot;&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_discrete</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>), <span class="dt">name =</span> <span class="st">&quot;&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_fill_cyclical</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="dt">values =</span> trackColors[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>])) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Nur&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">guides</span>(<span class="dt">y =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">theme_ridges</span>(<span class="dt">grid =</span> <span class="ot">FALSE</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>),
        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>),
        <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>, <span class="dt">size =</span> <span class="dv">10</span>),
        <span class="dt">axis.text=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">10</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">4.5</span>))
## Warning: attributes are not identical across measure variables;
## they will be dropped

sympIT &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(id,
  intervention,
  track,
  school,
  girl,
  <span class="st">&quot;Neck and shoulder pain&quot;</span> =<span class="st"> </span>symptom_neckShoulderPain_T1,
  <span class="st">&quot;Lower back pain&quot;</span> =<span class="st"> </span>symptom_lowerBackPain_T1,
  <span class="st">&quot;Stomach ache&quot;</span> =<span class="st"> </span>symptom_stomachAche_T1,
  <span class="st">&quot;Tension or nervousness&quot;</span> =<span class="st"> </span>symptom_tensionNervousness_T1,
  <span class="st">&quot;Irritability or anger bursts&quot;</span> =<span class="st"> </span>symptom_irritabilityAngerbursts_T1,
  <span class="st">&quot;Difficulty with sleep&quot;</span> =<span class="st"> </span>symptom_sleepDifficulty_T1,
  <span class="st">&quot;Headache&quot;</span> =<span class="st"> </span>symptom_headAche_T1,
  <span class="st">&quot;Tiredness or faintness&quot;</span> =<span class="st"> </span>symptom_tirednessFaintness_T1) <span class="op">%&gt;%</span>
<span class="st"> </span>tidyr<span class="op">::</span><span class="kw">gather</span>(<span class="dt">key =</span> Variable, <span class="dt">value =</span> Value, <span class="dv">6</span><span class="op">:</span><span class="kw">ncol</span>(.)) <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;IT&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st"> </span>ggplot2<span class="op">::</span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Value, <span class="dt">y =</span> Variable, <span class="dt">group =</span> Variable)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">geom_density_ridges2</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> Variable), <span class="dt">stat =</span> <span class="st">&quot;binline&quot;</span>, <span class="dt">binwidth =</span> <span class="dv">1</span>, <span class="dt">scale =</span> <span class="fl">0.95</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>), <span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>),
                     <span class="dt">name =</span> <span class="st">&quot;&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_discrete</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>), <span class="dt">name =</span> <span class="st">&quot;&quot;</span>, <span class="dt">labels =</span> <span class="ot">NULL</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_fill_cyclical</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="dt">values =</span> trackColors[<span class="dv">12</span><span class="op">:</span><span class="dv">13</span>])) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;IT&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">guides</span>(<span class="dt">y =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">theme_ridges</span>(<span class="dt">grid =</span> <span class="ot">FALSE</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>),
        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>),
        <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>, <span class="dt">size =</span> <span class="dv">10</span>),
        <span class="dt">axis.text=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">10</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">4.5</span>))
## Warning: attributes are not identical across measure variables;
## they will be dropped

sympBA &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(id,
  intervention,
  track,
  school,
  girl,
  <span class="st">&quot;Neck and shoulder pain&quot;</span> =<span class="st"> </span>symptom_neckShoulderPain_T1,
  <span class="st">&quot;Lower back pain&quot;</span> =<span class="st"> </span>symptom_lowerBackPain_T1,
  <span class="st">&quot;Stomach ache&quot;</span> =<span class="st"> </span>symptom_stomachAche_T1,
  <span class="st">&quot;Tension or nervousness&quot;</span> =<span class="st"> </span>symptom_tensionNervousness_T1,
  <span class="st">&quot;Irritability or anger bursts&quot;</span> =<span class="st"> </span>symptom_irritabilityAngerbursts_T1,
  <span class="st">&quot;Difficulty with sleep&quot;</span> =<span class="st"> </span>symptom_sleepDifficulty_T1,
  <span class="st">&quot;Headache&quot;</span> =<span class="st"> </span>symptom_headAche_T1,
  <span class="st">&quot;Tiredness or faintness&quot;</span> =<span class="st"> </span>symptom_tirednessFaintness_T1) <span class="op">%&gt;%</span>
<span class="st"> </span>tidyr<span class="op">::</span><span class="kw">gather</span>(<span class="dt">key =</span> Variable, <span class="dt">value =</span> Value, <span class="dv">6</span><span class="op">:</span><span class="kw">ncol</span>(.)) <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;BA&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st"> </span>ggplot2<span class="op">::</span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Value, <span class="dt">y =</span> Variable, <span class="dt">group =</span> Variable)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">geom_density_ridges2</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> Variable), <span class="dt">stat =</span> <span class="st">&quot;binline&quot;</span>, <span class="dt">binwidth =</span> <span class="dv">1</span>, <span class="dt">scale =</span> <span class="fl">0.95</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>), <span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>),
                     <span class="dt">name =</span> <span class="st">&quot;&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_discrete</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>), <span class="dt">name =</span> <span class="st">&quot;&quot;</span>, <span class="dt">labels =</span> <span class="ot">NULL</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_fill_cyclical</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="dt">values =</span> trackColors[<span class="dv">8</span><span class="op">:</span><span class="dv">9</span>])) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;BA&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">guides</span>(<span class="dt">y =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">theme_ridges</span>(<span class="dt">grid =</span> <span class="ot">FALSE</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>),
        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>),
        <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>, <span class="dt">size =</span> <span class="dv">10</span>),
        <span class="dt">axis.text=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">10</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">4.5</span>))
## Warning: attributes are not identical across measure variables;
## they will be dropped

<span class="co">#grid.arrange(sympIT, sympHRC, sympBA, sympNur, ncol = 2)</span>

<span class="co"># (&quot;Seldom or never&quot;, &quot;About once a month&quot;, &quot;About once a week&quot;, &quot;Almost daily&quot;)</span>

<span class="co"># This draws all histograms next to each other:</span>
<span class="co"># grid::grid.newpage()</span>
<span class="co"># grid::grid.draw(cbind(ggplot2::ggplotGrob(sympIT), ggplot2::ggplotGrob(sympBA), ggplot2::ggplotGrob(sympHRC), ggplot2::ggplotGrob(sympNur), size = &quot;last&quot;))</span>

<span class="co"># This draws 2 histograms per row:</span>
<span class="co">#grid.newpage()</span>
<span class="co">#grid.draw(rbind(cbind(ggplot2::ggplotGrob(sympIT), ggplot2::ggplotGrob(sympBA), size = &quot;last&quot;), cbind(ggplot2::ggplotGrob(sympHRC), ggplot2::ggplotGrob(sympNur), size = &quot;last&quot;)))</span>

(sympNur <span class="op">|</span><span class="st"> </span>sympHRC <span class="op">|</span><span class="st"> </span>sympBA <span class="op">|</span><span class="st"> </span>sympIT)
## Warning: Removed 141 rows containing non-finite values (stat_binline).
## Warning: Removed 49 rows containing non-finite values (stat_binline).

## Warning: Removed 49 rows containing non-finite values (stat_binline).
## Warning: Removed 26 rows containing non-finite values (stat_binline).</code></pre></div>
<p><img src="baseline-supplement_files/figure-html/symptom-histogram-edutracks-1.png" width="672" /></p>
</div>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
