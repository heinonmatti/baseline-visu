<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title>Baseline analysis supplement</title>

<script src="site_libs/jquery-1.12.4/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<script src="site_libs/htmlwidgets-1.0/htmlwidgets.js"></script>
<link href="site_libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="site_libs/datatables-binding-0.4/datatables.js"></script>
<link href="site_libs/dt-core-1.10.16/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="site_libs/dt-core-1.10.16/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="site_libs/dt-core-1.10.16/js/jquery.dataTables.min.js"></script>
<link href="site_libs/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
<script src="site_libs/crosstalk-1.0.0/js/crosstalk.min.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; background-color: #f8f8f8; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
pre, code { background-color: #f8f8f8; }
code > span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code > span.dt { color: #204a87; } /* DataType */
code > span.dv { color: #0000cf; } /* DecVal */
code > span.bn { color: #0000cf; } /* BaseN */
code > span.fl { color: #0000cf; } /* Float */
code > span.ch { color: #4e9a06; } /* Char */
code > span.st { color: #4e9a06; } /* String */
code > span.co { color: #8f5902; font-style: italic; } /* Comment */
code > span.ot { color: #8f5902; } /* Other */
code > span.al { color: #ef2929; } /* Alert */
code > span.fu { color: #000000; } /* Function */
code > span.er { color: #a40000; font-weight: bold; } /* Error */
code > span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #000000; } /* Constant */
code > span.sc { color: #000000; } /* SpecialChar */
code > span.vs { color: #4e9a06; } /* VerbatimString */
code > span.ss { color: #4e9a06; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #000000; } /* Variable */
code > span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code > span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code > span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code > span.ex { } /* Extension */
code > span.at { color: #c4a000; } /* Attribute */
code > span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code > span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
div.sourceCode {
  overflow-x: visible;
}
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>


</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 66px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 71px;
  margin-top: -71px;
}

.section h2 {
  padding-top: 71px;
  margin-top: -71px;
}
.section h3 {
  padding-top: 71px;
  margin-top: -71px;
}
.section h4 {
  padding-top: 71px;
  margin-top: -71px;
}
.section h5 {
  padding-top: 71px;
  margin-top: -71px;
}
.section h6 {
  padding-top: 71px;
  margin-top: -71px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>




<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
  padding-left: 25px;
  text-indent: 0;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>

<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Visualising baseline characteristics</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">About</a>
</li>
<li>
  <a href="baseline-manuscript.html">Manuscript</a>
</li>
<li>
  <a href="baseline-supplement.html">Descriptives</a>
</li>
<li>
  <a href="baseline-networks.html">Networks</a>
</li>
<li>
  <a href="https://raw.githubusercontent.com/heinonmatti/baseline-visu/master/baseline-datasetup.R">Data setup code</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">

<div class="btn-group pull-right">
<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Baseline analysis supplement</h1>

</div>


<p>Welcome to the LMI baseline supplement! This supplement will walk you through the analyses and provides additional graphs.</p>
<p>Clicking the “Code”-buttons on the right shows code for each chunk.</p>
<p>To start data analysis, we set up the basics to enable compiling the document.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">source</span>(<span class="st">&quot;baseline-datasetup.R&quot;</span>)</code></pre></div>
<div id="descriptions-of-scales-used-to-measure-theoretical-predictors-of-pa" class="section level1">
<h1>Descriptions of scales used to measure theoretical predictors of PA</h1>
<p><em>Outcome expectations.</em> Outcome expectations were measured using a 12-item scale, with the items based on a belief elicitation study conducted in the study population, in line with standard procedures (Francis et al., 2004). The scale consisted of 9 positive outcome expectations items and three negative ones.</p>
<p><em>Autonomous motivation.</em> We used 15 items from the 19-item BREQ-2 questionnaire (Markland &amp; Tobin, 2004), combined with three items from the integrated regulation scale from Wilson et al. (2006).</p>
<p><em>Perceived environmental opportunities.</em> Environmental and social opportunities for PA were measured using an 8-item scale developed for this study.</p>
<p><em>Descriptive norms.</em> PA descriptive norm was gauged by two questions, one on the behaviour of friends and the other on the behaviour of parents.</p>
<p><em>Intention.</em> Participants were queried about their intention to be physically active with two questions. Both were formed as “I intend to be physically active for at least 1,5 hours weekly, during the next month”. Both had a scale from 1 to 7, the first ranging from “unlikely” to “likely” and the other ranging from “absolutely not” to “absolutely yes”.</p>
<p><em>Action- and coping planning.</em> Action- and coping planning was measured with an 8-item scale (Sniehotta et al., 2005).</p>
<p><em>Self-efficacy/perceived behavioural control.</em> PA self-efficacy was measured with 2 items, perceived behavioural control with 3 items (Hagger et al., 2003).</p>
<p><strong>Behaviour change technique (BCT) use:</strong></p>
<p>Use of BCTs was assessed by asking whether the participants had engaged in them during the last three weeks. The scale was not previously validated, but was used in (improved from?) the feasibility study (Hankonen et al 2017). Two types of BCTs were assessed; those judged to benefit from repeated enactment (such as reminding oneself of positive consequences) and others, such as goal setting.</p>
<p><em>Agreement-dependent BCTs.</em></p>
<p>Agreement-dependent BCTs were asked with the lead “Have you done the following during the last three weeks?”. The response scale ranged from 0 = not at all true to 5 = completely true. Items are as follows:</p>
<ol style="list-style-type: decimal">
<li>I have set PA goals for myself.<br />
</li>
<li>I have personally made a specific plan (“what, where, how”) to implement my PA.<br />
</li>
<li>I have a PA plan, which has been made by someone else, e.g. my sports club (e.g. a workout schedule).<br />
</li>
<li>I have a way by which I remind myself of my PA plan, e.g. I write it down in the calendar.<br />
</li>
<li>I have broken down larger PA goals to smaller subgoals.<br />
</li>
<li>I have tried out new ways for me to be physically active.<br />
</li>
<li>I have pondered, what kind of difficult situations or barriers prevent me from implementing my PA plan.<br />
</li>
<li>I have planned for ways to overcome barriers to doing PA.<br />
</li>
<li>I have thought about how PA fits my identity (self concept).<br />
</li>
<li>I have attempted to find ways to exercise so, that it won’t obstruct but instead helps actualise my other life values.</li>
</ol>
<p><em>Frequency-dependent BCTs.</em></p>
<p>The answer scale for frequency-dependent BCTs was as follows: 0 = not once, 1 = once, 2 = twice, 3 = weekly, 4 = about every second day, 5 = daily. Items are as follows:</p>
<ol style="list-style-type: decimal">
<li>I have reminded myself in my spare time what kind of positive consequences frequent PA would have in my life.</li>
<li>I have monitored my PA by marking the PA occasions on an exercise log on paper.</li>
<li>I have monitored my PA by using a smartphone, e.g. the Moves-app.</li>
<li>I have used mnemonic cues with which I remember to implement my PA intention.</li>
<li>I have compared my actualized PA with the PA goal I have set.</li>
<li>I have thought about which reasons to do PA are important to me personally.</li>
<li>I have made changes in my home (e.g. my room or my computer), so that starting PA would be easier.</li>
<li>I have asked my friends or family for support to reach my PA goals.</li>
<li>If I haven’t reached my PA goal, I have evaluated, what went wrong.</li>
</ol>
</div>
<div id="estimating-means-with-cis-taking-clustering-into-account" class="section level1">
<h1>Estimating means with CIs taking clustering into account</h1>
<p>The code chunks create linear models for all variables. The results are used to estimate confidence intervals and intra-class correlations (ICC).</p>
<p>The CIs are calculated with a multilevel model, accounting for school and classroom membership.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Create a vector with all names of the variables we want. Exclude T3 variables.</span>
names &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>id, <span class="op">-</span>intervention, <span class="op">-</span>group, <span class="op">-</span>school, <span class="op">-</span>girl, <span class="op">-</span>track, <span class="op">-</span>trackSchool, <span class="op">-</span><span class="kw">contains</span>(<span class="st">&quot;_T3&quot;</span>), <span class="op">-</span><span class="kw">contains</span>(<span class="st">&quot;_diff&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">names</span>(.)

<span class="co"># Create empty soon-to-be-filled objects</span>
m &lt;-<span class="st"> </span><span class="ot">NA</span>
mean &lt;-<span class="st"> </span><span class="ot">NA</span>
m_p &lt;-<span class="st"> </span><span class="ot">NA</span>
ci_low &lt;-<span class="st"> </span><span class="ot">NA</span>
ci_high &lt;-<span class="st"> </span><span class="ot">NA</span>
ICC_group &lt;-<span class="st"> </span><span class="ot">NA</span>
ICC_School &lt;-<span class="st"> </span><span class="ot">NA</span>
nonmissings &lt;-<span class="st"> </span><span class="ot">NA</span>

## # Use this to test a single variable:
## dftest &lt;- df #%&gt;% na.omit()
## m &lt;- lme4::lmer(sitLieAccelerometer_diff ~ (1|school) + (1|group), data=dftest)
## mean &lt;- lme4::fixef(m)
## m_p &lt;- profile(m, which = &quot;beta_&quot;)
## ci_low &lt;- confint(m_p)[, 1]
## ci_high &lt;- confint(m_p)[, 2]
## ICC_group &lt;- icc(m)[1]
## ICC_School &lt;- icc(m)[2]
## nonmissings &lt;- length(m@resp$y)


<span class="co"># # UNCOMMENT below and run code</span>

<span class="co"># for (i in names){ # Loop over each variable name for all participants, extract statistics</span>
<span class="co"># m &lt;- lme4::lmer(paste0(i,&quot; ~ (1|school) + (1|group)&quot;), data=df)</span>
<span class="co"># mean[i] &lt;- lme4::fixef(m)</span>
<span class="co"># m_p &lt;- profile(m, which = &quot;beta_&quot;)</span>
<span class="co"># ci_low[i] &lt;- confint(m_p)[, 1]</span>
<span class="co"># ci_high[i] &lt;- confint(m_p)[, 2]</span>
<span class="co"># ICC_group[i] &lt;- sjstats::icc(m)[1]</span>
<span class="co"># ICC_School[i] &lt;- sjstats::icc(m)[2]</span>
<span class="co"># nonmissings[i] &lt;- length(m@resp$y)</span>
<span class="co"># }</span>
<span class="co"># </span>
<span class="co"># </span>
<span class="co"># vardatatable &lt;- data_frame(</span>
<span class="co">#   Variable = stringr::str_sub(names(mean), end = -4), #remove &quot;_T1&quot; from names</span>
<span class="co">#   &quot;Mean&quot; = round(mean, 1),</span>
<span class="co">#   &quot;CI95&quot; = paste(round(ci_low, 1), &quot; - &quot;, round(ci_high, 2)),</span>
<span class="co">#   &quot;ICC class&quot; =ifelse(round(ICC_group, 3) == 0, &quot;&lt; 0.001&quot;, round(ICC_group, 3)),</span>
<span class="co">#   &quot;ICC school&quot; = ifelse(round(ICC_School, 3) == 0, &quot;&lt; 0.001&quot;, round(ICC_School, 3)),</span>
<span class="co">#   n = nonmissings) %&gt;%</span>
<span class="co">#   dplyr::arrange(Variable) %&gt;%</span>
<span class="co">#   dplyr::filter(Variable != &quot;&quot;) %&gt;% #remove first row, which is empty</span>
<span class="co">#   dplyr::mutate(`ICC class` = as.numeric(`ICC class`)) %&gt;%</span>
<span class="co">#   as.data.frame()</span>
<span class="co"># </span>
<span class="co"># ci_total &lt;- data_frame(</span>
<span class="co">#   &quot;ciLo&quot; = ci_low,</span>
<span class="co">#   &quot;mean&quot; = mean,</span>
<span class="co">#   &quot;ciHi&quot; = ci_high,</span>
<span class="co">#   &quot;diamondlabels&quot; = names(mean)) %&gt;%</span>
<span class="co">#   dplyr::filter(diamondlabels != &quot;&quot;) %&gt;% #remove first row, which is empty</span>
<span class="co">#   as.data.frame()</span>
<span class="co"># </span>
<span class="co"># save(vardatatable, file = &quot;./Rdata_files/vardatatable.Rdata&quot;)</span>
<span class="co"># save(ci_total, file = &quot;./Rdata_files/ci_total.Rdata&quot;)</span>
<span class="kw">load</span>(<span class="st">&quot;./Rdata_files/vardatatable.Rdata&quot;</span>)
<span class="kw">load</span>(<span class="st">&quot;./Rdata_files/ci_total.Rdata&quot;</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
vardatatable2 &lt;-<span class="st"> </span>vardatatable
vardatatable2<span class="op">$</span>Variable &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&quot;mvpaAccelerometer&quot;</span>, <span class="st">&quot;MVPA minutes (accelerometer)&quot;</span>, vardatatable2<span class="op">$</span>Variable)
vardatatable2<span class="op">$</span>Variable &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&quot;padaysLastweek&quot;</span>, <span class="st">&quot;Number of MVPA days last week (self-report)&quot;</span>, vardatatable2<span class="op">$</span>Variable)
vardatatable2<span class="op">$</span>Variable &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&quot;sitLieAccelerometer&quot;</span>, <span class="st">&quot;Minutes spent sitting or lying down (accelerometer)&quot;</span>, vardatatable2<span class="op">$</span>Variable)
vardatatable2<span class="op">$</span>Variable &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&quot;sitBreaksAccelerometer&quot;</span>, <span class="st">&quot;Number of times sitting was interrupted (accelerometer)&quot;</span>, vardatatable2<span class="op">$</span>Variable)

vardatatable2 <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(Variable <span class="op">==</span><span class="st"> &quot;MVPA minutes (accelerometer)&quot;</span> <span class="op">|</span><span class="st"> </span>
<span class="st">           </span>Variable <span class="op">==</span><span class="st"> &quot;Number of MVPA days last week (self-report)&quot;</span> <span class="op">|</span><span class="st"> </span>
<span class="st">           </span>Variable <span class="op">==</span><span class="st"> &quot;Minutes spent sitting or lying down (accelerometer)&quot;</span> <span class="op">|</span><span class="st"> </span>
<span class="st">           </span>Variable <span class="op">==</span><span class="st"> &quot;Number of times sitting was interrupted (accelerometer)&quot;</span> ) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span>papaja<span class="op">::</span><span class="kw">apa_table</span>(
        <span class="dt">caption =</span> <span class="st">&quot;Primary outcome variables with their class and school ICCs&quot;</span>,
        <span class="dt">escape =</span> <span class="ot">TRUE</span>, <span class="dt">format.args =</span> <span class="kw">list</span>(<span class="dt">digits =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">0</span>), <span class="dt">margin =</span> <span class="dv">2</span>)
        )</code></pre></div>
<caption>
(#tab:primary-outcome-vars-table-total)
</caption>
<caption>
<em>Primary outcome variables with their class and school ICCs</em>
</caption>
<table>
<thead>
<tr class="header">
<th align="left">Variable</th>
<th align="left">Mean</th>
<th align="left">CI95</th>
<th align="left">ICC class</th>
<th align="left">ICC school</th>
<th align="left">n</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">MVPA minutes (accelerometer)</td>
<td align="left">183.1</td>
<td align="left">166  -  200.45</td>
<td align="left">0.072</td>
<td align="left">0.096</td>
<td align="left">706</td>
</tr>
<tr class="even">
<td align="left">Number of MVPA days last week (self-report)</td>
<td align="left">2.8</td>
<td align="left">2.6  -  2.95</td>
<td align="left">0.047</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,082</td>
</tr>
<tr class="odd">
<td align="left">Number of times sitting was interrupted (accelerometer)</td>
<td align="left">28.0</td>
<td align="left">24.7  -  31.37</td>
<td align="left">0.058</td>
<td align="left">0.085</td>
<td align="left">706</td>
</tr>
<tr class="even">
<td align="left">Minutes spent sitting or lying down (accelerometer)</td>
<td align="left">573.9</td>
<td align="left">535.5  -  611.8</td>
<td align="left">0.086</td>
<td align="left">0.145</td>
<td align="left">706</td>
</tr>
</tbody>
</table>
<div id="all-main-variables-their-means-cis-and-iccs." class="section level2">
<h2>All main variables, their means, CIs and ICCs.</h2>
<p>Values calculated with a multilevel model accounting for school and classroom.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
vardatatable <span class="op">%&gt;%</span>
<span class="st">   </span>DT<span class="op">::</span><span class="kw">datatable</span>( <span class="co">#papaja::apa_table(</span>
        <span class="dt">caption =</span> <span class="st">&quot;All variables with their class and school ICCs (values calculated with a multilevel model accounting for school and classroom)&quot;</span>,
        <span class="dt">escape =</span> <span class="ot">TRUE</span> <span class="co">#, format.args = list(digits = c(1, 3, 0), margin = 2)</span>
   )</code></pre></div>
<div id="htmlwidget-0cbd436449649916ef84" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-0cbd436449649916ef84">{"x":{"filter":"none","caption":"<caption>All variables with their class and school ICCs (values calculated with a multilevel model accounting for school and classroom)<\/caption>","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153","154","155","156","157","158","159","160","161","162","163","164","165","166","167","168","169","170","171"],["big5agreeableness","big5agreeableness_01","big5agrReverseCoded_02","big5conscientiousness","big5conscientiousness_01","big5consReverseCoded_02","big5extraversion","big5extraversion_01","big5extReverseCoded_02","big5neuroticism","big5neuroticism_01","big5neurReverseCoded_02","big5openness","big5openness_01","big5openReverseCoded_02","fatpct","PA_actCop","PA_actionplan","PA_actplan_01","PA_actplan_02","PA_actplan_03","PA_actplan_04","PA_agrbct","PA_agrbct_01","PA_agrbct_02","PA_agrbct_03","PA_agrbct_04","PA_agrbct_05","PA_agrbct_06","PA_agrbct_07","PA_agrbct_08","PA_agrbct_09","PA_agrbct_10","PA_amotivation","PA_amotivation_01","PA_amotivation_02","PA_amotivation_03","PA_amotivation_04","PA_autonomous","PA_autonomous_01","PA_autonomous_02","PA_autonomous_03","PA_autonomous_04","PA_autonomous_05","PA_autonomous_06","PA_autonomous_07","PA_autonomous_08","PA_autonomous_09","PA_controlled","PA_controlled_01","PA_controlled_02","PA_controlled_03","PA_controlled_04","PA_controlled_05","PA_copingplan","PA_copplan_01","PA_copplan_02","PA_copplan_03","PA_copplan_04","PA_dnorm","PA_dnorm_01","PA_dnorm_02","PA_extrinsic","PA_extrinsic_01","PA_extrinsic_02","PA_extrinsic_03","PA_frqbct","PA_frqbct_01","PA_frqbct_02","PA_frqbct_03","PA_frqbct_04","PA_frqbct_05","PA_frqbct_06","PA_frqbct_07","PA_frqbct_08","PA_frqbct_09","PA_goal","PA_goal_01","PA_identified","PA_identified_01","PA_identified_02","PA_identified_03","PA_inorm","PA_inorm_01","PA_integrated","PA_integrated_01","PA_integrated_02","PA_integrated_03","PA_intention","PA_intention_01","PA_intention_02","PA_intrinsic","PA_intrinsic_01","PA_intrinsic_02","PA_intrinsic_03","PA_introjected","PA_introjected_01","PA_introjected_02","PA_opportunities","PA_opportunities_01","PA_opportunities_02","PA_opportunities_04","PA_opportunities_05","PA_opportunities_07","PA_opportunitiesReverseCoded_03","PA_opportunitiesReverseCoded_06","PA_opportunitiesReverseCoded_08","PA_outcomeExpectations","PA_outcomeExpectations_01","PA_outcomeExpectations_03","PA_outcomeExpectations_04","PA_outcomeExpectations_05","PA_outcomeExpectations_06","PA_outcomeExpectations_07","PA_outcomeExpectations_10","PA_outcomeExpectations_11","PA_outcomeExpectations_12","PA_outcomeExpectationsNegative_02","PA_outcomeExpectationsNegative_08","PA_outcomeExpectationsNegative_09","PA_pbc","PA_pbc_01","PA_pbc_03","PA_pbcReverseCoded_02","PA_selfefficacy","PA_selfefficacy_01","PA_selfefficacyReverseCoded_02","PA_sePbc","paAccelerometer","padaysLastweek","pafreqUsually","pahrsLastweek","pahrsUsually","paLastweek","paminLastweek","SB_dnorm","SB_dnorm_01","SB_dnorm_02","SB_inorm","SB_inorm_01","SB_inorm_02","SB_intention","SB_intention_01","SB_intention_02","SB_intention_03","SB_intention_04","SB_outcomeExpectations","SB_outcomeExpectations_02","SB_outcomeExpectations_03","SB_outcomeExpectations_04","SB_outcomeExpectations_05","SB_outcomeExpectations_06","SB_outcomeExpectationsNegative_01","SB_outcomeExpectationsNegative_07","SB_sePbc","SB_sePbc_01","SB_sePbc_02","SB_sePbc_03","SB_sePbc_04","SB_sePbc_05","sitBreaks","sitLieAccelerometer","symptom","symptom_headAche","symptom_irritabilityAngerbursts","symptom_lowerBackPain","symptom_neckShoulderPain","symptom_sleepDifficulty","symptom_stomachAche","symptom_tensionNervousness","symptom_tirednessFaintness"],[5.3,5.5,5.2,5,5.4,4.6,4.5,5,4.1,3.8,4.1,3.5,4.9,5.4,4.4,25.5,2.6,2.8,2.6,2.8,2.9,2.8,3.1,3.7,3.2,2.4,2.5,2.6,3.2,3,3.1,3.7,3.6,1.5,1.5,1.5,1.6,1.5,3.4,3.1,3.8,3.4,3.3,3.3,3.1,3.7,3.6,3.5,1.8,1.7,1.5,1.5,2.2,2.3,2.5,2.4,2.4,2.5,2.7,4.4,4.5,4.3,1.6,1.7,1.5,1.5,2.5,3.7,1.9,2,1.9,2.5,3.4,2.2,2.4,2.8,0.6,0.6,3.4,3.1,3.8,3.4,4.7,4.7,3.2,3.3,3.3,3.1,5.4,5.4,5.4,3.6,3.7,3.6,3.5,2.2,2.2,2.3,5.1,4.7,5.5,5.6,5.3,4.6,5.1,3.6,6.6,4.6,5.5,5.2,5.5,5.2,5.4,4.9,5.4,5.1,5.2,2.9,2.5,2.6,5.3,5.9,5.2,4.9,5.2,5.9,4.6,5.3,183.1,2.8,2.6,5.4,3.1,339.7,1.4,3.2,3.1,3.4,4,3.9,4.1,3.7,3.3,3.5,4,4.1,4.4,4.8,4.6,4.9,4.9,4.9,3.4,3.3,5,4.4,4.3,5.7,5.7,4.7,28,573.9,2,2,1.9,1.8,2,2.1,1.7,1.9,2.3],["5.2  -  5.5","5.4  -  5.66","5  -  5.37","4.9  -  5.17","5.2  -  5.65","4.5  -  4.78","4.3  -  4.77","4.7  -  5.24","3.8  -  4.32","3.6  -  4","3.8  -  4.39","3.4  -  3.67","4.7  -  5.12","5.1  -  5.59","4.2  -  4.67","22.4  -  28.67","2.6  -  2.69","2.7  -  2.83","2.5  -  2.68","2.7  -  2.88","2.8  -  2.93","2.7  -  2.86","3  -  3.23","3.5  -  3.85","3  -  3.33","2.3  -  2.57","2.4  -  2.67","2.5  -  2.78","3.1  -  3.38","2.9  -  3.16","3  -  3.25","3.5  -  3.85","3.5  -  3.79","1.5  -  1.61","1.4  -  1.59","1.4  -  1.63","1.5  -  1.69","1.4  -  1.55","3.3  -  3.52","3  -  3.29","3.7  -  3.86","3.2  -  3.51","3.2  -  3.47","3.1  -  3.39","3  -  3.22","3.6  -  3.88","3.5  -  3.76","3.4  -  3.62","1.8  -  1.9","1.6  -  1.73","1.4  -  1.55","1.5  -  1.61","2.1  -  2.28","2.2  -  2.4","2.4  -  2.56","2.3  -  2.47","2.4  -  2.5","2.4  -  2.54","2.6  -  2.77","4.2  -  4.58","4.3  -  4.71","4.1  -  4.52","1.5  -  1.62","1.6  -  1.73","1.4  -  1.55","1.5  -  1.61","2.4  -  2.62","3.6  -  3.84","1.8  -  1.98","1.9  -  2.13","1.8  -  2.02","2.4  -  2.64","3.3  -  3.54","2.1  -  2.3","2.3  -  2.5","2.7  -  2.9","0.5  -  0.59","0.5  -  0.59","3.3  -  3.54","3  -  3.29","3.7  -  3.86","3.2  -  3.51","4.5  -  4.84","4.5  -  4.84","3.1  -  3.34","3.2  -  3.47","3.1  -  3.39","3  -  3.22","5.2  -  5.57","5.2  -  5.55","5.2  -  5.61","3.5  -  3.74","3.6  -  3.88","3.5  -  3.76","3.4  -  3.62","2.2  -  2.33","2.1  -  2.28","2.2  -  2.4","5.1  -  5.19","4.3  -  4.98","5.4  -  5.62","5.4  -  5.75","5.2  -  5.43","4.5  -  4.77","5  -  5.23","3.3  -  3.95","6.5  -  6.68","4.5  -  4.74","5.3  -  5.7","4.9  -  5.47","5.3  -  5.65","5  -  5.39","5.2  -  5.63","4.7  -  5.13","5.2  -  5.54","4.9  -  5.38","4.9  -  5.45","2.7  -  3.02","2.3  -  2.69","2.5  -  2.68","5.2  -  5.45","5.7  -  5.98","5  -  5.4","4.7  -  5.11","5.1  -  5.35","5.8  -  5.96","4.4  -  4.77","5.1  -  5.4","166  -  200.45","2.6  -  2.95","2.4  -  2.73","4.7  -  6.16","2.9  -  3.36","296  -  382.07","1.4  -  1.5","3.1  -  3.41","2.9  -  3.22","3.2  -  3.59","3.9  -  4.14","3.8  -  4.11","3.9  -  4.28","3.4  -  4.06","3  -  3.64","3.2  -  3.81","3.7  -  4.37","3.8  -  4.43","4.3  -  4.53","4.6  -  5.06","4.4  -  4.88","4.7  -  5.12","4.7  -  5.09","4.7  -  5.11","3.3  -  3.51","3.2  -  3.51","4.8  -  5.14","4.1  -  4.6","4.1  -  4.54","5.6  -  5.87","5.6  -  5.88","4.5  -  4.91","24.7  -  31.37","535.5  -  611.8","1.8  -  2.11","1.8  -  2.16","1.8  -  2.04","1.7  -  1.85","1.8  -  2.17","1.9  -  2.27","1.6  -  1.86","1.8  -  2.08","2.2  -  2.4"],[0.033,0.045,0.005,null,0.014,null,0.02,0.048,0.002,0.014,0.017,0.011,0.01,0.025,null,0.003,0.035,0.038,0.032,0.028,0.037,0.038,0.052,0.061,0.025,0.009,0.035,0.055,0.028,0.022,0.023,0.032,0.044,0.035,0.031,0.026,0.032,0.027,0.073,0.002,0.031,0.058,0.059,0.048,0.072,0.072,0.057,0.055,0.005,0.01,0.024,0.011,null,0.006,0.023,0.007,0.004,0.035,0.035,0.05,0.05,0.027,0.022,0.01,0.024,0.011,0.027,0.014,0.024,0.007,0.035,0.033,0.016,0.003,0.014,0.007,0.046,0.046,0.04,0.002,0.031,0.058,0.006,0.006,0.071,0.059,0.048,0.072,0.105,0.088,0.111,0.074,0.072,0.057,0.055,null,null,0.006,0.018,0.037,0.018,0.021,null,0.009,null,null,0.02,0.034,0.042,0.008,0.009,0.023,0.03,0.039,0.019,0.055,0.042,0.046,0.038,0.023,0.028,0.032,0.014,0.005,0.007,0.009,0.002,0.028,0.072,0.047,0.094,0.024,0.085,0.024,null,0.003,null,0.01,0.012,null,0.03,0.014,null,null,0.023,0.028,0.029,0.017,0.024,0.038,0.04,0.047,0.008,0.012,0.015,0.01,0.003,0.026,0.034,0.005,0.058,0.086,0.023,0.007,0.026,0.004,0.011,0.01,0.015,0.007,0.025],["0.012","0.002","0.01","0.007","0.015","0.002","0.022","0.013","0.012","0.012","0.014","0.002","0.03","0.016","0.016","0.123","&lt; 0.001","&lt; 0.001","&lt; 0.001","&lt; 0.001","&lt; 0.001","&lt; 0.001","&lt; 0.001","&lt; 0.001","&lt; 0.001","&lt; 0.001","&lt; 0.001","&lt; 0.001","0.001","&lt; 0.001","&lt; 0.001","0.001","&lt; 0.001","0.002","&lt; 0.001","0.005","&lt; 0.001","&lt; 0.001","&lt; 0.001","0.012","&lt; 0.001","&lt; 0.001","0.004","&lt; 0.001","&lt; 0.001","0.005","&lt; 0.001","&lt; 0.001","&lt; 0.001","&lt; 0.001","&lt; 0.001","&lt; 0.001","0.001","&lt; 0.001","&lt; 0.001","&lt; 0.001","&lt; 0.001","&lt; 0.001","&lt; 0.001","0.003","0.004","0.004","&lt; 0.001","&lt; 0.001","&lt; 0.001","&lt; 0.001","&lt; 0.001","&lt; 0.001","&lt; 0.001","&lt; 0.001","&lt; 0.001","&lt; 0.001","&lt; 0.001","&lt; 0.001","&lt; 0.001","&lt; 0.001","&lt; 0.001","&lt; 0.001","0.004","0.012","&lt; 0.001","&lt; 0.001","0.003","0.003","&lt; 0.001","0.004","&lt; 0.001","&lt; 0.001","&lt; 0.001","&lt; 0.001","&lt; 0.001","&lt; 0.001","0.005","&lt; 0.001","&lt; 0.001","&lt; 0.001","0.001","&lt; 0.001","&lt; 0.001","0.02","&lt; 0.001","0.008","&lt; 0.001","0.001","&lt; 0.001","0.024","&lt; 0.001","0.013","0.011","0.018","0.007","0.011","0.016","0.008","0.006","0.011","0.014","&lt; 0.001","0.004","&lt; 0.001","0.004","&lt; 0.001","0.01","0.005","0.005","&lt; 0.001","0.005","0.007","0.096","&lt; 0.001","0.003","0.007","0.005","0.006","0.01","0.007","0.004","0.007","0.004","0.008","0.005","0.035","0.025","0.034","0.027","0.027","0.005","0.014","0.014","0.005","0.004","0.011","&lt; 0.001","0.003","0.011","0.014","0.015","&lt; 0.001","&lt; 0.001","0.012","0.085","0.145","0.039","0.027","0.01","0.005","0.033","0.023","0.023","0.024","0.009"],[1068,1061,1064,1067,1059,1065,1068,1063,1062,1068,1064,1061,1068,1062,1066,942,1073,1073,1073,1073,1073,1073,1071,1071,1071,1071,1071,1071,1071,1071,1071,1071,1071,1072,1062,1057,1067,1066,1078,1063,1063,1070,1070,1062,1066,1070,1066,1057,1073,1068,1069,1064,1068,1066,1073,1073,1073,1073,1073,1073,1073,1073,1069,1068,1069,1064,1070,1070,1070,1070,1070,1070,1070,1070,1070,1070,1061,1061,1074,1063,1063,1070,1073,1073,1073,1070,1062,1066,1073,1073,1073,1074,1070,1066,1057,1073,1068,1066,1075,1070,1067,1070,1064,1068,1065,1059,1066,1078,1071,1064,1071,1067,1071,1062,1069,1063,1070,1066,1063,1064,1071,1069,1066,1063,1071,1071,1071,1071,706,1082,1082,1082,1082,1082,1082,1062,1059,1060,1064,1056,1053,1064,1059,1056,1054,1055,1064,1056,1058,1063,1060,1058,1063,1057,1064,1062,1061,1060,1060,1054,706,706,1084,1055,1039,1053,1047,1052,1026,1051,1058]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Variable<\/th>\n      <th>Mean<\/th>\n      <th>CI95<\/th>\n      <th>ICC class<\/th>\n      <th>ICC school<\/th>\n      <th>n<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-center","targets":"_all"},{"className":"dt-right","targets":[2,4,6]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="assorted-tables-with-iccs" class="section level2 tabset">
<h2>Assorted tables with ICCs</h2>
<div id="description" class="section level3">
<h3>Description</h3>
<p><strong>See tabs above for differently sorted tables</strong></p>
</div>
<div id="model-with-school-and-class-icc-top-20-items-sorted-by-classroom-icc" class="section level3">
<h3>Model with school and class: ICC top 20 items, sorted by classroom ICC</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
vardatatable <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(Variable, <span class="st">`</span><span class="dt">ICC class</span><span class="st">`</span>, <span class="st">`</span><span class="dt">ICC school</span><span class="st">`</span>, n) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">arrange</span>(<span class="kw">desc</span>(<span class="st">`</span><span class="dt">ICC class</span><span class="st">`</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">slice</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">20</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">as.tbl</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>papaja<span class="op">::</span><span class="kw">apa_table</span>(<span class="dt">caption =</span> <span class="st">&quot;Intra-class correlations sorted by classroom ICC&quot;</span>,
        <span class="dt">format.args =</span> <span class="kw">list</span>(<span class="dt">digits =</span> <span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">0</span>), <span class="dt">margin =</span> <span class="dv">2</span>))</code></pre></div>
<caption>
(#tab:icc-school-class-sortbyclass)
</caption>
<caption>
<em>Intra-class correlations sorted by classroom ICC</em>
</caption>
<table>
<thead>
<tr class="header">
<th align="left">Variable</th>
<th align="left">ICC class</th>
<th align="left">ICC school</th>
<th align="left">n</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">PA_intention_02</td>
<td align="left">0.111</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,073</td>
</tr>
<tr class="even">
<td align="left">PA_intention</td>
<td align="left">0.105</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,073</td>
</tr>
<tr class="odd">
<td align="left">pafreqUsually</td>
<td align="left">0.094</td>
<td align="left">0.003</td>
<td align="left">1,082</td>
</tr>
<tr class="even">
<td align="left">PA_intention_01</td>
<td align="left">0.088</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,073</td>
</tr>
<tr class="odd">
<td align="left">sitLieAccelerometer</td>
<td align="left">0.086</td>
<td align="left">0.145</td>
<td align="left">706</td>
</tr>
<tr class="even">
<td align="left">pahrsUsually</td>
<td align="left">0.085</td>
<td align="left">0.005</td>
<td align="left">1,082</td>
</tr>
<tr class="odd">
<td align="left">PA_intrinsic</td>
<td align="left">0.074</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,074</td>
</tr>
<tr class="even">
<td align="left">PA_autonomous</td>
<td align="left">0.073</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,078</td>
</tr>
<tr class="odd">
<td align="left">PA_autonomous_06</td>
<td align="left">0.072</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,066</td>
</tr>
<tr class="even">
<td align="left">PA_autonomous_07</td>
<td align="left">0.072</td>
<td align="left">0.005</td>
<td align="left">1,070</td>
</tr>
<tr class="odd">
<td align="left">PA_integrated_03</td>
<td align="left">0.072</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,066</td>
</tr>
<tr class="even">
<td align="left">PA_intrinsic_01</td>
<td align="left">0.072</td>
<td align="left">0.005</td>
<td align="left">1,070</td>
</tr>
<tr class="odd">
<td align="left">paAccelerometer</td>
<td align="left">0.072</td>
<td align="left">0.096</td>
<td align="left">706</td>
</tr>
<tr class="even">
<td align="left">PA_integrated</td>
<td align="left">0.071</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,073</td>
</tr>
<tr class="odd">
<td align="left">PA_agrbct_01</td>
<td align="left">0.061</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,071</td>
</tr>
<tr class="even">
<td align="left">PA_autonomous_04</td>
<td align="left">0.059</td>
<td align="left">0.004</td>
<td align="left">1,070</td>
</tr>
<tr class="odd">
<td align="left">PA_integrated_01</td>
<td align="left">0.059</td>
<td align="left">0.004</td>
<td align="left">1,070</td>
</tr>
<tr class="even">
<td align="left">PA_autonomous_03</td>
<td align="left">0.058</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,070</td>
</tr>
<tr class="odd">
<td align="left">PA_identified_03</td>
<td align="left">0.058</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,070</td>
</tr>
<tr class="even">
<td align="left">sitBreaks</td>
<td align="left">0.058</td>
<td align="left">0.085</td>
<td align="left">706</td>
</tr>
</tbody>
</table>
</div>
<div id="model-with-school-and-class-icc-top-20-items-sorted-by-school-icc" class="section level3">
<h3>Model with school and class: ICC top 20 items, sorted by school ICC</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
vardatatable <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(Variable, <span class="st">`</span><span class="dt">ICC class</span><span class="st">`</span>, <span class="st">`</span><span class="dt">ICC school</span><span class="st">`</span>, n) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">arrange</span>(<span class="kw">desc</span>(<span class="st">`</span><span class="dt">ICC school</span><span class="st">`</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">slice</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">20</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>papaja<span class="op">::</span><span class="kw">apa_table</span>(<span class="dt">caption =</span> <span class="st">&quot;Intra-class correlations sorted by school ICC&quot;</span>,
        <span class="dt">format.args =</span> <span class="kw">list</span>(<span class="dt">digits =</span> <span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">0</span>), <span class="dt">margin =</span> <span class="dv">2</span>))</code></pre></div>
<caption>
(#tab:icc-school-class-sortbyschool)
</caption>
<caption>
<em>Intra-class correlations sorted by school ICC</em>
</caption>
<table>
<thead>
<tr class="header">
<th align="left">Variable</th>
<th align="left">ICC class</th>
<th align="left">ICC school</th>
<th align="left">n</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">sitLieAccelerometer</td>
<td align="left">0.086</td>
<td align="left">0.145</td>
<td align="left">706</td>
</tr>
<tr class="even">
<td align="left">fatpct</td>
<td align="left">0.003</td>
<td align="left">0.123</td>
<td align="left">942</td>
</tr>
<tr class="odd">
<td align="left">paAccelerometer</td>
<td align="left">0.072</td>
<td align="left">0.096</td>
<td align="left">706</td>
</tr>
<tr class="even">
<td align="left">sitBreaks</td>
<td align="left">0.058</td>
<td align="left">0.085</td>
<td align="left">706</td>
</tr>
<tr class="odd">
<td align="left">symptom</td>
<td align="left">0.023</td>
<td align="left">0.039</td>
<td align="left">1,084</td>
</tr>
<tr class="even">
<td align="left">SB_intention</td>
<td align="left">0.014</td>
<td align="left">0.035</td>
<td align="left">1,064</td>
</tr>
<tr class="odd">
<td align="left">SB_intention_02</td>
<td align="left">NA</td>
<td align="left">0.034</td>
<td align="left">1,056</td>
</tr>
<tr class="even">
<td align="left">symptom_neckShoulderPain</td>
<td align="left">0.011</td>
<td align="left">0.033</td>
<td align="left">1,047</td>
</tr>
<tr class="odd">
<td align="left">big5openness</td>
<td align="left">0.010</td>
<td align="left">0.03</td>
<td align="left">1,068</td>
</tr>
<tr class="even">
<td align="left">SB_intention_03</td>
<td align="left">0.023</td>
<td align="left">0.027</td>
<td align="left">1,054</td>
</tr>
<tr class="odd">
<td align="left">SB_intention_04</td>
<td align="left">0.028</td>
<td align="left">0.027</td>
<td align="left">1,055</td>
</tr>
<tr class="even">
<td align="left">symptom_headAche</td>
<td align="left">0.007</td>
<td align="left">0.027</td>
<td align="left">1,055</td>
</tr>
<tr class="odd">
<td align="left">SB_intention_01</td>
<td align="left">NA</td>
<td align="left">0.025</td>
<td align="left">1,059</td>
</tr>
<tr class="even">
<td align="left">PA_opportunitiesReverseCoded_06</td>
<td align="left">NA</td>
<td align="left">0.024</td>
<td align="left">1,059</td>
</tr>
<tr class="odd">
<td align="left">symptom_tensionNervousness</td>
<td align="left">0.007</td>
<td align="left">0.024</td>
<td align="left">1,051</td>
</tr>
<tr class="even">
<td align="left">symptom_sleepDifficulty</td>
<td align="left">0.010</td>
<td align="left">0.023</td>
<td align="left">1,052</td>
</tr>
<tr class="odd">
<td align="left">symptom_stomachAche</td>
<td align="left">0.015</td>
<td align="left">0.023</td>
<td align="left">1,026</td>
</tr>
<tr class="even">
<td align="left">big5extraversion</td>
<td align="left">0.020</td>
<td align="left">0.022</td>
<td align="left">1,068</td>
</tr>
<tr class="odd">
<td align="left">PA_opportunities_01</td>
<td align="left">0.037</td>
<td align="left">0.02</td>
<td align="left">1,070</td>
</tr>
<tr class="even">
<td align="left">PA_outcomeExpectations_03</td>
<td align="left">0.008</td>
<td align="left">0.018</td>
<td align="left">1,064</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="model-with-school-class-and-educational-track" class="section level2 tabset">
<h2>Model with school, class and educational track</h2>
<p>The model below is the same as the one above, except it adds educational track.</p>
<p>As before, we create a table with all variables, their means, CIs and ICCs.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#library(sjstats)</span>
<span class="co">#library(lme4)</span>

names &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>id, <span class="op">-</span>intervention, <span class="op">-</span>group, <span class="op">-</span>school, <span class="op">-</span>girl, <span class="op">-</span>track, <span class="op">-</span>trackSchool, <span class="op">-</span><span class="kw">contains</span>(<span class="st">&quot;_T3&quot;</span>), <span class="op">-</span><span class="kw">contains</span>(<span class="st">&quot;_diff&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">names</span>(.)

<span class="co"># Create empty soon-to-be-filled objects</span>
m &lt;-<span class="st"> </span><span class="ot">NA</span>
mean &lt;-<span class="st"> </span><span class="ot">NA</span>
m_p &lt;-<span class="st"> </span><span class="ot">NA</span>
ci_low &lt;-<span class="st"> </span><span class="ot">NA</span>
ci_high &lt;-<span class="st"> </span><span class="ot">NA</span>
ICC_group &lt;-<span class="st"> </span><span class="ot">NA</span>
ICC_School &lt;-<span class="st"> </span><span class="ot">NA</span>
nonmissings &lt;-<span class="st"> </span><span class="ot">NA</span>
ICC_track &lt;-<span class="st"> </span><span class="ot">NA</span>


## To test the code with a single variable:
<span class="co"># dftest &lt;- df #%&gt;% na.omit()</span>
<span class="co"># m &lt;- lme4::lmer(sitLieAccelerometer_T1 ~ (1|school) + (1|group) + (1|track), data=df)</span>
<span class="co"># mean &lt;- lme4::fixef(m)</span>
<span class="co"># m_p &lt;- profile(m)</span>
<span class="co"># ci_low &lt;- confint(m_p)[5]</span>
<span class="co"># ci_high &lt;- confint(m_p)[10]</span>
<span class="co"># ICC_group &lt;- icc(m)[1]</span>
<span class="co"># ICC_School &lt;- icc(m)[2]</span>
<span class="co"># nonmissings &lt;- length(m@resp$y)</span>

<span class="co"># # UNCOMMENT below and run code</span>

<span class="co"># for (i in names){ # Loop over each variable name for all participants, extract statistics</span>
<span class="co"># m &lt;- lme4::lmer(paste0(i,&quot; ~ (1|school) + (1|group) + (1|track)&quot;), data=df)</span>
<span class="co"># mean[i] &lt;- lme4::fixef(m)</span>
<span class="co"># m_p &lt;- profile(m, which = &quot;beta_&quot;)</span>
<span class="co"># ci_low[i] &lt;- confint(m_p)[1]</span>
<span class="co"># ci_high[i] &lt;- confint(m_p)[2]</span>
<span class="co"># ICC_group[i] &lt;- sjstats::icc(m)[1]</span>
<span class="co"># ICC_School[i] &lt;- sjstats::icc(m)[3]</span>
<span class="co"># ICC_track[i] &lt;- sjstats::icc(m)[2]</span>
<span class="co"># nonmissings[i] &lt;- length(m@resp$y)</span>
<span class="co"># }</span>
<span class="co"># </span>
<span class="co"># vardatatable_containing_edutrack &lt;- data_frame(</span>
<span class="co">#   Variable = stringr::str_sub(names(mean), end = -4), #remove &quot;_T1&quot; from names</span>
<span class="co">#   Mean = round(mean, 1), </span>
<span class="co">#   CI95 = paste(round(ci_low, 2), &quot;-&quot;, round(ci_high, 2)), </span>
<span class="co">#   &quot;ICC class&quot; =ifelse(round(ICC_group, 3) == 0, &quot;&lt; 0.001&quot;, round(ICC_group, 3)), </span>
<span class="co">#   &quot;ICC school&quot; = ifelse(round(ICC_School, 3) == 0, &quot;&lt; 0.001&quot;, round(ICC_School, 3)),</span>
<span class="co">#   &quot;ICC educational track&quot; = ifelse(round(ICC_track, 3) == 0, &quot;&lt; 0.001&quot;, round(ICC_track, 3)),</span>
<span class="co">#   n = nonmissings) %&gt;% </span>
<span class="co">#   dplyr::arrange(Variable) %&gt;% </span>
<span class="co">#   dplyr::filter(Variable != &quot;&quot;) #remove first row, which is empty</span>
<span class="co"># </span>
<span class="co">#</span>
<span class="co"># ci_edutrack &lt;- data_frame(</span>
<span class="co">#   &quot;ciLo&quot; = ci_low,</span>
<span class="co">#   &quot;mean&quot; = mean,</span>
<span class="co">#   &quot;ciHi&quot; = ci_high,</span>
<span class="co">#   &quot;diamondlabels&quot; = names(mean)) %&gt;%</span>
<span class="co">#   dplyr::filter(diamondlabels != &quot;&quot;) %&gt;% #remove first row, which is empty</span>
<span class="co">#   as.data.frame()</span>
<span class="co"># </span>
<span class="co"># save(vardatatable_containing_edutrack, file = &quot;vardatatable_containing_edutrack.Rdata&quot;)</span>
<span class="co"># save(ci_edutrack, file = &quot;ci_edutrack.Rdata&quot;)</span>
<span class="kw">load</span>(<span class="st">&quot;vardatatable_containing_edutrack.Rdata&quot;</span>)
<span class="kw">load</span>(<span class="st">&quot;ci_edutrack.Rdata&quot;</span>)</code></pre></div>
<div id="main-table" class="section level3">
<h3>Main table</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
vardatatable_containing_edutrack <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>DT<span class="op">::</span><span class="kw">datatable</span>(<span class="dt">caption =</span> <span class="st">&quot;Values calculated with a multilevel model accounting for school, classroom and educational track&quot;</span>)</code></pre></div>
<div id="htmlwidget-1263cc3576c0d60ec172" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-1263cc3576c0d60ec172">{"x":{"filter":"none","caption":"<caption>Values calculated with a multilevel model accounting for school, classroom and educational track<\/caption>","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153","154","155","156","157","158","159","160","161","162","163","164","165","166","167","168","169","170","171"],["big5agreeableness","big5agreeableness_01","big5agrReverseCoded_02","big5conscientiousness","big5conscientiousness_01","big5consReverseCoded_02","big5extraversion","big5extraversion_01","big5extReverseCoded_02","big5neuroticism","big5neuroticism_01","big5neurReverseCoded_02","big5openness","big5openness_01","big5openReverseCoded_02","fatpct","PA_actCop","PA_actionplan","PA_actplan_01","PA_actplan_02","PA_actplan_03","PA_actplan_04","PA_agrbct","PA_agrbct_01","PA_agrbct_02","PA_agrbct_03","PA_agrbct_04","PA_agrbct_05","PA_agrbct_06","PA_agrbct_07","PA_agrbct_08","PA_agrbct_09","PA_agrbct_10","PA_amotivation","PA_amotivation_01","PA_amotivation_02","PA_amotivation_03","PA_amotivation_04","PA_autonomous","PA_autonomous_01","PA_autonomous_02","PA_autonomous_03","PA_autonomous_04","PA_autonomous_05","PA_autonomous_06","PA_autonomous_07","PA_autonomous_08","PA_autonomous_09","PA_controlled","PA_controlled_01","PA_controlled_02","PA_controlled_03","PA_controlled_04","PA_controlled_05","PA_copingplan","PA_copplan_01","PA_copplan_02","PA_copplan_03","PA_copplan_04","PA_dnorm","PA_dnorm_01","PA_dnorm_02","PA_extrinsic","PA_extrinsic_01","PA_extrinsic_02","PA_extrinsic_03","PA_frqbct","PA_frqbct_01","PA_frqbct_02","PA_frqbct_03","PA_frqbct_04","PA_frqbct_05","PA_frqbct_06","PA_frqbct_07","PA_frqbct_08","PA_frqbct_09","PA_goal","PA_goal_01","PA_identified","PA_identified_01","PA_identified_02","PA_identified_03","PA_inorm","PA_inorm_01","PA_integrated","PA_integrated_01","PA_integrated_02","PA_integrated_03","PA_intention","PA_intention_01","PA_intention_02","PA_intrinsic","PA_intrinsic_01","PA_intrinsic_02","PA_intrinsic_03","PA_introjected","PA_introjected_01","PA_introjected_02","PA_opportunities","PA_opportunities_01","PA_opportunities_02","PA_opportunities_04","PA_opportunities_05","PA_opportunities_07","PA_opportunitiesReverseCoded_03","PA_opportunitiesReverseCoded_06","PA_opportunitiesReverseCoded_08","PA_outcomeExpectations","PA_outcomeExpectations_01","PA_outcomeExpectations_03","PA_outcomeExpectations_04","PA_outcomeExpectations_05","PA_outcomeExpectations_06","PA_outcomeExpectations_07","PA_outcomeExpectations_10","PA_outcomeExpectations_11","PA_outcomeExpectations_12","PA_outcomeExpectationsNegative_02","PA_outcomeExpectationsNegative_08","PA_outcomeExpectationsNegative_09","PA_pbc","PA_pbc_01","PA_pbc_03","PA_pbcReverseCoded_02","PA_selfefficacy","PA_selfefficacy_01","PA_selfefficacyReverseCoded_02","PA_sePbc","paAccelerometer","padaysLastweek","pafreqUsually","pahrsLastweek","pahrsUsually","paLastweek","paminLastweek","SB_dnorm","SB_dnorm_01","SB_dnorm_02","SB_inorm","SB_inorm_01","SB_inorm_02","SB_intention","SB_intention_01","SB_intention_02","SB_intention_03","SB_intention_04","SB_outcomeExpectations","SB_outcomeExpectations_02","SB_outcomeExpectations_03","SB_outcomeExpectations_04","SB_outcomeExpectations_05","SB_outcomeExpectations_06","SB_outcomeExpectationsNegative_01","SB_outcomeExpectationsNegative_07","SB_sePbc","SB_sePbc_01","SB_sePbc_02","SB_sePbc_03","SB_sePbc_04","SB_sePbc_05","sitBreaks","sitLieAccelerometer","symptom","symptom_headAche","symptom_irritabilityAngerbursts","symptom_lowerBackPain","symptom_neckShoulderPain","symptom_sleepDifficulty","symptom_stomachAche","symptom_tensionNervousness","symptom_tirednessFaintness"],[5.3,5.5,5.1,5,5.4,4.6,4.5,4.9,4.1,3.8,4,3.5,4.9,5.3,4.4,25.4,2.6,2.7,2.6,2.8,2.8,2.7,3.1,3.6,3.2,2.5,2.6,2.7,3.2,3,3.1,3.6,3.6,1.7,1.6,1.6,1.7,1.6,3.4,3,3.7,3.4,3.3,3.2,3.1,3.7,3.6,3.5,1.9,1.8,1.6,1.6,2.2,2.3,2.5,2.4,2.4,2.5,2.7,4.4,4.5,4.3,1.7,1.8,1.6,1.6,2.5,3.7,1.9,2,1.9,2.5,3.4,2.2,2.4,2.8,0.6,0.6,3.4,3,3.7,3.4,4.7,4.7,3.2,3.3,3.2,3.1,5.3,5.3,5.3,3.6,3.7,3.6,3.5,2.2,2.2,2.3,5.1,4.7,5.5,5.6,5.3,4.6,5.1,3.6,6.6,4.6,5.4,5.1,5.5,5.2,5.3,4.9,5.3,5,5.1,3,2.6,2.6,5.3,5.9,5.2,4.9,5.2,5.9,4.6,5.3,177.9,2.8,2.5,5.5,3.1,345.7,1.4,3.2,3,3.4,4,3.9,4.1,3.7,3.3,3.5,4,4,4.4,4.8,4.6,4.9,4.9,4.8,3.4,3.4,5,4.4,4.3,5.7,5.7,4.7,27,583.5,2,2,1.9,1.7,1.9,2.1,1.8,1.9,2.3],["5.11 - 5.47","5.3 - 5.68","4.85 - 5.35","4.83 - 5.16","5.19 - 5.64","4.42 - 4.77","4.11 - 4.9","4.32 - 5.4","3.82 - 4.36","3.53 - 4","3.68 - 4.37","3.38 - 3.67","4.65 - 5.16","5 - 5.65","4.19 - 4.67","NA - 28.52","2.43 - 2.78","2.54 - 2.9","2.37 - 2.78","2.59 - 2.92","2.65 - 2.98","2.52 - 2.93","2.77 - 3.49","3.13 - 4.12","2.79 - 3.57","2.15 - 2.97","2.19 - 2.99","2.34 - 3.03","2.87 - 3.58","2.66 - 3.34","2.75 - 3.45","3.29 - 4.01","3.24 - 3.94","1.4 - 1.93","1.38 - 1.83","1.4 - 1.89","1.48 - 1.89","1.3 - 1.98","3.09 - 3.7","2.75 - 3.28","3.49 - 3.93","3.03 - 3.69","2.86 - 3.67","2.93 - 3.58","2.72 - 3.38","3.35 - 4.05","3.33 - 3.98","3.18 - 3.85","1.78 - 2.04","1.5 - 2.11","1.33 - 1.88","1.45 - 1.81","2.08 - 2.28","2.15 - 2.43","2.32 - 2.67","2.24 - 2.56","2.28 - 2.57","2.28 - 2.67","2.48 - 2.87","4.01 - 4.79","3.97 - 4.95","3.99 - 4.69","1.42 - 1.97","1.5 - 2.11","1.33 - 1.88","1.45 - 1.81","2.29 - 2.75","3.41 - 3.96","1.65 - 2.09","1.88 - 2.15","1.67 - 2.18","2.14 - 2.79","3.05 - 3.68","2.05 - 2.38","2.11 - 2.59","2.49 - 3.07","0.5 - 0.63","0.5 - 0.63","3.11 - 3.6","2.75 - 3.28","3.49 - 3.93","3.03 - 3.69","4.48 - 4.84","4.48 - 4.84","2.84 - 3.56","2.86 - 3.67","2.93 - 3.58","2.72 - 3.38","4.79 - 5.78","4.74 - 5.76","4.82 - 5.81","3.3 - 3.95","3.35 - 4.05","3.33 - 3.98","3.18 - 3.85","2.17 - 2.32","2.08 - 2.28","2.15 - 2.43","5.05 - 5.19","4.29 - 4.98","5.37 - 5.62","5.29 - 5.83","5.21 - 5.43","4.39 - 4.92","4.95 - 5.23","3.31 - 3.95","6.44 - 6.68","4.44 - 4.79","5.11 - 5.76","4.8 - 5.44","5.26 - 5.65","4.88 - 5.43","4.99 - 5.65","4.66 - 5.1","5.09 - 5.5","4.71 - 5.38","4.81 - 5.43","2.67 - 3.45","2.34 - 2.83","2.41 - 2.92","5.17 - 5.45","5.71 - 5.98","4.97 - 5.4","4.62 - 5.11","5.09 - 5.38","5.74 - 5.99","4.41 - 4.77","5.14 - 5.4","156.22 - 199.6","2.36 - 3.17","2.17 - 2.93","4.24 - 6.89","2.58 - 3.51","266.9 - 428.18","1.37 - 1.52","2.96 - 3.49","2.82 - 3.27","3.1 - 3.7","3.86 - 4.15","3.66 - 4.09","3.91 - 4.32","3.27 - 4.2","2.91 - 3.78","3.07 - 3.98","3.49 - 4.52","3.59 - 4.51","4.23 - 4.55","4.53 - 5.01","4.24 - 4.97","4.62 - 5.14","4.64 - 5.18","4.49 - 5.13","3.28 - 3.52","3.17 - 3.59","4.82 - 5.14","4.14 - 4.6","4.07 - 4.55","5.6 - 5.9","5.58 - 5.89","4.46 - 4.91","22.79 - 31.27","537.01 - 629.45","1.78 - 2.14","1.78 - 2.18","1.71 - 2.08","1.58 - 1.86","1.72 - 2.11","1.85 - 2.24","1.54 - 2","1.71 - 2.06","2.13 - 2.42"],["0.032","0.041","0.002","&lt; 0.001","0.012","&lt; 0.001","&lt; 0.001","0.005","0.001","0.006","0.009","0.011","0.004","0.011","&lt; 0.001","0.002","0.006","0.013","0.006","0.015","0.021","0.008","0.004","0.007","&lt; 0.001","&lt; 0.001","0.014","0.03","0.009","&lt; 0.001","&lt; 0.001","0.007","0.019","0.006","&lt; 0.001","0.004","0.015","0.014","0.005","&lt; 0.001","0.012","0.013","&lt; 0.001","&lt; 0.001","0.021","0.012","0.004","0.002","0.004","&lt; 0.001","0.012","0.005","&lt; 0.001","0.002","&lt; 0.001","&lt; 0.001","&lt; 0.001","0.011","0.01","0.005","&lt; 0.001","0.013","0.008","&lt; 0.001","0.012","0.005","0.002","&lt; 0.001","0.013","0.006","0.02","0.008","&lt; 0.001","0.001","0.004","&lt; 0.001","0.038","0.038","0.006","&lt; 0.001","0.012","0.013","0.006","0.006","&lt; 0.001","&lt; 0.001","&lt; 0.001","0.021","0.039","0.027","0.044","0.009","0.012","0.004","0.002","&lt; 0.001","&lt; 0.001","0.002","0.018","0.033","0.018","0.012","&lt; 0.001","0.004","&lt; 0.001","&lt; 0.001","0.02","0.029","0.021","0.004","0.009","0.013","0.013","0.036","0.016","0.035","0.031","0.031","0.028","0.015","0.027","0.031","0.014","0.005","0.005","0.007","0.002","0.026","0.021","0.006","0.023","0.004","0.033","0.004","&lt; 0.001","&lt; 0.001","&lt; 0.001","0.002","0.009","&lt; 0.001","0.025","&lt; 0.001","&lt; 0.001","&lt; 0.001","0.005","0.012","0.019","0.013","0.01","0.028","0.033","0.033","0.008","0.008","0.015","0.01","0.003","0.025","0.033","0.005","0.014","0.039","0.013","0.002","0.011","&lt; 0.001","0.012","0.008","0.007","0.005","0.023"],["&lt; 0.001","&lt; 0.001","&lt; 0.001","0.004","0.013","&lt; 0.001","0.026","0.015","0.013","&lt; 0.001","&lt; 0.001","0.002","0.026","0.009","0.016","0.106","&lt; 0.001","&lt; 0.001","&lt; 0.001","&lt; 0.001","&lt; 0.001","&lt; 0.001","0.003","&lt; 0.001","&lt; 0.001","&lt; 0.001","0.004","&lt; 0.001","0.005","&lt; 0.001","0.004","0.001","0.003","&lt; 0.001","&lt; 0.001","&lt; 0.001","&lt; 0.001","&lt; 0.001","0.006","&lt; 0.001","&lt; 0.001","0.007","0.011","0.006","0.001","0.007","0.007","0.001","&lt; 0.001","&lt; 0.001","&lt; 0.001","&lt; 0.001","0.001","&lt; 0.001","&lt; 0.001","&lt; 0.001","&lt; 0.001","&lt; 0.001","&lt; 0.001","0.004","0.012","&lt; 0.001","&lt; 0.001","&lt; 0.001","&lt; 0.001","&lt; 0.001","&lt; 0.001","&lt; 0.001","0.002","&lt; 0.001","0.003","0.002","0.002","&lt; 0.001","&lt; 0.001","&lt; 0.001","&lt; 0.001","&lt; 0.001","&lt; 0.001","&lt; 0.001","&lt; 0.001","0.007","0.003","0.003","0.008","0.011","0.006","0.001","&lt; 0.001","&lt; 0.001","&lt; 0.001","0.006","0.007","0.007","0.001","&lt; 0.001","0.001","&lt; 0.001","&lt; 0.001","&lt; 0.001","&lt; 0.001","0.01","&lt; 0.001","&lt; 0.001","&lt; 0.001","0.022","&lt; 0.001","0.003","0.009","&lt; 0.001","0.007","0.007","0.002","&lt; 0.001","&lt; 0.001","&lt; 0.001","&lt; 0.001","&lt; 0.001","&lt; 0.001","&lt; 0.001","0.003","&lt; 0.001","0.01","0.003","0.004","&lt; 0.001","0.005","0.006","&lt; 0.001","&lt; 0.001","0.005","&lt; 0.001","0.004","&lt; 0.001","0.011","&lt; 0.001","&lt; 0.001","&lt; 0.001","0.003","&lt; 0.001","0.006","&lt; 0.001","&lt; 0.001","0.006","&lt; 0.001","&lt; 0.001","&lt; 0.001","&lt; 0.001","&lt; 0.001","&lt; 0.001","&lt; 0.001","&lt; 0.001","&lt; 0.001","&lt; 0.001","0.011","0.014","0.015","&lt; 0.001","&lt; 0.001","0.012","&lt; 0.001","0.131","&lt; 0.001","&lt; 0.001","0.002","&lt; 0.001","&lt; 0.001","0.007","&lt; 0.001","0.006","0.004"],["0.017","0.01","0.015","0.008","0.006","0.004","0.048","0.076","0.003","0.023","0.025","&lt; 0.001","0.014","0.028","&lt; 0.001","0.007","0.036","0.031","0.033","0.018","0.02","0.038","0.063","0.062","0.039","0.042","0.041","0.035","0.028","0.036","0.034","0.034","0.029","0.091","0.048","0.055","0.029","0.113","0.073","0.034","0.024","0.053","0.084","0.053","0.049","0.069","0.058","0.062","0.051","0.077","0.08","0.026","&lt; 0.001","0.005","0.034","0.022","0.015","0.034","0.033","0.052","0.054","0.023","0.096","0.077","0.08","0.026","0.034","0.024","0.014","0.002","0.021","0.029","0.025","0.004","0.015","0.02","0.007","0.007","0.044","0.034","0.024","0.053","&lt; 0.001","&lt; 0.001","0.082","0.084","0.053","0.049","0.064","0.061","0.064","0.071","0.069","0.058","0.062","0.001","&lt; 0.001","0.005","&lt; 0.001","0.02","&lt; 0.001","0.011","&lt; 0.001","0.014","&lt; 0.001","0.002","0.003","0.024","0.027","0.027","&lt; 0.001","0.019","0.04","0.01","0.008","0.032","0.024","0.044","0.015","0.016","0.002","0.001","&lt; 0.001","0.005","0.003","0.001","&lt; 0.001","0.002","0.156","0.04","0.069","0.036","0.051","0.037","0.005","0.026","0.015","0.03","0.005","0.014","0.005","0.076","0.05","0.061","0.064","0.055","0.017","0.017","0.041","0.014","0.016","0.029","&lt; 0.001","0.008","&lt; 0.001","&lt; 0.001","&lt; 0.001","0.003","0.003","&lt; 0.001","0.14","0.085","0.066","0.038","0.028","0.018","0.032","0.018","0.08","0.019","0.007"],[1068,1061,1064,1067,1059,1065,1068,1063,1062,1068,1064,1061,1068,1062,1066,942,1073,1073,1073,1073,1073,1073,1071,1071,1071,1071,1071,1071,1071,1071,1071,1071,1071,1072,1062,1057,1067,1066,1078,1063,1063,1070,1070,1062,1066,1070,1066,1057,1073,1068,1069,1064,1068,1066,1073,1073,1073,1073,1073,1073,1073,1073,1069,1068,1069,1064,1070,1070,1070,1070,1070,1070,1070,1070,1070,1070,1061,1061,1074,1063,1063,1070,1073,1073,1073,1070,1062,1066,1073,1073,1073,1074,1070,1066,1057,1073,1068,1066,1075,1070,1067,1070,1064,1068,1065,1059,1066,1078,1071,1064,1071,1067,1071,1062,1069,1063,1070,1066,1063,1064,1071,1069,1066,1063,1071,1071,1071,1071,706,1082,1082,1082,1082,1082,1082,1062,1059,1060,1064,1056,1053,1064,1059,1056,1054,1055,1064,1056,1058,1063,1060,1058,1063,1057,1064,1062,1061,1060,1060,1054,706,706,1084,1055,1039,1053,1047,1052,1026,1051,1058]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Variable<\/th>\n      <th>Mean<\/th>\n      <th>CI95<\/th>\n      <th>ICC class<\/th>\n      <th>ICC school<\/th>\n      <th>ICC educational track<\/th>\n      <th>n<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-center","targets":"_all"},{"className":"dt-right","targets":[2,7]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="model-with-school-class-and-track-top-20-items-sorted-by-school" class="section level3">
<h3>Model with school, class and track: Top 20 items, sorted by school</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
vardatatable_containing_edutrack <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(Variable, <span class="st">`</span><span class="dt">ICC educational track</span><span class="st">`</span>, <span class="st">`</span><span class="dt">ICC class</span><span class="st">`</span>, <span class="st">`</span><span class="dt">ICC school</span><span class="st">`</span>, n) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">arrange</span>(<span class="kw">desc</span>(<span class="st">`</span><span class="dt">ICC school</span><span class="st">`</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">top_n</span>(<span class="dv">20</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>papaja<span class="op">::</span><span class="kw">apa_table</span>(<span class="dt">caption =</span> <span class="st">&quot;Intra-class correlations sorted by school ICC&quot;</span>,
        <span class="dt">format.args =</span> <span class="kw">list</span>(<span class="dt">digits =</span> <span class="kw">c</span>(<span class="dv">0</span>), <span class="dt">margin =</span> <span class="dv">2</span>))
## Selecting by n</code></pre></div>
<caption>
(#tab:icc-school-class-track-sortbyschool)
</caption>
<caption>
<em>Intra-class correlations sorted by school ICC</em>
</caption>
<table>
<thead>
<tr class="header">
<th align="left">Variable</th>
<th align="left">ICC educational track</th>
<th align="left">ICC class</th>
<th align="left">ICC school</th>
<th align="left">n</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">PA_dnorm_01</td>
<td align="left">0.054</td>
<td align="left">&lt; 0.001</td>
<td align="left">0.012</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">paminLastweek</td>
<td align="left">0.005</td>
<td align="left">&lt; 0.001</td>
<td align="left">0.011</td>
<td align="left">1082</td>
</tr>
<tr class="odd">
<td align="left">PA_integrated</td>
<td align="left">0.082</td>
<td align="left">&lt; 0.001</td>
<td align="left">0.008</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">PA_autonomous</td>
<td align="left">0.073</td>
<td align="left">0.005</td>
<td align="left">0.006</td>
<td align="left">1078</td>
</tr>
<tr class="odd">
<td align="left">PA_intrinsic</td>
<td align="left">0.071</td>
<td align="left">0.009</td>
<td align="left">0.006</td>
<td align="left">1074</td>
</tr>
<tr class="even">
<td align="left">pafreqUsually</td>
<td align="left">0.069</td>
<td align="left">0.023</td>
<td align="left">0.005</td>
<td align="left">1082</td>
</tr>
<tr class="odd">
<td align="left">PA_dnorm</td>
<td align="left">0.052</td>
<td align="left">0.005</td>
<td align="left">0.004</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">pahrsUsually</td>
<td align="left">0.051</td>
<td align="left">0.033</td>
<td align="left">0.004</td>
<td align="left">1082</td>
</tr>
<tr class="odd">
<td align="left">PA_inorm</td>
<td align="left">&lt; 0.001</td>
<td align="left">0.006</td>
<td align="left">0.003</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">PA_inorm_01</td>
<td align="left">&lt; 0.001</td>
<td align="left">0.006</td>
<td align="left">0.003</td>
<td align="left">1073</td>
</tr>
<tr class="odd">
<td align="left">PA_outcomeExpectations</td>
<td align="left">0.024</td>
<td align="left">0.029</td>
<td align="left">0.003</td>
<td align="left">1078</td>
</tr>
<tr class="even">
<td align="left">PA_actCop</td>
<td align="left">0.036</td>
<td align="left">0.006</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="odd">
<td align="left">PA_actionplan</td>
<td align="left">0.031</td>
<td align="left">0.013</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">PA_actplan_01</td>
<td align="left">0.033</td>
<td align="left">0.006</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="odd">
<td align="left">PA_actplan_02</td>
<td align="left">0.018</td>
<td align="left">0.015</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">PA_actplan_03</td>
<td align="left">0.02</td>
<td align="left">0.021</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="odd">
<td align="left">PA_actplan_04</td>
<td align="left">0.038</td>
<td align="left">0.008</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">PA_controlled</td>
<td align="left">0.051</td>
<td align="left">0.004</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="odd">
<td align="left">PA_copingplan</td>
<td align="left">0.034</td>
<td align="left">&lt; 0.001</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">PA_copplan_01</td>
<td align="left">0.022</td>
<td align="left">&lt; 0.001</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="odd">
<td align="left">PA_copplan_02</td>
<td align="left">0.015</td>
<td align="left">&lt; 0.001</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">PA_copplan_03</td>
<td align="left">0.034</td>
<td align="left">0.011</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="odd">
<td align="left">PA_copplan_04</td>
<td align="left">0.033</td>
<td align="left">0.01</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">PA_dnorm_02</td>
<td align="left">0.023</td>
<td align="left">0.013</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="odd">
<td align="left">PA_identified</td>
<td align="left">0.044</td>
<td align="left">0.006</td>
<td align="left">&lt; 0.001</td>
<td align="left">1074</td>
</tr>
<tr class="even">
<td align="left">PA_intention</td>
<td align="left">0.064</td>
<td align="left">0.039</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="odd">
<td align="left">PA_intention_01</td>
<td align="left">0.061</td>
<td align="left">0.027</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">PA_intention_02</td>
<td align="left">0.064</td>
<td align="left">0.044</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="odd">
<td align="left">PA_introjected</td>
<td align="left">0.001</td>
<td align="left">&lt; 0.001</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">PA_opportunities</td>
<td align="left">&lt; 0.001</td>
<td align="left">0.018</td>
<td align="left">&lt; 0.001</td>
<td align="left">1075</td>
</tr>
<tr class="odd">
<td align="left">padaysLastweek</td>
<td align="left">0.04</td>
<td align="left">0.006</td>
<td align="left">&lt; 0.001</td>
<td align="left">1082</td>
</tr>
<tr class="even">
<td align="left">pahrsLastweek</td>
<td align="left">0.036</td>
<td align="left">0.004</td>
<td align="left">&lt; 0.001</td>
<td align="left">1082</td>
</tr>
<tr class="odd">
<td align="left">paLastweek</td>
<td align="left">0.037</td>
<td align="left">0.004</td>
<td align="left">&lt; 0.001</td>
<td align="left">1082</td>
</tr>
<tr class="even">
<td align="left">symptom</td>
<td align="left">0.066</td>
<td align="left">0.013</td>
<td align="left">&lt; 0.001</td>
<td align="left">1084</td>
</tr>
</tbody>
</table>
</div>
<div id="model-with-school-class-and-track-top-20-items-sorted-by-classroom" class="section level3">
<h3>Model with school, class and track: Top 20 items, sorted by classroom</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
vardatatable_containing_edutrack <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(Variable, <span class="st">`</span><span class="dt">ICC educational track</span><span class="st">`</span>, <span class="st">`</span><span class="dt">ICC class</span><span class="st">`</span>, <span class="st">`</span><span class="dt">ICC school</span><span class="st">`</span>, n) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">arrange</span>(<span class="kw">desc</span>(<span class="st">`</span><span class="dt">ICC class</span><span class="st">`</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">top_n</span>(<span class="dv">20</span>) <span class="op">%&gt;%</span><span class="st"> </span>papaja<span class="op">::</span><span class="kw">apa_table</span>(<span class="dt">caption =</span> <span class="st">&quot;Intra-class correlations sorted by classroom ICC&quot;</span>,
        <span class="dt">format.args =</span> <span class="kw">list</span>(<span class="dt">digits =</span> <span class="kw">c</span>(<span class="dv">0</span>), <span class="dt">margin =</span> <span class="dv">2</span>))
## Selecting by n</code></pre></div>
<caption>
(#tab:icc-school-class-track-sortbyclass)
</caption>
<caption>
<em>Intra-class correlations sorted by classroom ICC</em>
</caption>
<table>
<thead>
<tr class="header">
<th align="left">Variable</th>
<th align="left">ICC educational track</th>
<th align="left">ICC class</th>
<th align="left">ICC school</th>
<th align="left">n</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">PA_intention_02</td>
<td align="left">0.064</td>
<td align="left">0.044</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">PA_intention</td>
<td align="left">0.064</td>
<td align="left">0.039</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="odd">
<td align="left">pahrsUsually</td>
<td align="left">0.051</td>
<td align="left">0.033</td>
<td align="left">0.004</td>
<td align="left">1082</td>
</tr>
<tr class="even">
<td align="left">PA_outcomeExpectations</td>
<td align="left">0.024</td>
<td align="left">0.029</td>
<td align="left">0.003</td>
<td align="left">1078</td>
</tr>
<tr class="odd">
<td align="left">PA_intention_01</td>
<td align="left">0.061</td>
<td align="left">0.027</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">pafreqUsually</td>
<td align="left">0.069</td>
<td align="left">0.023</td>
<td align="left">0.005</td>
<td align="left">1082</td>
</tr>
<tr class="odd">
<td align="left">PA_actplan_03</td>
<td align="left">0.02</td>
<td align="left">0.021</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">PA_opportunities</td>
<td align="left">&lt; 0.001</td>
<td align="left">0.018</td>
<td align="left">&lt; 0.001</td>
<td align="left">1075</td>
</tr>
<tr class="odd">
<td align="left">PA_actplan_02</td>
<td align="left">0.018</td>
<td align="left">0.015</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">PA_actionplan</td>
<td align="left">0.031</td>
<td align="left">0.013</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="odd">
<td align="left">PA_dnorm_02</td>
<td align="left">0.023</td>
<td align="left">0.013</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">symptom</td>
<td align="left">0.066</td>
<td align="left">0.013</td>
<td align="left">&lt; 0.001</td>
<td align="left">1084</td>
</tr>
<tr class="odd">
<td align="left">PA_copplan_03</td>
<td align="left">0.034</td>
<td align="left">0.011</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">PA_copplan_04</td>
<td align="left">0.033</td>
<td align="left">0.01</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="odd">
<td align="left">PA_intrinsic</td>
<td align="left">0.071</td>
<td align="left">0.009</td>
<td align="left">0.006</td>
<td align="left">1074</td>
</tr>
<tr class="even">
<td align="left">PA_actplan_04</td>
<td align="left">0.038</td>
<td align="left">0.008</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="odd">
<td align="left">PA_actCop</td>
<td align="left">0.036</td>
<td align="left">0.006</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">PA_actplan_01</td>
<td align="left">0.033</td>
<td align="left">0.006</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="odd">
<td align="left">PA_identified</td>
<td align="left">0.044</td>
<td align="left">0.006</td>
<td align="left">&lt; 0.001</td>
<td align="left">1074</td>
</tr>
<tr class="even">
<td align="left">PA_inorm</td>
<td align="left">&lt; 0.001</td>
<td align="left">0.006</td>
<td align="left">0.003</td>
<td align="left">1073</td>
</tr>
<tr class="odd">
<td align="left">PA_inorm_01</td>
<td align="left">&lt; 0.001</td>
<td align="left">0.006</td>
<td align="left">0.003</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">padaysLastweek</td>
<td align="left">0.04</td>
<td align="left">0.006</td>
<td align="left">&lt; 0.001</td>
<td align="left">1082</td>
</tr>
<tr class="odd">
<td align="left">PA_autonomous</td>
<td align="left">0.073</td>
<td align="left">0.005</td>
<td align="left">0.006</td>
<td align="left">1078</td>
</tr>
<tr class="even">
<td align="left">PA_dnorm</td>
<td align="left">0.052</td>
<td align="left">0.005</td>
<td align="left">0.004</td>
<td align="left">1073</td>
</tr>
<tr class="odd">
<td align="left">PA_controlled</td>
<td align="left">0.051</td>
<td align="left">0.004</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">pahrsLastweek</td>
<td align="left">0.036</td>
<td align="left">0.004</td>
<td align="left">&lt; 0.001</td>
<td align="left">1082</td>
</tr>
<tr class="odd">
<td align="left">paLastweek</td>
<td align="left">0.037</td>
<td align="left">0.004</td>
<td align="left">&lt; 0.001</td>
<td align="left">1082</td>
</tr>
<tr class="even">
<td align="left">PA_copingplan</td>
<td align="left">0.034</td>
<td align="left">&lt; 0.001</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="odd">
<td align="left">PA_copplan_01</td>
<td align="left">0.022</td>
<td align="left">&lt; 0.001</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">PA_copplan_02</td>
<td align="left">0.015</td>
<td align="left">&lt; 0.001</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="odd">
<td align="left">PA_dnorm_01</td>
<td align="left">0.054</td>
<td align="left">&lt; 0.001</td>
<td align="left">0.012</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">PA_integrated</td>
<td align="left">0.082</td>
<td align="left">&lt; 0.001</td>
<td align="left">0.008</td>
<td align="left">1073</td>
</tr>
<tr class="odd">
<td align="left">PA_introjected</td>
<td align="left">0.001</td>
<td align="left">&lt; 0.001</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">paminLastweek</td>
<td align="left">0.005</td>
<td align="left">&lt; 0.001</td>
<td align="left">0.011</td>
<td align="left">1082</td>
</tr>
</tbody>
</table>
</div>
<div id="model-with-school-class-and-track-top-20-items-sorted-by-educational-track" class="section level3">
<h3>Model with school, class and track: Top 20 items, sorted by educational track</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
vardatatable_containing_edutrack <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(Variable, <span class="st">`</span><span class="dt">ICC educational track</span><span class="st">`</span>, <span class="st">`</span><span class="dt">ICC class</span><span class="st">`</span>, <span class="st">`</span><span class="dt">ICC school</span><span class="st">`</span>, n) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">arrange</span>(<span class="kw">desc</span>(<span class="st">`</span><span class="dt">ICC educational track</span><span class="st">`</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">top_n</span>(<span class="dv">20</span>) <span class="op">%&gt;%</span><span class="st"> </span>papaja<span class="op">::</span><span class="kw">apa_table</span>(<span class="dt">caption =</span> <span class="st">&quot;Intra-class correlations sorted by educational track ICC&quot;</span>,
        <span class="dt">format.args =</span> <span class="kw">list</span>(<span class="dt">digits =</span> <span class="kw">c</span>(<span class="dv">0</span>), <span class="dt">margin =</span> <span class="dv">2</span>))
## Selecting by n</code></pre></div>
<caption>
(#tab:icc-school-class-track-sortbytrack)
</caption>
<caption>
<em>Intra-class correlations sorted by educational track ICC</em>
</caption>
<table>
<thead>
<tr class="header">
<th align="left">Variable</th>
<th align="left">ICC educational track</th>
<th align="left">ICC class</th>
<th align="left">ICC school</th>
<th align="left">n</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">PA_integrated</td>
<td align="left">0.082</td>
<td align="left">&lt; 0.001</td>
<td align="left">0.008</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">PA_autonomous</td>
<td align="left">0.073</td>
<td align="left">0.005</td>
<td align="left">0.006</td>
<td align="left">1078</td>
</tr>
<tr class="odd">
<td align="left">PA_intrinsic</td>
<td align="left">0.071</td>
<td align="left">0.009</td>
<td align="left">0.006</td>
<td align="left">1074</td>
</tr>
<tr class="even">
<td align="left">pafreqUsually</td>
<td align="left">0.069</td>
<td align="left">0.023</td>
<td align="left">0.005</td>
<td align="left">1082</td>
</tr>
<tr class="odd">
<td align="left">symptom</td>
<td align="left">0.066</td>
<td align="left">0.013</td>
<td align="left">&lt; 0.001</td>
<td align="left">1084</td>
</tr>
<tr class="even">
<td align="left">PA_intention</td>
<td align="left">0.064</td>
<td align="left">0.039</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="odd">
<td align="left">PA_intention_02</td>
<td align="left">0.064</td>
<td align="left">0.044</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">PA_intention_01</td>
<td align="left">0.061</td>
<td align="left">0.027</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="odd">
<td align="left">PA_dnorm_01</td>
<td align="left">0.054</td>
<td align="left">&lt; 0.001</td>
<td align="left">0.012</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">PA_dnorm</td>
<td align="left">0.052</td>
<td align="left">0.005</td>
<td align="left">0.004</td>
<td align="left">1073</td>
</tr>
<tr class="odd">
<td align="left">PA_controlled</td>
<td align="left">0.051</td>
<td align="left">0.004</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">pahrsUsually</td>
<td align="left">0.051</td>
<td align="left">0.033</td>
<td align="left">0.004</td>
<td align="left">1082</td>
</tr>
<tr class="odd">
<td align="left">PA_identified</td>
<td align="left">0.044</td>
<td align="left">0.006</td>
<td align="left">&lt; 0.001</td>
<td align="left">1074</td>
</tr>
<tr class="even">
<td align="left">padaysLastweek</td>
<td align="left">0.04</td>
<td align="left">0.006</td>
<td align="left">&lt; 0.001</td>
<td align="left">1082</td>
</tr>
<tr class="odd">
<td align="left">PA_actplan_04</td>
<td align="left">0.038</td>
<td align="left">0.008</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">paLastweek</td>
<td align="left">0.037</td>
<td align="left">0.004</td>
<td align="left">&lt; 0.001</td>
<td align="left">1082</td>
</tr>
<tr class="odd">
<td align="left">PA_actCop</td>
<td align="left">0.036</td>
<td align="left">0.006</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">pahrsLastweek</td>
<td align="left">0.036</td>
<td align="left">0.004</td>
<td align="left">&lt; 0.001</td>
<td align="left">1082</td>
</tr>
<tr class="odd">
<td align="left">PA_copingplan</td>
<td align="left">0.034</td>
<td align="left">&lt; 0.001</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">PA_copplan_03</td>
<td align="left">0.034</td>
<td align="left">0.011</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="odd">
<td align="left">PA_actplan_01</td>
<td align="left">0.033</td>
<td align="left">0.006</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">PA_copplan_04</td>
<td align="left">0.033</td>
<td align="left">0.01</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="odd">
<td align="left">PA_actionplan</td>
<td align="left">0.031</td>
<td align="left">0.013</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">PA_outcomeExpectations</td>
<td align="left">0.024</td>
<td align="left">0.029</td>
<td align="left">0.003</td>
<td align="left">1078</td>
</tr>
<tr class="odd">
<td align="left">PA_dnorm_02</td>
<td align="left">0.023</td>
<td align="left">0.013</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">PA_copplan_01</td>
<td align="left">0.022</td>
<td align="left">&lt; 0.001</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="odd">
<td align="left">PA_actplan_03</td>
<td align="left">0.02</td>
<td align="left">0.021</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">PA_actplan_02</td>
<td align="left">0.018</td>
<td align="left">0.015</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="odd">
<td align="left">PA_copplan_02</td>
<td align="left">0.015</td>
<td align="left">&lt; 0.001</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">paminLastweek</td>
<td align="left">0.005</td>
<td align="left">&lt; 0.001</td>
<td align="left">0.011</td>
<td align="left">1082</td>
</tr>
<tr class="odd">
<td align="left">PA_introjected</td>
<td align="left">0.001</td>
<td align="left">&lt; 0.001</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">PA_inorm</td>
<td align="left">&lt; 0.001</td>
<td align="left">0.006</td>
<td align="left">0.003</td>
<td align="left">1073</td>
</tr>
<tr class="odd">
<td align="left">PA_inorm_01</td>
<td align="left">&lt; 0.001</td>
<td align="left">0.006</td>
<td align="left">0.003</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">PA_opportunities</td>
<td align="left">&lt; 0.001</td>
<td align="left">0.018</td>
<td align="left">&lt; 0.001</td>
<td align="left">1075</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="model-with-educational-track-only" class="section level2 tabset">
<h2>Model with educational track only</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#library(sjstats)</span>
<span class="co">#library(lme4)</span>

names &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>id, <span class="op">-</span>intervention, <span class="op">-</span>group, <span class="op">-</span>school, <span class="op">-</span>girl, <span class="op">-</span>track, <span class="op">-</span>trackSchool, <span class="op">-</span><span class="kw">contains</span>(<span class="st">&quot;_T3&quot;</span>), <span class="op">-</span><span class="kw">contains</span>(<span class="st">&quot;_diff&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">names</span>(.)

<span class="co"># Create empty soon-to-be-filled objects</span>
m &lt;-<span class="st"> </span><span class="ot">NA</span>
mean &lt;-<span class="st"> </span><span class="ot">NA</span>
m_p &lt;-<span class="st"> </span><span class="ot">NA</span>
ci_low &lt;-<span class="st"> </span><span class="ot">NA</span>
ci_high &lt;-<span class="st"> </span><span class="ot">NA</span>
ICC_group &lt;-<span class="st"> </span><span class="ot">NA</span>
ICC_School &lt;-<span class="st"> </span><span class="ot">NA</span>
nonmissings &lt;-<span class="st"> </span><span class="ot">NA</span>
ICC_track &lt;-<span class="st"> </span><span class="ot">NA</span>


## To test the code with a single variable:
<span class="co"># dftest &lt;- df #%&gt;% na.omit()</span>
<span class="co"># m &lt;- lme4::lmer(sitLieAccelerometer_T1 ~ (1|track), data=df)</span>
<span class="co"># mean &lt;- lme4::fixef(m)</span>
<span class="co"># m_p &lt;- profile(m)</span>
<span class="co"># ci_low &lt;- confint(m_p)[3]</span>
<span class="co"># ci_high &lt;- confint(m_p)[6]</span>
<span class="co"># ICC_group &lt;- sjstats::icc(m)[1]</span>
<span class="co"># nonmissings &lt;- length(m@resp$y)</span>

<span class="co"># # UNCOMMENT below and run code</span>

<span class="co"># for (i in names){ # Loop over each variable name for all participants, extract statistics</span>
<span class="co"># m &lt;- lme4::lmer(paste0(i,&quot; ~ (1|track)&quot;), data=df)</span>
<span class="co"># mean[i] &lt;- lme4::fixef(m)</span>
<span class="co"># m_p &lt;- profile(m, which = &quot;beta_&quot;)</span>
<span class="co"># ci_low[i] &lt;- confint(m_p)[1]</span>
<span class="co"># ci_high[i] &lt;- confint(m_p)[2]</span>
<span class="co"># ICC_track[i] &lt;- sjstats::icc(m)[1]</span>
<span class="co"># nonmissings[i] &lt;- length(m@resp$y)</span>
<span class="co"># }</span>
<span class="co"># </span>
<span class="co"># vardatatable_edutrack_only &lt;- data_frame(</span>
<span class="co">#   Variable = stringr::str_sub(names(mean), end = -4), #remove &quot;_T1&quot; from names</span>
<span class="co">#   Mean = round(mean, 1),</span>
<span class="co">#   CI95 = paste(round(ci_low, 1), &quot;-&quot;, round(ci_high, 1)),</span>
<span class="co">#   &quot;ICC educational track&quot; = ifelse(round(ICC_track, 3) == 0, &quot;&lt; 0.001&quot;, round(ICC_track, 3)),</span>
<span class="co">#   n = nonmissings) %&gt;%</span>
<span class="co">#   dplyr::arrange(Variable) %&gt;%</span>
<span class="co">#   dplyr::filter(Variable != &quot;&quot;) #remove first row, which is empty</span>
<span class="co"># </span>
<span class="co"># ci_edutrack_only &lt;- data_frame(</span>
<span class="co">#   &quot;ciLo&quot; = ci_low,</span>
<span class="co">#   &quot;mean&quot; = mean,</span>
<span class="co">#   &quot;ciHi&quot; = ci_high,</span>
<span class="co">#   &quot;diamondlabels&quot; = names(mean)) %&gt;%</span>
<span class="co">#   dplyr::filter(diamondlabels != &quot;&quot;) %&gt;% #remove first row, which is empty</span>
<span class="co">#   as.data.frame()</span>
<span class="co"># </span>
<span class="co"># save(vardatatable_edutrack_only, file = &quot;vardatatable_edutrack_only.Rdata&quot;)</span>
<span class="co"># save(ci_edutrack_only, file = &quot;ci_edutrack_only.Rdata&quot;)</span>
<span class="kw">load</span>(<span class="st">&quot;vardatatable_edutrack_only.Rdata&quot;</span>)
<span class="kw">load</span>(<span class="st">&quot;ci_edutrack_only.Rdata&quot;</span>)</code></pre></div>
<div id="main-table-1" class="section level3">
<h3>Main table</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
vardatatable_edutrack_only <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>DT<span class="op">::</span><span class="kw">datatable</span>(<span class="dt">caption =</span> <span class="st">&quot;Values calculated with a multilevel model accounting for educational track only&quot;</span>)</code></pre></div>
<div id="htmlwidget-56198680b3bcf0f99ded" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-56198680b3bcf0f99ded">{"x":{"filter":"none","caption":"<caption>Values calculated with a multilevel model accounting for educational track only<\/caption>","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153","154","155","156","157","158","159","160","161","162","163","164","165","166","167","168","169","170","171"],["big5agreeableness","big5agreeableness_01","big5agrReverseCoded_02","big5conscientiousness","big5conscientiousness_01","big5consReverseCoded_02","big5extraversion","big5extraversion_01","big5extReverseCoded_02","big5neuroticism","big5neuroticism_01","big5neurReverseCoded_02","big5openness","big5openness_01","big5openReverseCoded_02","fatpct","PA_actCop","PA_actionplan","PA_actplan_01","PA_actplan_02","PA_actplan_03","PA_actplan_04","PA_agrbct","PA_agrbct_01","PA_agrbct_02","PA_agrbct_03","PA_agrbct_04","PA_agrbct_05","PA_agrbct_06","PA_agrbct_07","PA_agrbct_08","PA_agrbct_09","PA_agrbct_10","PA_amotivation","PA_amotivation_01","PA_amotivation_02","PA_amotivation_03","PA_amotivation_04","PA_autonomous","PA_autonomous_01","PA_autonomous_02","PA_autonomous_03","PA_autonomous_04","PA_autonomous_05","PA_autonomous_06","PA_autonomous_07","PA_autonomous_08","PA_autonomous_09","PA_controlled","PA_controlled_01","PA_controlled_02","PA_controlled_03","PA_controlled_04","PA_controlled_05","PA_copingplan","PA_copplan_01","PA_copplan_02","PA_copplan_03","PA_copplan_04","PA_dnorm","PA_dnorm_01","PA_dnorm_02","PA_extrinsic","PA_extrinsic_01","PA_extrinsic_02","PA_extrinsic_03","PA_frqbct","PA_frqbct_01","PA_frqbct_02","PA_frqbct_03","PA_frqbct_04","PA_frqbct_05","PA_frqbct_06","PA_frqbct_07","PA_frqbct_08","PA_frqbct_09","PA_goal","PA_goal_01","PA_identified","PA_identified_01","PA_identified_02","PA_identified_03","PA_inorm","PA_inorm_01","PA_integrated","PA_integrated_01","PA_integrated_02","PA_integrated_03","PA_intention","PA_intention_01","PA_intention_02","PA_intrinsic","PA_intrinsic_01","PA_intrinsic_02","PA_intrinsic_03","PA_introjected","PA_introjected_01","PA_introjected_02","PA_opportunities","PA_opportunities_01","PA_opportunities_02","PA_opportunities_04","PA_opportunities_05","PA_opportunities_07","PA_opportunitiesReverseCoded_03","PA_opportunitiesReverseCoded_06","PA_opportunitiesReverseCoded_08","PA_outcomeExpectations","PA_outcomeExpectations_01","PA_outcomeExpectations_03","PA_outcomeExpectations_04","PA_outcomeExpectations_05","PA_outcomeExpectations_06","PA_outcomeExpectations_07","PA_outcomeExpectations_10","PA_outcomeExpectations_11","PA_outcomeExpectations_12","PA_outcomeExpectationsNegative_02","PA_outcomeExpectationsNegative_08","PA_outcomeExpectationsNegative_09","PA_pbc","PA_pbc_01","PA_pbc_03","PA_pbcReverseCoded_02","PA_selfefficacy","PA_selfefficacy_01","PA_selfefficacyReverseCoded_02","PA_sePbc","paAccelerometer","padaysLastweek","pafreqUsually","pahrsLastweek","pahrsUsually","paLastweek","paminLastweek","SB_dnorm","SB_dnorm_01","SB_dnorm_02","SB_inorm","SB_inorm_01","SB_inorm_02","SB_intention","SB_intention_01","SB_intention_02","SB_intention_03","SB_intention_04","SB_outcomeExpectations","SB_outcomeExpectations_02","SB_outcomeExpectations_03","SB_outcomeExpectations_04","SB_outcomeExpectations_05","SB_outcomeExpectations_06","SB_outcomeExpectationsNegative_01","SB_outcomeExpectationsNegative_07","SB_sePbc","SB_sePbc_01","SB_sePbc_02","SB_sePbc_03","SB_sePbc_04","SB_sePbc_05","sitBreaks","sitLieAccelerometer","symptom","symptom_headAche","symptom_irritabilityAngerbursts","symptom_lowerBackPain","symptom_neckShoulderPain","symptom_sleepDifficulty","symptom_stomachAche","symptom_tensionNervousness","symptom_tirednessFaintness"],[5.3,5.5,5.1,5,5.4,4.6,4.5,4.9,4,3.8,4,3.5,4.9,5.3,4.4,24.8,2.6,2.7,2.6,2.8,2.8,2.7,3.1,3.6,3.2,2.5,2.6,2.7,3.2,3,3.1,3.6,3.6,1.7,1.6,1.6,1.7,1.6,3.4,3,3.7,3.3,3.2,3.2,3,3.7,3.6,3.5,1.9,1.8,1.6,1.6,2.2,2.3,2.5,2.4,2.4,2.5,2.7,4.4,4.4,4.3,1.7,1.8,1.6,1.6,2.5,3.7,1.9,2,1.9,2.5,3.4,2.2,2.4,2.8,0.6,0.6,3.4,3,3.7,3.3,4.6,4.6,3.2,3.2,3.2,3,5.3,5.2,5.3,3.6,3.7,3.6,3.5,2.2,2.2,2.3,5.1,4.7,5.5,5.5,5.3,4.6,5.1,3.6,6.6,4.6,5.4,5.1,5.4,5.1,5.3,4.9,5.3,5,5.1,3.1,2.6,2.6,5.3,5.8,5.2,4.9,5.2,5.9,4.6,5.3,178,2.8,2.5,5.5,3,345.5,1.4,3.2,3,3.4,4,3.9,4.1,3.7,3.3,3.5,4,4,4.4,4.8,4.6,4.9,4.9,4.8,3.4,3.4,5,4.4,4.3,5.7,5.7,4.7,27,591.9,2,2,1.9,1.7,1.9,2,1.8,1.9,2.3],["5.1 - 5.5","5.3 - 5.7","4.9 - 5.4","4.8 - 5.1","5.2 - 5.6","4.4 - 4.8","4.2 - 4.8","4.4 - 5.3","3.9 - 4.2","3.5 - 4","3.7 - 4.4","3.4 - 3.7","4.7 - 5.1","5 - 5.6","4.2 - 4.6","21.8 - 27.8","2.4 - 2.8","2.5 - 2.9","2.4 - 2.8","2.6 - 2.9","2.6 - 3","2.5 - 2.9","2.8 - 3.5","3.1 - 4.1","2.8 - 3.6","2.1 - 3","2.2 - 3","2.3 - 3","2.9 - 3.5","2.7 - 3.3","2.8 - 3.4","3.3 - 4","3.2 - 3.9","1.4 - 1.9","1.4 - 1.8","1.4 - 1.9","1.5 - 1.9","1.3 - 2","3.1 - 3.7","2.7 - 3.3","3.5 - 3.9","3 - 3.7","2.9 - 3.6","2.9 - 3.6","2.7 - 3.4","3.3 - 4","3.3 - 4","3.2 - 3.8","1.8 - 2","1.5 - 2.1","1.3 - 1.9","1.5 - 1.8","2.1 - 2.3","2.1 - 2.4","2.3 - 2.7","2.2 - 2.6","2.3 - 2.6","2.3 - 2.7","2.5 - 2.9","4 - 4.8","4 - 4.9","4 - 4.7","1.4 - 2","1.5 - 2.1","1.3 - 1.9","1.5 - 1.8","2.3 - 2.8","3.4 - 4","1.7 - 2.1","1.9 - 2.1","1.7 - 2.2","2.1 - 2.8","3.1 - 3.7","2.1 - 2.4","2.1 - 2.6","2.5 - 3.1","0.5 - 0.6","0.5 - 0.6","3.1 - 3.6","2.7 - 3.3","3.5 - 3.9","3 - 3.7","4.5 - 4.8","4.5 - 4.8","2.8 - 3.5","2.9 - 3.6","2.9 - 3.6","2.7 - 3.4","4.7 - 5.8","4.7 - 5.8","4.7 - 5.8","3.3 - 3.9","3.3 - 4","3.3 - 4","3.2 - 3.8","2.2 - 2.3","2.1 - 2.3","2.1 - 2.4","5 - 5.2","4.3 - 5","5.4 - 5.6","5.3 - 5.8","5.2 - 5.4","4.4 - 4.9","5 - 5.2","3.3 - 3.9","6.5 - 6.7","4.4 - 4.8","5.1 - 5.7","4.8 - 5.4","5.3 - 5.6","4.9 - 5.4","5 - 5.6","4.6 - 5.1","5.1 - 5.5","4.7 - 5.4","4.8 - 5.4","2.7 - 3.5","2.3 - 2.8","2.4 - 2.9","5.2 - 5.5","5.7 - 6","5 - 5.4","4.6 - 5.1","5.1 - 5.4","5.7 - 6","4.5 - 4.7","5.1 - 5.4","156.1 - 200.1","2.4 - 3.2","2.2 - 2.9","4.2 - 6.9","2.5 - 3.5","267.1 - 427.5","1.4 - 1.5","3 - 3.5","2.8 - 3.3","3.1 - 3.7","3.9 - 4.1","3.7 - 4.1","3.9 - 4.3","3.3 - 4.2","2.9 - 3.8","3.1 - 4","3.5 - 4.5","3.6 - 4.5","4.2 - 4.6","4.5 - 5","4.2 - 5","4.6 - 5.2","4.6 - 5.2","4.5 - 5.1","3.3 - 3.5","3.2 - 3.6","4.9 - 5.1","4.2 - 4.5","4.1 - 4.5","5.6 - 5.9","5.6 - 5.9","4.5 - 4.9","22.8 - 31.3","551.8 - 632.9","1.8 - 2.1","1.8 - 2.2","1.7 - 2.1","1.6 - 1.9","1.7 - 2.1","1.8 - 2.2","1.5 - 2","1.7 - 2.1","2.1 - 2.4"],["0.015","0.013","0.015","0.008","0.009","0.004","0.039","0.066","0.001","0.024","0.027","0.003","0.026","0.033","0.005","0.108","0.037","0.034","0.034","0.02","0.024","0.04","0.064","0.065","0.039","0.042","0.044","0.039","0.029","0.036","0.032","0.036","0.032","0.091","0.048","0.055","0.03","0.108","0.073","0.034","0.026","0.055","0.08","0.052","0.057","0.072","0.06","0.063","0.053","0.077","0.081","0.029","&lt; 0.001","0.005","0.034","0.022","0.015","0.036","0.035","0.053","0.051","0.025","0.1","0.077","0.081","0.029","0.035","0.024","0.014","0.002","0.022","0.029","0.024","0.004","0.015","0.02","0.016","0.016","0.045","0.034","0.026","0.055","&lt; 0.001","&lt; 0.001","0.079","0.08","0.052","0.057","0.085","0.075","0.087","0.075","0.072","0.06","0.063","0.002","&lt; 0.001","0.005","0.001","0.022","&lt; 0.001","0.014","&lt; 0.001","0.015","&lt; 0.001","0.018","0.002","0.033","0.032","0.027","0.006","0.024","0.041","0.015","0.01","0.038","0.029","0.055","0.018","0.019","0.008","0.005","0.007","0.007","0.005","0.002","0.001","0.009","0.162","0.042","0.075","0.036","0.061","0.037","0.003","0.026","0.015","0.03","0.005","0.014","0.009","0.076","0.05","0.064","0.065","0.057","0.02","0.018","0.042","0.02","0.019","0.034","&lt; 0.001","0.009","0.004","0.004","0.006","0.004","0.004","0.006","0.143","0.166","0.067","0.038","0.032","0.018","0.033","0.028","0.077","0.028","0.015"],[1068,1061,1064,1067,1059,1065,1068,1063,1062,1068,1064,1061,1068,1062,1066,942,1073,1073,1073,1073,1073,1073,1071,1071,1071,1071,1071,1071,1071,1071,1071,1071,1071,1072,1062,1057,1067,1066,1078,1063,1063,1070,1070,1062,1066,1070,1066,1057,1073,1068,1069,1064,1068,1066,1073,1073,1073,1073,1073,1073,1073,1073,1069,1068,1069,1064,1070,1070,1070,1070,1070,1070,1070,1070,1070,1070,1061,1061,1074,1063,1063,1070,1073,1073,1073,1070,1062,1066,1073,1073,1073,1074,1070,1066,1057,1073,1068,1066,1075,1070,1067,1070,1064,1068,1065,1059,1066,1078,1071,1064,1071,1067,1071,1062,1069,1063,1070,1066,1063,1064,1071,1069,1066,1063,1071,1071,1071,1071,706,1082,1082,1082,1082,1082,1082,1062,1059,1060,1064,1056,1053,1064,1059,1056,1054,1055,1064,1056,1058,1063,1060,1058,1063,1057,1064,1062,1061,1060,1060,1054,706,706,1084,1055,1039,1053,1047,1052,1026,1051,1058]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Variable<\/th>\n      <th>Mean<\/th>\n      <th>CI95<\/th>\n      <th>ICC educational track<\/th>\n      <th>n<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-center","targets":"_all"},{"className":"dt-right","targets":[2,5]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="model-with-educational-track-only-top-20-items-sorted-by-icc-educational-track" class="section level3">
<h3>Model with educational track only: Top 20 items, sorted by ICC educational track</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
vardatatable_edutrack_only <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(Variable, <span class="st">`</span><span class="dt">ICC educational track</span><span class="st">`</span>, n) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">arrange</span>(<span class="kw">desc</span>(<span class="st">`</span><span class="dt">ICC educational track</span><span class="st">`</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">top_n</span>(<span class="dv">20</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>papaja<span class="op">::</span><span class="kw">apa_table</span>(<span class="dt">caption =</span> <span class="st">&quot;Intra-class correlations sorted by educational track ICC&quot;</span>,
        <span class="dt">format.args =</span> <span class="kw">list</span>(<span class="dt">digits =</span> <span class="kw">c</span>(<span class="dv">0</span>), <span class="dt">margin =</span> <span class="dv">2</span>))
## Selecting by n</code></pre></div>
<caption>
(#tab:icc-edu-track-only)
</caption>
<caption>
<em>Intra-class correlations sorted by educational track ICC</em>
</caption>
<table>
<thead>
<tr class="header">
<th align="left">Variable</th>
<th align="left">ICC educational track</th>
<th align="left">n</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">PA_intention_02</td>
<td align="left">0.087</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">PA_intention</td>
<td align="left">0.085</td>
<td align="left">1073</td>
</tr>
<tr class="odd">
<td align="left">PA_integrated</td>
<td align="left">0.079</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">PA_intention_01</td>
<td align="left">0.075</td>
<td align="left">1073</td>
</tr>
<tr class="odd">
<td align="left">PA_intrinsic</td>
<td align="left">0.075</td>
<td align="left">1074</td>
</tr>
<tr class="even">
<td align="left">pafreqUsually</td>
<td align="left">0.075</td>
<td align="left">1082</td>
</tr>
<tr class="odd">
<td align="left">PA_autonomous</td>
<td align="left">0.073</td>
<td align="left">1078</td>
</tr>
<tr class="even">
<td align="left">symptom</td>
<td align="left">0.067</td>
<td align="left">1084</td>
</tr>
<tr class="odd">
<td align="left">pahrsUsually</td>
<td align="left">0.061</td>
<td align="left">1082</td>
</tr>
<tr class="even">
<td align="left">PA_controlled</td>
<td align="left">0.053</td>
<td align="left">1073</td>
</tr>
<tr class="odd">
<td align="left">PA_dnorm</td>
<td align="left">0.053</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">PA_dnorm_01</td>
<td align="left">0.051</td>
<td align="left">1073</td>
</tr>
<tr class="odd">
<td align="left">PA_identified</td>
<td align="left">0.045</td>
<td align="left">1074</td>
</tr>
<tr class="even">
<td align="left">padaysLastweek</td>
<td align="left">0.042</td>
<td align="left">1082</td>
</tr>
<tr class="odd">
<td align="left">PA_actplan_04</td>
<td align="left">0.04</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">PA_actCop</td>
<td align="left">0.037</td>
<td align="left">1073</td>
</tr>
<tr class="odd">
<td align="left">paLastweek</td>
<td align="left">0.037</td>
<td align="left">1082</td>
</tr>
<tr class="even">
<td align="left">PA_copplan_03</td>
<td align="left">0.036</td>
<td align="left">1073</td>
</tr>
<tr class="odd">
<td align="left">pahrsLastweek</td>
<td align="left">0.036</td>
<td align="left">1082</td>
</tr>
<tr class="even">
<td align="left">PA_copplan_04</td>
<td align="left">0.035</td>
<td align="left">1073</td>
</tr>
<tr class="odd">
<td align="left">PA_actionplan</td>
<td align="left">0.034</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">PA_actplan_01</td>
<td align="left">0.034</td>
<td align="left">1073</td>
</tr>
<tr class="odd">
<td align="left">PA_copingplan</td>
<td align="left">0.034</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">PA_outcomeExpectations</td>
<td align="left">0.033</td>
<td align="left">1078</td>
</tr>
<tr class="odd">
<td align="left">PA_dnorm_02</td>
<td align="left">0.025</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">PA_actplan_03</td>
<td align="left">0.024</td>
<td align="left">1073</td>
</tr>
<tr class="odd">
<td align="left">PA_copplan_01</td>
<td align="left">0.022</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">PA_actplan_02</td>
<td align="left">0.02</td>
<td align="left">1073</td>
</tr>
<tr class="odd">
<td align="left">PA_copplan_02</td>
<td align="left">0.015</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">paminLastweek</td>
<td align="left">0.003</td>
<td align="left">1082</td>
</tr>
<tr class="odd">
<td align="left">PA_introjected</td>
<td align="left">0.002</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">PA_opportunities</td>
<td align="left">0.001</td>
<td align="left">1075</td>
</tr>
<tr class="odd">
<td align="left">PA_inorm</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">PA_inorm_01</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="calculating-cis-using-the-sandwich-estimator" class="section level2">
<h2>Calculating CIs using the sandwich estimator</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Basic instructions are from https://web.archive.org/web/20180206180739/http://thestatsgeek.com/2014/02/14/the-robust-sandwich-variance-estimator-for-linear-regression-using-r/</span>

names &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>id, <span class="op">-</span>intervention, <span class="op">-</span>group, <span class="op">-</span>school, <span class="op">-</span>girl, <span class="op">-</span>track, <span class="op">-</span>trackSchool, <span class="op">-</span><span class="kw">contains</span>(<span class="st">&quot;_T3&quot;</span>), <span class="op">-</span><span class="kw">contains</span>(<span class="st">&quot;_diff&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">names</span>(.)

<span class="co"># Create empty soon-to-be-filled objects</span>
m &lt;-<span class="st"> </span><span class="ot">NA</span>
sandwich_se &lt;-<span class="st"> </span><span class="ot">NA</span>
mean &lt;-<span class="st"> </span><span class="ot">NA</span>
ci_low &lt;-<span class="st"> </span><span class="ot">NA</span>
ci_high &lt;-<span class="st"> </span><span class="ot">NA</span>
nonmissings &lt;-<span class="st"> </span><span class="ot">NA</span>

## To test the code with a single variable:
<span class="co"># df_for_sandwich &lt;- df %&gt;% dplyr::select(group, school, track, sitLieAccelerometer_T1) %&gt;% na.omit()</span>
<span class="co"># sandwich_clusters &lt;- df_for_sandwich %&gt;% dplyr::select(group, school, track)</span>
<span class="co"># m &lt;- lm(sitLieAccelerometer_T1 ~ 1, data=df_for_sandwich)</span>
<span class="co"># sandwich_se &lt;- diag(sandwich::vcovCL(m, type = &quot;HC1&quot;, cluster = sandwich_clusters))^0.5</span>
<span class="co"># mean &lt;- m$coefficients[[1]]</span>
<span class="co"># ci_low &lt;- coef(m) - 1.96 * sandwich_se</span>
<span class="co"># ci_high &lt;- coef(m) + 1.96 * sandwich_se</span>
<span class="co"># nonmissings &lt;- nrow(m$model)</span>


<span class="co"># # UNCOMMENT below and run code</span>

<span class="co"># for (i in names){ # Loop over each variable name for all participants, extract statistics</span>
<span class="co"># df_for_sandwich &lt;- df %&gt;% dplyr::select(</span>
<span class="co">#   group, school, track, i) %&gt;%</span>
<span class="co">#   na.omit()</span>
<span class="co"># sandwich_clusters &lt;- df_for_sandwich %&gt;% dplyr::select(group, school, track)</span>
<span class="co"># m &lt;- lm(paste0(i,&quot; ~ 1&quot;), data = df_for_sandwich)</span>
<span class="co"># sandwich_se &lt;- diag(sandwich::vcovCL(m, type = &quot;HC1&quot;, cluster = sandwich_clusters))^0.5</span>
<span class="co"># mean[i] &lt;- m$coefficients[[1]]</span>
<span class="co"># ci_low[i] &lt;- coef(m) - 1.96 * sandwich_se</span>
<span class="co"># ci_high[i] &lt;- coef(m) + 1.96 * sandwich_se</span>
<span class="co"># nonmissings[i] &lt;- nrow(m$model)</span>
<span class="co"># }</span>
<span class="co">#</span>
<span class="co"># vardatatable_sandwich &lt;- data_frame(</span>
<span class="co">#   Variable = stringr::str_sub(names(mean), end = -4), #remove &quot;_T1&quot; from names</span>
<span class="co">#   Mean = round(mean, 1),</span>
<span class="co">#   CI95 = paste(round(ci_low, 1), &quot;-&quot;, round(ci_high, 1)),</span>
<span class="co">#   n = nonmissings) %&gt;%</span>
<span class="co">#   dplyr::arrange(Variable) %&gt;%</span>
<span class="co">#   dplyr::filter(Variable != &quot;&quot;) #remove first row, which is empty</span>
<span class="co">#</span>
<span class="co"># ci_sandwich &lt;- data_frame(</span>
<span class="co">#   &quot;ciLo&quot; = ci_low,</span>
<span class="co">#   &quot;mean&quot; = mean,</span>
<span class="co">#   &quot;ciHi&quot; = ci_high,</span>
<span class="co">#   &quot;diamondlabels&quot; = names(mean)) %&gt;%</span>
<span class="co">#   dplyr::filter(diamondlabels != &quot;&quot;) %&gt;% #remove first row, which is empty</span>
<span class="co">#   as.data.frame()</span>
<span class="co">#</span>
<span class="co"># save(vardatatable_sandwich, file = &quot;vardatatable_sandwich.Rdata&quot;)</span>
<span class="co"># save(ci_sandwich, file = &quot;ci_sandwich.Rdata&quot;)</span>

<span class="kw">load</span>(<span class="st">&quot;vardatatable_sandwich.Rdata&quot;</span>)
<span class="kw">load</span>(<span class="st">&quot;ci_sandwich.Rdata&quot;</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
vardatatable_sandwich <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>DT<span class="op">::</span><span class="kw">datatable</span>(<span class="dt">caption =</span> <span class="st">&quot;Values calculated with a sandwich estimator accounting for school, class and educational track&quot;</span>)</code></pre></div>
<div id="htmlwidget-e90e883bb9fae4c7889e" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-e90e883bb9fae4c7889e">{"x":{"filter":"none","caption":"<caption>Values calculated with a sandwich estimator accounting for school, class and educational track<\/caption>","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153","154","155","156","157","158","159","160","161","162","163","164","165","166","167","168","169","170","171"],["big5agreeableness","big5agreeableness_01","big5agrReverseCoded_02","big5conscientiousness","big5conscientiousness_01","big5consReverseCoded_02","big5extraversion","big5extraversion_01","big5extReverseCoded_02","big5neuroticism","big5neuroticism_01","big5neurReverseCoded_02","big5openness","big5openness_01","big5openReverseCoded_02","fatpct","PA_actCop","PA_actionplan","PA_actplan_01","PA_actplan_02","PA_actplan_03","PA_actplan_04","PA_agrbct","PA_agrbct_01","PA_agrbct_02","PA_agrbct_03","PA_agrbct_04","PA_agrbct_05","PA_agrbct_06","PA_agrbct_07","PA_agrbct_08","PA_agrbct_09","PA_agrbct_10","PA_amotivation","PA_amotivation_01","PA_amotivation_02","PA_amotivation_03","PA_amotivation_04","PA_autonomous","PA_autonomous_01","PA_autonomous_02","PA_autonomous_03","PA_autonomous_04","PA_autonomous_05","PA_autonomous_06","PA_autonomous_07","PA_autonomous_08","PA_autonomous_09","PA_controlled","PA_controlled_01","PA_controlled_02","PA_controlled_03","PA_controlled_04","PA_controlled_05","PA_copingplan","PA_copplan_01","PA_copplan_02","PA_copplan_03","PA_copplan_04","PA_dnorm","PA_dnorm_01","PA_dnorm_02","PA_extrinsic","PA_extrinsic_01","PA_extrinsic_02","PA_extrinsic_03","PA_frqbct","PA_frqbct_01","PA_frqbct_02","PA_frqbct_03","PA_frqbct_04","PA_frqbct_05","PA_frqbct_06","PA_frqbct_07","PA_frqbct_08","PA_frqbct_09","PA_goal","PA_goal_01","PA_identified","PA_identified_01","PA_identified_02","PA_identified_03","PA_inorm","PA_inorm_01","PA_integrated","PA_integrated_01","PA_integrated_02","PA_integrated_03","PA_intention","PA_intention_01","PA_intention_02","PA_intrinsic","PA_intrinsic_01","PA_intrinsic_02","PA_intrinsic_03","PA_introjected","PA_introjected_01","PA_introjected_02","PA_opportunities","PA_opportunities_01","PA_opportunities_02","PA_opportunities_04","PA_opportunities_05","PA_opportunities_07","PA_opportunitiesReverseCoded_03","PA_opportunitiesReverseCoded_06","PA_opportunitiesReverseCoded_08","PA_outcomeExpectations","PA_outcomeExpectations_01","PA_outcomeExpectations_03","PA_outcomeExpectations_04","PA_outcomeExpectations_05","PA_outcomeExpectations_06","PA_outcomeExpectations_07","PA_outcomeExpectations_10","PA_outcomeExpectations_11","PA_outcomeExpectations_12","PA_outcomeExpectationsNegative_02","PA_outcomeExpectationsNegative_08","PA_outcomeExpectationsNegative_09","PA_pbc","PA_pbc_01","PA_pbc_03","PA_pbcReverseCoded_02","PA_selfefficacy","PA_selfefficacy_01","PA_selfefficacyReverseCoded_02","PA_sePbc","paAccelerometer","padaysLastweek","pafreqUsually","pahrsLastweek","pahrsUsually","paLastweek","paminLastweek","SB_dnorm","SB_dnorm_01","SB_dnorm_02","SB_inorm","SB_inorm_01","SB_inorm_02","SB_intention","SB_intention_01","SB_intention_02","SB_intention_03","SB_intention_04","SB_outcomeExpectations","SB_outcomeExpectations_02","SB_outcomeExpectations_03","SB_outcomeExpectations_04","SB_outcomeExpectations_05","SB_outcomeExpectations_06","SB_outcomeExpectationsNegative_01","SB_outcomeExpectationsNegative_07","SB_sePbc","SB_sePbc_01","SB_sePbc_02","SB_sePbc_03","SB_sePbc_04","SB_sePbc_05","sitBreaks","sitLieAccelerometer","symptom","symptom_headAche","symptom_irritabilityAngerbursts","symptom_lowerBackPain","symptom_neckShoulderPain","symptom_sleepDifficulty","symptom_stomachAche","symptom_tensionNervousness","symptom_tirednessFaintness"],[5.3,5.5,5.2,5,5.4,4.6,4.5,4.9,4,3.8,4.1,3.5,4.8,5.3,4.4,25.3,2.6,2.8,2.6,2.8,2.9,2.8,3.1,3.7,3.2,2.4,2.5,2.6,3.2,3,3.1,3.7,3.6,1.5,1.5,1.5,1.6,1.5,3.4,3.1,3.8,3.4,3.3,3.3,3.1,3.7,3.6,3.5,1.8,1.7,1.5,1.5,2.2,2.3,2.5,2.4,2.4,2.5,2.7,4.4,4.5,4.3,1.6,1.7,1.5,1.5,2.5,3.7,1.9,2,1.9,2.5,3.4,2.2,2.4,2.8,0.6,0.6,3.4,3.1,3.8,3.4,4.6,4.6,3.2,3.3,3.3,3.1,5.4,5.4,5.4,3.6,3.7,3.6,3.5,2.2,2.2,2.3,5.1,4.6,5.5,5.5,5.3,4.6,5.1,3.7,6.6,4.6,5.4,5.2,5.5,5.2,5.4,4.9,5.3,5.1,5.2,2.9,2.5,2.6,5.3,5.9,5.2,4.9,5.2,5.9,4.6,5.3,183.7,2.8,2.6,5.5,3.1,340.8,1.4,3.2,3.1,3.4,4,3.9,4.1,3.7,3.3,3.5,4,4.1,4.4,4.8,4.6,4.9,4.9,4.9,3.4,3.3,4.9,4.3,4.3,5.7,5.7,4.7,28.2,577.8,2,2,1.9,1.8,1.9,2.1,1.7,1.9,2.3],["5.1 - 5.5","5.3 - 5.7","4.9 - 5.4","4.9 - 5.1","5.2 - 5.6","4.5 - 4.8","4.3 - 4.7","4.6 - 5.2","3.9 - 4.2","3.6 - 4","3.8 - 4.4","3.4 - 3.7","4.7 - 5","5.1 - 5.5","4.2 - 4.6","21.5 - 29.1","2.5 - 2.7","2.7 - 2.9","2.5 - 2.7","2.7 - 2.9","2.8 - 2.9","2.7 - 2.9","2.9 - 3.3","3.3 - 4","2.9 - 3.4","2.2 - 2.7","2.3 - 2.7","2.4 - 2.9","3 - 3.4","2.8 - 3.2","2.9 - 3.3","3.4 - 3.9","3.4 - 3.8","1.4 - 1.7","1.4 - 1.6","1.4 - 1.7","1.5 - 1.7","1.4 - 1.6","3.2 - 3.6","2.9 - 3.3","3.6 - 3.9","3.2 - 3.6","3.1 - 3.5","3.1 - 3.5","2.9 - 3.3","3.5 - 3.9","3.5 - 3.8","3.3 - 3.7","1.8 - 1.9","1.6 - 1.7","1.4 - 1.6","1.5 - 1.6","2.1 - 2.3","2.2 - 2.4","2.4 - 2.6","2.3 - 2.5","2.4 - 2.5","2.3 - 2.6","2.6 - 2.8","4.1 - 4.7","4.2 - 4.8","4 - 4.6","1.5 - 1.6","1.6 - 1.7","1.4 - 1.6","1.5 - 1.6","2.4 - 2.7","3.6 - 3.9","1.7 - 2","2 - 2.1","1.8 - 2","2.3 - 2.7","3.2 - 3.6","2.1 - 2.3","2.3 - 2.5","2.6 - 3","0.5 - 0.6","0.5 - 0.6","3.2 - 3.6","2.9 - 3.3","3.6 - 3.9","3.2 - 3.6","4.5 - 4.8","4.5 - 4.8","3 - 3.4","3.1 - 3.5","3.1 - 3.5","2.9 - 3.3","5 - 5.7","5 - 5.7","5.1 - 5.7","3.4 - 3.8","3.5 - 3.9","3.5 - 3.8","3.3 - 3.7","2.2 - 2.3","2.1 - 2.3","2.2 - 2.4","5.1 - 5.2","4.2 - 5","5.4 - 5.6","5.4 - 5.7","NaN - NaN","4.5 - 4.8","5 - 5.2","3.4 - 3.9","6.5 - 6.7","4.5 - 4.7","5.2 - 5.7","4.9 - 5.5","5.3 - 5.6","4.9 - 5.4","5.1 - 5.7","4.7 - 5.1","5.1 - 5.5","4.8 - 5.4","4.9 - 5.4","2.7 - 3.1","2.3 - 2.7","2.4 - 2.7","5.2 - 5.5","5.7 - 6","5 - 5.4","4.8 - 5.1","5.1 - 5.3","5.7 - 6","4.4 - 4.7","5.1 - 5.4","161 - 206.4","2.5 - 3.1","2.3 - 2.8","4.3 - 6.6","2.7 - 3.4","270.4 - 411.1","1.4 - 1.5","3 - 3.4","2.9 - 3.2","3.2 - 3.6","3.9 - 4.1","3.7 - 4.1","4 - 4.2","3.3 - 4.1","3 - 3.6","3.1 - 3.8","3.6 - 4.4","3.7 - 4.5","4.3 - 4.6","4.6 - 5.1","4.3 - 4.9","4.7 - 5.2","4.7 - 5.1","4.6 - 5.1","3.4 - 3.4","3.2 - 3.5","4.8 - 5.1","4.2 - 4.5","4.1 - 4.4","5.6 - 5.9","5.6 - 5.9","4.4 - 4.9","23.7 - 32.6","539.3 - 616.4","1.8 - 2.1","1.8 - 2.2","1.8 - 2","1.6 - 1.9","1.7 - 2.2","1.9 - 2.3","1.6 - 1.9","1.7 - 2.1","2.1 - 2.4"],[1068,1061,1064,1067,1059,1065,1068,1063,1062,1068,1064,1061,1068,1062,1066,942,1073,1073,1073,1073,1073,1073,1071,1071,1071,1071,1071,1071,1071,1071,1071,1071,1071,1072,1062,1057,1067,1066,1078,1063,1063,1070,1070,1062,1066,1070,1066,1057,1073,1068,1069,1064,1068,1066,1073,1073,1073,1073,1073,1073,1073,1073,1069,1068,1069,1064,1070,1070,1070,1070,1070,1070,1070,1070,1070,1070,1061,1061,1074,1063,1063,1070,1073,1073,1073,1070,1062,1066,1073,1073,1073,1074,1070,1066,1057,1073,1068,1066,1075,1070,1067,1070,1064,1068,1065,1059,1066,1078,1071,1064,1071,1067,1071,1062,1069,1063,1070,1066,1063,1064,1071,1069,1066,1063,1071,1071,1071,1071,706,1082,1082,1082,1082,1082,1082,1062,1059,1060,1064,1056,1053,1064,1059,1056,1054,1055,1064,1056,1058,1063,1060,1058,1063,1057,1064,1062,1061,1060,1060,1054,706,706,1084,1055,1039,1053,1047,1052,1026,1051,1058]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Variable<\/th>\n      <th>Mean<\/th>\n      <th>CI95<\/th>\n      <th>n<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-center","targets":"_all"},{"className":"dt-right","targets":[2,4]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="calculating-observed-means-and-cis-without-clustering" class="section level2">
<h2>Calculating observed means and CIs, without clustering</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
df_for_uncorrected &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>id, <span class="op">-</span>intervention, <span class="op">-</span>group, <span class="op">-</span>school, <span class="op">-</span>girl, <span class="op">-</span>track, <span class="op">-</span>trackSchool, <span class="op">-</span><span class="kw">contains</span>(<span class="st">&quot;_T3&quot;</span>), <span class="op">-</span><span class="kw">contains</span>(<span class="st">&quot;_diff&quot;</span>))

<span class="co"># Create empty soon-to-be-filled objects</span>
mean_uncorrected &lt;-<span class="st"> </span><span class="ot">NA</span>
ci_low &lt;-<span class="st"> </span><span class="ot">NA</span>
ci_high &lt;-<span class="st"> </span><span class="ot">NA</span>
nonmissings &lt;-<span class="st"> </span><span class="ot">NA</span>

ci_uncorrected &lt;-<span class="st"> </span><span class="kw">rbind</span>(
  df_for_uncorrected <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">summarise_all</span>(<span class="kw">funs</span>(<span class="kw">t.test</span>(.)<span class="op">$</span>conf.int[<span class="dv">1</span>])),
  df_for_uncorrected <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">summarise_all</span>(<span class="kw">funs</span>(<span class="kw">mean</span>(., <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))),
  df_for_uncorrected <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">summarise_all</span>(<span class="kw">funs</span>(<span class="kw">t.test</span>(.)<span class="op">$</span>conf.int[<span class="dv">2</span>]))) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">t</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>data.frame

<span class="kw">names</span>(ci_uncorrected) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;ciLo&quot;</span>, <span class="st">&quot;mean&quot;</span>, <span class="st">&quot;ciHi&quot;</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
ci_uncorrected <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">Variable =</span> <span class="kw">labels</span>(ci_uncorrected)[[<span class="dv">1</span>]]) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate_at</span>(<span class="kw">vars</span>(<span class="op">-</span>Variable), <span class="kw">funs</span>(<span class="kw">round</span>(., <span class="dt">digits =</span> <span class="dv">3</span>))) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(Variable, <span class="kw">everything</span>()) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>DT<span class="op">::</span><span class="kw">datatable</span>(<span class="dt">caption =</span> <span class="st">&quot;Values calculated without accounting for clustering&quot;</span>)</code></pre></div>
<div id="htmlwidget-4fd1c9bd685bb3ff97e6" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-4fd1c9bd685bb3ff97e6">{"x":{"filter":"none","caption":"<caption>Values calculated without accounting for clustering<\/caption>","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153","154","155","156","157","158","159","160","161","162","163","164","165","166","167","168","169","170","171"],["big5agreeableness_01_T1","big5agrReverseCoded_02_T1","big5conscientiousness_01_T1","big5consReverseCoded_02_T1","big5extraversion_01_T1","big5extReverseCoded_02_T1","big5neuroticism_01_T1","big5neurReverseCoded_02_T1","big5openness_01_T1","big5openReverseCoded_02_T1","fatpct_T1","PA_actplan_01_T1","PA_actplan_02_T1","PA_actplan_03_T1","PA_actplan_04_T1","PA_agrbct_01_T1","PA_agrbct_02_T1","PA_agrbct_03_T1","PA_agrbct_04_T1","PA_agrbct_05_T1","PA_agrbct_06_T1","PA_agrbct_07_T1","PA_agrbct_08_T1","PA_agrbct_09_T1","PA_agrbct_10_T1","PA_amotivation_01_T1","PA_amotivation_02_T1","PA_amotivation_03_T1","PA_amotivation_04_T1","PA_copplan_01_T1","PA_copplan_02_T1","PA_copplan_03_T1","PA_copplan_04_T1","PA_dnorm_02_T1","PA_dnorm_01_T1","PA_controlled_01_T1","PA_controlled_02_T1","PA_controlled_03_T1","PA_frqbct_01_T1","PA_frqbct_02_T1","PA_frqbct_03_T1","PA_frqbct_04_T1","PA_frqbct_05_T1","PA_frqbct_06_T1","PA_frqbct_07_T1","PA_frqbct_08_T1","PA_frqbct_09_T1","PA_goal_01_T1","PA_autonomous_01_T1","PA_autonomous_02_T1","PA_autonomous_03_T1","PA_inorm_01_T1","PA_autonomous_04_T1","PA_autonomous_05_T1","PA_autonomous_06_T1","PA_intention_01_T1","PA_intention_02_T1","PA_autonomous_07_T1","PA_autonomous_08_T1","PA_autonomous_09_T1","PA_controlled_04_T1","PA_controlled_05_T1","PA_outcomeExpectations_01_T1","PA_outcomeExpectations_03_T1","PA_outcomeExpectations_04_T1","PA_outcomeExpectations_05_T1","PA_outcomeExpectations_06_T1","PA_outcomeExpectations_07_T1","PA_outcomeExpectations_10_T1","PA_outcomeExpectations_11_T1","PA_outcomeExpectations_12_T1","PA_outcomeExpectationsNegative_02_T1","PA_outcomeExpectationsNegative_08_T1","PA_outcomeExpectationsNegative_09_T1","PA_opportunities_01_T1","PA_opportunities_02_T1","PA_opportunities_04_T1","PA_opportunities_05_T1","PA_opportunities_07_T1","PA_opportunitiesReverseCoded_03_T1","PA_opportunitiesReverseCoded_06_T1","PA_opportunitiesReverseCoded_08_T1","PA_pbc_01_T1","PA_pbc_03_T1","PA_pbcReverseCoded_02_T1","PA_selfefficacy_01_T1","PA_selfefficacyReverseCoded_02_T1","paAccelerometer_T1","padaysLastweek_T1","pafreqUsually_T1","pahrsLastweek_T1","pahrsUsually_T1","paminLastweek_T1","SB_dnorm_01_T1","SB_dnorm_02_T1","SB_inorm_01_T1","SB_inorm_02_T1","SB_intention_01_T1","SB_intention_02_T1","SB_intention_03_T1","SB_intention_04_T1","SB_outcomeExpectationsNegative_01_T1","SB_outcomeExpectations_02_T1","SB_outcomeExpectations_03_T1","SB_outcomeExpectations_04_T1","SB_outcomeExpectations_05_T1","SB_outcomeExpectations_06_T1","SB_outcomeExpectationsNegative_07_T1","SB_sePbc_01_T1","SB_sePbc_02_T1","SB_sePbc_03_T1","SB_sePbc_04_T1","SB_sePbc_05_T1","sitLieAccelerometer_T1","symptom_neckShoulderPain_T1","symptom_lowerBackPain_T1","symptom_stomachAche_T1","symptom_tensionNervousness_T1","symptom_irritabilityAngerbursts_T1","symptom_sleepDifficulty_T1","symptom_headAche_T1","symptom_tirednessFaintness_T1","sitBreaks_T1","paLastweek_T1","big5agreeableness_T1","big5conscientiousness_T1","big5extraversion_T1","big5neuroticism_T1","big5openness_T1","PA_agrbct_T1","PA_amotivation_T1","PA_autonomous_T1","PA_controlled_T1","PA_dnorm_T1","PA_frqbct_T1","PA_goal_T1","PA_inorm_T1","PA_intention_T1","PA_outcomeExpectations_T1","PA_opportunities_T1","PA_pbc_T1","PA_selfefficacy_T1","SB_dnorm_T1","SB_inorm_T1","SB_intention_T1","SB_outcomeExpectations_T1","SB_sePbc_T1","symptom_T1","PA_actionplan_T1","PA_copingplan_T1","PA_sePbc_T1","PA_actCop_T1","PA_extrinsic_01_T1","PA_extrinsic_02_T1","PA_extrinsic_03_T1","PA_introjected_01_T1","PA_introjected_02_T1","PA_identified_01_T1","PA_identified_02_T1","PA_identified_03_T1","PA_integrated_01_T1","PA_integrated_02_T1","PA_integrated_03_T1","PA_intrinsic_01_T1","PA_intrinsic_02_T1","PA_intrinsic_03_T1","PA_intrinsic_T1","PA_integrated_T1","PA_identified_T1","PA_introjected_T1","PA_extrinsic_T1"],[5.426,5.064,5.315,4.524,4.822,3.914,3.97,3.432,5.216,4.273,24.706,2.537,2.743,2.793,2.719,3.556,3.074,2.331,2.409,2.524,3.112,2.928,2.996,3.554,3.508,1.455,1.471,1.54,1.415,2.349,2.37,2.405,2.635,4.184,4.375,1.597,1.42,1.49,3.636,1.783,1.939,1.812,2.387,3.301,2.1,2.291,2.677,0.528,3.038,3.68,3.289,4.527,3.218,3.184,3.007,5.238,5.294,3.647,3.558,3.419,2.091,2.225,5.349,5.082,5.359,5.071,5.284,4.801,5.241,5.008,5.059,2.775,2.438,2.474,4.518,5.397,5.442,5.21,4.521,4.998,3.559,6.507,5.774,5.077,4.82,5.761,4.474,179.806,2.686,2.47,5.066,2.976,1.419,2.971,3.302,3.816,4,3.196,3.356,3.888,3.952,3.292,4.72,4.523,4.814,4.805,4.754,3.24,4.232,4.167,5.649,5.646,4.549,571.068,1.882,1.7,1.676,1.845,1.84,2.015,1.921,2.21,27.344,317.357,5.426,5.315,4.822,3.97,5.216,3.025,1.487,3.347,1.787,4.3,2.465,0.528,4.527,5.269,4.535,5.064,5.251,5.142,3.147,3.929,3.61,4.345,4.874,1.915,2.703,2.446,5.21,2.578,1.597,1.42,1.49,2.091,2.225,3.038,3.68,3.289,3.218,3.184,3.007,3.647,3.558,3.419,3.544,3.147,3.344,2.165,1.511],[5.51,5.167,5.401,4.633,4.927,4.028,4.086,3.528,5.31,4.377,25.274,2.598,2.805,2.853,2.778,3.67,3.185,2.441,2.514,2.624,3.219,3.029,3.097,3.658,3.614,1.512,1.53,1.603,1.473,2.407,2.43,2.463,2.693,4.304,4.486,1.658,1.474,1.548,3.732,1.871,2.034,1.898,2.488,3.406,2.196,2.391,2.786,0.558,3.118,3.755,3.367,4.648,3.295,3.262,3.089,5.355,5.404,3.721,3.631,3.496,2.172,2.308,5.444,5.189,5.452,5.164,5.374,4.897,5.34,5.109,5.162,2.874,2.534,2.57,4.641,5.496,5.54,5.32,4.628,5.112,3.675,6.578,5.862,5.181,4.94,5.852,4.589,183.764,2.799,2.552,5.455,3.088,1.449,3.065,3.397,3.91,4.093,3.304,3.456,4.005,4.064,3.397,4.815,4.624,4.92,4.907,4.854,3.346,4.335,4.271,5.741,5.738,4.655,578.212,1.944,1.755,1.723,1.903,1.898,2.081,1.978,2.273,28.158,340.758,5.51,5.401,4.927,4.086,5.31,3.105,1.536,3.41,1.836,4.395,2.533,0.558,4.648,5.38,4.59,5.12,5.328,5.22,3.234,4.004,3.707,4.408,4.95,1.954,2.759,2.498,5.274,2.628,1.658,1.474,1.548,2.172,2.308,3.118,3.755,3.367,3.295,3.262,3.089,3.721,3.631,3.496,3.612,3.218,3.41,2.24,1.561],[5.593,5.271,5.487,4.742,5.031,4.142,4.203,3.623,5.404,4.481,25.842,2.659,2.867,2.912,2.838,3.785,3.296,2.551,2.62,2.723,3.327,3.13,3.199,3.762,3.721,1.57,1.589,1.665,1.53,2.466,2.489,2.521,2.752,4.424,4.598,1.72,1.529,1.606,3.828,1.959,2.128,1.984,2.589,3.51,2.293,2.49,2.895,0.588,3.198,3.83,3.445,4.769,3.373,3.34,3.172,5.473,5.515,3.794,3.705,3.572,2.253,2.39,5.538,5.296,5.545,5.257,5.465,4.994,5.438,5.21,5.265,2.974,2.631,2.665,4.764,5.594,5.638,5.431,4.736,5.225,3.791,6.649,5.949,5.285,5.06,5.942,4.705,187.723,2.913,2.633,5.843,3.2,1.479,3.159,3.492,4.004,4.186,3.413,3.557,4.122,4.175,3.502,4.91,4.724,5.026,5.008,4.955,3.453,4.439,4.375,5.833,5.829,4.76,585.355,2.005,1.81,1.77,1.961,1.956,2.147,2.035,2.336,28.973,364.159,5.593,5.487,5.031,4.203,5.404,3.185,1.585,3.473,1.885,4.49,2.602,0.588,4.769,5.49,4.644,5.176,5.404,5.299,3.321,4.079,3.804,4.471,5.025,1.994,2.814,2.55,5.338,2.679,1.72,1.529,1.606,2.253,2.39,3.198,3.83,3.445,3.373,3.34,3.172,3.794,3.705,3.572,3.68,3.288,3.476,2.316,1.611]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Variable<\/th>\n      <th>ciLo<\/th>\n      <th>mean<\/th>\n      <th>ciHi<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-center","targets":"_all"},{"className":"dt-right","targets":[2,3,4]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div id="compare-mean--and-ci-estimates-visually" class="section level1">
<h1>Compare mean- and CI-estimates visually</h1>
<p>This section contains diamond plots comparing different estimates for means and CIs.</p>
<div id="high-mean-variables" class="section level2">
<h2>High-mean variables</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ci_total_big &lt;-<span class="st"> </span>ci_total <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(mean <span class="op">&gt;</span><span class="st"> </span><span class="dv">10</span>)
ci_edutrack_big &lt;-<span class="st"> </span>ci_edutrack <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(mean <span class="op">&gt;</span><span class="st"> </span><span class="dv">10</span>)
ci_uncorrected_big &lt;-<span class="st"> </span>ci_uncorrected <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(mean <span class="op">&gt;</span><span class="st"> </span><span class="dv">10</span>)
ci_sandwich_big &lt;-<span class="st"> </span>ci_sandwich <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(mean <span class="op">&gt;</span><span class="st"> </span><span class="dv">10</span>)


<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>){
plot1 &lt;-<span class="st"> </span>userfriendlyscience<span class="op">::</span><span class="kw">diamondPlot</span>(ci_total_big[i, ], 
                                          <span class="dt">color =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>)[<span class="dv">1</span>], 
                                          <span class="dt">alpha=</span>.<span class="dv">15</span>, 
                                          <span class="dt">yLabels =</span> ci_total_big[i, ]<span class="op">$</span>diamondlabels, 
                                          <span class="dt">fixedSize =</span> <span class="fl">0.3</span>, 
                                          <span class="dt">xlab =</span> <span class="ot">NULL</span>) <span class="op">+</span>
<span class="st">  </span>userfriendlyscience<span class="op">::</span><span class="kw">diamondPlot</span>(ci_edutrack_big[i, ], 
                                   <span class="dt">returnLayerOnly =</span> <span class="ot">TRUE</span>,
                                   <span class="dt">color =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>)[<span class="dv">2</span>], 
                                   <span class="dt">alpha=</span>.<span class="dv">15</span>, 
                                   <span class="dt">yLabels =</span> ci_edutrack_big[i, ]<span class="op">$</span>diamondlabels, 
                                   <span class="dt">fixedSize =</span> <span class="fl">0.5</span>, 
                                   <span class="dt">xlab =</span> <span class="ot">NULL</span>) <span class="op">+</span>
<span class="st">  </span>userfriendlyscience<span class="op">::</span><span class="kw">diamondPlot</span>(ci_uncorrected_big[i, ], 
                                   <span class="dt">returnLayerOnly =</span> <span class="ot">TRUE</span>,
                                   <span class="dt">color =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>)[<span class="dv">3</span>], 
                                   <span class="dt">alpha=</span>.<span class="dv">15</span>, 
                                   <span class="dt">yLabels =</span> ci_uncorrected_big[i, ]<span class="op">$</span>diamondlabels, 
                                   <span class="dt">fixedSize =</span> <span class="fl">0.3</span>, 
                                   <span class="dt">xlab =</span> <span class="ot">NULL</span>) <span class="op">+</span>
<span class="st">  </span>userfriendlyscience<span class="op">::</span><span class="kw">diamondPlot</span>(ci_sandwich_big[i, ], 
                                   <span class="dt">returnLayerOnly =</span> <span class="ot">TRUE</span>,
                                   <span class="dt">color =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>)[<span class="dv">4</span>], 
                                   <span class="dt">alpha=</span>.<span class="dv">15</span>, 
                                   <span class="dt">yLabels =</span> ci_uncorrected_big[i, ]<span class="op">$</span>diamondlabels, 
                                   <span class="dt">fixedSize =</span> <span class="fl">0.3</span>, 
                                   <span class="dt">xlab =</span> <span class="ot">NULL</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_rect</span>(<span class="kw">aes</span>(<span class="dt">xmin=</span><span class="ot">Inf</span>, <span class="dt">xmax=</span><span class="ot">Inf</span>, <span class="dt">ymin=</span><span class="ot">Inf</span>, <span class="dt">ymax=</span><span class="ot">Inf</span>, <span class="dt">fill =</span> <span class="st">&quot;Classroom &amp; school&quot;</span>), 
            <span class="dt">colour=</span><span class="ot">NA</span>, <span class="dt">alpha=</span><span class="fl">0.05</span>) <span class="op">+</span><span class="st"> </span><span class="co"># Create invisible rectangle for legend</span>
<span class="st">  </span><span class="kw">geom_rect</span>(<span class="kw">aes</span>(<span class="dt">xmin=</span><span class="ot">Inf</span>, <span class="dt">xmax=</span><span class="ot">Inf</span>, <span class="dt">ymin=</span><span class="ot">Inf</span>, <span class="dt">ymax=</span><span class="ot">Inf</span>, <span class="dt">fill =</span> <span class="st">&quot;Classroom, school &amp; track&quot;</span>), 
            <span class="dt">colour=</span><span class="ot">NA</span>, <span class="dt">alpha=</span><span class="fl">0.05</span>) <span class="op">+</span><span class="st"> </span><span class="co"># Create invisible rectangle for legend</span>
<span class="st">  </span><span class="kw">geom_rect</span>(<span class="kw">aes</span>(<span class="dt">xmin=</span><span class="ot">Inf</span>, <span class="dt">xmax=</span><span class="ot">Inf</span>, <span class="dt">ymin=</span><span class="ot">Inf</span>, <span class="dt">ymax=</span><span class="ot">Inf</span>, <span class="dt">fill =</span> <span class="st">&quot;Uncorrected&quot;</span>), 
            <span class="dt">colour=</span><span class="ot">NA</span>, <span class="dt">alpha=</span><span class="fl">0.05</span>) <span class="op">+</span><span class="st"> </span><span class="co"># Create invisible rectangle for legend</span>
<span class="st">  </span><span class="kw">geom_rect</span>(<span class="kw">aes</span>(<span class="dt">xmin=</span><span class="ot">Inf</span>, <span class="dt">xmax=</span><span class="ot">Inf</span>, <span class="dt">ymin=</span><span class="ot">Inf</span>, <span class="dt">ymax=</span><span class="ot">Inf</span>, <span class="dt">fill =</span> <span class="st">&quot;Sandwich&quot;</span>), 
            <span class="dt">colour=</span><span class="ot">NA</span>, <span class="dt">alpha=</span><span class="fl">0.05</span>) <span class="op">+</span><span class="st"> </span><span class="co"># Create invisible rectangle for legend</span>
<span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="st">&#39;Model&#39;</span>,
                    <span class="dt">values =</span> <span class="kw">c</span>(viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>)[<span class="dv">1</span>], 
                               viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>)[<span class="dv">2</span>], 
                               viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>)[<span class="dv">4</span>], 
                               viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>)[<span class="dv">3</span>]),
                    <span class="dt">guide =</span> <span class="kw">guide_legend</span>(<span class="dt">override.aes =</span> <span class="kw">list</span>(<span class="dt">alpha =</span> <span class="dv">1</span>), <span class="dt">ncol =</span> <span class="dv">2</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">&quot;right&quot;</span>) 
  <span class="kw">plot</span>(plot1)
}</code></pre></div>
<p><img src="baseline-supplement_files/figure-html/parameter-comparison-highmean-plots-1.png" width="2100" /><img src="baseline-supplement_files/figure-html/parameter-comparison-highmean-plots-2.png" width="2100" /><img src="baseline-supplement_files/figure-html/parameter-comparison-highmean-plots-3.png" width="2100" /><img src="baseline-supplement_files/figure-html/parameter-comparison-highmean-plots-4.png" width="2100" /></p>
</div>
<div id="other-variables" class="section level2">
<h2>Other variables</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Take the high-mean variables out, because otherwise you&#39;d have something with a mean of 200 </span>
<span class="co"># and a mean of 2 in the same plot, and scaling of the x-axis would smudge differences between the</span>
<span class="co"># diamonds, which indicate the estimates</span>

ci_total_small &lt;-<span class="st"> </span>ci_total <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(mean <span class="op">&lt;=</span><span class="st"> </span><span class="dv">10</span>)
ci_edutrack_small &lt;-<span class="st"> </span>ci_edutrack <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(mean <span class="op">&lt;=</span><span class="st"> </span><span class="dv">10</span>)
ci_uncorrected_small &lt;-<span class="st"> </span>ci_uncorrected <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(mean <span class="op">&lt;=</span><span class="st"> </span><span class="dv">10</span>)
ci_sandwich_small &lt;-<span class="st"> </span>ci_sandwich <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(mean <span class="op">&lt;=</span><span class="st"> </span><span class="dv">10</span>)

<span class="co"># Now, four data frames contain columns ciLo, mean, ciHi, and variable name, for each variable (i.e. row).</span>
<span class="co"># Make a diamondPlot layer from each of these data frames, so that i number of variables are in the same plot: </span>

<span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">c</span>(<span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">1</span>, <span class="dt">to =</span> <span class="dv">171</span>, <span class="dt">by =</span> <span class="dv">8</span>))) {
plot1 &lt;-<span class="st"> </span>userfriendlyscience<span class="op">::</span><span class="kw">diamondPlot</span>(ci_total_small[i<span class="op">:</span>(i <span class="op">+</span><span class="st"> </span><span class="dv">8</span>), ], 
                                          <span class="dt">color =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>)[<span class="dv">1</span>], 
                                          <span class="dt">alpha=</span>.<span class="dv">15</span>, 
                                          <span class="dt">yLabels =</span> ci_total_small[i<span class="op">:</span>(i <span class="op">+</span><span class="st"> </span><span class="dv">8</span>), ]<span class="op">$</span>diamondlabels, 
                                          <span class="dt">fixedSize =</span> <span class="fl">0.3</span>, 
                                          <span class="dt">xlab =</span> <span class="ot">NULL</span>) <span class="op">+</span>
<span class="st">  </span>userfriendlyscience<span class="op">::</span><span class="kw">diamondPlot</span>(ci_edutrack_small[i<span class="op">:</span>(i <span class="op">+</span><span class="st"> </span><span class="dv">8</span>), ], 
                                   <span class="dt">returnLayerOnly =</span> <span class="ot">TRUE</span>,
                                   <span class="dt">color =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>)[<span class="dv">2</span>], 
                                   <span class="dt">alpha=</span>.<span class="dv">15</span>, 
                                   <span class="dt">yLabels =</span> ci_edutrack_small[i<span class="op">:</span>(i <span class="op">+</span><span class="st"> </span><span class="dv">8</span>), ]<span class="op">$</span>diamondlabels, 
                                   <span class="dt">fixedSize =</span> <span class="fl">0.5</span>, 
                                   <span class="dt">xlab =</span> <span class="ot">NULL</span>) <span class="op">+</span>
<span class="st">  </span>userfriendlyscience<span class="op">::</span><span class="kw">diamondPlot</span>(ci_uncorrected_small[i<span class="op">:</span>(i <span class="op">+</span><span class="st"> </span><span class="dv">8</span>), ], 
                                   <span class="dt">returnLayerOnly =</span> <span class="ot">TRUE</span>,
                                   <span class="dt">color =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>)[<span class="dv">3</span>], 
                                   <span class="dt">alpha=</span>.<span class="dv">15</span>, 
                                   <span class="dt">yLabels =</span> ci_uncorrected_small[i<span class="op">:</span>(i <span class="op">+</span><span class="st"> </span><span class="dv">8</span>), ]<span class="op">$</span>diamondlabels, 
                                   <span class="dt">fixedSize =</span> <span class="fl">0.3</span>, 
                                   <span class="dt">xlab =</span> <span class="ot">NULL</span>) <span class="op">+</span>
<span class="st">  </span>userfriendlyscience<span class="op">::</span><span class="kw">diamondPlot</span>(ci_sandwich_small[i<span class="op">:</span>(i <span class="op">+</span><span class="st"> </span><span class="dv">8</span>), ], 
                                   <span class="dt">returnLayerOnly =</span> <span class="ot">TRUE</span>,
                                   <span class="dt">color =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>)[<span class="dv">4</span>], 
                                   <span class="dt">alpha=</span>.<span class="dv">15</span>, 
                                   <span class="dt">yLabels =</span> ci_uncorrected_small[i<span class="op">:</span>(i <span class="op">+</span><span class="st"> </span><span class="dv">8</span>), ]<span class="op">$</span>diamondlabels, 
                                   <span class="dt">fixedSize =</span> <span class="fl">0.3</span>, 
                                   <span class="dt">xlab =</span> <span class="ot">NULL</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_rect</span>(<span class="kw">aes</span>(<span class="dt">xmin=</span><span class="ot">Inf</span>, <span class="dt">xmax=</span><span class="ot">Inf</span>, <span class="dt">ymin=</span><span class="ot">Inf</span>, <span class="dt">ymax=</span><span class="ot">Inf</span>, <span class="dt">fill =</span> <span class="st">&quot;Classroom &amp; school&quot;</span>), 
            <span class="dt">colour=</span><span class="ot">NA</span>, <span class="dt">alpha=</span><span class="fl">0.05</span>) <span class="op">+</span><span class="st"> </span><span class="co"># Create invisible rectangle for legend</span>
<span class="st">  </span><span class="kw">geom_rect</span>(<span class="kw">aes</span>(<span class="dt">xmin=</span><span class="ot">Inf</span>, <span class="dt">xmax=</span><span class="ot">Inf</span>, <span class="dt">ymin=</span><span class="ot">Inf</span>, <span class="dt">ymax=</span><span class="ot">Inf</span>, <span class="dt">fill =</span> <span class="st">&quot;Classroom, school &amp; track&quot;</span>), 
            <span class="dt">colour=</span><span class="ot">NA</span>, <span class="dt">alpha=</span><span class="fl">0.05</span>) <span class="op">+</span><span class="st"> </span><span class="co"># Create invisible rectangle for legend</span>
<span class="st">  </span><span class="kw">geom_rect</span>(<span class="kw">aes</span>(<span class="dt">xmin=</span><span class="ot">Inf</span>, <span class="dt">xmax=</span><span class="ot">Inf</span>, <span class="dt">ymin=</span><span class="ot">Inf</span>, <span class="dt">ymax=</span><span class="ot">Inf</span>, <span class="dt">fill =</span> <span class="st">&quot;Uncorrected&quot;</span>), 
            <span class="dt">colour=</span><span class="ot">NA</span>, <span class="dt">alpha=</span><span class="fl">0.05</span>) <span class="op">+</span><span class="st"> </span><span class="co"># Create invisible rectangle for legend</span>
<span class="st">  </span><span class="kw">geom_rect</span>(<span class="kw">aes</span>(<span class="dt">xmin=</span><span class="ot">Inf</span>, <span class="dt">xmax=</span><span class="ot">Inf</span>, <span class="dt">ymin=</span><span class="ot">Inf</span>, <span class="dt">ymax=</span><span class="ot">Inf</span>, <span class="dt">fill =</span> <span class="st">&quot;Sandwich&quot;</span>), 
            <span class="dt">colour=</span><span class="ot">NA</span>, <span class="dt">alpha=</span><span class="fl">0.05</span>) <span class="op">+</span><span class="st"> </span><span class="co"># Create invisible rectangle for legend</span>
<span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="st">&#39;Model: &#39;</span>,
                    <span class="dt">values =</span> <span class="kw">c</span>(viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>)[<span class="dv">1</span>], 
                               viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>)[<span class="dv">2</span>], 
                               viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>)[<span class="dv">4</span>], 
                               viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>)[<span class="dv">3</span>]),
                    <span class="dt">guide =</span> <span class="kw">guide_legend</span>(<span class="dt">override.aes =</span> <span class="kw">list</span>(<span class="dt">alpha =</span> <span class="dv">1</span>), <span class="dt">ncol =</span> <span class="dv">2</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">&quot;bottom&quot;</span>) 
<span class="co">#  cat(&#39;\n\n####&#39;, i, &#39;\n\n  &#39;) </span>
  <span class="kw">print</span>(plot1)
}</code></pre></div>
<p><img src="baseline-supplement_files/figure-html/estimates%20for%20other%20variables-1.png" width="2100" /><img src="baseline-supplement_files/figure-html/estimates%20for%20other%20variables-2.png" width="2100" /><img src="baseline-supplement_files/figure-html/estimates%20for%20other%20variables-3.png" width="2100" /><img src="baseline-supplement_files/figure-html/estimates%20for%20other%20variables-4.png" width="2100" /><img src="baseline-supplement_files/figure-html/estimates%20for%20other%20variables-5.png" width="2100" /><img src="baseline-supplement_files/figure-html/estimates%20for%20other%20variables-6.png" width="2100" /><img src="baseline-supplement_files/figure-html/estimates%20for%20other%20variables-7.png" width="2100" /><img src="baseline-supplement_files/figure-html/estimates%20for%20other%20variables-8.png" width="2100" /><img src="baseline-supplement_files/figure-html/estimates%20for%20other%20variables-9.png" width="2100" /><img src="baseline-supplement_files/figure-html/estimates%20for%20other%20variables-10.png" width="2100" /><img src="baseline-supplement_files/figure-html/estimates%20for%20other%20variables-11.png" width="2100" /><img src="baseline-supplement_files/figure-html/estimates%20for%20other%20variables-12.png" width="2100" /><img src="baseline-supplement_files/figure-html/estimates%20for%20other%20variables-13.png" width="2100" /><img src="baseline-supplement_files/figure-html/estimates%20for%20other%20variables-14.png" width="2100" /><img src="baseline-supplement_files/figure-html/estimates%20for%20other%20variables-15.png" width="2100" /><img src="baseline-supplement_files/figure-html/estimates%20for%20other%20variables-16.png" width="2100" /><img src="baseline-supplement_files/figure-html/estimates%20for%20other%20variables-17.png" width="2100" /><img src="baseline-supplement_files/figure-html/estimates%20for%20other%20variables-18.png" width="2100" /><img src="baseline-supplement_files/figure-html/estimates%20for%20other%20variables-19.png" width="2100" /><img src="baseline-supplement_files/figure-html/estimates%20for%20other%20variables-20.png" width="2100" /><img src="baseline-supplement_files/figure-html/estimates%20for%20other%20variables-21.png" width="2100" /><img src="baseline-supplement_files/figure-html/estimates%20for%20other%20variables-22.png" width="2100" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">

CI_widths &lt;-<span class="st"> </span><span class="kw">data.frame</span>(
  <span class="st">&quot;Label&quot;</span> =<span class="st"> </span>ci_total<span class="op">$</span>diamondlabels,
  <span class="st">&quot;Classroom &amp; school&quot;</span> =<span class="st"> </span>(ci_total<span class="op">$</span>ciHi <span class="op">-</span><span class="st"> </span>ci_total<span class="op">$</span>ciLo), 
  <span class="st">&quot;Classroom, school &amp; track&quot;</span> =<span class="st"> </span>(ci_edutrack<span class="op">$</span>ciHi <span class="op">-</span><span class="st"> </span>ci_edutrack<span class="op">$</span>ciLo), 
  <span class="st">&quot;Uncorrected&quot;</span> =<span class="st"> </span>(ci_uncorrected<span class="op">$</span>ciHi <span class="op">-</span><span class="st"> </span>ci_uncorrected<span class="op">$</span>ciLo),
  <span class="st">&quot;Sandwich&quot;</span> =<span class="st"> </span>(ci_sandwich<span class="op">$</span>ciHi <span class="op">-</span><span class="st"> </span>ci_sandwich<span class="op">$</span>ciLo)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">arrange</span>(Sandwich)

CI_widths <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">Label =</span> <span class="kw">as.numeric</span>(<span class="kw">as.factor</span>(ci_total<span class="op">$</span>diamondlabels)))  <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>tidyr<span class="op">::</span><span class="kw">gather</span>(estimator, value, <span class="dv">2</span><span class="op">:</span>Sandwich) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>ggplot2<span class="op">::</span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Label, <span class="dt">y =</span> value, <span class="dt">group =</span> estimator)) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">color =</span> estimator)) <span class="op">+</span>
<span class="st">    </span><span class="kw">ggtitle</span>(<span class="st">&quot;All variables&quot;</span>)</code></pre></div>
<p><img src="baseline-supplement_files/figure-html/ci-widths-1.png" width="2100" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
CI_widths <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">Label =</span> <span class="kw">paste</span>(ci_total<span class="op">$</span>diamondlabels,
                              <span class="kw">as.numeric</span>(<span class="kw">as.factor</span>(ci_total<span class="op">$</span>diamondlabels))))  <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>tidyr<span class="op">::</span><span class="kw">gather</span>(estimator, value, <span class="dv">2</span><span class="op">:</span>Sandwich) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>ggplot2<span class="op">::</span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Label, <span class="dt">y =</span> value, <span class="dt">group =</span> estimator)) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">color =</span> estimator)) <span class="op">+</span>
<span class="st">    </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">75</span>, <span class="dv">100</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">100</span>)) <span class="op">+</span>
<span class="st">    </span><span class="kw">theme</span>(<span class="dt">axis.text.x=</span><span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">45</span>, <span class="dt">hjust =</span> <span class="dv">1</span>)) <span class="op">+</span>
<span class="st">    </span><span class="kw">ggtitle</span>(<span class="st">&quot;Zoomed into bumps&quot;</span>)</code></pre></div>
<p><img src="baseline-supplement_files/figure-html/ci-widths-2.png" width="2100" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
CI_widths <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">Label =</span> (ci_total<span class="op">$</span>diamondlabels))  <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>tidyr<span class="op">::</span><span class="kw">gather</span>(estimator, value, <span class="dv">2</span><span class="op">:</span>Sandwich) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>ggplot2<span class="op">::</span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Label, <span class="dt">y =</span> value, <span class="dt">group =</span> estimator)) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">color =</span> estimator)) <span class="op">+</span>
<span class="st">    </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">81</span>, <span class="dv">83</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">100</span>)) <span class="op">+</span>
<span class="st">    </span><span class="kw">theme</span>(<span class="dt">axis.text.x=</span><span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">45</span>, <span class="dt">hjust =</span> <span class="dv">1</span>)) <span class="op">+</span>
<span class="st">    </span><span class="kw">ggtitle</span>(<span class="st">&quot;Zoomed into first bump&quot;</span>)</code></pre></div>
<p><img src="baseline-supplement_files/figure-html/ci-widths-3.png" width="2100" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
CI_widths <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">Label =</span> (ci_total<span class="op">$</span>diamondlabels))  <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>tidyr<span class="op">::</span><span class="kw">gather</span>(estimator, value, <span class="dv">2</span><span class="op">:</span>Sandwich) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>ggplot2<span class="op">::</span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Label, <span class="dt">y =</span> value, <span class="dt">group =</span> estimator)) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">color =</span> estimator)) <span class="op">+</span>
<span class="st">    </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">87</span>, <span class="dv">89</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">100</span>)) <span class="op">+</span>
<span class="st">    </span><span class="kw">theme</span>(<span class="dt">axis.text.x=</span><span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">45</span>, <span class="dt">hjust =</span> <span class="dv">1</span>)) <span class="op">+</span>
<span class="st">    </span><span class="kw">ggtitle</span>(<span class="st">&quot;Zoomed into second bump&quot;</span>)</code></pre></div>
<p><img src="baseline-supplement_files/figure-html/ci-widths-4.png" width="2100" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
CI_widths <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">Label =</span> (ci_total<span class="op">$</span>diamondlabels))  <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>tidyr<span class="op">::</span><span class="kw">gather</span>(estimator, value, <span class="dv">2</span><span class="op">:</span>Sandwich) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>ggplot2<span class="op">::</span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Label, <span class="dt">y =</span> value, <span class="dt">group =</span> estimator)) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">color =</span> estimator)) <span class="op">+</span>
<span class="st">    </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">92</span>, <span class="dv">96</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">100</span>)) <span class="op">+</span>
<span class="st">    </span><span class="kw">theme</span>(<span class="dt">axis.text.x=</span><span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">45</span>, <span class="dt">hjust =</span> <span class="dv">1</span>)) <span class="op">+</span>
<span class="st">    </span><span class="kw">ggtitle</span>(<span class="st">&quot;Zoomed into third bump&quot;</span>)</code></pre></div>
<p><img src="baseline-supplement_files/figure-html/ci-widths-5.png" width="2100" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
CI_widths <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">Label =</span> (ci_total<span class="op">$</span>diamondlabels))  <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>tidyr<span class="op">::</span><span class="kw">gather</span>(estimator, value, <span class="dv">2</span><span class="op">:</span>Sandwich) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>ggplot2<span class="op">::</span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Label, <span class="dt">y =</span> value, <span class="dt">group =</span> estimator)) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">color =</span> estimator)) <span class="op">+</span>
<span class="st">    </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">97</span>, <span class="dv">99</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">100</span>)) <span class="op">+</span>
<span class="st">    </span><span class="kw">theme</span>(<span class="dt">axis.text.x=</span><span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">45</span>, <span class="dt">hjust =</span> <span class="dv">1</span>)) <span class="op">+</span>
<span class="st">    </span><span class="kw">ggtitle</span>(<span class="st">&quot;Zoomed into fourth bump&quot;</span>)</code></pre></div>
<p><img src="baseline-supplement_files/figure-html/ci-widths-6.png" width="2100" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># # test to see all labels are in the right order</span>
<span class="co"># data.frame(</span>
<span class="co">#   Label = ci_total$diamondlabels,</span>
<span class="co">#   label2 = ci_edutrack$diamondlabels,</span>
<span class="co">#   label3 = ci_uncorrected$diamondlabels,</span>
<span class="co">#   label4 = ci_sandwich) %&gt;% rowwise %&gt;% </span>
<span class="co">#   dplyr::mutate(test1 = ifelse(Label == label2, &quot;OK&quot;,</span>
<span class="co">#                         ifelse(label2 == label3, &quot;OK&quot;, </span>
<span class="co">#                                ifelse(label3 == label4, &quot;OK&quot;, &quot;DISCREPANCY&quot;))))</span></code></pre></div>
<p>Create confidence bounds for all items by gender and intervention allocation</p>
<p>These numbers are visualised with diamond plots later.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># names &lt;- df %&gt;% dplyr::select(-id, -intervention, -group, -school, -girl, -track, -trackSchool, -contains(&quot;_T3&quot;), -contains(&quot;_diff&quot;)) %&gt;% names(.)</span>
<span class="co"># </span>
<span class="co"># # Intercepts for boys; when boy is 1, girl is 0, but boy is a factor, so intercept is for boys even though boy is 1 for boys and 0 for girls.</span>
<span class="co"># m.boys &lt;- NA</span>
<span class="co"># mean.boys &lt;- NA</span>
<span class="co"># m_p.boys &lt;- NA</span>
<span class="co"># ci_low.boys &lt;- NA</span>
<span class="co"># ci_high.boys &lt;- NA</span>
<span class="co"># ICC_group.boys &lt;- NA</span>
<span class="co"># ICC_School.boys &lt;- NA</span>
<span class="co"># nonmissings.boys &lt;- NA</span>
<span class="co"># </span>
<span class="co"># df.boys &lt;- df %&gt;% dplyr::mutate(boy = factor(ifelse(girl == &quot;girl&quot;, 0, 1), levels = c(1, 0)))</span>
<span class="co"># </span>
<span class="co"># for (i in names){</span>
<span class="co"># m.boys &lt;- lme4::lmer(paste0(i,&quot; ~ (1|school) + (1|group) + boy&quot;), data=df.boys)</span>
<span class="co"># mean.boys[i] &lt;- lme4::fixef(m.boys)[1]</span>
<span class="co"># m_p.boys &lt;- profile(m.boys, which = &quot;beta_&quot;)</span>
<span class="co"># ci_low.boys[i] &lt;- confint(m_p.boys)[1, 1]</span>
<span class="co"># ci_high.boys[i] &lt;- confint(m_p.boys)[1, 2]</span>
<span class="co"># ICC_group.boys[i] &lt;- sjstats::icc(m.boys)[1]</span>
<span class="co"># ICC_School.boys[i] &lt;- sjstats::icc(m.boys)[2]</span>
<span class="co"># nonmissings.boys[i] &lt;- length(m.boys@resp$y)</span>
<span class="co"># }</span>
<span class="co"># </span>
<span class="co"># cat(&quot;The labels are arranged such that intercept is not for girls:&quot;, labels(lme4::fixef(m.boys))[2] == &quot;boy0&quot;)</span>
<span class="co"># </span>
<span class="co"># ci_boys &lt;- data.frame(ciLo = ci_low.boys, mean = mean.boys, ciHi = ci_high.boys)</span>
<span class="co"># diamondlabels &lt;- labels(ci_boys)[[1]]</span>
<span class="co"># ci_boys &lt;- data.frame(ci_boys, diamondlabels)</span>
<span class="co"># </span>
<span class="co"># # Intercepts for girls; when boy is 1, girl is 0, but boy is a factor, so intercept is for girls even though girl is 1 for girls and 0 for boys.</span>
<span class="co"># m.girls &lt;- NA</span>
<span class="co"># mean.girls &lt;- NA</span>
<span class="co"># m_p.girls &lt;- NA</span>
<span class="co"># ci_low.girls &lt;- NA</span>
<span class="co"># ci_high.girls &lt;- NA</span>
<span class="co"># ICC_group.girls &lt;- NA</span>
<span class="co"># ICC_School.girls &lt;- NA</span>
<span class="co"># nonmissings.girls &lt;- NA</span>
<span class="co"># </span>
<span class="co"># for (i in names){</span>
<span class="co"># m.girls &lt;- lme4::lmer(paste0(i,&quot; ~ (1|school) + (1|group) + girl&quot;), data=df)</span>
<span class="co"># mean.girls[i] &lt;- lme4::fixef(m.girls)[1]</span>
<span class="co"># m_p.girls &lt;- profile(m.girls, which = &quot;beta_&quot;)</span>
<span class="co"># ci_low.girls[i] &lt;- confint(m_p.girls)[1, 1]</span>
<span class="co"># ci_high.girls[i] &lt;- confint(m_p.girls)[1, 2]</span>
<span class="co"># ICC_group.girls[i] &lt;- sjstats::icc(m.girls)[1]</span>
<span class="co"># ICC_School.girls[i] &lt;- sjstats::icc(m.girls)[2]</span>
<span class="co"># nonmissings.girls[i] &lt;- length(m.girls@resp$y)</span>
<span class="co"># }</span>
<span class="co"># </span>
<span class="co"># cat(&quot;The labels are arranged such that intercept is not for boys:&quot;, labels(lme4::fixef(m.girls))[2] == &quot;girl0&quot;)</span>
<span class="co"># </span>
<span class="co"># ci_girls &lt;- data.frame(ciLo = ci_low.girls, mean = mean.girls, ciHi = ci_high.girls)</span>
<span class="co"># diamondlabels &lt;- labels(ci_girls)[[1]]</span>
<span class="co"># ci_girls &lt;- data.frame(ci_girls, diamondlabels)</span>
<span class="co"># </span>
<span class="co"># </span>
<span class="co"># # Intercepts for intervention</span>
<span class="co"># m.intervention &lt;- NA</span>
<span class="co"># mean.intervention &lt;- NA</span>
<span class="co"># m_p.intervention &lt;- NA</span>
<span class="co"># ci_low.intervention &lt;- NA</span>
<span class="co"># ci_high.intervention &lt;- NA</span>
<span class="co"># ICC_group.intervention &lt;- NA</span>
<span class="co"># ICC_School.intervention &lt;- NA</span>
<span class="co"># nonmissings.intervention &lt;- NA</span>
<span class="co"># </span>
<span class="co"># ## change &quot;intervention&quot; to be consistent regarding level order with &quot;girl&quot;.</span>
<span class="co"># df.intervention &lt;- df %&gt;% dplyr::mutate(intervention = factor(intervention, levels = c(1, 0)))</span>
<span class="co"># </span>
<span class="co"># for (i in names){</span>
<span class="co"># m.intervention &lt;- lme4::lmer(paste0(i,&quot; ~ (1|school) + (1|group) + intervention&quot;), data=df.intervention)</span>
<span class="co"># mean.intervention[i] &lt;- lme4::fixef(m.intervention)[1]</span>
<span class="co"># m_p.intervention &lt;- profile(m.intervention, which = &quot;beta_&quot;)</span>
<span class="co"># ci_low.intervention[i] &lt;- confint(m_p.intervention)[1, 1]</span>
<span class="co"># ci_high.intervention[i] &lt;- confint(m_p.intervention)[1, 2]</span>
<span class="co"># ICC_group.intervention[i] &lt;- sjstats::icc(m.intervention)[1]</span>
<span class="co"># ICC_School.intervention[i] &lt;- sjstats::icc(m.intervention)[2]</span>
<span class="co"># nonmissings.intervention[i] &lt;- length(m.intervention@resp$y)</span>
<span class="co"># }</span>
<span class="co"># </span>
<span class="co"># cat(&quot;The labels are arranged such that intercept is not for control:&quot;, labels(lme4::fixef(m.intervention))[2] == &quot;intervention0&quot;)</span>
<span class="co"># </span>
<span class="co"># ci_intervention &lt;- data.frame(ciLo = ci_low.intervention, mean = mean.intervention, ciHi = ci_high.intervention)</span>
<span class="co"># diamondlabels &lt;- labels(ci_intervention)[[1]]</span>
<span class="co"># ci_intervention &lt;- data.frame(ci_intervention, diamondlabels)</span>
<span class="co"># </span>
<span class="co"># # Intercepts for control</span>
<span class="co"># </span>
<span class="co"># m.control &lt;- NA</span>
<span class="co"># mean.control &lt;- NA</span>
<span class="co"># m_p.control &lt;- NA</span>
<span class="co"># ci_low.control &lt;- NA</span>
<span class="co"># ci_high.control &lt;- NA</span>
<span class="co"># ICC_group.control &lt;- NA</span>
<span class="co"># ICC_School.control &lt;- NA</span>
<span class="co"># nonmissings.control &lt;- NA</span>
<span class="co"># </span>
<span class="co"># df.control &lt;- df %&gt;% dplyr::mutate(control = factor(ifelse(intervention == 1, 0, 1), levels = c(1, 0)))</span>
<span class="co"># </span>
<span class="co"># for (i in names){</span>
<span class="co"># m.control &lt;- lme4::lmer(paste0(i,&quot; ~ (1|school) + (1|group) + control&quot;), data=df.control)</span>
<span class="co"># mean.control[i] &lt;- lme4::fixef(m.control)[1]</span>
<span class="co"># m_p.control &lt;- profile(m.control, which = &quot;beta_&quot;)</span>
<span class="co"># ci_low.control[i] &lt;- confint(m_p.control)[1, 1]</span>
<span class="co"># ci_high.control[i] &lt;- confint(m_p.control)[1, 2]</span>
<span class="co"># ICC_group.control[i] &lt;- sjstats::icc(m.control)[1]</span>
<span class="co"># ICC_School.control[i] &lt;- sjstats::icc(m.control)[2]</span>
<span class="co"># nonmissings.control[i] &lt;- length(m.control@resp$y)</span>
<span class="co"># }</span>
<span class="co"># </span>
<span class="co"># cat(&quot;The labels are arranged such that intercept is not for intervention:&quot;, labels(lme4::fixef(m.control))[2] == &quot;control0&quot;)</span>
<span class="co"># </span>
<span class="co"># ci_control &lt;- data.frame(ciLo = ci_low.control, mean = mean.control, ciHi = ci_high.control)</span>
<span class="co"># diamondlabels &lt;- labels(ci_control)[[1]]</span>
<span class="co"># ci_control &lt;- data.frame(ci_control, diamondlabels)</span>
<span class="co"># </span>
<span class="co"># # # Same ICC results you&#39;d get with e.g.:</span>
<span class="co"># # m1 &lt;- as.data.frame(VarCorr(m))</span>
<span class="co"># # m1$vcov[1] / (m1$vcov[1] + m1$vcov[3])</span>
<span class="co"># </span>
<span class="co"># # Or from broom:</span>
<span class="co"># # tidy(m)$estimate[2]^2 / (tidy(m)$estimate[2]^2 + tidy(m)$estimate[4]^2)</span>
<span class="co"># </span>
<span class="co"># # Or from sjstats:</span>
<span class="co"># # sum(get_re_var(m)) / (sum(get_re_var(m)) + get_re_var(m, &quot;sigma_2&quot;))</span>
<span class="co"># </span>
<span class="co"># save(ci_control, file = &quot;ci_control.Rdata&quot;)</span>
<span class="co"># save(ci_intervention, file = &quot;ci_intervention.Rdata&quot;)</span>
<span class="co"># save(ci_girls, file = &quot;ci_girls.Rdata&quot;)</span>
<span class="co"># save(ci_boys, file = &quot;ci_boys.Rdata&quot;)</span>

<span class="kw">load</span>(<span class="st">&quot;ci_control.Rdata&quot;</span>)
<span class="kw">load</span>(<span class="st">&quot;ci_intervention.Rdata&quot;</span>)
<span class="kw">load</span>(<span class="st">&quot;ci_girls.Rdata&quot;</span>)
<span class="kw">load</span>(<span class="st">&quot;ci_boys.Rdata&quot;</span>)</code></pre></div>
<!-- ### Gender and intervention group CIs with sandwich estimator -->
<!-- NOT INCLUDED, because the line beginning with "sandwich_se <- diag(..." gives a negative sandwich variance estimate, which can't be square-rooted -->
</div>
</div>
<div id="descriptive-tables" class="section level1">
<h1>Descriptive tables</h1>
<p>Next code chunk prepares data.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
demographics &lt;-<span class="st"> </span>lmi <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="dt">id =</span> ID,
  <span class="dt">birthYear =</span> Kys0004.<span class="dv">1</span>,
  <span class="dt">surveyDate =</span> StartDateTime.<span class="dv">1</span>,
  <span class="dt">intervention =</span> ryhma,
  <span class="dt">school =</span> Aineisto.<span class="dv">1</span>,
  <span class="dt">girl =</span> Kys0013.<span class="dv">1</span>,
  <span class="dt">ethnicity =</span> Kys0005.<span class="dv">1</span>,
  <span class="dt">studyYear =</span> Kys0014.<span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(
    <span class="dt">surveyYear =</span> lubridate<span class="op">::</span><span class="kw">year</span>(surveyDate),
    <span class="dt">age =</span> <span class="kw">as.numeric</span>(surveyYear) <span class="op">-</span><span class="st"> </span><span class="kw">as.numeric</span>(birthYear),
    <span class="dt">intervention =</span> <span class="kw">ifelse</span>(intervention <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>),
    <span class="dt">intervention =</span> <span class="kw">as.numeric</span>(intervention, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;0&quot;</span>, <span class="st">&quot;1&quot;</span>)),
    <span class="dt">girl =</span> <span class="kw">ifelse</span>(girl <span class="op">==</span><span class="st"> &quot;2&quot;</span>, <span class="dv">1</span>, <span class="dv">0</span>),
    <span class="dt">girl =</span> <span class="kw">as.numeric</span>(girl, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;1&quot;</span>, <span class="st">&quot;0&quot;</span>)),
    <span class="dt">school =</span> <span class="kw">factor</span>(school, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;1&quot;</span>, <span class="st">&quot;2&quot;</span>, <span class="st">&quot;3&quot;</span>, <span class="st">&quot;4&quot;</span>, <span class="st">&quot;5&quot;</span>)),
    <span class="dt">bornInFinland =</span> <span class="kw">as.numeric</span>(<span class="kw">ifelse</span>(ethnicity <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>)),
    <span class="dt">studyYear =</span> <span class="kw">ifelse</span>(<span class="kw">as.numeric</span>(studyYear) <span class="op">==</span><span class="st"> </span><span class="dv">0</span>, <span class="ot">NA</span>, <span class="kw">as.numeric</span>(studyYear))) <span class="op">%&gt;%</span><span class="st">  </span><span class="co"># Remove &quot;other&quot; from study year</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>surveyDate, <span class="op">-</span>surveyYear)

<span class="co"># Insert track variable with those who answered &quot;other&quot; with one of the actual category labels given the appropriate category:</span>
Track &lt;-<span class="st"> </span>lmi <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(Kys0016.<span class="dv">1</span>, Kys0017.<span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(
  <span class="dt">Kys0016.1 =</span> <span class="kw">as.character</span>(Kys0016.<span class="dv">1</span>), <span class="co"># Because I had an Evaluation error: `x` and `labels` must be same type.</span>
  <span class="dt">Kys0017.1 =</span> <span class="kw">as.character</span>(Kys0017.<span class="dv">1</span>),
  <span class="dt">Kys0016.1 =</span> <span class="kw">ifelse</span>(Kys0017.<span class="dv">1</span> <span class="op">==</span><span class="st"> &quot;Merkonomi&quot;</span> <span class="op">|</span><span class="st"> </span>Kys0017.<span class="dv">1</span> <span class="op">==</span><span class="st"> &quot;merkonomi&quot;</span>, <span class="dv">3</span>,
                     <span class="kw">ifelse</span>(Kys0017.<span class="dv">1</span> <span class="op">==</span><span class="st"> &quot;Datanomi&quot;</span> <span class="op">|</span><span class="st"> </span>Kys0017.<span class="dv">1</span> <span class="op">==</span><span class="st"> &quot;datanomi&quot;</span>, <span class="dv">2</span>, Kys0016.<span class="dv">1</span>)),
  <span class="dt">Track =</span> <span class="kw">factor</span>(Kys0016.<span class="dv">1</span>, <span class="co"># Fix track labels first</span>
                 <span class="dt">levels =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>),
                 <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Other&quot;</span>, <span class="st">&quot;IT&quot;</span>, <span class="st">&quot;BA&quot;</span>, <span class="st">&quot;HRC&quot;</span>, <span class="st">&quot;Nur&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>Kys0016.<span class="dv">1</span>, <span class="op">-</span>Kys0017.<span class="dv">1</span>)

demographics &lt;-<span class="st"> </span><span class="kw">bind_cols</span>(demographics, Track)</code></pre></div>
<div id="create-demographic-tables" class="section level2">
<h2>Create demographic tables</h2>
<div id="by-educational-track" class="section level3">
<h3>By educational track</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">demotable &lt;-<span class="st"> </span>demographics <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">!=</span><span class="st"> &quot;Other&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">group_by</span>(Track) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">summarise</span>(<span class="st">&quot;Mean age (range)&quot;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(age, <span class="dt">na.rm =</span> T), <span class="dv">1</span>),<span class="st">&quot; (&quot;</span>, 
                                        <span class="kw">range</span>(age, <span class="dt">na.rm =</span> T)[<span class="dv">1</span>], <span class="st">&quot;-&quot;</span>,
                                        <span class="kw">range</span>(age, <span class="dt">na.rm =</span> T)[<span class="dv">2</span>], <span class="st">&quot;)&quot;</span>),
            <span class="st">&quot;Mean study year (sd)&quot;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(studyYear, <span class="dt">na.rm =</span> T), <span class="dv">1</span>),<span class="st">&quot; (&quot;</span>, 
                                               <span class="kw">round</span>(<span class="kw">sd</span>(studyYear, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&quot;)&quot;</span>),
            <span class="st">&quot;% girl&quot;</span> =<span class="st"> </span><span class="kw">round</span>(<span class="kw">mean</span>(girl, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)<span class="op">*</span><span class="dv">100</span>, <span class="dv">1</span>),
            <span class="st">&quot;% intervention&quot;</span> =<span class="st"> </span><span class="kw">round</span>(<span class="kw">mean</span>(intervention, <span class="dt">na.rm =</span> T)<span class="op">*</span><span class="dv">100</span>, <span class="dv">1</span>),
            <span class="st">&quot;% born in Finland&quot;</span> =<span class="st"> </span><span class="kw">round</span>(<span class="kw">mean</span>(bornInFinland, <span class="dt">na.rm =</span> T)<span class="op">*</span><span class="dv">100</span>, <span class="dv">1</span>),
            <span class="dt">n =</span> <span class="kw">n</span>()) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="kw">complete.cases</span>(.)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">arrange</span>(<span class="kw">desc</span>(Track)) 

demotable_total &lt;-<span class="st"> </span>demographics <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarise</span>(<span class="st">&quot;Track&quot;</span> =<span class="st"> &quot;Full sample&quot;</span>,
            <span class="st">&quot;Mean age (range)&quot;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(age, <span class="dt">na.rm =</span> T), <span class="dv">1</span>),<span class="st">&quot; (&quot;</span>, 
                                        <span class="kw">range</span>(age, <span class="dt">na.rm =</span> T)[<span class="dv">1</span>], <span class="st">&quot;-&quot;</span>,
                                        <span class="kw">range</span>(age, <span class="dt">na.rm =</span> T)[<span class="dv">2</span>], <span class="st">&quot;)&quot;</span>),
            <span class="st">&quot;Mean study year (sd)&quot;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(studyYear, <span class="dt">na.rm =</span> T), <span class="dv">1</span>),<span class="st">&quot; (&quot;</span>, 
                                               <span class="kw">round</span>(<span class="kw">sd</span>(studyYear, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&quot;)&quot;</span>),
            <span class="st">&quot;% girl&quot;</span> =<span class="st"> </span><span class="kw">round</span>(<span class="kw">mean</span>(girl, <span class="dt">na.rm =</span> T)<span class="op">*</span><span class="dv">100</span>, <span class="dv">1</span>),
            <span class="st">&quot;% intervention&quot;</span> =<span class="st"> </span><span class="kw">round</span>(<span class="kw">mean</span>(intervention, <span class="dt">na.rm =</span> T)<span class="op">*</span><span class="dv">100</span>, <span class="dv">1</span>),
            <span class="st">&quot;% born in Finland&quot;</span> =<span class="st"> </span><span class="kw">round</span>(<span class="kw">mean</span>(bornInFinland, <span class="dt">na.rm =</span> T)<span class="op">*</span><span class="dv">100</span>, <span class="dv">1</span>),
            <span class="dt">n =</span> <span class="kw">n</span>())

demotable &lt;-<span class="st"> </span><span class="kw">bind_rows</span>(demotable, demotable_total)
## Warning in bind_rows_(x, .id): binding factor and character vector,
## coercing into character vector
## Warning in bind_rows_(x, .id): binding character and factor vector,
## coercing into character vector

demotable &lt;-<span class="st"> </span>demotable <span class="op">%&gt;%</span><span class="st"> </span>tidyr<span class="op">::</span><span class="kw">gather</span>(Variable, val, <span class="dv">2</span><span class="op">:</span><span class="kw">ncol</span>(demotable)) <span class="op">%&gt;%</span><span class="st"> </span>tidyr<span class="op">::</span><span class="kw">spread</span>(Track, val)

<span class="co"># For some reason, sum of n&#39;s of all tracks is 1084.</span>

papaja<span class="op">::</span><span class="kw">apa_table</span>(demotable, <span class="dt">caption =</span> <span class="st">&quot;Baseline demographics of educational tracks&quot;</span>, <span class="dt">digits =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>))</code></pre></div>
<caption>
(#tab:demographics-table-track)
</caption>
<caption>
<em>Baseline demographics of educational tracks</em>
</caption>
<table>
<thead>
<tr class="header">
<th align="left">Variable</th>
<th align="left">BA</th>
<th align="left">Full sample</th>
<th align="left">HRC</th>
<th align="left">IT</th>
<th align="left">Nur</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">% born in Finland</td>
<td align="left">87.1</td>
<td align="left">83.1</td>
<td align="left">88.2</td>
<td align="left">87.9</td>
<td align="left">80</td>
</tr>
<tr class="even">
<td align="left">% girl</td>
<td align="left">39</td>
<td align="left">56.5</td>
<td align="left">60.6</td>
<td align="left">16</td>
<td align="left">82.3</td>
</tr>
<tr class="odd">
<td align="left">% intervention</td>
<td align="left">53.5</td>
<td align="left">53.6</td>
<td align="left">31.5</td>
<td align="left">46.6</td>
<td align="left">68.9</td>
</tr>
<tr class="even">
<td align="left">Mean age (range)</td>
<td align="left">18 (16-35)</td>
<td align="left">18.5 (16-49)</td>
<td align="left">18.5 (17-27)</td>
<td align="left">18.5 (17-43)</td>
<td align="left">18.8 (16-49)</td>
</tr>
<tr class="odd">
<td align="left">Mean study year (sd)</td>
<td align="left">1.7 (0.9)</td>
<td align="left">1.7 (0.9)</td>
<td align="left">1.9 (0.7)</td>
<td align="left">1.7 (0.9)</td>
<td align="left">1.7 (0.9)</td>
</tr>
<tr class="even">
<td align="left">n</td>
<td align="left">282</td>
<td align="left">1165</td>
<td align="left">213</td>
<td align="left">163</td>
<td align="left">402</td>
</tr>
</tbody>
</table>
</div>
<div id="by-gender" class="section level3">
<h3>By gender</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">demographics<span class="op">$</span>Girl &lt;-<span class="st"> </span><span class="kw">factor</span>(demographics<span class="op">$</span>girl)

demotable &lt;-<span class="st"> </span>demographics <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(Girl) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarise</span>(<span class="st">&quot;Mean age (range)&quot;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(age, <span class="dt">na.rm =</span> T), <span class="dv">1</span>),<span class="st">&quot; (&quot;</span>, 
                                        <span class="kw">range</span>(age, <span class="dt">na.rm =</span> T)[<span class="dv">1</span>], <span class="st">&quot;-&quot;</span>,
                                        <span class="kw">range</span>(age, <span class="dt">na.rm =</span> T)[<span class="dv">2</span>], <span class="st">&quot;)&quot;</span>),
            <span class="st">&quot;Mean study year (sd)&quot;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(studyYear, <span class="dt">na.rm =</span> T), <span class="dv">1</span>),<span class="st">&quot; (&quot;</span>, 
                                               <span class="kw">round</span>(<span class="kw">sd</span>(studyYear, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&quot;)&quot;</span>),
            <span class="st">&quot;% intervention&quot;</span> =<span class="st"> </span><span class="kw">round</span>(<span class="kw">mean</span>(<span class="kw">as.numeric</span>(intervention), <span class="dt">na.rm =</span> T)<span class="op">*</span><span class="dv">100</span>, <span class="dv">1</span>),
            <span class="st">&quot;% born in Finland&quot;</span> =<span class="st"> </span><span class="kw">round</span>(<span class="kw">mean</span>(bornInFinland, <span class="dt">na.rm =</span> T)<span class="op">*</span><span class="dv">100</span>, <span class="dv">1</span>),
            <span class="dt">n =</span> <span class="kw">n</span>()) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="kw">complete.cases</span>(.)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">arrange</span>(<span class="kw">desc</span>(Girl)) 
## Warning in min(x): no non-missing arguments to min; returning Inf
## Warning in max(x): no non-missing arguments to max; returning -Inf
## Warning in min(x): no non-missing arguments to min; returning Inf
## Warning in max(x): no non-missing arguments to max; returning -Inf

demotable_total &lt;-<span class="st"> </span>demographics <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarise</span>(<span class="st">&quot;Girl&quot;</span> =<span class="st"> &quot;Full sample&quot;</span>,
            <span class="st">&quot;Mean age (range)&quot;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(age, <span class="dt">na.rm =</span> T), <span class="dv">1</span>),<span class="st">&quot; (&quot;</span>, 
                                        <span class="kw">range</span>(age, <span class="dt">na.rm =</span> T)[<span class="dv">1</span>], <span class="st">&quot;-&quot;</span>,
                                        <span class="kw">range</span>(age, <span class="dt">na.rm =</span> T)[<span class="dv">2</span>], <span class="st">&quot;)&quot;</span>),
            <span class="st">&quot;Mean study year (sd)&quot;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(studyYear, <span class="dt">na.rm =</span> T), <span class="dv">1</span>),<span class="st">&quot; (&quot;</span>, 
                                               <span class="kw">round</span>(<span class="kw">sd</span>(studyYear, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&quot;)&quot;</span>),
            <span class="st">&quot;% intervention&quot;</span> =<span class="st"> </span><span class="kw">round</span>(<span class="kw">mean</span>(intervention, <span class="dt">na.rm =</span> T)<span class="op">*</span><span class="dv">100</span>, <span class="dv">1</span>),
            <span class="st">&quot;% born in Finland&quot;</span> =<span class="st"> </span><span class="kw">round</span>(<span class="kw">mean</span>(bornInFinland, <span class="dt">na.rm =</span> T)<span class="op">*</span><span class="dv">100</span>, <span class="dv">1</span>),
            <span class="dt">n =</span> <span class="kw">n</span>())

demotable &lt;-<span class="st"> </span><span class="kw">bind_rows</span>(demotable, demotable_total)
## Warning in bind_rows_(x, .id): binding factor and character vector,
## coercing into character vector
## Warning in bind_rows_(x, .id): binding character and factor vector,
## coercing into character vector

demotable &lt;-<span class="st"> </span>demotable <span class="op">%&gt;%</span><span class="st"> </span>tidyr<span class="op">::</span><span class="kw">gather</span>(Variable, val, <span class="dv">2</span><span class="op">:</span><span class="kw">ncol</span>(demotable)) <span class="op">%&gt;%</span><span class="st"> </span>tidyr<span class="op">::</span><span class="kw">spread</span>(Girl, val)

<span class="kw">names</span>(demotable) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;&quot;</span>, <span class="st">&quot;Boy&quot;</span>, <span class="st">&quot;Girl&quot;</span>, <span class="st">&quot;Full sample&quot;</span>)

<span class="co"># For some reason, sum of n&#39;s of all tracks is 1084.</span>

papaja<span class="op">::</span><span class="kw">apa_table</span>(demotable, <span class="dt">caption =</span> <span class="st">&quot;Baseline demographics of educational tracks&quot;</span>, <span class="dt">digits =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>))</code></pre></div>
<caption>
(#tab:demographics-table-gender)
</caption>
<caption>
<em>Baseline demographics of educational tracks</em>
</caption>
<table>
<thead>
<tr class="header">
<th></th>
<th align="left">Boy</th>
<th align="left">Girl</th>
<th align="left">Full sample</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>% born in Finland</td>
<td align="left">88.2</td>
<td align="left">80.1</td>
<td align="left">83.1</td>
</tr>
<tr class="even">
<td>% intervention</td>
<td align="left">50.5</td>
<td align="left">56</td>
<td align="left">53.6</td>
</tr>
<tr class="odd">
<td>Mean age (range)</td>
<td align="left">18.2 (16-35)</td>
<td align="left">18.7 (16-49)</td>
<td align="left">18.5 (16-49)</td>
</tr>
<tr class="even">
<td>Mean study year (sd)</td>
<td align="left">1.7 (0.9)</td>
<td align="left">1.7 (0.8)</td>
<td align="left">1.7 (0.9)</td>
</tr>
<tr class="odd">
<td>n</td>
<td align="left">471</td>
<td align="left">613</td>
<td align="left">1165</td>
</tr>
</tbody>
</table>
</div>
<div id="by-intervention-participation" class="section level3">
<h3>By intervention participation</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">demographics<span class="op">$</span>intervention &lt;-<span class="st"> </span><span class="kw">factor</span>(demographics<span class="op">$</span>intervention)
demographics<span class="op">$</span>girl &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(demographics<span class="op">$</span>girl)

demotable &lt;-<span class="st"> </span>demographics <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(intervention) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarise</span>(<span class="st">&quot;Mean age (range)&quot;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(age, <span class="dt">na.rm =</span> T), <span class="dv">1</span>),<span class="st">&quot; (&quot;</span>, 
                                        <span class="kw">range</span>(age, <span class="dt">na.rm =</span> T)[<span class="dv">1</span>], <span class="st">&quot;-&quot;</span>,
                                        <span class="kw">range</span>(age, <span class="dt">na.rm =</span> T)[<span class="dv">2</span>], <span class="st">&quot;)&quot;</span>),
            <span class="st">&quot;Mean study year (sd)&quot;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(studyYear, <span class="dt">na.rm =</span> T), <span class="dv">1</span>),<span class="st">&quot; (&quot;</span>, 
                                               <span class="kw">round</span>(<span class="kw">sd</span>(studyYear, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&quot;)&quot;</span>),
            <span class="st">&quot;% girl&quot;</span> =<span class="st"> </span><span class="kw">round</span>(<span class="kw">mean</span>(girl, <span class="dt">na.rm =</span> T)<span class="op">*</span><span class="dv">100</span>, <span class="dv">1</span>),
            <span class="st">&quot;% born in Finland&quot;</span> =<span class="st"> </span><span class="kw">round</span>(<span class="kw">mean</span>(bornInFinland, <span class="dt">na.rm =</span> T)<span class="op">*</span><span class="dv">100</span>, <span class="dv">1</span>),
            <span class="dt">n =</span> <span class="kw">n</span>()) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="kw">complete.cases</span>(.)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">arrange</span>(<span class="kw">desc</span>(intervention)) 
## Warning in min(x): no non-missing arguments to min; returning Inf
## Warning in max(x): no non-missing arguments to max; returning -Inf
## Warning in min(x): no non-missing arguments to min; returning Inf
## Warning in max(x): no non-missing arguments to max; returning -Inf

demotable_total &lt;-<span class="st"> </span>demographics <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarise</span>(<span class="st">&quot;intervention&quot;</span> =<span class="st"> &quot;Full sample&quot;</span>,
            <span class="st">&quot;Mean age (range)&quot;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(age, <span class="dt">na.rm =</span> T), <span class="dv">1</span>),<span class="st">&quot; (&quot;</span>, 
                                        <span class="kw">range</span>(age, <span class="dt">na.rm =</span> T)[<span class="dv">1</span>], <span class="st">&quot;-&quot;</span>,
                                        <span class="kw">range</span>(age, <span class="dt">na.rm =</span> T)[<span class="dv">2</span>], <span class="st">&quot;)&quot;</span>),
            <span class="st">&quot;Mean study year (sd)&quot;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(studyYear, <span class="dt">na.rm =</span> T), <span class="dv">1</span>),<span class="st">&quot; (&quot;</span>, 
                                               <span class="kw">round</span>(<span class="kw">sd</span>(studyYear, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&quot;)&quot;</span>),
            <span class="st">&quot;% girl&quot;</span> =<span class="st"> </span><span class="kw">round</span>(<span class="kw">mean</span>(girl, <span class="dt">na.rm =</span> T)<span class="op">*</span><span class="dv">100</span>, <span class="dv">1</span>),
            <span class="st">&quot;% born in Finland&quot;</span> =<span class="st"> </span><span class="kw">round</span>(<span class="kw">mean</span>(bornInFinland, <span class="dt">na.rm =</span> T)<span class="op">*</span><span class="dv">100</span>, <span class="dv">1</span>),
            <span class="dt">n =</span> <span class="kw">n</span>())

demotable &lt;-<span class="st"> </span><span class="kw">bind_rows</span>(demotable, demotable_total)
## Warning in bind_rows_(x, .id): binding factor and character vector,
## coercing into character vector
## Warning in bind_rows_(x, .id): binding character and factor vector,
## coercing into character vector

demotable &lt;-<span class="st"> </span>demotable <span class="op">%&gt;%</span><span class="st"> </span>tidyr<span class="op">::</span><span class="kw">gather</span>(Variable, val, <span class="dv">2</span><span class="op">:</span><span class="kw">ncol</span>(demotable)) <span class="op">%&gt;%</span><span class="st"> </span>tidyr<span class="op">::</span><span class="kw">spread</span>(intervention, val)

<span class="kw">names</span>(demotable) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;&quot;</span>, <span class="st">&quot;Control&quot;</span>, <span class="st">&quot;Intervention&quot;</span>, <span class="st">&quot;Full sample&quot;</span>)

<span class="co"># For some reason, sum of n&#39;s of all tracks is 1084.</span>

papaja<span class="op">::</span><span class="kw">apa_table</span>(demotable, <span class="dt">caption =</span> <span class="st">&quot;Baseline demographics of educational tracks&quot;</span>, <span class="dt">digits =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>))</code></pre></div>
<caption>
(#tab:demographics-table-intervention)
</caption>
<caption>
<em>Baseline demographics of educational tracks</em>
</caption>
<table>
<thead>
<tr class="header">
<th></th>
<th align="left">Control</th>
<th align="left">Intervention</th>
<th align="left">Full sample</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>% born in Finland</td>
<td align="left">87.5</td>
<td align="left">79.6</td>
<td align="left">83.1</td>
</tr>
<tr class="even">
<td>% girl</td>
<td align="left">53.7</td>
<td align="left">59</td>
<td align="left">56.5</td>
</tr>
<tr class="odd">
<td>Mean age (range)</td>
<td align="left">18.3 (16-38)</td>
<td align="left">18.7 (16-49)</td>
<td align="left">18.5 (16-49)</td>
</tr>
<tr class="even">
<td>Mean study year (sd)</td>
<td align="left">1.7 (0.9)</td>
<td align="left">1.7 (0.9)</td>
<td align="left">1.7 (0.9)</td>
</tr>
<tr class="odd">
<td>n</td>
<td align="left">503</td>
<td align="left">581</td>
<td align="left">1165</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="create-outcome-tables" class="section level2">
<h2>Create outcome tables</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
outtable_track &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(mvpaAccelerometer_T1, sitLieAccelerometer_T1, sitBreaksAccelerometer_T1, <span class="co"># Main outcomes </span>
          PA_actionplan_T1,
          PA_copingplan_T1,
          PA_agrbct_T1,
          PA_frqbct_T1,
          PA_amotivation_T1,
          PA_autonomous_T1,
          PA_controlled_T1,
          PA_goal_T1,
          PA_inorm_T1,
          PA_dnorm_T1,
          PA_intention_T1,
          PA_outcomeExpectations_T1,
          PA_opportunities_T1,
          PA_pbc_T1,
          PA_selfefficacy_T1,
          SB_dnorm_T1,
          SB_inorm_T1,
          SB_intention_T1,
          SB_outcomeExpectations_T1,
          SB_sePbc_T1,
         track, girl, intervention) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(track) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarise</span>(
            <span class="st">&#39;PA action planning&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(PA_actionplan_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&quot; (&quot;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(PA_actionplan_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&quot;)&quot;</span>),
            <span class="st">&#39;PA coping planning&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(PA_copingplan_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(PA_copingplan_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),
            <span class="st">&#39;PA agreement-BCTs&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(PA_agrbct_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(PA_agrbct_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),
            <span class="st">&#39;PA frequency-BCTs&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(PA_frqbct_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(PA_frqbct_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),
            <span class="st">&#39;PA amotivation&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(PA_amotivation_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(PA_amotivation_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),
            <span class="st">&#39;PA autonomous regulation&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(PA_autonomous_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(PA_autonomous_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),
            <span class="st">&#39;PA controlled regulation&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(PA_controlled_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(PA_controlled_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),
            <span class="st">&#39;PA injunctive norm&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(PA_inorm_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(PA_inorm_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),
            <span class="st">&#39;PA descriptive norm&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(PA_dnorm_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(PA_dnorm_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),
            <span class="st">&#39;PA intention&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(PA_intention_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(PA_intention_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),
            <span class="st">&#39;PA outcome expectations&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(PA_outcomeExpectations_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(PA_outcomeExpectations_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),
            <span class="st">&#39;PA opportunities&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(PA_opportunities_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(PA_opportunities_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),
            <span class="st">&#39;PA perceived behavioural control&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(PA_pbc_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(PA_pbc_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),
            <span class="st">&#39;PA self-efficacy&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(PA_selfefficacy_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(PA_selfefficacy_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),
            <span class="st">&#39;SB descriptive norm&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(SB_dnorm_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(SB_dnorm_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),
            <span class="st">&#39;SB injunctive norm&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(SB_inorm_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(SB_inorm_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),
            <span class="st">&#39;SB intention&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(SB_intention_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(SB_intention_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),
            <span class="st">&#39;SB outcome expectations&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(SB_outcomeExpectations_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(SB_outcomeExpectations_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),
            <span class="st">&#39;SB self-efficacy &amp; perceived behavioural control&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(SB_sePbc_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(SB_sePbc_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),

            <span class="st">&quot;Mean daily MVPA minutes&quot;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(mvpaAccelerometer_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>),<span class="st">&quot; (&quot;</span>, 
                                        <span class="kw">round</span>(<span class="kw">sd</span>(mvpaAccelerometer_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&quot;)&quot;</span>),
            <span class="st">&quot;Mean daily minutes spent sitting or lying down&quot;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(sitLieAccelerometer_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>),<span class="st">&quot; (&quot;</span>, 
                                        <span class="kw">round</span>(<span class="kw">sd</span>(sitLieAccelerometer_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&quot;)&quot;</span>),
            <span class="st">&quot;Mean daily breaks in sitting&quot;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(sitBreaksAccelerometer_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>),<span class="st">&quot; (&quot;</span>, 
                                        <span class="kw">round</span>(<span class="kw">sd</span>(sitBreaksAccelerometer_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&quot;)&quot;</span>),
            <span class="dt">n =</span> <span class="kw">n</span>()) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="kw">complete.cases</span>(.)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">arrange</span>(<span class="kw">desc</span>(track)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">!=</span><span class="st"> &quot;Other&quot;</span>)
## Error in FUN(X[[i]], ...): object &#39;SB_sePbc_T1&#39; not found

outtable_intervention &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(mvpaAccelerometer_T1, sitLieAccelerometer_T1, sitBreaksAccelerometer_T1, <span class="co"># Main outcomes </span>
          PA_actionplan_T1,
          PA_copingplan_T1,
          PA_agrbct_T1,
          PA_frqbct_T1,
          PA_amotivation_T1,
          PA_autonomous_T1,
          PA_controlled_T1,
          PA_goal_T1,
          PA_inorm_T1,
          PA_dnorm_T1,
          PA_intention_T1,
          PA_outcomeExpectations_T1,
          PA_opportunities_T1,
          PA_pbc_T1,
          PA_selfefficacy_T1,
          SB_dnorm_T1,
          SB_inorm_T1,
          SB_intention_T1,
          SB_outcomeExpectations_T1,
          SB_sePbc_T1,
         track, girl, intervention) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(intervention) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarise</span>(
            <span class="st">&#39;PA action planning&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(PA_actionplan_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&quot; (&quot;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(PA_actionplan_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&quot;)&quot;</span>),
            <span class="st">&#39;PA coping planning&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(PA_copingplan_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(PA_copingplan_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),
            <span class="st">&#39;PA agreement-BCTs&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(PA_agrbct_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(PA_agrbct_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),
            <span class="st">&#39;PA frequency-BCTs&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(PA_frqbct_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(PA_frqbct_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),
            <span class="st">&#39;PA amotivation&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(PA_amotivation_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(PA_amotivation_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),
            <span class="st">&#39;PA autonomous regulation&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(PA_autonomous_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(PA_autonomous_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),
            <span class="st">&#39;PA controlled regulation&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(PA_controlled_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(PA_controlled_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),
            <span class="st">&#39;PA injunctive norm&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(PA_inorm_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(PA_inorm_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),
            <span class="st">&#39;PA descriptive norm&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(PA_dnorm_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(PA_dnorm_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),
            <span class="st">&#39;PA intention&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(PA_intention_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(PA_intention_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),
            <span class="st">&#39;PA outcome expectations&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(PA_outcomeExpectations_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(PA_outcomeExpectations_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),
            <span class="st">&#39;PA opportunities&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(PA_opportunities_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(PA_opportunities_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),
            <span class="st">&#39;PA perceived behavioural control&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(PA_pbc_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(PA_pbc_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),
            <span class="st">&#39;PA self-efficacy&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(PA_selfefficacy_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(PA_selfefficacy_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),
            <span class="st">&#39;SB descriptive norm&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(SB_dnorm_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(SB_dnorm_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),
            <span class="st">&#39;SB injunctive norm&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(SB_inorm_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(SB_inorm_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),
            <span class="st">&#39;SB intention&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(SB_intention_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(SB_intention_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),
            <span class="st">&#39;SB outcome expectations&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(SB_outcomeExpectations_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(SB_outcomeExpectations_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),
            <span class="st">&#39;SB self-efficacy &amp; perceived behavioural control&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(SB_sePbc_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(SB_sePbc_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),

            <span class="st">&quot;Mean daily MVPA minutes&quot;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(mvpaAccelerometer_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>),<span class="st">&quot; (&quot;</span>, 
                                        <span class="kw">round</span>(<span class="kw">sd</span>(mvpaAccelerometer_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&quot;)&quot;</span>),
            <span class="st">&quot;Mean daily minutes spent sitting or lying down&quot;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(sitLieAccelerometer_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>),<span class="st">&quot; (&quot;</span>, 
                                        <span class="kw">round</span>(<span class="kw">sd</span>(sitLieAccelerometer_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&quot;)&quot;</span>),
            <span class="st">&quot;Mean daily breaks in sitting&quot;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(sitBreaksAccelerometer_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>),<span class="st">&quot; (&quot;</span>, 
                                        <span class="kw">round</span>(<span class="kw">sd</span>(sitBreaksAccelerometer_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&quot;)&quot;</span>),
            <span class="dt">n =</span> <span class="kw">n</span>()) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="kw">complete.cases</span>(.))
## Error in FUN(X[[i]], ...): object &#39;SB_sePbc_T1&#39; not found

outtable_girl &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(mvpaAccelerometer_T1, sitLieAccelerometer_T1, sitBreaksAccelerometer_T1, <span class="co"># Main outcomes </span>
          PA_actionplan_T1,
          PA_copingplan_T1,
          PA_agrbct_T1,
          PA_frqbct_T1,
          PA_amotivation_T1,
          PA_autonomous_T1,
          PA_controlled_T1,
          PA_goal_T1,
          PA_inorm_T1,
          PA_dnorm_T1,
          PA_intention_T1,
          PA_outcomeExpectations_T1,
          PA_opportunities_T1,
          PA_pbc_T1,
          PA_selfefficacy_T1,
          SB_dnorm_T1,
          SB_inorm_T1,
          SB_intention_T1,
          SB_outcomeExpectations_T1,
          SB_sePbc_T1,
         track, girl, intervention) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(girl) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarise</span>(
            <span class="st">&#39;PA action planning&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(PA_actionplan_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&quot; (&quot;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(PA_actionplan_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&quot;)&quot;</span>),
            <span class="st">&#39;PA coping planning&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(PA_copingplan_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(PA_copingplan_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),
            <span class="st">&#39;PA agreement-BCTs&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(PA_agrbct_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(PA_agrbct_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),
            <span class="st">&#39;PA frequency-BCTs&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(PA_frqbct_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(PA_frqbct_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),
            <span class="st">&#39;PA amotivation&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(PA_amotivation_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(PA_amotivation_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),
            <span class="st">&#39;PA autonomous regulation&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(PA_autonomous_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(PA_autonomous_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),
            <span class="st">&#39;PA controlled regulation&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(PA_controlled_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(PA_controlled_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),
            <span class="st">&#39;PA injunctive norm&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(PA_inorm_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(PA_inorm_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),
            <span class="st">&#39;PA descriptive norm&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(PA_dnorm_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(PA_dnorm_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),
            <span class="st">&#39;PA intention&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(PA_intention_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(PA_intention_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),
            <span class="st">&#39;PA outcome expectations&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(PA_outcomeExpectations_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(PA_outcomeExpectations_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),
            <span class="st">&#39;PA opportunities&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(PA_opportunities_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(PA_opportunities_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),
            <span class="st">&#39;PA perceived behavioural control&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(PA_pbc_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(PA_pbc_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),
            <span class="st">&#39;PA self-efficacy&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(PA_selfefficacy_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(PA_selfefficacy_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),
            <span class="st">&#39;SB descriptive norm&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(SB_dnorm_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(SB_dnorm_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),
            <span class="st">&#39;SB injunctive norm&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(SB_inorm_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(SB_inorm_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),
            <span class="st">&#39;SB intention&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(SB_intention_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(SB_intention_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),
            <span class="st">&#39;SB outcome expectations&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(SB_outcomeExpectations_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(SB_outcomeExpectations_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),
            <span class="st">&#39;SB self-efficacy &amp; perceived behavioural control&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(SB_sePbc_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(SB_sePbc_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),

            <span class="st">&quot;Mean daily MVPA minutes&quot;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(mvpaAccelerometer_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>),<span class="st">&quot; (&quot;</span>, 
                                        <span class="kw">round</span>(<span class="kw">sd</span>(mvpaAccelerometer_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&quot;)&quot;</span>),
            <span class="st">&quot;Mean daily minutes spent sitting or lying down&quot;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(sitLieAccelerometer_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>),<span class="st">&quot; (&quot;</span>, 
                                        <span class="kw">round</span>(<span class="kw">sd</span>(sitLieAccelerometer_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&quot;)&quot;</span>),
            <span class="st">&quot;Mean daily breaks in sitting&quot;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(sitBreaksAccelerometer_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>),<span class="st">&quot; (&quot;</span>, 
                                        <span class="kw">round</span>(<span class="kw">sd</span>(sitBreaksAccelerometer_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&quot;)&quot;</span>),
            <span class="dt">n =</span> <span class="kw">n</span>()) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="kw">complete.cases</span>(.))
## Error in FUN(X[[i]], ...): object &#39;SB_sePbc_T1&#39; not found

outtable_total &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarise</span>(<span class="st">&#39;girl&#39;</span> =<span class="st"> &quot;Full sample&quot;</span>,
            <span class="st">&#39;PA action planning&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(PA_actionplan_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&quot; (&quot;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(PA_actionplan_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&quot;)&quot;</span>),
            <span class="st">&#39;PA coping planning&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(PA_copingplan_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(PA_copingplan_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),
            <span class="st">&#39;PA agreement-BCTs&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(PA_agrbct_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(PA_agrbct_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),
            <span class="st">&#39;PA frequency-BCTs&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(PA_frqbct_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(PA_frqbct_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),
            <span class="st">&#39;PA amotivation&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(PA_amotivation_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(PA_amotivation_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),
            <span class="st">&#39;PA autonomous regulation&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(PA_autonomous_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(PA_autonomous_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),
            <span class="st">&#39;PA controlled regulation&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(PA_controlled_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(PA_controlled_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),
            <span class="st">&#39;PA injunctive norm&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(PA_inorm_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(PA_inorm_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),
            <span class="st">&#39;PA descriptive norm&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(PA_dnorm_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(PA_dnorm_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),
            <span class="st">&#39;PA intention&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(PA_intention_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(PA_intention_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),
            <span class="st">&#39;PA outcome expectations&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(PA_outcomeExpectations_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(PA_outcomeExpectations_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),
            <span class="st">&#39;PA opportunities&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(PA_opportunities_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(PA_opportunities_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),
            <span class="st">&#39;PA perceived behavioural control&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(PA_pbc_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(PA_pbc_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),
            <span class="st">&#39;PA self-efficacy&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(PA_selfefficacy_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(PA_selfefficacy_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),
            <span class="st">&#39;SB descriptive norm&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(SB_dnorm_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(SB_dnorm_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),
            <span class="st">&#39;SB injunctive norm&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(SB_inorm_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(SB_inorm_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),
            <span class="st">&#39;SB intention&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(SB_intention_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(SB_intention_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),
            <span class="st">&#39;SB outcome expectations&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(SB_outcomeExpectations_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(SB_outcomeExpectations_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),
            <span class="st">&#39;SB self-efficacy &amp; perceived behavioural control&#39;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(SB_sePbc_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&#39; (&#39;</span>, <span class="kw">round</span>(<span class="kw">sd</span>(SB_sePbc_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&#39;)&#39;</span>),

            <span class="st">&quot;Mean daily MVPA minutes&quot;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(mvpaAccelerometer_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>),<span class="st">&quot; (&quot;</span>, 
                                        <span class="kw">round</span>(<span class="kw">sd</span>(mvpaAccelerometer_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&quot;)&quot;</span>),
            <span class="st">&quot;Mean daily minutes spent sitting or lying down&quot;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(sitLieAccelerometer_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>),<span class="st">&quot; (&quot;</span>, 
                                        <span class="kw">round</span>(<span class="kw">sd</span>(sitLieAccelerometer_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&quot;)&quot;</span>),
            <span class="st">&quot;Mean daily breaks in sitting&quot;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(<span class="kw">mean</span>(sitBreaksAccelerometer_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>),<span class="st">&quot; (&quot;</span>, 
                                        <span class="kw">round</span>(<span class="kw">sd</span>(sitBreaksAccelerometer_T1, <span class="dt">na.rm =</span> T), <span class="dv">1</span>), <span class="st">&quot;)&quot;</span>),
            <span class="dt">n =</span> <span class="kw">n</span>())
## Error in summarise_impl(.data, dots): Evaluation error: object &#39;SB_sePbc_T1&#39; not found.



<span class="co"># Transpose each table</span>
outtable_track &lt;-<span class="st"> </span>outtable_track <span class="op">%&gt;%</span><span class="st"> </span>tidyr<span class="op">::</span><span class="kw">gather</span>(Variable, val, <span class="dv">2</span><span class="op">:</span><span class="kw">ncol</span>(.)) <span class="op">%&gt;%</span><span class="st"> </span>tidyr<span class="op">::</span><span class="kw">spread</span>(track, val)
## Error in eval(lhs, parent, parent): object &#39;outtable_track&#39; not found

outtable_intervention &lt;-<span class="st"> </span>outtable_intervention <span class="op">%&gt;%</span><span class="st"> </span>tidyr<span class="op">::</span><span class="kw">gather</span>(Variable, val, <span class="dv">2</span><span class="op">:</span><span class="kw">ncol</span>(.)) <span class="op">%&gt;%</span><span class="st"> </span>tidyr<span class="op">::</span><span class="kw">spread</span>(intervention, val)
## Error in eval(lhs, parent, parent): object &#39;outtable_intervention&#39; not found
<span class="kw">names</span>(outtable_intervention) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Variable&quot;</span>, <span class="st">&quot;Control&quot;</span>, <span class="st">&quot;Intervention&quot;</span>)
## Error in names(outtable_intervention) &lt;- c(&quot;Variable&quot;, &quot;Control&quot;, &quot;Intervention&quot;): object &#39;outtable_intervention&#39; not found

## In the last table, have a column for total before transposing
outtable_girl &lt;-<span class="st"> </span><span class="kw">bind_rows</span>(outtable_girl, outtable_total)
## Error in dots_values(...): object &#39;outtable_girl&#39; not found
outtable_girl &lt;-<span class="st"> </span>outtable_girl <span class="op">%&gt;%</span><span class="st"> </span>tidyr<span class="op">::</span><span class="kw">gather</span>(Variable, val, <span class="dv">2</span><span class="op">:</span><span class="kw">ncol</span>(.)) <span class="op">%&gt;%</span><span class="st"> </span>tidyr<span class="op">::</span><span class="kw">spread</span>(girl, val)
## Error in eval(lhs, parent, parent): object &#39;outtable_girl&#39; not found
<span class="kw">names</span>(outtable_girl) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Variable&quot;</span>, <span class="st">&quot;Boy&quot;</span>, <span class="st">&quot;Girl&quot;</span>, <span class="st">&quot;Full sample&quot;</span>)
## Error in names(outtable_girl) &lt;- c(&quot;Variable&quot;, &quot;Boy&quot;, &quot;Girl&quot;, &quot;Full sample&quot;): object &#39;outtable_girl&#39; not found

<span class="co"># Are all variables the same?</span>
<span class="kw">identical</span>(outtable_track<span class="op">$</span>Variable, outtable_girl<span class="op">$</span>Variable)
## Error in identical(outtable_track$Variable, outtable_girl$Variable): object &#39;outtable_track&#39; not found
<span class="kw">identical</span>(outtable_track<span class="op">$</span>Variable, outtable_intervention<span class="op">$</span>Variable)
## Error in identical(outtable_track$Variable, outtable_intervention$Variable): object &#39;outtable_track&#39; not found

<span class="co"># Create large table with all variables</span>
outtable_mega &lt;-<span class="st"> </span><span class="kw">bind_cols</span>(outtable_track, outtable_intervention, outtable_girl) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>Variable1, <span class="op">-</span>Variable2) 
## Error in dots_values(...): object &#39;outtable_track&#39; not found

<span class="co"># Move n to be the first row</span>
out1 &lt;-<span class="st"> </span>outtable_mega <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(Variable <span class="op">==</span><span class="st"> &quot;n&quot;</span>)
## Error in eval(lhs, parent, parent): object &#39;outtable_mega&#39; not found
out2 &lt;-<span class="st"> </span>outtable_mega <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(Variable <span class="op">!=</span><span class="st"> &quot;n&quot;</span>)
## Error in eval(lhs, parent, parent): object &#39;outtable_mega&#39; not found
outtable_mega &lt;-<span class="st"> </span><span class="kw">bind_rows</span>(out1, out2)
## Error in dots_values(...): object &#39;out1&#39; not found

<span class="co"># Fix names: leave first blank, have the rest as they were</span>
<span class="kw">names</span>(outtable_mega) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;&quot;</span>, <span class="kw">names</span>(outtable_mega)[<span class="dv">2</span><span class="op">:</span>(<span class="kw">length</span>(<span class="kw">names</span>(outtable_mega)))])
## Error in eval(expr, envir, enclos): object &#39;outtable_mega&#39; not found

papaja<span class="op">::</span><span class="kw">apa_table</span>(outtable_mega, <span class="dt">caption =</span> <span class="st">&quot;Baseline demographics of educational tracks&quot;</span>)
## Error in papaja::apa_table(outtable_mega, caption = &quot;Baseline demographics of educational tracks&quot;): object &#39;outtable_mega&#39; not found</code></pre></div>
</div>
<div id="mediator-table-with-cis" class="section level2">
<h2>Mediator table with CIs</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
mediatortable_intervention &lt;-<span class="st"> </span>ci_intervention <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="kw">grepl</span>(<span class="st">&#39;PA_actionplan_T1|PA_copingplan_T1|PA_agrbct_T1|PA_frqbct_T1|PA_amotivation_T1|PA_autonomous_T1|PA_controlled_T1|PA_goal_T1|PA_inorm_T1|PA_dnorm_T1|PA_intention_T1|PA_outcomeExpectations_T1|PA_opportunities_T1|PA_pbc_T1|PA_selfefficacy_T1|SB_dnorm_T1|SB_inorm_T1|SB_intention_T1|SB_outcomeExpectations_T1&#39;</span>, ci_intervention<span class="op">$</span>diamondlabels)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(diamondlabels <span class="op">!=</span><span class="st"> &quot;PA_goal_T1&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="st">&quot;CI95&quot;</span> =<span class="st"> </span><span class="kw">paste</span>(<span class="kw">round</span>(ciLo, <span class="dv">1</span>), <span class="st">&quot;-&quot;</span>, <span class="kw">round</span>(ciHi, <span class="dv">1</span>)),
         <span class="dt">mean =</span> <span class="kw">round</span>(mean, <span class="dv">1</span>))

mediatortable_intervention<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_actionplan_T1&#39;</span>, <span class="st">&#39;PA action planning&#39;</span>, mediatortable_intervention<span class="op">$</span>diamondlabels)
mediatortable_intervention<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_copingplan_T1&#39;</span>, <span class="st">&#39;PA coping planning&#39;</span>, mediatortable_intervention<span class="op">$</span>diamondlabels)
mediatortable_intervention<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_agrbct_T1&#39;</span>, <span class="st">&#39;PA agreement-BCTs&#39;</span>, mediatortable_intervention<span class="op">$</span>diamondlabels)
mediatortable_intervention<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_frqbct_T1&#39;</span>, <span class="st">&#39;PA frequency-BCTs&#39;</span>, mediatortable_intervention<span class="op">$</span>diamondlabels)
mediatortable_intervention<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_amotivation_T1&#39;</span>, <span class="st">&#39;PA amotivation&#39;</span>, mediatortable_intervention<span class="op">$</span>diamondlabels)
mediatortable_intervention<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_autonomous_T1&#39;</span>, <span class="st">&#39;PA autonomous regulation&#39;</span>, mediatortable_intervention<span class="op">$</span>diamondlabels)
mediatortable_intervention<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_controlled_T1&#39;</span>, <span class="st">&#39;PA controlled regulation&#39;</span>, mediatortable_intervention<span class="op">$</span>diamondlabels)
mediatortable_intervention<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_inorm_T1&#39;</span>, <span class="st">&#39;PA injunctive norm&#39;</span>, mediatortable_intervention<span class="op">$</span>diamondlabels)
mediatortable_intervention<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_dnorm_T1&#39;</span>, <span class="st">&#39;PA descriptive norm&#39;</span>, mediatortable_intervention<span class="op">$</span>diamondlabels)
mediatortable_intervention<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_intention_T1&#39;</span>, <span class="st">&#39;PA intention&#39;</span>, mediatortable_intervention<span class="op">$</span>diamondlabels)
mediatortable_intervention<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_outcomeExpectations_T1&#39;</span>, <span class="st">&#39;PA outcome expectations&#39;</span>, mediatortable_intervention<span class="op">$</span>diamondlabels)
mediatortable_intervention<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_opportunities_T1&#39;</span>, <span class="st">&#39;PA opportunities&#39;</span>, mediatortable_intervention<span class="op">$</span>diamondlabels)
mediatortable_intervention<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_pbc_T1&#39;</span>, <span class="st">&#39;PA perceived behavioural control&#39;</span>, mediatortable_intervention<span class="op">$</span>diamondlabels)
mediatortable_intervention<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_selfefficacy_T1&#39;</span>, <span class="st">&#39;PA self-efficacy&#39;</span>, mediatortable_intervention<span class="op">$</span>diamondlabels)
mediatortable_intervention<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;SB_dnorm_T1&#39;</span>, <span class="st">&#39;SB descriptive norm&#39;</span>, mediatortable_intervention<span class="op">$</span>diamondlabels)
mediatortable_intervention<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;SB_inorm_T1&#39;</span>, <span class="st">&#39;SB injunctive norm&#39;</span>, mediatortable_intervention<span class="op">$</span>diamondlabels)
mediatortable_intervention<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;SB_intention_T1&#39;</span>, <span class="st">&#39;SB intention&#39;</span>, mediatortable_intervention<span class="op">$</span>diamondlabels)
mediatortable_intervention<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;SB_outcomeExpectations_T1&#39;</span>, <span class="st">&#39;SB outcome expectations&#39;</span>, mediatortable_intervention<span class="op">$</span>diamondlabels)

mediatortable_control &lt;-<span class="st"> </span>ci_control <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="kw">grepl</span>(<span class="st">&#39;PA_actionplan_T1|PA_copingplan_T1|PA_agrbct_T1|PA_frqbct_T1|PA_amotivation_T1|PA_autonomous_T1|PA_controlled_T1|PA_goal_T1|PA_inorm_T1|PA_dnorm_T1|PA_intention_T1|PA_outcomeExpectations_T1|PA_opportunities_T1|PA_pbc_T1|PA_selfefficacy_T1|SB_dnorm_T1|SB_inorm_T1|SB_intention_T1|SB_outcomeExpectations_T1&#39;</span>, ci_control<span class="op">$</span>diamondlabels)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(diamondlabels <span class="op">!=</span><span class="st"> &quot;PA_goal_T1&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="st">&quot;CI95&quot;</span> =<span class="st"> </span><span class="kw">paste</span>(<span class="kw">round</span>(ciLo, <span class="dv">1</span>), <span class="st">&quot;-&quot;</span>, <span class="kw">round</span>(ciHi, <span class="dv">1</span>)),
         <span class="dt">mean =</span> <span class="kw">round</span>(mean, <span class="dv">1</span>))

mediatortable_control<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_actionplan_T1&#39;</span>, <span class="st">&#39;PA action planning&#39;</span>, mediatortable_control<span class="op">$</span>diamondlabels)
mediatortable_control<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_copingplan_T1&#39;</span>, <span class="st">&#39;PA coping planning&#39;</span>, mediatortable_control<span class="op">$</span>diamondlabels)
mediatortable_control<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_agrbct_T1&#39;</span>, <span class="st">&#39;PA agreement-BCTs&#39;</span>, mediatortable_control<span class="op">$</span>diamondlabels)
mediatortable_control<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_frqbct_T1&#39;</span>, <span class="st">&#39;PA frequency-BCTs&#39;</span>, mediatortable_control<span class="op">$</span>diamondlabels)
mediatortable_control<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_amotivation_T1&#39;</span>, <span class="st">&#39;PA amotivation&#39;</span>, mediatortable_control<span class="op">$</span>diamondlabels)
mediatortable_control<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_autonomous_T1&#39;</span>, <span class="st">&#39;PA autonomous regulation&#39;</span>, mediatortable_control<span class="op">$</span>diamondlabels)
mediatortable_control<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_controlled_T1&#39;</span>, <span class="st">&#39;PA controlled regulation&#39;</span>, mediatortable_control<span class="op">$</span>diamondlabels)
mediatortable_control<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_inorm_T1&#39;</span>, <span class="st">&#39;PA injunctive norm&#39;</span>, mediatortable_control<span class="op">$</span>diamondlabels)
mediatortable_control<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_dnorm_T1&#39;</span>, <span class="st">&#39;PA descriptive norm&#39;</span>, mediatortable_control<span class="op">$</span>diamondlabels)
mediatortable_control<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_intention_T1&#39;</span>, <span class="st">&#39;PA intention&#39;</span>, mediatortable_control<span class="op">$</span>diamondlabels)
mediatortable_control<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_outcomeExpectations_T1&#39;</span>, <span class="st">&#39;PA outcome expectations&#39;</span>, mediatortable_control<span class="op">$</span>diamondlabels)
mediatortable_control<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_opportunities_T1&#39;</span>, <span class="st">&#39;PA opportunities&#39;</span>, mediatortable_control<span class="op">$</span>diamondlabels)
mediatortable_control<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_pbc_T1&#39;</span>, <span class="st">&#39;PA perceived behavioural control&#39;</span>, mediatortable_control<span class="op">$</span>diamondlabels)
mediatortable_control<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_selfefficacy_T1&#39;</span>, <span class="st">&#39;PA self-efficacy&#39;</span>, mediatortable_control<span class="op">$</span>diamondlabels)
mediatortable_control<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;SB_dnorm_T1&#39;</span>, <span class="st">&#39;SB descriptive norm&#39;</span>, mediatortable_control<span class="op">$</span>diamondlabels)
mediatortable_control<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;SB_inorm_T1&#39;</span>, <span class="st">&#39;SB injunctive norm&#39;</span>, mediatortable_control<span class="op">$</span>diamondlabels)
mediatortable_control<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;SB_intention_T1&#39;</span>, <span class="st">&#39;SB intention&#39;</span>, mediatortable_control<span class="op">$</span>diamondlabels)
mediatortable_control<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;SB_outcomeExpectations_T1&#39;</span>, <span class="st">&#39;SB outcome expectations&#39;</span>, mediatortable_control<span class="op">$</span>diamondlabels)

mediatortable_girls &lt;-<span class="st"> </span>ci_girls <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="kw">grepl</span>(<span class="st">&#39;PA_actionplan_T1|PA_copingplan_T1|PA_agrbct_T1|PA_frqbct_T1|PA_amotivation_T1|PA_autonomous_T1|PA_controlled_T1|PA_goal_T1|PA_inorm_T1|PA_dnorm_T1|PA_intention_T1|PA_outcomeExpectations_T1|PA_opportunities_T1|PA_pbc_T1|PA_selfefficacy_T1|SB_dnorm_T1|SB_inorm_T1|SB_intention_T1|SB_outcomeExpectations_T1&#39;</span>, ci_girls<span class="op">$</span>diamondlabels)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(diamondlabels <span class="op">!=</span><span class="st"> &quot;PA_goal_T1&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="st">&quot;CI95&quot;</span> =<span class="st"> </span><span class="kw">paste</span>(<span class="kw">round</span>(ciLo, <span class="dv">1</span>), <span class="st">&quot;-&quot;</span>, <span class="kw">round</span>(ciHi, <span class="dv">1</span>)),
         <span class="dt">mean =</span> <span class="kw">round</span>(mean, <span class="dv">1</span>))

mediatortable_girls<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_actionplan_T1&#39;</span>, <span class="st">&#39;PA action planning&#39;</span>, mediatortable_girls<span class="op">$</span>diamondlabels)
mediatortable_girls<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_copingplan_T1&#39;</span>, <span class="st">&#39;PA coping planning&#39;</span>, mediatortable_girls<span class="op">$</span>diamondlabels)
mediatortable_girls<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_agrbct_T1&#39;</span>, <span class="st">&#39;PA agreement-BCTs&#39;</span>, mediatortable_girls<span class="op">$</span>diamondlabels)
mediatortable_girls<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_frqbct_T1&#39;</span>, <span class="st">&#39;PA frequency-BCTs&#39;</span>, mediatortable_girls<span class="op">$</span>diamondlabels)
mediatortable_girls<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_amotivation_T1&#39;</span>, <span class="st">&#39;PA amotivation&#39;</span>, mediatortable_girls<span class="op">$</span>diamondlabels)
mediatortable_girls<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_autonomous_T1&#39;</span>, <span class="st">&#39;PA autonomous regulation&#39;</span>, mediatortable_girls<span class="op">$</span>diamondlabels)
mediatortable_girls<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_controlled_T1&#39;</span>, <span class="st">&#39;PA controlled regulation&#39;</span>, mediatortable_girls<span class="op">$</span>diamondlabels)
mediatortable_girls<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_inorm_T1&#39;</span>, <span class="st">&#39;PA injunctive norm&#39;</span>, mediatortable_girls<span class="op">$</span>diamondlabels)
mediatortable_girls<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_dnorm_T1&#39;</span>, <span class="st">&#39;PA descriptive norm&#39;</span>, mediatortable_girls<span class="op">$</span>diamondlabels)
mediatortable_girls<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_intention_T1&#39;</span>, <span class="st">&#39;PA intention&#39;</span>, mediatortable_girls<span class="op">$</span>diamondlabels)
mediatortable_girls<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_outcomeExpectations_T1&#39;</span>, <span class="st">&#39;PA outcome expectations&#39;</span>, mediatortable_girls<span class="op">$</span>diamondlabels)
mediatortable_girls<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_opportunities_T1&#39;</span>, <span class="st">&#39;PA opportunities&#39;</span>, mediatortable_girls<span class="op">$</span>diamondlabels)
mediatortable_girls<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_pbc_T1&#39;</span>, <span class="st">&#39;PA perceived behavioural control&#39;</span>, mediatortable_girls<span class="op">$</span>diamondlabels)
mediatortable_girls<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_selfefficacy_T1&#39;</span>, <span class="st">&#39;PA self-efficacy&#39;</span>, mediatortable_girls<span class="op">$</span>diamondlabels)
mediatortable_girls<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;SB_dnorm_T1&#39;</span>, <span class="st">&#39;SB descriptive norm&#39;</span>, mediatortable_girls<span class="op">$</span>diamondlabels)
mediatortable_girls<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;SB_inorm_T1&#39;</span>, <span class="st">&#39;SB injunctive norm&#39;</span>, mediatortable_girls<span class="op">$</span>diamondlabels)
mediatortable_girls<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;SB_intention_T1&#39;</span>, <span class="st">&#39;SB intention&#39;</span>, mediatortable_girls<span class="op">$</span>diamondlabels)
mediatortable_girls<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;SB_outcomeExpectations_T1&#39;</span>, <span class="st">&#39;SB outcome expectations&#39;</span>, mediatortable_girls<span class="op">$</span>diamondlabels)

mediatortable_boys &lt;-<span class="st"> </span>ci_boys <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="kw">grepl</span>(<span class="st">&#39;PA_actionplan_T1|PA_copingplan_T1|PA_agrbct_T1|PA_frqbct_T1|PA_amotivation_T1|PA_autonomous_T1|PA_controlled_T1|PA_goal_T1|PA_inorm_T1|PA_dnorm_T1|PA_intention_T1|PA_outcomeExpectations_T1|PA_opportunities_T1|PA_pbc_T1|PA_selfefficacy_T1|SB_dnorm_T1|SB_inorm_T1|SB_intention_T1|SB_outcomeExpectations_T1&#39;</span>, ci_boys<span class="op">$</span>diamondlabels)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(diamondlabels <span class="op">!=</span><span class="st"> &quot;PA_goal_T1&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="st">&quot;CI95&quot;</span> =<span class="st"> </span><span class="kw">paste</span>(<span class="kw">round</span>(ciLo, <span class="dv">1</span>), <span class="st">&quot;-&quot;</span>, <span class="kw">round</span>(ciHi, <span class="dv">1</span>)),
         <span class="dt">mean =</span> <span class="kw">round</span>(mean, <span class="dv">1</span>))

mediatortable_boys<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_actionplan_T1&#39;</span>, <span class="st">&#39;PA action planning&#39;</span>, mediatortable_boys<span class="op">$</span>diamondlabels)
mediatortable_boys<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_copingplan_T1&#39;</span>, <span class="st">&#39;PA coping planning&#39;</span>, mediatortable_boys<span class="op">$</span>diamondlabels)
mediatortable_boys<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_agrbct_T1&#39;</span>, <span class="st">&#39;PA agreement-BCTs&#39;</span>, mediatortable_boys<span class="op">$</span>diamondlabels)
mediatortable_boys<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_frqbct_T1&#39;</span>, <span class="st">&#39;PA frequency-BCTs&#39;</span>, mediatortable_boys<span class="op">$</span>diamondlabels)
mediatortable_boys<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_amotivation_T1&#39;</span>, <span class="st">&#39;PA amotivation&#39;</span>, mediatortable_boys<span class="op">$</span>diamondlabels)
mediatortable_boys<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_autonomous_T1&#39;</span>, <span class="st">&#39;PA autonomous regulation&#39;</span>, mediatortable_boys<span class="op">$</span>diamondlabels)
mediatortable_boys<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_controlled_T1&#39;</span>, <span class="st">&#39;PA controlled regulation&#39;</span>, mediatortable_boys<span class="op">$</span>diamondlabels)
mediatortable_boys<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_inorm_T1&#39;</span>, <span class="st">&#39;PA injunctive norm&#39;</span>, mediatortable_boys<span class="op">$</span>diamondlabels)
mediatortable_boys<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_dnorm_T1&#39;</span>, <span class="st">&#39;PA descriptive norm&#39;</span>, mediatortable_boys<span class="op">$</span>diamondlabels)
mediatortable_boys<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_intention_T1&#39;</span>, <span class="st">&#39;PA intention&#39;</span>, mediatortable_boys<span class="op">$</span>diamondlabels)
mediatortable_boys<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_outcomeExpectations_T1&#39;</span>, <span class="st">&#39;PA outcome expectations&#39;</span>, mediatortable_boys<span class="op">$</span>diamondlabels)
mediatortable_boys<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_opportunities_T1&#39;</span>, <span class="st">&#39;PA opportunities&#39;</span>, mediatortable_boys<span class="op">$</span>diamondlabels)
mediatortable_boys<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_pbc_T1&#39;</span>, <span class="st">&#39;PA perceived behavioural control&#39;</span>, mediatortable_boys<span class="op">$</span>diamondlabels)
mediatortable_boys<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_selfefficacy_T1&#39;</span>, <span class="st">&#39;PA self-efficacy&#39;</span>, mediatortable_boys<span class="op">$</span>diamondlabels)
mediatortable_boys<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;SB_dnorm_T1&#39;</span>, <span class="st">&#39;SB descriptive norm&#39;</span>, mediatortable_boys<span class="op">$</span>diamondlabels)
mediatortable_boys<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;SB_inorm_T1&#39;</span>, <span class="st">&#39;SB injunctive norm&#39;</span>, mediatortable_boys<span class="op">$</span>diamondlabels)
mediatortable_boys<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;SB_intention_T1&#39;</span>, <span class="st">&#39;SB intention&#39;</span>, mediatortable_boys<span class="op">$</span>diamondlabels)
mediatortable_boys<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;SB_outcomeExpectations_T1&#39;</span>, <span class="st">&#39;SB outcome expectations&#39;</span>, mediatortable_boys<span class="op">$</span>diamondlabels)

mediatortable_total &lt;-<span class="st"> </span>ci_total <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="kw">grepl</span>(<span class="st">&#39;PA_actionplan_T1|PA_copingplan_T1|PA_agrbct_T1|PA_frqbct_T1|PA_amotivation_T1|PA_autonomous_T1|PA_controlled_T1|PA_goal_T1|PA_inorm_T1|PA_dnorm_T1|PA_intention_T1|PA_outcomeExpectations_T1|PA_opportunities_T1|PA_pbc_T1|PA_selfefficacy_T1|SB_dnorm_T1|SB_inorm_T1|SB_intention_T1|SB_outcomeExpectations_T1&#39;</span>, ci_total<span class="op">$</span>diamondlabels)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(diamondlabels <span class="op">!=</span><span class="st"> &quot;PA_goal_T1&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="st">&quot;CI95&quot;</span> =<span class="st"> </span><span class="kw">paste</span>(<span class="kw">round</span>(ciLo, <span class="dv">1</span>), <span class="st">&quot;-&quot;</span>, <span class="kw">round</span>(ciHi, <span class="dv">1</span>)),
         <span class="dt">mean =</span> <span class="kw">round</span>(mean, <span class="dv">1</span>))

mediatortable_total<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_actionplan_T1&#39;</span>, <span class="st">&#39;PA action planning&#39;</span>, mediatortable_total<span class="op">$</span>diamondlabels)
mediatortable_total<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_copingplan_T1&#39;</span>, <span class="st">&#39;PA coping planning&#39;</span>, mediatortable_total<span class="op">$</span>diamondlabels)
mediatortable_total<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_agrbct_T1&#39;</span>, <span class="st">&#39;PA agreement-BCTs&#39;</span>, mediatortable_total<span class="op">$</span>diamondlabels)
mediatortable_total<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_frqbct_T1&#39;</span>, <span class="st">&#39;PA frequency-BCTs&#39;</span>, mediatortable_total<span class="op">$</span>diamondlabels)
mediatortable_total<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_amotivation_T1&#39;</span>, <span class="st">&#39;PA amotivation&#39;</span>, mediatortable_total<span class="op">$</span>diamondlabels)
mediatortable_total<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_autonomous_T1&#39;</span>, <span class="st">&#39;PA autonomous regulation&#39;</span>, mediatortable_total<span class="op">$</span>diamondlabels)
mediatortable_total<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_controlled_T1&#39;</span>, <span class="st">&#39;PA controlled regulation&#39;</span>, mediatortable_total<span class="op">$</span>diamondlabels)
mediatortable_total<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_inorm_T1&#39;</span>, <span class="st">&#39;PA injunctive norm&#39;</span>, mediatortable_total<span class="op">$</span>diamondlabels)
mediatortable_total<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_dnorm_T1&#39;</span>, <span class="st">&#39;PA descriptive norm&#39;</span>, mediatortable_total<span class="op">$</span>diamondlabels)
mediatortable_total<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_intention_T1&#39;</span>, <span class="st">&#39;PA intention&#39;</span>, mediatortable_total<span class="op">$</span>diamondlabels)
mediatortable_total<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_outcomeExpectations_T1&#39;</span>, <span class="st">&#39;PA outcome expectations&#39;</span>, mediatortable_total<span class="op">$</span>diamondlabels)
mediatortable_total<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_opportunities_T1&#39;</span>, <span class="st">&#39;PA opportunities&#39;</span>, mediatortable_total<span class="op">$</span>diamondlabels)
mediatortable_total<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_pbc_T1&#39;</span>, <span class="st">&#39;PA perceived behavioural control&#39;</span>, mediatortable_total<span class="op">$</span>diamondlabels)
mediatortable_total<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;PA_selfefficacy_T1&#39;</span>, <span class="st">&#39;PA self-efficacy&#39;</span>, mediatortable_total<span class="op">$</span>diamondlabels)
mediatortable_total<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;SB_dnorm_T1&#39;</span>, <span class="st">&#39;SB descriptive norm&#39;</span>, mediatortable_total<span class="op">$</span>diamondlabels)
mediatortable_total<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;SB_inorm_T1&#39;</span>, <span class="st">&#39;SB injunctive norm&#39;</span>, mediatortable_total<span class="op">$</span>diamondlabels)
mediatortable_total<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;SB_intention_T1&#39;</span>, <span class="st">&#39;SB intention&#39;</span>, mediatortable_total<span class="op">$</span>diamondlabels)
mediatortable_total<span class="op">$</span>diamondlabels &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;SB_outcomeExpectations_T1&#39;</span>, <span class="st">&#39;SB outcome expectations&#39;</span>, mediatortable_total<span class="op">$</span>diamondlabels)

mega_mediatortable &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">Variable =</span> mediatortable_girls<span class="op">$</span>diamondlabels, 
                                 <span class="st">&quot;Girls&quot;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(mediatortable_girls<span class="op">$</span>mean, <span class="dv">2</span>), <span class="st">&quot; (&quot;</span>, mediatortable_girls<span class="op">$</span>CI95, <span class="st">&quot;)&quot;</span>),
                                 <span class="st">&quot;Boys&quot;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(mediatortable_boys<span class="op">$</span>mean, <span class="dv">2</span>), <span class="st">&quot; (&quot;</span>, mediatortable_boys<span class="op">$</span>CI95, <span class="st">&quot;)&quot;</span>),
                                 <span class="st">&quot;Intervention&quot;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(mediatortable_intervention<span class="op">$</span>mean, <span class="dv">2</span>), <span class="st">&quot; (&quot;</span>, mediatortable_intervention<span class="op">$</span>CI95, <span class="st">&quot;)&quot;</span>),
                                 <span class="st">&quot;Control&quot;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(mediatortable_control<span class="op">$</span>mean, <span class="dv">2</span>), <span class="st">&quot; (&quot;</span>, mediatortable_control<span class="op">$</span>CI95, <span class="st">&quot;)&quot;</span>),
                                 <span class="st">&quot;Total&quot;</span> =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(mediatortable_total<span class="op">$</span>mean, <span class="dv">2</span>), <span class="st">&quot; (&quot;</span>, mediatortable_total<span class="op">$</span>CI95, <span class="st">&quot;)&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">arrange</span>(Variable)

papaja<span class="op">::</span><span class="kw">apa_table</span>(mega_mediatortable, <span class="dt">caption =</span> <span class="st">&quot;Main mediating variables of PA and SB&quot;</span>)</code></pre></div>
<caption>
(#tab:outcome-table2)
</caption>
<caption>
<em>Main mediating variables of PA and SB</em>
</caption>
<table>
<thead>
<tr class="header">
<th align="left">Variable</th>
<th align="left">Girls</th>
<th align="left">Boys</th>
<th align="left">Intervention</th>
<th align="left">Control</th>
<th align="left">Total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">PA action planning</td>
<td align="left">2.7 (2.6 - 2.8)</td>
<td align="left">2.8 (2.7 - 2.9)</td>
<td align="left">2.7 (2.6 - 2.8)</td>
<td align="left">2.8 (2.7 - 2.9)</td>
<td align="left">2.8 (2.7 - 2.8)</td>
</tr>
<tr class="even">
<td align="left">PA agreement-BCTs</td>
<td align="left">3.1 (2.9 - 3.2)</td>
<td align="left">3.1 (3 - 3.3)</td>
<td align="left">3 (2.9 - 3.2)</td>
<td align="left">3.2 (3 - 3.4)</td>
<td align="left">3.1 (3 - 3.2)</td>
</tr>
<tr class="odd">
<td align="left">PA amotivation</td>
<td align="left">1.5 (1.4 - 1.5)</td>
<td align="left">1.6 (1.5 - 1.7)</td>
<td align="left">1.5 (1.4 - 1.6)</td>
<td align="left">1.5 (1.4 - 1.7)</td>
<td align="left">1.5 (1.5 - 1.6)</td>
</tr>
<tr class="even">
<td align="left">PA autonomous regulation</td>
<td align="left">3.3 (3.2 - 3.5)</td>
<td align="left">3.6 (3.4 - 3.7)</td>
<td align="left">3.3 (3.2 - 3.5)</td>
<td align="left">3.5 (3.3 - 3.6)</td>
<td align="left">3.4 (3.3 - 3.5)</td>
</tr>
<tr class="odd">
<td align="left">PA controlled regulation</td>
<td align="left">1.9 (1.8 - 2)</td>
<td align="left">1.8 (1.7 - 1.8)</td>
<td align="left">1.8 (1.7 - 1.9)</td>
<td align="left">1.9 (1.8 - 1.9)</td>
<td align="left">1.8 (1.8 - 1.9)</td>
</tr>
<tr class="even">
<td align="left">PA coping planning</td>
<td align="left">2.4 (2.4 - 2.5)</td>
<td align="left">2.6 (2.5 - 2.7)</td>
<td align="left">2.5 (2.4 - 2.6)</td>
<td align="left">2.5 (2.4 - 2.6)</td>
<td align="left">2.5 (2.4 - 2.6)</td>
</tr>
<tr class="odd">
<td align="left">PA descriptive norm</td>
<td align="left">4.3 (4.1 - 4.5)</td>
<td align="left">4.5 (4.4 - 4.7)</td>
<td align="left">4.3 (4.1 - 4.5)</td>
<td align="left">4.5 (4.3 - 4.7)</td>
<td align="left">4.4 (4.2 - 4.6)</td>
</tr>
<tr class="even">
<td align="left">PA frequency-BCTs</td>
<td align="left">2.5 (2.4 - 2.6)</td>
<td align="left">2.6 (2.5 - 2.7)</td>
<td align="left">2.5 (2.4 - 2.6)</td>
<td align="left">2.6 (2.4 - 2.7)</td>
<td align="left">2.5 (2.4 - 2.6)</td>
</tr>
<tr class="odd">
<td align="left">PA injunctive norm</td>
<td align="left">4.6 (4.4 - 4.8)</td>
<td align="left">4.8 (4.5 - 5)</td>
<td align="left">4.5 (4.3 - 4.7)</td>
<td align="left">4.8 (4.6 - 5)</td>
<td align="left">4.7 (4.5 - 4.8)</td>
</tr>
<tr class="even">
<td align="left">PA intention</td>
<td align="left">5.3 (5.1 - 5.5)</td>
<td align="left">5.5 (5.2 - 5.7)</td>
<td align="left">5.4 (5.1 - 5.7)</td>
<td align="left">5.4 (5.1 - 5.7)</td>
<td align="left">5.4 (5.2 - 5.6)</td>
</tr>
<tr class="odd">
<td align="left">PA opportunities</td>
<td align="left">5.1 (5 - 5.1)</td>
<td align="left">5.2 (5.1 - 5.3)</td>
<td align="left">5.1 (5 - 5.2)</td>
<td align="left">5.2 (5.1 - 5.3)</td>
<td align="left">5.1 (5.1 - 5.2)</td>
</tr>
<tr class="even">
<td align="left">PA outcome expectations</td>
<td align="left">4.7 (4.6 - 4.8)</td>
<td align="left">4.5 (4.4 - 4.6)</td>
<td align="left">4.6 (4.4 - 4.7)</td>
<td align="left">4.7 (4.5 - 4.8)</td>
<td align="left">4.6 (4.5 - 4.7)</td>
</tr>
<tr class="odd">
<td align="left">PA perceived behavioural control</td>
<td align="left">5.2 (5.1 - 5.3)</td>
<td align="left">5.5 (5.4 - 5.6)</td>
<td align="left">5.3 (5.1 - 5.5)</td>
<td align="left">5.3 (5.1 - 5.5)</td>
<td align="left">5.3 (5.2 - 5.5)</td>
</tr>
<tr class="even">
<td align="left">PA self-efficacy</td>
<td align="left">5.1 (5 - 5.3)</td>
<td align="left">5.3 (5.2 - 5.5)</td>
<td align="left">5.2 (5 - 5.3)</td>
<td align="left">5.3 (5.1 - 5.4)</td>
<td align="left">5.2 (5.1 - 5.4)</td>
</tr>
<tr class="odd">
<td align="left">SB descriptive norm</td>
<td align="left">3.2 (3 - 3.4)</td>
<td align="left">3.4 (3.1 - 3.6)</td>
<td align="left">3.2 (3 - 3.4)</td>
<td align="left">3.3 (3.1 - 3.5)</td>
<td align="left">3.2 (3.1 - 3.4)</td>
</tr>
<tr class="even">
<td align="left">SB injunctive norm</td>
<td align="left">4 (3.8 - 4.1)</td>
<td align="left">4.1 (3.9 - 4.3)</td>
<td align="left">3.9 (3.8 - 4.1)</td>
<td align="left">4.1 (4 - 4.2)</td>
<td align="left">4 (3.9 - 4.1)</td>
</tr>
<tr class="odd">
<td align="left">SB intention</td>
<td align="left">3.8 (3.5 - 4.1)</td>
<td align="left">3.6 (3.3 - 3.9)</td>
<td align="left">3.7 (3.2 - 4.2)</td>
<td align="left">3.7 (3.3 - 4.2)</td>
<td align="left">3.7 (3.4 - 4.1)</td>
</tr>
<tr class="even">
<td align="left">SB outcome expectations</td>
<td align="left">4.5 (4.4 - 4.6)</td>
<td align="left">4.3 (4.2 - 4.4)</td>
<td align="left">4.4 (4.2 - 4.6)</td>
<td align="left">4.4 (4.3 - 4.6)</td>
<td align="left">4.4 (4.3 - 4.5)</td>
</tr>
</tbody>
</table>
<!-- # Visualising random effects using full posterior -->
<!-- <!-- TODO: Delete this section? -->
<p>–&gt;</p>
<!-- ## Using rstanarm -->
<!-- Plot below shows credible intervals deviations   -->
</div>
<div id="using-brms-and-diamondplot" class="section level2">
<h2>Using brms and diamondPlot</h2>
<p>Set Rtools folder, if not in C:/Rtools/:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># For some reason, having BINPREF in .Renviron doesn&#39;t work and I keep needing this:</span>
<span class="kw">Sys.setenv</span>(<span class="st">&quot;BINPREF&quot;</span> =<span class="st"> &quot;C:/HYApp/Rtools3.4/mingw_$(WIN)/bin/&quot;</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># Centre the variable:</span>
df_randeff_plot_brms &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">mvpaAccelerometer_T1_centred =</span> 
                      mvpaAccelerometer_T1 <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(mvpaAccelerometer_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))

m_<span class="dv">1</span> &lt;-<span class="st"> </span>brms<span class="op">::</span><span class="kw">bf</span>(mvpaAccelerometer_T1_centred <span class="op">~</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>group)) 
<span class="kw">get_prior</span>(m_<span class="dv">1</span>, <span class="dt">data =</span> df_randeff_plot_brms)

fit_<span class="dv">1</span> &lt;-<span class="st"> </span>brms<span class="op">::</span><span class="kw">brm</span>(m_<span class="dv">1</span>, df_randeff_plot_brms)

pt &lt;-<span class="st"> </span>brms<span class="op">::</span><span class="kw">ranef</span>(fit_<span class="dv">1</span>, <span class="dt">robust =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>data.frame <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="dt">credintLow =</span> group.<span class="fl">2.5</span>.ile.Intercept,
         <span class="dt">intercept =</span> group.Estimate.Intercept, 
         <span class="dt">credintHigh =</span> group.<span class="fl">97.5</span>.ile.Intercept) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">arrange</span>(intercept)


plot1 &lt;-<span class="st"> </span>userfriendlyscience<span class="op">::</span><span class="kw">diamondPlot</span>(pt, <span class="dt">color =</span> <span class="st">&#39;green&#39;</span>, <span class="dt">alpha=</span>.<span class="dv">3</span>, <span class="dt">yLabels =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">58</span>, <span class="dt">fixedSize =</span> <span class="fl">0.3</span>, <span class="dt">xlab =</span> <span class="ot">NULL</span>) <span class="op">+</span>
<span class="st">  </span>ggplot2<span class="op">::</span><span class="kw">coord_flip</span>(<span class="dt">expand =</span> <span class="ot">TRUE</span>) <span class="op">+</span>
<span class="st">  </span>ggplot2<span class="op">::</span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Deviance from average MVPA&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Group&quot;</span>)


df <span class="op">%&gt;%</span><span class="st"> </span>ggplot2<span class="op">::</span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> group, <span class="dt">y =</span> mvpaAccelerometer_T1_centred)) <span class="op">+</span>
<span class="st">  </span>userfriendlyscience<span class="op">::</span><span class="kw">diamondPlot</span>(pt, <span class="dt">color =</span> <span class="st">&#39;green&#39;</span>, <span class="dt">alpha=</span>.<span class="dv">3</span>, <span class="dt">yLabels =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">58</span>, <span class="dt">fixedSize =</span> <span class="fl">0.3</span>, <span class="dt">xlab =</span> <span class="ot">NULL</span>, <span class="dt">returnLayerOnly =</span> <span class="ot">TRUE</span>) <span class="op">+</span>
<span class="st">  </span>ggplot2<span class="op">::</span><span class="kw">coord_flip</span>(<span class="dt">expand =</span> <span class="ot">TRUE</span>) <span class="op">+</span>
<span class="st">  </span>ggplot2<span class="op">::</span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Deviance from average MVPA&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Group&quot;</span>)
   
<span class="co"># brmstools::forest(fit_1)</span></code></pre></div>
</div>
<div id="random-effects-in-autonomous-motivation" class="section level2">
<h2>Random effects in autonomous motivation</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># Centre the variable:</span>
df_randeff_plot_brms_autonomous &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">PA_autonomous_T1_centred =</span> PA_autonomous_T1 <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(PA_autonomous_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))

m_<span class="dv">1</span> &lt;-<span class="st"> </span>brms<span class="op">::</span><span class="kw">bf</span>(PA_autonomous_T1_centred <span class="op">~</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>group)) 
<span class="kw">get_prior</span>(m_<span class="dv">1</span>, <span class="dt">data =</span> df_randeff_plot_brms_autonomous)
## Found more than one class &quot;family&quot; in cache; using the first, from namespace &#39;lme4&#39;
## Also defined by &#39;MatrixModels&#39;
## Warning: Rows containing NAs were excluded from the model</code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["bound"],"name":[8],"type":["chr"],"align":["left"]}],"data":[{"1":"student_t(3, 0, 10)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","_rn_":"1"},{"1":"student_t(3, 0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"","_rn_":"2"},{"1":"","2":"sd","3":"","4":"group","5":"","6":"","7":"","8":"","_rn_":"3"},{"1":"","2":"sd","3":"Intercept","4":"group","5":"","6":"","7":"","8":"","_rn_":"4"},{"1":"student_t(3, 0, 10)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"","_rn_":"5"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[15],"max":[15]},"pages":{}}}
  </script>
</div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
fit_<span class="dv">1</span> &lt;-<span class="st"> </span>brms<span class="op">::</span><span class="kw">brm</span>(m_<span class="dv">1</span>, df_randeff_plot_brms_autonomous)
## Found more than one class &quot;family&quot; in cache; using the first, from namespace &#39;lme4&#39;
## Also defined by &#39;MatrixModels&#39;
## Warning: Rows containing NAs were excluded from the model
## Compiling the C++ model
## Start sampling
## 
## SAMPLING FOR MODEL &#39;gaussian brms-model&#39; NOW (CHAIN 1).
## 
## Gradient evaluation took 0 seconds
## 1000 transitions using 10 leapfrog steps per transition would take 0 seconds.
## Adjust your expectations accordingly!
## 
## 
## Iteration:    1 / 2000 [  0%]  (Warmup)
## Iteration:  200 / 2000 [ 10%]  (Warmup)
## Iteration:  400 / 2000 [ 20%]  (Warmup)
## Iteration:  600 / 2000 [ 30%]  (Warmup)
## Iteration:  800 / 2000 [ 40%]  (Warmup)
## Iteration: 1000 / 2000 [ 50%]  (Warmup)
## Iteration: 1001 / 2000 [ 50%]  (Sampling)
## Iteration: 1200 / 2000 [ 60%]  (Sampling)
## Iteration: 1400 / 2000 [ 70%]  (Sampling)
## Iteration: 1600 / 2000 [ 80%]  (Sampling)
## Iteration: 1800 / 2000 [ 90%]  (Sampling)
## Iteration: 2000 / 2000 [100%]  (Sampling)
## 
##  Elapsed Time: 1.161 seconds (Warm-up)
##                0.878 seconds (Sampling)
##                2.039 seconds (Total)
## 
## 
## SAMPLING FOR MODEL &#39;gaussian brms-model&#39; NOW (CHAIN 2).
## 
## Gradient evaluation took 0 seconds
## 1000 transitions using 10 leapfrog steps per transition would take 0 seconds.
## Adjust your expectations accordingly!
## 
## 
## Iteration:    1 / 2000 [  0%]  (Warmup)
## Iteration:  200 / 2000 [ 10%]  (Warmup)
## Iteration:  400 / 2000 [ 20%]  (Warmup)
## Iteration:  600 / 2000 [ 30%]  (Warmup)
## Iteration:  800 / 2000 [ 40%]  (Warmup)
## Iteration: 1000 / 2000 [ 50%]  (Warmup)
## Iteration: 1001 / 2000 [ 50%]  (Sampling)
## Iteration: 1200 / 2000 [ 60%]  (Sampling)
## Iteration: 1400 / 2000 [ 70%]  (Sampling)
## Iteration: 1600 / 2000 [ 80%]  (Sampling)
## Iteration: 1800 / 2000 [ 90%]  (Sampling)
## Iteration: 2000 / 2000 [100%]  (Sampling)
## 
##  Elapsed Time: 1.199 seconds (Warm-up)
##                0.984 seconds (Sampling)
##                2.183 seconds (Total)
## 
## 
## SAMPLING FOR MODEL &#39;gaussian brms-model&#39; NOW (CHAIN 3).
## 
## Gradient evaluation took 0 seconds
## 1000 transitions using 10 leapfrog steps per transition would take 0 seconds.
## Adjust your expectations accordingly!
## 
## 
## Iteration:    1 / 2000 [  0%]  (Warmup)
## Iteration:  200 / 2000 [ 10%]  (Warmup)
## Iteration:  400 / 2000 [ 20%]  (Warmup)
## Iteration:  600 / 2000 [ 30%]  (Warmup)
## Iteration:  800 / 2000 [ 40%]  (Warmup)
## Iteration: 1000 / 2000 [ 50%]  (Warmup)
## Iteration: 1001 / 2000 [ 50%]  (Sampling)
## Iteration: 1200 / 2000 [ 60%]  (Sampling)
## Iteration: 1400 / 2000 [ 70%]  (Sampling)
## Iteration: 1600 / 2000 [ 80%]  (Sampling)
## Iteration: 1800 / 2000 [ 90%]  (Sampling)
## Iteration: 2000 / 2000 [100%]  (Sampling)
## 
##  Elapsed Time: 1.113 seconds (Warm-up)
##                1.018 seconds (Sampling)
##                2.131 seconds (Total)
## 
## 
## SAMPLING FOR MODEL &#39;gaussian brms-model&#39; NOW (CHAIN 4).
## 
## Gradient evaluation took 0 seconds
## 1000 transitions using 10 leapfrog steps per transition would take 0 seconds.
## Adjust your expectations accordingly!
## 
## 
## Iteration:    1 / 2000 [  0%]  (Warmup)
## Iteration:  200 / 2000 [ 10%]  (Warmup)
## Iteration:  400 / 2000 [ 20%]  (Warmup)
## Iteration:  600 / 2000 [ 30%]  (Warmup)
## Iteration:  800 / 2000 [ 40%]  (Warmup)
## Iteration: 1000 / 2000 [ 50%]  (Warmup)
## Iteration: 1001 / 2000 [ 50%]  (Sampling)
## Iteration: 1200 / 2000 [ 60%]  (Sampling)
## Iteration: 1400 / 2000 [ 70%]  (Sampling)
## Iteration: 1600 / 2000 [ 80%]  (Sampling)
## Iteration: 1800 / 2000 [ 90%]  (Sampling)
## Iteration: 2000 / 2000 [100%]  (Sampling)
## 
##  Elapsed Time: 1.118 seconds (Warm-up)
##                0.985 seconds (Sampling)
##                2.103 seconds (Total)

pt &lt;-<span class="st"> </span>brms<span class="op">::</span><span class="kw">ranef</span>(fit_<span class="dv">1</span>, <span class="dt">robust =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>data.frame <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="dt">credintLow =</span> group.<span class="fl">2.5</span>.ile.Intercept,
         <span class="dt">intercept =</span> group.Estimate.Intercept, 
         <span class="dt">credintHigh =</span> group.<span class="fl">97.5</span>.ile.Intercept) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">arrange</span>(intercept)


plot1 &lt;-<span class="st"> </span>userfriendlyscience<span class="op">::</span><span class="kw">diamondPlot</span>(pt, <span class="dt">color =</span> <span class="st">&#39;blue&#39;</span>, <span class="dt">alpha=</span>.<span class="dv">3</span>, <span class="dt">yLabels =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">59</span>, <span class="dt">fixedSize =</span> <span class="fl">0.3</span>, <span class="dt">xlab =</span> <span class="ot">NULL</span>) <span class="op">+</span>
<span class="st">  </span>ggplot2<span class="op">::</span><span class="kw">coord_flip</span>(<span class="dt">expand =</span> <span class="ot">TRUE</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Deviance from average motivation&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Group&quot;</span>)


df_randeff_plot_brms_autonomous <span class="op">%&gt;%</span><span class="st"> </span>ggplot2<span class="op">::</span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> group, <span class="dt">y =</span> PA_autonomous_T1_centred)) <span class="op">+</span>
<span class="st">  </span>userfriendlyscience<span class="op">::</span><span class="kw">diamondPlot</span>(pt, <span class="dt">color =</span> <span class="st">&#39;blue&#39;</span>, <span class="dt">alpha=</span>.<span class="dv">3</span>, <span class="dt">yLabels =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">59</span>, <span class="dt">fixedSize =</span> <span class="fl">0.3</span>, <span class="dt">xlab =</span> <span class="ot">NULL</span>, <span class="dt">returnLayerOnly =</span> <span class="ot">TRUE</span>) <span class="op">+</span>
<span class="st">  </span>ggplot2<span class="op">::</span><span class="kw">coord_flip</span>(<span class="dt">expand =</span> <span class="ot">TRUE</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Deviance from average motivation&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Group&quot;</span>)</code></pre></div>
<p><img src="baseline-supplement_files/figure-html/randeff-plot-brms-autonomous-1.png" width="3600" /></p>
</div>
</div>
<div id="primary-outcome-variables" class="section level1">
<h1>Primary outcome variables</h1>
<div id="self-reported-vs.accelerometer-measured-mvpa" class="section level2">
<h2>Self-reported vs. accelerometer-measured MVPA</h2>
<!-- TODO: Change Red line for the decided cutoff -->
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
lmi <span class="op">%&gt;%</span><span class="st"> </span>ggplot2<span class="op">::</span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> LiikuntaT1_ka, <span class="dt">y =</span> Kys0045.<span class="dv">1</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;loess&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="dv">120</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;accelerometer-measured MVPA&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;self-reported MVPA days last week&quot;</span>)
## Don&#39;t know how to automatically pick scale for object of type labelled. Defaulting to continuous.
## Warning: Removed 459 rows containing non-finite values (stat_smooth).
## Warning: Removed 459 rows containing missing values (geom_point).</code></pre></div>
<p><img src="baseline-supplement_files/figure-html/mvpa-accelerometer-selfreport-scatterplot-1.png" width="2100" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
corrgram<span class="op">::</span><span class="kw">corrgram</span>(<span class="kw">data.frame</span>(<span class="st">&quot;Self-rep PA&quot;</span> =<span class="st"> </span>df<span class="op">$</span>padaysLastweek_T1, 
                              <span class="st">&quot;Accelerometer PA&quot;</span> =<span class="st"> </span>df<span class="op">$</span>mvpaAccelerometer_T1, 
                              <span class="st">&quot;Sedentary time&quot;</span> =<span class="st"> </span>df<span class="op">$</span>sitLieAccelerometer_T1, 
                              <span class="st">&quot;Interrupted sitting&quot;</span> =<span class="st"> </span>df<span class="op">$</span>sitBreaksAccelerometer_T1), 
                   <span class="dt">lower.panel =</span> corrgram<span class="op">::</span>panel.pie, <span class="dt">upper.panel =</span> corrgram<span class="op">::</span>panel.conf)</code></pre></div>
<p><img src="baseline-supplement_files/figure-html/mvpa-accelerometer-selfreport-scatterplot-2.png" width="2100" /></p>
<p>This section reports the primary outcome variables.</p>
</div>
<div id="accelerometer-measured-mvpa" class="section level2">
<h2>Accelerometer-measured MVPA</h2>
<p>Contrary to some other findings, in our sample girls were more active than boys.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
MVPAgirl_df &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(girl) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(girl, mvpaAccelerometer_T1) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarise</span>(<span class="st">`</span><span class="dt">mean accelerometer-measured MVPA difference between girls and boys</span><span class="st">`</span> =<span class="st"> </span><span class="kw">mean</span>(mvpaAccelerometer_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="st">`</span><span class="dt">median accelerometer-measured MVPA difference between girls and boys</span><span class="st">`</span> =<span class="st"> </span><span class="kw">median</span>(mvpaAccelerometer_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)) 

userfriendlyscience<span class="op">::</span><span class="kw">meanDiff</span>(df<span class="op">$</span>girl, df<span class="op">$</span>mvpaAccelerometer_T1)
## Input variables:
## 
##   girl (grouping variable)
##   mvpaAccelerometer_T1 (dependent variable)
##   Mean 1 (girl) = 190.36, sd = 48.6, n = 425
##   Mean 2 (boy)= 173.55, sd = 59.39, n = 281
## 
## Independent samples t-test (tested for equal variances, p &lt; .001, so unequal variances)
##   (standard deviation used of largest sample, 48.6)
## 
## 95% confidence intervals:
##   Absolute mean difference: [8.45, 25.17] (Absolute mean difference: 16.81)
##   Cohen&#39;s d for difference: [0.19, 0.5] (Cohen&#39;s d point estimate: 0.35)
##   Hedges g for difference:  [0.19, 0.5] (Hedges g point estimate:  0.35)
## 
## Achieved power for d=0.35: 0.9957 (for small: 0.756; medium: 1; large: 1)
## 
## (secondary information (NHST): t[516] = 3.95, p &lt; .001)
## 
## 
## <span class="al">NOTE</span>: because the t-test is based on unequal variances, the NHST p-value may be inconsistent with the confidence interval. Although this is not a problem, if you wish to ensure consistency, you can use parameter &quot;var.equal = &#39;yes&#39;&quot; to force equal variances.</code></pre></div>
<div id="density-plot-by-intervention-and-gender" class="section level3">
<h3>Density plot by intervention and gender</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># Create data frame</span>
densplot &lt;-<span class="st"> </span>d
<span class="kw">levels</span>(densplot<span class="op">$</span>intervention) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Control&quot;</span>, <span class="st">&quot;Intervention&quot;</span>)
<span class="kw">levels</span>(densplot<span class="op">$</span>girl) &lt;-<span class="st"> </span><span class="kw">recode</span>(densplot<span class="op">$</span>girl, <span class="st">&quot;boy&quot;</span> =<span class="st"> &quot;Boys&quot;</span>, <span class="st">&quot;girl&quot;</span> =<span class="st"> &quot;Girls&quot;</span>)

<span class="co"># This gives side-by-side plots. There&#39;s a third plot below the two, which is fake to include x-axis text.</span>
<span class="kw">layout</span>(<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">3</span>), <span class="dt">nrow =</span> <span class="dv">2</span>, <span class="dt">ncol =</span> <span class="dv">2</span>, <span class="dt">byrow =</span> <span class="ot">TRUE</span>),
       <span class="dt">widths =</span> <span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>),<span class="dt">heights =</span> <span class="kw">c</span>(<span class="fl">0.45</span>,<span class="fl">0.05</span>))

<span class="co"># Minimise whitespace; see https://stackoverflow.com/questions/15848942/how-to-reduce-space-gap-between-multiple-graphs-in-r</span>
<span class="kw">par</span>(<span class="dt">mai =</span> <span class="kw">c</span>(<span class="fl">0.3</span>, <span class="fl">0.3</span>, <span class="fl">0.1</span>, <span class="fl">0.0</span>)) 

## Girls vs. boys
<span class="co"># Choose only the variables needed and drop NA</span>
dens &lt;-<span class="st"> </span>densplot <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(mvpaAccelerometer_T1, girl) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="kw">complete.cases</span>(.))

<span class="co"># Set random number generator for reproducibility of bootstrap test of equal densities</span>
<span class="kw">set.seed</span>(<span class="dv">10</span>)

<span class="co"># Make plot</span>
sm.mvpaAccelerometer_T1_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">sm.density.compare2</span>(<span class="kw">as.numeric</span>(dens<span class="op">$</span>mvpaAccelerometer_T1), 
                                               <span class="kw">as.factor</span>(dens<span class="op">$</span>girl), 
                                               <span class="dt">model =</span> <span class="st">&quot;equal&quot;</span>,
                                               <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>,
                                               <span class="dt">col =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end  =</span>  <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">1</span>)], 
                                               <span class="dt">lty =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>), <span class="dt">yaxt =</span> <span class="st">&quot;n&quot;</span>,
                                               <span class="dt">bandcol =</span> <span class="st">&#39;LightGray&#39;</span>, 
                                               <span class="dt">lwd =</span> (<span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>)))
## 
## Test of equal densities:  p-value =  0
<span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="kw">levels</span>(dens<span class="op">$</span>girl), <span class="dt">col =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>)], <span class="dt">lty =</span> <span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">1</span>), <span class="dt">lwd =</span> (<span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>)))
<span class="kw">mtext</span>(<span class="dt">side =</span> <span class="dv">2</span>, <span class="st">&quot;Density&quot;</span>, <span class="dt">line =</span> <span class="fl">0.5</span>)

## Intervention vs. control
<span class="co"># Choose only the variables needed and drop NA</span>
dens &lt;-<span class="st"> </span>densplot <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(mvpaAccelerometer_T1, intervention) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="kw">complete.cases</span>(.))

<span class="co"># Set random number generator for reproducibility of bootstrap test of equal densities</span>
<span class="kw">set.seed</span>(<span class="dv">10</span>)
<span class="co"># Make plot</span>
sm.mvpaAccelerometer_T1_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">sm.density.compare2</span>(<span class="kw">as.numeric</span>(dens<span class="op">$</span>mvpaAccelerometer_T1), 
                                               <span class="kw">as.factor</span>(dens<span class="op">$</span>intervention), 
                                               <span class="dt">model =</span> <span class="st">&quot;equal&quot;</span>, 
                                               <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>,
                                               <span class="dt">col =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">4</span>)], 
                                               <span class="dt">lty =</span> <span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">1</span>), <span class="dt">yaxt =</span> <span class="st">&quot;n&quot;</span>,
                                               <span class="dt">bandcol =</span> <span class="st">&#39;LightGray&#39;</span>, 
                                               <span class="dt">lwd =</span> (<span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>)))
## 
## Test of equal densities:  p-value =  0.25
<span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="kw">levels</span>(dens<span class="op">$</span>intervention), <span class="dt">col =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">4</span>)], <span class="dt">lty=</span><span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">1</span>), <span class="dt">lwd=</span>(<span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>)))

<span class="co"># Create x-axis label. See https://stackoverflow.com/questions/11198767/how-to-annotate-across-or-between-plots-in-multi-plot-panels-in-r</span>
<span class="kw">par</span>(<span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>)) 
<span class="kw">plot</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dt">type =</span> <span class="st">&quot;n&quot;</span>, <span class="dt">frame.plot =</span> <span class="ot">FALSE</span>,<span class="dt">axes =</span> <span class="ot">FALSE</span>) <span class="co"># Fake plot</span>
<span class="kw">text</span>(<span class="dt">x =</span> <span class="fl">1.02</span>, <span class="dt">y =</span> <span class="fl">1.3</span>, <span class="dt">labels =</span> <span class="st">&quot;MVPA minutes&quot;</span>, <span class="dt">pos =</span> <span class="dv">1</span>)</code></pre></div>
<p><img src="baseline-supplement_files/figure-html/MVPA-accelerometer-sm-1.png" width="2100" /></p>
</div>
<div id="data-preparation" class="section level3 tabset">
<h3>Data preparation</h3>
<div id="description-1" class="section level4">
<h4>Description</h4>
<p>The tab “Information on data preparation” of this section present information on data preparation for the plot</p>
</div>
<div id="information-on-data-preparation" class="section level4">
<h4>Information on data preparation</h4>
<p>Prepare data</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m_mvpaAccelerometer_trackgirl &lt;-<span class="st"> </span>brms<span class="op">::</span><span class="kw">bf</span>(mvpaAccelerometer_T1 <span class="op">~</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>track<span class="op">:</span>girl)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>brms<span class="op">::</span><span class="kw">brm</span>(., <span class="dt">data =</span> df, <span class="dt">chains =</span> <span class="dv">4</span>, <span class="dt">iter =</span> <span class="dv">4000</span>, <span class="dt">control =</span> <span class="kw">list</span>(<span class="dt">adapt_delta =</span> <span class="fl">0.95</span>))
## Found more than one class &quot;family&quot; in cache; using the first, from namespace &#39;lme4&#39;
## Also defined by &#39;MatrixModels&#39;
## Warning: Rows containing NAs were excluded from the model
## Compiling the C++ model
## Warning: running command &#39;C:/PROGRA~1/R/R-34~1.3/bin/x64/R CMD SHLIB
## file5d858966d48.cpp 2&gt; file5d858966d48.cpp.err.txt&#39; had status 1
## Error in compileCode(f, code, language = language, verbose = verbose): Compilation ERROR, function(s)/method(s) not created!       0 [main] sh (15296) C:\HYAPP\Rtools3.4\bin\sh.exe: *** fatal error - cygheap base mismatch detected - 0xC77408/0xD27408.
## This problem is probably due to using incompatible versions of the cygwin DLL.
## Search for cygwin1.dll using the Windows Start-&gt;Find/Search facility
## and delete all but the most recent version.  The most recent version *should*
## reside in x:\cygwin\bin, where &#39;x&#39; is the drive on which you have
## installed the cygwin distribution.  Rebooting is also suggested if you
## are unable to find another cygwin DLL.
## make: *** [file5d858966d48.o] Error 127
## Warning message:
## running command &#39;make -f &quot;C:/PROGRA~1/R/R-34~1.3/etc/x64/Makeconf&quot; -f &quot;C:/PROGRA~1/R/R-34~1.3/share/make/winshlib.mk&quot; -f &quot;//ATKK/home/h/hema/Documents/.R/Makevars&quot; SHLIB_LDFLAGS=&#39;$(SHLIB_CXXLDFLAGS)&#39; SHLIB_LD=&#39;$(SHLIB_CXXLD)&#39; SHLIB=&quot;file5d858966d48.dll&quot; WIN=64 TCLBIN=64 OBJECTS=&quot;file5d858966d48.o&quot;&#39; had status 2

brms<span class="op">::</span><span class="kw">prior_summary</span>(m_mvpaAccelerometer_trackgirl, <span class="dt">data =</span> df)
## Error in brms::prior_summary(m_mvpaAccelerometer_trackgirl, data = df): object &#39;m_mvpaAccelerometer_trackgirl&#39; not found

m_mvpaAccelerometer_trackgirl
## Error in eval(expr, envir, enclos): object &#39;m_mvpaAccelerometer_trackgirl&#39; not found

b_intercept &lt;-<span class="st"> </span>brms<span class="op">::</span><span class="kw">fixef</span>(m_mvpaAccelerometer_trackgirl)[<span class="dv">1</span>]
## Error in brms::fixef(m_mvpaAccelerometer_trackgirl): object &#39;m_mvpaAccelerometer_trackgirl&#39; not found

<span class="co"># This gives estimates only:</span>
PA_trackgirl_estimates &lt;-<span class="st"> </span>brms<span class="op">::</span><span class="kw">ranef</span>(m_mvpaAccelerometer_trackgirl)[[<span class="dv">1</span>]][<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]
## Error in brms::ranef(m_mvpaAccelerometer_trackgirl): object &#39;m_mvpaAccelerometer_trackgirl&#39; not found

<span class="co"># The 2.5%ile:</span>
PA_trackgirl_CIL &lt;-<span class="st"> </span>brms<span class="op">::</span><span class="kw">ranef</span>(m_mvpaAccelerometer_trackgirl)[[<span class="dv">1</span>]][<span class="dv">21</span><span class="op">:</span><span class="dv">30</span>]
## Error in brms::ranef(m_mvpaAccelerometer_trackgirl): object &#39;m_mvpaAccelerometer_trackgirl&#39; not found

<span class="co"># The 97.5%ile:</span>
PA_trackgirl_CIH &lt;-<span class="st"> </span>brms<span class="op">::</span><span class="kw">ranef</span>(m_mvpaAccelerometer_trackgirl)[[<span class="dv">1</span>]][<span class="dv">31</span><span class="op">:</span><span class="dv">40</span>]
## Error in brms::ranef(m_mvpaAccelerometer_trackgirl): object &#39;m_mvpaAccelerometer_trackgirl&#39; not found

PA_trackgirl_ci &lt;-<span class="st"> </span><span class="kw">data.frame</span>(PA_trackgirl_CIL, PA_trackgirl_estimates, PA_trackgirl_CIH, <span class="dt">Variable =</span> <span class="kw">labels</span>(brms<span class="op">::</span><span class="kw">ranef</span>(m_mvpaAccelerometer_trackgirl))) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">b_intercept =</span> <span class="kw">rep</span>(b_intercept, <span class="dv">10</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">PA_trackgirl_CIL =</span> PA_trackgirl_CIL <span class="op">+</span><span class="st"> </span>b_intercept,
         <span class="dt">PA_trackgirl_estimates =</span> PA_trackgirl_estimates <span class="op">+</span><span class="st"> </span>b_intercept,
         <span class="dt">PA_trackgirl_CIH =</span> PA_trackgirl_CIH <span class="op">+</span><span class="st"> </span>b_intercept,
         <span class="dt">track =</span> <span class="kw">c</span>(<span class="st">&#39;BA_boy&#39;</span>,
                   <span class="st">&#39;BA_girl&#39;</span>,
                   <span class="st">&#39;HRC_boy&#39;</span>,
                   <span class="st">&#39;HRC_girl&#39;</span>,
                   <span class="st">&#39;IT_boy&#39;</span>,
                   <span class="st">&#39;IT_girl&#39;</span>,
                   <span class="st">&#39;Nur_boy&#39;</span>,
                   <span class="st">&#39;Nur_girl&#39;</span>,
                   <span class="st">&#39;Other_boy&#39;</span>,
                   <span class="st">&#39;Other_girl&#39;</span>
))
## Error in data.frame(PA_trackgirl_CIL, PA_trackgirl_estimates, PA_trackgirl_CIH, : object &#39;PA_trackgirl_CIL&#39; not found

PA_trackgirl_diamonds_girl &lt;-<span class="st"> </span><span class="kw">rbind</span>(
PA_trackgirl_ci <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;Nur_girl&quot;</span>),
PA_trackgirl_ci <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;HRC_girl&quot;</span>),
PA_trackgirl_ci <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;BA_girl&quot;</span>),
PA_trackgirl_ci <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;IT_girl&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">arrange</span>(<span class="op">-</span><span class="kw">row_number</span>()) <span class="co"># reverse order of rows to make them right for the plot to come</span>
## Error in eval(lhs, parent, parent): object &#39;PA_trackgirl_ci&#39; not found

PA_trackgirl_diamonds_boy &lt;-<span class="st"> </span><span class="kw">rbind</span>(
PA_trackgirl_ci <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;Nur_boy&quot;</span>),
PA_trackgirl_ci <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;HRC_boy&quot;</span>),
PA_trackgirl_ci <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;BA_boy&quot;</span>),
PA_trackgirl_ci <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;IT_boy&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">arrange</span>(<span class="op">-</span><span class="kw">row_number</span>()) <span class="co"># reverse order of rows to make them right for the plot to come</span>
## Error in eval(lhs, parent, parent): object &#39;PA_trackgirl_ci&#39; not found


m_mvpaAccelerometer_trackintervention &lt;-<span class="st"> </span>brms<span class="op">::</span><span class="kw">bf</span>(mvpaAccelerometer_T1 <span class="op">~</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>track<span class="op">:</span>intervention)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>brms<span class="op">::</span><span class="kw">brm</span>(., <span class="dt">data =</span> df, <span class="dt">chains =</span> <span class="dv">4</span>, <span class="dt">iter =</span> <span class="dv">4000</span>, <span class="dt">control =</span> <span class="kw">list</span>(<span class="dt">adapt_delta =</span> <span class="fl">0.95</span>))
## Found more than one class &quot;family&quot; in cache; using the first, from namespace &#39;lme4&#39;
## Also defined by &#39;MatrixModels&#39;
## Warning: Rows containing NAs were excluded from the model
## Compiling the C++ model
## Warning: running command &#39;C:/PROGRA~1/R/R-34~1.3/bin/x64/R CMD SHLIB
## file5d8760f7191.cpp 2&gt; file5d8760f7191.cpp.err.txt&#39; had status 1
## Error in compileCode(f, code, language = language, verbose = verbose): Compilation ERROR, function(s)/method(s) not created!       0 [main] make (1288) c:\HYAPP\Rtools3.4\bin\make.exe: *** fatal error - cygheap base mismatch detected - 0xF47408/0xD97408.
## This problem is probably due to using incompatible versions of the cygwin DLL.
## Search for cygwin1.dll using the Windows Start-&gt;Find/Search facility
## and delete all but the most recent version.  The most recent version *should*
## reside in x:\cygwin\bin, where &#39;x&#39; is the drive on which you have
## installed the cygwin distribution.  Rebooting is also suggested if you
## are unable to find another cygwin DLL.
##       1 [main] make 12556 fork: child -1 - forked process 1288 died unexpectedly, retry 0, exit code 0xC0000142, errno 11
## make: vfork: Resource temporarily unavailable
## Warning message:
## running command &#39;make -f &quot;C:/PROGRA~1/R/R-34~1.3/etc/x64/Makeconf&quot; -f &quot;C:/PROGRA~1/R/R-34~1.3/share/make/winshlib.mk&quot; -f &quot;//ATKK/home/h/hema/Documents/.R/Makevars&quot; SHLIB_LDFLAGS=&#39;$(SHLIB_CXXLDFLAGS)&#39; SHLIB_LD=&#39;$(SHLIB_CXXLD)&#39; SHLIB=&quot;file5d8760f7191.dll&quot; WIN=64 TCLBIN=64 OBJECTS=&quot;file5d8760f7191.o&quot;&#39; had status 2

brms<span class="op">::</span><span class="kw">prior_summary</span>(m_mvpaAccelerometer_trackintervention, <span class="dt">data =</span> df)
## Error in brms::prior_summary(m_mvpaAccelerometer_trackintervention, data = df): object &#39;m_mvpaAccelerometer_trackintervention&#39; not found

m_mvpaAccelerometer_trackintervention
## Error in eval(expr, envir, enclos): object &#39;m_mvpaAccelerometer_trackintervention&#39; not found

b_intercept &lt;-<span class="st"> </span>brms<span class="op">::</span><span class="kw">fixef</span>(m_mvpaAccelerometer_trackintervention)[<span class="dv">1</span>]
## Error in brms::fixef(m_mvpaAccelerometer_trackintervention): object &#39;m_mvpaAccelerometer_trackintervention&#39; not found

<span class="co"># This gives estimates only:</span>
PA_trackintervention_estimates &lt;-<span class="st"> </span>brms<span class="op">::</span><span class="kw">ranef</span>(m_mvpaAccelerometer_trackintervention)[[<span class="dv">1</span>]][<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]
## Error in brms::ranef(m_mvpaAccelerometer_trackintervention): object &#39;m_mvpaAccelerometer_trackintervention&#39; not found


<span class="co"># The 2.5%ile:</span>
PA_trackintervention_CIL &lt;-<span class="st"> </span>brms<span class="op">::</span><span class="kw">ranef</span>(m_mvpaAccelerometer_trackintervention)[[<span class="dv">1</span>]][<span class="dv">21</span><span class="op">:</span><span class="dv">30</span>]
## Error in brms::ranef(m_mvpaAccelerometer_trackintervention): object &#39;m_mvpaAccelerometer_trackintervention&#39; not found

<span class="co"># The 97.5%ile:</span>
PA_trackintervention_CIH &lt;-<span class="st"> </span>brms<span class="op">::</span><span class="kw">ranef</span>(m_mvpaAccelerometer_trackintervention)[[<span class="dv">1</span>]][<span class="dv">31</span><span class="op">:</span><span class="dv">40</span>]
## Error in brms::ranef(m_mvpaAccelerometer_trackintervention): object &#39;m_mvpaAccelerometer_trackintervention&#39; not found

PA_trackintervention_ci &lt;-<span class="st"> </span><span class="kw">data.frame</span>(PA_trackintervention_CIL, PA_trackintervention_estimates, PA_trackintervention_CIH, <span class="dt">Variable =</span> <span class="kw">labels</span>(brms<span class="op">::</span><span class="kw">ranef</span>(m_mvpaAccelerometer_trackintervention))) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">b_intercept =</span> <span class="kw">rep</span>(b_intercept, <span class="dv">10</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">PA_trackintervention_CIL =</span> PA_trackintervention_CIL <span class="op">+</span><span class="st"> </span>b_intercept,
         <span class="dt">PA_trackintervention_estimates =</span> PA_trackintervention_estimates <span class="op">+</span><span class="st"> </span>b_intercept,
         <span class="dt">PA_trackintervention_CIH =</span> PA_trackintervention_CIH <span class="op">+</span><span class="st"> </span>b_intercept,
         <span class="dt">track =</span> <span class="kw">c</span>(<span class="st">&#39;BA_control&#39;</span>,
                   <span class="st">&#39;BA_intervention&#39;</span>,
                   <span class="st">&#39;HRC_control&#39;</span>,
                   <span class="st">&#39;HRC_intervention&#39;</span>,
                   <span class="st">&#39;IT_control&#39;</span>,
                   <span class="st">&#39;IT_intervention&#39;</span>,
                   <span class="st">&#39;Nur_control&#39;</span>,
                   <span class="st">&#39;Nur_intervention&#39;</span>,
                   <span class="st">&#39;Other_control&#39;</span>,
                   <span class="st">&#39;Other_intervention&#39;</span>
))
## Error in data.frame(PA_trackintervention_CIL, PA_trackintervention_estimates, : object &#39;PA_trackintervention_CIL&#39; not found

PA_trackintervention_diamonds_intervention &lt;-<span class="st"> </span><span class="kw">rbind</span>(
PA_trackintervention_ci <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;Nur_intervention&quot;</span>),
PA_trackintervention_ci <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;HRC_intervention&quot;</span>),
PA_trackintervention_ci <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;BA_intervention&quot;</span>),
PA_trackintervention_ci <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;IT_intervention&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">arrange</span>(<span class="op">-</span><span class="kw">row_number</span>()) <span class="co"># reverse order of rows to make them right for the plot to come</span>
## Error in eval(lhs, parent, parent): object &#39;PA_trackintervention_ci&#39; not found

PA_trackintervention_diamonds_control &lt;-<span class="st"> </span><span class="kw">rbind</span>(
PA_trackintervention_ci <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;Nur_control&quot;</span>),
PA_trackintervention_ci <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;HRC_control&quot;</span>),
PA_trackintervention_ci <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;BA_control&quot;</span>),
PA_trackintervention_ci <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;IT_control&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">arrange</span>(<span class="op">-</span><span class="kw">row_number</span>()) <span class="co"># reverse order of rows to make them right for the plot to come</span>
## Error in eval(lhs, parent, parent): object &#39;PA_trackintervention_ci&#39; not found

PA_trackgirl_diamonds_girl
## Error in eval(expr, envir, enclos): object &#39;PA_trackgirl_diamonds_girl&#39; not found
PA_trackgirl_diamonds_boy
## Error in eval(expr, envir, enclos): object &#39;PA_trackgirl_diamonds_boy&#39; not found
PA_trackintervention_diamonds_intervention
## Error in eval(expr, envir, enclos): object &#39;PA_trackintervention_diamonds_intervention&#39; not found
PA_trackintervention_diamonds_control
## Error in eval(expr, envir, enclos): object &#39;PA_trackintervention_diamonds_control&#39; not found</code></pre></div>
</div>
<div id="density-plot-of-girls-and-boys-in-different-educational-tracks-and-schools" class="section level4">
<h4>Density plot of girls and boys in different educational tracks and schools</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(mvpaAccelerometer_T1, girl, trackSchool) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(girl, trackSchool) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarise</span>(<span class="dt">mean =</span> <span class="kw">mean</span>(mvpaAccelerometer_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),
            <span class="dt">median =</span> <span class="kw">median</span>(mvpaAccelerometer_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),
            <span class="dt">max =</span> <span class="kw">max</span>(mvpaAccelerometer_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),
            <span class="dt">min =</span> <span class="kw">min</span>(mvpaAccelerometer_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),
            <span class="dt">sd =</span> <span class="kw">sd</span>(mvpaAccelerometer_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),
            <span class="dt">n =</span> <span class="kw">n</span>()) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>DT<span class="op">::</span><span class="kw">datatable</span>() <span class="co">#papaja::apa_table()</span></code></pre></div>
<div id="htmlwidget-3189eb5c9b06c86eb0e0" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-3189eb5c9b06c86eb0e0">{"x":{"filter":"none","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29"],["girl","girl","girl","girl","girl","girl","girl","girl","girl","girl","girl","girl","girl","boy","boy","boy","boy","boy","boy","boy","boy","boy","boy","boy","boy","boy","boy","boy",null],["BA1","BA2","BA4","HRC1","HRC5","IT1","IT2","Nur3","Nur4","Other1","Other3","Other4","Other5","BA1","BA2","BA4","HRC1","HRC2","HRC5","IT1","IT2","Nur2","Nur3","Nur4","Other2","Other3","Other4","Other5","NANA"],[179.114693877551,179.109285714286,null,169.163942857143,191.107219887955,134.111904761905,113.802251082251,198.281650579151,202.734261904762,141.585714285714,193.622142857143,189.892619047619,197.85,181.617916666667,178.393814935065,null,187.730634920635,null,175.26378968254,145.830216450216,145.481544566545,210.414285714286,180.954871794872,207.458268983269,104.478571428571,262.071428571429,219.714285714286,217.428571428571,193.574591836735],[171.716666666667,185.75,null,176.08,182.471428571429,135.477380952381,113.785714285714,203.179761904762,200.882142857143,141.585714285714,186.851428571429,201.166666666667,197.85,193.6625,169.063095238095,null,184.91,null,174.414285714286,136.501785714286,139.871428571429,210.414285714286,169.942857142857,205.775,104.478571428571,262.071428571429,219.714285714286,217.428571428571,161.65],[284.483333333333,288.42,null,290.185714285714,367.214285714286,197.4,178.383333333333,307.55,338.75,141.585714285714,243.785714285714,264.471428571429,197.85,284.185714285714,273.183333333333,null,320.24,null,297.56,366.98,284.1,210.414285714286,263.483333333333,342.357142857143,135.571428571429,262.071428571429,219.714285714286,217.428571428571,291.34],[99.14,71.2,null,76.0428571428571,106.15,76.15,75.6666666666667,92.1333333333333,103.65,141.585714285714,157,101.65,197.85,83.22,91.7,null,109.125,null,66.4857142857143,69.8428571428571,67.5714285714286,210.414285714286,85.775,61.525,73.3857142857143,262.071428571429,219.714285714286,217.428571428571,137.6],[42.6877334575207,44.9505369225851,null,52.5520436559175,47.831277852254,48.3783795147208,27.0470458558404,48.3507710567373,43.3270912454487,null,39.2725578229784,64.3310939390299,null,53.561715220555,51.2932382864237,null,65.8368234788884,null,51.4453944469,57.5575642106559,49.3043653636569,null,51.4977379558124,70.345806474678,43.9719402643577,null,null,null,65.9107825429033],[56,53,1,39,90,12,14,104,227,1,7,7,2,93,78,1,28,1,55,64,73,1,20,50,3,1,2,1,81]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>girl<\/th>\n      <th>trackSchool<\/th>\n      <th>mean<\/th>\n      <th>median<\/th>\n      <th>max<\/th>\n      <th>min<\/th>\n      <th>sd<\/th>\n      <th>n<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-center","targets":"_all"},{"className":"dt-right","targets":[3,4,5,6,7,8]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(mvpaAccelerometer_T1, girl, trackSchool) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(girl) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarise</span>(<span class="dt">mean =</span> <span class="kw">mean</span>(mvpaAccelerometer_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),
            <span class="dt">median =</span> <span class="kw">median</span>(mvpaAccelerometer_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),
            <span class="dt">max =</span> <span class="kw">max</span>(mvpaAccelerometer_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),
            <span class="dt">min =</span> <span class="kw">min</span>(mvpaAccelerometer_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),
            <span class="dt">sd =</span> <span class="kw">sd</span>(mvpaAccelerometer_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),
            <span class="dt">n =</span> <span class="kw">n</span>()) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>DT<span class="op">::</span><span class="kw">datatable</span>() <span class="co">#papaja::apa_table()</span></code></pre></div>
<div id="htmlwidget-6c5b06b50212cbf5124f" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-6c5b06b50212cbf5124f">{"x":{"filter":"none","data":[["1","2","3"],["girl","boy",null],[190.35868627451,173.546009998305,193.574591836735],[189.185714285714,164.657142857143,161.65],[367.214285714286,366.98,291.34],[71.2,61.525,137.6],[48.600141404636,59.3942453285483,65.9107825429033],[613,471,81]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>girl<\/th>\n      <th>mean<\/th>\n      <th>median<\/th>\n      <th>max<\/th>\n      <th>min<\/th>\n      <th>sd<\/th>\n      <th>n<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-center","targets":"_all"},{"className":"dt-right","targets":[2,3,4,5,6,7]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
plot1 &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(id,
                              <span class="dt">trackSchool =</span> trackSchool,
                              girl,
                              <span class="dt">PA =</span> mvpaAccelerometer_T1)  <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(trackSchool), <span class="op">!</span><span class="kw">grepl</span>(<span class="st">&#39;Other|NANA|BA4|HRC2|Nur2&#39;</span>, trackSchool)) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># Drop categories with just few participants</span>
<span class="st">  </span>ggplot2<span class="op">::</span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">y =</span> trackSchool)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">geom_density_ridges2</span>(<span class="kw">aes</span>(<span class="dt">x =</span> PA, <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>, 
                                    <span class="dt">fill =</span> <span class="kw">paste</span>(trackSchool, girl)),
                                  <span class="dt">scale =</span> <span class="dv">1</span>,
                                  <span class="dt">alpha =</span> <span class="fl">0.6</span>, <span class="dt">size =</span> <span class="fl">0.25</span>,
                                  <span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">450</span>,
                                  <span class="dt">jittered_points=</span><span class="ot">TRUE</span>, <span class="dt">point_shape=</span><span class="dv">21</span>,
                                  <span class="dt">point_fill=</span><span class="st">&quot;black&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;&quot;</span>,
       <span class="dt">y =</span> <span class="st">&quot;&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_discrete</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_fill_cyclical</span>(
                                <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&#39;BA1 boy&#39;</span> =<span class="st"> &quot;Boy&quot;</span>, <span class="st">&#39;BA1 girl&#39;</span> =<span class="st"> &quot;Girl&quot;</span>),
                                <span class="dt">values =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>)],
                                <span class="dt">name =</span> <span class="st">&quot;&quot;</span>, <span class="dt">guide =</span> <span class="kw">guide_legend</span>(<span class="dt">override.aes =</span> <span class="kw">list</span>(<span class="dt">alpha =</span> <span class="dv">1</span>))) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_colour_cyclical</span>(<span class="dt">values =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">theme_ridges</span>(<span class="dt">grid =</span> <span class="ot">FALSE</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">&quot;bottom&quot;</span>, <span class="dt">axis.text=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">10</span>))

plot1
## Picking joint bandwidth of 20.3
## Warning: Removed 367 rows containing non-finite values
## (stat_density_ridges).</code></pre></div>
<p><img src="baseline-supplement_files/figure-html/mvpa-trackshool-density-1.png" width="2100" /></p>
</div>
</div>
<div id="density-plot-by-track" class="section level3">
<h3>Density plot by track</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
plot1 &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(id,
                              <span class="dt">track =</span> track,
                              girl,
                              <span class="dt">PA =</span> mvpaAccelerometer_T1)  <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(track), track <span class="op">!=</span><span class="st"> &quot;Other&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># Drop category &quot;Other&quot;</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">track =</span> <span class="kw">factor</span>(track, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;IT&quot;</span>, <span class="st">&quot;BA&quot;</span>, <span class="st">&quot;HRC&quot;</span>, <span class="st">&quot;Nur&quot;</span>)),
                <span class="dt">track =</span> <span class="kw">recode_factor</span>(track, <span class="st">&quot;IT&quot;</span> =<span class="st"> &quot;IT&quot;</span>, <span class="st">&quot;BA&quot;</span> =<span class="st"> &quot;BA&quot;</span>, 
                                      <span class="st">&quot;HRC&quot;</span> =<span class="st"> &quot;HRC&quot;</span>, <span class="st">&quot;Nur&quot;</span> =<span class="st"> &quot;Nur&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>ggplot2<span class="op">::</span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">y =</span> track)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">geom_density_ridges2</span>(<span class="kw">aes</span>(<span class="dt">x =</span> PA, <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>, 
                                    <span class="dt">fill =</span> <span class="kw">paste</span>(track, girl),
                                    <span class="dt">point_color =</span> girl,
                                    <span class="dt">point_fill =</span> girl,
                                    <span class="dt">point_shape =</span> girl),
                                  <span class="dt">scale =</span> .<span class="dv">75</span>, <span class="dt">alpha =</span> <span class="fl">0.6</span>, <span class="dt">size =</span> <span class="fl">0.25</span>,
                                  <span class="dt">position =</span> <span class="kw">position_raincloud</span>(<span class="dt">width =</span> <span class="fl">0.05</span>, <span class="dt">height =</span> <span class="fl">0.15</span>),
                                  <span class="co"># from = 0, to = 450,</span>
                                  <span class="dt">jittered_points =</span> <span class="ot">TRUE</span>,
                                  <span class="dt">point_size =</span> <span class="dv">1</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="ot">NULL</span>,
       <span class="dt">y =</span> <span class="ot">NULL</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_discrete</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.1</span>, <span class="dv">0</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_fill_cyclical</span>(
                                <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&#39;BA boy&#39;</span> =<span class="st"> &quot;Boy&quot;</span>, <span class="st">&#39;BA girl&#39;</span> =<span class="st"> &quot;Girl&quot;</span>),
                                <span class="dt">values =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>)],
                                <span class="dt">name =</span> <span class="st">&quot;&quot;</span>, 
                                <span class="dt">guide =</span> <span class="kw">guide_legend</span>(<span class="dt">override.aes =</span> <span class="kw">list</span>(<span class="dt">alpha =</span> <span class="dv">1</span>, 
                                                                         <span class="dt">point_shape =</span> <span class="kw">c</span>(<span class="dv">24</span>, <span class="dv">4</span>),
                                                                         <span class="dt">point_size =</span> <span class="dv">2</span>))) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_colour_cyclical</span>(<span class="dt">values =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">theme_ridges</span>(<span class="dt">grid =</span> <span class="ot">FALSE</span>) <span class="op">+</span>
<span class="st">  </span><span class="co"># ggplot2::scale_fill_manual(values = c(&quot;#A0FFA0&quot;, &quot;#A0A0FF&quot;)) +</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_discrete_manual</span>(<span class="dt">aesthetics =</span> <span class="st">&quot;point_color&quot;</span>, 
                                  <span class="dt">values =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">1</span>)],
                                  <span class="dt">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_discrete_manual</span>(<span class="dt">aesthetics =</span> <span class="st">&quot;point_fill&quot;</span>,
                                  <span class="dt">values =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">1</span>)],
                                  <span class="dt">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_discrete_manual</span>(<span class="dt">aesthetics =</span> <span class="st">&quot;point_shape&quot;</span>, 
                                  <span class="dt">values =</span> <span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">24</span>),
                                  <span class="dt">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>papaja<span class="op">::</span><span class="kw">theme_apa</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)

plot1 &lt;-<span class="st"> </span>plot1 <span class="op">+</span><span class="st"> </span>
<span class="st">  </span>userfriendlyscience<span class="op">::</span><span class="kw">diamondPlot</span>(PA_trackgirl_diamonds_girl, 
                                   <span class="dt">returnLayerOnly =</span> <span class="ot">TRUE</span>, 
                                   <span class="dt">lineColor =</span> <span class="st">&quot;black&quot;</span>, 
                                   <span class="dt">color=</span>viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">3</span>],
                                   <span class="dt">alpha=</span>.<span class="dv">6</span>, 
                                   <span class="dt">fixedSize =</span> <span class="fl">0.1</span>, 
                                   <span class="dt">otherAxisCol =</span> (<span class="dv">1</span><span class="op">:</span><span class="dv">4</span> <span class="op">+</span><span class="st"> </span>.<span class="dv">15</span>)) <span class="op">+</span><span class="st"> </span><span class="co"># specify y-position; option to move the diamond </span>
<span class="st">  </span>userfriendlyscience<span class="op">::</span><span class="kw">diamondPlot</span>(PA_trackgirl_diamonds_boy, 
                                   <span class="dt">returnLayerOnly =</span> <span class="ot">TRUE</span>, 
                                   <span class="dt">lineColor =</span> <span class="st">&quot;black&quot;</span>, 
                                   <span class="dt">linetype =</span> <span class="st">&quot;solid&quot;</span>, 
                                   <span class="dt">color=</span>viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">1</span>],
                                   <span class="dt">alpha=</span>.<span class="dv">6</span>, 
                                   <span class="dt">fixedSize =</span> <span class="fl">0.1</span>, 
                                   <span class="dt">otherAxisCol =</span> (<span class="dv">1</span><span class="op">:</span><span class="dv">4</span> <span class="op">+</span><span class="st"> </span>.<span class="dv">15</span>))
## Error in nrow(data): object &#39;PA_trackgirl_diamonds_girl&#39; not found

<span class="co"># Draw plot with intervention and control densities</span>

plot2 &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(id,
                              <span class="dt">track =</span> track,
                              intervention,
                              <span class="dt">PA =</span> mvpaAccelerometer_T1)  <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(track), track <span class="op">!=</span><span class="st"> &quot;Other&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># Drop category &quot;Other&quot;</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">track =</span> <span class="kw">factor</span>(track, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;IT&quot;</span>, <span class="st">&quot;BA&quot;</span>, <span class="st">&quot;HRC&quot;</span>, <span class="st">&quot;Nur&quot;</span>)),
                <span class="dt">track =</span> <span class="kw">recode_factor</span>(track, <span class="st">&quot;IT&quot;</span> =<span class="st"> &quot;IT&quot;</span>, <span class="st">&quot;BA&quot;</span> =<span class="st"> &quot;BA&quot;</span>, 
                                      <span class="st">&quot;HRC&quot;</span> =<span class="st"> &quot;HRC&quot;</span>, <span class="st">&quot;Nur&quot;</span> =<span class="st"> &quot;Nur&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>ggplot2<span class="op">::</span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">y =</span> track)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">geom_density_ridges2</span>(<span class="kw">aes</span>(<span class="dt">x =</span> PA, <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>, 
                                    <span class="dt">fill =</span> <span class="kw">paste</span>(track, intervention),
                                    <span class="dt">point_color =</span> intervention,
                                    <span class="dt">point_fill =</span> intervention,
                                    <span class="dt">point_shape =</span> intervention),
                                  <span class="dt">scale =</span> .<span class="dv">75</span>, <span class="dt">alpha =</span> <span class="fl">0.6</span>, <span class="dt">size =</span> <span class="fl">0.25</span>,
                                  <span class="dt">position =</span> <span class="kw">position_raincloud</span>(<span class="dt">width =</span> <span class="fl">0.05</span>, <span class="dt">height =</span> <span class="fl">0.15</span>),
                                  <span class="co"># from = 0, to = 450,</span>
                                  <span class="dt">jittered_points =</span> <span class="ot">TRUE</span>,
                                  <span class="dt">point_size =</span> <span class="dv">1</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="ot">NULL</span>,
       <span class="dt">y =</span> <span class="ot">NULL</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_discrete</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.1</span>, <span class="dv">0</span>), <span class="dt">labels =</span> <span class="ot">NULL</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_fill_cyclical</span>(
                                <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&#39;BA 0&#39;</span> =<span class="st"> &quot;Control&quot;</span>, <span class="st">&#39;BA 1&#39;</span> =<span class="st"> &quot;Intervention&quot;</span>),
                                <span class="dt">values =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">4</span>)],
                                <span class="dt">name =</span> <span class="st">&quot;&quot;</span>, 
                                <span class="dt">guide =</span> <span class="kw">guide_legend</span>(<span class="dt">override.aes =</span> <span class="kw">list</span>(<span class="dt">alpha =</span> <span class="dv">1</span>, 
                                                                         <span class="dt">point_shape =</span> <span class="kw">c</span>(<span class="dv">21</span>, <span class="dv">3</span>),
                                                                         <span class="dt">point_size =</span> <span class="dv">2</span>))) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_colour_cyclical</span>(<span class="dt">values =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">theme_ridges</span>(<span class="dt">grid =</span> <span class="ot">FALSE</span>) <span class="op">+</span>
<span class="st">  </span><span class="co"># ggplot2::scale_fill_manual(values = c(&quot;#A0FFA0&quot;, &quot;#A0A0FF&quot;)) +</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_discrete_manual</span>(<span class="dt">aesthetics =</span> <span class="st">&quot;point_color&quot;</span>, 
                                  <span class="dt">values =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">4</span>)],
                                  <span class="dt">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_discrete_manual</span>(<span class="dt">aesthetics =</span> <span class="st">&quot;point_fill&quot;</span>,
                                  <span class="dt">values =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">4</span>)],
                                  <span class="dt">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_discrete_manual</span>(<span class="dt">aesthetics =</span> <span class="st">&quot;point_shape&quot;</span>, 
                                  <span class="dt">values =</span> <span class="kw">c</span>(<span class="dv">21</span>, <span class="dv">3</span>),
                                  <span class="dt">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>papaja<span class="op">::</span><span class="kw">theme_apa</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)

plot2 &lt;-<span class="st"> </span>plot2 <span class="op">+</span><span class="st"> </span>
<span class="st">  </span>userfriendlyscience<span class="op">::</span><span class="kw">diamondPlot</span>(PA_trackintervention_diamonds_intervention, 
                                   <span class="dt">returnLayerOnly =</span> <span class="ot">TRUE</span>, 
                                   <span class="dt">lineColor =</span> <span class="st">&quot;black&quot;</span>,  
                                   <span class="dt">color=</span>viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">4</span>],
                                   <span class="dt">alpha=</span>.<span class="dv">6</span>, 
                                   <span class="dt">fixedSize =</span> <span class="fl">0.1</span>, 
                                   <span class="dt">otherAxisCol =</span> (<span class="dv">1</span><span class="op">:</span><span class="dv">4</span> <span class="op">+</span><span class="st"> </span>.<span class="dv">15</span>)) <span class="op">+</span>
<span class="st">  </span>userfriendlyscience<span class="op">::</span><span class="kw">diamondPlot</span>(PA_trackintervention_diamonds_control, 
                                   <span class="dt">returnLayerOnly =</span> <span class="ot">TRUE</span>, 
                                   <span class="dt">lineColor =</span> <span class="st">&quot;black&quot;</span>,  
                                   <span class="dt">color=</span>viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">2</span>],
                                   <span class="dt">alpha=</span>.<span class="dv">6</span>, 
                                   <span class="dt">fixedSize =</span> <span class="fl">0.1</span>, 
                                   <span class="dt">otherAxisCol =</span> (<span class="dv">1</span><span class="op">:</span><span class="dv">4</span> <span class="op">+</span><span class="st"> </span>.<span class="dv">15</span>))
## Error in nrow(data): object &#39;PA_trackintervention_diamonds_intervention&#39; not found

plot1 <span class="op">+</span><span class="st"> </span>plot2
## Picking joint bandwidth of 18.1
## Warning: Removed 370 rows containing non-finite values
## (stat_density_ridges).
## Picking joint bandwidth of 17.4
## Warning: Removed 370 rows containing non-finite values
## (stat_density_ridges).</code></pre></div>
<p><img src="baseline-supplement_files/figure-html/MVPA-accelerometer-plot-1.png" width="2100" /></p>
</div>
</div>
<div id="self-reported-mvpa-days-previous-week" class="section level2">
<h2>Self-reported MVPA days, previous week</h2>
<p>Description</p>
<p>This section reports the question on how many days the participants did MVPA during the previous week.</p>
<div id="data-preparation-1" class="section level3 tabset">
<h3>Data preparation</h3>
<div id="description-2" class="section level4">
<h4>Description</h4>
<p>The tab “Information on data preparation” of this section present information on data preparation for the plot</p>
</div>
<div id="information-on-data-preparation-1" class="section level4">
<h4>Information on data preparation</h4>
<p>Code chunk below prepares data.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m_padaysLastweek_trackgirl &lt;-<span class="st"> </span>brms<span class="op">::</span><span class="kw">bf</span>(padaysLastweek_T1 <span class="op">~</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>track<span class="op">:</span>girl)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>brms<span class="op">::</span><span class="kw">brm</span>(., <span class="dt">data =</span> df, <span class="dt">chains =</span> <span class="dv">4</span>, <span class="dt">iter =</span> <span class="dv">4000</span>, <span class="dt">control =</span> <span class="kw">list</span>(<span class="dt">adapt_delta =</span> <span class="fl">0.95</span>))
## Found more than one class &quot;family&quot; in cache; using the first, from namespace &#39;lme4&#39;
## Also defined by &#39;MatrixModels&#39;
## Warning: Rows containing NAs were excluded from the model
## Compiling the C++ model
## Start sampling
## 
## SAMPLING FOR MODEL &#39;gaussian brms-model&#39; NOW (CHAIN 1).
## 
## Gradient evaluation took 0 seconds
## 1000 transitions using 10 leapfrog steps per transition would take 0 seconds.
## Adjust your expectations accordingly!
## 
## 
## Iteration:    1 / 4000 [  0%]  (Warmup)
## Iteration:  400 / 4000 [ 10%]  (Warmup)
## Iteration:  800 / 4000 [ 20%]  (Warmup)
## Iteration: 1200 / 4000 [ 30%]  (Warmup)
## Iteration: 1600 / 4000 [ 40%]  (Warmup)
## Iteration: 2000 / 4000 [ 50%]  (Warmup)
## Iteration: 2001 / 4000 [ 50%]  (Sampling)
## Iteration: 2400 / 4000 [ 60%]  (Sampling)
## Iteration: 2800 / 4000 [ 70%]  (Sampling)
## Iteration: 3200 / 4000 [ 80%]  (Sampling)
## Iteration: 3600 / 4000 [ 90%]  (Sampling)
## Iteration: 4000 / 4000 [100%]  (Sampling)
## 
##  Elapsed Time: 2.587 seconds (Warm-up)
##                2.15 seconds (Sampling)
##                4.737 seconds (Total)
## 
## 
## SAMPLING FOR MODEL &#39;gaussian brms-model&#39; NOW (CHAIN 2).
## 
## Gradient evaluation took 0 seconds
## 1000 transitions using 10 leapfrog steps per transition would take 0 seconds.
## Adjust your expectations accordingly!
## 
## 
## Iteration:    1 / 4000 [  0%]  (Warmup)
## Iteration:  400 / 4000 [ 10%]  (Warmup)
## Iteration:  800 / 4000 [ 20%]  (Warmup)
## Iteration: 1200 / 4000 [ 30%]  (Warmup)
## Iteration: 1600 / 4000 [ 40%]  (Warmup)
## Iteration: 2000 / 4000 [ 50%]  (Warmup)
## Iteration: 2001 / 4000 [ 50%]  (Sampling)
## Iteration: 2400 / 4000 [ 60%]  (Sampling)
## Iteration: 2800 / 4000 [ 70%]  (Sampling)
## Iteration: 3200 / 4000 [ 80%]  (Sampling)
## Iteration: 3600 / 4000 [ 90%]  (Sampling)
## Iteration: 4000 / 4000 [100%]  (Sampling)
## 
##  Elapsed Time: 2.244 seconds (Warm-up)
##                2.448 seconds (Sampling)
##                4.692 seconds (Total)
## 
## 
## SAMPLING FOR MODEL &#39;gaussian brms-model&#39; NOW (CHAIN 3).
## 
## Gradient evaluation took 0 seconds
## 1000 transitions using 10 leapfrog steps per transition would take 0 seconds.
## Adjust your expectations accordingly!
## 
## 
## Iteration:    1 / 4000 [  0%]  (Warmup)
## Iteration:  400 / 4000 [ 10%]  (Warmup)
## Iteration:  800 / 4000 [ 20%]  (Warmup)
## Iteration: 1200 / 4000 [ 30%]  (Warmup)
## Iteration: 1600 / 4000 [ 40%]  (Warmup)
## Iteration: 2000 / 4000 [ 50%]  (Warmup)
## Iteration: 2001 / 4000 [ 50%]  (Sampling)
## Iteration: 2400 / 4000 [ 60%]  (Sampling)
## Iteration: 2800 / 4000 [ 70%]  (Sampling)
## Iteration: 3200 / 4000 [ 80%]  (Sampling)
## Iteration: 3600 / 4000 [ 90%]  (Sampling)
## Iteration: 4000 / 4000 [100%]  (Sampling)
## 
##  Elapsed Time: 2.311 seconds (Warm-up)
##                2.201 seconds (Sampling)
##                4.512 seconds (Total)
## 
## 
## SAMPLING FOR MODEL &#39;gaussian brms-model&#39; NOW (CHAIN 4).
## 
## Gradient evaluation took 0 seconds
## 1000 transitions using 10 leapfrog steps per transition would take 0 seconds.
## Adjust your expectations accordingly!
## 
## 
## Iteration:    1 / 4000 [  0%]  (Warmup)
## Iteration:  400 / 4000 [ 10%]  (Warmup)
## Iteration:  800 / 4000 [ 20%]  (Warmup)
## Iteration: 1200 / 4000 [ 30%]  (Warmup)
## Iteration: 1600 / 4000 [ 40%]  (Warmup)
## Iteration: 2000 / 4000 [ 50%]  (Warmup)
## Iteration: 2001 / 4000 [ 50%]  (Sampling)
## Iteration: 2400 / 4000 [ 60%]  (Sampling)
## Iteration: 2800 / 4000 [ 70%]  (Sampling)
## Iteration: 3200 / 4000 [ 80%]  (Sampling)
## Iteration: 3600 / 4000 [ 90%]  (Sampling)
## Iteration: 4000 / 4000 [100%]  (Sampling)
## 
##  Elapsed Time: 2.227 seconds (Warm-up)
##                1.647 seconds (Sampling)
##                3.874 seconds (Total)

brms<span class="op">::</span><span class="kw">prior_summary</span>(m_padaysLastweek_trackgirl, <span class="dt">data =</span> df)</code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["bound"],"name":[8],"type":["chr"],"align":["left"]}],"data":[{"1":"student_t(3, 3, 10)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":""},{"1":"student_t(3, 0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":""},{"1":"","2":"sd","3":"","4":"track:girl","5":"","6":"","7":"","8":""},{"1":"","2":"sd","3":"Intercept","4":"track:girl","5":"","6":"","7":"","8":""},{"1":"student_t(3, 0, 10)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":""}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[15],"max":[15]},"pages":{}}}
  </script>
</div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
m_padaysLastweek_trackgirl
##  Family: gaussian 
##   Links: mu = identity; sigma = identity 
## Formula: padaysLastweek_T1 ~ (1 | track:girl) 
##    Data: df (Number of observations: 1082) 
## Samples: 4 chains, each with iter = 4000; warmup = 2000; thin = 1; 
##          total post-warmup samples = 8000
##     ICs: LOO = NA; WAIC = NA; R2 = NA
##  
## Group-Level Effects: 
## ~track:girl (Number of levels: 10) 
##               Estimate Est.Error l-95% CI u-95% CI Eff.Sample Rhat
## sd(Intercept)     0.58      0.19     0.32     1.06       2144 1.00
## 
## Population-Level Effects: 
##           Estimate Est.Error l-95% CI u-95% CI Eff.Sample Rhat
## Intercept     2.81      0.22     2.37     3.24       2044 1.00
## 
## Family Specific Parameters: 
##       Estimate Est.Error l-95% CI u-95% CI Eff.Sample Rhat
## sigma     1.84      0.04     1.76     1.92       7718 1.00
## 
## Samples were drawn using sampling(NUTS). For each parameter, Eff.Sample 
## is a crude measure of effective sample size, and Rhat is the potential 
## scale reduction factor on split chains (at convergence, Rhat = 1).

b_intercept &lt;-<span class="st"> </span>brms<span class="op">::</span><span class="kw">fixef</span>(m_padaysLastweek_trackgirl)[<span class="dv">1</span>]

<span class="co"># This gives estimates only:</span>
padaysLastweek_trackgirl_estimates &lt;-<span class="st"> </span>brms<span class="op">::</span><span class="kw">ranef</span>(m_padaysLastweek_trackgirl)[[<span class="dv">1</span>]][<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]

<span class="co"># The 2.5%ile:</span>
padaysLastweek_trackgirl_CIL &lt;-<span class="st"> </span>brms<span class="op">::</span><span class="kw">ranef</span>(m_padaysLastweek_trackgirl)[[<span class="dv">1</span>]][<span class="dv">21</span><span class="op">:</span><span class="dv">30</span>]

<span class="co"># The 97.5%ile:</span>
padaysLastweek_trackgirl_CIH &lt;-<span class="st"> </span>brms<span class="op">::</span><span class="kw">ranef</span>(m_padaysLastweek_trackgirl)[[<span class="dv">1</span>]][<span class="dv">31</span><span class="op">:</span><span class="dv">40</span>]

padaysLastweek_trackgirl_ci &lt;-<span class="st"> </span><span class="kw">data.frame</span>(padaysLastweek_trackgirl_CIL, padaysLastweek_trackgirl_estimates, padaysLastweek_trackgirl_CIH, <span class="dt">Variable =</span> <span class="kw">labels</span>(brms<span class="op">::</span><span class="kw">ranef</span>(m_padaysLastweek_trackgirl))) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">b_intercept =</span> <span class="kw">rep</span>(b_intercept, <span class="dv">10</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">padaysLastweek_trackgirl_CIL =</span> padaysLastweek_trackgirl_CIL <span class="op">+</span><span class="st"> </span>b_intercept,
         <span class="dt">padaysLastweek_trackgirl_estimates =</span> padaysLastweek_trackgirl_estimates <span class="op">+</span><span class="st"> </span>b_intercept,
         <span class="dt">padaysLastweek_trackgirl_CIH =</span> padaysLastweek_trackgirl_CIH <span class="op">+</span><span class="st"> </span>b_intercept,
         <span class="dt">track =</span> <span class="kw">c</span>(<span class="st">&#39;BA_boy&#39;</span>,
                   <span class="st">&#39;BA_girl&#39;</span>,
                   <span class="st">&#39;HRC_boy&#39;</span>,
                   <span class="st">&#39;HRC_girl&#39;</span>,
                   <span class="st">&#39;IT_boy&#39;</span>,
                   <span class="st">&#39;IT_girl&#39;</span>,
                   <span class="st">&#39;Nur_boy&#39;</span>,
                   <span class="st">&#39;Nur_girl&#39;</span>,
                   <span class="st">&#39;Other_boy&#39;</span>,
                   <span class="st">&#39;Other_girl&#39;</span>
))

padaysLastweek_trackgirl_diamonds_girl &lt;-<span class="st"> </span><span class="kw">rbind</span>(
padaysLastweek_trackgirl_ci <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;Nur_girl&quot;</span>),
padaysLastweek_trackgirl_ci <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;HRC_girl&quot;</span>),
padaysLastweek_trackgirl_ci <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;BA_girl&quot;</span>),
padaysLastweek_trackgirl_ci <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;IT_girl&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">arrange</span>(<span class="op">-</span><span class="kw">row_number</span>()) <span class="co"># reverse order of rows to make them right for the plot to come</span>

padaysLastweek_trackgirl_diamonds_boy &lt;-<span class="st"> </span><span class="kw">rbind</span>(
padaysLastweek_trackgirl_ci <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;Nur_boy&quot;</span>),
padaysLastweek_trackgirl_ci <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;HRC_boy&quot;</span>),
padaysLastweek_trackgirl_ci <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;BA_boy&quot;</span>),
padaysLastweek_trackgirl_ci <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;IT_boy&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">arrange</span>(<span class="op">-</span><span class="kw">row_number</span>()) <span class="co"># reverse order of rows to make them right for the plot to come</span>


m_padaysLastweek_trackintervention &lt;-<span class="st"> </span>brms<span class="op">::</span><span class="kw">bf</span>(padaysLastweek_T1 <span class="op">~</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>track<span class="op">:</span>intervention)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>brms<span class="op">::</span><span class="kw">brm</span>(., <span class="dt">data =</span> df, <span class="dt">chains =</span> <span class="dv">4</span>, <span class="dt">iter =</span> <span class="dv">4000</span>, <span class="dt">control =</span> <span class="kw">list</span>(<span class="dt">adapt_delta =</span> <span class="fl">0.95</span>))
## Found more than one class &quot;family&quot; in cache; using the first, from namespace &#39;lme4&#39;
## Also defined by &#39;MatrixModels&#39;
## Warning: Rows containing NAs were excluded from the model
## Compiling the C++ model
## Start sampling
## 
## SAMPLING FOR MODEL &#39;gaussian brms-model&#39; NOW (CHAIN 1).
## 
## Gradient evaluation took 0 seconds
## 1000 transitions using 10 leapfrog steps per transition would take 0 seconds.
## Adjust your expectations accordingly!
## 
## 
## Iteration:    1 / 4000 [  0%]  (Warmup)
## Iteration:  400 / 4000 [ 10%]  (Warmup)
## Iteration:  800 / 4000 [ 20%]  (Warmup)
## Iteration: 1200 / 4000 [ 30%]  (Warmup)
## Iteration: 1600 / 4000 [ 40%]  (Warmup)
## Iteration: 2000 / 4000 [ 50%]  (Warmup)
## Iteration: 2001 / 4000 [ 50%]  (Sampling)
## Iteration: 2400 / 4000 [ 60%]  (Sampling)
## Iteration: 2800 / 4000 [ 70%]  (Sampling)
## Iteration: 3200 / 4000 [ 80%]  (Sampling)
## Iteration: 3600 / 4000 [ 90%]  (Sampling)
## Iteration: 4000 / 4000 [100%]  (Sampling)
## 
##  Elapsed Time: 2.135 seconds (Warm-up)
##                1.497 seconds (Sampling)
##                3.632 seconds (Total)
## 
## 
## SAMPLING FOR MODEL &#39;gaussian brms-model&#39; NOW (CHAIN 2).
## 
## Gradient evaluation took 0 seconds
## 1000 transitions using 10 leapfrog steps per transition would take 0 seconds.
## Adjust your expectations accordingly!
## 
## 
## Iteration:    1 / 4000 [  0%]  (Warmup)
## Iteration:  400 / 4000 [ 10%]  (Warmup)
## Iteration:  800 / 4000 [ 20%]  (Warmup)
## Iteration: 1200 / 4000 [ 30%]  (Warmup)
## Iteration: 1600 / 4000 [ 40%]  (Warmup)
## Iteration: 2000 / 4000 [ 50%]  (Warmup)
## Iteration: 2001 / 4000 [ 50%]  (Sampling)
## Iteration: 2400 / 4000 [ 60%]  (Sampling)
## Iteration: 2800 / 4000 [ 70%]  (Sampling)
## Iteration: 3200 / 4000 [ 80%]  (Sampling)
## Iteration: 3600 / 4000 [ 90%]  (Sampling)
## Iteration: 4000 / 4000 [100%]  (Sampling)
## 
##  Elapsed Time: 1.995 seconds (Warm-up)
##                1.378 seconds (Sampling)
##                3.373 seconds (Total)
## 
## 
## SAMPLING FOR MODEL &#39;gaussian brms-model&#39; NOW (CHAIN 3).
## 
## Gradient evaluation took 0 seconds
## 1000 transitions using 10 leapfrog steps per transition would take 0 seconds.
## Adjust your expectations accordingly!
## 
## 
## Iteration:    1 / 4000 [  0%]  (Warmup)
## Iteration:  400 / 4000 [ 10%]  (Warmup)
## Iteration:  800 / 4000 [ 20%]  (Warmup)
## Iteration: 1200 / 4000 [ 30%]  (Warmup)
## Iteration: 1600 / 4000 [ 40%]  (Warmup)
## Iteration: 2000 / 4000 [ 50%]  (Warmup)
## Iteration: 2001 / 4000 [ 50%]  (Sampling)
## Iteration: 2400 / 4000 [ 60%]  (Sampling)
## Iteration: 2800 / 4000 [ 70%]  (Sampling)
## Iteration: 3200 / 4000 [ 80%]  (Sampling)
## Iteration: 3600 / 4000 [ 90%]  (Sampling)
## Iteration: 4000 / 4000 [100%]  (Sampling)
## 
##  Elapsed Time: 1.988 seconds (Warm-up)
##                1.444 seconds (Sampling)
##                3.432 seconds (Total)
## 
## 
## SAMPLING FOR MODEL &#39;gaussian brms-model&#39; NOW (CHAIN 4).
## 
## Gradient evaluation took 0.001 seconds
## 1000 transitions using 10 leapfrog steps per transition would take 10 seconds.
## Adjust your expectations accordingly!
## 
## 
## Iteration:    1 / 4000 [  0%]  (Warmup)
## Iteration:  400 / 4000 [ 10%]  (Warmup)
## Iteration:  800 / 4000 [ 20%]  (Warmup)
## Iteration: 1200 / 4000 [ 30%]  (Warmup)
## Iteration: 1600 / 4000 [ 40%]  (Warmup)
## Iteration: 2000 / 4000 [ 50%]  (Warmup)
## Iteration: 2001 / 4000 [ 50%]  (Sampling)
## Iteration: 2400 / 4000 [ 60%]  (Sampling)
## Iteration: 2800 / 4000 [ 70%]  (Sampling)
## Iteration: 3200 / 4000 [ 80%]  (Sampling)
## Iteration: 3600 / 4000 [ 90%]  (Sampling)
## Iteration: 4000 / 4000 [100%]  (Sampling)
## 
##  Elapsed Time: 2.129 seconds (Warm-up)
##                1.574 seconds (Sampling)
##                3.703 seconds (Total)
## Warning: There were 1 divergent transitions after warmup. Increasing adapt_delta above 0.95 may help. See
## http://mc-stan.org/misc/warnings.html#divergent-transitions-after-warmup
## Warning: Examine the pairs() plot to diagnose sampling problems

brms<span class="op">::</span><span class="kw">prior_summary</span>(m_padaysLastweek_trackintervention, <span class="dt">data =</span> df)</code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["bound"],"name":[8],"type":["chr"],"align":["left"]}],"data":[{"1":"student_t(3, 3, 10)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":""},{"1":"student_t(3, 0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":""},{"1":"","2":"sd","3":"","4":"track:intervention","5":"","6":"","7":"","8":""},{"1":"","2":"sd","3":"Intercept","4":"track:intervention","5":"","6":"","7":"","8":""},{"1":"student_t(3, 0, 10)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":""}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[15],"max":[15]},"pages":{}}}
  </script>
</div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
m_padaysLastweek_trackintervention
## Warning: There were 1 divergent transitions after warmup. Increasing adapt_delta above 0.95 may help.
## See http://mc-stan.org/misc/warnings.html#divergent-transitions-after-warmup
##  Family: gaussian 
##   Links: mu = identity; sigma = identity 
## Formula: padaysLastweek_T1 ~ (1 | track:intervention) 
##    Data: df (Number of observations: 1082) 
## Samples: 4 chains, each with iter = 4000; warmup = 2000; thin = 1; 
##          total post-warmup samples = 8000
##     ICs: LOO = NA; WAIC = NA; R2 = NA
##  
## Group-Level Effects: 
## ~track:intervention (Number of levels: 10) 
##               Estimate Est.Error l-95% CI u-95% CI Eff.Sample Rhat
## sd(Intercept)     0.47      0.17     0.24     0.87       1913 1.00
## 
## Population-Level Effects: 
##           Estimate Est.Error l-95% CI u-95% CI Eff.Sample Rhat
## Intercept     2.78      0.18     2.43     3.14       1863 1.00
## 
## Family Specific Parameters: 
##       Estimate Est.Error l-95% CI u-95% CI Eff.Sample Rhat
## sigma     1.87      0.04     1.79     1.95       8000 1.00
## 
## Samples were drawn using sampling(NUTS). For each parameter, Eff.Sample 
## is a crude measure of effective sample size, and Rhat is the potential 
## scale reduction factor on split chains (at convergence, Rhat = 1).

b_intercept &lt;-<span class="st"> </span>brms<span class="op">::</span><span class="kw">fixef</span>(m_padaysLastweek_trackintervention)[<span class="dv">1</span>]

<span class="co"># This gives estimates only:</span>
padaysLastweek_trackintervention_estimates &lt;-<span class="st"> </span>brms<span class="op">::</span><span class="kw">ranef</span>(m_padaysLastweek_trackintervention)[[<span class="dv">1</span>]][<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]

<span class="co"># The 2.5%ile:</span>
padaysLastweek_trackintervention_CIL &lt;-<span class="st"> </span>brms<span class="op">::</span><span class="kw">ranef</span>(m_padaysLastweek_trackintervention)[[<span class="dv">1</span>]][<span class="dv">21</span><span class="op">:</span><span class="dv">30</span>]

<span class="co"># The 97.5%ile:</span>
padaysLastweek_trackintervention_CIH &lt;-<span class="st"> </span>brms<span class="op">::</span><span class="kw">ranef</span>(m_padaysLastweek_trackintervention)[[<span class="dv">1</span>]][<span class="dv">31</span><span class="op">:</span><span class="dv">40</span>]

padaysLastweek_trackintervention_ci &lt;-<span class="st"> </span><span class="kw">data.frame</span>(padaysLastweek_trackintervention_CIL, padaysLastweek_trackintervention_estimates, padaysLastweek_trackintervention_CIH, <span class="dt">Variable =</span> <span class="kw">labels</span>(brms<span class="op">::</span><span class="kw">ranef</span>(m_padaysLastweek_trackintervention))) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">b_intercept =</span> <span class="kw">rep</span>(b_intercept, <span class="dv">10</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">padaysLastweek_trackintervention_CIL =</span> padaysLastweek_trackintervention_CIL <span class="op">+</span><span class="st"> </span>b_intercept,
         <span class="dt">padaysLastweek_trackintervention_estimates =</span> padaysLastweek_trackintervention_estimates <span class="op">+</span><span class="st"> </span>b_intercept,
         <span class="dt">padaysLastweek_trackintervention_CIH =</span> padaysLastweek_trackintervention_CIH <span class="op">+</span><span class="st"> </span>b_intercept,
         <span class="dt">track =</span> <span class="kw">c</span>(<span class="st">&#39;BA_control&#39;</span>,
                   <span class="st">&#39;BA_intervention&#39;</span>,
                   <span class="st">&#39;HRC_control&#39;</span>,
                   <span class="st">&#39;HRC_intervention&#39;</span>,
                   <span class="st">&#39;IT_control&#39;</span>,
                   <span class="st">&#39;IT_intervention&#39;</span>,
                   <span class="st">&#39;Nur_control&#39;</span>,
                   <span class="st">&#39;Nur_intervention&#39;</span>,
                   <span class="st">&#39;Other_control&#39;</span>,
                   <span class="st">&#39;Other_intervention&#39;</span>
))

padaysLastweek_trackintervention_diamonds_intervention &lt;-<span class="st"> </span><span class="kw">rbind</span>(
padaysLastweek_trackintervention_ci <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;Nur_intervention&quot;</span>),
padaysLastweek_trackintervention_ci <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;HRC_intervention&quot;</span>),
padaysLastweek_trackintervention_ci <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;BA_intervention&quot;</span>),
padaysLastweek_trackintervention_ci <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;IT_intervention&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">arrange</span>(<span class="op">-</span><span class="kw">row_number</span>()) <span class="co"># reverse order of rows to make them right for the plot to come</span>

padaysLastweek_trackintervention_diamonds_control &lt;-<span class="st"> </span><span class="kw">rbind</span>(
padaysLastweek_trackintervention_ci <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;Nur_control&quot;</span>),
padaysLastweek_trackintervention_ci <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;HRC_control&quot;</span>),
padaysLastweek_trackintervention_ci <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;BA_control&quot;</span>),
padaysLastweek_trackintervention_ci <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;IT_control&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">arrange</span>(<span class="op">-</span><span class="kw">row_number</span>()) <span class="co"># reverse order of rows to make them right for the plot to come</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
padaysLastweek_trackgirl_diamonds_girl <span class="op">%&gt;%</span><span class="st"> </span>DT<span class="op">::</span><span class="kw">datatable</span>() <span class="co">#papaja::apa_table()</span></code></pre></div>
<div id="htmlwidget-56e85359cca84bf5348f" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-56e85359cca84bf5348f">{"x":{"filter":"none","data":[["1","2","3","4"],[1.70190814433605,2.23461359565472,1.82212084867023,2.11182440661328],[2.40937180852442,2.74529940386682,2.34735464952122,2.57343543924272],[3.06999121632138,3.26241414978509,2.83864153579845,3.03743699962167],["track:girl","track:girl","track:girl","track:girl"],[2.80904263110048,2.80904263110048,2.80904263110048,2.80904263110048],["IT_girl","BA_girl","HRC_girl","Nur_girl"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>padaysLastweek_trackgirl_CIL<\/th>\n      <th>padaysLastweek_trackgirl_estimates<\/th>\n      <th>padaysLastweek_trackgirl_CIH<\/th>\n      <th>Variable<\/th>\n      <th>b_intercept<\/th>\n      <th>track<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-center","targets":"_all"},{"className":"dt-right","targets":[1,2,3,5]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">padaysLastweek_trackgirl_diamonds_boy <span class="op">%&gt;%</span><span class="st"> </span>DT<span class="op">::</span><span class="kw">datatable</span>() <span class="co">#papaja::apa_table()</span></code></pre></div>
<div id="htmlwidget-4af0f6378e7fa8487949" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-4af0f6378e7fa8487949">{"x":{"filter":"none","data":[["1","2","3","4"],[1.86116381942434,3.24863377329025,2.47543118590634,2.71747936873088],[2.36969506678235,3.71463382057083,3.00901515085638,3.25825110025559],[2.86192129531325,4.22396566116564,3.55553527228671,3.81680702214736],["track:girl","track:girl","track:girl","track:girl"],[2.80904263110048,2.80904263110048,2.80904263110048,2.80904263110048],["IT_boy","BA_boy","HRC_boy","Nur_boy"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>padaysLastweek_trackgirl_CIL<\/th>\n      <th>padaysLastweek_trackgirl_estimates<\/th>\n      <th>padaysLastweek_trackgirl_CIH<\/th>\n      <th>Variable<\/th>\n      <th>b_intercept<\/th>\n      <th>track<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-center","targets":"_all"},{"className":"dt-right","targets":[1,2,3,5]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">padaysLastweek_trackintervention_diamonds_intervention <span class="op">%&gt;%</span><span class="st"> </span>DT<span class="op">::</span><span class="kw">datatable</span>() <span class="co">#papaja::apa_table()</span></code></pre></div>
<div id="htmlwidget-acba9c92db3c0b989448" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-acba9c92db3c0b989448">{"x":{"filter":"none","data":[["1","2","3","4"],[2.00182175004296,2.8462915774722,1.98196510811754,2.19852281062067],[2.50520419363881,3.26594650577811,2.51069770298318,2.6084249248094],[2.98138582730213,3.71409088321042,2.99707884724092,3.00394716449739],["track:intervention","track:intervention","track:intervention","track:intervention"],[2.77808247313572,2.77808247313572,2.77808247313572,2.77808247313572],["IT_intervention","BA_intervention","HRC_intervention","Nur_intervention"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>padaysLastweek_trackintervention_CIL<\/th>\n      <th>padaysLastweek_trackintervention_estimates<\/th>\n      <th>padaysLastweek_trackintervention_CIH<\/th>\n      <th>Variable<\/th>\n      <th>b_intercept<\/th>\n      <th>track<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-center","targets":"_all"},{"className":"dt-right","targets":[1,2,3,5]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">padaysLastweek_trackintervention_diamonds_control <span class="op">%&gt;%</span><span class="st"> </span>DT<span class="op">::</span><span class="kw">datatable</span>() <span class="co">#papaja::apa_table()</span></code></pre></div>
<div id="htmlwidget-2f8adaecf0ad479574d0" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-2f8adaecf0ad479574d0">{"x":{"filter":"none","data":[["1","2","3","4"],[1.81086268734723,2.90254424682239,2.23627411332854,2.47318430399818],[2.31658188445365,3.33314875739909,2.68032597812389,2.91326057170267],[2.77350135860108,3.80966837653854,3.10089200313596,3.35181948831041],["track:intervention","track:intervention","track:intervention","track:intervention"],[2.77808247313572,2.77808247313572,2.77808247313572,2.77808247313572],["IT_control","BA_control","HRC_control","Nur_control"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>padaysLastweek_trackintervention_CIL<\/th>\n      <th>padaysLastweek_trackintervention_estimates<\/th>\n      <th>padaysLastweek_trackintervention_CIH<\/th>\n      <th>Variable<\/th>\n      <th>b_intercept<\/th>\n      <th>track<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-center","targets":"_all"},{"className":"dt-right","targets":[1,2,3,5]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div id="density-plot-by-intervention-and-gender-1" class="section level3">
<h3>Density plot by intervention and gender</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># Create data frame</span>
densplot &lt;-<span class="st"> </span>d
<span class="kw">levels</span>(densplot<span class="op">$</span>intervention) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Control&quot;</span>, <span class="st">&quot;Intervention&quot;</span>)
<span class="kw">levels</span>(densplot<span class="op">$</span>girl) &lt;-<span class="st"> </span><span class="kw">recode</span>(densplot<span class="op">$</span>girl, <span class="st">&quot;boy&quot;</span> =<span class="st"> &quot;Boys&quot;</span>, <span class="st">&quot;girl&quot;</span> =<span class="st"> &quot;Girls&quot;</span>)

<span class="co"># This gives side-by-side plots. There&#39;s a third plot below the two, which is fake to include x-axis text.</span>
<span class="kw">layout</span>(<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">3</span>), <span class="dt">nrow =</span> <span class="dv">2</span>, <span class="dt">ncol =</span> <span class="dv">2</span>, <span class="dt">byrow =</span> <span class="ot">TRUE</span>),
       <span class="dt">widths =</span> <span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>),<span class="dt">heights =</span> <span class="kw">c</span>(<span class="fl">0.45</span>,<span class="fl">0.05</span>))

<span class="co"># Minimise whitespace; see https://stackoverflow.com/questions/15848942/how-to-reduce-space-gap-between-multiple-graphs-in-r</span>
<span class="kw">par</span>(<span class="dt">mai =</span> <span class="kw">c</span>(<span class="fl">0.3</span>, <span class="fl">0.3</span>, <span class="fl">0.1</span>, <span class="fl">0.0</span>)) 

## Girls vs. boys
<span class="co"># Choose only the variables needed and drop NA</span>
dens &lt;-<span class="st"> </span>densplot <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(padaysLastweek_T1, girl) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="kw">complete.cases</span>(.))

<span class="co"># Set random number generator for reproducibility of bootstrap test of equal densities</span>
<span class="kw">set.seed</span>(<span class="dv">10</span>)

<span class="co"># Make plot</span>
sm.padaysLastweek_T1_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">sm.density.compare2</span>(<span class="kw">as.numeric</span>(dens<span class="op">$</span>padaysLastweek_T1), 
                                               <span class="kw">as.factor</span>(dens<span class="op">$</span>girl), 
                                               <span class="dt">model =</span> <span class="st">&quot;equal&quot;</span>,
                                               <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>,
                                               <span class="dt">col =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end  =</span>  <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">1</span>)], 
                                               <span class="dt">lty =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>), <span class="dt">yaxt =</span> <span class="st">&quot;n&quot;</span>,
                                               <span class="dt">bandcol =</span> <span class="st">&#39;LightGray&#39;</span>, 
                                               <span class="dt">lwd =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>),
                                               <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">7</span>))
## 
## Test of equal densities:  p-value =  0
<span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="kw">levels</span>(dens<span class="op">$</span>girl), <span class="dt">col =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>)], <span class="dt">lty =</span> <span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">1</span>), <span class="dt">lwd =</span> (<span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>)))
<span class="kw">mtext</span>(<span class="dt">side =</span> <span class="dv">2</span>, <span class="st">&quot;Density&quot;</span>, <span class="dt">line =</span> <span class="fl">0.5</span>)

## Intervention vs. control
<span class="co"># Choose only the variables needed and drop NA</span>
dens &lt;-<span class="st"> </span>densplot <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(padaysLastweek_T1, intervention) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="kw">complete.cases</span>(.))

<span class="co"># Set random number generator for reproducibility of bootstrap test of equal densities</span>
<span class="kw">set.seed</span>(<span class="dv">10</span>)
<span class="co"># Make plot</span>
sm.padaysLastweek_T1_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">sm.density.compare2</span>(<span class="kw">as.numeric</span>(dens<span class="op">$</span>padaysLastweek_T1), 
                                               <span class="kw">as.factor</span>(dens<span class="op">$</span>intervention), 
                                               <span class="dt">model =</span> <span class="st">&quot;equal&quot;</span>, 
                                               <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>,
                                               <span class="dt">col =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">4</span>)], 
                                               <span class="dt">lty =</span> <span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">1</span>), <span class="dt">yaxt =</span> <span class="st">&quot;n&quot;</span>,
                                               <span class="dt">bandcol =</span> <span class="st">&#39;LightGray&#39;</span>, 
                                               <span class="dt">lwd =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>),
                                               <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">7</span>))
## 
## Test of equal densities:  p-value =  0.09
<span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="kw">levels</span>(dens<span class="op">$</span>intervention), <span class="dt">col =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">4</span>)], <span class="dt">lty=</span><span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">1</span>), <span class="dt">lwd=</span>(<span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>)))

<span class="co"># Create x-axis label. See https://stackoverflow.com/questions/11198767/how-to-annotate-across-or-between-plots-in-multi-plot-panels-in-r</span>
<span class="kw">par</span>(<span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>)) 
<span class="kw">plot</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dt">type =</span> <span class="st">&quot;n&quot;</span>, <span class="dt">frame.plot =</span> <span class="ot">FALSE</span>,<span class="dt">axes =</span> <span class="ot">FALSE</span>) <span class="co"># Fake plot</span>
<span class="kw">text</span>(<span class="dt">x =</span> <span class="fl">1.02</span>, <span class="dt">y =</span> <span class="fl">1.3</span>, <span class="dt">labels =</span> <span class="st">&quot;Self-reported number of MVPA days previous week&quot;</span>, <span class="dt">pos =</span> <span class="dv">1</span>)</code></pre></div>
<p><img src="baseline-supplement_files/figure-html/padaysLastweek-sm-1.png" width="2100" /></p>
</div>
<div id="density-plot-by-track-1" class="section level3">
<h3>Density plot by track</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
plot1 &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(id,
                              <span class="dt">track =</span> track,
                              girl,
                              <span class="dt">PA =</span> padaysLastweek_T1)  <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(track), track <span class="op">!=</span><span class="st"> &quot;Other&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># Drop category &quot;Other&quot;</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">track =</span> <span class="kw">factor</span>(track, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;IT&quot;</span>, <span class="st">&quot;BA&quot;</span>, <span class="st">&quot;HRC&quot;</span>, <span class="st">&quot;Nur&quot;</span>)),
                <span class="dt">track =</span> <span class="kw">recode_factor</span>(track, <span class="st">&quot;IT&quot;</span> =<span class="st"> &quot;IT&quot;</span>, <span class="st">&quot;BA&quot;</span> =<span class="st"> &quot;BA&quot;</span>, 
                                      <span class="st">&quot;HRC&quot;</span> =<span class="st"> &quot;HRC&quot;</span>, <span class="st">&quot;Nur&quot;</span> =<span class="st"> &quot;Nur&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>ggplot2<span class="op">::</span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">y =</span> track)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">geom_density_ridges2</span>(<span class="kw">aes</span>(<span class="dt">x =</span> PA, <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>, 
                                    <span class="dt">fill =</span> <span class="kw">paste</span>(track, girl),
                                    <span class="dt">point_color =</span> girl,
                                    <span class="dt">point_fill =</span> girl,
                                    <span class="dt">point_shape =</span> girl),
                                  <span class="dt">scale =</span> .<span class="dv">6</span>, <span class="dt">alpha =</span> <span class="fl">0.6</span>, <span class="dt">size =</span> <span class="fl">0.25</span>,
                                  <span class="dt">position =</span> <span class="kw">position_raincloud</span>(<span class="dt">width =</span> <span class="fl">0.2</span>, <span class="dt">height =</span> <span class="fl">0.4</span>),
                                  <span class="co"># from = 0, to = 450,</span>
                                  <span class="dt">jittered_points =</span> <span class="ot">TRUE</span>,
                                  <span class="dt">point_size =</span> <span class="dv">1</span>,
                                  <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">7</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="ot">NULL</span>,
       <span class="dt">y =</span> <span class="ot">NULL</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_discrete</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.1</span>, <span class="dv">0</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>), <span class="dt">breaks =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">7</span>, <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">7</span>)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_fill_cyclical</span>(
                                <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&#39;BA boy&#39;</span> =<span class="st"> &quot;Boy&quot;</span>, <span class="st">&#39;BA girl&#39;</span> =<span class="st"> &quot;Girl&quot;</span>),
                                <span class="dt">values =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>)],
                                <span class="dt">name =</span> <span class="st">&quot;&quot;</span>, 
                                <span class="dt">guide =</span> <span class="kw">guide_legend</span>(<span class="dt">override.aes =</span> <span class="kw">list</span>(<span class="dt">alpha =</span> <span class="dv">1</span>, 
                                                                         <span class="dt">point_shape =</span> <span class="kw">c</span>(<span class="dv">24</span>, <span class="dv">4</span>),
                                                                         <span class="dt">point_size =</span> <span class="dv">2</span>))) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_colour_cyclical</span>(<span class="dt">values =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">theme_ridges</span>(<span class="dt">grid =</span> <span class="ot">FALSE</span>) <span class="op">+</span>
<span class="st">  </span><span class="co"># ggplot2::scale_fill_manual(values = c(&quot;#A0FFA0&quot;, &quot;#A0A0FF&quot;)) +</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_discrete_manual</span>(<span class="dt">aesthetics =</span> <span class="st">&quot;point_color&quot;</span>, 
                                  <span class="dt">values =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">1</span>)],
                                  <span class="dt">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_discrete_manual</span>(<span class="dt">aesthetics =</span> <span class="st">&quot;point_fill&quot;</span>,
                                  <span class="dt">values =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">1</span>)],
                                  <span class="dt">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_discrete_manual</span>(<span class="dt">aesthetics =</span> <span class="st">&quot;point_shape&quot;</span>, 
                                  <span class="dt">values =</span> <span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">24</span>),
                                  <span class="dt">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>papaja<span class="op">::</span><span class="kw">theme_apa</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)
## Warning: Ignoring unknown parameters: limits

plot1 &lt;-<span class="st"> </span>plot1 <span class="op">+</span><span class="st"> </span>
<span class="st">  </span>userfriendlyscience<span class="op">::</span><span class="kw">diamondPlot</span>(padaysLastweek_trackgirl_diamonds_girl, 
                                   <span class="dt">returnLayerOnly =</span> <span class="ot">TRUE</span>, 
                                   <span class="dt">lineColor =</span> <span class="st">&quot;black&quot;</span>, 
                                   <span class="dt">color=</span>viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">3</span>],
                                   <span class="dt">alpha=</span>.<span class="dv">6</span>, 
                                   <span class="dt">fixedSize =</span> <span class="fl">0.1</span>, 
                                   <span class="dt">otherAxisCol =</span> (<span class="dv">1</span><span class="op">:</span><span class="dv">4</span> <span class="op">+</span><span class="st"> </span>.<span class="dv">15</span>)) <span class="op">+</span><span class="st"> </span><span class="co"># specify y-position; option to move the diamond </span>
<span class="st">  </span>userfriendlyscience<span class="op">::</span><span class="kw">diamondPlot</span>(padaysLastweek_trackgirl_diamonds_boy, 
                                   <span class="dt">returnLayerOnly =</span> <span class="ot">TRUE</span>, 
                                   <span class="dt">lineColor =</span> <span class="st">&quot;black&quot;</span>, 
                                   <span class="dt">linetype =</span> <span class="st">&quot;solid&quot;</span>, 
                                   <span class="dt">color=</span>viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">1</span>],
                                   <span class="dt">alpha=</span>.<span class="dv">6</span>, 
                                   <span class="dt">fixedSize =</span> <span class="fl">0.1</span>, 
                                   <span class="dt">otherAxisCol =</span> (<span class="dv">1</span><span class="op">:</span><span class="dv">4</span> <span class="op">+</span><span class="st"> </span>.<span class="dv">15</span>))

<span class="co"># Draw plot with intervention and control densities</span>

plot2 &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(id,
                              <span class="dt">track =</span> track,
                              intervention,
                              <span class="dt">PA =</span> padaysLastweek_T1)  <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(track), track <span class="op">!=</span><span class="st"> &quot;Other&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># Drop category &quot;Other&quot;</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">track =</span> <span class="kw">factor</span>(track, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;IT&quot;</span>, <span class="st">&quot;BA&quot;</span>, <span class="st">&quot;HRC&quot;</span>, <span class="st">&quot;Nur&quot;</span>)),
                <span class="dt">track =</span> <span class="kw">recode_factor</span>(track, <span class="st">&quot;IT&quot;</span> =<span class="st"> &quot;IT&quot;</span>, <span class="st">&quot;BA&quot;</span> =<span class="st"> &quot;BA&quot;</span>, 
                                      <span class="st">&quot;HRC&quot;</span> =<span class="st"> &quot;HRC&quot;</span>, <span class="st">&quot;Nur&quot;</span> =<span class="st"> &quot;Nur&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>ggplot2<span class="op">::</span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">y =</span> track)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">geom_density_ridges2</span>(<span class="kw">aes</span>(<span class="dt">x =</span> PA, <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>, 
                                    <span class="dt">fill =</span> <span class="kw">paste</span>(track, intervention),
                                    <span class="dt">point_color =</span> intervention,
                                    <span class="dt">point_fill =</span> intervention,
                                    <span class="dt">point_shape =</span> intervention),
                                  <span class="dt">scale =</span> .<span class="dv">6</span>, <span class="dt">alpha =</span> <span class="fl">0.6</span>, <span class="dt">size =</span> <span class="fl">0.25</span>,
                                  <span class="dt">position =</span> <span class="kw">position_raincloud</span>(<span class="dt">width =</span> <span class="fl">0.2</span>, <span class="dt">height =</span> <span class="fl">0.4</span>),
                                  <span class="co"># from = 0, to = 450,</span>
                                  <span class="dt">jittered_points =</span> <span class="ot">TRUE</span>,
                                  <span class="dt">point_size =</span> <span class="dv">1</span>,
                                  <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">7</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="ot">NULL</span>,
       <span class="dt">y =</span> <span class="ot">NULL</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_discrete</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.1</span>, <span class="dv">0</span>), <span class="dt">labels =</span> <span class="ot">NULL</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>), <span class="dt">breaks =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">7</span>, <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">7</span>)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_fill_cyclical</span>(
                                <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&#39;BA 0&#39;</span> =<span class="st"> &quot;Control&quot;</span>, <span class="st">&#39;BA 1&#39;</span> =<span class="st"> &quot;Intervention&quot;</span>),
                                <span class="dt">values =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">4</span>)],
                                <span class="dt">name =</span> <span class="st">&quot;&quot;</span>, 
                                <span class="dt">guide =</span> <span class="kw">guide_legend</span>(<span class="dt">override.aes =</span> <span class="kw">list</span>(<span class="dt">alpha =</span> <span class="dv">1</span>, 
                                                                         <span class="dt">point_shape =</span> <span class="kw">c</span>(<span class="dv">21</span>, <span class="dv">3</span>),
                                                                         <span class="dt">point_size =</span> <span class="dv">2</span>))) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_colour_cyclical</span>(<span class="dt">values =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">theme_ridges</span>(<span class="dt">grid =</span> <span class="ot">FALSE</span>) <span class="op">+</span>
<span class="st">  </span><span class="co"># ggplot2::scale_fill_manual(values = c(&quot;#A0FFA0&quot;, &quot;#A0A0FF&quot;)) +</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_discrete_manual</span>(<span class="dt">aesthetics =</span> <span class="st">&quot;point_color&quot;</span>, 
                                  <span class="dt">values =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">4</span>)],
                                  <span class="dt">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_discrete_manual</span>(<span class="dt">aesthetics =</span> <span class="st">&quot;point_fill&quot;</span>,
                                  <span class="dt">values =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">4</span>)],
                                  <span class="dt">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_discrete_manual</span>(<span class="dt">aesthetics =</span> <span class="st">&quot;point_shape&quot;</span>, 
                                  <span class="dt">values =</span> <span class="kw">c</span>(<span class="dv">21</span>, <span class="dv">3</span>),
                                  <span class="dt">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>papaja<span class="op">::</span><span class="kw">theme_apa</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)
## Warning: Ignoring unknown parameters: limits

plot2 &lt;-<span class="st"> </span>plot2 <span class="op">+</span><span class="st"> </span>
<span class="st">  </span>userfriendlyscience<span class="op">::</span><span class="kw">diamondPlot</span>(padaysLastweek_trackintervention_diamonds_intervention, 
                                   <span class="dt">returnLayerOnly =</span> <span class="ot">TRUE</span>, 
                                   <span class="dt">lineColor =</span> <span class="st">&quot;black&quot;</span>,  
                                   <span class="dt">color=</span>viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">4</span>],
                                   <span class="dt">alpha=</span>.<span class="dv">6</span>, 
                                   <span class="dt">fixedSize =</span> <span class="fl">0.1</span>, 
                                   <span class="dt">otherAxisCol =</span> (<span class="dv">1</span><span class="op">:</span><span class="dv">4</span> <span class="op">+</span><span class="st"> </span>.<span class="dv">15</span>)) <span class="op">+</span>
<span class="st">  </span>userfriendlyscience<span class="op">::</span><span class="kw">diamondPlot</span>(padaysLastweek_trackintervention_diamonds_control, 
                                   <span class="dt">returnLayerOnly =</span> <span class="ot">TRUE</span>, 
                                   <span class="dt">lineColor =</span> <span class="st">&quot;black&quot;</span>,  
                                   <span class="dt">color=</span>viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">2</span>],
                                   <span class="dt">alpha=</span>.<span class="dv">6</span>, 
                                   <span class="dt">fixedSize =</span> <span class="fl">0.1</span>, 
                                   <span class="dt">otherAxisCol =</span> (<span class="dv">1</span><span class="op">:</span><span class="dv">4</span> <span class="op">+</span><span class="st"> </span>.<span class="dv">15</span>))

plot1 <span class="op">+</span><span class="st"> </span>plot2
## Picking joint bandwidth of 0.604
## Warning: Removed 2 rows containing non-finite values (stat_density_ridges).
## Picking joint bandwidth of 0.614
## Warning: Removed 2 rows containing non-finite values (stat_density_ridges).</code></pre></div>
<p><img src="baseline-supplement_files/figure-html/padaysLastweek-densityplot-1.png" width="2100" /></p>
</div>
<div id="histogram-1" class="section level3">
<h3>Histogram 1</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">plotboys &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(id,
                                 <span class="dt">track =</span> track,
                                 girl,
                                 padaysLastweek_T1)  <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(track), track <span class="op">!=</span><span class="st"> &quot;Other&quot;</span>, girl <span class="op">==</span><span class="st"> &quot;boy&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># Drop category &quot;Other&quot;</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">track =</span> <span class="kw">factor</span>(track, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;IT&quot;</span>, <span class="st">&quot;BA&quot;</span>, <span class="st">&quot;HRC&quot;</span>, <span class="st">&quot;Nur&quot;</span>)),
                <span class="dt">track =</span> <span class="kw">recode_factor</span>(track, <span class="st">&quot;IT&quot;</span> =<span class="st"> &quot;IT&quot;</span>, <span class="st">&quot;BA&quot;</span> =<span class="st"> &quot;BA&quot;</span>, 
                                      <span class="st">&quot;HRC&quot;</span> =<span class="st"> &quot;HRC&quot;</span>, <span class="st">&quot;Nur&quot;</span> =<span class="st"> &quot;Nur&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>ggplot2<span class="op">::</span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">y =</span> track)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">geom_density_ridges2</span>(<span class="kw">aes</span>(<span class="dt">x =</span> padaysLastweek_T1, <span class="dt">fill =</span> girl), <span class="dt">stat =</span> <span class="st">&quot;binline&quot;</span>, <span class="dt">binwidth =</span> <span class="dv">1</span>, <span class="dt">scale =</span> <span class="fl">0.95</span>, <span class="dt">alpha =</span> <span class="fl">0.6</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">7</span>), <span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="dt">name =</span> <span class="ot">NULL</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_discrete</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>), <span class="dt">name =</span> <span class="st">&quot;&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_fill_cyclical</span>(<span class="dt">values =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">1</span>]) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Boys&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">guides</span>(<span class="dt">y =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">theme_ridges</span>(<span class="dt">grid =</span> <span class="ot">FALSE</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>),
        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>),
        <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>, <span class="dt">size =</span> <span class="dv">10</span>),
        <span class="dt">axis.text=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">10</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">0.5</span>, <span class="fl">7.5</span>))

plotboys &lt;-<span class="st"> </span>plotboys <span class="op">+</span><span class="st"> </span>
<span class="st">  </span>userfriendlyscience<span class="op">::</span><span class="kw">diamondPlot</span>(padaysLastweek_trackgirl_diamonds_girl, 
                                   <span class="dt">returnLayerOnly =</span> <span class="ot">TRUE</span>, 
                                   <span class="dt">lineColor =</span> <span class="st">&quot;black&quot;</span>, 
                                   <span class="dt">color=</span>viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">3</span>],
                                   <span class="dt">alpha=</span>.<span class="dv">6</span>, 
                                   <span class="dt">fixedSize =</span> <span class="fl">0.1</span>, 
                                   <span class="dt">otherAxisCol =</span> (<span class="dv">1</span><span class="op">:</span><span class="dv">4</span> <span class="op">+</span><span class="st"> </span>.<span class="dv">15</span>)) <span class="op">+</span><span class="st"> </span><span class="co"># specify y-position; option to move the diamond </span>
<span class="st">  </span>userfriendlyscience<span class="op">::</span><span class="kw">diamondPlot</span>(padaysLastweek_trackgirl_diamonds_boy, 
                                   <span class="dt">returnLayerOnly =</span> <span class="ot">TRUE</span>, 
                                   <span class="dt">lineColor =</span> <span class="st">&quot;black&quot;</span>, 
                                   <span class="dt">linetype =</span> <span class="st">&quot;solid&quot;</span>, 
                                   <span class="dt">color=</span>viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">1</span>],
                                   <span class="dt">alpha=</span>.<span class="dv">6</span>, 
                                   <span class="dt">fixedSize =</span> <span class="fl">0.1</span>, 
                                   <span class="dt">otherAxisCol =</span> (<span class="dv">1</span><span class="op">:</span><span class="dv">4</span> <span class="op">+</span><span class="st"> </span>.<span class="dv">15</span>))

plotgirls &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(id,
                                 <span class="dt">track =</span> track,
                                 girl,
                                 padaysLastweek_T1)  <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(track), track <span class="op">!=</span><span class="st"> &quot;Other&quot;</span>, girl <span class="op">==</span><span class="st"> &quot;girl&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># Drop category &quot;Other&quot;</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">track =</span> <span class="kw">factor</span>(track, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;IT&quot;</span>, <span class="st">&quot;BA&quot;</span>, <span class="st">&quot;HRC&quot;</span>, <span class="st">&quot;Nur&quot;</span>)),
                <span class="dt">track =</span> <span class="kw">recode_factor</span>(track, <span class="st">&quot;IT&quot;</span> =<span class="st"> &quot;IT&quot;</span>, <span class="st">&quot;BA&quot;</span> =<span class="st"> &quot;BA&quot;</span>, 
                                      <span class="st">&quot;HRC&quot;</span> =<span class="st"> &quot;HRC&quot;</span>, <span class="st">&quot;Nur&quot;</span> =<span class="st"> &quot;Nur&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>ggplot2<span class="op">::</span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">y =</span> track)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">geom_density_ridges2</span>(<span class="kw">aes</span>(<span class="dt">x =</span> padaysLastweek_T1, <span class="dt">fill =</span> girl), <span class="dt">stat =</span> <span class="st">&quot;binline&quot;</span>, <span class="dt">binwidth =</span> <span class="dv">1</span>, <span class="dt">scale =</span> <span class="fl">0.95</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">7</span>), <span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="dt">name =</span> <span class="ot">NULL</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_discrete</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>), <span class="dt">name =</span> <span class="st">&quot;&quot;</span>, <span class="dt">labels =</span> <span class="ot">NULL</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_fill_cyclical</span>(<span class="dt">values =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">3</span>]) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Girls&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">guides</span>(<span class="dt">y =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">theme_ridges</span>(<span class="dt">grid =</span> <span class="ot">FALSE</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>),
        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>),
        <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>, <span class="dt">size =</span> <span class="dv">10</span>),
        <span class="dt">axis.text=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">10</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">0.5</span>, <span class="fl">7.5</span>))

plotgirls &lt;-<span class="st"> </span>plotgirls <span class="op">+</span><span class="st"> </span>
<span class="st">  </span>userfriendlyscience<span class="op">::</span><span class="kw">diamondPlot</span>(padaysLastweek_trackgirl_diamonds_girl, 
                                   <span class="dt">returnLayerOnly =</span> <span class="ot">TRUE</span>, 
                                   <span class="dt">lineColor =</span> <span class="st">&quot;black&quot;</span>, 
                                   <span class="dt">color=</span>viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">3</span>],
                                   <span class="dt">alpha=</span>.<span class="dv">6</span>, 
                                   <span class="dt">fixedSize =</span> <span class="fl">0.1</span>, 
                                   <span class="dt">otherAxisCol =</span> (<span class="dv">1</span><span class="op">:</span><span class="dv">4</span> <span class="op">+</span><span class="st"> </span>.<span class="dv">15</span>)) <span class="op">+</span><span class="st"> </span><span class="co"># specify y-position; option to move the diamond </span>
<span class="st">  </span>userfriendlyscience<span class="op">::</span><span class="kw">diamondPlot</span>(padaysLastweek_trackgirl_diamonds_boy, 
                                   <span class="dt">returnLayerOnly =</span> <span class="ot">TRUE</span>, 
                                   <span class="dt">lineColor =</span> <span class="st">&quot;black&quot;</span>, 
                                   <span class="dt">linetype =</span> <span class="st">&quot;solid&quot;</span>, 
                                   <span class="dt">color=</span>viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">1</span>],
                                   <span class="dt">alpha=</span>.<span class="dv">6</span>, 
                                   <span class="dt">fixedSize =</span> <span class="fl">0.1</span>, 
                                   <span class="dt">otherAxisCol =</span> (<span class="dv">1</span><span class="op">:</span><span class="dv">4</span> <span class="op">+</span><span class="st"> </span>.<span class="dv">15</span>))


plotcontrol &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(id,
                                 <span class="dt">track =</span> track,
                                 intervention,
                                 padaysLastweek_T1)  <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(track), track <span class="op">!=</span><span class="st"> &quot;Other&quot;</span>, intervention <span class="op">==</span><span class="st"> &quot;0&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># Drop category &quot;Other&quot;</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">track =</span> <span class="kw">factor</span>(track, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;IT&quot;</span>, <span class="st">&quot;BA&quot;</span>, <span class="st">&quot;HRC&quot;</span>, <span class="st">&quot;Nur&quot;</span>)),
                <span class="dt">track =</span> <span class="kw">recode_factor</span>(track, <span class="st">&quot;IT&quot;</span> =<span class="st"> &quot;IT&quot;</span>, <span class="st">&quot;BA&quot;</span> =<span class="st"> &quot;BA&quot;</span>, 
                                      <span class="st">&quot;HRC&quot;</span> =<span class="st"> &quot;HRC&quot;</span>, <span class="st">&quot;Nur&quot;</span> =<span class="st"> &quot;Nur&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>ggplot2<span class="op">::</span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">y =</span> track)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">geom_density_ridges2</span>(<span class="kw">aes</span>(<span class="dt">x =</span> padaysLastweek_T1, <span class="dt">fill =</span> intervention), <span class="dt">stat =</span> <span class="st">&quot;binline&quot;</span>, <span class="dt">binwidth =</span> <span class="dv">1</span>, <span class="dt">scale =</span> <span class="fl">0.95</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">7</span>), <span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="dt">name =</span> <span class="ot">NULL</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_discrete</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>), <span class="dt">name =</span> <span class="st">&quot;&quot;</span>, <span class="dt">labels =</span> <span class="ot">NULL</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_fill_cyclical</span>(<span class="dt">values =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">2</span>]) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Control&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">guides</span>(<span class="dt">y =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">theme_ridges</span>(<span class="dt">grid =</span> <span class="ot">FALSE</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>),
        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>),
        <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>, <span class="dt">size =</span> <span class="dv">10</span>),
        <span class="dt">axis.text=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">10</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">0.5</span>, <span class="fl">7.5</span>))

plotcontrol &lt;-<span class="st"> </span>plotcontrol <span class="op">+</span><span class="st"> </span>
<span class="st">  </span>userfriendlyscience<span class="op">::</span><span class="kw">diamondPlot</span>(padaysLastweek_trackintervention_diamonds_intervention, 
                                   <span class="dt">returnLayerOnly =</span> <span class="ot">TRUE</span>, 
                                   <span class="dt">lineColor =</span> <span class="st">&quot;black&quot;</span>,  
                                   <span class="dt">color=</span>viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">4</span>],
                                   <span class="dt">alpha=</span>.<span class="dv">6</span>, 
                                   <span class="dt">fixedSize =</span> <span class="fl">0.1</span>, 
                                   <span class="dt">otherAxisCol =</span> (<span class="dv">1</span><span class="op">:</span><span class="dv">4</span> <span class="op">+</span><span class="st"> </span>.<span class="dv">15</span>)) <span class="op">+</span>
<span class="st">  </span>userfriendlyscience<span class="op">::</span><span class="kw">diamondPlot</span>(padaysLastweek_trackintervention_diamonds_control, 
                                   <span class="dt">returnLayerOnly =</span> <span class="ot">TRUE</span>, 
                                   <span class="dt">lineColor =</span> <span class="st">&quot;black&quot;</span>,  
                                   <span class="dt">color=</span>viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">2</span>],
                                   <span class="dt">alpha=</span>.<span class="dv">6</span>, 
                                   <span class="dt">fixedSize =</span> <span class="fl">0.1</span>, 
                                   <span class="dt">otherAxisCol =</span> (<span class="dv">1</span><span class="op">:</span><span class="dv">4</span> <span class="op">+</span><span class="st"> </span>.<span class="dv">15</span>))

plotintervention &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(id,
                                 <span class="dt">track =</span> track,
                                 intervention,
                                 padaysLastweek_T1)  <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(track), track <span class="op">!=</span><span class="st"> &quot;Other&quot;</span>, intervention <span class="op">==</span><span class="st"> &quot;1&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># Drop category &quot;Other&quot;</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">track =</span> <span class="kw">factor</span>(track, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;IT&quot;</span>, <span class="st">&quot;BA&quot;</span>, <span class="st">&quot;HRC&quot;</span>, <span class="st">&quot;Nur&quot;</span>)),
                <span class="dt">track =</span> <span class="kw">recode_factor</span>(track, <span class="st">&quot;IT&quot;</span> =<span class="st"> &quot;IT&quot;</span>, <span class="st">&quot;BA&quot;</span> =<span class="st"> &quot;BA&quot;</span>, 
                                      <span class="st">&quot;HRC&quot;</span> =<span class="st"> &quot;HRC&quot;</span>, <span class="st">&quot;Nur&quot;</span> =<span class="st"> &quot;Nur&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>ggplot2<span class="op">::</span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">y =</span> track)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">geom_density_ridges2</span>(<span class="kw">aes</span>(<span class="dt">x =</span> padaysLastweek_T1, <span class="dt">fill =</span> intervention), <span class="dt">stat =</span> <span class="st">&quot;binline&quot;</span>, <span class="dt">binwidth =</span> <span class="dv">1</span>, <span class="dt">scale =</span> <span class="fl">0.95</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">7</span>), <span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="dt">name =</span> <span class="ot">NULL</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_discrete</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>), <span class="dt">name =</span> <span class="st">&quot;&quot;</span>, <span class="dt">labels =</span> <span class="ot">NULL</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_fill_cyclical</span>(<span class="dt">values =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">4</span>]) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Intervention&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">guides</span>(<span class="dt">y =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">theme_ridges</span>(<span class="dt">grid =</span> <span class="ot">FALSE</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>),
        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>),
        <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>, <span class="dt">size =</span> <span class="dv">10</span>),
        <span class="dt">axis.text=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">10</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">0.5</span>, <span class="fl">7.5</span>))

plotintervention &lt;-<span class="st"> </span>plotintervention <span class="op">+</span><span class="st"> </span>
<span class="st">  </span>userfriendlyscience<span class="op">::</span><span class="kw">diamondPlot</span>(padaysLastweek_trackintervention_diamonds_intervention, 
                                   <span class="dt">returnLayerOnly =</span> <span class="ot">TRUE</span>, 
                                   <span class="dt">lineColor =</span> <span class="st">&quot;black&quot;</span>,  
                                   <span class="dt">color=</span>viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">4</span>],
                                   <span class="dt">alpha=</span>.<span class="dv">6</span>, 
                                   <span class="dt">fixedSize =</span> <span class="fl">0.1</span>, 
                                   <span class="dt">otherAxisCol =</span> (<span class="dv">1</span><span class="op">:</span><span class="dv">4</span> <span class="op">+</span><span class="st"> </span>.<span class="dv">15</span>)) <span class="op">+</span>
<span class="st">  </span>userfriendlyscience<span class="op">::</span><span class="kw">diamondPlot</span>(padaysLastweek_trackintervention_diamonds_control, 
                                   <span class="dt">returnLayerOnly =</span> <span class="ot">TRUE</span>, 
                                   <span class="dt">lineColor =</span> <span class="st">&quot;black&quot;</span>,  
                                   <span class="dt">color=</span>viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">2</span>],
                                   <span class="dt">alpha=</span>.<span class="dv">6</span>, 
                                   <span class="dt">fixedSize =</span> <span class="fl">0.1</span>, 
                                   <span class="dt">otherAxisCol =</span> (<span class="dv">1</span><span class="op">:</span><span class="dv">4</span> <span class="op">+</span><span class="st"> </span>.<span class="dv">15</span>))

plotboys <span class="op">+</span><span class="st"> </span>plotgirls <span class="op">+</span><span class="st"> </span>plotcontrol <span class="op">+</span><span class="st"> </span>plotintervention <span class="op">+</span><span class="st"> </span><span class="kw">plot_layout</span>(<span class="dt">ncol =</span> <span class="dv">4</span>)
## Warning: Removed 1 rows containing non-finite values (stat_binline).

## Warning: Removed 1 rows containing non-finite values (stat_binline).

## Warning: Removed 1 rows containing non-finite values (stat_binline).

## Warning: Removed 1 rows containing non-finite values (stat_binline).</code></pre></div>
<p><img src="baseline-supplement_files/figure-html/padaysLastweek-histogram1-1.png" width="2100" /></p>
</div>
<div id="histogram-2" class="section level3">
<h3>Histogram 2</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">hist_padaysLastweek_girl_count &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(id,
                                 <span class="dt">track =</span> track,
                                 girl,
                                 padaysLastweek_T1)  <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(track), track <span class="op">!=</span><span class="st"> &quot;Other&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># Drop category &quot;Other&quot;</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">track =</span> <span class="kw">factor</span>(track, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;IT&quot;</span>, <span class="st">&quot;BA&quot;</span>, <span class="st">&quot;HRC&quot;</span>, <span class="st">&quot;Nur&quot;</span>)),
                <span class="dt">track =</span> <span class="kw">recode_factor</span>(track, <span class="st">&quot;IT&quot;</span> =<span class="st"> &quot;IT&quot;</span>, <span class="st">&quot;BA&quot;</span> =<span class="st"> &quot;BA&quot;</span>, 
                                      <span class="st">&quot;HRC&quot;</span> =<span class="st"> &quot;HRC&quot;</span>, <span class="st">&quot;Nur&quot;</span> =<span class="st"> &quot;Nur&quot;</span>),
                <span class="dt">padaysLastweek_T1 =</span> <span class="kw">as.integer</span>(padaysLastweek_T1)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>padaysLastweek_T1, <span class="dt">fill=</span>girl)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth=</span><span class="dv">1</span>, <span class="dt">position=</span><span class="st">&quot;dodge&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">7</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="ot">NULL</span>) <span class="op">+</span><span class="st">   </span>
<span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">1</span>)], 
                    <span class="dt">name =</span> <span class="ot">NULL</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">facet_wrap</span>(<span class="st">&quot;track&quot;</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)

hist_padaysLastweek_girl_density &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(id,
                                 <span class="dt">track =</span> track,
                                 girl,
                                 padaysLastweek_T1)  <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(track), track <span class="op">!=</span><span class="st"> &quot;Other&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># Drop category &quot;Other&quot;</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">track =</span> <span class="kw">factor</span>(track, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;IT&quot;</span>, <span class="st">&quot;BA&quot;</span>, <span class="st">&quot;HRC&quot;</span>, <span class="st">&quot;Nur&quot;</span>)),
                <span class="dt">track =</span> <span class="kw">recode_factor</span>(track, <span class="st">&quot;IT&quot;</span> =<span class="st"> &quot;IT&quot;</span>, <span class="st">&quot;BA&quot;</span> =<span class="st"> &quot;BA&quot;</span>, 
                                      <span class="st">&quot;HRC&quot;</span> =<span class="st"> &quot;HRC&quot;</span>, <span class="st">&quot;Nur&quot;</span> =<span class="st"> &quot;Nur&quot;</span>),
                <span class="dt">padaysLastweek_T1 =</span> <span class="kw">as.integer</span>(padaysLastweek_T1)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>padaysLastweek_T1, <span class="dt">y =</span> ..density.., <span class="dt">fill=</span>girl)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth=</span><span class="dv">1</span>, <span class="dt">position=</span><span class="st">&quot;dodge&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">7</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="ot">NULL</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">1</span>)], <span class="dt">name =</span> <span class="ot">NULL</span>,
                    <span class="dt">guide =</span> <span class="ot">FALSE</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">facet_wrap</span>(<span class="st">&quot;track&quot;</span>)

hist_padaysLastweek_girl_count <span class="op">+</span><span class="st"> </span>hist_padaysLastweek_girl_density
## Warning: Removed 2 rows containing non-finite values (stat_bin).

## Warning: Removed 2 rows containing non-finite values (stat_bin).</code></pre></div>
<p><img src="baseline-supplement_files/figure-html/padaysLastweek-histogram2-1.png" width="2100" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
hist_padaysLastweek_intervention_count &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(id,
                                 <span class="dt">track =</span> track,
                                 intervention,
                                 padaysLastweek_T1)  <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(track), track <span class="op">!=</span><span class="st"> &quot;Other&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># Drop category &quot;Other&quot;</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">track =</span> <span class="kw">factor</span>(track, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;IT&quot;</span>, <span class="st">&quot;BA&quot;</span>, <span class="st">&quot;HRC&quot;</span>, <span class="st">&quot;Nur&quot;</span>)),
                <span class="dt">track =</span> <span class="kw">recode_factor</span>(track, <span class="st">&quot;IT&quot;</span> =<span class="st"> &quot;IT&quot;</span>, <span class="st">&quot;BA&quot;</span> =<span class="st"> &quot;BA&quot;</span>, 
                                      <span class="st">&quot;HRC&quot;</span> =<span class="st"> &quot;HRC&quot;</span>, <span class="st">&quot;Nur&quot;</span> =<span class="st"> &quot;Nur&quot;</span>),
                <span class="dt">padaysLastweek_T1 =</span> <span class="kw">as.integer</span>(padaysLastweek_T1)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>padaysLastweek_T1, <span class="dt">fill=</span>intervention)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="dv">1</span>, <span class="dt">position =</span> <span class="st">&quot;dodge&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">7</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="ot">NULL</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">4</span>)], 
                    <span class="dt">name =</span> <span class="ot">NULL</span>, 
                    <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;0&quot;</span> =<span class="st"> &quot;control&quot;</span>, <span class="st">&quot;1&quot;</span> =<span class="st"> &quot;intervention&quot;</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">facet_wrap</span>(<span class="st">&quot;track&quot;</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)

hist_padaysLastweek_intervention_density &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(id,
                                 <span class="dt">track =</span> track,
                                 intervention,
                                 padaysLastweek_T1)  <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(track), track <span class="op">!=</span><span class="st"> &quot;Other&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># Drop category &quot;Other&quot;</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">track =</span> <span class="kw">factor</span>(track, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;IT&quot;</span>, <span class="st">&quot;BA&quot;</span>, <span class="st">&quot;HRC&quot;</span>, <span class="st">&quot;Nur&quot;</span>)),
                <span class="dt">track =</span> <span class="kw">recode_factor</span>(track, <span class="st">&quot;IT&quot;</span> =<span class="st"> &quot;IT&quot;</span>, <span class="st">&quot;BA&quot;</span> =<span class="st"> &quot;BA&quot;</span>, 
                                      <span class="st">&quot;HRC&quot;</span> =<span class="st"> &quot;HRC&quot;</span>, <span class="st">&quot;Nur&quot;</span> =<span class="st"> &quot;Nur&quot;</span>),
                <span class="dt">padaysLastweek_T1 =</span> <span class="kw">as.integer</span>(padaysLastweek_T1)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>padaysLastweek_T1, <span class="dt">y =</span> ..density.., <span class="dt">fill=</span>intervention)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="dv">1</span>, <span class="dt">position =</span> <span class="st">&quot;dodge&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">7</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="ot">NULL</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">4</span>)], 
                    <span class="dt">guide =</span> <span class="ot">FALSE</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">facet_wrap</span>(<span class="st">&quot;track&quot;</span>)

hist_padaysLastweek_intervention_count <span class="op">+</span><span class="st"> </span>hist_padaysLastweek_intervention_density
## Warning: Removed 2 rows containing non-finite values (stat_bin).

## Warning: Removed 2 rows containing non-finite values (stat_bin).</code></pre></div>
<p><img src="baseline-supplement_files/figure-html/padaysLastweek-histogram2-2.png" width="2100" /></p>
</div>
</div>
<div id="breaks-in-sedentary-time" class="section level2">
<h2>Breaks in sedentary time</h2>
<p>This section reports the accelerometer-measured number of breaks to sitting time.</p>
<div id="data-preparation-2" class="section level3 tabset">
<h3>Data preparation</h3>
<div id="description-3" class="section level4">
<h4>Description</h4>
<p>The tab “Information on data preparation” of this section present information on data preparation for the plot</p>
</div>
<div id="information-on-data-preparation-2" class="section level4">
<h4>Information on data preparation</h4>
<p>Code chunk below prepares data.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m_sitBreaksAccelerometer_trackgirl &lt;-<span class="st"> </span>brms<span class="op">::</span><span class="kw">bf</span>(sitBreaksAccelerometer_T1 <span class="op">~</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>track<span class="op">:</span>girl)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>brms<span class="op">::</span><span class="kw">brm</span>(., <span class="dt">data =</span> df, <span class="dt">chains =</span> <span class="dv">4</span>, <span class="dt">iter =</span> <span class="dv">4000</span>, <span class="dt">control =</span> <span class="kw">list</span>(<span class="dt">adapt_delta =</span> <span class="fl">0.95</span>))
## Found more than one class &quot;family&quot; in cache; using the first, from namespace &#39;lme4&#39;
## Also defined by &#39;MatrixModels&#39;
## Warning: Rows containing NAs were excluded from the model
## Compiling the C++ model
## Warning: running command &#39;C:/PROGRA~1/R/R-34~1.3/bin/x64/R CMD SHLIB
## file5d8493f616e.cpp 2&gt; file5d8493f616e.cpp.err.txt&#39; had status 1
## Error in compileCode(f, code, language = language, verbose = verbose): Compilation ERROR, function(s)/method(s) not created!       1 [main] make (4576) c:\HYAPP\Rtools3.4\bin\make.exe: *** fatal error - cygheap base mismatch detected - 0xF77408/0xE97408.
## This problem is probably due to using incompatible versions of the cygwin DLL.
## Search for cygwin1.dll using the Windows Start-&gt;Find/Search facility
## and delete all but the most recent version.  The most recent version *should*
## reside in x:\cygwin\bin, where &#39;x&#39; is the drive on which you have
## installed the cygwin distribution.  Rebooting is also suggested if you
## are unable to find another cygwin DLL.
##       1 [main] make 4076 fork: child -1 - forked process 4576 died unexpectedly, retry 0, exit code 0xC0000142, errno 11
## make: vfork: Resource temporarily unavailable
## Warning message:
## running command &#39;make -f &quot;C:/PROGRA~1/R/R-34~1.3/etc/x64/Makeconf&quot; -f &quot;C:/PROGRA~1/R/R-34~1.3/share/make/winshlib.mk&quot; -f &quot;//ATKK/home/h/hema/Documents/.R/Makevars&quot; SHLIB_LDFLAGS=&#39;$(SHLIB_CXXLDFLAGS)&#39; SHLIB_LD=&#39;$(SHLIB_CXXLD)&#39; SHLIB=&quot;file5d8493f616e.dll&quot; WIN=64 TCLBIN=64 OBJECTS=&quot;file5d8493f616e.o&quot;&#39; had status 2

brms<span class="op">::</span><span class="kw">prior_summary</span>(m_sitBreaksAccelerometer_trackgirl, <span class="dt">data =</span> df)
## Error in brms::prior_summary(m_sitBreaksAccelerometer_trackgirl, data = df): object &#39;m_sitBreaksAccelerometer_trackgirl&#39; not found

m_sitBreaksAccelerometer_trackgirl
## Error in eval(expr, envir, enclos): object &#39;m_sitBreaksAccelerometer_trackgirl&#39; not found

b_intercept &lt;-<span class="st"> </span>brms<span class="op">::</span><span class="kw">fixef</span>(m_sitBreaksAccelerometer_trackgirl)[<span class="dv">1</span>]
## Error in brms::fixef(m_sitBreaksAccelerometer_trackgirl): object &#39;m_sitBreaksAccelerometer_trackgirl&#39; not found

<span class="co"># This gives estimates only:</span>
sitBreaksAccelerometer_trackgirl_estimates &lt;-<span class="st"> </span>brms<span class="op">::</span><span class="kw">ranef</span>(m_sitBreaksAccelerometer_trackgirl)[[<span class="dv">1</span>]][<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]
## Error in brms::ranef(m_sitBreaksAccelerometer_trackgirl): object &#39;m_sitBreaksAccelerometer_trackgirl&#39; not found

<span class="co"># The 2.5%ile:</span>
sitBreaksAccelerometer_trackgirl_CIL &lt;-<span class="st"> </span>brms<span class="op">::</span><span class="kw">ranef</span>(m_sitBreaksAccelerometer_trackgirl)[[<span class="dv">1</span>]][<span class="dv">21</span><span class="op">:</span><span class="dv">30</span>]
## Error in brms::ranef(m_sitBreaksAccelerometer_trackgirl): object &#39;m_sitBreaksAccelerometer_trackgirl&#39; not found

<span class="co"># The 97.5%ile:</span>
sitBreaksAccelerometer_trackgirl_CIH &lt;-<span class="st"> </span>brms<span class="op">::</span><span class="kw">ranef</span>(m_sitBreaksAccelerometer_trackgirl)[[<span class="dv">1</span>]][<span class="dv">31</span><span class="op">:</span><span class="dv">40</span>]
## Error in brms::ranef(m_sitBreaksAccelerometer_trackgirl): object &#39;m_sitBreaksAccelerometer_trackgirl&#39; not found

sitBreaksAccelerometer_trackgirl_ci &lt;-<span class="st"> </span><span class="kw">data.frame</span>(sitBreaksAccelerometer_trackgirl_CIL, sitBreaksAccelerometer_trackgirl_estimates, sitBreaksAccelerometer_trackgirl_CIH, <span class="dt">Variable =</span> <span class="kw">labels</span>(brms<span class="op">::</span><span class="kw">ranef</span>(m_sitBreaksAccelerometer_trackgirl))) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">b_intercept =</span> <span class="kw">rep</span>(b_intercept, <span class="dv">10</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">sitBreaksAccelerometer_trackgirl_CIL =</span> sitBreaksAccelerometer_trackgirl_CIL <span class="op">+</span><span class="st"> </span>b_intercept,
         <span class="dt">sitBreaksAccelerometer_trackgirl_estimates =</span> sitBreaksAccelerometer_trackgirl_estimates <span class="op">+</span><span class="st"> </span>b_intercept,
         <span class="dt">sitBreaksAccelerometer_trackgirl_CIH =</span> sitBreaksAccelerometer_trackgirl_CIH <span class="op">+</span><span class="st"> </span>b_intercept,
         <span class="dt">track =</span> <span class="kw">c</span>(<span class="st">&#39;BA_boy&#39;</span>,
                   <span class="st">&#39;BA_girl&#39;</span>,
                   <span class="st">&#39;HRC_boy&#39;</span>,
                   <span class="st">&#39;HRC_girl&#39;</span>,
                   <span class="st">&#39;IT_boy&#39;</span>,
                   <span class="st">&#39;IT_girl&#39;</span>,
                   <span class="st">&#39;Nur_boy&#39;</span>,
                   <span class="st">&#39;Nur_girl&#39;</span>,
                   <span class="st">&#39;Other_boy&#39;</span>,
                   <span class="st">&#39;Other_girl&#39;</span>
))
## Error in data.frame(sitBreaksAccelerometer_trackgirl_CIL, sitBreaksAccelerometer_trackgirl_estimates, : object &#39;sitBreaksAccelerometer_trackgirl_CIL&#39; not found

sitBreaksAccelerometer_trackgirl_diamonds_girl &lt;-<span class="st"> </span><span class="kw">rbind</span>(
sitBreaksAccelerometer_trackgirl_ci <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;Nur_girl&quot;</span>),
sitBreaksAccelerometer_trackgirl_ci <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;HRC_girl&quot;</span>),
sitBreaksAccelerometer_trackgirl_ci <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;BA_girl&quot;</span>),
sitBreaksAccelerometer_trackgirl_ci <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;IT_girl&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">arrange</span>(<span class="op">-</span><span class="kw">row_number</span>()) <span class="co"># reverse order of rows to make them right for the plot to come</span>
## Error in eval(lhs, parent, parent): object &#39;sitBreaksAccelerometer_trackgirl_ci&#39; not found

sitBreaksAccelerometer_trackgirl_diamonds_boy &lt;-<span class="st"> </span><span class="kw">rbind</span>(
sitBreaksAccelerometer_trackgirl_ci <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;Nur_boy&quot;</span>),
sitBreaksAccelerometer_trackgirl_ci <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;HRC_boy&quot;</span>),
sitBreaksAccelerometer_trackgirl_ci <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;BA_boy&quot;</span>),
sitBreaksAccelerometer_trackgirl_ci <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;IT_boy&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">arrange</span>(<span class="op">-</span><span class="kw">row_number</span>()) <span class="co"># reverse order of rows to make them right for the plot to come</span>
## Error in eval(lhs, parent, parent): object &#39;sitBreaksAccelerometer_trackgirl_ci&#39; not found


m_sitBreaksAccelerometer_trackintervention &lt;-<span class="st"> </span>brms<span class="op">::</span><span class="kw">bf</span>(sitBreaksAccelerometer_T1 <span class="op">~</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>track<span class="op">:</span>intervention)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>brms<span class="op">::</span><span class="kw">brm</span>(., <span class="dt">data =</span> df, <span class="dt">chains =</span> <span class="dv">4</span>, <span class="dt">iter =</span> <span class="dv">4000</span>, <span class="dt">control =</span> <span class="kw">list</span>(<span class="dt">adapt_delta =</span> <span class="fl">0.95</span>))
## Found more than one class &quot;family&quot; in cache; using the first, from namespace &#39;lme4&#39;
## Also defined by &#39;MatrixModels&#39;
## Warning: Rows containing NAs were excluded from the model
## Compiling the C++ model
## Warning: running command &#39;C:/PROGRA~1/R/R-34~1.3/bin/x64/R CMD SHLIB
## file5d8725e6b4d.cpp 2&gt; file5d8725e6b4d.cpp.err.txt&#39; had status 1
## Error in compileCode(f, code, language = language, verbose = verbose): Compilation ERROR, function(s)/method(s) not created!       0 [main] make (16636) c:\HYAPP\Rtools3.4\bin\make.exe: *** fatal error - cygheap base mismatch detected - 0xD57408/0xDD7408.
## This problem is probably due to using incompatible versions of the cygwin DLL.
## Search for cygwin1.dll using the Windows Start-&gt;Find/Search facility
## and delete all but the most recent version.  The most recent version *should*
## reside in x:\cygwin\bin, where &#39;x&#39; is the drive on which you have
## installed the cygwin distribution.  Rebooting is also suggested if you
## are unable to find another cygwin DLL.
##       0 [main] make 13600 fork: child -1 - forked process 16636 died unexpectedly, retry 0, exit code 0xC0000142, errno 11
## make: vfork: Resource temporarily unavailable
## Warning message:
## running command &#39;make -f &quot;C:/PROGRA~1/R/R-34~1.3/etc/x64/Makeconf&quot; -f &quot;C:/PROGRA~1/R/R-34~1.3/share/make/winshlib.mk&quot; -f &quot;//ATKK/home/h/hema/Documents/.R/Makevars&quot; SHLIB_LDFLAGS=&#39;$(SHLIB_CXXLDFLAGS)&#39; SHLIB_LD=&#39;$(SHLIB_CXXLD)&#39; SHLIB=&quot;file5d8725e6b4d.dll&quot; WIN=64 TCLBIN=64 OBJECTS=&quot;file5d8725e6b4d.o&quot;&#39; had status 2

brms<span class="op">::</span><span class="kw">prior_summary</span>(m_sitBreaksAccelerometer_trackintervention, <span class="dt">data =</span> df)
## Error in brms::prior_summary(m_sitBreaksAccelerometer_trackintervention, : object &#39;m_sitBreaksAccelerometer_trackintervention&#39; not found

m_sitBreaksAccelerometer_trackintervention
## Error in eval(expr, envir, enclos): object &#39;m_sitBreaksAccelerometer_trackintervention&#39; not found

b_intercept &lt;-<span class="st"> </span>brms<span class="op">::</span><span class="kw">fixef</span>(m_sitBreaksAccelerometer_trackintervention)[<span class="dv">1</span>]
## Error in brms::fixef(m_sitBreaksAccelerometer_trackintervention): object &#39;m_sitBreaksAccelerometer_trackintervention&#39; not found

<span class="co"># This gives estimates only:</span>
sitBreaksAccelerometer_trackintervention_estimates &lt;-<span class="st"> </span>brms<span class="op">::</span><span class="kw">ranef</span>(m_sitBreaksAccelerometer_trackintervention)[[<span class="dv">1</span>]][<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]
## Error in brms::ranef(m_sitBreaksAccelerometer_trackintervention): object &#39;m_sitBreaksAccelerometer_trackintervention&#39; not found

<span class="co"># The 2.5%ile:</span>
sitBreaksAccelerometer_trackintervention_CIL &lt;-<span class="st"> </span>brms<span class="op">::</span><span class="kw">ranef</span>(m_sitBreaksAccelerometer_trackintervention)[[<span class="dv">1</span>]][<span class="dv">21</span><span class="op">:</span><span class="dv">30</span>]
## Error in brms::ranef(m_sitBreaksAccelerometer_trackintervention): object &#39;m_sitBreaksAccelerometer_trackintervention&#39; not found

<span class="co"># The 97.5%ile:</span>
sitBreaksAccelerometer_trackintervention_CIH &lt;-<span class="st"> </span>brms<span class="op">::</span><span class="kw">ranef</span>(m_sitBreaksAccelerometer_trackintervention)[[<span class="dv">1</span>]][<span class="dv">31</span><span class="op">:</span><span class="dv">40</span>]
## Error in brms::ranef(m_sitBreaksAccelerometer_trackintervention): object &#39;m_sitBreaksAccelerometer_trackintervention&#39; not found

sitBreaksAccelerometer_trackintervention_ci &lt;-<span class="st"> </span><span class="kw">data.frame</span>(sitBreaksAccelerometer_trackintervention_CIL, sitBreaksAccelerometer_trackintervention_estimates, sitBreaksAccelerometer_trackintervention_CIH, <span class="dt">Variable =</span> <span class="kw">labels</span>(brms<span class="op">::</span><span class="kw">ranef</span>(m_sitBreaksAccelerometer_trackintervention))) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">b_intercept =</span> <span class="kw">rep</span>(b_intercept, <span class="dv">10</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">sitBreaksAccelerometer_trackintervention_CIL =</span> sitBreaksAccelerometer_trackintervention_CIL <span class="op">+</span><span class="st"> </span>b_intercept,
         <span class="dt">sitBreaksAccelerometer_trackintervention_estimates =</span> sitBreaksAccelerometer_trackintervention_estimates <span class="op">+</span><span class="st"> </span>b_intercept,
         <span class="dt">sitBreaksAccelerometer_trackintervention_CIH =</span> sitBreaksAccelerometer_trackintervention_CIH <span class="op">+</span><span class="st"> </span>b_intercept,
         <span class="dt">track =</span> <span class="kw">c</span>(<span class="st">&#39;BA_control&#39;</span>,
                   <span class="st">&#39;BA_intervention&#39;</span>,
                   <span class="st">&#39;HRC_control&#39;</span>,
                   <span class="st">&#39;HRC_intervention&#39;</span>,
                   <span class="st">&#39;IT_control&#39;</span>,
                   <span class="st">&#39;IT_intervention&#39;</span>,
                   <span class="st">&#39;Nur_control&#39;</span>,
                   <span class="st">&#39;Nur_intervention&#39;</span>,
                   <span class="st">&#39;Other_control&#39;</span>,
                   <span class="st">&#39;Other_intervention&#39;</span>
))
## Error in data.frame(sitBreaksAccelerometer_trackintervention_CIL, sitBreaksAccelerometer_trackintervention_estimates, : object &#39;sitBreaksAccelerometer_trackintervention_CIL&#39; not found

sitBreaksAccelerometer_trackintervention_diamonds_intervention &lt;-<span class="st"> </span><span class="kw">rbind</span>(
sitBreaksAccelerometer_trackintervention_ci <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;Nur_intervention&quot;</span>),
sitBreaksAccelerometer_trackintervention_ci <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;HRC_intervention&quot;</span>),
sitBreaksAccelerometer_trackintervention_ci <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;BA_intervention&quot;</span>),
sitBreaksAccelerometer_trackintervention_ci <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;IT_intervention&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">arrange</span>(<span class="op">-</span><span class="kw">row_number</span>()) <span class="co"># reverse order of rows to make them right for the plot to come</span>
## Error in eval(lhs, parent, parent): object &#39;sitBreaksAccelerometer_trackintervention_ci&#39; not found

sitBreaksAccelerometer_trackintervention_diamonds_control &lt;-<span class="st"> </span><span class="kw">rbind</span>(
sitBreaksAccelerometer_trackintervention_ci <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;Nur_control&quot;</span>),
sitBreaksAccelerometer_trackintervention_ci <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;HRC_control&quot;</span>),
sitBreaksAccelerometer_trackintervention_ci <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;BA_control&quot;</span>),
sitBreaksAccelerometer_trackintervention_ci <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;IT_control&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">arrange</span>(<span class="op">-</span><span class="kw">row_number</span>()) <span class="co"># reverse order of rows to make them right for the plot to come</span>
## Error in eval(lhs, parent, parent): object &#39;sitBreaksAccelerometer_trackintervention_ci&#39; not found</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
sitBreaksAccelerometer_trackgirl_diamonds_girl <span class="op">%&gt;%</span><span class="st"> </span>DT<span class="op">::</span><span class="kw">datatable</span>() <span class="co">#papaja::apa_table()</span>
## Error in eval(lhs, parent, parent): object &#39;sitBreaksAccelerometer_trackgirl_diamonds_girl&#39; not found
sitBreaksAccelerometer_trackgirl_diamonds_boy <span class="op">%&gt;%</span><span class="st"> </span>DT<span class="op">::</span><span class="kw">datatable</span>() <span class="co">#papaja::apa_table()</span>
## Error in eval(lhs, parent, parent): object &#39;sitBreaksAccelerometer_trackgirl_diamonds_boy&#39; not found
sitBreaksAccelerometer_trackintervention_diamonds_intervention <span class="op">%&gt;%</span><span class="st"> </span>DT<span class="op">::</span><span class="kw">datatable</span>() <span class="co">#papaja::apa_table()</span>
## Error in eval(lhs, parent, parent): object &#39;sitBreaksAccelerometer_trackintervention_diamonds_intervention&#39; not found
sitBreaksAccelerometer_trackintervention_diamonds_control <span class="op">%&gt;%</span><span class="st"> </span>DT<span class="op">::</span><span class="kw">datatable</span>() <span class="co">#papaja::apa_table()</span>
## Error in eval(lhs, parent, parent): object &#39;sitBreaksAccelerometer_trackintervention_diamonds_control&#39; not found</code></pre></div>
</div>
</div>
<div id="density-plot-by-intervention-and-gender-2" class="section level3">
<h3>Density plot by intervention and gender</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># Create data frame</span>
densplot &lt;-<span class="st"> </span>d
<span class="kw">levels</span>(densplot<span class="op">$</span>intervention) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Control&quot;</span>, <span class="st">&quot;Intervention&quot;</span>)
<span class="kw">levels</span>(densplot<span class="op">$</span>girl) &lt;-<span class="st"> </span><span class="kw">recode</span>(densplot<span class="op">$</span>girl, <span class="st">&quot;boy&quot;</span> =<span class="st"> &quot;Boys&quot;</span>, <span class="st">&quot;girl&quot;</span> =<span class="st"> &quot;Girls&quot;</span>)

<span class="co"># This gives side-by-side plots. There&#39;s a third plot below the two, which is fake to include x-axis text.</span>
<span class="kw">layout</span>(<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">3</span>), <span class="dt">nrow =</span> <span class="dv">2</span>, <span class="dt">ncol =</span> <span class="dv">2</span>, <span class="dt">byrow =</span> <span class="ot">TRUE</span>),
       <span class="dt">widths =</span> <span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>),<span class="dt">heights =</span> <span class="kw">c</span>(<span class="fl">0.45</span>,<span class="fl">0.05</span>))

<span class="co"># Minimise whitespace; see https://stackoverflow.com/questions/15848942/how-to-reduce-space-gap-between-multiple-graphs-in-r</span>
<span class="kw">par</span>(<span class="dt">mai =</span> <span class="kw">c</span>(<span class="fl">0.3</span>, <span class="fl">0.3</span>, <span class="fl">0.1</span>, <span class="fl">0.0</span>)) 

## Girls vs. boys
<span class="co"># Choose only the variables needed and drop NA</span>
dens &lt;-<span class="st"> </span>densplot <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(sitBreaksAccelerometer_T1, girl) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="kw">complete.cases</span>(.))

<span class="co"># Set random number generator for reproducibility of bootstrap test of equal densities</span>
<span class="kw">set.seed</span>(<span class="dv">10</span>)

<span class="co"># Make plot</span>
sm.sitBreaksAccelerometer_T1_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">sm.density.compare2</span>(<span class="kw">as.numeric</span>(dens<span class="op">$</span>sitBreaksAccelerometer_T1), 
                                               <span class="kw">as.factor</span>(dens<span class="op">$</span>girl), 
                                               <span class="dt">model =</span> <span class="st">&quot;equal&quot;</span>,
                                               <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>,
                                               <span class="dt">col =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end  =</span>  <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">1</span>)], 
                                               <span class="dt">lty =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>), <span class="dt">yaxt =</span> <span class="st">&quot;n&quot;</span>,
                                               <span class="dt">bandcol =</span> <span class="st">&#39;LightGray&#39;</span>, 
                                               <span class="dt">lwd =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))
## 
## Test of equal densities:  p-value =  0
<span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="kw">levels</span>(dens<span class="op">$</span>girl), <span class="dt">col =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>)], <span class="dt">lty =</span> <span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">1</span>), <span class="dt">lwd =</span> (<span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>)))
<span class="kw">mtext</span>(<span class="dt">side =</span> <span class="dv">2</span>, <span class="st">&quot;Density&quot;</span>, <span class="dt">line =</span> <span class="fl">0.5</span>)

## Intervention vs. control
<span class="co"># Choose only the variables needed and drop NA</span>
dens &lt;-<span class="st"> </span>densplot <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(sitBreaksAccelerometer_T1, intervention) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="kw">complete.cases</span>(.))

<span class="co"># Set random number generator for reproducibility of bootstrap test of equal densities</span>
<span class="kw">set.seed</span>(<span class="dv">10</span>)
<span class="co"># Make plot</span>
sm.sitBreaksAccelerometer_T1_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">sm.density.compare2</span>(<span class="kw">as.numeric</span>(dens<span class="op">$</span>sitBreaksAccelerometer_T1), 
                                               <span class="kw">as.factor</span>(dens<span class="op">$</span>intervention), 
                                               <span class="dt">model =</span> <span class="st">&quot;equal&quot;</span>, 
                                               <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>,
                                               <span class="dt">col =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">4</span>)], 
                                               <span class="dt">lty =</span> <span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">1</span>), <span class="dt">yaxt =</span> <span class="st">&quot;n&quot;</span>,
                                               <span class="dt">bandcol =</span> <span class="st">&#39;LightGray&#39;</span>, 
                                               <span class="dt">lwd =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))
## 
## Test of equal densities:  p-value =  0.2
<span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="kw">levels</span>(dens<span class="op">$</span>intervention), <span class="dt">col =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">4</span>)], <span class="dt">lty=</span><span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">1</span>), <span class="dt">lwd=</span>(<span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>)))

<span class="co"># Create x-axis label. See https://stackoverflow.com/questions/11198767/how-to-annotate-across-or-between-plots-in-multi-plot-panels-in-r</span>
<span class="kw">par</span>(<span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>)) 
<span class="kw">plot</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dt">type =</span> <span class="st">&quot;n&quot;</span>, <span class="dt">frame.plot =</span> <span class="ot">FALSE</span>,<span class="dt">axes =</span> <span class="ot">FALSE</span>) <span class="co"># Fake plot</span>
<span class="kw">text</span>(<span class="dt">x =</span> <span class="fl">1.02</span>, <span class="dt">y =</span> <span class="fl">1.3</span>, <span class="dt">labels =</span> <span class="st">&quot;Average number of breaks in daily sitting&quot;</span>, <span class="dt">pos =</span> <span class="dv">1</span>)</code></pre></div>
<p><img src="baseline-supplement_files/figure-html/sitBreaksAccelerometer-sm-1.png" width="2100" /></p>
</div>
<div id="density-plot-by-track-2" class="section level3">
<h3>Density plot by track</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
plot1 &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(id,
                              <span class="dt">track =</span> track,
                              girl,
                              <span class="dt">PA =</span> sitBreaksAccelerometer_T1)  <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(track), track <span class="op">!=</span><span class="st"> &quot;Other&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># Drop category &quot;Other&quot;</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">track =</span> <span class="kw">factor</span>(track, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;IT&quot;</span>, <span class="st">&quot;BA&quot;</span>, <span class="st">&quot;HRC&quot;</span>, <span class="st">&quot;Nur&quot;</span>)),
                <span class="dt">track =</span> <span class="kw">recode_factor</span>(track, <span class="st">&quot;IT&quot;</span> =<span class="st"> &quot;IT&quot;</span>, <span class="st">&quot;BA&quot;</span> =<span class="st"> &quot;BA&quot;</span>, 
                                      <span class="st">&quot;HRC&quot;</span> =<span class="st"> &quot;HRC&quot;</span>, <span class="st">&quot;Nur&quot;</span> =<span class="st"> &quot;Nur&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>ggplot2<span class="op">::</span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">y =</span> track)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">geom_density_ridges2</span>(<span class="kw">aes</span>(<span class="dt">x =</span> PA, <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>, 
                                    <span class="dt">fill =</span> <span class="kw">paste</span>(track, girl),
                                    <span class="dt">point_color =</span> girl,
                                    <span class="dt">point_fill =</span> girl,
                                    <span class="dt">point_shape =</span> girl),
                                  <span class="dt">scale =</span> .<span class="dv">6</span>, <span class="dt">alpha =</span> <span class="fl">0.6</span>, <span class="dt">size =</span> <span class="fl">0.25</span>,
                                  <span class="dt">position =</span> <span class="kw">position_raincloud</span>(<span class="dt">width =</span> <span class="fl">0.2</span>, <span class="dt">height =</span> <span class="fl">0.15</span>),
                                  <span class="co"># from = 0, to = 450,</span>
                                  <span class="dt">jittered_points =</span> <span class="ot">TRUE</span>,
                                  <span class="dt">point_size =</span> <span class="dv">1</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="ot">NULL</span>,
       <span class="dt">y =</span> <span class="ot">NULL</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_discrete</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.1</span>, <span class="dv">0</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_fill_cyclical</span>(
                                <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&#39;BA boy&#39;</span> =<span class="st"> &quot;Boy&quot;</span>, <span class="st">&#39;BA girl&#39;</span> =<span class="st"> &quot;Girl&quot;</span>),
                                <span class="dt">values =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>)],
                                <span class="dt">name =</span> <span class="st">&quot;&quot;</span>, 
                                <span class="dt">guide =</span> <span class="kw">guide_legend</span>(<span class="dt">override.aes =</span> <span class="kw">list</span>(<span class="dt">alpha =</span> <span class="dv">1</span>, 
                                                                         <span class="dt">point_shape =</span> <span class="kw">c</span>(<span class="dv">24</span>, <span class="dv">4</span>),
                                                                         <span class="dt">point_size =</span> <span class="dv">2</span>))) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_colour_cyclical</span>(<span class="dt">values =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">theme_ridges</span>(<span class="dt">grid =</span> <span class="ot">FALSE</span>) <span class="op">+</span>
<span class="st">  </span><span class="co"># ggplot2::scale_fill_manual(values = c(&quot;#A0FFA0&quot;, &quot;#A0A0FF&quot;)) +</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_discrete_manual</span>(<span class="dt">aesthetics =</span> <span class="st">&quot;point_color&quot;</span>, 
                                  <span class="dt">values =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">1</span>)],
                                  <span class="dt">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_discrete_manual</span>(<span class="dt">aesthetics =</span> <span class="st">&quot;point_fill&quot;</span>,
                                  <span class="dt">values =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">1</span>)],
                                  <span class="dt">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_discrete_manual</span>(<span class="dt">aesthetics =</span> <span class="st">&quot;point_shape&quot;</span>, 
                                  <span class="dt">values =</span> <span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">24</span>),
                                  <span class="dt">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>papaja<span class="op">::</span><span class="kw">theme_apa</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)

plot1 &lt;-<span class="st"> </span>plot1 <span class="op">+</span><span class="st"> </span>
<span class="st">  </span>userfriendlyscience<span class="op">::</span><span class="kw">diamondPlot</span>(sitBreaksAccelerometer_trackgirl_diamonds_girl, 
                                   <span class="dt">returnLayerOnly =</span> <span class="ot">TRUE</span>, 
                                   <span class="dt">lineColor =</span> <span class="st">&quot;black&quot;</span>, 
                                   <span class="dt">color=</span>viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">3</span>],
                                   <span class="dt">alpha=</span>.<span class="dv">6</span>, 
                                   <span class="dt">fixedSize =</span> <span class="fl">0.1</span>, 
                                   <span class="dt">otherAxisCol =</span> (<span class="dv">1</span><span class="op">:</span><span class="dv">4</span> <span class="op">+</span><span class="st"> </span>.<span class="dv">15</span>)) <span class="op">+</span><span class="st"> </span><span class="co"># specify y-position; option to move the diamond </span>
<span class="st">  </span>userfriendlyscience<span class="op">::</span><span class="kw">diamondPlot</span>(sitBreaksAccelerometer_trackgirl_diamonds_boy, 
                                   <span class="dt">returnLayerOnly =</span> <span class="ot">TRUE</span>, 
                                   <span class="dt">lineColor =</span> <span class="st">&quot;black&quot;</span>, 
                                   <span class="dt">linetype =</span> <span class="st">&quot;solid&quot;</span>, 
                                   <span class="dt">color=</span>viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">1</span>],
                                   <span class="dt">alpha=</span>.<span class="dv">6</span>, 
                                   <span class="dt">fixedSize =</span> <span class="fl">0.1</span>, 
                                   <span class="dt">otherAxisCol =</span> (<span class="dv">1</span><span class="op">:</span><span class="dv">4</span> <span class="op">+</span><span class="st"> </span>.<span class="dv">15</span>))
## Error in nrow(data): object &#39;sitBreaksAccelerometer_trackgirl_diamonds_girl&#39; not found

<span class="co"># Draw plot with intervention and control densities</span>

plot2 &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(id,
                              <span class="dt">track =</span> track,
                              intervention,
                              <span class="dt">PA =</span> sitBreaksAccelerometer_T1)  <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(track), track <span class="op">!=</span><span class="st"> &quot;Other&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># Drop category &quot;Other&quot;</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">track =</span> <span class="kw">factor</span>(track, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;IT&quot;</span>, <span class="st">&quot;BA&quot;</span>, <span class="st">&quot;HRC&quot;</span>, <span class="st">&quot;Nur&quot;</span>)),
                <span class="dt">track =</span> <span class="kw">recode_factor</span>(track, <span class="st">&quot;IT&quot;</span> =<span class="st"> &quot;IT&quot;</span>, <span class="st">&quot;BA&quot;</span> =<span class="st"> &quot;BA&quot;</span>, 
                                      <span class="st">&quot;HRC&quot;</span> =<span class="st"> &quot;HRC&quot;</span>, <span class="st">&quot;Nur&quot;</span> =<span class="st"> &quot;Nur&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>ggplot2<span class="op">::</span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">y =</span> track)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">geom_density_ridges2</span>(<span class="kw">aes</span>(<span class="dt">x =</span> PA, <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>, 
                                    <span class="dt">fill =</span> <span class="kw">paste</span>(track, intervention),
                                    <span class="dt">point_color =</span> intervention,
                                    <span class="dt">point_fill =</span> intervention,
                                    <span class="dt">point_shape =</span> intervention),
                                  <span class="dt">scale =</span> .<span class="dv">6</span>, <span class="dt">alpha =</span> <span class="fl">0.6</span>, <span class="dt">size =</span> <span class="fl">0.25</span>,
                                  <span class="dt">position =</span> <span class="kw">position_raincloud</span>(<span class="dt">width =</span> <span class="fl">0.2</span>, <span class="dt">height =</span> <span class="fl">0.15</span>),
                                  <span class="co"># from = 0, to = 450,</span>
                                  <span class="dt">jittered_points =</span> <span class="ot">TRUE</span>,
                                  <span class="dt">point_size =</span> <span class="dv">1</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="ot">NULL</span>,
       <span class="dt">y =</span> <span class="ot">NULL</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_discrete</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.1</span>, <span class="dv">0</span>), <span class="dt">labels =</span> <span class="ot">NULL</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_fill_cyclical</span>(
                                <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&#39;BA 0&#39;</span> =<span class="st"> &quot;Control&quot;</span>, <span class="st">&#39;BA 1&#39;</span> =<span class="st"> &quot;Intervention&quot;</span>),
                                <span class="dt">values =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">4</span>)],
                                <span class="dt">name =</span> <span class="st">&quot;&quot;</span>, 
                                <span class="dt">guide =</span> <span class="kw">guide_legend</span>(<span class="dt">override.aes =</span> <span class="kw">list</span>(<span class="dt">alpha =</span> <span class="dv">1</span>, 
                                                                         <span class="dt">point_shape =</span> <span class="kw">c</span>(<span class="dv">21</span>, <span class="dv">3</span>),
                                                                         <span class="dt">point_size =</span> <span class="dv">2</span>))) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_colour_cyclical</span>(<span class="dt">values =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">theme_ridges</span>(<span class="dt">grid =</span> <span class="ot">FALSE</span>) <span class="op">+</span>
<span class="st">  </span><span class="co"># ggplot2::scale_fill_manual(values = c(&quot;#A0FFA0&quot;, &quot;#A0A0FF&quot;)) +</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_discrete_manual</span>(<span class="dt">aesthetics =</span> <span class="st">&quot;point_color&quot;</span>, 
                                  <span class="dt">values =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">4</span>)],
                                  <span class="dt">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_discrete_manual</span>(<span class="dt">aesthetics =</span> <span class="st">&quot;point_fill&quot;</span>,
                                  <span class="dt">values =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">4</span>)],
                                  <span class="dt">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_discrete_manual</span>(<span class="dt">aesthetics =</span> <span class="st">&quot;point_shape&quot;</span>, 
                                  <span class="dt">values =</span> <span class="kw">c</span>(<span class="dv">21</span>, <span class="dv">3</span>),
                                  <span class="dt">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>papaja<span class="op">::</span><span class="kw">theme_apa</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)

plot2 &lt;-<span class="st"> </span>plot2 <span class="op">+</span><span class="st"> </span>
<span class="st">  </span>userfriendlyscience<span class="op">::</span><span class="kw">diamondPlot</span>(sitBreaksAccelerometer_trackintervention_diamonds_intervention, 
                                   <span class="dt">returnLayerOnly =</span> <span class="ot">TRUE</span>, 
                                   <span class="dt">lineColor =</span> <span class="st">&quot;black&quot;</span>,  
                                   <span class="dt">color=</span>viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">4</span>],
                                   <span class="dt">alpha=</span>.<span class="dv">6</span>, 
                                   <span class="dt">fixedSize =</span> <span class="fl">0.1</span>, 
                                   <span class="dt">otherAxisCol =</span> (<span class="dv">1</span><span class="op">:</span><span class="dv">4</span> <span class="op">+</span><span class="st"> </span>.<span class="dv">15</span>)) <span class="op">+</span>
<span class="st">  </span>userfriendlyscience<span class="op">::</span><span class="kw">diamondPlot</span>(sitBreaksAccelerometer_trackintervention_diamonds_control, 
                                   <span class="dt">returnLayerOnly =</span> <span class="ot">TRUE</span>, 
                                   <span class="dt">lineColor =</span> <span class="st">&quot;black&quot;</span>,  
                                   <span class="dt">color=</span>viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">2</span>],
                                   <span class="dt">alpha=</span>.<span class="dv">6</span>, 
                                   <span class="dt">fixedSize =</span> <span class="fl">0.1</span>, 
                                   <span class="dt">otherAxisCol =</span> (<span class="dv">1</span><span class="op">:</span><span class="dv">4</span> <span class="op">+</span><span class="st"> </span>.<span class="dv">15</span>))
## Error in nrow(data): object &#39;sitBreaksAccelerometer_trackintervention_diamonds_intervention&#39; not found

plot1 <span class="op">+</span><span class="st"> </span>plot2
## Picking joint bandwidth of 3.67
## Warning: Removed 370 rows containing non-finite values
## (stat_density_ridges).
## Picking joint bandwidth of 3.51
## Warning: Removed 370 rows containing non-finite values
## (stat_density_ridges).</code></pre></div>
<p><img src="baseline-supplement_files/figure-html/sitBreaksAccelerometer-densityplot-1.png" width="2100" /></p>
</div>
</div>
<div id="sb-accelerometer-measured" class="section level2">
<h2>SB, Accelerometer-measured</h2>
<div id="density-plot-by-intervention-and-gender-3" class="section level3">
<h3>Density plot by intervention and gender</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># Create data frame</span>
densplot &lt;-<span class="st"> </span>d
<span class="kw">levels</span>(densplot<span class="op">$</span>intervention) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Control&quot;</span>, <span class="st">&quot;Intervention&quot;</span>)
<span class="kw">levels</span>(densplot<span class="op">$</span>girl) &lt;-<span class="st"> </span><span class="kw">recode</span>(densplot<span class="op">$</span>girl, <span class="st">&quot;boy&quot;</span> =<span class="st"> &quot;Boys&quot;</span>, <span class="st">&quot;girl&quot;</span> =<span class="st"> &quot;Girls&quot;</span>)

<span class="co"># This gives side-by-side plots. There&#39;s a third plot below the two, which is fake to include x-axis text.</span>
<span class="kw">layout</span>(<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">3</span>), <span class="dt">nrow =</span> <span class="dv">2</span>, <span class="dt">ncol =</span> <span class="dv">2</span>, <span class="dt">byrow =</span> <span class="ot">TRUE</span>),
       <span class="dt">widths =</span> <span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>),<span class="dt">heights =</span> <span class="kw">c</span>(<span class="fl">0.45</span>,<span class="fl">0.05</span>))

<span class="co"># Minimise whitespace; see https://stackoverflow.com/questions/15848942/how-to-reduce-space-gap-between-multiple-graphs-in-r</span>
<span class="kw">par</span>(<span class="dt">mai =</span> <span class="kw">c</span>(<span class="fl">0.3</span>, <span class="fl">0.3</span>, <span class="fl">0.1</span>, <span class="fl">0.0</span>)) 

## Girls vs. boys
<span class="co"># Choose only the variables needed and drop NA</span>
dens &lt;-<span class="st"> </span>densplot <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(sitLieAccelerometer_T1, girl) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="kw">complete.cases</span>(.))

<span class="co"># Set random number generator for reproducibility of bootstrap test of equal densities</span>
<span class="kw">set.seed</span>(<span class="dv">10</span>)

<span class="co"># Make plot</span>
sm.sitLieAccelerometer_T1_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">sm.density.compare2</span>(<span class="kw">as.numeric</span>(dens<span class="op">$</span>sitLieAccelerometer_T1), 
                                               <span class="kw">as.factor</span>(dens<span class="op">$</span>girl), 
                                               <span class="dt">model =</span> <span class="st">&quot;equal&quot;</span>,
                                               <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>,
                                               <span class="dt">col =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end  =</span>  <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">1</span>)], 
                                               <span class="dt">lty =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>), <span class="dt">yaxt =</span> <span class="st">&quot;n&quot;</span>,
                                               <span class="dt">bandcol =</span> <span class="st">&#39;LightGray&#39;</span>, 
                                               <span class="dt">lwd =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))
## 
## Test of equal densities:  p-value =  0
<span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="kw">levels</span>(dens<span class="op">$</span>girl), <span class="dt">col =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>)], <span class="dt">lty =</span> <span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">1</span>), <span class="dt">lwd =</span> (<span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>)))
<span class="kw">mtext</span>(<span class="dt">side =</span> <span class="dv">2</span>, <span class="st">&quot;Density&quot;</span>, <span class="dt">line =</span> <span class="fl">0.5</span>)

## Intervention vs. control
<span class="co"># Choose only the variables needed and drop NA</span>
dens &lt;-<span class="st"> </span>densplot <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(sitLieAccelerometer_T1, intervention) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="kw">complete.cases</span>(.))

<span class="co"># Set random number generator for reproducibility of bootstrap test of equal densities</span>
<span class="kw">set.seed</span>(<span class="dv">10</span>)
<span class="co"># Make plot</span>
sm.sitLieAccelerometer_T1_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">sm.density.compare2</span>(<span class="kw">as.numeric</span>(dens<span class="op">$</span>sitLieAccelerometer_T1), 
                                               <span class="kw">as.factor</span>(dens<span class="op">$</span>intervention), 
                                               <span class="dt">model =</span> <span class="st">&quot;equal&quot;</span>, 
                                               <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>,
                                               <span class="dt">col =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">4</span>)], 
                                               <span class="dt">lty =</span> <span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">1</span>), <span class="dt">yaxt =</span> <span class="st">&quot;n&quot;</span>,
                                               <span class="dt">bandcol =</span> <span class="st">&#39;LightGray&#39;</span>, 
                                               <span class="dt">lwd =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))
## 
## Test of equal densities:  p-value =  0.12
<span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="kw">levels</span>(dens<span class="op">$</span>intervention), <span class="dt">col =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">4</span>)], <span class="dt">lty=</span><span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">1</span>), <span class="dt">lwd=</span>(<span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>)))

<span class="co"># Create x-axis label. See https://stackoverflow.com/questions/11198767/how-to-annotate-across-or-between-plots-in-multi-plot-panels-in-r</span>
<span class="kw">par</span>(<span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>)) 
<span class="kw">plot</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dt">type =</span> <span class="st">&quot;n&quot;</span>, <span class="dt">frame.plot =</span> <span class="ot">FALSE</span>,<span class="dt">axes =</span> <span class="ot">FALSE</span>) <span class="co"># Fake plot</span>
<span class="kw">text</span>(<span class="dt">x =</span> <span class="fl">1.02</span>, <span class="dt">y =</span> <span class="fl">1.3</span>, <span class="dt">labels =</span> <span class="st">&quot;Average daily minutes spent sitting or lying down&quot;</span>, <span class="dt">pos =</span> <span class="dv">1</span>)</code></pre></div>
<p><img src="baseline-supplement_files/figure-html/sitLieAccelerometer-sm-1.png" width="2100" /></p>
</div>
<div id="data-preparation-3" class="section level3 tabset">
<h3>Data preparation</h3>
<div id="description-4" class="section level4">
<h4>Description</h4>
<p>The tab “Information on data preparation” of this section present information on data preparation for the plot</p>
</div>
<div id="information-on-data-preparation-3" class="section level4">
<h4>Information on data preparation</h4>
<p>Prepare data: time spent sitting &amp; lying down</p>
<p>Get credibility intervals track:school</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m_sitLieAccelerometer_trackgirl &lt;-<span class="st"> </span>brms<span class="op">::</span><span class="kw">bf</span>(sitLieAccelerometer_T1 <span class="op">~</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>track<span class="op">:</span>girl)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>brms<span class="op">::</span><span class="kw">brm</span>(., <span class="dt">data =</span> df, <span class="dt">chains =</span> <span class="dv">4</span>, <span class="dt">iter =</span> <span class="dv">4000</span>, <span class="dt">control =</span> <span class="kw">list</span>(<span class="dt">adapt_delta =</span> <span class="fl">0.95</span>))
## Found more than one class &quot;family&quot; in cache; using the first, from namespace &#39;lme4&#39;
## Also defined by &#39;MatrixModels&#39;
## Warning: Rows containing NAs were excluded from the model
## Compiling the C++ model
## Start sampling
## 
## SAMPLING FOR MODEL &#39;gaussian brms-model&#39; NOW (CHAIN 1).
## 
## Gradient evaluation took 0 seconds
## 1000 transitions using 10 leapfrog steps per transition would take 0 seconds.
## Adjust your expectations accordingly!
## 
## 
## Iteration:    1 / 4000 [  0%]  (Warmup)
## Iteration:  400 / 4000 [ 10%]  (Warmup)
## Iteration:  800 / 4000 [ 20%]  (Warmup)
## Iteration: 1200 / 4000 [ 30%]  (Warmup)
## Iteration: 1600 / 4000 [ 40%]  (Warmup)
## Iteration: 2000 / 4000 [ 50%]  (Warmup)
## Iteration: 2001 / 4000 [ 50%]  (Sampling)
## Iteration: 2400 / 4000 [ 60%]  (Sampling)
## Iteration: 2800 / 4000 [ 70%]  (Sampling)
## Iteration: 3200 / 4000 [ 80%]  (Sampling)
## Iteration: 3600 / 4000 [ 90%]  (Sampling)
## Iteration: 4000 / 4000 [100%]  (Sampling)
## 
##  Elapsed Time: 3.354 seconds (Warm-up)
##                2.245 seconds (Sampling)
##                5.599 seconds (Total)
## 
## 
## SAMPLING FOR MODEL &#39;gaussian brms-model&#39; NOW (CHAIN 2).
## 
## Gradient evaluation took 0 seconds
## 1000 transitions using 10 leapfrog steps per transition would take 0 seconds.
## Adjust your expectations accordingly!
## 
## 
## Iteration:    1 / 4000 [  0%]  (Warmup)
## Iteration:  400 / 4000 [ 10%]  (Warmup)
## Iteration:  800 / 4000 [ 20%]  (Warmup)
## Iteration: 1200 / 4000 [ 30%]  (Warmup)
## Iteration: 1600 / 4000 [ 40%]  (Warmup)
## Iteration: 2000 / 4000 [ 50%]  (Warmup)
## Iteration: 2001 / 4000 [ 50%]  (Sampling)
## Iteration: 2400 / 4000 [ 60%]  (Sampling)
## Iteration: 2800 / 4000 [ 70%]  (Sampling)
## Iteration: 3200 / 4000 [ 80%]  (Sampling)
## Iteration: 3600 / 4000 [ 90%]  (Sampling)
## Iteration: 4000 / 4000 [100%]  (Sampling)
## 
##  Elapsed Time: 3.724 seconds (Warm-up)
##                1.895 seconds (Sampling)
##                5.619 seconds (Total)
## 
## 
## SAMPLING FOR MODEL &#39;gaussian brms-model&#39; NOW (CHAIN 3).
## 
## Gradient evaluation took 0 seconds
## 1000 transitions using 10 leapfrog steps per transition would take 0 seconds.
## Adjust your expectations accordingly!
## 
## 
## Iteration:    1 / 4000 [  0%]  (Warmup)
## Iteration:  400 / 4000 [ 10%]  (Warmup)
## Iteration:  800 / 4000 [ 20%]  (Warmup)
## Iteration: 1200 / 4000 [ 30%]  (Warmup)
## Iteration: 1600 / 4000 [ 40%]  (Warmup)
## Iteration: 2000 / 4000 [ 50%]  (Warmup)
## Iteration: 2001 / 4000 [ 50%]  (Sampling)
## Iteration: 2400 / 4000 [ 60%]  (Sampling)
## Iteration: 2800 / 4000 [ 70%]  (Sampling)
## Iteration: 3200 / 4000 [ 80%]  (Sampling)
## Iteration: 3600 / 4000 [ 90%]  (Sampling)
## Iteration: 4000 / 4000 [100%]  (Sampling)
## 
##  Elapsed Time: 2.559 seconds (Warm-up)
##                1.812 seconds (Sampling)
##                4.371 seconds (Total)
## 
## 
## SAMPLING FOR MODEL &#39;gaussian brms-model&#39; NOW (CHAIN 4).
## 
## Gradient evaluation took 0 seconds
## 1000 transitions using 10 leapfrog steps per transition would take 0 seconds.
## Adjust your expectations accordingly!
## 
## 
## Iteration:    1 / 4000 [  0%]  (Warmup)
## Iteration:  400 / 4000 [ 10%]  (Warmup)
## Iteration:  800 / 4000 [ 20%]  (Warmup)
## Iteration: 1200 / 4000 [ 30%]  (Warmup)
## Iteration: 1600 / 4000 [ 40%]  (Warmup)
## Iteration: 2000 / 4000 [ 50%]  (Warmup)
## Iteration: 2001 / 4000 [ 50%]  (Sampling)
## Iteration: 2400 / 4000 [ 60%]  (Sampling)
## Iteration: 2800 / 4000 [ 70%]  (Sampling)
## Iteration: 3200 / 4000 [ 80%]  (Sampling)
## Iteration: 3600 / 4000 [ 90%]  (Sampling)
## Iteration: 4000 / 4000 [100%]  (Sampling)
## 
##  Elapsed Time: 3.19 seconds (Warm-up)
##                2.269 seconds (Sampling)
##                5.459 seconds (Total)

brms<span class="op">::</span><span class="kw">prior_summary</span>(m_sitLieAccelerometer_trackgirl, <span class="dt">data =</span> df)</code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["bound"],"name":[8],"type":["chr"],"align":["left"]}],"data":[{"1":"student_t(3, 568, 97)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":""},{"1":"student_t(3, 0, 97)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":""},{"1":"","2":"sd","3":"","4":"track:girl","5":"","6":"","7":"","8":""},{"1":"","2":"sd","3":"Intercept","4":"track:girl","5":"","6":"","7":"","8":""},{"1":"student_t(3, 0, 97)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":""}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[15],"max":[15]},"pages":{}}}
  </script>
</div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
m_sitLieAccelerometer_trackgirl
##  Family: gaussian 
##   Links: mu = identity; sigma = identity 
## Formula: sitLieAccelerometer_T1 ~ (1 | track:girl) 
##    Data: df (Number of observations: 706) 
## Samples: 4 chains, each with iter = 4000; warmup = 2000; thin = 1; 
##          total post-warmup samples = 8000
##     ICs: LOO = NA; WAIC = NA; R2 = NA
##  
## Group-Level Effects: 
## ~track:girl (Number of levels: 10) 
##               Estimate Est.Error l-95% CI u-95% CI Eff.Sample Rhat
## sd(Intercept)    45.40     14.36    25.22    81.06       1708 1.00
## 
## Population-Level Effects: 
##           Estimate Est.Error l-95% CI u-95% CI Eff.Sample Rhat
## Intercept   592.97     15.73   562.65   624.88       1386 1.00
## 
## Family Specific Parameters: 
##       Estimate Est.Error l-95% CI u-95% CI Eff.Sample Rhat
## sigma    89.82      2.40    85.33    94.62       7188 1.00
## 
## Samples were drawn using sampling(NUTS). For each parameter, Eff.Sample 
## is a crude measure of effective sample size, and Rhat is the potential 
## scale reduction factor on split chains (at convergence, Rhat = 1).

b_intercept &lt;-<span class="st"> </span>brms<span class="op">::</span><span class="kw">fixef</span>(m_sitLieAccelerometer_trackgirl)[<span class="dv">1</span>]

<span class="co"># This gives estimates only:</span>
sitLie_trackgirl_estimates &lt;-<span class="st"> </span>brms<span class="op">::</span><span class="kw">ranef</span>(m_sitLieAccelerometer_trackgirl)[[<span class="dv">1</span>]][<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]

<span class="co"># The 2.5%ile:</span>
sitLie_trackgirl_CIL &lt;-<span class="st"> </span>brms<span class="op">::</span><span class="kw">ranef</span>(m_sitLieAccelerometer_trackgirl)[[<span class="dv">1</span>]][<span class="dv">21</span><span class="op">:</span><span class="dv">30</span>]

<span class="co"># The 97.5%ile:</span>
sitLie_trackgirl_CIH &lt;-<span class="st"> </span>brms<span class="op">::</span><span class="kw">ranef</span>(m_sitLieAccelerometer_trackgirl)[[<span class="dv">1</span>]][<span class="dv">31</span><span class="op">:</span><span class="dv">40</span>]

sitLie_trackgirl_ci &lt;-<span class="st"> </span><span class="kw">data.frame</span>(sitLie_trackgirl_CIL, sitLie_trackgirl_estimates, sitLie_trackgirl_CIH, <span class="dt">Variable =</span> <span class="kw">labels</span>(brms<span class="op">::</span><span class="kw">ranef</span>(m_sitLieAccelerometer_trackgirl))) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">b_intercept =</span> <span class="kw">rep</span>(b_intercept, <span class="dv">10</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">sitLie_trackgirl_CIL =</span> sitLie_trackgirl_CIL <span class="op">+</span><span class="st"> </span>b_intercept,
         <span class="dt">sitLie_trackgirl_estimates =</span> sitLie_trackgirl_estimates <span class="op">+</span><span class="st"> </span>b_intercept,
         <span class="dt">sitLie_trackgirl_CIH =</span> sitLie_trackgirl_CIH <span class="op">+</span><span class="st"> </span>b_intercept,
         <span class="dt">track =</span> <span class="kw">c</span>(<span class="st">&#39;BA_boy&#39;</span>,
                   <span class="st">&#39;BA_girl&#39;</span>,
                   <span class="st">&#39;HRC_boy&#39;</span>,
                   <span class="st">&#39;HRC_girl&#39;</span>,
                   <span class="st">&#39;IT_boy&#39;</span>,
                   <span class="st">&#39;IT_girl&#39;</span>,
                   <span class="st">&#39;Nur_boy&#39;</span>,
                   <span class="st">&#39;Nur_girl&#39;</span>,
                   <span class="st">&#39;Other_boy&#39;</span>,
                   <span class="st">&#39;Other_girl&#39;</span>
))

sitLie_trackgirl_diamonds_girl &lt;-<span class="st"> </span><span class="kw">rbind</span>(
sitLie_trackgirl_ci <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;Nur_girl&quot;</span>),
sitLie_trackgirl_ci <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;HRC_girl&quot;</span>),
sitLie_trackgirl_ci <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;BA_girl&quot;</span>),
sitLie_trackgirl_ci <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;IT_girl&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">arrange</span>(<span class="op">-</span><span class="kw">row_number</span>()) <span class="co"># reverse order of rows to make them right for the plot to come</span>

sitLie_trackgirl_diamonds_boy &lt;-<span class="st"> </span><span class="kw">rbind</span>(
sitLie_trackgirl_ci <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;Nur_boy&quot;</span>),
sitLie_trackgirl_ci <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;HRC_boy&quot;</span>),
sitLie_trackgirl_ci <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;BA_boy&quot;</span>),
sitLie_trackgirl_ci <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;IT_boy&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">arrange</span>(<span class="op">-</span><span class="kw">row_number</span>()) <span class="co"># reverse order of rows to make them right for the plot to come</span>


m_sitLieAccelerometer_trackintervention &lt;-<span class="st"> </span>brms<span class="op">::</span><span class="kw">bf</span>(sitLieAccelerometer_T1 <span class="op">~</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>track<span class="op">:</span>intervention)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>brms<span class="op">::</span><span class="kw">brm</span>(., <span class="dt">data =</span> df, <span class="dt">chains =</span> <span class="dv">4</span>, <span class="dt">iter =</span> <span class="dv">4000</span>, <span class="dt">control =</span> <span class="kw">list</span>(<span class="dt">adapt_delta =</span> <span class="fl">0.95</span>))
## Found more than one class &quot;family&quot; in cache; using the first, from namespace &#39;lme4&#39;
## Also defined by &#39;MatrixModels&#39;
## Warning: Rows containing NAs were excluded from the model
## Compiling the C++ model
## Start sampling
## 
## SAMPLING FOR MODEL &#39;gaussian brms-model&#39; NOW (CHAIN 1).
## 
## Gradient evaluation took 0 seconds
## 1000 transitions using 10 leapfrog steps per transition would take 0 seconds.
## Adjust your expectations accordingly!
## 
## 
## Iteration:    1 / 4000 [  0%]  (Warmup)
## Iteration:  400 / 4000 [ 10%]  (Warmup)
## Iteration:  800 / 4000 [ 20%]  (Warmup)
## Iteration: 1200 / 4000 [ 30%]  (Warmup)
## Iteration: 1600 / 4000 [ 40%]  (Warmup)
## Iteration: 2000 / 4000 [ 50%]  (Warmup)
## Iteration: 2001 / 4000 [ 50%]  (Sampling)
## Iteration: 2400 / 4000 [ 60%]  (Sampling)
## Iteration: 2800 / 4000 [ 70%]  (Sampling)
## Iteration: 3200 / 4000 [ 80%]  (Sampling)
## Iteration: 3600 / 4000 [ 90%]  (Sampling)
## Iteration: 4000 / 4000 [100%]  (Sampling)
## 
##  Elapsed Time: 3.599 seconds (Warm-up)
##                1.687 seconds (Sampling)
##                5.286 seconds (Total)
## 
## 
## SAMPLING FOR MODEL &#39;gaussian brms-model&#39; NOW (CHAIN 2).
## 
## Gradient evaluation took 0 seconds
## 1000 transitions using 10 leapfrog steps per transition would take 0 seconds.
## Adjust your expectations accordingly!
## 
## 
## Iteration:    1 / 4000 [  0%]  (Warmup)
## Iteration:  400 / 4000 [ 10%]  (Warmup)
## Iteration:  800 / 4000 [ 20%]  (Warmup)
## Iteration: 1200 / 4000 [ 30%]  (Warmup)
## Iteration: 1600 / 4000 [ 40%]  (Warmup)
## Iteration: 2000 / 4000 [ 50%]  (Warmup)
## Iteration: 2001 / 4000 [ 50%]  (Sampling)
## Iteration: 2400 / 4000 [ 60%]  (Sampling)
## Iteration: 2800 / 4000 [ 70%]  (Sampling)
## Iteration: 3200 / 4000 [ 80%]  (Sampling)
## Iteration: 3600 / 4000 [ 90%]  (Sampling)
## Iteration: 4000 / 4000 [100%]  (Sampling)
## 
##  Elapsed Time: 2.876 seconds (Warm-up)
##                1.914 seconds (Sampling)
##                4.79 seconds (Total)
## 
## 
## SAMPLING FOR MODEL &#39;gaussian brms-model&#39; NOW (CHAIN 3).
## 
## Gradient evaluation took 0 seconds
## 1000 transitions using 10 leapfrog steps per transition would take 0 seconds.
## Adjust your expectations accordingly!
## 
## 
## Iteration:    1 / 4000 [  0%]  (Warmup)
## Iteration:  400 / 4000 [ 10%]  (Warmup)
## Iteration:  800 / 4000 [ 20%]  (Warmup)
## Iteration: 1200 / 4000 [ 30%]  (Warmup)
## Iteration: 1600 / 4000 [ 40%]  (Warmup)
## Iteration: 2000 / 4000 [ 50%]  (Warmup)
## Iteration: 2001 / 4000 [ 50%]  (Sampling)
## Iteration: 2400 / 4000 [ 60%]  (Sampling)
## Iteration: 2800 / 4000 [ 70%]  (Sampling)
## Iteration: 3200 / 4000 [ 80%]  (Sampling)
## Iteration: 3600 / 4000 [ 90%]  (Sampling)
## Iteration: 4000 / 4000 [100%]  (Sampling)
## 
##  Elapsed Time: 3.261 seconds (Warm-up)
##                1.886 seconds (Sampling)
##                5.147 seconds (Total)
## 
## 
## SAMPLING FOR MODEL &#39;gaussian brms-model&#39; NOW (CHAIN 4).
## 
## Gradient evaluation took 0 seconds
## 1000 transitions using 10 leapfrog steps per transition would take 0 seconds.
## Adjust your expectations accordingly!
## 
## 
## Iteration:    1 / 4000 [  0%]  (Warmup)
## Iteration:  400 / 4000 [ 10%]  (Warmup)
## Iteration:  800 / 4000 [ 20%]  (Warmup)
## Iteration: 1200 / 4000 [ 30%]  (Warmup)
## Iteration: 1600 / 4000 [ 40%]  (Warmup)
## Iteration: 2000 / 4000 [ 50%]  (Warmup)
## Iteration: 2001 / 4000 [ 50%]  (Sampling)
## Iteration: 2400 / 4000 [ 60%]  (Sampling)
## Iteration: 2800 / 4000 [ 70%]  (Sampling)
## Iteration: 3200 / 4000 [ 80%]  (Sampling)
## Iteration: 3600 / 4000 [ 90%]  (Sampling)
## Iteration: 4000 / 4000 [100%]  (Sampling)
## 
##  Elapsed Time: 3.423 seconds (Warm-up)
##                1.827 seconds (Sampling)
##                5.25 seconds (Total)

brms<span class="op">::</span><span class="kw">prior_summary</span>(m_sitLieAccelerometer_trackintervention, <span class="dt">data =</span> df)</code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["bound"],"name":[8],"type":["chr"],"align":["left"]}],"data":[{"1":"student_t(3, 568, 97)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":""},{"1":"student_t(3, 0, 97)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":""},{"1":"","2":"sd","3":"","4":"track:intervention","5":"","6":"","7":"","8":""},{"1":"","2":"sd","3":"Intercept","4":"track:intervention","5":"","6":"","7":"","8":""},{"1":"student_t(3, 0, 97)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":""}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[15],"max":[15]},"pages":{}}}
  </script>
</div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
m_sitLieAccelerometer_trackintervention
##  Family: gaussian 
##   Links: mu = identity; sigma = identity 
## Formula: sitLieAccelerometer_T1 ~ (1 | track:intervention) 
##    Data: df (Number of observations: 706) 
## Samples: 4 chains, each with iter = 4000; warmup = 2000; thin = 1; 
##          total post-warmup samples = 8000
##     ICs: LOO = NA; WAIC = NA; R2 = NA
##  
## Group-Level Effects: 
## ~track:intervention (Number of levels: 10) 
##               Estimate Est.Error l-95% CI u-95% CI Eff.Sample Rhat
## sd(Intercept)    47.96     14.11    28.14    82.40       1472 1.00
## 
## Population-Level Effects: 
##           Estimate Est.Error l-95% CI u-95% CI Eff.Sample Rhat
## Intercept   591.56     15.87   560.36   622.91       1518 1.00
## 
## Family Specific Parameters: 
##       Estimate Est.Error l-95% CI u-95% CI Eff.Sample Rhat
## sigma    89.74      2.36    85.25    94.49       6460 1.00
## 
## Samples were drawn using sampling(NUTS). For each parameter, Eff.Sample 
## is a crude measure of effective sample size, and Rhat is the potential 
## scale reduction factor on split chains (at convergence, Rhat = 1).

b_intercept &lt;-<span class="st"> </span>brms<span class="op">::</span><span class="kw">fixef</span>(m_sitLieAccelerometer_trackintervention)[<span class="dv">1</span>]

<span class="co"># This gives estimates only:</span>
sitLie_trackintervention_estimates &lt;-<span class="st"> </span>brms<span class="op">::</span><span class="kw">ranef</span>(m_sitLieAccelerometer_trackintervention)[[<span class="dv">1</span>]][<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]


<span class="co"># The 2.5%ile:</span>
sitLie_trackintervention_CIL &lt;-<span class="st"> </span>brms<span class="op">::</span><span class="kw">ranef</span>(m_sitLieAccelerometer_trackintervention)[[<span class="dv">1</span>]][<span class="dv">21</span><span class="op">:</span><span class="dv">30</span>]

<span class="co"># The 97.5%ile:</span>
sitLie_trackintervention_CIH &lt;-<span class="st"> </span>brms<span class="op">::</span><span class="kw">ranef</span>(m_sitLieAccelerometer_trackintervention)[[<span class="dv">1</span>]][<span class="dv">31</span><span class="op">:</span><span class="dv">40</span>]

sitLie_trackintervention_ci &lt;-<span class="st"> </span><span class="kw">data.frame</span>(sitLie_trackintervention_CIL, sitLie_trackintervention_estimates, sitLie_trackintervention_CIH, <span class="dt">Variable =</span> <span class="kw">labels</span>(brms<span class="op">::</span><span class="kw">ranef</span>(m_sitLieAccelerometer_trackintervention))) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">b_intercept =</span> <span class="kw">rep</span>(b_intercept, <span class="dv">10</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">sitLie_trackintervention_CIL =</span> sitLie_trackintervention_CIL <span class="op">+</span><span class="st"> </span>b_intercept,
         <span class="dt">sitLie_trackintervention_estimates =</span> sitLie_trackintervention_estimates <span class="op">+</span><span class="st"> </span>b_intercept,
         <span class="dt">sitLie_trackintervention_CIH =</span> sitLie_trackintervention_CIH <span class="op">+</span><span class="st"> </span>b_intercept,
         <span class="dt">track =</span> <span class="kw">c</span>(<span class="st">&#39;BA_control&#39;</span>,
                   <span class="st">&#39;BA_intervention&#39;</span>,
                   <span class="st">&#39;HRC_control&#39;</span>,
                   <span class="st">&#39;HRC_intervention&#39;</span>,
                   <span class="st">&#39;IT_control&#39;</span>,
                   <span class="st">&#39;IT_intervention&#39;</span>,
                   <span class="st">&#39;Nur_control&#39;</span>,
                   <span class="st">&#39;Nur_intervention&#39;</span>,
                   <span class="st">&#39;Other_control&#39;</span>,
                   <span class="st">&#39;Other_intervention&#39;</span>
))

sitLie_trackintervention_diamonds_intervention &lt;-<span class="st"> </span><span class="kw">rbind</span>(
sitLie_trackintervention_ci <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;Nur_intervention&quot;</span>),
sitLie_trackintervention_ci <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;HRC_intervention&quot;</span>),
sitLie_trackintervention_ci <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;BA_intervention&quot;</span>),
sitLie_trackintervention_ci <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;IT_intervention&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">arrange</span>(<span class="op">-</span><span class="kw">row_number</span>()) <span class="co"># reverse order of rows to make them right for the plot to come</span>

sitLie_trackintervention_diamonds_control &lt;-<span class="st"> </span><span class="kw">rbind</span>(
sitLie_trackintervention_ci <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;Nur_control&quot;</span>),
sitLie_trackintervention_ci <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;HRC_control&quot;</span>),
sitLie_trackintervention_ci <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;BA_control&quot;</span>),
sitLie_trackintervention_ci <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;IT_control&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">arrange</span>(<span class="op">-</span><span class="kw">row_number</span>()) <span class="co"># reverse order of rows to make them right for the plot to come</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
sitLie_trackgirl_diamonds_girl <span class="op">%&gt;%</span><span class="st"> </span>DT<span class="op">::</span><span class="kw">datatable</span>() <span class="co">#papaja::apa_table()</span></code></pre></div>
<div id="htmlwidget-538cb37359fe2a0108c3" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-538cb37359fe2a0108c3">{"x":{"filter":"none","data":[["1","2","3","4"],[578.97134941312,532.395683636849,507.666234328968,515.055523590314],[623.670102617489,570.339956581952,544.817977243947,549.521015234562],[669.738929649794,606.632261510577,578.693551304187,580.686587664841],["track:girl","track:girl","track:girl","track:girl"],[592.966028819195,592.966028819195,592.966028819195,592.966028819195],["IT_girl","BA_girl","HRC_girl","Nur_girl"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>sitLie_trackgirl_CIL<\/th>\n      <th>sitLie_trackgirl_estimates<\/th>\n      <th>sitLie_trackgirl_CIH<\/th>\n      <th>Variable<\/th>\n      <th>b_intercept<\/th>\n      <th>track<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-center","targets":"_all"},{"className":"dt-right","targets":[1,2,3,5]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sitLie_trackgirl_diamonds_boy <span class="op">%&gt;%</span><span class="st"> </span>DT<span class="op">::</span><span class="kw">datatable</span>() <span class="co">#papaja::apa_table()</span></code></pre></div>
<div id="htmlwidget-c6054af1c7e5fcde8e55" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-c6054af1c7e5fcde8e55">{"x":{"filter":"none","data":[["1","2","3","4"],[618.868869015662,564.025459825444,546.715447867138,544.031557017227],[654.050535082882,600.339032031156,585.053505149516,581.97962242585],[690.073854585841,634.379967973028,622.346048631911,619.624057156543],["track:girl","track:girl","track:girl","track:girl"],[592.966028819195,592.966028819195,592.966028819195,592.966028819195],["IT_boy","BA_boy","HRC_boy","Nur_boy"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>sitLie_trackgirl_CIL<\/th>\n      <th>sitLie_trackgirl_estimates<\/th>\n      <th>sitLie_trackgirl_CIH<\/th>\n      <th>Variable<\/th>\n      <th>b_intercept<\/th>\n      <th>track<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-center","targets":"_all"},{"className":"dt-right","targets":[1,2,3,5]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sitLie_trackintervention_diamonds_intervention <span class="op">%&gt;%</span><span class="st"> </span>DT<span class="op">::</span><span class="kw">datatable</span>() <span class="co">#papaja::apa_table()</span></code></pre></div>
<div id="htmlwidget-14c8823788bce8dda49b" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-14c8823788bce8dda49b">{"x":{"filter":"none","data":[["1","2","3","4"],[606.921618897206,551.774609979041,568.415204984286,529.462097734073],[644.056853075972,587.68719357376,607.227089923806,562.676019851337],[683.474304479893,623.308060326484,646.425544256143,595.363845125801],["track:intervention","track:intervention","track:intervention","track:intervention"],[591.56168344155,591.56168344155,591.56168344155,591.56168344155],["IT_intervention","BA_intervention","HRC_intervention","Nur_intervention"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>sitLie_trackintervention_CIL<\/th>\n      <th>sitLie_trackintervention_estimates<\/th>\n      <th>sitLie_trackintervention_CIH<\/th>\n      <th>Variable<\/th>\n      <th>b_intercept<\/th>\n      <th>track<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-center","targets":"_all"},{"className":"dt-right","targets":[1,2,3,5]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sitLie_trackintervention_diamonds_control <span class="op">%&gt;%</span><span class="st"> </span>DT<span class="op">::</span><span class="kw">datatable</span>() <span class="co">#papaja::apa_table()</span></code></pre></div>
<div id="htmlwidget-96333f595737f03ba84d" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-96333f595737f03ba84d">{"x":{"filter":"none","data":[["1","2","3","4"],[615.84624753666,550.295947962909,503.74589460833,503.824101672616],[652.199508389966,586.297304577827,539.061458599598,540.049744515418],[690.519727843751,622.038650976485,573.92372689759,575.34960687838],["track:intervention","track:intervention","track:intervention","track:intervention"],[591.56168344155,591.56168344155,591.56168344155,591.56168344155],["IT_control","BA_control","HRC_control","Nur_control"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>sitLie_trackintervention_CIL<\/th>\n      <th>sitLie_trackintervention_estimates<\/th>\n      <th>sitLie_trackintervention_CIH<\/th>\n      <th>Variable<\/th>\n      <th>b_intercept<\/th>\n      <th>track<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-center","targets":"_all"},{"className":"dt-right","targets":[1,2,3,5]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="basic-observed-characteristics" class="section level4">
<h4>Basic observed characteristics</h4>
<p>NOTE: These values do not account for clustering.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(sitLieAccelerometer_T1, girl, track) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(girl, track) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarise</span>(<span class="dt">mean =</span> <span class="kw">mean</span>(sitLieAccelerometer_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),
            <span class="dt">median =</span> <span class="kw">median</span>(sitLieAccelerometer_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),
            <span class="dt">max =</span> <span class="kw">max</span>(sitLieAccelerometer_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),
            <span class="dt">min =</span> <span class="kw">min</span>(sitLieAccelerometer_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),
            <span class="dt">sd =</span> <span class="kw">sd</span>(sitLieAccelerometer_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),
            <span class="dt">n =</span> <span class="kw">n</span>()) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>DT<span class="op">::</span><span class="kw">datatable</span>() <span class="co">#papaja::apa_table()</span></code></pre></div>
<div id="htmlwidget-03d4ec72341f9992eaaf" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-03d4ec72341f9992eaaf">{"x":{"filter":"none","data":[["1","2","3","4","5","6","7","8","9","10","11"],["girl","girl","girl","girl","girl","boy","boy","boy","boy","boy",null],["Other","IT","BA","HRC","Nur","Other","IT","BA","HRC","Nur",null],[578.015930735931,631.536892230576,568.787731092437,542.164774705581,548.650489417989,692.442857142857,657.613181296615,600.69216991342,584.617702821869,580.90718487395,617.704761904762],[504.3,610.68,558.012857142857,538.65,544.532142857143,722.8,653.4,592.3775,564.375,563.025,643.885714285714],[936.085714285714,754.742857142857,862.485714285714,913.075,827.016666666667,779.342857142857,894.757142857143,806.06,854.142857142857,900.575,815.275],[415.116666666667,508.928571428572,406.08,304.757142857143,309.1,591,419.271428571429,419.2,371.416666666667,411.671428571429,420.075],[150.08696232701,69.7512518247912,96.1703834217487,100.898808515516,79.6549559485247,79.3083622736632,89.2992887209799,88.6106044804923,96.9714978459966,88.7297263524453,120.435198189186],[17,26,110,129,331,7,137,172,84,71,81]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>girl<\/th>\n      <th>track<\/th>\n      <th>mean<\/th>\n      <th>median<\/th>\n      <th>max<\/th>\n      <th>min<\/th>\n      <th>sd<\/th>\n      <th>n<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-center","targets":"_all"},{"className":"dt-right","targets":[3,4,5,6,7,8]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">  

df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(sitLieAccelerometer_T1, girl, track) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(girl) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarise</span>(<span class="dt">mean =</span> <span class="kw">mean</span>(sitLieAccelerometer_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),
            <span class="dt">median =</span> <span class="kw">median</span>(sitLieAccelerometer_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),
            <span class="dt">max =</span> <span class="kw">max</span>(sitLieAccelerometer_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),
            <span class="dt">min =</span> <span class="kw">min</span>(sitLieAccelerometer_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),
            <span class="dt">sd =</span> <span class="kw">sd</span>(sitLieAccelerometer_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),
            <span class="dt">n =</span> <span class="kw">n</span>()) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>DT<span class="op">::</span><span class="kw">datatable</span>() <span class="co">#papaja::apa_table()</span></code></pre></div>
<div id="htmlwidget-3da1420a000f7ec5ab82" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-3da1420a000f7ec5ab82">{"x":{"filter":"none","data":[["1","2","3"],["girl","boy",null],[554.918777591036,612.457799525504,617.704761904762],[548.92,612.375,643.885714285714],[936.085714285714,900.575,815.275],[304.757142857143,371.416666666667,420.075],[90.8851154009524,95.622549963648,120.435198189186],[613,471,81]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>girl<\/th>\n      <th>mean<\/th>\n      <th>median<\/th>\n      <th>max<\/th>\n      <th>min<\/th>\n      <th>sd<\/th>\n      <th>n<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-center","targets":"_all"},{"className":"dt-right","targets":[2,3,4,5,6,7]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(sitLieAccelerometer_T1, intervention, track) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(intervention, track) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarise</span>(<span class="dt">mean =</span> <span class="kw">mean</span>(sitLieAccelerometer_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),
            <span class="dt">median =</span> <span class="kw">median</span>(sitLieAccelerometer_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),
            <span class="dt">max =</span> <span class="kw">max</span>(sitLieAccelerometer_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),
            <span class="dt">min =</span> <span class="kw">min</span>(sitLieAccelerometer_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),
            <span class="dt">sd =</span> <span class="kw">sd</span>(sitLieAccelerometer_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),
            <span class="dt">n =</span> <span class="kw">n</span>()) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>DT<span class="op">::</span><span class="kw">datatable</span>() <span class="co">#papaja::apa_table()</span></code></pre></div>
<div id="htmlwidget-2a501f62cf09963369b9" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-2a501f62cf09963369b9">{"x":{"filter":"none","data":[["1","2","3","4","5","6","7","8","9","10","11"],["0","0","0","0","0","1","1","1","1","1",null],["Other","IT","BA","HRC","Nur","Other","IT","BA","HRC","Nur",null],[595.480714285714,657.278533333333,585.959313543599,536.775812728938,537.520359848485,637.294727891156,648.407083333333,587.589993972272,608.511522702104,561.973042059463,617.704761904762],[591,651.213333333333,592.68,536.657142857143,531.776190476191,652.875,651.204285714286,575.58,591.166666666667,551.816666666667,643.885714285714],[779.342857142857,894.757142857143,862.485714285714,913.075,827.016666666667,936.085714285714,828.085714285714,806.06,854.142857142857,900.575,815.275],[470.942857142857,480.84,406.08,304.757142857143,309.1,415.116666666667,419.271428571429,411.6,435.742857142857,395.25,420.075],[116.876612246874,84.5229104748496,89.3713214952016,99.4810813651142,85.2964829380916,172.850463743804,88.5522779532508,97.0519095339557,87.3796267325336,79.7394759028584,120.435198189186],[14,87,131,146,125,10,76,151,67,277,81]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>intervention<\/th>\n      <th>track<\/th>\n      <th>mean<\/th>\n      <th>median<\/th>\n      <th>max<\/th>\n      <th>min<\/th>\n      <th>sd<\/th>\n      <th>n<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-center","targets":"_all"},{"className":"dt-right","targets":[3,4,5,6,7,8]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(sitLieAccelerometer_T1, intervention, track) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(intervention) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarise</span>(<span class="dt">mean =</span> <span class="kw">mean</span>(sitLieAccelerometer_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),
            <span class="dt">median =</span> <span class="kw">median</span>(sitLieAccelerometer_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),
            <span class="dt">max =</span> <span class="kw">max</span>(sitLieAccelerometer_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),
            <span class="dt">min =</span> <span class="kw">min</span>(sitLieAccelerometer_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),
            <span class="dt">sd =</span> <span class="kw">sd</span>(sitLieAccelerometer_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),
            <span class="dt">n =</span> <span class="kw">n</span>()) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>DT<span class="op">::</span><span class="kw">datatable</span>() <span class="co">#papaja::apa_table()</span></code></pre></div>
<div id="htmlwidget-6e3274ae817af6abc55e" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-6e3274ae817af6abc55e">{"x":{"filter":"none","data":[["1","2","3"],["0","1",null],[568.501818379791,585.906152683296,617.704761904762],[562.073333333333,574.446666666667,643.885714285714],[913.075,936.085714285714,815.275],[304.757142857143,395.25,420.075],[100.942171747921,92.6681405401554,120.435198189186],[503,581,81]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>intervention<\/th>\n      <th>mean<\/th>\n      <th>median<\/th>\n      <th>max<\/th>\n      <th>min<\/th>\n      <th>sd<\/th>\n      <th>n<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-center","targets":"_all"},{"className":"dt-right","targets":[2,3,4,5,6,7]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div id="density-plot-by-track-3" class="section level3">
<h3>Density plot by track</h3>
<p>Time spent sitting or lying down</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
plot1 &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(id,
                              <span class="dt">track =</span> track,
                              girl,
                              <span class="dt">PA =</span> sitLieAccelerometer_T1)  <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(track), track <span class="op">!=</span><span class="st"> &quot;Other&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># Drop category &quot;Other&quot;</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">track =</span> <span class="kw">factor</span>(track, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;IT&quot;</span>, <span class="st">&quot;BA&quot;</span>, <span class="st">&quot;HRC&quot;</span>, <span class="st">&quot;Nur&quot;</span>)),
                <span class="dt">track =</span> <span class="kw">recode_factor</span>(track, <span class="st">&quot;IT&quot;</span> =<span class="st"> &quot;IT&quot;</span>, <span class="st">&quot;BA&quot;</span> =<span class="st"> &quot;BA&quot;</span>, 
                                      <span class="st">&quot;HRC&quot;</span> =<span class="st"> &quot;HRC&quot;</span>, <span class="st">&quot;Nur&quot;</span> =<span class="st"> &quot;Nur&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>ggplot2<span class="op">::</span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">y =</span> track)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">geom_density_ridges2</span>(<span class="kw">aes</span>(<span class="dt">x =</span> PA, <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>, 
                                    <span class="dt">fill =</span> <span class="kw">paste</span>(track, girl),
                                    <span class="dt">point_color =</span> girl,
                                    <span class="dt">point_fill =</span> girl,
                                    <span class="dt">point_shape =</span> girl),
                                  <span class="dt">scale =</span> .<span class="dv">75</span>, <span class="dt">alpha =</span> <span class="fl">0.6</span>, <span class="dt">size =</span> <span class="fl">0.25</span>,
                                  <span class="dt">position =</span> <span class="kw">position_raincloud</span>(<span class="dt">width =</span> <span class="fl">0.05</span>, <span class="dt">height =</span> <span class="fl">0.15</span>),
                                  <span class="co"># from = 0, to = 450,</span>
                                  <span class="dt">jittered_points =</span> <span class="ot">TRUE</span>,
                                  <span class="dt">point_size =</span> <span class="dv">1</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="ot">NULL</span>,
       <span class="dt">y =</span> <span class="ot">NULL</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_discrete</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.1</span>, <span class="dv">0</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_fill_cyclical</span>(
                                <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&#39;BA boy&#39;</span> =<span class="st"> &quot;Boy&quot;</span>, <span class="st">&#39;BA girl&#39;</span> =<span class="st"> &quot;Girl&quot;</span>),
                                <span class="dt">values =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>)],
                                <span class="dt">name =</span> <span class="st">&quot;&quot;</span>, 
                                <span class="dt">guide =</span> <span class="kw">guide_legend</span>(<span class="dt">override.aes =</span> <span class="kw">list</span>(<span class="dt">alpha =</span> <span class="dv">1</span>, 
                                                                         <span class="dt">point_shape =</span> <span class="kw">c</span>(<span class="dv">24</span>, <span class="dv">4</span>),
                                                                         <span class="dt">point_size =</span> <span class="dv">2</span>))) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_colour_cyclical</span>(<span class="dt">values =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">theme_ridges</span>(<span class="dt">grid =</span> <span class="ot">FALSE</span>) <span class="op">+</span>
<span class="st">  </span><span class="co"># ggplot2::scale_fill_manual(values = c(&quot;#A0FFA0&quot;, &quot;#A0A0FF&quot;)) +</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_discrete_manual</span>(<span class="dt">aesthetics =</span> <span class="st">&quot;point_color&quot;</span>, 
                                  <span class="dt">values =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">1</span>)],
                                  <span class="dt">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_discrete_manual</span>(<span class="dt">aesthetics =</span> <span class="st">&quot;point_fill&quot;</span>,
                                  <span class="dt">values =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">1</span>)],
                                  <span class="dt">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_discrete_manual</span>(<span class="dt">aesthetics =</span> <span class="st">&quot;point_shape&quot;</span>, 
                                  <span class="dt">values =</span> <span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">24</span>),
                                  <span class="dt">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>papaja<span class="op">::</span><span class="kw">theme_apa</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)

plot1 &lt;-<span class="st"> </span>plot1 <span class="op">+</span><span class="st"> </span>
<span class="st">  </span>userfriendlyscience<span class="op">::</span><span class="kw">diamondPlot</span>(sitLie_trackgirl_diamonds_girl, 
                                   <span class="dt">returnLayerOnly =</span> <span class="ot">TRUE</span>, 
                                   <span class="dt">lineColor =</span> <span class="st">&quot;black&quot;</span>, 
                                   <span class="dt">color=</span>viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">3</span>],
                                   <span class="dt">alpha=</span>.<span class="dv">6</span>, 
                                   <span class="dt">fixedSize =</span> <span class="fl">0.1</span>, 
                                   <span class="dt">otherAxisCol =</span> (<span class="dv">1</span><span class="op">:</span><span class="dv">4</span> <span class="op">+</span><span class="st"> </span>.<span class="dv">15</span>)) <span class="op">+</span><span class="st"> </span><span class="co"># specify y-position; option to move the diamond </span>
<span class="st">  </span>userfriendlyscience<span class="op">::</span><span class="kw">diamondPlot</span>(sitLie_trackgirl_diamonds_boy, 
                                   <span class="dt">returnLayerOnly =</span> <span class="ot">TRUE</span>, 
                                   <span class="dt">lineColor =</span> <span class="st">&quot;black&quot;</span>, 
                                   <span class="dt">linetype =</span> <span class="st">&quot;solid&quot;</span>, 
                                   <span class="dt">color=</span>viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">1</span>],
                                   <span class="dt">alpha=</span>.<span class="dv">6</span>, 
                                   <span class="dt">fixedSize =</span> <span class="fl">0.1</span>, 
                                   <span class="dt">otherAxisCol =</span> (<span class="dv">1</span><span class="op">:</span><span class="dv">4</span> <span class="op">+</span><span class="st"> </span>.<span class="dv">15</span>))

<span class="co"># Draw plot with intervention and control densities</span>

plot2 &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(id,
                              <span class="dt">track =</span> track,
                              intervention,
                              <span class="dt">PA =</span> sitLieAccelerometer_T1)  <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(track), track <span class="op">!=</span><span class="st"> &quot;Other&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># Drop category &quot;Other&quot;</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">track =</span> <span class="kw">factor</span>(track, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;IT&quot;</span>, <span class="st">&quot;BA&quot;</span>, <span class="st">&quot;HRC&quot;</span>, <span class="st">&quot;Nur&quot;</span>)),
                <span class="dt">track =</span> <span class="kw">recode_factor</span>(track, <span class="st">&quot;IT&quot;</span> =<span class="st"> &quot;IT&quot;</span>, <span class="st">&quot;BA&quot;</span> =<span class="st"> &quot;BA&quot;</span>, 
                                      <span class="st">&quot;HRC&quot;</span> =<span class="st"> &quot;HRC&quot;</span>, <span class="st">&quot;Nur&quot;</span> =<span class="st"> &quot;Nur&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>ggplot2<span class="op">::</span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">y =</span> track)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">geom_density_ridges2</span>(<span class="kw">aes</span>(<span class="dt">x =</span> PA, <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>, 
                                    <span class="dt">fill =</span> <span class="kw">paste</span>(track, intervention),
                                    <span class="dt">point_color =</span> intervention,
                                    <span class="dt">point_fill =</span> intervention,
                                    <span class="dt">point_shape =</span> intervention),
                                  <span class="dt">scale =</span> .<span class="dv">75</span>, <span class="dt">alpha =</span> <span class="fl">0.6</span>, <span class="dt">size =</span> <span class="fl">0.25</span>,
                                  <span class="dt">position =</span> <span class="kw">position_raincloud</span>(<span class="dt">width =</span> <span class="fl">0.05</span>, <span class="dt">height =</span> <span class="fl">0.15</span>),
                                  <span class="co"># from = 0, to = 450,</span>
                                  <span class="dt">jittered_points =</span> <span class="ot">TRUE</span>,
                                  <span class="dt">point_size =</span> <span class="dv">1</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="ot">NULL</span>,
       <span class="dt">y =</span> <span class="ot">NULL</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_discrete</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.1</span>, <span class="dv">0</span>), <span class="dt">labels =</span> <span class="ot">NULL</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_fill_cyclical</span>(
                                <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&#39;BA 0&#39;</span> =<span class="st"> &quot;Control&quot;</span>, <span class="st">&#39;BA 1&#39;</span> =<span class="st"> &quot;Intervention&quot;</span>),
                                <span class="dt">values =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">4</span>)],
                                <span class="dt">name =</span> <span class="st">&quot;&quot;</span>, 
                                <span class="dt">guide =</span> <span class="kw">guide_legend</span>(<span class="dt">override.aes =</span> <span class="kw">list</span>(<span class="dt">alpha =</span> <span class="dv">1</span>, 
                                                                         <span class="dt">point_shape =</span> <span class="kw">c</span>(<span class="dv">21</span>, <span class="dv">3</span>),
                                                                         <span class="dt">point_size =</span> <span class="dv">2</span>))) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_colour_cyclical</span>(<span class="dt">values =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">theme_ridges</span>(<span class="dt">grid =</span> <span class="ot">FALSE</span>) <span class="op">+</span>
<span class="st">  </span><span class="co"># ggplot2::scale_fill_manual(values = c(&quot;#A0FFA0&quot;, &quot;#A0A0FF&quot;)) +</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_discrete_manual</span>(<span class="dt">aesthetics =</span> <span class="st">&quot;point_color&quot;</span>, 
                                  <span class="dt">values =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">4</span>)],
                                  <span class="dt">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_discrete_manual</span>(<span class="dt">aesthetics =</span> <span class="st">&quot;point_fill&quot;</span>,
                                  <span class="dt">values =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">4</span>)],
                                  <span class="dt">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_discrete_manual</span>(<span class="dt">aesthetics =</span> <span class="st">&quot;point_shape&quot;</span>, 
                                  <span class="dt">values =</span> <span class="kw">c</span>(<span class="dv">21</span>, <span class="dv">3</span>),
                                  <span class="dt">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>papaja<span class="op">::</span><span class="kw">theme_apa</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)

plot2 &lt;-<span class="st"> </span>plot2 <span class="op">+</span><span class="st"> </span>
<span class="st">  </span>userfriendlyscience<span class="op">::</span><span class="kw">diamondPlot</span>(sitLie_trackintervention_diamonds_intervention, 
                                   <span class="dt">returnLayerOnly =</span> <span class="ot">TRUE</span>, 
                                   <span class="dt">lineColor =</span> <span class="st">&quot;black&quot;</span>,  
                                   <span class="dt">color=</span>viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">4</span>],
                                   <span class="dt">alpha=</span>.<span class="dv">6</span>, 
                                   <span class="dt">fixedSize =</span> <span class="fl">0.1</span>, 
                                   <span class="dt">otherAxisCol =</span> (<span class="dv">1</span><span class="op">:</span><span class="dv">4</span> <span class="op">+</span><span class="st"> </span>.<span class="dv">15</span>)) <span class="op">+</span>
<span class="st">  </span>userfriendlyscience<span class="op">::</span><span class="kw">diamondPlot</span>(sitLie_trackintervention_diamonds_control, 
                                   <span class="dt">returnLayerOnly =</span> <span class="ot">TRUE</span>, 
                                   <span class="dt">lineColor =</span> <span class="st">&quot;black&quot;</span>,  
                                   <span class="dt">color=</span>viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">2</span>],
                                   <span class="dt">alpha=</span>.<span class="dv">6</span>, 
                                   <span class="dt">fixedSize =</span> <span class="fl">0.1</span>, 
                                   <span class="dt">otherAxisCol =</span> (<span class="dv">1</span><span class="op">:</span><span class="dv">4</span> <span class="op">+</span><span class="st"> </span>.<span class="dv">15</span>))

plot1 <span class="op">+</span><span class="st"> </span>plot2
## Picking joint bandwidth of 29.7
## Warning: Removed 370 rows containing non-finite values
## (stat_density_ridges).
## Picking joint bandwidth of 29.5
## Warning: Removed 370 rows containing non-finite values
## (stat_density_ridges).</code></pre></div>
<p><img src="baseline-supplement_files/figure-html/sitLie-accelerometer-plot-1.png" width="2100" /></p>
<!-- Check for plot correctness -->
<!-- Show gender and group allocation of maximum and minimum values for each track. -->
</div>
</div>
</div>
<div id="pa-determinants" class="section level1">
<h1>PA Determinants</h1>
<p>This section reports various hypothesised determinants of physical activity.</p>
<div id="simple-diamond-plot" class="section level2">
<h2>Simple diamond plot</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">PA_ci_girls &lt;-<span class="st"> </span>ci_girls <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(diamondlabels <span class="op">%in%</span><span class="st"> </span><span class="kw">names</span>(scales_T1) <span class="op">&amp;</span><span class="st"> </span><span class="kw">grepl</span>(<span class="st">&quot;PA_&quot;</span>, diamondlabels) <span class="op">&amp;</span><span class="st"> </span><span class="op">!</span><span class="kw">grepl</span>(<span class="st">&quot;bct&quot;</span>, diamondlabels))

PA_ci_boys &lt;-<span class="st"> </span>ci_boys <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(diamondlabels <span class="op">%in%</span><span class="st"> </span><span class="kw">names</span>(scales_T1) <span class="op">&amp;</span><span class="st"> </span><span class="kw">grepl</span>(<span class="st">&quot;PA_&quot;</span>, diamondlabels) <span class="op">&amp;</span><span class="st"> </span><span class="op">!</span><span class="kw">grepl</span>(<span class="st">&quot;bct&quot;</span>, diamondlabels))

PA_ci_intervention &lt;-<span class="st"> </span>ci_intervention <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(diamondlabels <span class="op">%in%</span><span class="st"> </span><span class="kw">names</span>(scales_T1) <span class="op">&amp;</span><span class="st"> </span><span class="kw">grepl</span>(<span class="st">&quot;PA_&quot;</span>, diamondlabels) <span class="op">&amp;</span><span class="st"> </span><span class="op">!</span><span class="kw">grepl</span>(<span class="st">&quot;bct&quot;</span>, diamondlabels))

PA_ci_control &lt;-<span class="st"> </span>ci_control <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(diamondlabels <span class="op">%in%</span><span class="st"> </span><span class="kw">names</span>(scales_T1) <span class="op">&amp;</span><span class="st"> </span><span class="kw">grepl</span>(<span class="st">&quot;PA_&quot;</span>, diamondlabels) <span class="op">&amp;</span><span class="st"> </span><span class="op">!</span><span class="kw">grepl</span>(<span class="st">&quot;bct&quot;</span>, diamondlabels))

ICClabels &lt;-<span class="st"> </span>vardatatable_containing_edutrack <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(Variable <span class="op">%in%</span><span class="st"> </span>PA_ci_control<span class="op">$</span>diamondlabels)

plot1 &lt;-<span class="st"> </span>userfriendlyscience<span class="op">::</span><span class="kw">diamondPlot</span>(PA_ci_girls, <span class="dt">color =</span> <span class="st">&#39;green&#39;</span>, <span class="dt">alpha=</span>.<span class="dv">3</span>, <span class="dt">yLabels =</span> PA_ci_girls<span class="op">$</span>diamondlabels, <span class="dt">fixedSize =</span> <span class="fl">0.3</span>, <span class="dt">xlab =</span> <span class="ot">NULL</span>) <span class="op">+</span>
<span class="st">  </span>userfriendlyscience<span class="op">::</span><span class="kw">diamondPlot</span>(PA_ci_boys, <span class="dt">returnLayerOnly =</span> <span class="ot">TRUE</span>, <span class="dt">color=</span><span class="st">&#39;blue&#39;</span>, <span class="dt">alpha=</span>.<span class="dv">3</span>, <span class="dt">fixedSize =</span> <span class="fl">0.3</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">7</span>), <span class="dt">breaks =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">7</span>)

plot2 &lt;-<span class="st"> </span>userfriendlyscience<span class="op">::</span><span class="kw">diamondPlot</span>(PA_ci_intervention, <span class="dt">color =</span> <span class="st">&#39;red&#39;</span>, <span class="dt">alpha=</span>.<span class="dv">3</span>, <span class="dt">yLabels =</span> <span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">&quot;&quot;</span>, <span class="kw">length</span>(PA_ci_girls<span class="op">$</span>diamondlabels))), <span class="dt">fixedSize =</span> <span class="fl">0.3</span>, <span class="dt">xlab =</span> <span class="ot">NULL</span>, <span class="dt">ylab =</span> <span class="ot">NULL</span>) <span class="op">+</span>
<span class="st">  </span>userfriendlyscience<span class="op">::</span><span class="kw">diamondPlot</span>(PA_ci_control, <span class="dt">returnLayerOnly =</span> <span class="ot">TRUE</span>, <span class="dt">color=</span><span class="st">&#39;black&#39;</span>, <span class="dt">alpha=</span>.<span class="dv">3</span>, <span class="dt">fixedSize =</span> <span class="fl">0.3</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">7</span>), <span class="dt">breaks =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">7</span>)

grid<span class="op">::</span><span class="kw">grid.newpage</span>()
grid<span class="op">::</span><span class="kw">grid.draw</span>(<span class="kw">cbind</span>(ggplot2<span class="op">::</span><span class="kw">ggplotGrob</span>(plot1), ggplot2<span class="op">::</span><span class="kw">ggplotGrob</span>(plot2), <span class="dt">size =</span> <span class="st">&quot;first&quot;</span>))</code></pre></div>
<p><img src="baseline-supplement_files/figure-html/selfrep-determinants-simple-diamondplot-1.png" width="2100" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># dat2 &lt;- data.frame(ciLo = c(3, 2), mean = c(4, 2.5), ciHi = c(6, 3));</span>
<span class="co"># userfriendlyscience::diamondPlot(dat1, color = &#39;blue&#39;, alpha=.3, yLabels = dat1$diamondlabels) +</span>
<span class="co"># userfriendlyscience::diamondPlot(dat2, returnLayerOnly = TRUE, color=&#39;red&#39;, alpha=.3)</span>
 </code></pre></div>
<p>Note: action and coping planning on a scale from 1 to 4.</p>
</div>
<div id="pa-motivation" class="section level2">
<h2>PA motivation</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
plot1 &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(id,
  intervention,
  group,
  school,
  girl,
  <span class="st">&#39;PA autonomous</span><span class="ch">\n</span><span class="st">motivation&#39;</span> =<span class="st"> </span>PA_autonomous_T1,
<span class="st">&#39;PA controlled</span><span class="ch">\n</span><span class="st">motivation&#39;</span> =<span class="st"> </span>PA_controlled_T1,
<span class="st">&#39;PA amotivation&#39;</span> =<span class="st"> </span>PA_amotivation_T1)  <span class="op">%&gt;%</span>
<span class="st">  </span>tidyr<span class="op">::</span><span class="kw">gather</span>(<span class="dt">key =</span> Variable, <span class="dt">value =</span> Value, <span class="dv">6</span><span class="op">:</span><span class="kw">ncol</span>(.), <span class="dt">factor_key =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span>
<span class="st">  </span>ggplot2<span class="op">::</span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">y =</span> Variable)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">geom_density_ridges</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Value,
                                    <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>,
                                    <span class="dt">fill =</span> <span class="kw">paste</span>(Variable, girl),
                                    <span class="dt">point_color =</span> girl,
                                    <span class="dt">point_fill =</span> girl,
                                    <span class="dt">point_shape =</span> girl,
                                    <span class="dt">point_size =</span> girl,
                                    <span class="dt">point_alpha =</span> girl),
                                <span class="dt">scale =</span> <span class="fl">1.16</span>, <span class="dt">alpha =</span> .<span class="dv">6</span>, <span class="dt">size =</span> <span class="fl">0.25</span>,
                                <span class="dt">from =</span> <span class="dv">1</span>, <span class="dt">to =</span> <span class="dv">5</span>,
                                <span class="dt">position =</span> <span class="kw">position_raincloud</span>(<span class="dt">width =</span> <span class="fl">0.03</span>, <span class="dt">height =</span> <span class="fl">0.2</span>),
                                <span class="dt">jittered_points =</span> <span class="ot">TRUE</span>,
                                <span class="dt">point_size =</span> <span class="dv">1</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="ot">NULL</span>,
       <span class="dt">y =</span> <span class="ot">NULL</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_discrete</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_fill_cyclical</span>(
                      <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&#39;PA amotivation boy&#39;</span> =<span class="st"> &quot;Boy&quot;</span>, <span class="st">&#39;PA amotivation girl&#39;</span> =<span class="st"> &quot;Girl&quot;</span>),
                      <span class="dt">values =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>)],
                      <span class="dt">name =</span> <span class="st">&quot;&quot;</span>, 
                      <span class="dt">guide =</span> <span class="kw">guide_legend</span>(<span class="dt">override.aes =</span> <span class="kw">list</span>(<span class="dt">alpha =</span> <span class="dv">1</span>, 
                                                               <span class="dt">point_shape =</span> <span class="kw">c</span>(<span class="dv">24</span>, <span class="dv">25</span>),
                                                               <span class="dt">point_size =</span> <span class="dv">2</span>))) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_colour_cyclical</span>(<span class="dt">values =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">theme_ridges</span>(<span class="dt">grid =</span> <span class="ot">FALSE</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_discrete_manual</span>(<span class="dt">aesthetics =</span> <span class="st">&quot;point_color&quot;</span>, 
                                  <span class="dt">values =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>)],
                                  <span class="dt">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_discrete_manual</span>(<span class="dt">aesthetics =</span> <span class="st">&quot;point_fill&quot;</span>,
                                  <span class="dt">values =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>)],
                                  <span class="dt">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_discrete_manual</span>(<span class="dt">aesthetics =</span> <span class="st">&quot;point_shape&quot;</span>, 
                                  <span class="dt">values =</span> <span class="kw">c</span>(<span class="dv">24</span>, <span class="dv">25</span>),
                                  <span class="dt">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_discrete_manual</span>(<span class="dt">aesthetics =</span> <span class="st">&quot;point_size&quot;</span>, 
                                  <span class="dt">values =</span> <span class="kw">c</span>(.<span class="dv">75</span>, .<span class="dv">75</span>),
                                  <span class="dt">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_discrete_manual</span>(<span class="dt">aesthetics =</span> <span class="st">&quot;point_alpha&quot;</span>, 
                                  <span class="dt">values =</span> <span class="kw">c</span>(<span class="fl">0.3</span>, <span class="fl">0.3</span>),
                                  <span class="dt">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>papaja<span class="op">::</span><span class="kw">theme_apa</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)

target =<span class="st"> </span><span class="kw">c</span>(
<span class="st">&quot;PA_autonomous_T1&quot;</span>,
<span class="st">&quot;PA_controlled_T1&quot;</span>,
<span class="st">&quot;PA_amotivation_T1&quot;</span>)

PA_ci_girls &lt;-<span class="st"> </span>ci_girls <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(diamondlabels <span class="op">%in%</span><span class="st"> </span><span class="kw">names</span>(scales_T1) <span class="op">&amp;</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_autonomous_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_controlled_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_amotivation_T1&quot;</span>, diamondlabels))

PA_ci_girls &lt;-<span class="st"> </span>PA_ci_girls[<span class="kw">match</span>(target, PA_ci_girls<span class="op">$</span>diamondlabels), ]

PA_ci_boys &lt;-<span class="st"> </span>ci_boys <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(diamondlabels <span class="op">%in%</span><span class="st"> </span><span class="kw">names</span>(scales_T1) <span class="op">&amp;</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_autonomous_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_controlled_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_amotivation_T1&quot;</span>, diamondlabels))

PA_ci_boys &lt;-<span class="st"> </span>PA_ci_boys[<span class="kw">match</span>(target, PA_ci_boys<span class="op">$</span>diamondlabels), ]

plot1 &lt;-<span class="st"> </span>plot1 <span class="op">+</span><span class="st"> </span>userfriendlyscience<span class="op">::</span><span class="kw">diamondPlot</span>(PA_ci_girls, <span class="dt">returnLayerOnly =</span> <span class="ot">TRUE</span>, <span class="dt">lineColor =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">color=</span>viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">3</span>], 
                <span class="dt">alpha=</span>.<span class="dv">6</span>, <span class="dt">fixedSize =</span> <span class="fl">0.05</span>, <span class="dt">otherAxisCol =</span> (<span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(target) <span class="op">+</span><span class="st"> </span>.<span class="dv">07</span>)) <span class="op">+</span>
<span class="st">  </span>userfriendlyscience<span class="op">::</span><span class="kw">diamondPlot</span>(PA_ci_boys, <span class="dt">returnLayerOnly =</span> <span class="ot">TRUE</span>, <span class="dt">lineColor =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">linetype =</span> <span class="st">&quot;solid&quot;</span>, <span class="dt">color=</span>viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">1</span>],  
                <span class="dt">alpha=</span>.<span class="dv">6</span>, <span class="dt">fixedSize =</span> <span class="fl">0.05</span>, <span class="dt">otherAxisCol =</span> (<span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(target) <span class="op">+</span><span class="st"> </span>.<span class="dv">07</span>))

plot2 &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(id,
                              intervention,
                              group,
                              school,
                              girl,
                              <span class="st">&#39;PA autonomous</span><span class="ch">\n</span><span class="st">motivation&#39;</span> =<span class="st"> </span>PA_autonomous_T1,
                              <span class="st">&#39;PA controlled</span><span class="ch">\n</span><span class="st">motivation&#39;</span> =<span class="st"> </span>PA_controlled_T1,
                              <span class="st">&#39;PA amotivation&#39;</span> =<span class="st"> </span>PA_amotivation_T1)  <span class="op">%&gt;%</span>
<span class="st">  </span>tidyr<span class="op">::</span><span class="kw">gather</span>(<span class="dt">key =</span> Variable, <span class="dt">value =</span> Value, <span class="dv">6</span><span class="op">:</span><span class="kw">ncol</span>(.), <span class="dt">factor_key =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span>
<span class="st">  </span>ggplot2<span class="op">::</span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">y =</span> Variable)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">geom_density_ridges</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Value,
                                    <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>,
                                    <span class="dt">fill =</span> <span class="kw">paste</span>(Variable, intervention),
                                    <span class="dt">point_color =</span> intervention,
                                    <span class="dt">point_fill =</span> intervention,
                                    <span class="dt">point_shape =</span> intervention,
                                    <span class="dt">point_size =</span> intervention,
                                    <span class="dt">point_alpha =</span> intervention),
                                <span class="dt">scale =</span> <span class="fl">1.16</span>, <span class="dt">alpha =</span> .<span class="dv">6</span>, <span class="dt">size =</span> <span class="fl">0.25</span>,
                                <span class="dt">from =</span> <span class="dv">1</span>, <span class="dt">to =</span> <span class="dv">5</span>,
                                <span class="dt">position =</span> <span class="kw">position_raincloud</span>(<span class="dt">width =</span> <span class="fl">0.03</span>, <span class="dt">height =</span> <span class="fl">0.2</span>),
                                <span class="dt">jittered_points =</span> <span class="ot">TRUE</span>,
                                <span class="dt">point_size =</span> <span class="dv">1</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="ot">NULL</span>,
       <span class="dt">y =</span> <span class="ot">NULL</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_discrete</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_fill_cyclical</span>(
                      <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&#39;PA amotivation 0&#39;</span> =<span class="st"> &quot;Control&quot;</span>, <span class="st">&#39;PA amotivation 1&#39;</span> =<span class="st"> &quot;Intervention&quot;</span>),
                      <span class="dt">values =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">4</span>)],
                      <span class="dt">name =</span> <span class="st">&quot;&quot;</span>, 
                      <span class="dt">guide =</span> <span class="kw">guide_legend</span>(<span class="dt">override.aes =</span> <span class="kw">list</span>(<span class="dt">alpha =</span> <span class="dv">1</span>, 
                                                               <span class="dt">point_shape =</span> <span class="kw">c</span>(<span class="dv">22</span>, <span class="dv">23</span>),
                                                               <span class="dt">point_size =</span> <span class="dv">2</span>))) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_colour_cyclical</span>(<span class="dt">values =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">theme_ridges</span>(<span class="dt">grid =</span> <span class="ot">FALSE</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_discrete_manual</span>(<span class="dt">aesthetics =</span> <span class="st">&quot;point_color&quot;</span>, 
                                  <span class="dt">values =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">4</span>)],
                                  <span class="dt">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_discrete_manual</span>(<span class="dt">aesthetics =</span> <span class="st">&quot;point_fill&quot;</span>,
                                  <span class="dt">values =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">4</span>)],
                                  <span class="dt">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_discrete_manual</span>(<span class="dt">aesthetics =</span> <span class="st">&quot;point_shape&quot;</span>, 
                                  <span class="dt">values =</span> <span class="kw">c</span>(<span class="dv">22</span>, <span class="dv">23</span>),
                                  <span class="dt">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_discrete_manual</span>(<span class="dt">aesthetics =</span> <span class="st">&quot;point_size&quot;</span>, 
                                  <span class="dt">values =</span> <span class="kw">c</span>(.<span class="dv">75</span>, .<span class="dv">75</span>),
                                  <span class="dt">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_discrete_manual</span>(<span class="dt">aesthetics =</span> <span class="st">&quot;point_alpha&quot;</span>, 
                                  <span class="dt">values =</span> <span class="kw">c</span>(<span class="fl">0.3</span>, <span class="fl">0.3</span>),
                                  <span class="dt">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>papaja<span class="op">::</span><span class="kw">theme_apa</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)

PA_ci_intervention &lt;-<span class="st"> </span>ci_intervention <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(diamondlabels <span class="op">%in%</span><span class="st"> </span><span class="kw">names</span>(scales_T1) <span class="op">&amp;</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_autonomous_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_controlled_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_amotivation_T1&quot;</span>, diamondlabels))

PA_ci_intervention &lt;-<span class="st"> </span>PA_ci_intervention[<span class="kw">match</span>(target, PA_ci_intervention<span class="op">$</span>diamondlabels), ]

PA_ci_control &lt;-<span class="st"> </span>ci_control <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(diamondlabels <span class="op">%in%</span><span class="st"> </span><span class="kw">names</span>(scales_T1) <span class="op">&amp;</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_autonomous_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_controlled_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_amotivation_T1&quot;</span>, diamondlabels))

PA_ci_control &lt;-<span class="st"> </span>PA_ci_control[<span class="kw">match</span>(target, PA_ci_control<span class="op">$</span>diamondlabels), ]

plot2 &lt;-<span class="st"> </span>plot2 <span class="op">+</span><span class="st"> </span>
<span class="st">  </span>userfriendlyscience<span class="op">::</span><span class="kw">diamondPlot</span>(PA_ci_intervention, <span class="dt">returnLayerOnly =</span> <span class="ot">TRUE</span>, <span class="dt">lineColor =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">color=</span>viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">4</span>],
              <span class="dt">alpha=</span>.<span class="dv">6</span>, <span class="dt">fixedSize =</span> <span class="fl">0.05</span>, <span class="dt">otherAxisCol =</span> (<span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(target) <span class="op">+</span><span class="st"> </span>.<span class="dv">07</span>)) <span class="op">+</span>
<span class="st">  </span>userfriendlyscience<span class="op">::</span><span class="kw">diamondPlot</span>(PA_ci_control, <span class="dt">returnLayerOnly =</span> <span class="ot">TRUE</span>, <span class="dt">lineColor =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">color=</span>viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">2</span>], 
              <span class="dt">alpha=</span>.<span class="dv">6</span>, <span class="dt">fixedSize =</span> <span class="fl">0.05</span>, <span class="dt">otherAxisCol =</span> (<span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(target) <span class="op">+</span><span class="st"> </span>.<span class="dv">07</span>))

plot1 <span class="op">+</span><span class="st"> </span>plot2 
## Picking joint bandwidth of 0.216
## Warning: Removed 272 rows containing non-finite values
## (stat_density_ridges).
## Picking joint bandwidth of 0.216
## Warning: Removed 272 rows containing non-finite values
## (stat_density_ridges).</code></pre></div>
<p><img src="baseline-supplement_files/figure-html/pa-determinants-motivation-1.png" width="2100" /></p>
<p>To check that the labels/colors in diamonds are right, here are means of the variables:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(
  intervention,
  girl,
  <span class="st">&#39;PA autonomous </span><span class="ch">\n</span><span class="st">motivation&#39;</span> =<span class="st"> </span>PA_autonomous_T1,
<span class="st">&#39;PA controlled </span><span class="ch">\n</span><span class="st">motivation&#39;</span> =<span class="st"> </span>PA_controlled_T1,
<span class="st">&#39;PA amotivation&#39;</span> =<span class="st"> </span>PA_amotivation_T1) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(girl) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarise_at</span>(<span class="kw">vars</span>(<span class="kw">contains</span>(<span class="st">&quot;PA&quot;</span>)), <span class="kw">funs</span>(<span class="kw">mean</span>(., <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>DT<span class="op">::</span><span class="kw">datatable</span>() <span class="co">#papaja::apa_table()</span></code></pre></div>
<div id="htmlwidget-e306786c2ff5bce7a177" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-e306786c2ff5bce7a177">{"x":{"filter":"none","data":[["1","2","3"],["girl","boy",null],[3.36778440235887,3.46523316678563,null],[1.88830313014827,1.76716738197425,null],[1.45716253443526,1.63829407566024,null]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>girl<\/th>\n      <th>PA autonomous \nmotivation<\/th>\n      <th>PA controlled \nmotivation<\/th>\n      <th>PA amotivation<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-center","targets":"_all"},{"className":"dt-right","targets":[2,3,4]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(
  intervention,
  girl,
  <span class="st">&#39;PA autonomous </span><span class="ch">\n</span><span class="st">motivation&#39;</span> =<span class="st"> </span>PA_autonomous_T1,
<span class="st">&#39;PA controlled </span><span class="ch">\n</span><span class="st">motivation&#39;</span> =<span class="st"> </span>PA_controlled_T1,
<span class="st">&#39;PA amotivation&#39;</span> =<span class="st"> </span>PA_amotivation_T1) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(intervention) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">summarise_at</span>(<span class="kw">vars</span>(<span class="kw">contains</span>(<span class="st">&quot;PA&quot;</span>)), <span class="kw">funs</span>(<span class="kw">mean</span>(., <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>DT<span class="op">::</span><span class="kw">datatable</span>() <span class="co">#papaja::apa_table()</span></code></pre></div>
<div id="htmlwidget-bfb121ad3377069c8856" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-bfb121ad3377069c8856">{"x":{"filter":"none","data":[["1","2","3"],["0","1",null],[3.47441708814454,3.35448364722976,null],[1.87494969818913,1.80182291666667,null],[1.55717639168343,1.51782608695652,null]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>intervention<\/th>\n      <th>PA autonomous \nmotivation<\/th>\n      <th>PA controlled \nmotivation<\/th>\n      <th>PA amotivation<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-center","targets":"_all"},{"className":"dt-right","targets":[2,3,4]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="big-5-personality-traits" class="section level2">
<h2>Big 5 personality traits</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
plot1 &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(id,
  intervention,
  group,
  school,
  girl,
<span class="st">&#39;Agreeableness&#39;</span> =<span class="st"> </span>big5agreeableness_T1,
<span class="st">&#39;Conscientiousness&#39;</span> =<span class="st"> </span>big5conscientiousness_T1,
<span class="st">&#39;Extraversion&#39;</span> =<span class="st"> </span>big5extraversion_T1,
<span class="st">&#39;Neuroticism&#39;</span> =<span class="st"> </span>big5neuroticism_T1,
<span class="st">&#39;Openness&#39;</span> =<span class="st"> </span>big5openness_T1)  <span class="op">%&gt;%</span>
<span class="st">  </span><span class="co"># dplyr::select(noquote(order(colnames(.)))) %&gt;% # Orders columns alphabetically</span>
<span class="st">  </span>tidyr<span class="op">::</span><span class="kw">gather</span>(<span class="dt">key =</span> Variable, <span class="dt">value =</span> Value, <span class="dv">6</span><span class="op">:</span><span class="kw">ncol</span>(.)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>ggplot2<span class="op">::</span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">y =</span> Variable)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">geom_density_ridges</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Value, <span class="dt">fill =</span> <span class="kw">paste</span>(Variable, girl)), 
           <span class="dt">alpha =</span> .<span class="dv">6</span>, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">from =</span> <span class="dv">1</span>, <span class="dt">to =</span> <span class="dv">7</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;&quot;</span>,
       <span class="dt">y =</span> <span class="st">&quot;&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_discrete</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_fill_cyclical</span>(<span class="dt">breaks =</span> <span class="kw">c</span>(<span class="st">&quot;Agreeableness boy&quot;</span>, <span class="st">&quot;Agreeableness girl&quot;</span>),
                      <span class="dt">labels =</span> <span class="kw">c</span>( <span class="st">&#39;Agreeableness boy&#39;</span> =<span class="st"> &quot;Boy&quot;</span>, <span class="st">&#39;Agreeableness girl&#39;</span> =<span class="st"> &quot;Girl&quot;</span>),
                      <span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;#3bc600&quot;</span>, <span class="st">&quot;#0000ff&quot;</span>, <span class="st">&quot;#9cc68b&quot;</span>, <span class="st">&quot;#8080ff&quot;</span>),
                      <span class="dt">name =</span> <span class="st">&quot;&quot;</span>, <span class="dt">guide =</span> <span class="st">&quot;legend&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">theme_ridges</span>(<span class="dt">grid =</span> <span class="ot">FALSE</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">&quot;bottom&quot;</span>)
## Warning: attributes are not identical across measure variables;
## they will be dropped

plot2 &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(id,
  intervention,
  group,
  school,
  girl,
<span class="st">&#39;Agreeableness&#39;</span> =<span class="st"> </span>big5agreeableness_T1,
<span class="st">&#39;Conscientiousness&#39;</span> =<span class="st"> </span>big5conscientiousness_T1,
<span class="st">&#39;Extraversion&#39;</span> =<span class="st"> </span>big5extraversion_T1,
<span class="st">&#39;Neuroticism&#39;</span> =<span class="st"> </span>big5neuroticism_T1,
<span class="st">&#39;Openness&#39;</span> =<span class="st"> </span>big5openness_T1) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="co"># dplyr::select(noquote(order(colnames(.)))) %&gt;% # Orders columns alphabetically</span>
<span class="st">  </span>tidyr<span class="op">::</span><span class="kw">gather</span>(<span class="dt">key =</span> Variable, <span class="dt">value =</span> Value, <span class="dv">6</span><span class="op">:</span><span class="kw">ncol</span>(.)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>ggplot2<span class="op">::</span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">y =</span> Variable)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">geom_density_ridges</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Value, <span class="dt">fill =</span> <span class="kw">paste</span>(Variable, intervention)), 
           <span class="dt">alpha =</span> .<span class="dv">6</span>, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">from =</span> <span class="dv">1</span>, <span class="dt">to =</span> <span class="dv">7</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;&quot;</span>,
       <span class="dt">y =</span> <span class="st">&quot;&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_discrete</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>), <span class="dt">labels =</span> <span class="ot">NULL</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_fill_cyclical</span>(<span class="dt">breaks =</span> <span class="kw">c</span>(<span class="st">&quot;Agreeableness 1&quot;</span>, <span class="st">&quot;Agreeableness 0&quot;</span>),
                      <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&#39;Agreeableness 1&#39;</span> =<span class="st"> &quot;Intervention&quot;</span>, <span class="st">&#39;Agreeableness 0&#39;</span> =<span class="st"> &quot;Control&quot;</span>),
                      <span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;#ff0000&quot;</span>, <span class="st">&quot;#0000ff&quot;</span>, <span class="st">&quot;#ff8080&quot;</span>, <span class="st">&quot;#8080ff&quot;</span>),
                      <span class="dt">name =</span> <span class="st">&quot;&quot;</span>, <span class="dt">guide =</span> <span class="st">&quot;legend&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">theme_ridges</span>(<span class="dt">grid =</span> <span class="ot">FALSE</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">&quot;bottom&quot;</span>)
## Warning: attributes are not identical across measure variables;
## they will be dropped

plot1 <span class="op">+</span><span class="st"> </span>plot2
## Picking joint bandwidth of 0.398
## Warning: Removed 516 rows containing non-finite values
## (stat_density_ridges).
## Picking joint bandwidth of 0.405
## Warning: Removed 516 rows containing non-finite values
## (stat_density_ridges).</code></pre></div>
<p><img src="baseline-supplement_files/figure-html/big5-1.png" width="2100" /></p>
</div>
<div id="bct-use" class="section level2">
<h2>BCT use</h2>
<div id="ridge-plots-for-means" class="section level3">
<h3>Ridge plots for means</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
plot1 &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(id,
  intervention,
  group,
  school,
  girl,
<span class="st">&#39;Frequency-</span><span class="ch">\n</span><span class="st">related BCTs&#39;</span> =<span class="st"> </span>PA_frqbct_T1,
<span class="st">&#39;Agreement-</span><span class="ch">\n</span><span class="st">related BCTs&#39;</span> =<span class="st"> </span>PA_agrbct_T1)  <span class="op">%&gt;%</span>
<span class="st">  </span><span class="co"># dplyr::select(noquote(order(colnames(.)))) %&gt;% # Orders columns alphabetically</span>
<span class="st">  </span>tidyr<span class="op">::</span><span class="kw">gather</span>(<span class="dt">key =</span> Variable, <span class="dt">value =</span> Value, <span class="dv">6</span><span class="op">:</span><span class="kw">ncol</span>(.)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>ggplot2<span class="op">::</span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">y =</span> Variable)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">geom_density_ridges</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Value, <span class="dt">fill =</span> <span class="kw">paste</span>(Variable, girl)), 
           <span class="dt">alpha =</span> .<span class="dv">6</span>, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">from =</span> <span class="dv">1</span>, <span class="dt">to =</span> <span class="dv">7</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;&quot;</span>,
       <span class="dt">y =</span> <span class="st">&quot;&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_discrete</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_fill_cyclical</span>(<span class="dt">breaks =</span> <span class="kw">c</span>(<span class="st">&quot;Agreement-</span><span class="ch">\n</span><span class="st">related BCTs boy&quot;</span>, <span class="st">&quot;Agreement-</span><span class="ch">\n</span><span class="st">related BCTs girl&quot;</span>),
                      <span class="dt">labels =</span> <span class="kw">c</span>( <span class="st">&#39;Agreement-</span><span class="ch">\n</span><span class="st">related BCTs boy&#39;</span> =<span class="st"> &quot;Boy&quot;</span>, <span class="st">&#39;Agreement-</span><span class="ch">\n</span><span class="st">related BCTs girl&#39;</span> =<span class="st"> &quot;Girl&quot;</span>),
                      <span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;#3bc600&quot;</span>, <span class="st">&quot;#0000ff&quot;</span>, <span class="st">&quot;#9cc68b&quot;</span>, <span class="st">&quot;#8080ff&quot;</span>),
                      <span class="dt">name =</span> <span class="st">&quot;&quot;</span>, <span class="dt">guide =</span> <span class="st">&quot;legend&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">theme_ridges</span>(<span class="dt">grid =</span> <span class="ot">FALSE</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">&quot;bottom&quot;</span>)

plot2 &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(id,
  intervention,
  group,
  school,
  girl,
<span class="st">&#39;Frequency-</span><span class="ch">\n</span><span class="st">related BCTs&#39;</span> =<span class="st"> </span>PA_frqbct_T1,
<span class="st">&#39;Agreement-</span><span class="ch">\n</span><span class="st">related BCTs&#39;</span> =<span class="st"> </span>PA_agrbct_T1) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="co"># dplyr::select(noquote(order(colnames(.)))) %&gt;% # Orders columns alphabetically</span>
<span class="st">  </span>tidyr<span class="op">::</span><span class="kw">gather</span>(<span class="dt">key =</span> Variable, <span class="dt">value =</span> Value, <span class="dv">6</span><span class="op">:</span><span class="kw">ncol</span>(.)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>ggplot2<span class="op">::</span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">y =</span> Variable)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">geom_density_ridges</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Value, <span class="dt">fill =</span> <span class="kw">paste</span>(Variable, intervention)), 
           <span class="dt">alpha =</span> .<span class="dv">6</span>, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">from =</span> <span class="dv">1</span>, <span class="dt">to =</span> <span class="dv">7</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;&quot;</span>,
       <span class="dt">y =</span> <span class="st">&quot;&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_discrete</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>), <span class="dt">labels =</span> <span class="ot">NULL</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_fill_cyclical</span>(<span class="dt">breaks =</span> <span class="kw">c</span>(<span class="st">&quot;Agreement-</span><span class="ch">\n</span><span class="st">related BCTs 1&quot;</span>, <span class="st">&quot;Agreement-</span><span class="ch">\n</span><span class="st">related BCTs 0&quot;</span>),
                      <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&#39;Agreement-</span><span class="ch">\n</span><span class="st">related BCTs 1&#39;</span> =<span class="st"> &quot;Intervention&quot;</span>, <span class="st">&#39;Agreement-</span><span class="ch">\n</span><span class="st">related BCTs 0&#39;</span> =<span class="st"> &quot;Control&quot;</span>),
                      <span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;#ff0000&quot;</span>, <span class="st">&quot;#0000ff&quot;</span>, <span class="st">&quot;#ff8080&quot;</span>, <span class="st">&quot;#8080ff&quot;</span>),
                      <span class="dt">name =</span> <span class="st">&quot;&quot;</span>, <span class="dt">guide =</span> <span class="st">&quot;legend&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">theme_ridges</span>(<span class="dt">grid =</span> <span class="ot">FALSE</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">&quot;bottom&quot;</span>)

plot1 <span class="op">+</span><span class="st"> </span>plot2
## Picking joint bandwidth of 0.319
## Warning: Removed 189 rows containing non-finite values
## (stat_density_ridges).
## Picking joint bandwidth of 0.318
## Warning: Removed 189 rows containing non-finite values
## (stat_density_ridges).</code></pre></div>
<p><img src="baseline-supplement_files/figure-html/bct-sumscore-density-plot-1.png" width="2100" /></p>
</div>
<div id="sm-kernel-density-plots-for-means" class="section level3">
<h3>sm kernel density plots for means</h3>
<div id="frequency-measured-bcts" class="section level4">
<h4>Frequency-measured BCTs</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># Create data frame</span>
densplot &lt;-<span class="st"> </span>df
<span class="kw">levels</span>(densplot<span class="op">$</span>intervention) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Control&quot;</span>, <span class="st">&quot;Intervention&quot;</span>)
<span class="kw">levels</span>(densplot<span class="op">$</span>girl) &lt;-<span class="st"> </span><span class="kw">recode</span>(densplot<span class="op">$</span>girl, <span class="st">&quot;boy&quot;</span> =<span class="st"> &quot;Boys&quot;</span>, <span class="st">&quot;girl&quot;</span> =<span class="st"> &quot;Girls&quot;</span>)

<span class="co"># This gives side-by-side plots. There&#39;s a third plot below the two, which is fake to include x-axis text.</span>
<span class="kw">layout</span>(<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">3</span>), <span class="dt">nrow =</span> <span class="dv">2</span>, <span class="dt">ncol =</span> <span class="dv">2</span>, <span class="dt">byrow =</span> <span class="ot">TRUE</span>),
       <span class="dt">widths =</span> <span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>),<span class="dt">heights =</span> <span class="kw">c</span>(<span class="fl">0.45</span>,<span class="fl">0.05</span>))

<span class="co"># Minimise whitespace; see https://stackoverflow.com/questions/15848942/how-to-reduce-space-gap-between-multiple-graphs-in-r</span>
<span class="kw">par</span>(<span class="dt">mai =</span> <span class="kw">c</span>(<span class="fl">0.3</span>, <span class="fl">0.3</span>, <span class="fl">0.1</span>, <span class="fl">0.0</span>)) 

## Girls vs. boys
<span class="co"># Choose only the variables needed and drop NA</span>
dens &lt;-<span class="st"> </span>densplot <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(PA_frqbct_T1, girl) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="kw">complete.cases</span>(.))

<span class="co"># Set random number generator for reproducibility of bootstrap test of equal densities</span>
<span class="kw">set.seed</span>(<span class="dv">10</span>)

<span class="co"># Make plot</span>
sm.PA_frqbct_T1_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">sm.density.compare2</span>(<span class="kw">as.numeric</span>(dens<span class="op">$</span>PA_frqbct_T1), 
                                               <span class="kw">as.factor</span>(dens<span class="op">$</span>girl), 
                                               <span class="dt">model =</span> <span class="st">&quot;equal&quot;</span>,
                                               <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>,
                                               <span class="dt">col =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end  =</span>  <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">1</span>)], 
                                               <span class="dt">lty =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>), <span class="dt">yaxt =</span> <span class="st">&quot;n&quot;</span>,
                                               <span class="dt">bandcol =</span> <span class="st">&#39;LightGray&#39;</span>, 
                                               <span class="dt">lwd =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>),
                                               <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">6</span>))
## 
## Test of equal densities:  p-value =  0.22
<span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="kw">levels</span>(dens<span class="op">$</span>girl), <span class="dt">col =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>)], <span class="dt">lty =</span> <span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">1</span>), <span class="dt">lwd =</span> (<span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>)))
<span class="kw">mtext</span>(<span class="dt">side =</span> <span class="dv">2</span>, <span class="st">&quot;Density&quot;</span>, <span class="dt">line =</span> <span class="fl">0.5</span>)

## Intervention vs. control
<span class="co"># Choose only the variables needed and drop NA</span>
dens &lt;-<span class="st"> </span>densplot <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(PA_frqbct_T1, intervention) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="kw">complete.cases</span>(.))

<span class="co"># Set random number generator for reproducibility of bootstrap test of equal densities</span>
<span class="kw">set.seed</span>(<span class="dv">10</span>)
<span class="co"># Make plot</span>
sm.PA_frqbct_T1_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">sm.density.compare2</span>(<span class="kw">as.numeric</span>(dens<span class="op">$</span>PA_frqbct_T1), 
                                               <span class="kw">as.factor</span>(dens<span class="op">$</span>intervention), 
                                               <span class="dt">model =</span> <span class="st">&quot;equal&quot;</span>, 
                                               <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>,
                                               <span class="dt">col =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">4</span>)], 
                                               <span class="dt">lty =</span> <span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">1</span>), <span class="dt">yaxt =</span> <span class="st">&quot;n&quot;</span>,
                                               <span class="dt">bandcol =</span> <span class="st">&#39;LightGray&#39;</span>, 
                                               <span class="dt">lwd =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>),
                                               <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">6</span>))
## 
## Test of equal densities:  p-value =  0.35
<span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="kw">levels</span>(dens<span class="op">$</span>intervention), <span class="dt">col =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">4</span>)], <span class="dt">lty=</span><span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">1</span>), <span class="dt">lwd=</span>(<span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>)))

<span class="co"># Create x-axis label. See https://stackoverflow.com/questions/11198767/how-to-annotate-across-or-between-plots-in-multi-plot-panels-in-r</span>
<span class="kw">par</span>(<span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>)) 
<span class="kw">plot</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dt">type =</span> <span class="st">&quot;n&quot;</span>, <span class="dt">frame.plot =</span> <span class="ot">FALSE</span>,<span class="dt">axes =</span> <span class="ot">FALSE</span>) <span class="co"># Fake plot</span>
<span class="kw">text</span>(<span class="dt">x =</span> <span class="fl">1.02</span>, <span class="dt">y =</span> <span class="fl">1.3</span>, <span class="dt">labels =</span> <span class="st">&quot;Frequency-based BCT sumscore mean&quot;</span>, <span class="dt">pos =</span> <span class="dv">1</span>)</code></pre></div>
<p><img src="baseline-supplement_files/figure-html/sm-frqbct-1.png" width="2100" /></p>
</div>
<div id="agreement-measured-bcts" class="section level4">
<h4>Agreement-measured BCTs</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># Create data frame</span>
densplot &lt;-<span class="st"> </span>df
<span class="kw">levels</span>(densplot<span class="op">$</span>intervention) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Control&quot;</span>, <span class="st">&quot;Intervention&quot;</span>)
<span class="kw">levels</span>(densplot<span class="op">$</span>girl) &lt;-<span class="st"> </span><span class="kw">recode</span>(densplot<span class="op">$</span>girl, <span class="st">&quot;boy&quot;</span> =<span class="st"> &quot;Boys&quot;</span>, <span class="st">&quot;girl&quot;</span> =<span class="st"> &quot;Girls&quot;</span>)

<span class="co"># This gives side-by-side plots. There&#39;s a third plot below the two, which is fake to include x-axis text.</span>
<span class="kw">layout</span>(<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">3</span>), <span class="dt">nrow =</span> <span class="dv">2</span>, <span class="dt">ncol =</span> <span class="dv">2</span>, <span class="dt">byrow =</span> <span class="ot">TRUE</span>),
       <span class="dt">widths =</span> <span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>),<span class="dt">heights =</span> <span class="kw">c</span>(<span class="fl">0.45</span>,<span class="fl">0.05</span>))

<span class="co"># Minimise whitespace; see https://stackoverflow.com/questions/15848942/how-to-reduce-space-gap-between-multiple-graphs-in-r</span>
<span class="kw">par</span>(<span class="dt">mai =</span> <span class="kw">c</span>(<span class="fl">0.3</span>, <span class="fl">0.3</span>, <span class="fl">0.1</span>, <span class="fl">0.0</span>)) 

## Girls vs. boys
<span class="co"># Choose only the variables needed and drop NA</span>
dens &lt;-<span class="st"> </span>densplot <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(PA_agrbct_T1, girl) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="kw">complete.cases</span>(.))

<span class="co"># Set random number generator for reproducibility of bootstrap test of equal densities</span>
<span class="kw">set.seed</span>(<span class="dv">10</span>)

<span class="co"># Make plot</span>
sm.PA_agrbct_T1_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">sm.density.compare2</span>(<span class="kw">as.numeric</span>(dens<span class="op">$</span>PA_agrbct_T1), 
                                               <span class="kw">as.factor</span>(dens<span class="op">$</span>girl), 
                                               <span class="dt">model =</span> <span class="st">&quot;equal&quot;</span>,
                                               <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>,
                                               <span class="dt">col =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end  =</span>  <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">1</span>)], 
                                               <span class="dt">lty =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>), <span class="dt">yaxt =</span> <span class="st">&quot;n&quot;</span>,
                                               <span class="dt">bandcol =</span> <span class="st">&#39;LightGray&#39;</span>, 
                                               <span class="dt">lwd =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>),
                                               <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">6</span>))
## 
## Test of equal densities:  p-value =  0.23
<span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="kw">levels</span>(dens<span class="op">$</span>girl), <span class="dt">col =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>)], <span class="dt">lty =</span> <span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">1</span>), <span class="dt">lwd =</span> (<span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>)))
<span class="kw">mtext</span>(<span class="dt">side =</span> <span class="dv">2</span>, <span class="st">&quot;Density&quot;</span>, <span class="dt">line =</span> <span class="fl">0.5</span>)

## Intervention vs. control
<span class="co"># Choose only the variables needed and drop NA</span>
dens &lt;-<span class="st"> </span>densplot <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(PA_agrbct_T1, intervention) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="kw">complete.cases</span>(.))

<span class="co"># Set random number generator for reproducibility of bootstrap test of equal densities</span>
<span class="kw">set.seed</span>(<span class="dv">10</span>)
<span class="co"># Make plot</span>
sm.PA_agrbct_T1_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">sm.density.compare2</span>(<span class="kw">as.numeric</span>(dens<span class="op">$</span>PA_agrbct_T1), 
                                               <span class="kw">as.factor</span>(dens<span class="op">$</span>intervention), 
                                               <span class="dt">model =</span> <span class="st">&quot;equal&quot;</span>, 
                                               <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>,
                                               <span class="dt">col =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">4</span>)], 
                                               <span class="dt">lty =</span> <span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">1</span>), <span class="dt">yaxt =</span> <span class="st">&quot;n&quot;</span>,
                                               <span class="dt">bandcol =</span> <span class="st">&#39;LightGray&#39;</span>, 
                                               <span class="dt">lwd =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>),
                                               <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">6</span>))
## 
## Test of equal densities:  p-value =  0
<span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="kw">levels</span>(dens<span class="op">$</span>intervention), <span class="dt">col =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">4</span>)], <span class="dt">lty=</span><span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">1</span>), <span class="dt">lwd=</span>(<span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>)))
<span class="kw">par</span>(<span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>)) 
<span class="kw">plot</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dt">type =</span> <span class="st">&quot;n&quot;</span>, <span class="dt">frame.plot =</span> <span class="ot">FALSE</span>,<span class="dt">axes =</span> <span class="ot">FALSE</span>) <span class="co"># Fake plot</span>
<span class="kw">text</span>(<span class="dt">x =</span> <span class="fl">1.02</span>, <span class="dt">y =</span> <span class="fl">1.3</span>, <span class="dt">labels =</span> <span class="st">&quot;Agreement-based BCT sumscore mean&quot;</span>, <span class="dt">pos =</span> <span class="dv">1</span>) <span class="co"># Create x-axis label. See https://stackoverflow.com/questions/11198767/how-to-annotate-across-or-between-plots-in-multi-plot-panels-in-r</span></code></pre></div>
<p><img src="baseline-supplement_files/figure-html/sm-agrbct-1.png" width="2100" /></p>
</div>
</div>
<div id="histograms-for-individual-items" class="section level3">
<h3>Histograms for individual items</h3>
<div id="frequency-measured-bcts-1" class="section level4">
<h4>Frequency-measured BCTs</h4>
<p>These questions were asked with the lead “Have you done the following during the last three weeks?”.</p>
<p>The answer scale was as follows:</p>
<p>0 = not once 1 = once 2 = twice 3 = weekly 4 = about every second day 5 = daily</p>
<p>Items are as follows:</p>
<ol style="list-style-type: decimal">
<li>I have reminded myself even in my spare time, what kind of positive consequences frequent PA would have in my life.</li>
<li>I have monitored my PA by marking the PA occasions on an exercise log on paper.</li>
<li>I have monitored my PA by using a smart phone, e.g. the Moves-app.</li>
<li>I use mnemonic cues with which I remember to implement my PA intention.</li>
<li>I have compared my actualized PA with the PA goal I have set.</li>
<li>I have thought about which reasons to do PA are important to me personally.</li>
<li>I have made changes in my home (e.g. my room or my computer), so that starting PA would be easier.</li>
<li>I have asked my friends or family for support to reach my PA goals.</li>
<li>If I haven’t reached my PA goal, I have evaluated, what went wrong.</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">genderInterventionColors &lt;-<span class="st"> </span>viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">11</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)

bctGirls &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(id,
  intervention,
  group,
  school,
  girl,
<span class="st">&#39;Reminded self of positive consequences&#39;</span> =<span class="st"> </span>PA_frqbct_01_T1,
<span class="st">&#39;Has logged PA on paper&#39;</span> =<span class="st"> </span>PA_frqbct_02_T1,
<span class="st">&#39;Has monitored PA on smartphone&#39;</span> =<span class="st"> </span>PA_frqbct_03_T1,
<span class="st">&#39;Uses mnemonic cues&#39;</span> =<span class="st"> </span>PA_frqbct_04_T1,
<span class="st">&#39;Has compared actual with goal&#39;</span> =<span class="st"> </span>PA_frqbct_05_T1,
<span class="st">&#39;Has thought of relevance of PA&#39;</span> =<span class="st"> </span>PA_frqbct_06_T1,
<span class="st">&#39;Has made changes at home&#39;</span> =<span class="st"> </span>PA_frqbct_07_T1,
<span class="st">&#39;Has sought social support&#39;</span> =<span class="st"> </span>PA_frqbct_08_T1,
<span class="st">&#39;Has evaluated why goal not reached&#39;</span> =<span class="st"> </span>PA_frqbct_09_T1) <span class="op">%&gt;%</span>
<span class="st"> </span>tidyr<span class="op">::</span><span class="kw">gather</span>(<span class="dt">key =</span> Variable, <span class="dt">value =</span> Value, <span class="dv">6</span><span class="op">:</span><span class="kw">ncol</span>(.)) <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(girl <span class="op">==</span><span class="st"> &quot;girl&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st"> </span>ggplot2<span class="op">::</span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Value, <span class="dt">y =</span> Variable, <span class="dt">group =</span> Variable)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">geom_density_ridges2</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> Variable), <span class="dt">stat =</span> <span class="st">&quot;binline&quot;</span>, <span class="dt">binwidth =</span> <span class="dv">1</span>, <span class="dt">scale =</span> <span class="fl">0.95</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>), <span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>),
                     <span class="dt">name =</span> <span class="st">&quot;&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_discrete</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>), <span class="dt">name =</span> <span class="st">&quot;&quot;</span>, <span class="dt">labels =</span> <span class="ot">NULL</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_fill_cyclical</span>(<span class="dt">values =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">11</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">7</span><span class="op">:</span><span class="dv">8</span>]) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Girls&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">guides</span>(<span class="dt">y =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">theme_ridges</span>(<span class="dt">grid =</span> <span class="ot">FALSE</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>),
        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>),
        <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>),
        <span class="dt">axis.text=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">10</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">6.5</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">12</span>))
## Warning: attributes are not identical across measure variables;
## they will be dropped

bctBoys &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(id,
  intervention,
  group,
  school,
  girl,
<span class="st">&#39;Reminded self of positive consequences&#39;</span> =<span class="st"> </span>PA_frqbct_01_T1,
<span class="st">&#39;Has logged PA on paper&#39;</span> =<span class="st"> </span>PA_frqbct_02_T1,
<span class="st">&#39;Has monitored PA on smartphone&#39;</span> =<span class="st"> </span>PA_frqbct_03_T1,
<span class="st">&#39;Uses mnemonic cues&#39;</span> =<span class="st"> </span>PA_frqbct_04_T1,
<span class="st">&#39;Has compared actual with goal&#39;</span> =<span class="st"> </span>PA_frqbct_05_T1,
<span class="st">&#39;Has thought of relevance of PA&#39;</span> =<span class="st"> </span>PA_frqbct_06_T1,
<span class="st">&#39;Has made changes at home&#39;</span> =<span class="st"> </span>PA_frqbct_07_T1,
<span class="st">&#39;Has sought social support&#39;</span> =<span class="st"> </span>PA_frqbct_08_T1,
<span class="st">&#39;Has evaluated why goal not reached&#39;</span> =<span class="st"> </span>PA_frqbct_09_T1) <span class="op">%&gt;%</span>
<span class="st"> </span>tidyr<span class="op">::</span><span class="kw">gather</span>(<span class="dt">key =</span> Variable, <span class="dt">value =</span> Value, <span class="dv">6</span><span class="op">:</span><span class="kw">ncol</span>(.)) <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(girl <span class="op">==</span><span class="st"> &quot;boy&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st"> </span>ggplot2<span class="op">::</span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Value, <span class="dt">y =</span> Variable, <span class="dt">group =</span> Variable)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">geom_density_ridges2</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> Variable), <span class="dt">stat =</span> <span class="st">&quot;binline&quot;</span>, <span class="dt">binwidth =</span> <span class="dv">1</span>, <span class="dt">scale =</span> <span class="fl">0.95</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>), <span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>),
                     <span class="dt">name =</span> <span class="st">&quot;&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_discrete</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>), <span class="dt">name =</span> <span class="st">&quot;&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_fill_cyclical</span>(<span class="dt">values =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">11</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>]) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Boys&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">guides</span>(<span class="dt">y =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">theme_ridges</span>(<span class="dt">grid =</span> <span class="ot">FALSE</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>),
        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>),
        <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>),
        <span class="dt">axis.text=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">10</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">6.5</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">12</span>))
## Warning: attributes are not identical across measure variables;
## they will be dropped

bctInt &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(id,
  intervention,
  group,
  school,
  girl,
<span class="st">&#39;Reminded self of positive consequences&#39;</span> =<span class="st"> </span>PA_frqbct_01_T1,
<span class="st">&#39;Has logged PA on paper&#39;</span> =<span class="st"> </span>PA_frqbct_02_T1,
<span class="st">&#39;Has monitored PA on smartphone&#39;</span> =<span class="st"> </span>PA_frqbct_03_T1,
<span class="st">&#39;Uses mnemonic cues&#39;</span> =<span class="st"> </span>PA_frqbct_04_T1,
<span class="st">&#39;Has compared actual with goal&#39;</span> =<span class="st"> </span>PA_frqbct_05_T1,
<span class="st">&#39;Has thought of relevance of PA&#39;</span> =<span class="st"> </span>PA_frqbct_06_T1,
<span class="st">&#39;Has made changes at home&#39;</span> =<span class="st"> </span>PA_frqbct_07_T1,
<span class="st">&#39;Has sought social support&#39;</span> =<span class="st"> </span>PA_frqbct_08_T1,
<span class="st">&#39;Has evaluated why goal not reached&#39;</span> =<span class="st"> </span>PA_frqbct_09_T1) <span class="op">%&gt;%</span>
<span class="st"> </span>tidyr<span class="op">::</span><span class="kw">gather</span>(<span class="dt">key =</span> Variable, <span class="dt">value =</span> Value, <span class="dv">6</span><span class="op">:</span><span class="kw">ncol</span>(.)) <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(intervention <span class="op">==</span><span class="st"> &quot;1&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st"> </span>ggplot2<span class="op">::</span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Value, <span class="dt">y =</span> Variable, <span class="dt">group =</span> Variable)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">geom_density_ridges2</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> Variable), <span class="dt">stat =</span> <span class="st">&quot;binline&quot;</span>, <span class="dt">binwidth =</span> <span class="dv">1</span>, <span class="dt">scale =</span> <span class="fl">0.95</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>), <span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>),
                     <span class="dt">name =</span> <span class="st">&quot;&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_discrete</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>), <span class="dt">name =</span> <span class="st">&quot;&quot;</span>, <span class="dt">labels =</span> <span class="ot">NULL</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_fill_cyclical</span>(<span class="dt">values =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">11</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">10</span><span class="op">:</span><span class="dv">11</span>]) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Intervention&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">guides</span>(<span class="dt">y =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">theme_ridges</span>(<span class="dt">grid =</span> <span class="ot">FALSE</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>),
        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>),
        <span class="dt">axis.text=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">10</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">6.5</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">12</span>))
## Warning: attributes are not identical across measure variables;
## they will be dropped

bctCont &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(id,
  intervention,
  group,
  school,
  girl,
<span class="st">&#39;Reminded self of positive consequences&#39;</span> =<span class="st"> </span>PA_frqbct_01_T1,
<span class="st">&#39;Has logged PA on paper&#39;</span> =<span class="st"> </span>PA_frqbct_02_T1,
<span class="st">&#39;Has monitored PA on smartphone&#39;</span> =<span class="st"> </span>PA_frqbct_03_T1,
<span class="st">&#39;Uses mnemonic cues&#39;</span> =<span class="st"> </span>PA_frqbct_04_T1,
<span class="st">&#39;Has compared actual with goal&#39;</span> =<span class="st"> </span>PA_frqbct_05_T1,
<span class="st">&#39;Has thought of relevance of PA&#39;</span> =<span class="st"> </span>PA_frqbct_06_T1,
<span class="st">&#39;Has made changes at home&#39;</span> =<span class="st"> </span>PA_frqbct_07_T1,
<span class="st">&#39;Has sought social support&#39;</span> =<span class="st"> </span>PA_frqbct_08_T1,
<span class="st">&#39;Has evaluated why goal not reached&#39;</span> =<span class="st"> </span>PA_frqbct_09_T1) <span class="op">%&gt;%</span>
<span class="st"> </span>tidyr<span class="op">::</span><span class="kw">gather</span>(<span class="dt">key =</span> Variable, <span class="dt">value =</span> Value, <span class="dv">6</span><span class="op">:</span><span class="kw">ncol</span>(.)) <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(intervention <span class="op">==</span><span class="st"> &quot;0&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st"> </span>ggplot2<span class="op">::</span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Value, <span class="dt">y =</span> Variable, <span class="dt">group =</span> Variable)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">geom_density_ridges2</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> Variable), <span class="dt">stat =</span> <span class="st">&quot;binline&quot;</span>, <span class="dt">binwidth =</span> <span class="dv">1</span>, <span class="dt">scale =</span> <span class="fl">0.95</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>), <span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>),
                     <span class="dt">name =</span> <span class="st">&quot;&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_discrete</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>), <span class="dt">name =</span> <span class="st">&quot;&quot;</span>, <span class="dt">labels =</span> <span class="ot">NULL</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_fill_cyclical</span>(<span class="dt">values =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">11</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">4</span><span class="op">:</span><span class="dv">5</span>]) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Control&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">guides</span>(<span class="dt">y =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">theme_ridges</span>(<span class="dt">grid =</span> <span class="ot">FALSE</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>),
        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>),
        <span class="dt">axis.text=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">10</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">6.5</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">12</span>))
## Warning: attributes are not identical across measure variables;
## they will be dropped

bctBoys <span class="op">+</span><span class="st"> </span>bctGirls <span class="op">+</span><span class="st"> </span>bctInt <span class="op">+</span><span class="st"> </span>bctCont <span class="op">+</span><span class="st"> </span><span class="kw">plot_layout</span>(<span class="dt">nrow =</span> <span class="dv">1</span>) 
## Warning: Removed 72 rows containing non-finite values (stat_binline).
## Warning: Removed 54 rows containing non-finite values (stat_binline).

## Warning: Removed 54 rows containing non-finite values (stat_binline).
## Warning: Removed 72 rows containing non-finite values (stat_binline).</code></pre></div>
<p><img src="baseline-supplement_files/figure-html/histogram-frqbcts-1.png" width="2100" /></p>
</div>
<div id="agreement-measured-bcts-1" class="section level4">
<h4>Agreement-measured BCTs</h4>
<p>These questions were asked with the lead “Have you done the following during the last three weeks?”.</p>
<p>The answer scale was as follows:</p>
<p>0 = not at all true 1 … 4 [unlabeled] 5 = completely true</p>
<p>Items are as follows:</p>
<ol style="list-style-type: decimal">
<li>I have set PA goals for myself.</li>
<li>I have personally made a specific plan (“what, where, how”) to implement my PA.</li>
<li>I have a PA plan, which has been made by someone else, e.g. my sports club (e.g. a workout schedule).</li>
<li>I have a way by which I remind myself of my PA plan, e.g. I write it down in the calendar.</li>
<li>I have cut larger PA goals to smaller subgoals.</li>
<li>I have tried out new ways for me to be physically active.</li>
<li>I have pondered, what kind of difficult situations or barriers prevent me from implementing my PA plan.</li>
<li>I have planned for ways to overcome barriers to doing PA.</li>
<li>I have thought about how PA fits my identity (self concept).</li>
<li>I have attempted to find ways to exercise so, that it won’t obstruct but instead helps actualise my other life values.</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
bctGirls &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(id,
  intervention,
  group,
  school,
  girl,
  <span class="st">&#39;Has set goals&#39;</span> =<span class="st"> </span>PA_agrbct_01_T1,
  <span class="st">&#39;Has made plan&#39;</span> =<span class="st"> </span>PA_agrbct_02_T1,
  <span class="st">&#39;Plan made by other&#39;</span> =<span class="st"> </span>PA_agrbct_03_T1,
  <span class="st">&#39;Has reminder of plan&#39;</span> =<span class="st"> </span>PA_agrbct_04_T1,
  <span class="st">&#39;Has cut goals to subgoals&#39;</span> =<span class="st"> </span>PA_agrbct_05_T1,
  <span class="st">&#39;Has tried new PA options&#39;</span> =<span class="st"> </span>PA_agrbct_06_T1,
  <span class="st">&#39;Has thought of barriers&#39;</span> =<span class="st"> </span>PA_agrbct_07_T1,
  <span class="st">&#39;Has planned for barriers&#39;</span> =<span class="st"> </span>PA_agrbct_08_T1,
  <span class="st">&#39;Has thought of PA identity&#39;</span> =<span class="st"> </span>PA_agrbct_09_T1,
  <span class="st">&#39;Has fitted PA to life values&#39;</span> =<span class="st"> </span>PA_agrbct_10_T1) <span class="op">%&gt;%</span>
<span class="st"> </span>tidyr<span class="op">::</span><span class="kw">gather</span>(<span class="dt">key =</span> Variable, <span class="dt">value =</span> Value, <span class="dv">6</span><span class="op">:</span><span class="kw">ncol</span>(.)) <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(girl <span class="op">==</span><span class="st"> &quot;girl&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st"> </span>ggplot2<span class="op">::</span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Value, <span class="dt">y =</span> Variable, <span class="dt">group =</span> Variable)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">geom_density_ridges2</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> Variable), <span class="dt">stat =</span> <span class="st">&quot;binline&quot;</span>, <span class="dt">binwidth =</span> <span class="dv">1</span>, <span class="dt">scale =</span> <span class="fl">0.95</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>), <span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>),
                     <span class="dt">name =</span> <span class="st">&quot;&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_discrete</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>), <span class="dt">name =</span> <span class="st">&quot;&quot;</span>, <span class="dt">labels =</span> <span class="ot">NULL</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_fill_cyclical</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;darkolivegreen2&quot;</span>, <span class="st">&quot;darkolivegreen4&quot;</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Girls&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">guides</span>(<span class="dt">y =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">theme_ridges</span>(<span class="dt">grid =</span> <span class="ot">FALSE</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>),
        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>),
        <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>),
        <span class="dt">axis.text=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">10</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">6.5</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">12</span>))
## Warning: attributes are not identical across measure variables;
## they will be dropped

bctBoys &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(id,
  intervention,
  group,
  school,
  girl,
  <span class="st">&#39;Has set goals&#39;</span> =<span class="st"> </span>PA_agrbct_01_T1,
  <span class="st">&#39;Has made plan&#39;</span> =<span class="st"> </span>PA_agrbct_02_T1,
  <span class="st">&#39;Plan made by other&#39;</span> =<span class="st"> </span>PA_agrbct_03_T1,
  <span class="st">&#39;Has reminder of plan&#39;</span> =<span class="st"> </span>PA_agrbct_04_T1,
  <span class="st">&#39;Has cut goals to subgoals&#39;</span> =<span class="st"> </span>PA_agrbct_05_T1,
  <span class="st">&#39;Has tried new PA options&#39;</span> =<span class="st"> </span>PA_agrbct_06_T1,
  <span class="st">&#39;Has thought of barriers&#39;</span> =<span class="st"> </span>PA_agrbct_07_T1,
  <span class="st">&#39;Has planned for barriers&#39;</span> =<span class="st"> </span>PA_agrbct_08_T1,
  <span class="st">&#39;Has thought of PA identity&#39;</span> =<span class="st"> </span>PA_agrbct_09_T1,
  <span class="st">&#39;Has fitted PA to life values&#39;</span> =<span class="st"> </span>PA_agrbct_10_T1) <span class="op">%&gt;%</span>
<span class="st">  </span>tidyr<span class="op">::</span><span class="kw">gather</span>(<span class="dt">key =</span> Variable, <span class="dt">value =</span> Value, <span class="dv">6</span><span class="op">:</span><span class="kw">ncol</span>(.)) <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(girl <span class="op">==</span><span class="st"> &quot;boy&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st"> </span>ggplot2<span class="op">::</span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Value, <span class="dt">y =</span> Variable, <span class="dt">group =</span> Variable)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">geom_density_ridges2</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> Variable), <span class="dt">stat =</span> <span class="st">&quot;binline&quot;</span>, <span class="dt">binwidth =</span> <span class="dv">1</span>, <span class="dt">scale =</span> <span class="fl">0.95</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>), <span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>),
                     <span class="dt">name =</span> <span class="st">&quot;&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_discrete</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>), <span class="dt">name =</span> <span class="st">&quot;&quot;</span>, <span class="dt">labels =</span> <span class="ot">NULL</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_fill_cyclical</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;darkolivegreen2&quot;</span>, <span class="st">&quot;darkolivegreen4&quot;</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Boys&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">guides</span>(<span class="dt">y =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">theme_ridges</span>(<span class="dt">grid =</span> <span class="ot">FALSE</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>),
        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>),
        <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>),
        <span class="dt">axis.text=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">10</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">6.5</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">12</span>))
## Warning: attributes are not identical across measure variables;
## they will be dropped

bctInt &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(id,
  intervention,
  group,
  school,
  girl,
  <span class="st">&#39;Has set goals&#39;</span> =<span class="st"> </span>PA_agrbct_01_T1,
  <span class="st">&#39;Has made plan&#39;</span> =<span class="st"> </span>PA_agrbct_02_T1,
  <span class="st">&#39;Plan made by other&#39;</span> =<span class="st"> </span>PA_agrbct_03_T1,
  <span class="st">&#39;Has reminder of plan&#39;</span> =<span class="st"> </span>PA_agrbct_04_T1,
  <span class="st">&#39;Has cut goals to subgoals&#39;</span> =<span class="st"> </span>PA_agrbct_05_T1,
  <span class="st">&#39;Has tried new PA options&#39;</span> =<span class="st"> </span>PA_agrbct_06_T1,
  <span class="st">&#39;Has thought of barriers&#39;</span> =<span class="st"> </span>PA_agrbct_07_T1,
  <span class="st">&#39;Has planned for barriers&#39;</span> =<span class="st"> </span>PA_agrbct_08_T1,
  <span class="st">&#39;Has thought of PA identity&#39;</span> =<span class="st"> </span>PA_agrbct_09_T1,
  <span class="st">&#39;Has fitted PA to life values&#39;</span> =<span class="st"> </span>PA_agrbct_10_T1) <span class="op">%&gt;%</span>
<span class="st"> </span>tidyr<span class="op">::</span><span class="kw">gather</span>(<span class="dt">key =</span> Variable, <span class="dt">value =</span> Value, <span class="dv">6</span><span class="op">:</span><span class="kw">ncol</span>(.)) <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(intervention <span class="op">==</span><span class="st"> &quot;1&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st"> </span>ggplot2<span class="op">::</span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Value, <span class="dt">y =</span> Variable, <span class="dt">group =</span> Variable)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">geom_density_ridges2</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> Variable), <span class="dt">stat =</span> <span class="st">&quot;binline&quot;</span>, <span class="dt">binwidth =</span> <span class="dv">1</span>, <span class="dt">scale =</span> <span class="fl">0.95</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>), <span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>),
                     <span class="dt">name =</span> <span class="st">&quot;&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_discrete</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>), <span class="dt">name =</span> <span class="st">&quot;&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_fill_cyclical</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;deepskyblue&quot;</span>, <span class="st">&quot;deepskyblue4&quot;</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Intervention&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">guides</span>(<span class="dt">y =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">theme_ridges</span>(<span class="dt">grid =</span> <span class="ot">FALSE</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>),
        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>),
        <span class="dt">axis.text=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">10</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">6.5</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">12</span>))
## Warning: attributes are not identical across measure variables;
## they will be dropped

bctCont &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(id,
  intervention,
  group,
  school,
  girl,
  <span class="st">&#39;Has set goals&#39;</span> =<span class="st"> </span>PA_agrbct_01_T1,
  <span class="st">&#39;Has made plan&#39;</span> =<span class="st"> </span>PA_agrbct_02_T1,
  <span class="st">&#39;Plan made by other&#39;</span> =<span class="st"> </span>PA_agrbct_03_T1,
  <span class="st">&#39;Has reminder of plan&#39;</span> =<span class="st"> </span>PA_agrbct_04_T1,
  <span class="st">&#39;Has cut goals to subgoals&#39;</span> =<span class="st"> </span>PA_agrbct_05_T1,
  <span class="st">&#39;Has tried new PA options&#39;</span> =<span class="st"> </span>PA_agrbct_06_T1,
  <span class="st">&#39;Has thought of barriers&#39;</span> =<span class="st"> </span>PA_agrbct_07_T1,
  <span class="st">&#39;Has planned for barriers&#39;</span> =<span class="st"> </span>PA_agrbct_08_T1,
  <span class="st">&#39;Has thought of PA identity&#39;</span> =<span class="st"> </span>PA_agrbct_09_T1,
  <span class="st">&#39;Has fitted PA to life values&#39;</span> =<span class="st"> </span>PA_agrbct_10_T1) <span class="op">%&gt;%</span>
<span class="st"> </span>tidyr<span class="op">::</span><span class="kw">gather</span>(<span class="dt">key =</span> Variable, <span class="dt">value =</span> Value, <span class="dv">6</span><span class="op">:</span><span class="kw">ncol</span>(.)) <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(intervention <span class="op">==</span><span class="st"> &quot;0&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st"> </span>ggplot2<span class="op">::</span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Value, <span class="dt">y =</span> Variable, <span class="dt">group =</span> Variable)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">geom_density_ridges2</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> Variable), <span class="dt">stat =</span> <span class="st">&quot;binline&quot;</span>, <span class="dt">binwidth =</span> <span class="dv">1</span>, <span class="dt">scale =</span> <span class="fl">0.95</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>), <span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>),
                     <span class="dt">name =</span> <span class="st">&quot;&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_discrete</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>), <span class="dt">name =</span> <span class="st">&quot;&quot;</span>, <span class="dt">labels =</span> <span class="ot">NULL</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_fill_cyclical</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;deepskyblue&quot;</span>, <span class="st">&quot;deepskyblue4&quot;</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Control&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">guides</span>(<span class="dt">y =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">theme_ridges</span>(<span class="dt">grid =</span> <span class="ot">FALSE</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>),
        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>),
        <span class="dt">axis.text=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">10</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">6.5</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">12</span>))
## Warning: attributes are not identical across measure variables;
## they will be dropped

bctInt <span class="op">+</span><span class="st"> </span>bctCont <span class="op">+</span><span class="st"> </span>bctGirls <span class="op">+</span><span class="st"> </span>bctBoys <span class="op">+</span><span class="st"> </span><span class="kw">plot_layout</span>(<span class="dt">nrow =</span> <span class="dv">1</span>) 
## Warning: Removed 60 rows containing non-finite values (stat_binline).
## Warning: Removed 70 rows containing non-finite values (stat_binline).
## Warning: Removed 60 rows containing non-finite values (stat_binline).
## Warning: Removed 70 rows containing non-finite values (stat_binline).</code></pre></div>
<p><img src="baseline-supplement_files/figure-html/histogram-agrbcts-1.png" width="2100" /></p>
</div>
</div>
<div id="bct-plot-without-fill" class="section level3">
<h3>BCT Plot without fill</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">plot1 &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(id,
                              intervention,
                              group,
                              school,
                              girl,
                              <span class="st">&#39;PA intention&#39;</span> =<span class="st"> </span>PA_intention_T1,
                              <span class="st">&#39;PA outcome</span><span class="ch">\n</span><span class="st">expectations&#39;</span> =<span class="st"> </span>PA_outcomeExpectations_T1,
                              <span class="st">&#39;PA perceived</span><span class="ch">\n</span><span class="st">behavioural control&#39;</span> =<span class="st"> </span>PA_pbc_T1,
                              <span class="st">&#39;PA self efficacy&#39;</span> =<span class="st"> </span>PA_selfefficacy_T1,
                              <span class="st">&#39;PA perceived</span><span class="ch">\n</span><span class="st">opportunities&#39;</span> =<span class="st"> </span>PA_opportunities_T1,
                              <span class="st">&#39;PA descriptive</span><span class="ch">\n</span><span class="st">norm&#39;</span> =<span class="st"> </span>PA_dnorm_T1,
                              <span class="st">&#39;PA injunctive</span><span class="ch">\n</span><span class="st">norm&#39;</span> =<span class="st"> </span>PA_inorm_T1)  <span class="op">%&gt;%</span>
<span class="st">  </span><span class="co"># dplyr::select(noquote(order(colnames(.)))) %&gt;% # Orders columns alphabetically</span>
<span class="st">  </span>tidyr<span class="op">::</span><span class="kw">gather</span>(<span class="dt">key =</span> Variable, <span class="dt">value =</span> Value, <span class="dv">6</span><span class="op">:</span><span class="kw">ncol</span>(.), <span class="dt">factor_key =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span>
<span class="st">  </span>ggplot2<span class="op">::</span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">y =</span> Variable)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">geom_density_ridges</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Value, <span class="dt">colour =</span> <span class="kw">paste</span>(Variable, girl), 
                                    <span class="dt">fill =</span> <span class="kw">paste</span>(Variable, girl)), 
                                    <span class="dt">alpha =</span> <span class="dv">0</span>, <span class="dt">size =</span> <span class="fl">0.75</span>, <span class="dt">from =</span> <span class="dv">1</span>, <span class="dt">to =</span> <span class="dv">7</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;&quot;</span>,
       <span class="dt">y =</span> <span class="st">&quot;&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_discrete</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_fill_cyclical</span>(<span class="dt">breaks =</span> <span class="kw">c</span>(<span class="st">&quot;PA injunctive</span><span class="ch">\n</span><span class="st">norm boy&quot;</span>, <span class="st">&quot;PA injunctive</span><span class="ch">\n</span><span class="st">norm girl&quot;</span>),
                                <span class="dt">labels =</span> <span class="kw">c</span>( <span class="st">&#39;PA injunctive</span><span class="ch">\n</span><span class="st">norm boy&#39;</span> =<span class="st"> &quot;Boy&quot;</span>, <span class="st">&#39;PA injunctive</span><span class="ch">\n</span><span class="st">norm girl&#39;</span> =<span class="st"> &quot;Girl&quot;</span>),
                                <span class="dt">values =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>)], <span class="co">#c(&quot;#3bc600&quot;, &quot;#0000ff&quot;, &quot;#9cc68b&quot;, &quot;#8080ff&quot;),</span>
                                <span class="dt">name =</span> <span class="st">&quot;&quot;</span>, <span class="dt">guide =</span> <span class="kw">guide_legend</span>(<span class="dt">override.aes =</span> <span class="kw">list</span>(<span class="dt">alpha =</span> <span class="dv">1</span>))) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_colour_cyclical</span>(<span class="dt">values =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>, <span class="dt">alpha =</span> <span class="fl">0.9</span>)[<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>)]) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">theme_ridges</span>(<span class="dt">grid =</span> <span class="ot">FALSE</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">&quot;bottom&quot;</span>, <span class="dt">axis.text=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">10</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">7</span>)
## Warning: attributes are not identical across measure variables;
## they will be dropped

target =<span class="st"> </span><span class="kw">c</span>(
<span class="st">&quot;PA_intention_T1&quot;</span>,
<span class="st">&quot;PA_outcomeExpectations_T1&quot;</span>,
<span class="st">&quot;PA_pbc_T1&quot;</span>,
<span class="st">&quot;PA_selfefficacy_T1&quot;</span>,
<span class="st">&quot;PA_opportunities_T1&quot;</span>,
<span class="st">&quot;PA_dnorm_T1&quot;</span>,
<span class="st">&quot;PA_inorm_T1&quot;</span>)

PA_ci_girls &lt;-<span class="st"> </span>ci_girls <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(diamondlabels <span class="op">%in%</span><span class="st"> </span><span class="kw">names</span>(scales_T1) <span class="op">&amp;</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_intention_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_outcomeExpectations_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_pbc_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_selfefficacy_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_opportunities_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_dnorm_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_inorm_T1&quot;</span>, diamondlabels))

PA_ci_girls &lt;-<span class="st"> </span>PA_ci_girls[<span class="kw">match</span>(target, PA_ci_girls<span class="op">$</span>diamondlabels), ]

PA_ci_boys &lt;-<span class="st"> </span>ci_boys <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(diamondlabels <span class="op">%in%</span><span class="st"> </span><span class="kw">names</span>(scales_T1) <span class="op">&amp;</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_intention_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_outcomeExpectations_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_pbc_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_selfefficacy_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_opportunities_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_dnorm_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_inorm_T1&quot;</span>, diamondlabels))

PA_ci_boys &lt;-<span class="st"> </span>PA_ci_boys[<span class="kw">match</span>(target, PA_ci_boys<span class="op">$</span>diamondlabels), ]

plot1 &lt;-<span class="st"> </span>plot1 <span class="op">+</span><span class="st"> </span>userfriendlyscience<span class="op">::</span><span class="kw">diamondPlot</span>(PA_ci_girls, <span class="dt">returnLayerOnly =</span> <span class="ot">TRUE</span>, <span class="dt">color=</span>viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">3</span>)], 
                <span class="dt">alpha=</span>.<span class="dv">6</span>, <span class="dt">fixedSize =</span> <span class="fl">0.15</span>, <span class="dt">otherAxisCol =</span> (<span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(target) <span class="op">+</span><span class="st"> </span>.<span class="dv">2</span>)) <span class="op">+</span>
<span class="st">  </span>userfriendlyscience<span class="op">::</span><span class="kw">diamondPlot</span>(PA_ci_boys, <span class="dt">returnLayerOnly =</span> <span class="ot">TRUE</span>, <span class="dt">color=</span>viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">1</span>)],  
                <span class="dt">alpha=</span>.<span class="dv">6</span>, <span class="dt">fixedSize =</span> <span class="fl">0.15</span>, <span class="dt">otherAxisCol =</span> (<span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(target) <span class="op">+</span><span class="st"> </span>.<span class="dv">2</span>))

plot2 &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(id,
                              intervention,
                              group,
                              school,
                              girl,
                              <span class="st">&#39;PA intention&#39;</span> =<span class="st"> </span>PA_intention_T1,
                              <span class="st">&#39;PA outcome</span><span class="ch">\n</span><span class="st">expectations&#39;</span> =<span class="st"> </span>PA_outcomeExpectations_T1,
                              <span class="st">&#39;PA perceived</span><span class="ch">\n</span><span class="st">behavioural control&#39;</span> =<span class="st"> </span>PA_pbc_T1,
                              <span class="st">&#39;PA self efficacy&#39;</span> =<span class="st"> </span>PA_selfefficacy_T1,
                              <span class="st">&#39;PA perceived</span><span class="ch">\n</span><span class="st">opportunities&#39;</span> =<span class="st"> </span>PA_opportunities_T1,
                              <span class="st">&#39;PA descriptive</span><span class="ch">\n</span><span class="st">norm&#39;</span> =<span class="st"> </span>PA_dnorm_T1,
                              <span class="st">&#39;PA injunctive</span><span class="ch">\n</span><span class="st">norm&#39;</span> =<span class="st"> </span>PA_inorm_T1)  <span class="op">%&gt;%</span>
<span class="st">  </span><span class="co"># dplyr::select(noquote(order(colnames(.)))) %&gt;% # Orders columns alphabetically</span>
<span class="st">  </span>tidyr<span class="op">::</span><span class="kw">gather</span>(<span class="dt">key =</span> Variable, <span class="dt">value =</span> Value, <span class="dv">6</span><span class="op">:</span><span class="kw">ncol</span>(.), <span class="dt">factor_key =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span>
<span class="st">  </span>ggplot2<span class="op">::</span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">y =</span> Variable)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">geom_density_ridges</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Value, <span class="dt">colour =</span> <span class="kw">paste</span>(Variable, intervention), 
                                    <span class="dt">fill =</span> <span class="kw">paste</span>(Variable, intervention)), 
                                    <span class="dt">alpha =</span> <span class="dv">0</span>, <span class="dt">size =</span> <span class="fl">0.75</span>, <span class="dt">from =</span> <span class="dv">1</span>, <span class="dt">to =</span> <span class="dv">7</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;&quot;</span>,
       <span class="dt">y =</span> <span class="st">&quot;&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_discrete</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>), <span class="dt">labels =</span> <span class="ot">NULL</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_fill_cyclical</span>(<span class="dt">breaks =</span> <span class="kw">c</span>(<span class="st">&quot;PA injunctive</span><span class="ch">\n</span><span class="st">norm 0&quot;</span>, <span class="st">&quot;PA injunctive</span><span class="ch">\n</span><span class="st">norm 1&quot;</span>),
                                <span class="dt">labels =</span> <span class="kw">c</span>( <span class="st">&#39;PA injunctive</span><span class="ch">\n</span><span class="st">norm 0&#39;</span> =<span class="st"> &quot;Control&quot;</span>, <span class="st">&#39;PA injunctive</span><span class="ch">\n</span><span class="st">norm 1&#39;</span> =<span class="st"> &quot;Intervention&quot;</span>),
                                <span class="dt">values =</span> <span class="kw">c</span>(viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">4</span>)], viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">8</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">8</span>)]), <span class="co"># get 2 x 2 colors, close to each other</span>
                                <span class="dt">name =</span> <span class="st">&quot;&quot;</span>, <span class="dt">guide =</span> <span class="kw">guide_legend</span>(<span class="dt">override.aes =</span> <span class="kw">list</span>(<span class="dt">alpha =</span> <span class="dv">1</span>))) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_colour_cyclical</span>(<span class="dt">values =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>, <span class="dt">alpha =</span> <span class="fl">0.9</span>)[<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">4</span>)]) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">theme_ridges</span>(<span class="dt">grid =</span> <span class="ot">FALSE</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">&quot;bottom&quot;</span>, <span class="dt">axis.text=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">10</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">7</span>)
## Warning: attributes are not identical across measure variables;
## they will be dropped

PA_ci_intervention &lt;-<span class="st"> </span>ci_intervention <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(diamondlabels <span class="op">%in%</span><span class="st"> </span><span class="kw">names</span>(scales_T1) <span class="op">&amp;</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_intention_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_outcomeExpectations_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_pbc_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_selfefficacy_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_opportunities_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_dnorm_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_inorm_T1&quot;</span>, diamondlabels))

PA_ci_intervention &lt;-<span class="st"> </span>PA_ci_intervention[<span class="kw">match</span>(target, PA_ci_intervention<span class="op">$</span>diamondlabels), ]

PA_ci_control &lt;-<span class="st"> </span>ci_control <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(diamondlabels <span class="op">%in%</span><span class="st"> </span><span class="kw">names</span>(scales_T1) <span class="op">&amp;</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_intention_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_outcomeExpectations_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_pbc_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_selfefficacy_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_opportunities_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_dnorm_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_inorm_T1&quot;</span>, diamondlabels))

PA_ci_control &lt;-<span class="st"> </span>PA_ci_control[<span class="kw">match</span>(target, PA_ci_control<span class="op">$</span>diamondlabels), ]

plot2 &lt;-<span class="st"> </span>plot2 <span class="op">+</span><span class="st"> </span>
<span class="st">  </span>userfriendlyscience<span class="op">::</span><span class="kw">diamondPlot</span>(PA_ci_intervention, <span class="dt">returnLayerOnly =</span> <span class="ot">TRUE</span>, <span class="dt">color=</span>viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">4</span>)],
              <span class="dt">alpha=</span>.<span class="dv">6</span>, <span class="dt">fixedSize =</span> <span class="fl">0.15</span>, <span class="dt">otherAxisCol =</span> (<span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(target) <span class="op">+</span><span class="st"> </span>.<span class="dv">2</span>)) <span class="op">+</span>
<span class="st">  </span>userfriendlyscience<span class="op">::</span><span class="kw">diamondPlot</span>(PA_ci_control, <span class="dt">returnLayerOnly =</span> <span class="ot">TRUE</span>, <span class="dt">color=</span>viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">2</span>)], 
              <span class="dt">alpha=</span>.<span class="dv">6</span>, <span class="dt">fixedSize =</span> <span class="fl">0.15</span>, <span class="dt">otherAxisCol =</span> (<span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(target) <span class="op">+</span><span class="st"> </span>.<span class="dv">2</span>))

plot1 <span class="op">+</span><span class="st"> </span>plot2
## Picking joint bandwidth of 0.355
## Warning: Removed 641 rows containing non-finite values
## (stat_density_ridges).
## Picking joint bandwidth of 0.359
## Warning: Removed 641 rows containing non-finite values
## (stat_density_ridges).</code></pre></div>
<p><img src="baseline-supplement_files/figure-html/bct-determinants-nofill-1.png" width="2100" /></p>
</div>
</div>
<div id="pa-psychosocial-mediators" class="section level2">
<h2>PA psychosocial mediators</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
plot1 &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(id,
                              intervention,
                              group,
                              school,
                              girl,
                              <span class="st">&#39;PA intention&#39;</span> =<span class="st"> </span>PA_intention_T1,
                              <span class="st">&#39;PA outcome</span><span class="ch">\n</span><span class="st">expectations&#39;</span> =<span class="st"> </span>PA_outcomeExpectations_T1,
                              <span class="st">&#39;PA perceived</span><span class="ch">\n</span><span class="st">behavioural control&#39;</span> =<span class="st"> </span>PA_pbc_T1,
                              <span class="st">&#39;PA self efficacy&#39;</span> =<span class="st"> </span>PA_selfefficacy_T1,
                              <span class="st">&#39;PA perceived</span><span class="ch">\n</span><span class="st">opportunities&#39;</span> =<span class="st"> </span>PA_opportunities_T1,
                              <span class="st">&#39;PA descriptive</span><span class="ch">\n</span><span class="st">norm&#39;</span> =<span class="st"> </span>PA_dnorm_T1)  <span class="op">%&gt;%</span>
<span class="st">  </span><span class="co"># dplyr::select(noquote(order(colnames(.)))) %&gt;% # Orders columns alphabetically</span>
<span class="st">  </span>tidyr<span class="op">::</span><span class="kw">gather</span>(<span class="dt">key =</span> Variable, <span class="dt">value =</span> Value, <span class="dv">6</span><span class="op">:</span><span class="kw">ncol</span>(.), <span class="dt">factor_key =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span>
<span class="st">  </span>ggplot2<span class="op">::</span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">y =</span> Variable)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">geom_density_ridges</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Value, <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>, 
                                    <span class="dt">fill =</span> <span class="kw">paste</span>(Variable, girl)), 
                                    <span class="dt">alpha =</span> <span class="fl">0.6</span>, <span class="dt">size =</span> <span class="fl">0.25</span>, 
                                    <span class="dt">from =</span> <span class="dv">1</span>, <span class="dt">to =</span> <span class="dv">7</span>, <span class="dt">scale =</span> <span class="dv">1</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;&quot;</span>,
       <span class="dt">y =</span> <span class="st">&quot;&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_discrete</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_fill_cyclical</span>(<span class="dt">breaks =</span> <span class="kw">c</span>(<span class="st">&quot;PA descriptive</span><span class="ch">\n</span><span class="st">norm boy&quot;</span>, <span class="st">&quot;PA descriptive</span><span class="ch">\n</span><span class="st">norm girl&quot;</span>),
                                <span class="dt">labels =</span> <span class="kw">c</span>( <span class="st">&#39;PA descriptive</span><span class="ch">\n</span><span class="st">norm boy&#39;</span> =<span class="st"> &quot;Boy&quot;</span>, <span class="st">&#39;PA descriptive</span><span class="ch">\n</span><span class="st">norm girl&#39;</span> =<span class="st"> &quot;Girl&quot;</span>),
                                <span class="dt">values =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>)],
                                <span class="dt">name =</span> <span class="st">&quot;&quot;</span>, <span class="dt">guide =</span> <span class="kw">guide_legend</span>(<span class="dt">override.aes =</span> <span class="kw">list</span>(<span class="dt">alpha =</span> <span class="dv">1</span>))) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_colour_cyclical</span>(<span class="dt">values =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">theme_ridges</span>(<span class="dt">grid =</span> <span class="ot">FALSE</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">&quot;bottom&quot;</span>, <span class="dt">axis.text=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">10</span>))

target =<span class="st"> </span><span class="kw">c</span>(
<span class="st">&quot;PA_intention_T1&quot;</span>,
<span class="st">&quot;PA_outcomeExpectations_T1&quot;</span>,
<span class="st">&quot;PA_pbc_T1&quot;</span>,
<span class="st">&quot;PA_selfefficacy_T1&quot;</span>,
<span class="st">&quot;PA_opportunities_T1&quot;</span>,
<span class="st">&quot;PA_dnorm_T1&quot;</span>)

PA_ci_girls &lt;-<span class="st"> </span>ci_girls <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(diamondlabels <span class="op">%in%</span><span class="st"> </span><span class="kw">names</span>(scales_T1) <span class="op">&amp;</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_intention_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_outcomeExpectations_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_pbc_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_selfefficacy_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_opportunities_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_dnorm_T1&quot;</span>, diamondlabels))

PA_ci_girls &lt;-<span class="st"> </span>PA_ci_girls[<span class="kw">match</span>(target, PA_ci_girls<span class="op">$</span>diamondlabels), ]

PA_ci_boys &lt;-<span class="st"> </span>ci_boys <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(diamondlabels <span class="op">%in%</span><span class="st"> </span><span class="kw">names</span>(scales_T1) <span class="op">&amp;</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_intention_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_outcomeExpectations_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_pbc_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_selfefficacy_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_opportunities_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_dnorm_T1&quot;</span>, diamondlabels))

PA_ci_boys &lt;-<span class="st"> </span>PA_ci_boys[<span class="kw">match</span>(target, PA_ci_boys<span class="op">$</span>diamondlabels), ]

plot1 &lt;-<span class="st"> </span>plot1 <span class="op">+</span><span class="st"> </span>userfriendlyscience<span class="op">::</span><span class="kw">diamondPlot</span>(PA_ci_girls, <span class="dt">returnLayerOnly =</span> <span class="ot">TRUE</span>, <span class="dt">lineColor =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">color=</span>viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">3</span>], 
                <span class="dt">alpha=</span>.<span class="dv">6</span>, <span class="dt">fixedSize =</span> <span class="fl">0.15</span>, <span class="dt">otherAxisCol =</span> (<span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(target) <span class="op">+</span><span class="st"> </span>.<span class="dv">2</span>)) <span class="op">+</span>
<span class="st">  </span>userfriendlyscience<span class="op">::</span><span class="kw">diamondPlot</span>(PA_ci_boys, <span class="dt">returnLayerOnly =</span> <span class="ot">TRUE</span>, <span class="dt">lineColor =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">linetype =</span> <span class="st">&quot;solid&quot;</span>, <span class="dt">color=</span>viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">1</span>],  
                <span class="dt">alpha=</span>.<span class="dv">6</span>, <span class="dt">fixedSize =</span> <span class="fl">0.15</span>, <span class="dt">otherAxisCol =</span> (<span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(target) <span class="op">+</span><span class="st"> </span>.<span class="dv">2</span>))

plot2 &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(id,
                              intervention,
                              group,
                              school,
                              girl,
                              <span class="st">&#39;PA intention&#39;</span> =<span class="st"> </span>PA_intention_T1,
                              <span class="st">&#39;PA outcome</span><span class="ch">\n</span><span class="st">expectations&#39;</span> =<span class="st"> </span>PA_outcomeExpectations_T1,
                              <span class="st">&#39;PA perceived</span><span class="ch">\n</span><span class="st">behavioural control&#39;</span> =<span class="st"> </span>PA_pbc_T1,
                              <span class="st">&#39;PA self efficacy&#39;</span> =<span class="st"> </span>PA_selfefficacy_T1,
                              <span class="st">&#39;PA perceived</span><span class="ch">\n</span><span class="st">opportunities&#39;</span> =<span class="st"> </span>PA_opportunities_T1,
                              <span class="st">&#39;PA descriptive</span><span class="ch">\n</span><span class="st">norm&#39;</span> =<span class="st"> </span>PA_dnorm_T1)  <span class="op">%&gt;%</span>
<span class="st">  </span><span class="co"># dplyr::select(noquote(order(colnames(.)))) %&gt;% # Orders columns alphabetically</span>
<span class="st">  </span>tidyr<span class="op">::</span><span class="kw">gather</span>(<span class="dt">key =</span> Variable, <span class="dt">value =</span> Value, <span class="dv">6</span><span class="op">:</span><span class="kw">ncol</span>(.), <span class="dt">factor_key =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span>
<span class="st">  </span>ggplot2<span class="op">::</span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">y =</span> Variable)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">geom_density_ridges</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Value, <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>, 
                                    <span class="dt">fill =</span> <span class="kw">paste</span>(Variable, intervention)), 
                                    <span class="dt">alpha =</span> <span class="fl">0.75</span>, <span class="dt">size =</span> <span class="fl">0.25</span>, <span class="dt">from =</span> <span class="dv">1</span>, <span class="dt">to =</span> <span class="dv">7</span>, <span class="dt">scale =</span> <span class="dv">1</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;&quot;</span>,
       <span class="dt">y =</span> <span class="st">&quot;&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_discrete</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>), <span class="dt">labels =</span> <span class="ot">NULL</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_fill_cyclical</span>(<span class="dt">breaks =</span> <span class="kw">c</span>(<span class="st">&quot;PA descriptive</span><span class="ch">\n</span><span class="st">norm 0&quot;</span>, <span class="st">&quot;PA descriptive</span><span class="ch">\n</span><span class="st">norm 1&quot;</span>),
                                <span class="dt">labels =</span> <span class="kw">c</span>( <span class="st">&#39;PA descriptive</span><span class="ch">\n</span><span class="st">norm 0&#39;</span> =<span class="st"> &quot;Control&quot;</span>, <span class="st">&#39;PA descriptive</span><span class="ch">\n</span><span class="st">norm 1&#39;</span> =<span class="st"> &quot;Intervention&quot;</span>),
                                <span class="dt">values =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">4</span>)],
                                <span class="dt">name =</span> <span class="st">&quot;&quot;</span>, <span class="dt">guide =</span> <span class="kw">guide_legend</span>(<span class="dt">override.aes =</span> <span class="kw">list</span>(<span class="dt">alpha =</span> <span class="dv">1</span>))) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_colour_cyclical</span>(<span class="dt">values =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">theme_ridges</span>(<span class="dt">grid =</span> <span class="ot">FALSE</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">&quot;bottom&quot;</span>, <span class="dt">axis.text=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">10</span>))

PA_ci_intervention &lt;-<span class="st"> </span>ci_intervention <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(diamondlabels <span class="op">%in%</span><span class="st"> </span><span class="kw">names</span>(scales_T1) <span class="op">&amp;</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_intention_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_outcomeExpectations_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_pbc_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_selfefficacy_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_opportunities_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_dnorm_T1&quot;</span>, diamondlabels))

PA_ci_intervention &lt;-<span class="st"> </span>PA_ci_intervention[<span class="kw">match</span>(target, PA_ci_intervention<span class="op">$</span>diamondlabels), ]

PA_ci_control &lt;-<span class="st"> </span>ci_control <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(diamondlabels <span class="op">%in%</span><span class="st"> </span><span class="kw">names</span>(scales_T1) <span class="op">&amp;</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_intention_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_outcomeExpectations_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_pbc_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_selfefficacy_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_opportunities_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_dnorm_T1&quot;</span>, diamondlabels))

PA_ci_control &lt;-<span class="st"> </span>PA_ci_control[<span class="kw">match</span>(target, PA_ci_control<span class="op">$</span>diamondlabels), ]

plot2 &lt;-<span class="st"> </span>plot2 <span class="op">+</span><span class="st"> </span>
<span class="st">  </span>userfriendlyscience<span class="op">::</span><span class="kw">diamondPlot</span>(PA_ci_intervention, <span class="dt">returnLayerOnly =</span> <span class="ot">TRUE</span>, <span class="dt">lineColor =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">color=</span>viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">4</span>],
              <span class="dt">alpha=</span>.<span class="dv">6</span>, <span class="dt">fixedSize =</span> <span class="fl">0.15</span>, <span class="dt">otherAxisCol =</span> (<span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(target) <span class="op">+</span><span class="st"> </span>.<span class="dv">2</span>)) <span class="op">+</span>
<span class="st">  </span>userfriendlyscience<span class="op">::</span><span class="kw">diamondPlot</span>(PA_ci_control, <span class="dt">returnLayerOnly =</span> <span class="ot">TRUE</span>, <span class="dt">lineColor =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">color=</span>viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">2</span>], 
              <span class="dt">alpha=</span>.<span class="dv">6</span>, <span class="dt">fixedSize =</span> <span class="fl">0.15</span>, <span class="dt">otherAxisCol =</span> (<span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(target) <span class="op">+</span><span class="st"> </span>.<span class="dv">2</span>))

plot1 <span class="op">+</span><span class="st"> </span>plot2 
## Picking joint bandwidth of 0.327
## Warning: Removed 549 rows containing non-finite values
## (stat_density_ridges).
## Picking joint bandwidth of 0.332
## Warning: Removed 549 rows containing non-finite values
## (stat_density_ridges).</code></pre></div>
<p><img src="baseline-supplement_files/figure-html/densityplot-intention-oexp-pbc-se-opp-norms-1.png" width="2100" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># Test that the legend is right; descriptive norms are smaller for girls</span>
df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(girl) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarise</span>(<span class="dt">mean =</span> <span class="kw">mean</span>(PA_dnorm_T1, <span class="dt">na.rm =</span> T)) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(girl <span class="op">==</span><span class="st"> &quot;girl&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(mean) <span class="op">&lt;</span><span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(girl) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarise</span>(<span class="dt">mean =</span> <span class="kw">mean</span>(PA_dnorm_T1, <span class="dt">na.rm =</span> T)) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(girl <span class="op">==</span><span class="st"> &quot;boy&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(mean)
##      mean
## [1,] TRUE

df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(intervention) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarise</span>(<span class="dt">mean =</span> <span class="kw">mean</span>(PA_dnorm_T1, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(intervention <span class="op">==</span><span class="st"> &quot;1&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(mean) <span class="op">&lt;</span><span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(intervention) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarise</span>(<span class="dt">mean =</span> <span class="kw">mean</span>(PA_dnorm_T1, <span class="dt">na.rm =</span> T)) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(intervention <span class="op">==</span><span class="st"> &quot;0&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(mean)
##      mean
## [1,] TRUE</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
plot1 &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(id,
  intervention,
  group,
  school,
  girl,
<span class="st">&#39;PA action and</span><span class="ch">\n</span><span class="st">coping planning&#39;</span> =<span class="st"> </span>PA_actCop_T1,
<span class="st">&#39;PA intention&#39;</span> =<span class="st"> </span>PA_intention_T1,
<span class="st">&#39;PA outcome</span><span class="ch">\n</span><span class="st">expectations&#39;</span> =<span class="st"> </span>PA_outcomeExpectations_T1,
<span class="st">&#39;PA perceived</span><span class="ch">\n</span><span class="st">behavioural control&#39;</span> =<span class="st"> </span>PA_pbc_T1,
<span class="st">&#39;PA self efficacy&#39;</span> =<span class="st"> </span>PA_selfefficacy_T1,
<span class="st">&#39;PA perceived</span><span class="ch">\n</span><span class="st">opportunities&#39;</span> =<span class="st"> </span>PA_opportunities_T1,
<span class="st">&#39;PA descriptive</span><span class="ch">\n</span><span class="st">norm&#39;</span> =<span class="st"> </span>PA_dnorm_T1,
<span class="st">&#39;PA injunctive</span><span class="ch">\n</span><span class="st">norm&#39;</span> =<span class="st"> </span>PA_inorm_T1)  <span class="op">%&gt;%</span>
<span class="st">  </span><span class="co"># dplyr::select(noquote(order(colnames(.)))) %&gt;% # Orders columns alphabetically</span>
<span class="st">  </span>tidyr<span class="op">::</span><span class="kw">gather</span>(<span class="dt">key =</span> Variable, <span class="dt">value =</span> Value, <span class="dv">6</span><span class="op">:</span><span class="kw">ncol</span>(.), <span class="dt">factor_key =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>ggplot2<span class="op">::</span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">y =</span> Variable)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">geom_density_ridges</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Value,
                                    <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>,
                                    <span class="dt">fill =</span> <span class="kw">paste</span>(Variable, girl),
                                    <span class="dt">point_color =</span> girl,
                                    <span class="dt">point_fill =</span> girl,
                                    <span class="dt">point_shape =</span> girl,
                                    <span class="dt">point_size =</span> girl,
                                    <span class="dt">point_alpha =</span> girl),
                                <span class="dt">scale =</span> .<span class="dv">5</span>, <span class="dt">alpha =</span> .<span class="dv">6</span>, <span class="dt">size =</span> <span class="fl">0.25</span>,
                                <span class="dt">from =</span> <span class="dv">1</span>, <span class="dt">to =</span> <span class="dv">7</span>,
                                <span class="dt">position =</span> <span class="kw">position_raincloud</span>(<span class="dt">width =</span> <span class="fl">0.03</span>, <span class="dt">height =</span> <span class="fl">0.5</span>),
                                <span class="dt">jittered_points =</span> <span class="ot">TRUE</span>,
                                <span class="dt">point_size =</span> <span class="dv">1</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="ot">NULL</span>,
       <span class="dt">y =</span> <span class="ot">NULL</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_discrete</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_fill_cyclical</span>(
                      <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&#39;PA action and</span><span class="ch">\n</span><span class="st">coping planning boy&#39;</span> =<span class="st"> &quot;Boy&quot;</span>, <span class="st">&#39;PA action and</span><span class="ch">\n</span><span class="st">coping planning girl&#39;</span> =<span class="st"> &quot;Girl&quot;</span>),
                      <span class="dt">values =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>)],
                      <span class="dt">name =</span> <span class="st">&quot;&quot;</span>, 
                      <span class="dt">guide =</span> <span class="kw">guide_legend</span>(<span class="dt">override.aes =</span> <span class="kw">list</span>(<span class="dt">alpha =</span> <span class="dv">1</span>, 
                                                               <span class="dt">point_shape =</span> <span class="kw">c</span>(<span class="dv">24</span>, <span class="dv">25</span>),
                                                               <span class="dt">point_size =</span> <span class="dv">2</span>))) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_colour_cyclical</span>(<span class="dt">values =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">theme_ridges</span>(<span class="dt">grid =</span> <span class="ot">FALSE</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_discrete_manual</span>(<span class="dt">aesthetics =</span> <span class="st">&quot;point_color&quot;</span>, 
                                  <span class="dt">values =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>)],
                                  <span class="dt">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_discrete_manual</span>(<span class="dt">aesthetics =</span> <span class="st">&quot;point_fill&quot;</span>,
                                  <span class="dt">values =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>)],
                                  <span class="dt">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_discrete_manual</span>(<span class="dt">aesthetics =</span> <span class="st">&quot;point_shape&quot;</span>, 
                                  <span class="dt">values =</span> <span class="kw">c</span>(<span class="dv">24</span>, <span class="dv">25</span>),
                                  <span class="dt">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_discrete_manual</span>(<span class="dt">aesthetics =</span> <span class="st">&quot;point_size&quot;</span>, 
                                  <span class="dt">values =</span> <span class="kw">c</span>(.<span class="dv">75</span>, .<span class="dv">75</span>),
                                  <span class="dt">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_discrete_manual</span>(<span class="dt">aesthetics =</span> <span class="st">&quot;point_alpha&quot;</span>, 
                                  <span class="dt">values =</span> <span class="kw">c</span>(<span class="fl">0.1</span>, <span class="fl">0.1</span>),
                                  <span class="dt">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>papaja<span class="op">::</span><span class="kw">theme_apa</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)
## Warning: attributes are not identical across measure variables;
## they will be dropped

plot2 &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(id,
  intervention,
  group,
  school,
  girl,
<span class="st">&#39;PA action and</span><span class="ch">\n</span><span class="st">coping planning&#39;</span> =<span class="st"> </span>PA_actCop_T1,
<span class="st">&#39;PA intention&#39;</span> =<span class="st"> </span>PA_intention_T1,
<span class="st">&#39;PA outcome</span><span class="ch">\n</span><span class="st">expectations&#39;</span> =<span class="st"> </span>PA_outcomeExpectations_T1,
<span class="st">&#39;PA perceived</span><span class="ch">\n</span><span class="st">behavioural control&#39;</span> =<span class="st"> </span>PA_pbc_T1,
<span class="st">&#39;PA self efficacy&#39;</span> =<span class="st"> </span>PA_selfefficacy_T1,
<span class="st">&#39;PA perceived</span><span class="ch">\n</span><span class="st">opportunities&#39;</span> =<span class="st"> </span>PA_opportunities_T1,
<span class="st">&#39;PA descriptive</span><span class="ch">\n</span><span class="st">norm&#39;</span> =<span class="st"> </span>PA_dnorm_T1,
<span class="st">&#39;PA injunctive</span><span class="ch">\n</span><span class="st">norm&#39;</span> =<span class="st"> </span>PA_inorm_T1) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="co"># dplyr::select(noquote(order(colnames(.)))) %&gt;% # Orders columns alphabetically</span>
<span class="st">  </span>tidyr<span class="op">::</span><span class="kw">gather</span>(<span class="dt">key =</span> Variable, <span class="dt">value =</span> Value, <span class="dv">6</span><span class="op">:</span><span class="kw">ncol</span>(.), <span class="dt">factor_key =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>ggplot2<span class="op">::</span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">y =</span> Variable)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">geom_density_ridges</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Value,
                                    <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>,
                                    <span class="dt">fill =</span> <span class="kw">paste</span>(Variable, intervention),
                                    <span class="dt">point_color =</span> intervention,
                                    <span class="dt">point_fill =</span> intervention,
                                    <span class="dt">point_shape =</span> intervention,
                                    <span class="dt">point_size =</span> intervention,
                                    <span class="dt">point_alpha =</span> intervention),
                                <span class="dt">scale =</span> .<span class="dv">5</span>, <span class="dt">alpha =</span> .<span class="dv">6</span>, <span class="dt">size =</span> <span class="fl">0.25</span>,
                                <span class="dt">from =</span> <span class="dv">1</span>, <span class="dt">to =</span> <span class="dv">7</span>,
                                <span class="dt">position =</span> <span class="kw">position_raincloud</span>(<span class="dt">width =</span> <span class="fl">0.03</span>, <span class="dt">height =</span> <span class="fl">0.5</span>),
                                <span class="dt">jittered_points =</span> <span class="ot">TRUE</span>,
                                <span class="dt">point_size =</span> <span class="dv">1</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="ot">NULL</span>,
       <span class="dt">y =</span> <span class="ot">NULL</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_discrete</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>), <span class="dt">labels =</span> <span class="ot">NULL</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_fill_cyclical</span>(
                      <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&#39;PA action and</span><span class="ch">\n</span><span class="st">coping planning 0&#39;</span> =<span class="st"> &quot;Control&quot;</span>, <span class="st">&#39;PA action and</span><span class="ch">\n</span><span class="st">coping planning 1&#39;</span> =<span class="st"> &quot;intervention&quot;</span>),
                      <span class="dt">values =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">4</span>)],
                      <span class="dt">name =</span> <span class="st">&quot;&quot;</span>, 
                      <span class="dt">guide =</span> <span class="kw">guide_legend</span>(<span class="dt">override.aes =</span> <span class="kw">list</span>(<span class="dt">alpha =</span> <span class="dv">1</span>, 
                                                               <span class="dt">point_shape =</span> <span class="kw">c</span>(<span class="dv">21</span>, <span class="dv">22</span>),
                                                               <span class="dt">point_size =</span> <span class="dv">2</span>))) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_colour_cyclical</span>(<span class="dt">values =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">theme_ridges</span>(<span class="dt">grid =</span> <span class="ot">FALSE</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_discrete_manual</span>(<span class="dt">aesthetics =</span> <span class="st">&quot;point_color&quot;</span>, 
                                  <span class="dt">values =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">4</span>)],
                                  <span class="dt">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_discrete_manual</span>(<span class="dt">aesthetics =</span> <span class="st">&quot;point_fill&quot;</span>,
                                  <span class="dt">values =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">4</span>)],
                                  <span class="dt">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_discrete_manual</span>(<span class="dt">aesthetics =</span> <span class="st">&quot;point_shape&quot;</span>, 
                                  <span class="dt">values =</span> <span class="kw">c</span>(<span class="dv">21</span>, <span class="dv">22</span>),
                                  <span class="dt">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_discrete_manual</span>(<span class="dt">aesthetics =</span> <span class="st">&quot;point_size&quot;</span>, 
                                  <span class="dt">values =</span> <span class="kw">c</span>(.<span class="dv">75</span>, .<span class="dv">75</span>),
                                  <span class="dt">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_discrete_manual</span>(<span class="dt">aesthetics =</span> <span class="st">&quot;point_alpha&quot;</span>, 
                                  <span class="dt">values =</span> <span class="kw">c</span>(<span class="fl">0.1</span>, <span class="fl">0.1</span>),
                                  <span class="dt">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>papaja<span class="op">::</span><span class="kw">theme_apa</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)
## Warning: attributes are not identical across measure variables;
## they will be dropped

target =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;PA_actCop_T1&quot;</span>,
<span class="st">&quot;PA_intention_T1&quot;</span>,
<span class="st">&quot;PA_outcomeExpectations_T1&quot;</span>,
<span class="st">&quot;PA_pbc_T1&quot;</span>,
<span class="st">&quot;PA_selfefficacy_T1&quot;</span>,
<span class="st">&quot;PA_opportunities_T1&quot;</span>,
<span class="st">&quot;PA_dnorm_T1&quot;</span>,
<span class="st">&quot;PA_inorm_T1&quot;</span>)

PA_ci_girls &lt;-<span class="st"> </span>ci_girls <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(diamondlabels <span class="op">%in%</span><span class="st"> </span><span class="kw">names</span>(scales_T1) <span class="op">&amp;</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_actCop_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_intention_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_outcomeExpectations_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_pbc_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_selfefficacy_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_opportunities_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_dnorm_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_inorm_T1&quot;</span>, diamondlabels))

PA_ci_girls &lt;-<span class="st"> </span>PA_ci_girls[<span class="kw">match</span>(target, PA_ci_girls<span class="op">$</span>diamondlabels), ]

PA_ci_boys &lt;-<span class="st"> </span>ci_boys <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(diamondlabels <span class="op">%in%</span><span class="st"> </span><span class="kw">names</span>(scales_T1) <span class="op">&amp;</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_actCop_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_intention_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_outcomeExpectations_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_pbc_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_selfefficacy_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_opportunities_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_dnorm_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_inorm_T1&quot;</span>, diamondlabels))

PA_ci_boys &lt;-<span class="st"> </span>PA_ci_boys[<span class="kw">match</span>(target, PA_ci_boys<span class="op">$</span>diamondlabels), ]

plot1 &lt;-<span class="st"> </span>plot1 <span class="op">+</span><span class="st"> </span>
<span class="st">  </span>userfriendlyscience<span class="op">::</span><span class="kw">diamondPlot</span>(PA_ci_girls, <span class="dt">returnLayerOnly =</span> <span class="ot">TRUE</span>, <span class="dt">linecolor =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">color=</span>viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">1</span>],<span class="co"># &#39;blue&#39;, </span>
                <span class="dt">alpha=</span>.<span class="dv">95</span>, <span class="dt">fixedSize =</span> <span class="fl">0.15</span>, <span class="dt">otherAxisCol =</span> (<span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(target) <span class="op">+</span><span class="st"> </span>.<span class="dv">2</span>)) <span class="op">+</span>
<span class="st">  </span>userfriendlyscience<span class="op">::</span><span class="kw">diamondPlot</span>(PA_ci_boys, <span class="dt">returnLayerOnly =</span> <span class="ot">TRUE</span>, <span class="dt">lineColor =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">color=</span>viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">3</span>], <span class="co">#&#39;green&#39;, </span>
                <span class="dt">alpha=</span>.<span class="dv">95</span>, <span class="dt">fixedSize =</span> <span class="fl">0.15</span>, <span class="dt">otherAxisCol =</span> (<span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(target) <span class="op">+</span><span class="st"> </span>.<span class="dv">2</span>))
## Warning: Ignoring unknown parameters: linecolor
## Warning: Ignoring unknown parameters: linecolor

## Warning: Ignoring unknown parameters: linecolor

## Warning: Ignoring unknown parameters: linecolor

## Warning: Ignoring unknown parameters: linecolor

## Warning: Ignoring unknown parameters: linecolor

## Warning: Ignoring unknown parameters: linecolor

## Warning: Ignoring unknown parameters: linecolor

PA_ci_intervention &lt;-<span class="st"> </span>ci_intervention <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(diamondlabels <span class="op">%in%</span><span class="st"> </span><span class="kw">names</span>(scales_T1) <span class="op">&amp;</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_actCop_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_intention_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_outcomeExpectations_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_pbc_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_selfefficacy_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_opportunities_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_dnorm_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_inorm_T1&quot;</span>, diamondlabels))

PA_ci_intervention &lt;-<span class="st"> </span>PA_ci_intervention[<span class="kw">match</span>(target, PA_ci_intervention<span class="op">$</span>diamondlabels), ]

PA_ci_control &lt;-<span class="st"> </span>ci_control <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(diamondlabels <span class="op">%in%</span><span class="st"> </span><span class="kw">names</span>(scales_T1) <span class="op">&amp;</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_actCop_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_intention_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_outcomeExpectations_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_pbc_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_selfefficacy_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_opportunities_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_dnorm_T1&quot;</span>, diamondlabels) <span class="op">|</span><span class="st"> </span>
<span class="st">                                     </span><span class="kw">grepl</span>(<span class="st">&quot;PA_inorm_T1&quot;</span>, diamondlabels))

PA_ci_control &lt;-<span class="st"> </span>PA_ci_control[<span class="kw">match</span>(target, PA_ci_control<span class="op">$</span>diamondlabels), ]

plot2 &lt;-<span class="st"> </span>plot2 <span class="op">+</span><span class="st"> </span>
<span class="st">  </span>userfriendlyscience<span class="op">::</span><span class="kw">diamondPlot</span>(PA_ci_intervention, <span class="dt">returnLayerOnly =</span> <span class="ot">TRUE</span>, <span class="dt">lineColor =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">color=</span>viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">4</span>],<span class="co"># &#39;blue&#39;,</span>
              <span class="dt">alpha=</span>.<span class="dv">95</span>, <span class="dt">fixedSize =</span> <span class="fl">0.15</span>, <span class="dt">otherAxisCol =</span> (<span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(target) <span class="op">+</span><span class="st"> </span>.<span class="dv">2</span>)) <span class="op">+</span>
<span class="st">  </span>userfriendlyscience<span class="op">::</span><span class="kw">diamondPlot</span>(PA_ci_control, <span class="dt">returnLayerOnly =</span> <span class="ot">TRUE</span>, <span class="dt">lineColor =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">color=</span>viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">2</span>], <span class="co">#&#39;red&#39;, </span>
              <span class="dt">alpha=</span>.<span class="dv">95</span>, <span class="dt">fixedSize =</span> <span class="fl">0.15</span>, <span class="dt">otherAxisCol =</span> (<span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(target) <span class="op">+</span><span class="st"> </span>.<span class="dv">2</span>))

plot1 <span class="op">+</span><span class="st"> </span>plot2
## Picking joint bandwidth of 0.337
## Warning: Removed 733 rows containing non-finite values
## (stat_density_ridges).
## Picking joint bandwidth of 0.341
## Warning: Removed 733 rows containing non-finite values
## (stat_density_ridges).</code></pre></div>
<p><img src="baseline-supplement_files/figure-html/bct-determinants-showdata-1.png" width="2100" /></p>
</div>
<div id="sb-determinants" class="section level2">
<h2>SB determinants</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># Draw plot with gender densities</span>

plot1 &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(id,
  intervention,
  group,
  school,
  girl,
<span class="st">&#39;SB intention&#39;</span> =<span class="st"> </span>SB_intention_T1,
<span class="st">&#39;SB outcome</span><span class="ch">\n</span><span class="st">expectations&#39;</span> =<span class="st"> </span>SB_outcomeExpectations_T1,
<span class="st">&#39;SB self-efficacy</span><span class="ch">\n</span><span class="st">and perceived</span><span class="ch">\n</span><span class="st">behavioural control&#39;</span> =<span class="st"> </span>SB_sePbc_T1,
<span class="st">&#39;SB descriptive</span><span class="ch">\n</span><span class="st">norm&#39;</span> =<span class="st"> </span>SB_dnorm_T1,
<span class="st">&#39;SB injunctive</span><span class="ch">\n</span><span class="st">norm&#39;</span> =<span class="st"> </span>SB_inorm_T1)  <span class="op">%&gt;%</span>
<span class="st">  </span><span class="co"># dplyr::select(noquote(order(colnames(.)))) %&gt;% # Orders columns alphabetically</span>
<span class="st">  </span>tidyr<span class="op">::</span><span class="kw">gather</span>(<span class="dt">key =</span> Variable, <span class="dt">value =</span> Value, <span class="dv">6</span><span class="op">:</span><span class="kw">ncol</span>(.)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>ggplot2<span class="op">::</span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">y =</span> Variable)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">geom_density_ridges</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Value,
                                    <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>,
                                    <span class="dt">fill =</span> <span class="kw">paste</span>(Variable, girl),
                                    <span class="dt">point_color =</span> girl,
                                    <span class="dt">point_fill =</span> girl,
                                    <span class="dt">point_shape =</span> girl,
                                    <span class="dt">point_size =</span> girl,
                                    <span class="dt">point_alpha =</span> girl),
                                <span class="dt">scale =</span> .<span class="dv">5</span>, <span class="dt">alpha =</span> .<span class="dv">6</span>, <span class="dt">size =</span> <span class="fl">0.25</span>,
                                <span class="dt">from =</span> <span class="dv">1</span>, <span class="dt">to =</span> <span class="dv">7</span>,
                                <span class="dt">position =</span> <span class="kw">position_raincloud</span>(<span class="dt">width =</span> <span class="fl">0.03</span>, <span class="dt">height =</span> <span class="fl">0.5</span>),
                                <span class="dt">jittered_points =</span> <span class="ot">TRUE</span>,
                                <span class="dt">point_size =</span> <span class="dv">1</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="ot">NULL</span>,
       <span class="dt">y =</span> <span class="ot">NULL</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_discrete</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_fill_cyclical</span>(
                      <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&#39;SB descriptive</span><span class="ch">\n</span><span class="st">norm boy&#39;</span> =<span class="st"> &quot;Boy&quot;</span>, <span class="st">&#39;SB descriptive</span><span class="ch">\n</span><span class="st">norm girl&#39;</span> =<span class="st"> &quot;Girl&quot;</span>),
                      <span class="dt">values =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>)],
                      <span class="dt">name =</span> <span class="st">&quot;&quot;</span>, 
                      <span class="dt">guide =</span> <span class="kw">guide_legend</span>(<span class="dt">override.aes =</span> <span class="kw">list</span>(<span class="dt">alpha =</span> <span class="dv">1</span>, 
                                                               <span class="dt">point_shape =</span> <span class="kw">c</span>(<span class="dv">24</span>, <span class="dv">25</span>),
                                                               <span class="dt">point_size =</span> <span class="dv">2</span>))) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_colour_cyclical</span>(<span class="dt">values =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">theme_ridges</span>(<span class="dt">grid =</span> <span class="ot">FALSE</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_discrete_manual</span>(<span class="dt">aesthetics =</span> <span class="st">&quot;point_color&quot;</span>, 
                                  <span class="dt">values =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>)],
                                  <span class="dt">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_discrete_manual</span>(<span class="dt">aesthetics =</span> <span class="st">&quot;point_fill&quot;</span>,
                                  <span class="dt">values =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>)],
                                  <span class="dt">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_discrete_manual</span>(<span class="dt">aesthetics =</span> <span class="st">&quot;point_shape&quot;</span>, 
                                  <span class="dt">values =</span> <span class="kw">c</span>(<span class="dv">24</span>, <span class="dv">25</span>),
                                  <span class="dt">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_discrete_manual</span>(<span class="dt">aesthetics =</span> <span class="st">&quot;point_size&quot;</span>, 
                                  <span class="dt">values =</span> <span class="kw">c</span>(.<span class="dv">75</span>, .<span class="dv">75</span>),
                                  <span class="dt">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_discrete_manual</span>(<span class="dt">aesthetics =</span> <span class="st">&quot;point_alpha&quot;</span>, 
                                  <span class="dt">values =</span> <span class="kw">c</span>(<span class="fl">0.1</span>, <span class="fl">0.1</span>),
                                  <span class="dt">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>papaja<span class="op">::</span><span class="kw">theme_apa</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)

plot2 &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(id,
  intervention,
  group,
  school,
  girl,
<span class="st">&#39;SB intention&#39;</span> =<span class="st"> </span>SB_intention_T1,
<span class="st">&#39;SB outcome</span><span class="ch">\n</span><span class="st">expectations&#39;</span> =<span class="st"> </span>SB_outcomeExpectations_T1,
<span class="st">&#39;SB self-efficacy</span><span class="ch">\n</span><span class="st">and perceived</span><span class="ch">\n</span><span class="st">behavioural control&#39;</span> =<span class="st"> </span>SB_sePbc_T1,
<span class="st">&#39;SB descriptive</span><span class="ch">\n</span><span class="st">norm&#39;</span> =<span class="st"> </span>SB_dnorm_T1,
<span class="st">&#39;SB injunctive</span><span class="ch">\n</span><span class="st">norm&#39;</span> =<span class="st"> </span>SB_inorm_T1)  <span class="op">%&gt;%</span>
<span class="st">  </span><span class="co"># dplyr::select(noquote(order(colnames(.)))) %&gt;% # Orders columns alphabetically</span>
<span class="st">  </span>tidyr<span class="op">::</span><span class="kw">gather</span>(<span class="dt">key =</span> Variable, <span class="dt">value =</span> Value, <span class="dv">6</span><span class="op">:</span><span class="kw">ncol</span>(.)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>ggplot2<span class="op">::</span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">y =</span> Variable)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">geom_density_ridges</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Value,
                                    <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>,
                                    <span class="dt">fill =</span> <span class="kw">paste</span>(Variable, intervention),
                                    <span class="dt">point_color =</span> intervention,
                                    <span class="dt">point_fill =</span> intervention,
                                    <span class="dt">point_shape =</span> intervention,
                                    <span class="dt">point_size =</span> intervention,
                                    <span class="dt">point_alpha =</span> intervention),
                                <span class="dt">scale =</span> .<span class="dv">5</span>, <span class="dt">alpha =</span> .<span class="dv">6</span>, <span class="dt">size =</span> <span class="fl">0.25</span>,
                                <span class="dt">from =</span> <span class="dv">1</span>, <span class="dt">to =</span> <span class="dv">7</span>,
                                <span class="dt">position =</span> <span class="kw">position_raincloud</span>(<span class="dt">width =</span> <span class="fl">0.03</span>, <span class="dt">height =</span> <span class="fl">0.5</span>),
                                <span class="dt">jittered_points =</span> <span class="ot">TRUE</span>,
                                <span class="dt">point_size =</span> <span class="dv">1</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="ot">NULL</span>,
       <span class="dt">y =</span> <span class="ot">NULL</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_discrete</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>), <span class="dt">labels =</span> <span class="ot">NULL</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_fill_cyclical</span>(
                      <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&#39;SB descriptive</span><span class="ch">\n</span><span class="st">norm 0&#39;</span> =<span class="st"> &quot;Control&quot;</span>, <span class="st">&#39;SB descriptive</span><span class="ch">\n</span><span class="st">norm 1&#39;</span> =<span class="st"> &quot;intervention&quot;</span>),
                      <span class="dt">values =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">4</span>)],
                      <span class="dt">name =</span> <span class="st">&quot;&quot;</span>, 
                      <span class="dt">guide =</span> <span class="kw">guide_legend</span>(<span class="dt">override.aes =</span> <span class="kw">list</span>(<span class="dt">alpha =</span> <span class="dv">1</span>, 
                                                               <span class="dt">point_shape =</span> <span class="kw">c</span>(<span class="dv">21</span>, <span class="dv">22</span>),
                                                               <span class="dt">point_size =</span> <span class="dv">2</span>))) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_colour_cyclical</span>(<span class="dt">values =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">theme_ridges</span>(<span class="dt">grid =</span> <span class="ot">FALSE</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_discrete_manual</span>(<span class="dt">aesthetics =</span> <span class="st">&quot;point_color&quot;</span>, 
                                  <span class="dt">values =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">4</span>)],
                                  <span class="dt">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_discrete_manual</span>(<span class="dt">aesthetics =</span> <span class="st">&quot;point_fill&quot;</span>,
                                  <span class="dt">values =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">4</span>)],
                                  <span class="dt">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_discrete_manual</span>(<span class="dt">aesthetics =</span> <span class="st">&quot;point_shape&quot;</span>, 
                                  <span class="dt">values =</span> <span class="kw">c</span>(<span class="dv">21</span>, <span class="dv">22</span>),
                                  <span class="dt">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_discrete_manual</span>(<span class="dt">aesthetics =</span> <span class="st">&quot;point_size&quot;</span>, 
                                  <span class="dt">values =</span> <span class="kw">c</span>(.<span class="dv">75</span>, .<span class="dv">75</span>),
                                  <span class="dt">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_discrete_manual</span>(<span class="dt">aesthetics =</span> <span class="st">&quot;point_alpha&quot;</span>, 
                                  <span class="dt">values =</span> <span class="kw">c</span>(<span class="fl">0.1</span>, <span class="fl">0.1</span>),
                                  <span class="dt">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>papaja<span class="op">::</span><span class="kw">theme_apa</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)

plot1 <span class="op">+</span><span class="st"> </span>plot2
## Picking joint bandwidth of 0.311
## Warning: Removed 507 rows containing non-finite values
## (stat_density_ridges).
## Picking joint bandwidth of 0.317
## Warning: Removed 507 rows containing non-finite values
## (stat_density_ridges).</code></pre></div>
<p><img src="baseline-supplement_files/figure-html/sb-determinants-1.png" width="2100" /></p>
</div>
</div>
<div id="informativeness-of-averages" class="section level1">
<h1>Informativeness of averages</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># total_n &lt;- df %&gt;% select(mvpaAccelerometer_T1, sitLieAccelerometer_T1, padaysLastweek_T1, sitBreaksAccelerometer_T1) %&gt;% </span>
<span class="co">#   na.omit(.) %&gt;% </span>
<span class="co">#   summarise(n = n())</span>
                     
middle_x_percentile &lt;-<span class="st"> </span><span class="cf">function</span>(middle_percentile) {
  df <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>((df<span class="op">$</span>mvpaAccelerometer_T1 <span class="op">&gt;</span><span class="st"> </span><span class="kw">quantile</span>(df<span class="op">$</span>mvpaAccelerometer_T1, <span class="dt">probs =</span> <span class="kw">c</span>(<span class="fl">0.5</span> <span class="op">-</span><span class="st"> </span>middle_percentile<span class="op">/</span><span class="dv">2</span>, <span class="fl">0.5</span> <span class="op">+</span><span class="st"> </span>middle_percentile<span class="op">/</span><span class="dv">2</span>), <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)[[<span class="dv">1</span>]]) <span class="op">&amp;</span>
<span class="st">                  </span>(df<span class="op">$</span>mvpaAccelerometer_T1 <span class="op">&lt;</span><span class="st"> </span><span class="kw">quantile</span>(df<span class="op">$</span>mvpaAccelerometer_T1, <span class="dt">probs =</span> <span class="kw">c</span>(<span class="fl">0.5</span> <span class="op">-</span><span class="st"> </span>middle_percentile<span class="op">/</span><span class="dv">2</span>, <span class="fl">0.5</span> <span class="op">+</span><span class="st"> </span>middle_percentile<span class="op">/</span><span class="dv">2</span>), <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)[[<span class="dv">2</span>]]) <span class="op">&amp;</span>
<span class="st">                </span>(df<span class="op">$</span>sitLieAccelerometer_T1 <span class="op">&gt;</span><span class="st"> </span><span class="kw">quantile</span>(df<span class="op">$</span>sitLieAccelerometer_T1, <span class="dt">probs =</span> <span class="kw">c</span>(<span class="fl">0.5</span> <span class="op">-</span><span class="st"> </span>middle_percentile<span class="op">/</span><span class="dv">2</span>, <span class="fl">0.5</span> <span class="op">+</span><span class="st"> </span>middle_percentile<span class="op">/</span><span class="dv">2</span>), <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)[[<span class="dv">1</span>]]) <span class="op">&amp;</span>
<span class="st">                 </span>(df<span class="op">$</span>sitLieAccelerometer_T1 <span class="op">&lt;</span><span class="st"> </span><span class="kw">quantile</span>(df<span class="op">$</span>sitLieAccelerometer_T1, <span class="dt">probs =</span> <span class="kw">c</span>(<span class="fl">0.5</span> <span class="op">-</span><span class="st"> </span>middle_percentile<span class="op">/</span><span class="dv">2</span>, <span class="fl">0.5</span> <span class="op">+</span><span class="st"> </span>middle_percentile<span class="op">/</span><span class="dv">2</span>), <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)[[<span class="dv">2</span>]]) <span class="op">&amp;</span><span class="st"> </span>
<span class="st">                </span>(df<span class="op">$</span>padaysLastweek_T1 <span class="op">&gt;</span><span class="st"> </span><span class="kw">quantile</span>(df<span class="op">$</span>padaysLastweek_T1, <span class="dt">probs =</span> <span class="kw">c</span>(<span class="fl">0.5</span> <span class="op">-</span><span class="st"> </span>middle_percentile<span class="op">/</span><span class="dv">2</span>, <span class="fl">0.5</span> <span class="op">+</span><span class="st"> </span>middle_percentile<span class="op">/</span><span class="dv">2</span>), <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)[[<span class="dv">1</span>]]) <span class="op">&amp;</span>
<span class="st">                  </span>(df<span class="op">$</span>padaysLastweek_T1 <span class="op">&lt;</span><span class="st"> </span><span class="kw">quantile</span>(df<span class="op">$</span>padaysLastweek_T1, <span class="dt">probs =</span> <span class="kw">c</span>(<span class="fl">0.5</span> <span class="op">-</span><span class="st"> </span>middle_percentile<span class="op">/</span><span class="dv">2</span>, <span class="fl">0.5</span> <span class="op">+</span><span class="st"> </span>middle_percentile<span class="op">/</span><span class="dv">2</span>), <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)[[<span class="dv">2</span>]]) <span class="op">&amp;</span>
<span class="st">                </span>(df<span class="op">$</span>sitBreaksAccelerometer_T1 <span class="op">&gt;</span><span class="st"> </span><span class="kw">quantile</span>(df<span class="op">$</span>sitBreaksAccelerometer_T1, <span class="dt">probs =</span> <span class="kw">c</span>(<span class="fl">0.5</span> <span class="op">-</span><span class="st"> </span>middle_percentile<span class="op">/</span><span class="dv">2</span>, <span class="fl">0.5</span> <span class="op">+</span><span class="st"> </span>middle_percentile<span class="op">/</span><span class="dv">2</span>), <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)[[<span class="dv">1</span>]]) <span class="op">&amp;</span>
<span class="st">                  </span>(df<span class="op">$</span>sitBreaksAccelerometer_T1 <span class="op">&lt;</span><span class="st"> </span><span class="kw">quantile</span>(df<span class="op">$</span>sitBreaksAccelerometer_T1, <span class="dt">probs =</span> <span class="kw">c</span>(<span class="fl">0.5</span> <span class="op">-</span><span class="st"> </span>middle_percentile<span class="op">/</span><span class="dv">2</span>, <span class="fl">0.5</span> <span class="op">+</span><span class="st"> </span>middle_percentile<span class="op">/</span><span class="dv">2</span>), <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)[[<span class="dv">2</span>]])) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span><span class="kw">nrow</span>(.)
}
  

getmiddle &lt;-<span class="st"> </span><span class="cf">function</span>(middlePerc) {                                       
df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(mvpaAccelerometer_T1, padaysLastweek_T1, sitLieAccelerometer_T1, sitBreaksAccelerometer_T1) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">na.omit</span>(.) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">summarise</span>(<span class="dt">n =</span> <span class="kw">n</span>(), 
                   <span class="dt">middle =</span> <span class="kw">sum</span>((mvpaAccelerometer_T1 <span class="op">&gt;</span><span class="st"> </span>
<span class="st">                                       </span>(<span class="kw">quantile</span>(mvpaAccelerometer_T1, <span class="dt">probs =</span> <span class="kw">c</span>(<span class="fl">0.5</span> <span class="op">-</span><span class="st"> </span>middlePerc<span class="op">/</span><span class="dv">2</span>, <span class="fl">0.5</span> <span class="op">+</span><span class="st"> </span>middlePerc<span class="op">/</span><span class="dv">2</span>))[[<span class="dv">1</span>]])) <span class="op">&amp;</span><span class="st"> </span>
<span class="st">                                      </span>(mvpaAccelerometer_T1 <span class="op">&lt;</span><span class="st"> </span>
<span class="st">                                       </span>(<span class="kw">quantile</span>(mvpaAccelerometer_T1, <span class="dt">probs =</span> <span class="kw">c</span>(<span class="fl">0.5</span> <span class="op">-</span><span class="st"> </span>middlePerc<span class="op">/</span><span class="dv">2</span>, <span class="fl">0.5</span> <span class="op">+</span><span class="st"> </span>middlePerc<span class="op">/</span><span class="dv">2</span>))[[<span class="dv">2</span>]])) <span class="op">&amp;</span>
<span class="st">                                      </span>(padaysLastweek_T1 <span class="op">&gt;</span><span class="st"> </span>
<span class="st">                                       </span>(<span class="kw">quantile</span>(padaysLastweek_T1, <span class="dt">probs =</span> <span class="kw">c</span>(<span class="fl">0.5</span> <span class="op">-</span><span class="st"> </span>middlePerc<span class="op">/</span><span class="dv">2</span>, <span class="fl">0.5</span> <span class="op">+</span><span class="st"> </span>middlePerc<span class="op">/</span><span class="dv">2</span>))[[<span class="dv">1</span>]])) <span class="op">&amp;</span><span class="st"> </span>
<span class="st">                                      </span>(padaysLastweek_T1 <span class="op">&lt;</span><span class="st"> </span>
<span class="st">                                       </span>(<span class="kw">quantile</span>(padaysLastweek_T1, <span class="dt">probs =</span> <span class="kw">c</span>(<span class="fl">0.5</span> <span class="op">-</span><span class="st"> </span>middlePerc<span class="op">/</span><span class="dv">2</span>, <span class="fl">0.5</span> <span class="op">+</span><span class="st"> </span>middlePerc<span class="op">/</span><span class="dv">2</span>))[[<span class="dv">2</span>]])) <span class="op">&amp;</span>
<span class="st">                                      </span>(sitLieAccelerometer_T1 <span class="op">&gt;</span><span class="st"> </span>
<span class="st">                                       </span>(<span class="kw">quantile</span>(sitLieAccelerometer_T1, <span class="dt">probs =</span> <span class="kw">c</span>(<span class="fl">0.5</span> <span class="op">-</span><span class="st"> </span>middlePerc<span class="op">/</span><span class="dv">2</span>, <span class="fl">0.5</span> <span class="op">+</span><span class="st"> </span>middlePerc<span class="op">/</span><span class="dv">2</span>))[[<span class="dv">1</span>]])) <span class="op">&amp;</span><span class="st"> </span>
<span class="st">                                      </span>(sitLieAccelerometer_T1 <span class="op">&lt;</span><span class="st"> </span>
<span class="st">                                       </span>(<span class="kw">quantile</span>(sitLieAccelerometer_T1, <span class="dt">probs =</span> <span class="kw">c</span>(<span class="fl">0.5</span> <span class="op">-</span><span class="st"> </span>middlePerc<span class="op">/</span><span class="dv">2</span>, <span class="fl">0.5</span> <span class="op">+</span><span class="st"> </span>middlePerc<span class="op">/</span><span class="dv">2</span>))[[<span class="dv">2</span>]])) <span class="op">&amp;</span>
<span class="st">                                      </span>(sitBreaksAccelerometer_T1 <span class="op">&gt;</span><span class="st"> </span>
<span class="st">                                       </span>(<span class="kw">quantile</span>(sitBreaksAccelerometer_T1, <span class="dt">probs =</span> <span class="kw">c</span>(<span class="fl">0.5</span> <span class="op">-</span><span class="st"> </span>middlePerc<span class="op">/</span><span class="dv">2</span>, <span class="fl">0.5</span> <span class="op">+</span><span class="st"> </span>middlePerc<span class="op">/</span><span class="dv">2</span>))[[<span class="dv">1</span>]])) <span class="op">&amp;</span><span class="st"> </span>
<span class="st">                                      </span>(sitBreaksAccelerometer_T1 <span class="op">&lt;</span><span class="st"> </span>
<span class="st">                                       </span>(<span class="kw">quantile</span>(sitBreaksAccelerometer_T1, <span class="dt">probs =</span> <span class="kw">c</span>(<span class="fl">0.5</span> <span class="op">-</span><span class="st"> </span>middlePerc<span class="op">/</span><span class="dv">2</span>, <span class="fl">0.5</span> <span class="op">+</span><span class="st"> </span>middlePerc<span class="op">/</span><span class="dv">2</span>))[[<span class="dv">2</span>]]))
                                     )) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span><span class="kw">mutate</span>(<span class="dt">perc =</span> middle<span class="op">/</span>n)
}


middleprobs &lt;-<span class="st"> </span><span class="cf">function</span>(prob1, prob2) {
<span class="kw">sum</span>(df<span class="op">$</span>mvpaAccelerometer_T1 <span class="op">&gt;=</span><span class="st"> </span><span class="kw">quantile</span>(df<span class="op">$</span>mvpaAccelerometer_T1, <span class="dt">probs =</span> <span class="kw">c</span>(prob1, prob2), <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)[[<span class="dv">1</span>]] <span class="op">&amp;</span>
<span class="st">      </span>df<span class="op">$</span>mvpaAccelerometer_T1 <span class="op">&lt;=</span><span class="st"> </span><span class="kw">quantile</span>(df<span class="op">$</span>mvpaAccelerometer_T1, <span class="dt">probs =</span> <span class="kw">c</span>(prob1, prob2), <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)[[<span class="dv">2</span>]] <span class="op">&amp;</span>
<span class="st">    </span>df<span class="op">$</span>padaysLastweek_T1 <span class="op">&gt;=</span><span class="st"> </span><span class="kw">quantile</span>(df<span class="op">$</span>padaysLastweek_T1, <span class="dt">probs =</span> <span class="kw">c</span>(prob1, prob2), <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)[[<span class="dv">1</span>]] <span class="op">&amp;</span>
<span class="st">      </span>df<span class="op">$</span>padaysLastweek_T1 <span class="op">&lt;=</span><span class="st"> </span><span class="kw">quantile</span>(df<span class="op">$</span>padaysLastweek_T1, <span class="dt">probs =</span> <span class="kw">c</span>(prob1, prob2), <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)[[<span class="dv">2</span>]] <span class="op">&amp;</span>
<span class="st">    </span>df<span class="op">$</span>sitLieAccelerometer_T1 <span class="op">&gt;=</span><span class="st"> </span><span class="kw">quantile</span>(df<span class="op">$</span>sitLieAccelerometer_T1, <span class="dt">probs =</span> <span class="kw">c</span>(prob1, prob2), <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)[[<span class="dv">1</span>]] <span class="op">&amp;</span>
<span class="st">      </span>df<span class="op">$</span>sitLieAccelerometer_T1 <span class="op">&lt;=</span><span class="st"> </span><span class="kw">quantile</span>(df<span class="op">$</span>sitLieAccelerometer_T1, <span class="dt">probs =</span> <span class="kw">c</span>(prob1, prob2), <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)[[<span class="dv">2</span>]] <span class="op">&amp;</span>
<span class="st">    </span>df<span class="op">$</span>sitBreaksAccelerometer_T1 <span class="op">&gt;=</span><span class="st"> </span><span class="kw">quantile</span>(df<span class="op">$</span>sitBreaksAccelerometer_T1, <span class="dt">probs =</span> <span class="kw">c</span>(prob1, prob2), <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)[[<span class="dv">1</span>]] <span class="op">&amp;</span>
<span class="st">      </span>df<span class="op">$</span>sitBreaksAccelerometer_T1 <span class="op">&lt;=</span><span class="st"> </span><span class="kw">quantile</span>(df<span class="op">$</span>sitBreaksAccelerometer_T1, <span class="dt">probs =</span> <span class="kw">c</span>(prob1, prob2), <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)[[<span class="dv">2</span>]],
    <span class="dt">na.rm=</span> <span class="ot">TRUE</span>) 
}    

<span class="co"># # How to use these functions:</span>
<span class="co"># middleprobs(1/3, 2/3) </span>
<span class="co"># middle_x_percentile(1/3)</span>
<span class="co"># getmiddle(1/3)</span>

<span class="co"># # the gettmiddle function doesn&#39;t work like the others. Because it omits na from the start?</span>

<span class="co"># # middle_x_percentile(1) gives a number != total, because it&#39;s exclusive of the ends. See difference between</span>

<span class="co"># sum(df$mvpaAccelerometer_T1 &gt;= min(df$mvpaAccelerometer_T1, na.rm = TRUE) &amp;</span>
<span class="co">#       df$mvpaAccelerometer_T1 &lt;= max(df$mvpaAccelerometer_T1, na.rm = TRUE) &amp;</span>
<span class="co">#     df$padaysLastweek_T1 &gt;= min(df$padaysLastweek_T1, na.rm = TRUE) &amp;</span>
<span class="co">#       df$padaysLastweek_T1 &lt;= max(df$padaysLastweek_T1, na.rm = TRUE) &amp;</span>
<span class="co">#     df$sitLieAccelerometer_T1 &gt;= min(df$sitLieAccelerometer_T1, na.rm = TRUE) &amp;</span>
<span class="co">#       df$sitLieAccelerometer_T1 &lt;= max(df$sitLieAccelerometer_T1, na.rm = TRUE) &amp;</span>
<span class="co">#     df$sitBreaksAccelerometer_T1 &gt;= min(df$sitBreaksAccelerometer_T1, na.rm = TRUE) &amp;</span>
<span class="co">#       df$sitBreaksAccelerometer_T1 &lt;= max(df$sitBreaksAccelerometer_T1, na.rm = TRUE),</span>
<span class="co">#     na.rm= TRUE) </span>

<span class="co"># # and</span>

<span class="co"># sum(df$mvpaAccelerometer_T1 &gt; min(df$mvpaAccelerometer_T1, na.rm = TRUE) &amp;</span>
<span class="co">#       df$mvpaAccelerometer_T1 &lt; max(df$mvpaAccelerometer_T1, na.rm = TRUE) &amp;</span>
<span class="co">#     df$padaysLastweek_T1 &gt; min(df$padaysLastweek_T1, na.rm = TRUE) &amp;</span>
<span class="co">#       df$padaysLastweek_T1 &lt; max(df$padaysLastweek_T1, na.rm = TRUE) &amp;</span>
<span class="co">#     df$sitLieAccelerometer_T1 &gt; min(df$sitLieAccelerometer_T1, na.rm = TRUE) &amp;</span>
<span class="co">#       df$sitLieAccelerometer_T1 &lt; max(df$sitLieAccelerometer_T1, na.rm = TRUE) &amp;</span>
<span class="co">#     df$sitBreaksAccelerometer_T1 &gt; min(df$sitBreaksAccelerometer_T1, na.rm = TRUE) &amp;</span>
<span class="co">#       df$sitBreaksAccelerometer_T1 &lt; max(df$sitBreaksAccelerometer_T1, na.rm = TRUE),</span>
<span class="co">#     na.rm= TRUE) </span>

middle_df &lt;-<span class="st"> </span><span class="ot">NA</span>
  
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">100</span>) {
middle_df[i] &lt;-<span class="st"> </span><span class="kw">middleprobs</span>(<span class="fl">0.5</span> <span class="op">-</span><span class="st"> </span>i<span class="op">/</span><span class="dv">2</span><span class="op">/</span><span class="dv">100</span>, <span class="fl">0.5</span> <span class="op">+</span><span class="st"> </span>i<span class="op">/</span><span class="dv">2</span><span class="op">/</span><span class="dv">100</span>) <span class="op">/</span><span class="st"> </span><span class="dv">706</span>   
}

meansplot_df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">middle_band_width_perc =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">100</span>, <span class="dt">perc_of_participants_included =</span> middle_df)

meansplot_df <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">y =</span> <span class="dv">100</span> <span class="op">*</span><span class="st"> </span>perc_of_participants_included, <span class="dt">x =</span> middle_band_width_perc)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;The Stereotypical Participant?&quot;</span>, 
       <span class="dt">y =</span> <span class="st">&quot;% of participants included&quot;</span>, 
       <span class="dt">x =</span> <span class="st">&quot;Middle x percent (width of band around the median on all primary outcome variables)&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">100</span>, <span class="dt">by =</span> <span class="dv">10</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">100</span>, <span class="dt">by =</span> <span class="dv">10</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> <span class="dv">0</span>, <span class="dt">ymax =</span> <span class="dv">100</span> <span class="op">*</span><span class="st"> </span>perc_of_participants_included), <span class="dt">fill=</span><span class="st">&quot;blue&quot;</span>, <span class="dt">alpha=</span><span class="st">&quot;0.5&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme_light</span>()</code></pre></div>
<p><img src="baseline-supplement_files/figure-html/average-coverage-1.png" width="2100" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># # This makes an inferior plot:</span>
<span class="co">#</span>
<span class="co"># middle_df2 &lt;- NA</span>
<span class="co"># </span>
<span class="co"># for(i in 1:100) {</span>
<span class="co"># middle_df2[i] &lt;- middleprobs(0.5 - i/2/100, 0.5 + i/2/100) / 706   </span>
<span class="co"># }</span>
<span class="co"># </span>
<span class="co"># meansplot_df2 &lt;- data.frame(middle_band_width_perc = c(1:100), hi = 0.5 + middle_df2/2, lo = 0.5 - middle_df2/2)</span>
<span class="co"># </span>
<span class="co"># meansplot_df &lt;- data.frame(middle_band_width_perc = 1:100, perc_of_participants_included = middle_df)</span>
<span class="co">#</span>
<span class="co"># meansplot_df2 %&gt;% </span>
<span class="co">#   ggplot(aes(y = 100 * hi, x = middle_band_width_perc)) +</span>
<span class="co">#   geom_line() +</span>
<span class="co">#   # geom_line(aes(y = 100 * lo, x = middle_band_width_perc)) +</span>
<span class="co">#   labs(title = &quot;The Stereotypical Participant?&quot;, </span>
<span class="co">#        y = &quot;% of participants covered&quot;, </span>
<span class="co">#        x = &quot;Definition of average (\&quot;middle x percent\&quot;, or \&quot;width of band around the median on all the variables\&quot;)&quot;) +</span>
<span class="co">#   # geom_ribbon(aes(ymin = 0, ymax = 100 * hi), fill=&quot;blue&quot;, alpha=&quot;0.5&quot;) +</span>
<span class="co">#   scale_y_continuous(breaks = seq(0, 100, by = 10)) +</span>
<span class="co">#   scale_x_continuous(breaks = seq(0, 100, by = 10)) +</span>
<span class="co">#   theme_light()</span></code></pre></div>
<p>2 percent of participants fell in the middle 30% of all four outcome variables.</p>
</div>
<div id="types-of-self-reported-exercise" class="section level1">
<h1>Types of self-reported exercise</h1>
<p>This section describes the proportions of participants reporting they did a certain type of activity during the last month.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
exerciseTypes_df &lt;-<span class="st"> </span>lmi <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(Kys0051.<span class="dv">1</span><span class="op">:</span>Kys0064.<span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="kw">contains</span>(<span class="st">&quot;.1&quot;</span>))
exerciseTypes_df<span class="op">$</span>track &lt;-<span class="st"> </span>df<span class="op">$</span>track
exerciseTypes_df<span class="op">$</span>girl &lt;-<span class="st"> </span>df<span class="op">$</span>girl

<span class="kw">names</span>(exerciseTypes_df) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Team ball games&quot;</span>, 
                             <span class="st">&quot;Other ball games&quot;</span>,
                             <span class="st">&quot;Gym training&quot;</span>,
                             <span class="st">&quot;Combat sports&quot;</span>,
                             <span class="st">&quot;Fitness classes&quot;</span>,
                             <span class="st">&quot;Home workout&quot;</span>,
                             <span class="st">&quot;Cycling&quot;</span>,
                             <span class="st">&quot;Swimming&quot;</span>,
                             <span class="st">&quot;Walking&quot;</span>,
                             <span class="st">&quot;Running&quot;</span>,
                             <span class="st">&quot;Skiing&quot;</span>,
                             <span class="st">&quot;Roller skating&quot;</span>,
                             <span class="st">&quot;Horseback riding&quot;</span>,
                             <span class="st">&quot;Other&quot;</span>,
                             <span class="st">&quot;track&quot;</span>,
                             <span class="st">&quot;girl&quot;</span>
                             )

<span class="co"># For educational tracks</span>

exerciseTypes_proportions &lt;-<span class="st"> </span>exerciseTypes_df <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(track), track <span class="op">!=</span><span class="st"> &quot;Other&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate_at</span>(<span class="kw">vars</span>(<span class="st">`</span><span class="dt">Team ball games</span><span class="st">`</span><span class="op">:</span><span class="st">`</span><span class="dt">Other</span><span class="st">`</span>), <span class="kw">funs</span>(<span class="kw">replace_na</span>(., <span class="dv">0</span>))) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># replace NA&#39;s with 0</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">group_by</span>(track) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">summarise_at</span>(<span class="kw">vars</span>(<span class="st">`</span><span class="dt">Team ball games</span><span class="st">`</span><span class="op">:</span><span class="st">`</span><span class="dt">Other</span><span class="st">`</span>), <span class="kw">funs</span>(<span class="kw">mean</span>(., <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)))

exerciseTypes_cases &lt;-<span class="st"> </span>exerciseTypes_df <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(track), track <span class="op">!=</span><span class="st"> &quot;Other&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate_at</span>(<span class="kw">vars</span>(<span class="st">`</span><span class="dt">Team ball games</span><span class="st">`</span><span class="op">:</span><span class="st">`</span><span class="dt">Other</span><span class="st">`</span>), <span class="kw">funs</span>(<span class="kw">replace_na</span>(., <span class="dv">0</span>))) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># replace NA&#39;s with 0</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">group_by</span>(track) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">summarise_at</span>(<span class="kw">vars</span>(<span class="st">`</span><span class="dt">Team ball games</span><span class="st">`</span><span class="op">:</span><span class="st">`</span><span class="dt">Other</span><span class="st">`</span>), sum) 

exerciseTypes_totals &lt;-<span class="st"> </span>exerciseTypes_df <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(track), track <span class="op">!=</span><span class="st"> &quot;Other&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate_at</span>(<span class="kw">vars</span>(<span class="st">`</span><span class="dt">Team ball games</span><span class="st">`</span><span class="op">:</span><span class="st">`</span><span class="dt">Other</span><span class="st">`</span>), <span class="kw">funs</span>(<span class="kw">replace_na</span>(., <span class="dv">0</span>))) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># replace NA&#39;s with 0</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">group_by</span>(track) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">summarise_at</span>(<span class="kw">vars</span>(<span class="st">`</span><span class="dt">Team ball games</span><span class="st">`</span><span class="op">:</span><span class="st">`</span><span class="dt">Other</span><span class="st">`</span>), <span class="kw">funs</span>(<span class="kw">sum</span>(<span class="op">!</span><span class="kw">is.na</span>(.))))

exerciseTypes_pvals &lt;-<span class="st"> </span><span class="ot">NA</span> <span class="co"># Empty vector to be filled</span>

<span class="cf">for</span> (i <span class="cf">in</span> (<span class="dv">2</span><span class="op">:</span><span class="dv">15</span>)) {
exerciseTypes_test &lt;-<span class="st"> </span><span class="kw">data.frame</span>(exerciseTypes_cases[ , i], exerciseTypes_totals[ , i])
exerciseTypes_pvals[i<span class="op">-</span><span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">prop.test</span>(exerciseTypes_test[, <span class="dv">1</span>], exerciseTypes_test[, <span class="dv">2</span>])<span class="op">$</span>p.value <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">round</span>(., <span class="dv">5</span>)
}
## Warning in prop.test(exerciseTypes_test[, 1], exerciseTypes_test[, 2]):
## Chi-squared approximation may be incorrect

<span class="kw">data.frame</span>(<span class="st">&quot;Exercise type&quot;</span> =<span class="st"> </span><span class="kw">names</span>(exerciseTypes_df)[<span class="dv">1</span><span class="op">:</span><span class="dv">14</span>], <span class="st">&quot;p-values: educational tracks&quot;</span> =<span class="st"> </span>exerciseTypes_pvals) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>DT<span class="op">::</span><span class="kw">datatable</span>() <span class="co">#papaja::apa_table()</span></code></pre></div>
<div id="htmlwidget-ddf3025055bf8c1fd3d9" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-ddf3025055bf8c1fd3d9">{"x":{"filter":"none","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14"],["Team ball games","Other ball games","Gym training","Combat sports","Fitness classes","Home workout","Cycling","Swimming","Walking","Running","Skiing","Roller skating","Horseback riding","Other"],[0.00018,0.33314,0.00382,0.248,0.01828,6e-005,0,0,0,0.00049,0.00055,0.29701,0.47324,0.93672]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Exercise.type<\/th>\n      <th>p.values..educational.tracks<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-center","targets":"_all"},{"className":"dt-right","targets":2},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
exerciseTypes_proportions <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>DT<span class="op">::</span><span class="kw">datatable</span>() <span class="co">#papaja::apa_table()</span></code></pre></div>
<div id="htmlwidget-bc2e2bd013012c3a6da3" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-bc2e2bd013012c3a6da3">{"x":{"filter":"none","data":[["1","2","3","4"],["IT","BA","HRC","Nur"],[0.159509202453988,0.301418439716312,0.164319248826291,0.194029850746269],[0.0674846625766871,0.0638297872340425,0.0328638497652582,0.0671641791044776],[0.294478527607362,0.450354609929078,0.413145539906103,0.350746268656716],[0.0858895705521472,0.0921985815602837,0.0657276995305164,0.054726368159204],[0.00613496932515337,0.0709219858156028,0.0469483568075117,0.0646766169154229],[0.0674846625766871,0.223404255319149,0.234741784037559,0.228855721393035],[0.153374233128834,0.0815602836879433,0.0751173708920188,0.236318407960199],[0.049079754601227,0.0354609929078014,0.0516431924882629,0.161691542288557],[0.521472392638037,0.390070921985816,0.52112676056338,0.659203980099503],[0.134969325153374,0.26241134751773,0.272300469483568,0.305970149253731],[0.0429447852760736,0.049645390070922,0.0751173708920188,0.00995024875621891],[0,0.00354609929078014,0.00469483568075117,0.0124378109452736],[0.0245398773006135,0.0354609929078014,0.0234741784037559,0.0447761194029851],[0.104294478527607,0.099290780141844,0.107981220657277,0.114427860696517]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>track<\/th>\n      <th>Team ball games<\/th>\n      <th>Other ball games<\/th>\n      <th>Gym training<\/th>\n      <th>Combat sports<\/th>\n      <th>Fitness classes<\/th>\n      <th>Home workout<\/th>\n      <th>Cycling<\/th>\n      <th>Swimming<\/th>\n      <th>Walking<\/th>\n      <th>Running<\/th>\n      <th>Skiing<\/th>\n      <th>Roller skating<\/th>\n      <th>Horseback riding<\/th>\n      <th>Other<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-center","targets":"_all"},{"className":"dt-right","targets":[2,3,4,5,6,7,8,9,10,11,12,13,14,15]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># For girls and boys</span>

exerciseTypes_girlboy_proportions &lt;-<span class="st"> </span>exerciseTypes_df <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(girl)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate_at</span>(<span class="kw">vars</span>(<span class="st">`</span><span class="dt">Team ball games</span><span class="st">`</span><span class="op">:</span><span class="st">`</span><span class="dt">Other</span><span class="st">`</span>), <span class="kw">funs</span>(<span class="kw">replace_na</span>(., <span class="dv">0</span>))) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># replace NA&#39;s with 0</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">group_by</span>(girl) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">summarise_at</span>(<span class="kw">vars</span>(<span class="st">`</span><span class="dt">Team ball games</span><span class="st">`</span><span class="op">:</span><span class="st">`</span><span class="dt">Other</span><span class="st">`</span>), <span class="kw">funs</span>(<span class="kw">mean</span>(., <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))) 

exerciseTypes_girlboy_cases &lt;-<span class="st"> </span>exerciseTypes_df <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(girl)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate_at</span>(<span class="kw">vars</span>(<span class="st">`</span><span class="dt">Team ball games</span><span class="st">`</span><span class="op">:</span><span class="st">`</span><span class="dt">Other</span><span class="st">`</span>), <span class="kw">funs</span>(<span class="kw">replace_na</span>(., <span class="dv">0</span>))) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># replace NA&#39;s with 0</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">group_by</span>(girl) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">summarise_at</span>(<span class="kw">vars</span>(<span class="st">`</span><span class="dt">Team ball games</span><span class="st">`</span><span class="op">:</span><span class="st">`</span><span class="dt">Other</span><span class="st">`</span>), sum)

exerciseTypes_girlboy_totals &lt;-<span class="st"> </span>exerciseTypes_df <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(girl)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate_at</span>(<span class="kw">vars</span>(<span class="st">`</span><span class="dt">Team ball games</span><span class="st">`</span><span class="op">:</span><span class="st">`</span><span class="dt">Other</span><span class="st">`</span>), <span class="kw">funs</span>(<span class="kw">replace_na</span>(., <span class="dv">0</span>))) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># replace NA&#39;s with 0</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">group_by</span>(girl) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">summarise_at</span>(<span class="kw">vars</span>(<span class="st">`</span><span class="dt">Team ball games</span><span class="st">`</span><span class="op">:</span><span class="st">`</span><span class="dt">Other</span><span class="st">`</span>), <span class="kw">funs</span>(<span class="kw">sum</span>(<span class="op">!</span><span class="kw">is.na</span>(.))))

exerciseTypes_girlboy_pvals &lt;-<span class="st"> </span><span class="ot">NA</span> <span class="co"># Empty vector to be filled</span>

<span class="cf">for</span> (i <span class="cf">in</span> (<span class="dv">2</span><span class="op">:</span><span class="dv">15</span>)) {
exerciseTypes_girlboy_test &lt;-<span class="st"> </span><span class="kw">data.frame</span>(exerciseTypes_girlboy_cases[ , i], exerciseTypes_girlboy_totals[ , i])
exerciseTypes_girlboy_pvals[i<span class="op">-</span><span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">prop.test</span>(exerciseTypes_girlboy_test[, <span class="dv">1</span>], exerciseTypes_girlboy_test[, <span class="dv">2</span>])<span class="op">$</span>p.value <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">round</span>(., <span class="dv">5</span>)
}
## Warning in prop.test(exerciseTypes_girlboy_test[, 1],
## exerciseTypes_girlboy_test[, : Chi-squared approximation may be incorrect

<span class="kw">data.frame</span>(<span class="st">&quot;Exercise type&quot;</span> =<span class="st"> </span><span class="kw">names</span>(exerciseTypes_girlboy_cases)[<span class="dv">2</span><span class="op">:</span><span class="dv">15</span>], <span class="st">&quot;p-values: boys vs. girls&quot;</span> =<span class="st"> </span>exerciseTypes_girlboy_pvals)  <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>DT<span class="op">::</span><span class="kw">datatable</span>() <span class="co">#papaja::apa_table()</span></code></pre></div>
<div id="htmlwidget-50289237306ab0752d87" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-50289237306ab0752d87">{"x":{"filter":"none","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14"],["Team ball games","Other ball games","Gym training","Combat sports","Fitness classes","Home workout","Cycling","Swimming","Walking","Running","Skiing","Roller skating","Horseback riding","Other"],[0,0.06107,0.00165,0,0,0,0.36143,0.0061,0,0.00087,1,0.14735,0,0.96784]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Exercise.type<\/th>\n      <th>p.values..boys.vs..girls<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-center","targets":"_all"},{"className":"dt-right","targets":2},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
exerciseTypes_girlboy_proportions <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>DT<span class="op">::</span><span class="kw">datatable</span>() <span class="co">#papaja::apa_table()</span></code></pre></div>
<div id="htmlwidget-fa4286368c581004b6ee" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-fa4286368c581004b6ee">{"x":{"filter":"none","data":[["1","2"],["girl","boy"],[0.110929853181077,0.339702760084926],[0.0473083197389886,0.0764331210191083],[0.33768352365416,0.43312101910828],[0.0309951060358891,0.123142250530786],[0.0864600326264274,0.0127388535031847],[0.283849918433931,0.0976645435244161],[0.159869494290375,0.138004246284501],[0.114192495921697,0.0636942675159236],[0.64926590538336,0.407643312101911],[0.301794453507341,0.210191082802548],[0.0391517128874388,0.0382165605095541],[0.0032626427406199,0.0127388535031847],[0.0603588907014682,0.00424628450106157],[0.110929853181077,0.10828025477707]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>girl<\/th>\n      <th>Team ball games<\/th>\n      <th>Other ball games<\/th>\n      <th>Gym training<\/th>\n      <th>Combat sports<\/th>\n      <th>Fitness classes<\/th>\n      <th>Home workout<\/th>\n      <th>Cycling<\/th>\n      <th>Swimming<\/th>\n      <th>Walking<\/th>\n      <th>Running<\/th>\n      <th>Skiing<\/th>\n      <th>Roller skating<\/th>\n      <th>Horseback riding<\/th>\n      <th>Other<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-center","targets":"_all"},{"className":"dt-right","targets":[2,3,4,5,6,7,8,9,10,11,12,13,14,15]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<p>CIBER (not included for now)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#p_install(&quot;userfriendlyscience&quot;)</span>

<span class="co"># cat(names(df), sep = &quot;\&quot;,\n\&quot;&quot;)</span>

<span class="co"># Make variables numeric, and d as data frame</span>
d_num &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate_all</span>(as.numeric) 
d_num &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(d_num)

userfriendlyscience<span class="op">::</span><span class="kw">CIBER</span>(<span class="dt">data =</span> d_num,
      <span class="dt">determinants =</span> <span class="kw">c</span>(
        <span class="st">&quot;actCop_T1&quot;</span>,
        <span class="st">&quot;agrbct_T1&quot;</span>,
        <span class="st">&quot;amotivation_T1&quot;</span>,
        <span class="st">&quot;autonomous_T1&quot;</span>,
        <span class="st">&quot;big5_agreeableness_T1.1&quot;</span>,
        <span class="st">&quot;big5_conscientiousness_T1.1&quot;</span>,
        <span class="st">&quot;big5_extraversion_T1.1&quot;</span>,
        <span class="st">&quot;big5_neuroticism_T1.1&quot;</span>,
        <span class="st">&quot;big5_openness_T1.1&quot;</span>,
        <span class="st">&quot;controlled_T1&quot;</span>,
        <span class="st">&quot;dnorm_T1&quot;</span>,
        <span class="st">&quot;frqbct_T1&quot;</span>,
        <span class="st">&quot;goal_T1&quot;</span>,
        <span class="st">&quot;inorm_T1&quot;</span>,
        <span class="st">&quot;intention_T1&quot;</span>,
        <span class="st">&quot;outcomeExpectations_T1&quot;</span>,
        <span class="st">&quot;opportunities_T1&quot;</span>,
        <span class="st">&quot;pbc_T1&quot;</span>,
        <span class="st">&quot;selfefficacy_T1&quot;</span>),
      <span class="dt">targets =</span> <span class="kw">c</span>(<span class="st">&quot;paT1&quot;</span>, <span class="st">&quot;fatpct_T1&quot;</span>),
      <span class="dt">conf.level =</span> <span class="kw">list</span>(<span class="dt">means =</span> <span class="fl">0.9999</span>,
                        <span class="dt">associations =</span> <span class="fl">0.99</span>)
      )

userfriendlyscience<span class="op">::</span><span class="kw">CIBER</span>(<span class="dt">data =</span> d_num,
      <span class="dt">determinants =</span> <span class="kw">c</span>(
        <span class="st">&quot;actCop_T1&quot;</span>,
        <span class="st">&quot;agrbct_T1&quot;</span>,
        <span class="st">&quot;frqbct_T1&quot;</span>,
        <span class="st">&quot;amotivation_T1&quot;</span>,
        <span class="st">&quot;autonomous_T1&quot;</span>,
        <span class="st">&quot;controlled_T1&quot;</span>,
        <span class="st">&quot;dnorm_T1&quot;</span>,
        <span class="st">&quot;intention_T1&quot;</span>,
        <span class="st">&quot;outcomeExpectations_T1&quot;</span>,
        <span class="st">&quot;opportunities_T1&quot;</span>,
        <span class="st">&quot;sePbc_T1&quot;</span>),
      <span class="dt">targets =</span> <span class="kw">c</span>(<span class="st">&quot;paT1&quot;</span>, <span class="st">&quot;fatpct_T1&quot;</span>),
      <span class="dt">conf.level =</span> <span class="kw">list</span>(<span class="dt">means =</span> <span class="fl">0.9999</span>,
                        <span class="dt">associations =</span> <span class="fl">0.99</span>)
      )

<span class="co"># to create variable list for CIBER:</span>
<span class="co"># cat(names(d), sep = &quot;\&quot;,\n\&quot;&quot;)</span>

userfriendlyscience<span class="op">::</span><span class="kw">CIBER</span>(<span class="dt">data =</span> d_num,
  <span class="dt">determinants =</span> <span class="kw">c</span>(
  <span class="st">&quot;agrbct_01_T1&quot;</span>,
  <span class="st">&quot;agrbct_02_T1&quot;</span>,
  <span class="st">&quot;agrbct_03_T1&quot;</span>,
  <span class="st">&quot;agrbct_04_T1&quot;</span>,
  <span class="st">&quot;agrbct_05_T1&quot;</span>,
  <span class="st">&quot;agrbct_06_T1&quot;</span>,
  <span class="st">&quot;agrbct_07_T1&quot;</span>,
  <span class="st">&quot;agrbct_08_T1&quot;</span>,
  <span class="st">&quot;agrbct_09_T1&quot;</span>,
  <span class="st">&quot;agrbct_10_T1&quot;</span>,
  <span class="st">&quot;frqbct_01_T1&quot;</span>,
  <span class="st">&quot;frqbct_02_T1&quot;</span>,
  <span class="st">&quot;frqbct_03_T1&quot;</span>,
  <span class="st">&quot;frqbct_04_T1&quot;</span>,
  <span class="st">&quot;frqbct_05_T1&quot;</span>,
  <span class="st">&quot;frqbct_06_T1&quot;</span>,
  <span class="st">&quot;frqbct_07_T1&quot;</span>,
  <span class="st">&quot;frqbct_08_T1&quot;</span>,
  <span class="st">&quot;frqbct_09_T1&quot;</span>),
   <span class="dt">targets =</span> <span class="kw">c</span>(<span class="st">&quot;MVPA&quot;</span>, <span class="st">&quot;SB&quot;</span>),
  <span class="dt">leftAnchors =</span> <span class="kw">rep</span>(<span class="st">&quot;&quot;</span>, <span class="dv">19</span>),
  <span class="dt">rightAnchors =</span> <span class="kw">rep</span>(<span class="st">&quot;&quot;</span>, <span class="dv">19</span>))

userfriendlyscience<span class="op">::</span><span class="kw">CIBER</span>(<span class="dt">data =</span> d_num,
  <span class="dt">determinants =</span> <span class="kw">c</span>(
  <span class="st">&quot;autonomous_01_T1&quot;</span>,
  <span class="st">&quot;autonomous_02_T1&quot;</span>,
  <span class="st">&quot;autonomous_03_T1&quot;</span>,
  <span class="st">&quot;autonomous_04_T1&quot;</span>,
  <span class="st">&quot;autonomous_05_T1&quot;</span>,
  <span class="st">&quot;autonomous_06_T1&quot;</span>,
  <span class="st">&quot;autonomous_07_T1&quot;</span>,
  <span class="st">&quot;autonomous_08_T1&quot;</span>,
  <span class="st">&quot;autonomous_09_T1&quot;</span>),
   <span class="dt">targets =</span> <span class="kw">c</span>(<span class="st">&quot;MVPA&quot;</span>, <span class="st">&quot;SB&quot;</span>),
  <span class="dt">leftAnchors =</span> <span class="kw">rep</span>(<span class="st">&quot;&quot;</span>, <span class="dv">9</span>),
  <span class="dt">rightAnchors =</span> <span class="kw">rep</span>(<span class="st">&quot;&quot;</span>, <span class="dv">9</span>))

userfriendlyscience<span class="op">::</span><span class="kw">CIBER</span>(<span class="dt">data =</span> d_num,
  <span class="dt">determinants =</span> <span class="kw">c</span>(
  <span class="st">&quot;intention_01_T1&quot;</span>,
  <span class="st">&quot;intention_02_T1&quot;</span>,
  <span class="st">&quot;selfefficacy_01_T1&quot;</span>,
  <span class="st">&quot;selfefficacy_02_T1&quot;</span>,
  <span class="st">&quot;pbc_01_T1&quot;</span>,
  <span class="st">&quot;pbc_02_T1&quot;</span>,
  <span class="st">&quot;pbc_03_T1&quot;</span>,
  <span class="st">&quot;norm_01_T1&quot;</span>,
  <span class="st">&quot;norm_02_T1&quot;</span>,
  <span class="st">&quot;outcomeExpectations_01_T1&quot;</span>,
  <span class="st">&quot;outcomeExpectations_02_T1&quot;</span>,
  <span class="st">&quot;outcomeExpectations_03_T1&quot;</span>,
  <span class="st">&quot;outcomeExpectations_04_T1&quot;</span>,
  <span class="st">&quot;outcomeExpectations_05_T1&quot;</span>,
  <span class="st">&quot;outcomeExpectations_06_T1&quot;</span>,
  <span class="st">&quot;outcomeExpectations_07_T1&quot;</span>,
  <span class="st">&quot;outcomeExpectations_08_T1&quot;</span>,
  <span class="st">&quot;outcomeExpectations_09_T1&quot;</span>,
  <span class="st">&quot;outcomeExpectations_10_T1&quot;</span>,
  <span class="st">&quot;outcomeExpectations_11_T1&quot;</span>,
  <span class="st">&quot;outcomeExpectations_12_T1&quot;</span>),
   <span class="dt">targets =</span> <span class="kw">c</span>(<span class="st">&quot;MVPA&quot;</span>, <span class="st">&quot;SB&quot;</span>),
  <span class="dt">leftAnchors =</span> <span class="kw">rep</span>(<span class="st">&quot;&quot;</span>, <span class="dv">21</span>),
  <span class="dt">rightAnchors =</span> <span class="kw">rep</span>(<span class="st">&quot;&quot;</span>, <span class="dv">21</span>))</code></pre></div>
</div>
<div id="symptoms" class="section level1">
<h1>Symptoms</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">

<span class="co"># Create data frame</span>
densplot &lt;-<span class="st"> </span>df
<span class="kw">levels</span>(densplot<span class="op">$</span>intervention) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Control&quot;</span>, <span class="st">&quot;Intervention&quot;</span>)
<span class="kw">levels</span>(densplot<span class="op">$</span>girl) &lt;-<span class="st"> </span><span class="kw">recode</span>(densplot<span class="op">$</span>girl, <span class="st">&quot;boy&quot;</span> =<span class="st"> &quot;Boys&quot;</span>, <span class="st">&quot;girl&quot;</span> =<span class="st"> &quot;Girls&quot;</span>)

<span class="co"># This gives side-by-side plots. There&#39;s a third plot below the two, which is fake to include x-axis text.</span>
<span class="kw">layout</span>(<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">3</span>), <span class="dt">nrow =</span> <span class="dv">2</span>, <span class="dt">ncol =</span> <span class="dv">2</span>, <span class="dt">byrow =</span> <span class="ot">TRUE</span>),
       <span class="dt">widths =</span> <span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>),<span class="dt">heights =</span> <span class="kw">c</span>(<span class="fl">0.45</span>,<span class="fl">0.05</span>))

<span class="co"># Minimise whitespace; see https://stackoverflow.com/questions/15848942/how-to-reduce-space-gap-between-multiple-graphs-in-r</span>
<span class="kw">par</span>(<span class="dt">mai =</span> <span class="kw">c</span>(<span class="fl">0.3</span>, <span class="fl">0.3</span>, <span class="fl">0.1</span>, <span class="fl">0.0</span>)) 

## Girls vs. boys
<span class="co"># Choose only the variables needed and drop NA</span>
dens &lt;-<span class="st"> </span>densplot <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(symptom_T1, girl) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="kw">complete.cases</span>(.))

<span class="co"># Set random number generator for reproducibility of bootstrap test of equal densities</span>
<span class="kw">set.seed</span>(<span class="dv">10</span>)

<span class="co"># Make plot</span>
sm.symptom_T1_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">sm.density.compare2</span>(<span class="kw">as.numeric</span>(dens<span class="op">$</span>symptom_T1), 
                                               <span class="kw">as.factor</span>(dens<span class="op">$</span>girl), 
                                               <span class="dt">model =</span> <span class="st">&quot;equal&quot;</span>,
                                               <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>,
                                               <span class="dt">col =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end  =</span>  <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">1</span>)], 
                                               <span class="dt">lty =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>), <span class="dt">yaxt =</span> <span class="st">&quot;n&quot;</span>,
                                               <span class="dt">bandcol =</span> <span class="st">&#39;LightGray&#39;</span>, 
                                               <span class="dt">lwd =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>),
                                               <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">4</span>))
## 
## Test of equal densities:  p-value =  0
<span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="kw">levels</span>(dens<span class="op">$</span>girl), <span class="dt">col =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>)], <span class="dt">lty =</span> <span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">1</span>), <span class="dt">lwd =</span> (<span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>)))
<span class="kw">mtext</span>(<span class="dt">side =</span> <span class="dv">2</span>, <span class="st">&quot;Density&quot;</span>, <span class="dt">line =</span> <span class="fl">0.5</span>)

## Intervention vs. control
<span class="co"># Choose only the variables needed and drop NA</span>
dens &lt;-<span class="st"> </span>densplot <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(symptom_T1, intervention) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="kw">complete.cases</span>(.))

<span class="co"># Set random number generator for reproducibility of bootstrap test of equal densities</span>
<span class="kw">set.seed</span>(<span class="dv">10</span>)
<span class="co"># Make plot</span>
sm.symptom_T1_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">sm.density.compare2</span>(<span class="kw">as.numeric</span>(dens<span class="op">$</span>symptom_T1), 
                                               <span class="kw">as.factor</span>(dens<span class="op">$</span>intervention), 
                                               <span class="dt">model =</span> <span class="st">&quot;equal&quot;</span>, 
                                               <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>,
                                               <span class="dt">col =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">4</span>)], 
                                               <span class="dt">lty =</span> <span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">1</span>), <span class="dt">yaxt =</span> <span class="st">&quot;n&quot;</span>,
                                               <span class="dt">bandcol =</span> <span class="st">&#39;LightGray&#39;</span>, 
                                               <span class="dt">lwd =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>),
                                               <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">4</span>))
## 
## Test of equal densities:  p-value =  0.64
<span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="kw">levels</span>(dens<span class="op">$</span>intervention), <span class="dt">col =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">4</span>)], <span class="dt">lty=</span><span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">1</span>), <span class="dt">lwd=</span>(<span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>)))

<span class="co"># Create x-axis label. See https://stackoverflow.com/questions/11198767/how-to-annotate-across-or-between-plots-in-multi-plot-panels-in-r</span>
<span class="kw">par</span>(<span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>)) 
<span class="kw">plot</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dt">type =</span> <span class="st">&quot;n&quot;</span>, <span class="dt">frame.plot =</span> <span class="ot">FALSE</span>,<span class="dt">axes =</span> <span class="ot">FALSE</span>) <span class="co"># Fake plot</span>
<span class="kw">text</span>(<span class="dt">x =</span> <span class="fl">1.02</span>, <span class="dt">y =</span> <span class="fl">1.3</span>, <span class="dt">labels =</span> <span class="st">&quot;Symptom sumscore mean&quot;</span>, <span class="dt">pos =</span> <span class="dv">1</span>)</code></pre></div>
<p><img src="baseline-supplement_files/figure-html/sm-symptoms-1.png" width="2100" /></p>
<div id="symptom-histograms" class="section level2">
<h2>Symptom histograms</h2>
<div id="intervention-gender" class="section level3">
<h3>intervention / gender</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
sympGirls &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(id,
  intervention,
  group,
  school,
  girl,
  <span class="st">&quot;Neck and shoulder pain&quot;</span> =<span class="st"> </span>symptom_neckShoulderPain_T1,
  <span class="st">&quot;Lower back pain&quot;</span> =<span class="st"> </span>symptom_lowerBackPain_T1,
  <span class="st">&quot;Stomach ache&quot;</span> =<span class="st"> </span>symptom_stomachAche_T1,
  <span class="st">&quot;Tension or nervousness&quot;</span> =<span class="st"> </span>symptom_tensionNervousness_T1,
  <span class="st">&quot;Irritability or anger bursts&quot;</span> =<span class="st"> </span>symptom_irritabilityAngerbursts_T1,
  <span class="st">&quot;Difficulty with sleep&quot;</span> =<span class="st"> </span>symptom_sleepDifficulty_T1,
  <span class="st">&quot;Headache&quot;</span> =<span class="st"> </span>symptom_headAche_T1,
  <span class="st">&quot;Tiredness or faintness&quot;</span> =<span class="st"> </span>symptom_tirednessFaintness_T1) <span class="op">%&gt;%</span>
<span class="st"> </span>tidyr<span class="op">::</span><span class="kw">gather</span>(<span class="dt">key =</span> Variable, <span class="dt">value =</span> Value, <span class="dv">6</span><span class="op">:</span><span class="kw">ncol</span>(.)) <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(girl <span class="op">==</span><span class="st"> &quot;girl&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st"> </span>ggplot2<span class="op">::</span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Value, <span class="dt">y =</span> Variable, <span class="dt">group =</span> Variable)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">geom_density_ridges2</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> Variable), <span class="dt">stat =</span> <span class="st">&quot;binline&quot;</span>, <span class="dt">binwidth =</span> <span class="dv">1</span>, <span class="dt">scale =</span> <span class="fl">0.95</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>), <span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>),
                     <span class="dt">name =</span> <span class="st">&quot;&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_discrete</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>), <span class="dt">name =</span> <span class="st">&quot;&quot;</span>, <span class="dt">labels =</span> <span class="ot">NULL</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_fill_cyclical</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;darkolivegreen2&quot;</span>, <span class="st">&quot;darkolivegreen4&quot;</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Girls&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">guides</span>(<span class="dt">y =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">theme_ridges</span>(<span class="dt">grid =</span> <span class="ot">FALSE</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>),
        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>),
        <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>, <span class="dt">size =</span> <span class="dv">10</span>),
        <span class="dt">axis.text=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">10</span>, <span class="dt">face=</span><span class="st">&quot;bold&quot;</span>)) <span class="op">+</span>
<span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">4.5</span>))
## Warning: attributes are not identical across measure variables;
## they will be dropped

sympBoys &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(id,
  intervention,
  group,
  school,
  girl,
  <span class="st">&quot;Neck and shoulder pain&quot;</span> =<span class="st"> </span>symptom_neckShoulderPain_T1,
  <span class="st">&quot;Lower back pain&quot;</span> =<span class="st"> </span>symptom_lowerBackPain_T1,
  <span class="st">&quot;Stomach ache&quot;</span> =<span class="st"> </span>symptom_stomachAche_T1,
  <span class="st">&quot;Tension or nervousness&quot;</span> =<span class="st"> </span>symptom_tensionNervousness_T1,
  <span class="st">&quot;Irritability or anger bursts&quot;</span> =<span class="st"> </span>symptom_irritabilityAngerbursts_T1,
  <span class="st">&quot;Difficulty with sleep&quot;</span> =<span class="st"> </span>symptom_sleepDifficulty_T1,
  <span class="st">&quot;Headache&quot;</span> =<span class="st"> </span>symptom_headAche_T1,
  <span class="st">&quot;Tiredness or faintness&quot;</span> =<span class="st"> </span>symptom_tirednessFaintness_T1) <span class="op">%&gt;%</span>
<span class="st"> </span>tidyr<span class="op">::</span><span class="kw">gather</span>(<span class="dt">key =</span> Variable, <span class="dt">value =</span> Value, <span class="dv">6</span><span class="op">:</span><span class="kw">ncol</span>(.)) <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(girl <span class="op">==</span><span class="st"> &quot;boy&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st"> </span>ggplot2<span class="op">::</span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Value, <span class="dt">y =</span> Variable, <span class="dt">group =</span> Variable)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">geom_density_ridges2</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> Variable), <span class="dt">stat =</span> <span class="st">&quot;binline&quot;</span>, <span class="dt">binwidth =</span> <span class="dv">1</span>, <span class="dt">scale =</span> <span class="fl">0.95</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>), <span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>),
                     <span class="dt">name =</span> <span class="st">&quot;&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_discrete</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>), <span class="dt">name =</span> <span class="st">&quot;&quot;</span>, <span class="dt">labels =</span> <span class="ot">NULL</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_fill_cyclical</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;darkolivegreen2&quot;</span>, <span class="st">&quot;darkolivegreen4&quot;</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Boys&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">guides</span>(<span class="dt">y =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">theme_ridges</span>(<span class="dt">grid =</span> <span class="ot">FALSE</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>),
        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>),
        <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>, <span class="dt">size =</span> <span class="dv">10</span>),
        <span class="dt">axis.text=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">10</span>, <span class="dt">face=</span><span class="st">&quot;bold&quot;</span>)) <span class="op">+</span>
<span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">4.5</span>))
## Warning: attributes are not identical across measure variables;
## they will be dropped

sympInt &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(id,
  intervention,
  group,
  school,
  girl,
  <span class="st">&quot;Neck and shoulder pain&quot;</span> =<span class="st"> </span>symptom_neckShoulderPain_T1,
  <span class="st">&quot;Lower back pain&quot;</span> =<span class="st"> </span>symptom_lowerBackPain_T1,
  <span class="st">&quot;Stomach ache&quot;</span> =<span class="st"> </span>symptom_stomachAche_T1,
  <span class="st">&quot;Tension or nervousness&quot;</span> =<span class="st"> </span>symptom_tensionNervousness_T1,
  <span class="st">&quot;Irritability or anger bursts&quot;</span> =<span class="st"> </span>symptom_irritabilityAngerbursts_T1,
  <span class="st">&quot;Difficulty with sleep&quot;</span> =<span class="st"> </span>symptom_sleepDifficulty_T1,
  <span class="st">&quot;Headache&quot;</span> =<span class="st"> </span>symptom_headAche_T1,
  <span class="st">&quot;Tiredness or faintness&quot;</span> =<span class="st"> </span>symptom_tirednessFaintness_T1) <span class="op">%&gt;%</span>
<span class="st"> </span>tidyr<span class="op">::</span><span class="kw">gather</span>(<span class="dt">key =</span> Variable, <span class="dt">value =</span> Value, <span class="dv">6</span><span class="op">:</span><span class="kw">ncol</span>(.)) <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(intervention <span class="op">==</span><span class="st"> &quot;1&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st"> </span>ggplot2<span class="op">::</span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Value, <span class="dt">y =</span> Variable, <span class="dt">group =</span> Variable)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">geom_density_ridges2</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> Variable), <span class="dt">stat =</span> <span class="st">&quot;binline&quot;</span>, <span class="dt">binwidth =</span> <span class="dv">1</span>, <span class="dt">scale =</span> <span class="fl">0.95</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>), <span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>),
                     <span class="dt">name =</span> <span class="st">&quot;&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_discrete</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>), <span class="dt">name =</span> <span class="st">&quot;&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_fill_cyclical</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;deepskyblue&quot;</span>, <span class="st">&quot;deepskyblue4&quot;</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Intervention&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">guides</span>(<span class="dt">y =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">theme_ridges</span>(<span class="dt">grid =</span> <span class="ot">FALSE</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>),
        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>),
        <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>, <span class="dt">size =</span> <span class="dv">10</span>),
        <span class="dt">axis.text=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">10</span>)) <span class="op">+</span>
<span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">4.5</span>))
## Warning: attributes are not identical across measure variables;
## they will be dropped

sympCont &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(id,
  intervention,
  group,
  school,
  girl,
  <span class="st">&quot;Neck and shoulder pain&quot;</span> =<span class="st"> </span>symptom_neckShoulderPain_T1,
  <span class="st">&quot;Lower back pain&quot;</span> =<span class="st"> </span>symptom_lowerBackPain_T1,
  <span class="st">&quot;Stomach ache&quot;</span> =<span class="st"> </span>symptom_stomachAche_T1,
  <span class="st">&quot;Tension or nervousness&quot;</span> =<span class="st"> </span>symptom_tensionNervousness_T1,
  <span class="st">&quot;Irritability or anger bursts&quot;</span> =<span class="st"> </span>symptom_irritabilityAngerbursts_T1,
  <span class="st">&quot;Difficulty with sleep&quot;</span> =<span class="st"> </span>symptom_sleepDifficulty_T1,
  <span class="st">&quot;Headache&quot;</span> =<span class="st"> </span>symptom_headAche_T1,
  <span class="st">&quot;Tiredness or faintness&quot;</span> =<span class="st"> </span>symptom_tirednessFaintness_T1) <span class="op">%&gt;%</span>
<span class="st"> </span>tidyr<span class="op">::</span><span class="kw">gather</span>(<span class="dt">key =</span> Variable, <span class="dt">value =</span> Value, <span class="dv">6</span><span class="op">:</span><span class="kw">ncol</span>(.)) <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(intervention <span class="op">==</span><span class="st"> &quot;0&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st"> </span>ggplot2<span class="op">::</span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Value, <span class="dt">y =</span> Variable, <span class="dt">group =</span> Variable)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">geom_density_ridges2</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> Variable), <span class="dt">stat =</span> <span class="st">&quot;binline&quot;</span>, <span class="dt">binwidth =</span> <span class="dv">1</span>, <span class="dt">scale =</span> <span class="fl">0.95</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>), <span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>),
                     <span class="dt">name =</span> <span class="st">&quot;&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_discrete</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>), <span class="dt">name =</span> <span class="st">&quot;&quot;</span>, <span class="dt">labels =</span> <span class="ot">NULL</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_fill_cyclical</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;deepskyblue&quot;</span>, <span class="st">&quot;deepskyblue4&quot;</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Control&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">guides</span>(<span class="dt">y =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">theme_ridges</span>(<span class="dt">grid =</span> <span class="ot">FALSE</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>),
        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>),
        <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>, <span class="dt">size =</span> <span class="dv">10</span>),
        <span class="dt">axis.text=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">10</span>, <span class="dt">face=</span><span class="st">&quot;bold&quot;</span>)) <span class="op">+</span>
<span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">4.5</span>))
## Warning: attributes are not identical across measure variables;
## they will be dropped

<span class="co">#grid.arrange(sympInt, sympGirls, sympCont, sympBoys, ncol = 2)</span>

<span class="co"># (&quot;Seldom or never&quot;, &quot;About once a month&quot;, &quot;About once a week&quot;, &quot;Almost daily&quot;)</span>

<span class="co"># This draws all histograms next to each other:</span>
grid<span class="op">::</span><span class="kw">grid.newpage</span>()
grid<span class="op">::</span><span class="kw">grid.draw</span>(<span class="kw">cbind</span>(ggplot2<span class="op">::</span><span class="kw">ggplotGrob</span>(sympInt), ggplot2<span class="op">::</span><span class="kw">ggplotGrob</span>(sympCont), ggplot2<span class="op">::</span><span class="kw">ggplotGrob</span>(sympGirls), ggplot2<span class="op">::</span><span class="kw">ggplotGrob</span>(sympBoys), <span class="dt">size =</span> <span class="st">&quot;last&quot;</span>))
## Warning: Removed 198 rows containing non-finite values (stat_binline).
## Warning: Removed 93 rows containing non-finite values (stat_binline).
## Warning: Removed 197 rows containing non-finite values (stat_binline).
## Warning: Removed 94 rows containing non-finite values (stat_binline).</code></pre></div>
<p><img src="baseline-supplement_files/figure-html/symptom-histogram-ivgender-1.png" width="2100" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># This draws 2 histograms per row:</span>
<span class="co">#grid.newpage()</span>
<span class="co">#grid.draw(rbind(cbind(ggplot2::ggplotGrob(sympInt), ggplot2::ggplotGrob(sympCont), size = &quot;last&quot;), cbind(ggplot2::ggplotGrob(sympGirls), ggplot2::ggplotGrob(sympBoys), size = &quot;last&quot;)))</span></code></pre></div>
</div>
<div id="educational-track" class="section level3">
<h3>educational track</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">trackColors &lt;-<span class="st"> </span>viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">13</span>)

sympHRC &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(id,
  intervention,
  track,
  school,
  girl,
  <span class="st">&quot;Neck and shoulder pain&quot;</span> =<span class="st"> </span>symptom_neckShoulderPain_T1,
  <span class="st">&quot;Lower back pain&quot;</span> =<span class="st"> </span>symptom_lowerBackPain_T1,
  <span class="st">&quot;Stomach ache&quot;</span> =<span class="st"> </span>symptom_stomachAche_T1,
  <span class="st">&quot;Tension or nervousness&quot;</span> =<span class="st"> </span>symptom_tensionNervousness_T1,
  <span class="st">&quot;Irritability or anger bursts&quot;</span> =<span class="st"> </span>symptom_irritabilityAngerbursts_T1,
  <span class="st">&quot;Difficulty with sleep&quot;</span> =<span class="st"> </span>symptom_sleepDifficulty_T1,
  <span class="st">&quot;Headache&quot;</span> =<span class="st"> </span>symptom_headAche_T1,
  <span class="st">&quot;Tiredness or faintness&quot;</span> =<span class="st"> </span>symptom_tirednessFaintness_T1) <span class="op">%&gt;%</span>
<span class="st"> </span>tidyr<span class="op">::</span><span class="kw">gather</span>(<span class="dt">key =</span> Variable, <span class="dt">value =</span> Value, <span class="dv">6</span><span class="op">:</span><span class="kw">ncol</span>(.)) <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;HRC&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st"> </span>ggplot2<span class="op">::</span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Value, <span class="dt">y =</span> Variable, <span class="dt">group =</span> Variable)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">geom_density_ridges2</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> Variable), <span class="dt">stat =</span> <span class="st">&quot;binline&quot;</span>, <span class="dt">binwidth =</span> <span class="dv">1</span>, <span class="dt">scale =</span> <span class="fl">0.95</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>), <span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>),
                     <span class="dt">name =</span> <span class="st">&quot;&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_discrete</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>), <span class="dt">name =</span> <span class="st">&quot;&quot;</span>, <span class="dt">labels =</span> <span class="ot">NULL</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_fill_cyclical</span>(<span class="dt">values =</span> trackColors[<span class="dv">4</span><span class="op">:</span><span class="dv">5</span>]) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;HRC&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">guides</span>(<span class="dt">y =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">theme_ridges</span>(<span class="dt">grid =</span> <span class="ot">FALSE</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>),
        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>),
        <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>, <span class="dt">size =</span> <span class="dv">10</span>),
        <span class="dt">axis.text=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">10</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">4.5</span>))
## Warning: attributes are not identical across measure variables;
## they will be dropped

sympNur &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(id,
  intervention,
  track,
  school,
  girl,
  <span class="st">&quot;Neck and shoulder pain&quot;</span> =<span class="st"> </span>symptom_neckShoulderPain_T1,
  <span class="st">&quot;Lower back pain&quot;</span> =<span class="st"> </span>symptom_lowerBackPain_T1,
  <span class="st">&quot;Stomach ache&quot;</span> =<span class="st"> </span>symptom_stomachAche_T1,
  <span class="st">&quot;Tension or nervousness&quot;</span> =<span class="st"> </span>symptom_tensionNervousness_T1,
  <span class="st">&quot;Irritability or anger bursts&quot;</span> =<span class="st"> </span>symptom_irritabilityAngerbursts_T1,
  <span class="st">&quot;Difficulty with sleep&quot;</span> =<span class="st"> </span>symptom_sleepDifficulty_T1,
  <span class="st">&quot;Headache&quot;</span> =<span class="st"> </span>symptom_headAche_T1,
  <span class="st">&quot;Tiredness or faintness&quot;</span> =<span class="st"> </span>symptom_tirednessFaintness_T1) <span class="op">%&gt;%</span>
<span class="st"> </span>tidyr<span class="op">::</span><span class="kw">gather</span>(<span class="dt">key =</span> Variable, <span class="dt">value =</span> Value, <span class="dv">6</span><span class="op">:</span><span class="kw">ncol</span>(.)) <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;Nur&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st"> </span>ggplot2<span class="op">::</span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Value, <span class="dt">y =</span> Variable, <span class="dt">group =</span> Variable)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">geom_density_ridges2</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> Variable), <span class="dt">stat =</span> <span class="st">&quot;binline&quot;</span>, <span class="dt">binwidth =</span> <span class="dv">1</span>, <span class="dt">scale =</span> <span class="fl">0.95</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>), <span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>),
                     <span class="dt">name =</span> <span class="st">&quot;&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_discrete</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>), <span class="dt">name =</span> <span class="st">&quot;&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_fill_cyclical</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="dt">values =</span> trackColors[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>])) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Nur&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">guides</span>(<span class="dt">y =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">theme_ridges</span>(<span class="dt">grid =</span> <span class="ot">FALSE</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>),
        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>),
        <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>, <span class="dt">size =</span> <span class="dv">10</span>),
        <span class="dt">axis.text=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">10</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">4.5</span>))
## Warning: attributes are not identical across measure variables;
## they will be dropped

sympIT &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(id,
  intervention,
  track,
  school,
  girl,
  <span class="st">&quot;Neck and shoulder pain&quot;</span> =<span class="st"> </span>symptom_neckShoulderPain_T1,
  <span class="st">&quot;Lower back pain&quot;</span> =<span class="st"> </span>symptom_lowerBackPain_T1,
  <span class="st">&quot;Stomach ache&quot;</span> =<span class="st"> </span>symptom_stomachAche_T1,
  <span class="st">&quot;Tension or nervousness&quot;</span> =<span class="st"> </span>symptom_tensionNervousness_T1,
  <span class="st">&quot;Irritability or anger bursts&quot;</span> =<span class="st"> </span>symptom_irritabilityAngerbursts_T1,
  <span class="st">&quot;Difficulty with sleep&quot;</span> =<span class="st"> </span>symptom_sleepDifficulty_T1,
  <span class="st">&quot;Headache&quot;</span> =<span class="st"> </span>symptom_headAche_T1,
  <span class="st">&quot;Tiredness or faintness&quot;</span> =<span class="st"> </span>symptom_tirednessFaintness_T1) <span class="op">%&gt;%</span>
<span class="st"> </span>tidyr<span class="op">::</span><span class="kw">gather</span>(<span class="dt">key =</span> Variable, <span class="dt">value =</span> Value, <span class="dv">6</span><span class="op">:</span><span class="kw">ncol</span>(.)) <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;IT&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st"> </span>ggplot2<span class="op">::</span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Value, <span class="dt">y =</span> Variable, <span class="dt">group =</span> Variable)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">geom_density_ridges2</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> Variable), <span class="dt">stat =</span> <span class="st">&quot;binline&quot;</span>, <span class="dt">binwidth =</span> <span class="dv">1</span>, <span class="dt">scale =</span> <span class="fl">0.95</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>), <span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>),
                     <span class="dt">name =</span> <span class="st">&quot;&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_discrete</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>), <span class="dt">name =</span> <span class="st">&quot;&quot;</span>, <span class="dt">labels =</span> <span class="ot">NULL</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_fill_cyclical</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="dt">values =</span> trackColors[<span class="dv">12</span><span class="op">:</span><span class="dv">13</span>])) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;IT&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">guides</span>(<span class="dt">y =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">theme_ridges</span>(<span class="dt">grid =</span> <span class="ot">FALSE</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>),
        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>),
        <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>, <span class="dt">size =</span> <span class="dv">10</span>),
        <span class="dt">axis.text=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">10</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">4.5</span>))
## Warning: attributes are not identical across measure variables;
## they will be dropped

sympBA &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(id,
  intervention,
  track,
  school,
  girl,
  <span class="st">&quot;Neck and shoulder pain&quot;</span> =<span class="st"> </span>symptom_neckShoulderPain_T1,
  <span class="st">&quot;Lower back pain&quot;</span> =<span class="st"> </span>symptom_lowerBackPain_T1,
  <span class="st">&quot;Stomach ache&quot;</span> =<span class="st"> </span>symptom_stomachAche_T1,
  <span class="st">&quot;Tension or nervousness&quot;</span> =<span class="st"> </span>symptom_tensionNervousness_T1,
  <span class="st">&quot;Irritability or anger bursts&quot;</span> =<span class="st"> </span>symptom_irritabilityAngerbursts_T1,
  <span class="st">&quot;Difficulty with sleep&quot;</span> =<span class="st"> </span>symptom_sleepDifficulty_T1,
  <span class="st">&quot;Headache&quot;</span> =<span class="st"> </span>symptom_headAche_T1,
  <span class="st">&quot;Tiredness or faintness&quot;</span> =<span class="st"> </span>symptom_tirednessFaintness_T1) <span class="op">%&gt;%</span>
<span class="st"> </span>tidyr<span class="op">::</span><span class="kw">gather</span>(<span class="dt">key =</span> Variable, <span class="dt">value =</span> Value, <span class="dv">6</span><span class="op">:</span><span class="kw">ncol</span>(.)) <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;BA&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st"> </span>ggplot2<span class="op">::</span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Value, <span class="dt">y =</span> Variable, <span class="dt">group =</span> Variable)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">geom_density_ridges2</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> Variable), <span class="dt">stat =</span> <span class="st">&quot;binline&quot;</span>, <span class="dt">binwidth =</span> <span class="dv">1</span>, <span class="dt">scale =</span> <span class="fl">0.95</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>), <span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>),
                     <span class="dt">name =</span> <span class="st">&quot;&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_discrete</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>), <span class="dt">name =</span> <span class="st">&quot;&quot;</span>, <span class="dt">labels =</span> <span class="ot">NULL</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_fill_cyclical</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="dt">values =</span> trackColors[<span class="dv">8</span><span class="op">:</span><span class="dv">9</span>])) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;BA&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">guides</span>(<span class="dt">y =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">theme_ridges</span>(<span class="dt">grid =</span> <span class="ot">FALSE</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>),
        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>),
        <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>, <span class="dt">size =</span> <span class="dv">10</span>),
        <span class="dt">axis.text=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">10</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">4.5</span>))
## Warning: attributes are not identical across measure variables;
## they will be dropped

<span class="co">#grid.arrange(sympIT, sympHRC, sympBA, sympNur, ncol = 2)</span>

<span class="co"># (&quot;Seldom or never&quot;, &quot;About once a month&quot;, &quot;About once a week&quot;, &quot;Almost daily&quot;)</span>

<span class="co"># This draws all histograms next to each other:</span>
<span class="co"># grid::grid.newpage()</span>
<span class="co"># grid::grid.draw(cbind(ggplot2::ggplotGrob(sympIT), ggplot2::ggplotGrob(sympBA), ggplot2::ggplotGrob(sympHRC), ggplot2::ggplotGrob(sympNur), size = &quot;last&quot;))</span>

<span class="co"># This draws 2 histograms per row:</span>
<span class="co">#grid.newpage()</span>
<span class="co">#grid.draw(rbind(cbind(ggplot2::ggplotGrob(sympIT), ggplot2::ggplotGrob(sympBA), size = &quot;last&quot;), cbind(ggplot2::ggplotGrob(sympHRC), ggplot2::ggplotGrob(sympNur), size = &quot;last&quot;)))</span>

(sympNur <span class="op">|</span><span class="st"> </span>sympHRC <span class="op">|</span><span class="st"> </span>sympBA <span class="op">|</span><span class="st"> </span>sympIT)
## Warning: Removed 141 rows containing non-finite values (stat_binline).
## Warning: Removed 49 rows containing non-finite values (stat_binline).

## Warning: Removed 49 rows containing non-finite values (stat_binline).
## Warning: Removed 26 rows containing non-finite values (stat_binline).</code></pre></div>
<p><img src="baseline-supplement_files/figure-html/symptom-histogram-edutracks-1.png" width="2100" /></p>
</div>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
