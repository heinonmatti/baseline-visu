<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title>Baseline analysis supplement</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>


</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 66px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 71px;
  margin-top: -71px;
}

.section h2 {
  padding-top: 71px;
  margin-top: -71px;
}
.section h3 {
  padding-top: 71px;
  margin-top: -71px;
}
.section h4 {
  padding-top: 71px;
  margin-top: -71px;
}
.section h5 {
  padding-top: 71px;
  margin-top: -71px;
}
.section h6 {
  padding-top: 71px;
  margin-top: -71px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>




<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
  padding-left: 25px;
  text-indent: 0;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>

<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Visualising baseline characteristics</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">About</a>
</li>
<li>
  <a href="manuscript/baseline-manuscript.pdf">Manuscript</a>
</li>
<li>
  <a href="baseline-supplement.html">Descriptives</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">

<div class="btn-group pull-right">
<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Baseline analysis supplement</h1>

</div>


<p>Welcome to the LMI baseline supplement! This supplement will walk you through the paper and provides additional graphs.</p>
<div id="measures-used-in-the-study" class="section level1">
<h1>Measures used in the study</h1>
<p>Clicking the “Code”-buttons on the right shows code for each chunk.</p>
<p>To start data analysis, we set up the basics to enable compiling the document:</p>
<pre class="r"><code>source(&quot;baseline-datasetup.R&quot;)</code></pre>
</div>
<div id="means-with-cis-taking-clustering-into-account" class="section level1 tabset">
<h1>Means with CIs taking clustering into account</h1>
<div id="description" class="section level2">
<h2>Description</h2>
<p>The code chunks create linear models for all variables. The results are used to estimate confidence intervals and intra-class correlations (ICC).</p>
<p>Browse throught the tabs above to see different information.</p>
<p>Code chunk below shows how the values are calculated.</p>
<pre class="r"><code># Create a vector with all names of the variables we want. Exclude T3 variables.
names &lt;- df %&gt;% select(-id, -intervention, -group, -school, -girl, -track, -trackSchool, -contains(&quot;_T3&quot;), -contains(&quot;_diff&quot;)) %&gt;% names(.)

# Create empty soon-to-be-filled objects
m &lt;- NA
mean &lt;- NA
m_p &lt;- NA
ci_low &lt;- NA
ci_high &lt;- NA
ICC_group &lt;- NA
ICC_School &lt;- NA
nonmissings &lt;- NA

## Use this to test a single variable:
# dftest &lt;- df #%&gt;% na.omit()
# m &lt;- lme4::lmer(sitLieAccelerometer_diff ~ (1|school) + (1|group), data=dftest)
# mean &lt;- lme4::fixef(m)
# m_p &lt;- profile(m, which = &quot;beta_&quot;)
# ci_low &lt;- confint(m_p)[, 1]
# ci_high &lt;- confint(m_p)[, 2]
# ICC_group &lt;- icc(m)[1]
# ICC_School &lt;- icc(m)[2]
# nonmissings &lt;- length(m@resp$y)


# Loop over each variable name, extract statistics: 

# all participants
# for (i in names){
# m &lt;- lme4::lmer(paste0(i,&quot; ~ (1|school) + (1|group)&quot;), data=df)
# mean[i] &lt;- lme4::fixef(m)
# m_p &lt;- profile(m, which = &quot;beta_&quot;)
# ci_low[i] &lt;- confint(m_p)[, 1]
# ci_high[i] &lt;- confint(m_p)[, 2]
# ICC_group[i] &lt;- sjstats::icc(m)[1]
# ICC_School[i] &lt;- sjstats::icc(m)[2]
# nonmissings[i] &lt;- length(m@resp$y)
# }
# 
# 
# vardatatable &lt;- data_frame(
#   Variable = stringr::str_sub(names(mean), end = -4), #remove &quot;_T1&quot; from names
#   &quot;Mean&quot; = round(mean, 1),
#   &quot;CI95&quot; = paste(round(ci_low, 1), &quot; - &quot;, round(ci_high, 2)), 
#   &quot;ICC class&quot; =ifelse(round(ICC_group, 3) == 0, &quot;&lt; 0.001&quot;, round(ICC_group, 3)), 
#   &quot;ICC school&quot; = ifelse(round(ICC_School, 3) == 0, &quot;&lt; 0.001&quot;, round(ICC_School, 3)),
#   n = nonmissings) %&gt;% 
#   dplyr::arrange(Variable) %&gt;% 
#   filter(Variable != &quot;&quot;) %&gt;% #remove first row, which is empty
#   mutate(`ICC class` = as.numeric(`ICC class`)) %&gt;% 
#   as.data.frame()
# 
# ci_total &lt;- data_frame(
#   &quot;ciLo&quot; = ci_low,
#   &quot;mean&quot; = mean,
#   &quot;ciHi&quot; = ci_high,  
#   &quot;diamondlabels&quot; = names(mean)) %&gt;%  
#   filter(diamondlabels != &quot;&quot;) %&gt;% #remove first row, which is empty
#   as.data.frame()

# save(vardatatable, file = &quot;vardatatable.Rdata&quot;)
# save(ci_total, file = &quot;ci_total.Rdata&quot;)
load(&quot;vardatatable.Rdata&quot;)
load(&quot;ci_total.Rdata&quot;)</code></pre>
</div>
<div id="primary-outcome-variables" class="section level2">
<h2>Primary outcome variables</h2>
<div id="plot-of-self-reported-and-accelerometer-measured-mvpa-variables" class="section level3">
<h3>Plot of self-reported and accelerometer-measured MVPA-variables</h3>
</div>
</div>
</div>
<div id="red-line-is-for-the-cutoff" class="section level1">
<h1>!!! Red line is for the cutoff</h1>
<pre class="r"><code>lmi %&gt;% ggplot2::ggplot(aes(x = LiikuntaT1_ka, y = Kys0045.1)) + geom_point() + geom_smooth(method = &quot;loess&quot;) +
  geom_vline(xintercept = 120, col = &quot;red&quot;) +
  labs(x = &quot;accelerometer-measured MVPA&quot;, y = &quot;self-reported MVPA days last week&quot;)
## Don&#39;t know how to automatically pick scale for object of type labelled. Defaulting to continuous.
## Warning: Removed 459 rows containing non-finite values (stat_smooth).
## Warning: Removed 459 rows containing missing values (geom_point).</code></pre>
<p><img src="baseline-supplement_files/figure-html/unnamed-chunk-2-1.png" width="2100" /></p>
<pre class="r"><code>options(tibble.print_max = 1000)

vardatatable2 &lt;- vardatatable
vardatatable2$Variable &lt;- gsub(&quot;paAccelerometer&quot;, &quot;PA minutes&quot;, vardatatable2$Variable)
vardatatable2$Variable &lt;- gsub(&quot;padaysLastweek&quot;, &quot;Number of MVPA days last week (self-report)&quot;, vardatatable2$Variable)
vardatatable2$Variable &lt;- gsub(&quot;sitLieAccelerometer&quot;, &quot;Minutes spent sitting or lying down&quot;, vardatatable2$Variable)
vardatatable2$Variable &lt;- gsub(&quot;sitBreaks&quot;, &quot;Number of times sitting was interrupted&quot;, vardatatable2$Variable)

vardatatable2 %&gt;% 
  filter(Variable == &quot;MVPA minutes&quot; | 
           Variable == &quot;Number of MVPA days last week (self-report)&quot; | 
           Variable == &quot;Daily minutes spent sitting or lying down&quot; | 
           Variable == &quot;Number of times sitting was interrupted daily&quot; ) %&gt;% 
    papaja::apa_table(
        caption = &quot;Primary outcome variables with their class and school ICCs&quot;,
        escape = T,
        format.args = list(digits = c(1, 3, 0), margin = 2))</code></pre>
<caption>
(#tab:selected-total)
</caption>
<caption>
<em>Primary outcome variables with their class and school ICCs</em>
</caption>
<table>
<thead>
<tr class="header">
<th align="left">Variable</th>
<th align="left">Mean</th>
<th align="left">CI95</th>
<th align="left">ICC class</th>
<th align="left">ICC school</th>
<th align="left">n</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Number of MVPA days last week (self-report)</td>
<td align="left">2.8</td>
<td align="left">2.6  -  2.95</td>
<td align="left">0.047</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,082</td>
</tr>
</tbody>
</table>
<div id="all-main-variables-their-means-cis-and-iccs." class="section level2">
<h2>All main variables, their means, CIs and ICCs.</h2>
<pre class="r"><code>options(tibble.print_max = 1000)
 
vardatatable %&gt;%
    papaja::apa_table(
        caption = &quot;All variables with their class and school ICCs&quot;,
        escape = T,
        format.args = list(digits = c(1, 3, 0), margin = 2))</code></pre>
<caption>
(#tab:allvars-total)
</caption>
<caption>
<em>All variables with their class and school ICCs</em>
</caption>
<table>
<thead>
<tr class="header">
<th align="left">Variable</th>
<th align="left">Mean</th>
<th align="left">CI95</th>
<th align="left">ICC class</th>
<th align="left">ICC school</th>
<th align="left">n</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">b5agr</td>
<td align="left">5.3</td>
<td align="left">5.2  -  5.5</td>
<td align="left">0.033</td>
<td align="left">0.012</td>
<td align="left">1,068</td>
</tr>
<tr class="even">
<td align="left">b5agr_01</td>
<td align="left">5.5</td>
<td align="left">5.4  -  5.66</td>
<td align="left">0.045</td>
<td align="left">0.002</td>
<td align="left">1,061</td>
</tr>
<tr class="odd">
<td align="left">b5agrReverseCoded_02</td>
<td align="left">5.2</td>
<td align="left">5  -  5.37</td>
<td align="left">0.005</td>
<td align="left">0.01</td>
<td align="left">1,064</td>
</tr>
<tr class="even">
<td align="left">b5cons</td>
<td align="left">5.0</td>
<td align="left">4.9  -  5.17</td>
<td align="left">NA</td>
<td align="left">0.007</td>
<td align="left">1,067</td>
</tr>
<tr class="odd">
<td align="left">b5cons_01</td>
<td align="left">5.4</td>
<td align="left">5.2  -  5.65</td>
<td align="left">0.014</td>
<td align="left">0.015</td>
<td align="left">1,059</td>
</tr>
<tr class="even">
<td align="left">b5consReverseCoded_02</td>
<td align="left">4.6</td>
<td align="left">4.5  -  4.78</td>
<td align="left">NA</td>
<td align="left">0.002</td>
<td align="left">1,065</td>
</tr>
<tr class="odd">
<td align="left">b5ext</td>
<td align="left">4.5</td>
<td align="left">4.3  -  4.77</td>
<td align="left">0.020</td>
<td align="left">0.022</td>
<td align="left">1,068</td>
</tr>
<tr class="even">
<td align="left">b5ext_01</td>
<td align="left">5.0</td>
<td align="left">4.7  -  5.24</td>
<td align="left">0.048</td>
<td align="left">0.013</td>
<td align="left">1,063</td>
</tr>
<tr class="odd">
<td align="left">b5extReverseCoded_02</td>
<td align="left">4.1</td>
<td align="left">3.8  -  4.32</td>
<td align="left">0.002</td>
<td align="left">0.012</td>
<td align="left">1,062</td>
</tr>
<tr class="even">
<td align="left">b5neur</td>
<td align="left">3.8</td>
<td align="left">3.6  -  4</td>
<td align="left">0.014</td>
<td align="left">0.012</td>
<td align="left">1,068</td>
</tr>
<tr class="odd">
<td align="left">b5neur_01</td>
<td align="left">4.1</td>
<td align="left">3.8  -  4.39</td>
<td align="left">0.017</td>
<td align="left">0.014</td>
<td align="left">1,064</td>
</tr>
<tr class="even">
<td align="left">b5neurReverseCoded_02</td>
<td align="left">3.5</td>
<td align="left">3.4  -  3.67</td>
<td align="left">0.011</td>
<td align="left">0.002</td>
<td align="left">1,061</td>
</tr>
<tr class="odd">
<td align="left">b5open</td>
<td align="left">4.9</td>
<td align="left">4.7  -  5.12</td>
<td align="left">0.010</td>
<td align="left">0.03</td>
<td align="left">1,068</td>
</tr>
<tr class="even">
<td align="left">b5open_01</td>
<td align="left">5.4</td>
<td align="left">5.1  -  5.59</td>
<td align="left">0.025</td>
<td align="left">0.016</td>
<td align="left">1,062</td>
</tr>
<tr class="odd">
<td align="left">b5openReverseCoded_02</td>
<td align="left">4.4</td>
<td align="left">4.2  -  4.67</td>
<td align="left">NA</td>
<td align="left">0.016</td>
<td align="left">1,066</td>
</tr>
<tr class="even">
<td align="left">fatpct</td>
<td align="left">25.5</td>
<td align="left">22.4  -  28.67</td>
<td align="left">0.003</td>
<td align="left">0.123</td>
<td align="left">942</td>
</tr>
<tr class="odd">
<td align="left">PA_actCop</td>
<td align="left">2.6</td>
<td align="left">2.6  -  2.69</td>
<td align="left">0.035</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,073</td>
</tr>
<tr class="even">
<td align="left">PA_actionplan</td>
<td align="left">2.8</td>
<td align="left">2.7  -  2.83</td>
<td align="left">0.038</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,073</td>
</tr>
<tr class="odd">
<td align="left">PA_actplan_01</td>
<td align="left">2.6</td>
<td align="left">2.5  -  2.68</td>
<td align="left">0.032</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,073</td>
</tr>
<tr class="even">
<td align="left">PA_actplan_02</td>
<td align="left">2.8</td>
<td align="left">2.7  -  2.88</td>
<td align="left">0.028</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,073</td>
</tr>
<tr class="odd">
<td align="left">PA_actplan_03</td>
<td align="left">2.9</td>
<td align="left">2.8  -  2.93</td>
<td align="left">0.037</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,073</td>
</tr>
<tr class="even">
<td align="left">PA_actplan_04</td>
<td align="left">2.8</td>
<td align="left">2.7  -  2.86</td>
<td align="left">0.038</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,073</td>
</tr>
<tr class="odd">
<td align="left">PA_agrbct</td>
<td align="left">3.1</td>
<td align="left">3  -  3.23</td>
<td align="left">0.052</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,071</td>
</tr>
<tr class="even">
<td align="left">PA_agrbct_01</td>
<td align="left">3.7</td>
<td align="left">3.5  -  3.85</td>
<td align="left">0.061</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,071</td>
</tr>
<tr class="odd">
<td align="left">PA_agrbct_02</td>
<td align="left">3.2</td>
<td align="left">3  -  3.33</td>
<td align="left">0.025</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,071</td>
</tr>
<tr class="even">
<td align="left">PA_agrbct_03</td>
<td align="left">2.4</td>
<td align="left">2.3  -  2.57</td>
<td align="left">0.009</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,071</td>
</tr>
<tr class="odd">
<td align="left">PA_agrbct_04</td>
<td align="left">2.5</td>
<td align="left">2.4  -  2.67</td>
<td align="left">0.035</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,071</td>
</tr>
<tr class="even">
<td align="left">PA_agrbct_05</td>
<td align="left">2.6</td>
<td align="left">2.5  -  2.78</td>
<td align="left">0.055</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,071</td>
</tr>
<tr class="odd">
<td align="left">PA_agrbct_06</td>
<td align="left">3.2</td>
<td align="left">3.1  -  3.38</td>
<td align="left">0.028</td>
<td align="left">0.001</td>
<td align="left">1,071</td>
</tr>
<tr class="even">
<td align="left">PA_agrbct_07</td>
<td align="left">3.0</td>
<td align="left">2.9  -  3.16</td>
<td align="left">0.022</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,071</td>
</tr>
<tr class="odd">
<td align="left">PA_agrbct_08</td>
<td align="left">3.1</td>
<td align="left">3  -  3.25</td>
<td align="left">0.023</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,071</td>
</tr>
<tr class="even">
<td align="left">PA_agrbct_09</td>
<td align="left">3.7</td>
<td align="left">3.5  -  3.85</td>
<td align="left">0.032</td>
<td align="left">0.001</td>
<td align="left">1,071</td>
</tr>
<tr class="odd">
<td align="left">PA_agrbct_10</td>
<td align="left">3.6</td>
<td align="left">3.5  -  3.79</td>
<td align="left">0.044</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,071</td>
</tr>
<tr class="even">
<td align="left">PA_amotivation</td>
<td align="left">1.5</td>
<td align="left">1.5  -  1.61</td>
<td align="left">0.035</td>
<td align="left">0.002</td>
<td align="left">1,072</td>
</tr>
<tr class="odd">
<td align="left">PA_amotivation_01</td>
<td align="left">1.5</td>
<td align="left">1.4  -  1.59</td>
<td align="left">0.031</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,062</td>
</tr>
<tr class="even">
<td align="left">PA_amotivation_02</td>
<td align="left">1.5</td>
<td align="left">1.4  -  1.63</td>
<td align="left">0.026</td>
<td align="left">0.005</td>
<td align="left">1,057</td>
</tr>
<tr class="odd">
<td align="left">PA_amotivation_03</td>
<td align="left">1.6</td>
<td align="left">1.5  -  1.69</td>
<td align="left">0.032</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,067</td>
</tr>
<tr class="even">
<td align="left">PA_amotivation_04</td>
<td align="left">1.5</td>
<td align="left">1.4  -  1.55</td>
<td align="left">0.027</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,066</td>
</tr>
<tr class="odd">
<td align="left">PA_autonomous</td>
<td align="left">3.4</td>
<td align="left">3.3  -  3.52</td>
<td align="left">0.073</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,078</td>
</tr>
<tr class="even">
<td align="left">PA_autonomous_01</td>
<td align="left">3.1</td>
<td align="left">3  -  3.29</td>
<td align="left">0.002</td>
<td align="left">0.012</td>
<td align="left">1,063</td>
</tr>
<tr class="odd">
<td align="left">PA_autonomous_02</td>
<td align="left">3.8</td>
<td align="left">3.7  -  3.86</td>
<td align="left">0.031</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,063</td>
</tr>
<tr class="even">
<td align="left">PA_autonomous_03</td>
<td align="left">3.4</td>
<td align="left">3.2  -  3.51</td>
<td align="left">0.058</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,070</td>
</tr>
<tr class="odd">
<td align="left">PA_autonomous_04</td>
<td align="left">3.3</td>
<td align="left">3.2  -  3.47</td>
<td align="left">0.059</td>
<td align="left">0.004</td>
<td align="left">1,070</td>
</tr>
<tr class="even">
<td align="left">PA_autonomous_05</td>
<td align="left">3.3</td>
<td align="left">3.1  -  3.39</td>
<td align="left">0.048</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,062</td>
</tr>
<tr class="odd">
<td align="left">PA_autonomous_06</td>
<td align="left">3.1</td>
<td align="left">3  -  3.22</td>
<td align="left">0.072</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,066</td>
</tr>
<tr class="even">
<td align="left">PA_autonomous_07</td>
<td align="left">3.7</td>
<td align="left">3.6  -  3.88</td>
<td align="left">0.072</td>
<td align="left">0.005</td>
<td align="left">1,070</td>
</tr>
<tr class="odd">
<td align="left">PA_autonomous_08</td>
<td align="left">3.6</td>
<td align="left">3.5  -  3.76</td>
<td align="left">0.057</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,066</td>
</tr>
<tr class="even">
<td align="left">PA_autonomous_09</td>
<td align="left">3.5</td>
<td align="left">3.4  -  3.62</td>
<td align="left">0.055</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,057</td>
</tr>
<tr class="odd">
<td align="left">PA_controlled</td>
<td align="left">1.8</td>
<td align="left">1.8  -  1.9</td>
<td align="left">0.005</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,073</td>
</tr>
<tr class="even">
<td align="left">PA_controlled_01</td>
<td align="left">1.7</td>
<td align="left">1.6  -  1.73</td>
<td align="left">0.010</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,068</td>
</tr>
<tr class="odd">
<td align="left">PA_controlled_02</td>
<td align="left">1.5</td>
<td align="left">1.4  -  1.55</td>
<td align="left">0.024</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,069</td>
</tr>
<tr class="even">
<td align="left">PA_controlled_03</td>
<td align="left">1.5</td>
<td align="left">1.5  -  1.61</td>
<td align="left">0.011</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,064</td>
</tr>
<tr class="odd">
<td align="left">PA_controlled_04</td>
<td align="left">2.2</td>
<td align="left">2.1  -  2.28</td>
<td align="left">NA</td>
<td align="left">0.001</td>
<td align="left">1,068</td>
</tr>
<tr class="even">
<td align="left">PA_controlled_05</td>
<td align="left">2.3</td>
<td align="left">2.2  -  2.4</td>
<td align="left">0.006</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,066</td>
</tr>
<tr class="odd">
<td align="left">PA_copingplan</td>
<td align="left">2.5</td>
<td align="left">2.4  -  2.56</td>
<td align="left">0.023</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,073</td>
</tr>
<tr class="even">
<td align="left">PA_copplan_01</td>
<td align="left">2.4</td>
<td align="left">2.3  -  2.47</td>
<td align="left">0.007</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,073</td>
</tr>
<tr class="odd">
<td align="left">PA_copplan_02</td>
<td align="left">2.4</td>
<td align="left">2.4  -  2.5</td>
<td align="left">0.004</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,073</td>
</tr>
<tr class="even">
<td align="left">PA_copplan_03</td>
<td align="left">2.5</td>
<td align="left">2.4  -  2.54</td>
<td align="left">0.035</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,073</td>
</tr>
<tr class="odd">
<td align="left">PA_copplan_04</td>
<td align="left">2.7</td>
<td align="left">2.6  -  2.77</td>
<td align="left">0.035</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,073</td>
</tr>
<tr class="even">
<td align="left">PA_dnorm</td>
<td align="left">4.4</td>
<td align="left">4.2  -  4.58</td>
<td align="left">0.050</td>
<td align="left">0.003</td>
<td align="left">1,073</td>
</tr>
<tr class="odd">
<td align="left">PA_dnorm_01</td>
<td align="left">4.5</td>
<td align="left">4.3  -  4.71</td>
<td align="left">0.050</td>
<td align="left">0.004</td>
<td align="left">1,073</td>
</tr>
<tr class="even">
<td align="left">PA_dnorm_02</td>
<td align="left">4.3</td>
<td align="left">4.1  -  4.52</td>
<td align="left">0.027</td>
<td align="left">0.004</td>
<td align="left">1,073</td>
</tr>
<tr class="odd">
<td align="left">PA_extrinsic</td>
<td align="left">1.6</td>
<td align="left">1.5  -  1.62</td>
<td align="left">0.022</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,069</td>
</tr>
<tr class="even">
<td align="left">PA_extrinsic_01</td>
<td align="left">1.7</td>
<td align="left">1.6  -  1.73</td>
<td align="left">0.010</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,068</td>
</tr>
<tr class="odd">
<td align="left">PA_extrinsic_02</td>
<td align="left">1.5</td>
<td align="left">1.4  -  1.55</td>
<td align="left">0.024</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,069</td>
</tr>
<tr class="even">
<td align="left">PA_extrinsic_03</td>
<td align="left">1.5</td>
<td align="left">1.5  -  1.61</td>
<td align="left">0.011</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,064</td>
</tr>
<tr class="odd">
<td align="left">PA_frqbct</td>
<td align="left">2.5</td>
<td align="left">2.4  -  2.62</td>
<td align="left">0.027</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,070</td>
</tr>
<tr class="even">
<td align="left">PA_frqbct_01</td>
<td align="left">3.7</td>
<td align="left">3.6  -  3.84</td>
<td align="left">0.014</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,070</td>
</tr>
<tr class="odd">
<td align="left">PA_frqbct_02</td>
<td align="left">1.9</td>
<td align="left">1.8  -  1.98</td>
<td align="left">0.024</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,070</td>
</tr>
<tr class="even">
<td align="left">PA_frqbct_03</td>
<td align="left">2.0</td>
<td align="left">1.9  -  2.13</td>
<td align="left">0.007</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,070</td>
</tr>
<tr class="odd">
<td align="left">PA_frqbct_04</td>
<td align="left">1.9</td>
<td align="left">1.8  -  2.02</td>
<td align="left">0.035</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,070</td>
</tr>
<tr class="even">
<td align="left">PA_frqbct_05</td>
<td align="left">2.5</td>
<td align="left">2.4  -  2.64</td>
<td align="left">0.033</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,070</td>
</tr>
<tr class="odd">
<td align="left">PA_frqbct_06</td>
<td align="left">3.4</td>
<td align="left">3.3  -  3.54</td>
<td align="left">0.016</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,070</td>
</tr>
<tr class="even">
<td align="left">PA_frqbct_07</td>
<td align="left">2.2</td>
<td align="left">2.1  -  2.3</td>
<td align="left">0.003</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,070</td>
</tr>
<tr class="odd">
<td align="left">PA_frqbct_08</td>
<td align="left">2.4</td>
<td align="left">2.3  -  2.5</td>
<td align="left">0.014</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,070</td>
</tr>
<tr class="even">
<td align="left">PA_frqbct_09</td>
<td align="left">2.8</td>
<td align="left">2.7  -  2.9</td>
<td align="left">0.007</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,070</td>
</tr>
<tr class="odd">
<td align="left">PA_goal</td>
<td align="left">0.6</td>
<td align="left">0.5  -  0.59</td>
<td align="left">0.046</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,061</td>
</tr>
<tr class="even">
<td align="left">PA_goal_01</td>
<td align="left">0.6</td>
<td align="left">0.5  -  0.59</td>
<td align="left">0.046</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,061</td>
</tr>
<tr class="odd">
<td align="left">PA_identified</td>
<td align="left">3.4</td>
<td align="left">3.3  -  3.54</td>
<td align="left">0.040</td>
<td align="left">0.004</td>
<td align="left">1,074</td>
</tr>
<tr class="even">
<td align="left">PA_identified_01</td>
<td align="left">3.1</td>
<td align="left">3  -  3.29</td>
<td align="left">0.002</td>
<td align="left">0.012</td>
<td align="left">1,063</td>
</tr>
<tr class="odd">
<td align="left">PA_identified_02</td>
<td align="left">3.8</td>
<td align="left">3.7  -  3.86</td>
<td align="left">0.031</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,063</td>
</tr>
<tr class="even">
<td align="left">PA_identified_03</td>
<td align="left">3.4</td>
<td align="left">3.2  -  3.51</td>
<td align="left">0.058</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,070</td>
</tr>
<tr class="odd">
<td align="left">PA_inorm</td>
<td align="left">4.7</td>
<td align="left">4.5  -  4.84</td>
<td align="left">0.006</td>
<td align="left">0.003</td>
<td align="left">1,073</td>
</tr>
<tr class="even">
<td align="left">PA_inorm_01</td>
<td align="left">4.7</td>
<td align="left">4.5  -  4.84</td>
<td align="left">0.006</td>
<td align="left">0.003</td>
<td align="left">1,073</td>
</tr>
<tr class="odd">
<td align="left">PA_integrated</td>
<td align="left">3.2</td>
<td align="left">3.1  -  3.34</td>
<td align="left">0.071</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,073</td>
</tr>
<tr class="even">
<td align="left">PA_integrated_01</td>
<td align="left">3.3</td>
<td align="left">3.2  -  3.47</td>
<td align="left">0.059</td>
<td align="left">0.004</td>
<td align="left">1,070</td>
</tr>
<tr class="odd">
<td align="left">PA_integrated_02</td>
<td align="left">3.3</td>
<td align="left">3.1  -  3.39</td>
<td align="left">0.048</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,062</td>
</tr>
<tr class="even">
<td align="left">PA_integrated_03</td>
<td align="left">3.1</td>
<td align="left">3  -  3.22</td>
<td align="left">0.072</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,066</td>
</tr>
<tr class="odd">
<td align="left">PA_intention</td>
<td align="left">5.4</td>
<td align="left">5.2  -  5.57</td>
<td align="left">0.105</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,073</td>
</tr>
<tr class="even">
<td align="left">PA_intention_01</td>
<td align="left">5.4</td>
<td align="left">5.2  -  5.55</td>
<td align="left">0.088</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,073</td>
</tr>
<tr class="odd">
<td align="left">PA_intention_02</td>
<td align="left">5.4</td>
<td align="left">5.2  -  5.61</td>
<td align="left">0.111</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,073</td>
</tr>
<tr class="even">
<td align="left">PA_intrinsic</td>
<td align="left">3.6</td>
<td align="left">3.5  -  3.74</td>
<td align="left">0.074</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,074</td>
</tr>
<tr class="odd">
<td align="left">PA_intrinsic_01</td>
<td align="left">3.7</td>
<td align="left">3.6  -  3.88</td>
<td align="left">0.072</td>
<td align="left">0.005</td>
<td align="left">1,070</td>
</tr>
<tr class="even">
<td align="left">PA_intrinsic_02</td>
<td align="left">3.6</td>
<td align="left">3.5  -  3.76</td>
<td align="left">0.057</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,066</td>
</tr>
<tr class="odd">
<td align="left">PA_intrinsic_03</td>
<td align="left">3.5</td>
<td align="left">3.4  -  3.62</td>
<td align="left">0.055</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,057</td>
</tr>
<tr class="even">
<td align="left">PA_introjected</td>
<td align="left">2.2</td>
<td align="left">2.2  -  2.33</td>
<td align="left">NA</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,073</td>
</tr>
<tr class="odd">
<td align="left">PA_introjected_01</td>
<td align="left">2.2</td>
<td align="left">2.1  -  2.28</td>
<td align="left">NA</td>
<td align="left">0.001</td>
<td align="left">1,068</td>
</tr>
<tr class="even">
<td align="left">PA_introjected_02</td>
<td align="left">2.3</td>
<td align="left">2.2  -  2.4</td>
<td align="left">0.006</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,066</td>
</tr>
<tr class="odd">
<td align="left">PA_opportunities</td>
<td align="left">5.1</td>
<td align="left">5.1  -  5.19</td>
<td align="left">0.018</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,075</td>
</tr>
<tr class="even">
<td align="left">PA_opportunities_01</td>
<td align="left">4.7</td>
<td align="left">4.3  -  4.98</td>
<td align="left">0.037</td>
<td align="left">0.02</td>
<td align="left">1,070</td>
</tr>
<tr class="odd">
<td align="left">PA_opportunities_02</td>
<td align="left">5.5</td>
<td align="left">5.4  -  5.62</td>
<td align="left">0.018</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,067</td>
</tr>
<tr class="even">
<td align="left">PA_opportunities_04</td>
<td align="left">5.6</td>
<td align="left">5.4  -  5.75</td>
<td align="left">0.021</td>
<td align="left">0.008</td>
<td align="left">1,070</td>
</tr>
<tr class="odd">
<td align="left">PA_opportunities_05</td>
<td align="left">5.3</td>
<td align="left">5.2  -  5.43</td>
<td align="left">NA</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,064</td>
</tr>
<tr class="even">
<td align="left">PA_opportunities_07</td>
<td align="left">4.6</td>
<td align="left">4.5  -  4.77</td>
<td align="left">0.009</td>
<td align="left">0.001</td>
<td align="left">1,068</td>
</tr>
<tr class="odd">
<td align="left">PA_opportunitiesReverseCoded_03</td>
<td align="left">5.1</td>
<td align="left">5  -  5.23</td>
<td align="left">NA</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,065</td>
</tr>
<tr class="even">
<td align="left">PA_opportunitiesReverseCoded_06</td>
<td align="left">3.6</td>
<td align="left">3.3  -  3.95</td>
<td align="left">NA</td>
<td align="left">0.024</td>
<td align="left">1,059</td>
</tr>
<tr class="odd">
<td align="left">PA_opportunitiesReverseCoded_08</td>
<td align="left">6.6</td>
<td align="left">6.5  -  6.68</td>
<td align="left">0.020</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,066</td>
</tr>
<tr class="even">
<td align="left">PA_outcomeExpectations</td>
<td align="left">4.6</td>
<td align="left">4.5  -  4.74</td>
<td align="left">0.034</td>
<td align="left">0.013</td>
<td align="left">1,078</td>
</tr>
<tr class="odd">
<td align="left">PA_outcomeExpectations_01</td>
<td align="left">5.5</td>
<td align="left">5.3  -  5.7</td>
<td align="left">0.042</td>
<td align="left">0.011</td>
<td align="left">1,071</td>
</tr>
<tr class="even">
<td align="left">PA_outcomeExpectations_03</td>
<td align="left">5.2</td>
<td align="left">4.9  -  5.47</td>
<td align="left">0.008</td>
<td align="left">0.018</td>
<td align="left">1,064</td>
</tr>
<tr class="odd">
<td align="left">PA_outcomeExpectations_04</td>
<td align="left">5.5</td>
<td align="left">5.3  -  5.65</td>
<td align="left">0.009</td>
<td align="left">0.007</td>
<td align="left">1,071</td>
</tr>
<tr class="even">
<td align="left">PA_outcomeExpectations_05</td>
<td align="left">5.2</td>
<td align="left">5  -  5.39</td>
<td align="left">0.023</td>
<td align="left">0.011</td>
<td align="left">1,067</td>
</tr>
<tr class="odd">
<td align="left">PA_outcomeExpectations_06</td>
<td align="left">5.4</td>
<td align="left">5.2  -  5.63</td>
<td align="left">0.030</td>
<td align="left">0.016</td>
<td align="left">1,071</td>
</tr>
<tr class="even">
<td align="left">PA_outcomeExpectations_07</td>
<td align="left">4.9</td>
<td align="left">4.7  -  5.13</td>
<td align="left">0.039</td>
<td align="left">0.008</td>
<td align="left">1,062</td>
</tr>
<tr class="odd">
<td align="left">PA_outcomeExpectations_10</td>
<td align="left">5.4</td>
<td align="left">5.2  -  5.54</td>
<td align="left">0.019</td>
<td align="left">0.006</td>
<td align="left">1,069</td>
</tr>
<tr class="even">
<td align="left">PA_outcomeExpectations_11</td>
<td align="left">5.1</td>
<td align="left">4.9  -  5.38</td>
<td align="left">0.055</td>
<td align="left">0.011</td>
<td align="left">1,063</td>
</tr>
<tr class="odd">
<td align="left">PA_outcomeExpectations_12</td>
<td align="left">5.2</td>
<td align="left">4.9  -  5.45</td>
<td align="left">0.042</td>
<td align="left">0.014</td>
<td align="left">1,070</td>
</tr>
<tr class="even">
<td align="left">PA_outcomeExpectationsNegative_02</td>
<td align="left">2.9</td>
<td align="left">2.7  -  3.02</td>
<td align="left">0.046</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,066</td>
</tr>
<tr class="odd">
<td align="left">PA_outcomeExpectationsNegative_08</td>
<td align="left">2.5</td>
<td align="left">2.3  -  2.69</td>
<td align="left">0.038</td>
<td align="left">0.004</td>
<td align="left">1,063</td>
</tr>
<tr class="even">
<td align="left">PA_outcomeExpectationsNegative_09</td>
<td align="left">2.6</td>
<td align="left">2.5  -  2.68</td>
<td align="left">0.023</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,064</td>
</tr>
<tr class="odd">
<td align="left">PA_pbc</td>
<td align="left">5.3</td>
<td align="left">5.2  -  5.45</td>
<td align="left">0.028</td>
<td align="left">0.004</td>
<td align="left">1,071</td>
</tr>
<tr class="even">
<td align="left">PA_pbc_01</td>
<td align="left">5.9</td>
<td align="left">5.7  -  5.98</td>
<td align="left">0.032</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,069</td>
</tr>
<tr class="odd">
<td align="left">PA_pbc_03</td>
<td align="left">5.2</td>
<td align="left">5  -  5.4</td>
<td align="left">0.014</td>
<td align="left">0.01</td>
<td align="left">1,066</td>
</tr>
<tr class="even">
<td align="left">PA_pbcReverseCoded_02</td>
<td align="left">4.9</td>
<td align="left">4.7  -  5.11</td>
<td align="left">0.005</td>
<td align="left">0.005</td>
<td align="left">1,063</td>
</tr>
<tr class="odd">
<td align="left">PA_selfefficacy</td>
<td align="left">5.2</td>
<td align="left">5.1  -  5.35</td>
<td align="left">0.007</td>
<td align="left">0.005</td>
<td align="left">1,071</td>
</tr>
<tr class="even">
<td align="left">PA_selfefficacy_01</td>
<td align="left">5.9</td>
<td align="left">5.8  -  5.96</td>
<td align="left">0.009</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,071</td>
</tr>
<tr class="odd">
<td align="left">PA_selfefficacyReverseCoded_02</td>
<td align="left">4.6</td>
<td align="left">4.4  -  4.77</td>
<td align="left">0.002</td>
<td align="left">0.005</td>
<td align="left">1,071</td>
</tr>
<tr class="even">
<td align="left">PA_sePbc</td>
<td align="left">5.3</td>
<td align="left">5.1  -  5.4</td>
<td align="left">0.028</td>
<td align="left">0.007</td>
<td align="left">1,071</td>
</tr>
<tr class="odd">
<td align="left">paAccelerometer</td>
<td align="left">183.1</td>
<td align="left">166  -  200.45</td>
<td align="left">0.072</td>
<td align="left">0.096</td>
<td align="left">706</td>
</tr>
<tr class="even">
<td align="left">padaysLastweek</td>
<td align="left">2.8</td>
<td align="left">2.6  -  2.95</td>
<td align="left">0.047</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,082</td>
</tr>
<tr class="odd">
<td align="left">pafreqUsually</td>
<td align="left">2.6</td>
<td align="left">2.4  -  2.73</td>
<td align="left">0.094</td>
<td align="left">0.003</td>
<td align="left">1,082</td>
</tr>
<tr class="even">
<td align="left">pahrsLastweek</td>
<td align="left">5.4</td>
<td align="left">4.7  -  6.16</td>
<td align="left">0.024</td>
<td align="left">0.007</td>
<td align="left">1,082</td>
</tr>
<tr class="odd">
<td align="left">pahrsUsually</td>
<td align="left">3.1</td>
<td align="left">2.9  -  3.36</td>
<td align="left">0.085</td>
<td align="left">0.005</td>
<td align="left">1,082</td>
</tr>
<tr class="even">
<td align="left">paLastweek</td>
<td align="left">339.7</td>
<td align="left">296  -  382.07</td>
<td align="left">0.024</td>
<td align="left">0.006</td>
<td align="left">1,082</td>
</tr>
<tr class="odd">
<td align="left">paminLastweek</td>
<td align="left">1.4</td>
<td align="left">1.4  -  1.5</td>
<td align="left">NA</td>
<td align="left">0.01</td>
<td align="left">1,082</td>
</tr>
<tr class="even">
<td align="left">SB_dnorm</td>
<td align="left">3.2</td>
<td align="left">3.1  -  3.41</td>
<td align="left">0.003</td>
<td align="left">0.007</td>
<td align="left">1,062</td>
</tr>
<tr class="odd">
<td align="left">SB_dnorm_01</td>
<td align="left">3.1</td>
<td align="left">2.9  -  3.22</td>
<td align="left">NA</td>
<td align="left">0.004</td>
<td align="left">1,059</td>
</tr>
<tr class="even">
<td align="left">SB_dnorm_02</td>
<td align="left">3.4</td>
<td align="left">3.2  -  3.59</td>
<td align="left">0.010</td>
<td align="left">0.007</td>
<td align="left">1,060</td>
</tr>
<tr class="odd">
<td align="left">SB_inorm</td>
<td align="left">4.0</td>
<td align="left">3.9  -  4.14</td>
<td align="left">0.012</td>
<td align="left">0.004</td>
<td align="left">1,064</td>
</tr>
<tr class="even">
<td align="left">SB_inorm_01</td>
<td align="left">3.9</td>
<td align="left">3.8  -  4.11</td>
<td align="left">NA</td>
<td align="left">0.008</td>
<td align="left">1,056</td>
</tr>
<tr class="odd">
<td align="left">SB_inorm_02</td>
<td align="left">4.1</td>
<td align="left">3.9  -  4.28</td>
<td align="left">0.030</td>
<td align="left">0.005</td>
<td align="left">1,053</td>
</tr>
<tr class="even">
<td align="left">SB_intention</td>
<td align="left">3.7</td>
<td align="left">3.4  -  4.06</td>
<td align="left">0.014</td>
<td align="left">0.035</td>
<td align="left">1,064</td>
</tr>
<tr class="odd">
<td align="left">SB_intention_01</td>
<td align="left">3.3</td>
<td align="left">3  -  3.64</td>
<td align="left">NA</td>
<td align="left">0.025</td>
<td align="left">1,059</td>
</tr>
<tr class="even">
<td align="left">SB_intention_02</td>
<td align="left">3.5</td>
<td align="left">3.2  -  3.81</td>
<td align="left">NA</td>
<td align="left">0.034</td>
<td align="left">1,056</td>
</tr>
<tr class="odd">
<td align="left">SB_intention_03</td>
<td align="left">4.0</td>
<td align="left">3.7  -  4.37</td>
<td align="left">0.023</td>
<td align="left">0.027</td>
<td align="left">1,054</td>
</tr>
<tr class="even">
<td align="left">SB_intention_04</td>
<td align="left">4.1</td>
<td align="left">3.8  -  4.43</td>
<td align="left">0.028</td>
<td align="left">0.027</td>
<td align="left">1,055</td>
</tr>
<tr class="odd">
<td align="left">SB_outcomeExpectations</td>
<td align="left">4.4</td>
<td align="left">4.3  -  4.53</td>
<td align="left">0.029</td>
<td align="left">0.005</td>
<td align="left">1,064</td>
</tr>
<tr class="even">
<td align="left">SB_outcomeExpectations_02</td>
<td align="left">4.8</td>
<td align="left">4.6  -  5.06</td>
<td align="left">0.017</td>
<td align="left">0.014</td>
<td align="left">1,056</td>
</tr>
<tr class="odd">
<td align="left">SB_outcomeExpectations_03</td>
<td align="left">4.6</td>
<td align="left">4.4  -  4.88</td>
<td align="left">0.024</td>
<td align="left">0.014</td>
<td align="left">1,058</td>
</tr>
<tr class="even">
<td align="left">SB_outcomeExpectations_04</td>
<td align="left">4.9</td>
<td align="left">4.7  -  5.12</td>
<td align="left">0.038</td>
<td align="left">0.005</td>
<td align="left">1,063</td>
</tr>
<tr class="odd">
<td align="left">SB_outcomeExpectations_05</td>
<td align="left">4.9</td>
<td align="left">4.7  -  5.09</td>
<td align="left">0.040</td>
<td align="left">0.004</td>
<td align="left">1,060</td>
</tr>
<tr class="even">
<td align="left">SB_outcomeExpectations_06</td>
<td align="left">4.9</td>
<td align="left">4.7  -  5.11</td>
<td align="left">0.047</td>
<td align="left">0.011</td>
<td align="left">1,058</td>
</tr>
<tr class="odd">
<td align="left">SB_outcomeExpectationsNegative_01</td>
<td align="left">3.4</td>
<td align="left">3.3  -  3.51</td>
<td align="left">0.008</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,063</td>
</tr>
<tr class="even">
<td align="left">SB_outcomeExpectationsNegative_07</td>
<td align="left">3.3</td>
<td align="left">3.2  -  3.51</td>
<td align="left">0.012</td>
<td align="left">0.003</td>
<td align="left">1,057</td>
</tr>
<tr class="odd">
<td align="left">SB_sePbc</td>
<td align="left">5.0</td>
<td align="left">4.8  -  5.14</td>
<td align="left">0.015</td>
<td align="left">0.011</td>
<td align="left">1,064</td>
</tr>
<tr class="even">
<td align="left">SB_sePbc_01</td>
<td align="left">4.4</td>
<td align="left">4.1  -  4.6</td>
<td align="left">0.010</td>
<td align="left">0.014</td>
<td align="left">1,062</td>
</tr>
<tr class="odd">
<td align="left">SB_sePbc_02</td>
<td align="left">4.3</td>
<td align="left">4.1  -  4.54</td>
<td align="left">0.003</td>
<td align="left">0.015</td>
<td align="left">1,061</td>
</tr>
<tr class="even">
<td align="left">SB_sePbc_03</td>
<td align="left">5.7</td>
<td align="left">5.6  -  5.87</td>
<td align="left">0.026</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,060</td>
</tr>
<tr class="odd">
<td align="left">SB_sePbc_04</td>
<td align="left">5.7</td>
<td align="left">5.6  -  5.88</td>
<td align="left">0.034</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,060</td>
</tr>
<tr class="even">
<td align="left">SB_sePbc_05</td>
<td align="left">4.7</td>
<td align="left">4.5  -  4.91</td>
<td align="left">0.005</td>
<td align="left">0.012</td>
<td align="left">1,054</td>
</tr>
<tr class="odd">
<td align="left">sitBreaks</td>
<td align="left">28.0</td>
<td align="left">24.7  -  31.37</td>
<td align="left">0.058</td>
<td align="left">0.085</td>
<td align="left">706</td>
</tr>
<tr class="even">
<td align="left">sitLieAccelerometer</td>
<td align="left">573.9</td>
<td align="left">535.5  -  611.8</td>
<td align="left">0.086</td>
<td align="left">0.145</td>
<td align="left">706</td>
</tr>
<tr class="odd">
<td align="left">symptom</td>
<td align="left">2.0</td>
<td align="left">1.8  -  2.11</td>
<td align="left">0.023</td>
<td align="left">0.039</td>
<td align="left">1,084</td>
</tr>
<tr class="even">
<td align="left">symptom_headAche</td>
<td align="left">2.0</td>
<td align="left">1.8  -  2.16</td>
<td align="left">0.007</td>
<td align="left">0.027</td>
<td align="left">1,055</td>
</tr>
<tr class="odd">
<td align="left">symptom_irritabilityAngerbursts</td>
<td align="left">1.9</td>
<td align="left">1.8  -  2.04</td>
<td align="left">0.026</td>
<td align="left">0.01</td>
<td align="left">1,039</td>
</tr>
<tr class="even">
<td align="left">symptom_lowerBackPain</td>
<td align="left">1.8</td>
<td align="left">1.7  -  1.85</td>
<td align="left">0.004</td>
<td align="left">0.005</td>
<td align="left">1,053</td>
</tr>
<tr class="odd">
<td align="left">symptom_neckShoulderPain</td>
<td align="left">2.0</td>
<td align="left">1.8  -  2.17</td>
<td align="left">0.011</td>
<td align="left">0.033</td>
<td align="left">1,047</td>
</tr>
<tr class="even">
<td align="left">symptom_sleepDifficulty</td>
<td align="left">2.1</td>
<td align="left">1.9  -  2.27</td>
<td align="left">0.010</td>
<td align="left">0.023</td>
<td align="left">1,052</td>
</tr>
<tr class="odd">
<td align="left">symptom_stomachAche</td>
<td align="left">1.7</td>
<td align="left">1.6  -  1.86</td>
<td align="left">0.015</td>
<td align="left">0.023</td>
<td align="left">1,026</td>
</tr>
<tr class="even">
<td align="left">symptom_tensionNervousness</td>
<td align="left">1.9</td>
<td align="left">1.8  -  2.08</td>
<td align="left">0.007</td>
<td align="left">0.024</td>
<td align="left">1,051</td>
</tr>
<tr class="odd">
<td align="left">symptom_tirednessFaintness</td>
<td align="left">2.3</td>
<td align="left">2.2  -  2.4</td>
<td align="left">0.025</td>
<td align="left">0.009</td>
<td align="left">1,058</td>
</tr>
</tbody>
</table>
</div>
<div id="icc-top-20-items-sorted-by-classroom-icc" class="section level2">
<h2>ICC top 20 items, sorted by classroom ICC</h2>
<pre class="r"><code>
vardatatable %&gt;% 
  select(Variable, `ICC class`, `ICC school`, n) %&gt;% 
  arrange(desc(`ICC class`)) %&gt;% slice(1:20) %&gt;% 
  as.tbl() %&gt;% 
  papaja::apa_table(caption = &quot;Intra-class correlations sorted by classroom ICC&quot;,
        format.args = list(digits = c(3, 0), margin = 2))</code></pre>
<caption>
(#tab:icc-school-class-sortbyclass)
</caption>
<caption>
<em>Intra-class correlations sorted by classroom ICC</em>
</caption>
<table>
<thead>
<tr class="header">
<th align="left">Variable</th>
<th align="left">ICC class</th>
<th align="left">ICC school</th>
<th align="left">n</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">PA_intention_02</td>
<td align="left">0.111</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,073</td>
</tr>
<tr class="even">
<td align="left">PA_intention</td>
<td align="left">0.105</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,073</td>
</tr>
<tr class="odd">
<td align="left">pafreqUsually</td>
<td align="left">0.094</td>
<td align="left">0.003</td>
<td align="left">1,082</td>
</tr>
<tr class="even">
<td align="left">PA_intention_01</td>
<td align="left">0.088</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,073</td>
</tr>
<tr class="odd">
<td align="left">sitLieAccelerometer</td>
<td align="left">0.086</td>
<td align="left">0.145</td>
<td align="left">706</td>
</tr>
<tr class="even">
<td align="left">pahrsUsually</td>
<td align="left">0.085</td>
<td align="left">0.005</td>
<td align="left">1,082</td>
</tr>
<tr class="odd">
<td align="left">PA_intrinsic</td>
<td align="left">0.074</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,074</td>
</tr>
<tr class="even">
<td align="left">PA_autonomous</td>
<td align="left">0.073</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,078</td>
</tr>
<tr class="odd">
<td align="left">PA_autonomous_06</td>
<td align="left">0.072</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,066</td>
</tr>
<tr class="even">
<td align="left">PA_autonomous_07</td>
<td align="left">0.072</td>
<td align="left">0.005</td>
<td align="left">1,070</td>
</tr>
<tr class="odd">
<td align="left">PA_integrated_03</td>
<td align="left">0.072</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,066</td>
</tr>
<tr class="even">
<td align="left">PA_intrinsic_01</td>
<td align="left">0.072</td>
<td align="left">0.005</td>
<td align="left">1,070</td>
</tr>
<tr class="odd">
<td align="left">paAccelerometer</td>
<td align="left">0.072</td>
<td align="left">0.096</td>
<td align="left">706</td>
</tr>
<tr class="even">
<td align="left">PA_integrated</td>
<td align="left">0.071</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,073</td>
</tr>
<tr class="odd">
<td align="left">PA_agrbct_01</td>
<td align="left">0.061</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,071</td>
</tr>
<tr class="even">
<td align="left">PA_autonomous_04</td>
<td align="left">0.059</td>
<td align="left">0.004</td>
<td align="left">1,070</td>
</tr>
<tr class="odd">
<td align="left">PA_integrated_01</td>
<td align="left">0.059</td>
<td align="left">0.004</td>
<td align="left">1,070</td>
</tr>
<tr class="even">
<td align="left">PA_autonomous_03</td>
<td align="left">0.058</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,070</td>
</tr>
<tr class="odd">
<td align="left">PA_identified_03</td>
<td align="left">0.058</td>
<td align="left">&lt; 0.001</td>
<td align="left">1,070</td>
</tr>
<tr class="even">
<td align="left">sitBreaks</td>
<td align="left">0.058</td>
<td align="left">0.085</td>
<td align="left">706</td>
</tr>
</tbody>
</table>
</div>
<div id="icc-top-20-items-sorted-by-school-icc" class="section level2">
<h2>ICC top 20 items, sorted by school ICC</h2>
<pre class="r"><code>
vardatatable %&gt;% select(Variable, `ICC class`, `ICC school`, n) %&gt;% 
  arrange(desc(`ICC school`)) %&gt;% 
  slice(1:20) %&gt;% 
  papaja::apa_table(caption = &quot;Intra-class correlations sorted by school ICC&quot;,
        format.args = list(digits = c(3, 0), margin = 2))</code></pre>
<caption>
(#tab:icc-school-class-sortbyschool)
</caption>
<caption>
<em>Intra-class correlations sorted by school ICC</em>
</caption>
<table>
<thead>
<tr class="header">
<th align="left">Variable</th>
<th align="left">ICC class</th>
<th align="left">ICC school</th>
<th align="left">n</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">sitLieAccelerometer</td>
<td align="left">0.086</td>
<td align="left">0.145</td>
<td align="left">706</td>
</tr>
<tr class="even">
<td align="left">fatpct</td>
<td align="left">0.003</td>
<td align="left">0.123</td>
<td align="left">942</td>
</tr>
<tr class="odd">
<td align="left">paAccelerometer</td>
<td align="left">0.072</td>
<td align="left">0.096</td>
<td align="left">706</td>
</tr>
<tr class="even">
<td align="left">sitBreaks</td>
<td align="left">0.058</td>
<td align="left">0.085</td>
<td align="left">706</td>
</tr>
<tr class="odd">
<td align="left">symptom</td>
<td align="left">0.023</td>
<td align="left">0.039</td>
<td align="left">1,084</td>
</tr>
<tr class="even">
<td align="left">SB_intention</td>
<td align="left">0.014</td>
<td align="left">0.035</td>
<td align="left">1,064</td>
</tr>
<tr class="odd">
<td align="left">SB_intention_02</td>
<td align="left">NA</td>
<td align="left">0.034</td>
<td align="left">1,056</td>
</tr>
<tr class="even">
<td align="left">symptom_neckShoulderPain</td>
<td align="left">0.011</td>
<td align="left">0.033</td>
<td align="left">1,047</td>
</tr>
<tr class="odd">
<td align="left">b5open</td>
<td align="left">0.010</td>
<td align="left">0.03</td>
<td align="left">1,068</td>
</tr>
<tr class="even">
<td align="left">SB_intention_03</td>
<td align="left">0.023</td>
<td align="left">0.027</td>
<td align="left">1,054</td>
</tr>
<tr class="odd">
<td align="left">SB_intention_04</td>
<td align="left">0.028</td>
<td align="left">0.027</td>
<td align="left">1,055</td>
</tr>
<tr class="even">
<td align="left">symptom_headAche</td>
<td align="left">0.007</td>
<td align="left">0.027</td>
<td align="left">1,055</td>
</tr>
<tr class="odd">
<td align="left">SB_intention_01</td>
<td align="left">NA</td>
<td align="left">0.025</td>
<td align="left">1,059</td>
</tr>
<tr class="even">
<td align="left">PA_opportunitiesReverseCoded_06</td>
<td align="left">NA</td>
<td align="left">0.024</td>
<td align="left">1,059</td>
</tr>
<tr class="odd">
<td align="left">symptom_tensionNervousness</td>
<td align="left">0.007</td>
<td align="left">0.024</td>
<td align="left">1,051</td>
</tr>
<tr class="even">
<td align="left">symptom_sleepDifficulty</td>
<td align="left">0.010</td>
<td align="left">0.023</td>
<td align="left">1,052</td>
</tr>
<tr class="odd">
<td align="left">symptom_stomachAche</td>
<td align="left">0.015</td>
<td align="left">0.023</td>
<td align="left">1,026</td>
</tr>
<tr class="even">
<td align="left">b5ext</td>
<td align="left">0.020</td>
<td align="left">0.022</td>
<td align="left">1,068</td>
</tr>
<tr class="odd">
<td align="left">PA_opportunities_01</td>
<td align="left">0.037</td>
<td align="left">0.02</td>
<td align="left">1,070</td>
</tr>
<tr class="even">
<td align="left">PA_outcomeExpectations_03</td>
<td align="left">0.008</td>
<td align="left">0.018</td>
<td align="left">1,064</td>
</tr>
</tbody>
</table>
</div>
<div id="model-with-educational-track" class="section level2">
<h2>Model with educational track</h2>
<p>The model below is the same as the one above, except it adds educational track.</p>
<p>As before, we create a table with all variables, their means, CIs and ICCs.</p>
<pre class="r"><code>#library(sjstats)
#library(lme4)

names &lt;- df %&gt;% select(-id, -intervention, -group, -school, -girl, -track, -trackSchool, -contains(&quot;_T3&quot;), -contains(&quot;_diff&quot;)) %&gt;% names(.)

# Create empty soon-to-be-filled objects
m &lt;- NA
mean &lt;- NA
m_p &lt;- NA
ci_low &lt;- NA
ci_high &lt;- NA
ICC_group &lt;- NA
ICC_School &lt;- NA
nonmissings &lt;- NA
ICC_track &lt;- NA


## To test the code with a single variable:
# dftest &lt;- df #%&gt;% na.omit()
# m &lt;- lme4::lmer(sitLieAccelerometer_T1 ~ (1|school) + (1|group) + (1|track), data=df)
# mean &lt;- lme4::fixef(m)
# m_p &lt;- profile(m)
# ci_low &lt;- confint(m_p)[5]
# ci_high &lt;- confint(m_p)[10]
# ICC_group &lt;- icc(m)[1]
# ICC_School &lt;- icc(m)[2]
# nonmissings &lt;- length(m@resp$y)

# Loop over each variable name, extract statistics: 

# all participants  
# for (i in names){
# m &lt;- lme4::lmer(paste0(i,&quot; ~ (1|school) + (1|group) + (1|track)&quot;), data=df)
# mean[i] &lt;- lme4::fixef(m)
# m_p &lt;- profile(m, which = &quot;beta_&quot;)
# ci_low[i] &lt;- confint(m_p)[1]
# ci_high[i] &lt;- confint(m_p)[2]
# ICC_group[i] &lt;- sjstats::icc(m)[1]
# ICC_School[i] &lt;- sjstats::icc(m)[3]
# ICC_track[i] &lt;- sjstats::icc(m)[2]
# nonmissings[i] &lt;- length(m@resp$y)
# }
# 
# vardatatable_containing_edutrack &lt;- data_frame(
#   Variable = stringr::str_sub(names(mean), end = -4), #remove &quot;_T1&quot; from names
#   Mean = round(mean, 1), 
#   CI95 = paste(round(ci_low, 2), &quot;-&quot;, round(ci_high, 2)), 
#   &quot;ICC class&quot; =ifelse(round(ICC_group, 3) == 0, &quot;&lt; 0.001&quot;, round(ICC_group, 3)), 
#   &quot;ICC school&quot; = ifelse(round(ICC_School, 3) == 0, &quot;&lt; 0.001&quot;, round(ICC_School, 3)),
#   &quot;ICC educational track&quot; = ifelse(round(ICC_track, 3) == 0, &quot;&lt; 0.001&quot;, round(ICC_track, 3)),
#   n = nonmissings) %&gt;% 
#   dplyr::arrange(Variable) %&gt;% 
#   filter(Variable != &quot;&quot;) #remove first row, which is empty
# 
# save(vardatatable_containing_edutrack, file = &quot;vardatatable_containing_edutrack.Rdata&quot;)
load(&quot;vardatatable_containing_edutrack.Rdata&quot;)

# ci_edutrack &lt;- data_frame(
#   &quot;ciLo&quot; = ci_low,
#   &quot;mean&quot; = mean,
#   &quot;ciHi&quot; = ci_high,  
#   &quot;diamondlabels&quot; = names(mean)) %&gt;%  
#   filter(diamondlabels != &quot;&quot;) %&gt;% #remove first row, which is empty
#   as.data.frame()
# 
# save(ci_edutrack, file = &quot;ci_edutrack.Rdata&quot;)
load(&quot;ci_edutrack.Rdata&quot;)</code></pre>
<div id="top-20-items-sorted-by-school" class="section level3">
<h3>Top 20 items, sorted by school</h3>
<pre class="r"><code>
vardatatable_containing_edutrack %&gt;% 
  select(Variable, `ICC educational track`, `ICC class`, `ICC school`, n) %&gt;% 
  arrange(desc(`ICC school`)) %&gt;% 
  top_n(20) %&gt;% 
  papaja::apa_table(caption = &quot;Intra-class correlations sorted by school ICC&quot;,
        format.args = list(digits = c(0), margin = 2))
## Selecting by n</code></pre>
<caption>
(#tab:icc-school-class-track-sortbyschool)
</caption>
<caption>
<em>Intra-class correlations sorted by school ICC</em>
</caption>
<table>
<thead>
<tr class="header">
<th align="left">Variable</th>
<th align="left">ICC educational track</th>
<th align="left">ICC class</th>
<th align="left">ICC school</th>
<th align="left">n</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">PA_dnorm_01</td>
<td align="left">0.054</td>
<td align="left">&lt; 0.001</td>
<td align="left">0.012</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">paminLastweek</td>
<td align="left">0.005</td>
<td align="left">&lt; 0.001</td>
<td align="left">0.011</td>
<td align="left">1082</td>
</tr>
<tr class="odd">
<td align="left">PA_integrated</td>
<td align="left">0.082</td>
<td align="left">&lt; 0.001</td>
<td align="left">0.008</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">PA_autonomous</td>
<td align="left">0.073</td>
<td align="left">0.005</td>
<td align="left">0.006</td>
<td align="left">1078</td>
</tr>
<tr class="odd">
<td align="left">PA_intrinsic</td>
<td align="left">0.071</td>
<td align="left">0.009</td>
<td align="left">0.006</td>
<td align="left">1074</td>
</tr>
<tr class="even">
<td align="left">pafreqUsually</td>
<td align="left">0.069</td>
<td align="left">0.023</td>
<td align="left">0.005</td>
<td align="left">1082</td>
</tr>
<tr class="odd">
<td align="left">PA_dnorm</td>
<td align="left">0.052</td>
<td align="left">0.005</td>
<td align="left">0.004</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">pahrsUsually</td>
<td align="left">0.051</td>
<td align="left">0.033</td>
<td align="left">0.004</td>
<td align="left">1082</td>
</tr>
<tr class="odd">
<td align="left">PA_inorm</td>
<td align="left">&lt; 0.001</td>
<td align="left">0.006</td>
<td align="left">0.003</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">PA_inorm_01</td>
<td align="left">&lt; 0.001</td>
<td align="left">0.006</td>
<td align="left">0.003</td>
<td align="left">1073</td>
</tr>
<tr class="odd">
<td align="left">PA_outcomeExpectations</td>
<td align="left">0.024</td>
<td align="left">0.029</td>
<td align="left">0.003</td>
<td align="left">1078</td>
</tr>
<tr class="even">
<td align="left">PA_actCop</td>
<td align="left">0.036</td>
<td align="left">0.006</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="odd">
<td align="left">PA_actionplan</td>
<td align="left">0.031</td>
<td align="left">0.013</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">PA_actplan_01</td>
<td align="left">0.033</td>
<td align="left">0.006</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="odd">
<td align="left">PA_actplan_02</td>
<td align="left">0.018</td>
<td align="left">0.015</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">PA_actplan_03</td>
<td align="left">0.02</td>
<td align="left">0.021</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="odd">
<td align="left">PA_actplan_04</td>
<td align="left">0.038</td>
<td align="left">0.008</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">PA_controlled</td>
<td align="left">0.051</td>
<td align="left">0.004</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="odd">
<td align="left">PA_copingplan</td>
<td align="left">0.034</td>
<td align="left">&lt; 0.001</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">PA_copplan_01</td>
<td align="left">0.022</td>
<td align="left">&lt; 0.001</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="odd">
<td align="left">PA_copplan_02</td>
<td align="left">0.015</td>
<td align="left">&lt; 0.001</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">PA_copplan_03</td>
<td align="left">0.034</td>
<td align="left">0.011</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="odd">
<td align="left">PA_copplan_04</td>
<td align="left">0.033</td>
<td align="left">0.01</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">PA_dnorm_02</td>
<td align="left">0.023</td>
<td align="left">0.013</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="odd">
<td align="left">PA_identified</td>
<td align="left">0.044</td>
<td align="left">0.006</td>
<td align="left">&lt; 0.001</td>
<td align="left">1074</td>
</tr>
<tr class="even">
<td align="left">PA_intention</td>
<td align="left">0.064</td>
<td align="left">0.039</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="odd">
<td align="left">PA_intention_01</td>
<td align="left">0.061</td>
<td align="left">0.027</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">PA_intention_02</td>
<td align="left">0.064</td>
<td align="left">0.044</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="odd">
<td align="left">PA_introjected</td>
<td align="left">0.001</td>
<td align="left">&lt; 0.001</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">PA_opportunities</td>
<td align="left">&lt; 0.001</td>
<td align="left">0.018</td>
<td align="left">&lt; 0.001</td>
<td align="left">1075</td>
</tr>
<tr class="odd">
<td align="left">padaysLastweek</td>
<td align="left">0.04</td>
<td align="left">0.006</td>
<td align="left">&lt; 0.001</td>
<td align="left">1082</td>
</tr>
<tr class="even">
<td align="left">pahrsLastweek</td>
<td align="left">0.036</td>
<td align="left">0.004</td>
<td align="left">&lt; 0.001</td>
<td align="left">1082</td>
</tr>
<tr class="odd">
<td align="left">paLastweek</td>
<td align="left">0.037</td>
<td align="left">0.004</td>
<td align="left">&lt; 0.001</td>
<td align="left">1082</td>
</tr>
<tr class="even">
<td align="left">symptom</td>
<td align="left">0.066</td>
<td align="left">0.013</td>
<td align="left">&lt; 0.001</td>
<td align="left">1084</td>
</tr>
</tbody>
</table>
</div>
<div id="top-20-items-sorted-by-classroom" class="section level3">
<h3>Top 20 items, sorted by classroom</h3>
<pre class="r"><code>
vardatatable_containing_edutrack %&gt;% select(Variable, `ICC educational track`, `ICC class`, `ICC school`, n) %&gt;% arrange(desc(`ICC class`)) %&gt;% top_n(20) %&gt;% papaja::apa_table(caption = &quot;Intra-class correlations sorted by classroom ICC&quot;,
        format.args = list(digits = c(0), margin = 2))
## Selecting by n</code></pre>
<caption>
(#tab:icc-school-class-track-sortbyclass)
</caption>
<caption>
<em>Intra-class correlations sorted by classroom ICC</em>
</caption>
<table>
<thead>
<tr class="header">
<th align="left">Variable</th>
<th align="left">ICC educational track</th>
<th align="left">ICC class</th>
<th align="left">ICC school</th>
<th align="left">n</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">PA_intention_02</td>
<td align="left">0.064</td>
<td align="left">0.044</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">PA_intention</td>
<td align="left">0.064</td>
<td align="left">0.039</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="odd">
<td align="left">pahrsUsually</td>
<td align="left">0.051</td>
<td align="left">0.033</td>
<td align="left">0.004</td>
<td align="left">1082</td>
</tr>
<tr class="even">
<td align="left">PA_outcomeExpectations</td>
<td align="left">0.024</td>
<td align="left">0.029</td>
<td align="left">0.003</td>
<td align="left">1078</td>
</tr>
<tr class="odd">
<td align="left">PA_intention_01</td>
<td align="left">0.061</td>
<td align="left">0.027</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">pafreqUsually</td>
<td align="left">0.069</td>
<td align="left">0.023</td>
<td align="left">0.005</td>
<td align="left">1082</td>
</tr>
<tr class="odd">
<td align="left">PA_actplan_03</td>
<td align="left">0.02</td>
<td align="left">0.021</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">PA_opportunities</td>
<td align="left">&lt; 0.001</td>
<td align="left">0.018</td>
<td align="left">&lt; 0.001</td>
<td align="left">1075</td>
</tr>
<tr class="odd">
<td align="left">PA_actplan_02</td>
<td align="left">0.018</td>
<td align="left">0.015</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">PA_actionplan</td>
<td align="left">0.031</td>
<td align="left">0.013</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="odd">
<td align="left">PA_dnorm_02</td>
<td align="left">0.023</td>
<td align="left">0.013</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">symptom</td>
<td align="left">0.066</td>
<td align="left">0.013</td>
<td align="left">&lt; 0.001</td>
<td align="left">1084</td>
</tr>
<tr class="odd">
<td align="left">PA_copplan_03</td>
<td align="left">0.034</td>
<td align="left">0.011</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">PA_copplan_04</td>
<td align="left">0.033</td>
<td align="left">0.01</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="odd">
<td align="left">PA_intrinsic</td>
<td align="left">0.071</td>
<td align="left">0.009</td>
<td align="left">0.006</td>
<td align="left">1074</td>
</tr>
<tr class="even">
<td align="left">PA_actplan_04</td>
<td align="left">0.038</td>
<td align="left">0.008</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="odd">
<td align="left">PA_actCop</td>
<td align="left">0.036</td>
<td align="left">0.006</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">PA_actplan_01</td>
<td align="left">0.033</td>
<td align="left">0.006</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="odd">
<td align="left">PA_identified</td>
<td align="left">0.044</td>
<td align="left">0.006</td>
<td align="left">&lt; 0.001</td>
<td align="left">1074</td>
</tr>
<tr class="even">
<td align="left">PA_inorm</td>
<td align="left">&lt; 0.001</td>
<td align="left">0.006</td>
<td align="left">0.003</td>
<td align="left">1073</td>
</tr>
<tr class="odd">
<td align="left">PA_inorm_01</td>
<td align="left">&lt; 0.001</td>
<td align="left">0.006</td>
<td align="left">0.003</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">padaysLastweek</td>
<td align="left">0.04</td>
<td align="left">0.006</td>
<td align="left">&lt; 0.001</td>
<td align="left">1082</td>
</tr>
<tr class="odd">
<td align="left">PA_autonomous</td>
<td align="left">0.073</td>
<td align="left">0.005</td>
<td align="left">0.006</td>
<td align="left">1078</td>
</tr>
<tr class="even">
<td align="left">PA_dnorm</td>
<td align="left">0.052</td>
<td align="left">0.005</td>
<td align="left">0.004</td>
<td align="left">1073</td>
</tr>
<tr class="odd">
<td align="left">PA_controlled</td>
<td align="left">0.051</td>
<td align="left">0.004</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">pahrsLastweek</td>
<td align="left">0.036</td>
<td align="left">0.004</td>
<td align="left">&lt; 0.001</td>
<td align="left">1082</td>
</tr>
<tr class="odd">
<td align="left">paLastweek</td>
<td align="left">0.037</td>
<td align="left">0.004</td>
<td align="left">&lt; 0.001</td>
<td align="left">1082</td>
</tr>
<tr class="even">
<td align="left">PA_copingplan</td>
<td align="left">0.034</td>
<td align="left">&lt; 0.001</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="odd">
<td align="left">PA_copplan_01</td>
<td align="left">0.022</td>
<td align="left">&lt; 0.001</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">PA_copplan_02</td>
<td align="left">0.015</td>
<td align="left">&lt; 0.001</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="odd">
<td align="left">PA_dnorm_01</td>
<td align="left">0.054</td>
<td align="left">&lt; 0.001</td>
<td align="left">0.012</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">PA_integrated</td>
<td align="left">0.082</td>
<td align="left">&lt; 0.001</td>
<td align="left">0.008</td>
<td align="left">1073</td>
</tr>
<tr class="odd">
<td align="left">PA_introjected</td>
<td align="left">0.001</td>
<td align="left">&lt; 0.001</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">paminLastweek</td>
<td align="left">0.005</td>
<td align="left">&lt; 0.001</td>
<td align="left">0.011</td>
<td align="left">1082</td>
</tr>
</tbody>
</table>
</div>
<div id="top-20-items-sorted-by-educational-track" class="section level3">
<h3>Top 20 items, sorted by educational track</h3>
<pre class="r"><code>
vardatatable_containing_edutrack %&gt;% select(Variable, `ICC educational track`, `ICC class`, `ICC school`, n) %&gt;% arrange(desc(`ICC educational track`)) %&gt;% top_n(20) %&gt;% papaja::apa_table(caption = &quot;Intra-class correlations sorted by educational track ICC&quot;,
        format.args = list(digits = c(0), margin = 2))
## Selecting by n</code></pre>
<caption>
(#tab:icc-school-class-track-sortbytrack)
</caption>
<caption>
<em>Intra-class correlations sorted by educational track ICC</em>
</caption>
<table>
<thead>
<tr class="header">
<th align="left">Variable</th>
<th align="left">ICC educational track</th>
<th align="left">ICC class</th>
<th align="left">ICC school</th>
<th align="left">n</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">PA_integrated</td>
<td align="left">0.082</td>
<td align="left">&lt; 0.001</td>
<td align="left">0.008</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">PA_autonomous</td>
<td align="left">0.073</td>
<td align="left">0.005</td>
<td align="left">0.006</td>
<td align="left">1078</td>
</tr>
<tr class="odd">
<td align="left">PA_intrinsic</td>
<td align="left">0.071</td>
<td align="left">0.009</td>
<td align="left">0.006</td>
<td align="left">1074</td>
</tr>
<tr class="even">
<td align="left">pafreqUsually</td>
<td align="left">0.069</td>
<td align="left">0.023</td>
<td align="left">0.005</td>
<td align="left">1082</td>
</tr>
<tr class="odd">
<td align="left">symptom</td>
<td align="left">0.066</td>
<td align="left">0.013</td>
<td align="left">&lt; 0.001</td>
<td align="left">1084</td>
</tr>
<tr class="even">
<td align="left">PA_intention</td>
<td align="left">0.064</td>
<td align="left">0.039</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="odd">
<td align="left">PA_intention_02</td>
<td align="left">0.064</td>
<td align="left">0.044</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">PA_intention_01</td>
<td align="left">0.061</td>
<td align="left">0.027</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="odd">
<td align="left">PA_dnorm_01</td>
<td align="left">0.054</td>
<td align="left">&lt; 0.001</td>
<td align="left">0.012</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">PA_dnorm</td>
<td align="left">0.052</td>
<td align="left">0.005</td>
<td align="left">0.004</td>
<td align="left">1073</td>
</tr>
<tr class="odd">
<td align="left">PA_controlled</td>
<td align="left">0.051</td>
<td align="left">0.004</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">pahrsUsually</td>
<td align="left">0.051</td>
<td align="left">0.033</td>
<td align="left">0.004</td>
<td align="left">1082</td>
</tr>
<tr class="odd">
<td align="left">PA_identified</td>
<td align="left">0.044</td>
<td align="left">0.006</td>
<td align="left">&lt; 0.001</td>
<td align="left">1074</td>
</tr>
<tr class="even">
<td align="left">padaysLastweek</td>
<td align="left">0.04</td>
<td align="left">0.006</td>
<td align="left">&lt; 0.001</td>
<td align="left">1082</td>
</tr>
<tr class="odd">
<td align="left">PA_actplan_04</td>
<td align="left">0.038</td>
<td align="left">0.008</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">paLastweek</td>
<td align="left">0.037</td>
<td align="left">0.004</td>
<td align="left">&lt; 0.001</td>
<td align="left">1082</td>
</tr>
<tr class="odd">
<td align="left">PA_actCop</td>
<td align="left">0.036</td>
<td align="left">0.006</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">pahrsLastweek</td>
<td align="left">0.036</td>
<td align="left">0.004</td>
<td align="left">&lt; 0.001</td>
<td align="left">1082</td>
</tr>
<tr class="odd">
<td align="left">PA_copingplan</td>
<td align="left">0.034</td>
<td align="left">&lt; 0.001</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">PA_copplan_03</td>
<td align="left">0.034</td>
<td align="left">0.011</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="odd">
<td align="left">PA_actplan_01</td>
<td align="left">0.033</td>
<td align="left">0.006</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">PA_copplan_04</td>
<td align="left">0.033</td>
<td align="left">0.01</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="odd">
<td align="left">PA_actionplan</td>
<td align="left">0.031</td>
<td align="left">0.013</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">PA_outcomeExpectations</td>
<td align="left">0.024</td>
<td align="left">0.029</td>
<td align="left">0.003</td>
<td align="left">1078</td>
</tr>
<tr class="odd">
<td align="left">PA_dnorm_02</td>
<td align="left">0.023</td>
<td align="left">0.013</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">PA_copplan_01</td>
<td align="left">0.022</td>
<td align="left">&lt; 0.001</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="odd">
<td align="left">PA_actplan_03</td>
<td align="left">0.02</td>
<td align="left">0.021</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">PA_actplan_02</td>
<td align="left">0.018</td>
<td align="left">0.015</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="odd">
<td align="left">PA_copplan_02</td>
<td align="left">0.015</td>
<td align="left">&lt; 0.001</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">paminLastweek</td>
<td align="left">0.005</td>
<td align="left">&lt; 0.001</td>
<td align="left">0.011</td>
<td align="left">1082</td>
</tr>
<tr class="odd">
<td align="left">PA_introjected</td>
<td align="left">0.001</td>
<td align="left">&lt; 0.001</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">PA_inorm</td>
<td align="left">&lt; 0.001</td>
<td align="left">0.006</td>
<td align="left">0.003</td>
<td align="left">1073</td>
</tr>
<tr class="odd">
<td align="left">PA_inorm_01</td>
<td align="left">&lt; 0.001</td>
<td align="left">0.006</td>
<td align="left">0.003</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">PA_opportunities</td>
<td align="left">&lt; 0.001</td>
<td align="left">0.018</td>
<td align="left">&lt; 0.001</td>
<td align="left">1075</td>
</tr>
</tbody>
</table>
</div>
<div id="model-with-educational-track-only" class="section level3">
<h3>Model with educational track only</h3>
<pre class="r"><code>#library(sjstats)
#library(lme4)

names &lt;- df %&gt;% dplyr::select(-id, -intervention, -group, -school, -girl, -track, -trackSchool, -contains(&quot;_T3&quot;), -contains(&quot;_diff&quot;)) %&gt;% names(.)

# Create empty soon-to-be-filled objects
m &lt;- NA
mean &lt;- NA
m_p &lt;- NA
ci_low &lt;- NA
ci_high &lt;- NA
ICC_group &lt;- NA
ICC_School &lt;- NA
nonmissings &lt;- NA
ICC_track &lt;- NA


## To test the code with a single variable:
# dftest &lt;- df #%&gt;% na.omit()
# m &lt;- lme4::lmer(sitLieAccelerometer_T1 ~ (1|track), data=df)
# mean &lt;- lme4::fixef(m)
# m_p &lt;- profile(m)
# ci_low &lt;- confint(m_p)[3]
# ci_high &lt;- confint(m_p)[6]
# ICC_group &lt;- sjstats::icc(m)[1]
# nonmissings &lt;- length(m@resp$y)

# Loop over each variable name, extract statistics: 

# all participants  
# for (i in names){
# m &lt;- lme4::lmer(paste0(i,&quot; ~ (1|track)&quot;), data=df)
# mean[i] &lt;- lme4::fixef(m)
# m_p &lt;- profile(m, which = &quot;beta_&quot;)
# ci_low[i] &lt;- confint(m_p)[1]
# ci_high[i] &lt;- confint(m_p)[2]
# ICC_track[i] &lt;- sjstats::icc(m)[1]
# nonmissings[i] &lt;- length(m@resp$y)
# }
# 
# vardatatable_edutrack_only &lt;- data_frame(
#   Variable = stringr::str_sub(names(mean), end = -4), #remove &quot;_T1&quot; from names
#   Mean = round(mean, 1), 
#   CI95 = paste(round(ci_low, 1), &quot;-&quot;, round(ci_high, 1)), 
#   &quot;ICC educational track&quot; = ifelse(round(ICC_track, 3) == 0, &quot;&lt; 0.001&quot;, round(ICC_track, 3)),
#   n = nonmissings) %&gt;% 
#   dplyr::arrange(Variable) %&gt;% 
#   filter(Variable != &quot;&quot;) #remove first row, which is empty
# 
# save(vardatatable_edutrack_only, file = &quot;vardatatable_edutrack_only.Rdata&quot;)
load(&quot;vardatatable_edutrack_only.Rdata&quot;)

# ci_edutrack_only &lt;- data_frame(
#   &quot;ciLo&quot; = ci_low,
#   &quot;mean&quot; = mean,
#   &quot;ciHi&quot; = ci_high,  
#   &quot;diamondlabels&quot; = names(mean)) %&gt;%  
#   filter(diamondlabels != &quot;&quot;) %&gt;% #remove first row, which is empty
#   as.data.frame()
# 
# save(ci_edutrack_only, file = &quot;ci_edutrack_only.Rdata&quot;)
load(&quot;ci_edutrack_only.Rdata&quot;)</code></pre>
<p>Top 20 items, sorted by ICC educational track</p>
<pre class="r"><code>
vardatatable_containing_edutrack %&gt;% 
  select(Variable, `ICC educational track`, n) %&gt;% 
  arrange(desc(`ICC educational track`)) %&gt;% 
  top_n(20) %&gt;% 
  papaja::apa_table(caption = &quot;Intra-class correlations sorted by educational track ICC&quot;,
        format.args = list(digits = c(0), margin = 2))
## Selecting by n</code></pre>
<caption>
(#tab:icc-edu-track-only)
</caption>
<caption>
<em>Intra-class correlations sorted by educational track ICC</em>
</caption>
<table>
<thead>
<tr class="header">
<th align="left">Variable</th>
<th align="left">ICC educational track</th>
<th align="left">n</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">PA_integrated</td>
<td align="left">0.082</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">PA_autonomous</td>
<td align="left">0.073</td>
<td align="left">1078</td>
</tr>
<tr class="odd">
<td align="left">PA_intrinsic</td>
<td align="left">0.071</td>
<td align="left">1074</td>
</tr>
<tr class="even">
<td align="left">pafreqUsually</td>
<td align="left">0.069</td>
<td align="left">1082</td>
</tr>
<tr class="odd">
<td align="left">symptom</td>
<td align="left">0.066</td>
<td align="left">1084</td>
</tr>
<tr class="even">
<td align="left">PA_intention</td>
<td align="left">0.064</td>
<td align="left">1073</td>
</tr>
<tr class="odd">
<td align="left">PA_intention_02</td>
<td align="left">0.064</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">PA_intention_01</td>
<td align="left">0.061</td>
<td align="left">1073</td>
</tr>
<tr class="odd">
<td align="left">PA_dnorm_01</td>
<td align="left">0.054</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">PA_dnorm</td>
<td align="left">0.052</td>
<td align="left">1073</td>
</tr>
<tr class="odd">
<td align="left">PA_controlled</td>
<td align="left">0.051</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">pahrsUsually</td>
<td align="left">0.051</td>
<td align="left">1082</td>
</tr>
<tr class="odd">
<td align="left">PA_identified</td>
<td align="left">0.044</td>
<td align="left">1074</td>
</tr>
<tr class="even">
<td align="left">padaysLastweek</td>
<td align="left">0.04</td>
<td align="left">1082</td>
</tr>
<tr class="odd">
<td align="left">PA_actplan_04</td>
<td align="left">0.038</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">paLastweek</td>
<td align="left">0.037</td>
<td align="left">1082</td>
</tr>
<tr class="odd">
<td align="left">PA_actCop</td>
<td align="left">0.036</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">pahrsLastweek</td>
<td align="left">0.036</td>
<td align="left">1082</td>
</tr>
<tr class="odd">
<td align="left">PA_copingplan</td>
<td align="left">0.034</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">PA_copplan_03</td>
<td align="left">0.034</td>
<td align="left">1073</td>
</tr>
<tr class="odd">
<td align="left">PA_actplan_01</td>
<td align="left">0.033</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">PA_copplan_04</td>
<td align="left">0.033</td>
<td align="left">1073</td>
</tr>
<tr class="odd">
<td align="left">PA_actionplan</td>
<td align="left">0.031</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">PA_outcomeExpectations</td>
<td align="left">0.024</td>
<td align="left">1078</td>
</tr>
<tr class="odd">
<td align="left">PA_dnorm_02</td>
<td align="left">0.023</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">PA_copplan_01</td>
<td align="left">0.022</td>
<td align="left">1073</td>
</tr>
<tr class="odd">
<td align="left">PA_actplan_03</td>
<td align="left">0.02</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">PA_actplan_02</td>
<td align="left">0.018</td>
<td align="left">1073</td>
</tr>
<tr class="odd">
<td align="left">PA_copplan_02</td>
<td align="left">0.015</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">paminLastweek</td>
<td align="left">0.005</td>
<td align="left">1082</td>
</tr>
<tr class="odd">
<td align="left">PA_introjected</td>
<td align="left">0.001</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">PA_inorm</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="odd">
<td align="left">PA_inorm_01</td>
<td align="left">&lt; 0.001</td>
<td align="left">1073</td>
</tr>
<tr class="even">
<td align="left">PA_opportunities</td>
<td align="left">&lt; 0.001</td>
<td align="left">1075</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="cis-using-the-sandwich-estimator" class="section level2">
<h2>CIs using the sandwich estimator</h2>
<pre class="r"><code># Basic instructions are from https://web.archive.org/web/20180206180739/http://thestatsgeek.com/2014/02/14/the-robust-sandwich-variance-estimator-for-linear-regression-using-r/

names &lt;- df %&gt;% dplyr::select(-id, -intervention, -group, -school, -girl, -track, -trackSchool, -contains(&quot;_T3&quot;), -contains(&quot;_diff&quot;)) %&gt;% names(.)

# Create empty soon-to-be-filled objects
m &lt;- NA
sandwich_se &lt;- NA
mean &lt;- NA
ci_low &lt;- NA
ci_high &lt;- NA
nonmissings &lt;- NA

## To test the code with a single variable:
# df_for_sandwich &lt;- df %&gt;% select(group, school, track, sitLieAccelerometer_T1) %&gt;% na.omit()
# sandwich_clusters &lt;- df_for_sandwich %&gt;% select(group, school, track)
# m &lt;- lm(sitLieAccelerometer_T1 ~ 1, data=df_for_sandwich)
# sandwich_se &lt;- diag(sandwich::vcovCL(m, type = &quot;HC1&quot;, cluster = sandwich_clusters))^0.5
# mean &lt;- m$coefficients[[1]]
# ci_low &lt;- coef(m) - 1.96 * sandwich_se
# ci_high &lt;- coef(m) + 1.96 * sandwich_se
# nonmissings &lt;- nrow(m$model)


## Loop over each variable name, extract statistics: 
# for (i in names){
# df_for_sandwich &lt;- df %&gt;% select(
#   group, school, track, i) %&gt;% 
#   na.omit()
# sandwich_clusters &lt;- df_for_sandwich %&gt;% select(group, school, track)
# m &lt;- lm(paste0(i,&quot; ~ 1&quot;), data = df_for_sandwich)
# sandwich_se &lt;- diag(sandwich::vcovCL(m, type = &quot;HC1&quot;, cluster = sandwich_clusters))^0.5
# mean[i] &lt;- m$coefficients[[1]]
# ci_low[i] &lt;- coef(m) - 1.96 * sandwich_se
# ci_high[i] &lt;- coef(m) + 1.96 * sandwich_se
# nonmissings[i] &lt;- nrow(m$model)
# }
# 
# vardatatable_sandwich &lt;- data_frame(
#   Variable = stringr::str_sub(names(mean), end = -4), #remove &quot;_T1&quot; from names
#   Mean = round(mean, 1), 
#   CI95 = paste(round(ci_low, 1), &quot;-&quot;, round(ci_high, 1)), 
#   n = nonmissings) %&gt;% 
#   dplyr::arrange(Variable) %&gt;% 
#   filter(Variable != &quot;&quot;) #remove first row, which is empty
# 
# save(vardatatable_sandwich, file = &quot;vardatatable_sandwich.Rdata&quot;)
load(&quot;vardatatable_sandwich.Rdata&quot;)

# ci_sandwich &lt;- data_frame(
#   &quot;ciLo&quot; = ci_low,
#   &quot;mean&quot; = mean,
#   &quot;ciHi&quot; = ci_high,  
#   &quot;diamondlabels&quot; = names(mean)) %&gt;%  
#   filter(diamondlabels != &quot;&quot;) %&gt;% #remove first row, which is empty
#   as.data.frame()
# 
# save(ci_sandwich, file = &quot;ci_sandwich.Rdata&quot;)
load(&quot;ci_sandwich.Rdata&quot;)</code></pre>
</div>
<div id="observed-means-and-cis-without-clustering" class="section level2">
<h2>Observed means and CIs, without clustering</h2>
<pre class="r"><code>
df_for_uncorrected &lt;- df %&gt;% dplyr::select(-id, -intervention, -group, -school, -girl, -track, -trackSchool, -contains(&quot;_T3&quot;), -contains(&quot;_diff&quot;))

# Create empty soon-to-be-filled objects
mean_uncorrected &lt;- NA
ci_low &lt;- NA
ci_high &lt;- NA
nonmissings &lt;- NA

ci_uncorrected &lt;- rbind(
  df_for_uncorrected %&gt;% dplyr::summarise_all(funs(t.test(.)$conf.int[1])),
  df_for_uncorrected %&gt;% dplyr::summarise_all(funs(mean(., na.rm = TRUE))),
  df_for_uncorrected %&gt;% dplyr::summarise_all(funs(t.test(.)$conf.int[2]))) %&gt;% 
  t() %&gt;% 
  data.frame

names(ci_uncorrected) &lt;- c(&quot;ciLo&quot;, &quot;mean&quot;, &quot;ciHi&quot;)</code></pre>
<div id="compare-estimates-visually" class="section level3 tabset">
<h3>Compare estimates visually</h3>
<p>This section contains diamond plots comparing different estimates for means and CIs.</p>
<div id="high-mean-variables" class="section level4">
<h4>High-mean variables</h4>
<pre class="r"><code>ci_total_big &lt;- ci_total %&gt;% filter(mean &gt; 10)
ci_edutrack_big &lt;- ci_edutrack %&gt;% filter(mean &gt; 10)
ci_uncorrected_big &lt;- ci_uncorrected %&gt;% filter(mean &gt; 10)
ci_sandwich_big &lt;- ci_sandwich %&gt;% filter(mean &gt; 10)


for (i in 1:4){
plot1 &lt;- userfriendlyscience::diamondPlot(ci_total_big[i, ], 
                                          color = viridis::viridis(4)[1], 
                                          alpha=.15, 
                                          yLabels = ci_total_big[i, ]$diamondlabels, 
                                          fixedSize = 0.3, 
                                          xlab = NULL) +
  userfriendlyscience::diamondPlot(ci_edutrack_big[i, ], 
                                   returnLayerOnly = TRUE,
                                   color = viridis::viridis(4)[2], 
                                   alpha=.15, 
                                   yLabels = ci_edutrack_big[i, ]$diamondlabels, 
                                   fixedSize = 0.5, 
                                   xlab = NULL) +
  userfriendlyscience::diamondPlot(ci_uncorrected_big[i, ], 
                                   returnLayerOnly = TRUE,
                                   color = viridis::viridis(4)[3], 
                                   alpha=.15, 
                                   yLabels = ci_uncorrected_big[i, ]$diamondlabels, 
                                   fixedSize = 0.3, 
                                   xlab = NULL) +
  userfriendlyscience::diamondPlot(ci_sandwich_big[i, ], 
                                   returnLayerOnly = TRUE,
                                   color = viridis::viridis(4)[4], 
                                   alpha=.15, 
                                   yLabels = ci_uncorrected_big[i, ]$diamondlabels, 
                                   fixedSize = 0.3, 
                                   xlab = NULL) + 
  geom_rect(aes(xmin=Inf, xmax=Inf, ymin=Inf, ymax=Inf, fill = &quot;Classroom &amp; school&quot;), 
            colour=NA, alpha=0.05) + # Create invisible rectangle for legend
  geom_rect(aes(xmin=Inf, xmax=Inf, ymin=Inf, ymax=Inf, fill = &quot;Classroom, school &amp; track&quot;), 
            colour=NA, alpha=0.05) + # Create invisible rectangle for legend
  geom_rect(aes(xmin=Inf, xmax=Inf, ymin=Inf, ymax=Inf, fill = &quot;Uncorrected&quot;), 
            colour=NA, alpha=0.05) + # Create invisible rectangle for legend
  geom_rect(aes(xmin=Inf, xmax=Inf, ymin=Inf, ymax=Inf, fill = &quot;Sandwich&quot;), 
            colour=NA, alpha=0.05) + # Create invisible rectangle for legend
  scale_fill_manual(&#39;Model&#39;,
                    values = c(viridis::viridis(4)[1], 
                               viridis::viridis(4)[2], 
                               viridis::viridis(4)[4], 
                               viridis::viridis(4)[3]),
                    guide = guide_legend(override.aes = list(alpha = 1), ncol = 2)) +
  theme(legend.position=&quot;right&quot;) 
  plot(plot1)
}</code></pre>
<p><img src="baseline-supplement_files/figure-html/unnamed-chunk-7-1.png" width="2100" /><img src="baseline-supplement_files/figure-html/unnamed-chunk-7-2.png" width="2100" /><img src="baseline-supplement_files/figure-html/unnamed-chunk-7-3.png" width="2100" /><img src="baseline-supplement_files/figure-html/unnamed-chunk-7-4.png" width="2100" /></p>
</div>
<div id="other-variables" class="section level4">
<h4>Other variables</h4>
<pre class="r"><code># Take the high-mean variables out, because otherwise you&#39;d have something with a mean of 200 
# and a mean of 2 in the same plot, and scaling of the x-axis would smudge differences between the
# diamonds, which indicate the estimates

ci_total_small &lt;- ci_total %&gt;% filter(mean &lt;= 10)
ci_edutrack_small &lt;- ci_edutrack %&gt;% filter(mean &lt;= 10)
ci_uncorrected_small &lt;- ci_uncorrected %&gt;% filter(mean &lt;= 10)
ci_sandwich_small &lt;- ci_sandwich %&gt;% filter(mean &lt;= 10)

# Now, four data frames contain columns ciLo, mean, ciHi, and variable name, for each variable (i.e. row).
# Make a diamondPlot layer from each of these data frames, so that i number of variables are in the same plot: 

for (i in c(seq(from = 1, to = 171, by = 8))) {
plot1 &lt;- userfriendlyscience::diamondPlot(ci_total_small[i:(i + 8), ], 
                                          color = viridis::viridis(4)[1], 
                                          alpha=.15, 
                                          yLabels = ci_total_small[i:(i + 8), ]$diamondlabels, 
                                          fixedSize = 0.3, 
                                          xlab = NULL) +
  userfriendlyscience::diamondPlot(ci_edutrack_small[i:(i + 8), ], 
                                   returnLayerOnly = TRUE,
                                   color = viridis::viridis(4)[2], 
                                   alpha=.15, 
                                   yLabels = ci_edutrack_small[i:(i + 8), ]$diamondlabels, 
                                   fixedSize = 0.5, 
                                   xlab = NULL) +
  userfriendlyscience::diamondPlot(ci_uncorrected_small[i:(i + 8), ], 
                                   returnLayerOnly = TRUE,
                                   color = viridis::viridis(4)[3], 
                                   alpha=.15, 
                                   yLabels = ci_uncorrected_small[i:(i + 8), ]$diamondlabels, 
                                   fixedSize = 0.3, 
                                   xlab = NULL) +
  userfriendlyscience::diamondPlot(ci_sandwich_small[i:(i + 8), ], 
                                   returnLayerOnly = TRUE,
                                   color = viridis::viridis(4)[4], 
                                   alpha=.15, 
                                   yLabels = ci_uncorrected_small[i:(i + 8), ]$diamondlabels, 
                                   fixedSize = 0.3, 
                                   xlab = NULL) + 
  geom_rect(aes(xmin=Inf, xmax=Inf, ymin=Inf, ymax=Inf, fill = &quot;Classroom &amp; school&quot;), 
            colour=NA, alpha=0.05) + # Create invisible rectangle for legend
  geom_rect(aes(xmin=Inf, xmax=Inf, ymin=Inf, ymax=Inf, fill = &quot;Classroom, school &amp; track&quot;), 
            colour=NA, alpha=0.05) + # Create invisible rectangle for legend
  geom_rect(aes(xmin=Inf, xmax=Inf, ymin=Inf, ymax=Inf, fill = &quot;Uncorrected&quot;), 
            colour=NA, alpha=0.05) + # Create invisible rectangle for legend
  geom_rect(aes(xmin=Inf, xmax=Inf, ymin=Inf, ymax=Inf, fill = &quot;Sandwich&quot;), 
            colour=NA, alpha=0.05) + # Create invisible rectangle for legend
  scale_fill_manual(&#39;Model: &#39;,
                    values = c(viridis::viridis(4)[1], 
                               viridis::viridis(4)[2], 
                               viridis::viridis(4)[4], 
                               viridis::viridis(4)[3]),
                    guide = guide_legend(override.aes = list(alpha = 1), ncol = 2)) +
  theme(legend.position=&quot;bottom&quot;) 
  cat(&#39;\n\n####&#39;, i, &#39;\n\n  &#39;)
  print(plot1)
}</code></pre>
</div>
<div id="section" class="section level4">
<h4>1</h4>
<p><img src="baseline-supplement_files/figure-html/estimates%20for%20other%20variables-1.png" width="2100" /></p>
</div>
<div id="section-1" class="section level4">
<h4>9</h4>
<p><img src="baseline-supplement_files/figure-html/estimates%20for%20other%20variables-2.png" width="2100" /></p>
</div>
<div id="section-2" class="section level4">
<h4>17</h4>
<p><img src="baseline-supplement_files/figure-html/estimates%20for%20other%20variables-3.png" width="2100" /></p>
</div>
<div id="section-3" class="section level4">
<h4>25</h4>
<p><img src="baseline-supplement_files/figure-html/estimates%20for%20other%20variables-4.png" width="2100" /></p>
</div>
<div id="section-4" class="section level4">
<h4>33</h4>
<p><img src="baseline-supplement_files/figure-html/estimates%20for%20other%20variables-5.png" width="2100" /></p>
</div>
<div id="section-5" class="section level4">
<h4>41</h4>
<p><img src="baseline-supplement_files/figure-html/estimates%20for%20other%20variables-6.png" width="2100" /></p>
</div>
<div id="section-6" class="section level4">
<h4>49</h4>
<p><img src="baseline-supplement_files/figure-html/estimates%20for%20other%20variables-7.png" width="2100" /></p>
</div>
<div id="section-7" class="section level4">
<h4>57</h4>
<p><img src="baseline-supplement_files/figure-html/estimates%20for%20other%20variables-8.png" width="2100" /></p>
</div>
<div id="section-8" class="section level4">
<h4>65</h4>
<p><img src="baseline-supplement_files/figure-html/estimates%20for%20other%20variables-9.png" width="2100" /></p>
</div>
<div id="section-9" class="section level4">
<h4>73</h4>
<p><img src="baseline-supplement_files/figure-html/estimates%20for%20other%20variables-10.png" width="2100" /></p>
</div>
<div id="section-10" class="section level4">
<h4>81</h4>
<p><img src="baseline-supplement_files/figure-html/estimates%20for%20other%20variables-11.png" width="2100" /></p>
</div>
<div id="section-11" class="section level4">
<h4>89</h4>
<p><img src="baseline-supplement_files/figure-html/estimates%20for%20other%20variables-12.png" width="2100" /></p>
</div>
<div id="section-12" class="section level4">
<h4>97</h4>
<p><img src="baseline-supplement_files/figure-html/estimates%20for%20other%20variables-13.png" width="2100" /></p>
</div>
<div id="section-13" class="section level4">
<h4>105</h4>
<p><img src="baseline-supplement_files/figure-html/estimates%20for%20other%20variables-14.png" width="2100" /></p>
</div>
<div id="section-14" class="section level4">
<h4>113</h4>
<p><img src="baseline-supplement_files/figure-html/estimates%20for%20other%20variables-15.png" width="2100" /></p>
</div>
<div id="section-15" class="section level4">
<h4>121</h4>
<p><img src="baseline-supplement_files/figure-html/estimates%20for%20other%20variables-16.png" width="2100" /></p>
</div>
<div id="section-16" class="section level4">
<h4>129</h4>
<p><img src="baseline-supplement_files/figure-html/estimates%20for%20other%20variables-17.png" width="2100" /></p>
</div>
<div id="section-17" class="section level4">
<h4>137</h4>
<p><img src="baseline-supplement_files/figure-html/estimates%20for%20other%20variables-18.png" width="2100" /></p>
</div>
<div id="section-18" class="section level4">
<h4>145</h4>
<p><img src="baseline-supplement_files/figure-html/estimates%20for%20other%20variables-19.png" width="2100" /></p>
</div>
<div id="section-19" class="section level4">
<h4>153</h4>
<p><img src="baseline-supplement_files/figure-html/estimates%20for%20other%20variables-20.png" width="2100" /></p>
</div>
<div id="section-20" class="section level4">
<h4>161</h4>
<p><img src="baseline-supplement_files/figure-html/estimates%20for%20other%20variables-21.png" width="2100" /></p>
</div>
<div id="section-21" class="section level4">
<h4>169</h4>
<p><img src="baseline-supplement_files/figure-html/estimates%20for%20other%20variables-22.png" width="2100" /></p>
<pre class="r"><code>

CI_widths &lt;- data.frame(
  &quot;Label&quot; = ci_total$diamondlabels,
  &quot;Classroom &amp; school&quot; = (ci_total$ciHi - ci_total$ciLo), 
  &quot;Classroom, school &amp; track&quot; = (ci_edutrack$ciHi - ci_edutrack$ciLo), 
  &quot;Uncorrected&quot; = (ci_uncorrected$ciHi - ci_uncorrected$ciLo),
  &quot;Sandwich&quot; = (ci_sandwich$ciHi - ci_sandwich$ciLo)) %&gt;% 
  dplyr::arrange(Sandwich)

CI_widths %&gt;%
  dplyr::mutate(Label = as.numeric(as.factor(ci_total$diamondlabels)))  %&gt;% 
  tidyr::gather(estimator, value, 2:Sandwich) %&gt;% 
  ggplot2::ggplot(aes(x = Label, y = value, group = estimator)) +
    geom_line(aes(color = estimator)) +
    ggtitle(&quot;All variables&quot;)</code></pre>
<p><img src="baseline-supplement_files/figure-html/unnamed-chunk-8-1.png" width="2100" /></p>
<pre class="r"><code>
CI_widths %&gt;%
  dplyr::mutate(Label = (ci_total$diamondlabels))  %&gt;% 
  tidyr::gather(estimator, value, 2:Sandwich) %&gt;% 
  ggplot2::ggplot(aes(x = Label, y = value, group = estimator)) +
    geom_line(aes(color = estimator)) +
    coord_cartesian(xlim = c(75, 100), ylim = c(0, 100)) +
    theme(axis.text.x=element_text(angle = 45, hjust = 1)) +
    ggtitle(&quot;Zoomed into bumps&quot;)</code></pre>
<p><img src="baseline-supplement_files/figure-html/unnamed-chunk-8-2.png" width="2100" /></p>
<pre class="r"><code>
CI_widths %&gt;%
  dplyr::mutate(Label = (ci_total$diamondlabels))  %&gt;% 
  tidyr::gather(estimator, value, 2:Sandwich) %&gt;% 
  ggplot2::ggplot(aes(x = Label, y = value, group = estimator)) +
    geom_line(aes(color = estimator)) +
    coord_cartesian(xlim = c(81, 83), ylim = c(0, 100)) +
    theme(axis.text.x=element_text(angle = 45, hjust = 1)) +
    ggtitle(&quot;Zoomed into first bump&quot;)</code></pre>
<p><img src="baseline-supplement_files/figure-html/unnamed-chunk-8-3.png" width="2100" /></p>
<pre class="r"><code>
CI_widths %&gt;%
  dplyr::mutate(Label = (ci_total$diamondlabels))  %&gt;% 
  tidyr::gather(estimator, value, 2:Sandwich) %&gt;% 
  ggplot2::ggplot(aes(x = Label, y = value, group = estimator)) +
    geom_line(aes(color = estimator)) +
    coord_cartesian(xlim = c(87, 89), ylim = c(0, 100)) +
    theme(axis.text.x=element_text(angle = 45, hjust = 1)) +
    ggtitle(&quot;Zoomed into first bump&quot;)</code></pre>
<p><img src="baseline-supplement_files/figure-html/unnamed-chunk-8-4.png" width="2100" /></p>
<pre class="r"><code>
# DELETE THESE:

CI_widths %&gt;%
#  mutate(Label = as.numeric(as.factor(ci_total$diamondlabels))) %&gt;% 
  gather(estimator, value, 2:Sandwich) %&gt;% 
  ggplot(aes(x = Label, y = value, group = estimator)) +
    geom_line(aes(color = estimator)) +
    ggtitle(&quot;Zoom into the bumps&quot;) +
    coord_cartesian(xlim = c(75, 100), ylim = c(0, 7)) +
    theme(axis.text.x=element_text(angle = 45, hjust = 1)) </code></pre>
<p><img src="baseline-supplement_files/figure-html/unnamed-chunk-8-5.png" width="2100" /></p>
<pre class="r"><code>
CI_widths %&gt;%
#  mutate(Label = as.numeric(as.factor(ci_total$diamondlabels))) %&gt;% 
  gather(estimator, value, 2:Sandwich) %&gt;% 
  ggplot(aes(x = Label, y = value, group = estimator)) +
    geom_line(aes(color = estimator)) +
    ggtitle(&quot;Zoom into second bump&quot;) +
    coord_cartesian(xlim = c(127, 130), ylim = c(0, 50)) +
    theme(axis.text.x=element_text(angle = 45, hjust = 1)) </code></pre>
<p><img src="baseline-supplement_files/figure-html/unnamed-chunk-8-6.png" width="2100" /></p>
<pre class="r"><code>
CI_widths %&gt;%
#  mutate(Label = as.numeric(as.factor(ci_total$diamondlabels))) %&gt;% 
  gather(estimator, value, 2:Sandwich) %&gt;% 
  ggplot(aes(x = Label, y = value, group = estimator)) +
    geom_line(aes(color = estimator)) +
    ggtitle(&quot;Zoom into third bump&quot;) +
    coord_cartesian(xlim = c(133, 135), ylim = c(0, 200)) +
    theme(axis.text.x=element_text(angle = 45, hjust = 1)) </code></pre>
<p><img src="baseline-supplement_files/figure-html/unnamed-chunk-8-7.png" width="2100" /></p>
<pre class="r"><code>
CI_widths %&gt;%
#  mutate(Label = as.numeric(as.factor(ci_total$diamondlabels))) %&gt;% 
  gather(estimator, value, 2:Sandwich) %&gt;% 
  ggplot(aes(x = Label, y = value, group = estimator)) +
    geom_line(aes(color = estimator)) +
    ggtitle(&quot;Zoom into fourth bump&quot;) +
    coord_cartesian(xlim = c(160, 163), ylim = c(0, 200)) +
    theme(axis.text.x=element_text(angle = 45, hjust = 1))</code></pre>
<p><img src="baseline-supplement_files/figure-html/unnamed-chunk-8-8.png" width="2100" /></p>
<pre class="r"><code>

CI_widths %&gt;%
#  mutate(Label = as.numeric(as.factor(ci_total$diamondlabels))) %&gt;% 
  gather(estimator, value, 2:Sandwich) %&gt;% 
  ggplot(aes(x = Label, y = value, group = estimator)) +
    geom_line(aes(color = estimator)) +
    ggtitle(&quot;Zoom into fourth bump&quot;) +
    coord_cartesian(xlim = c(0, 10), ylim = c(0, 1.25)) +
    theme(axis.text.x=element_text(angle = 45, hjust = 1))</code></pre>
<p><img src="baseline-supplement_files/figure-html/unnamed-chunk-8-9.png" width="2100" /></p>
<pre class="r"><code>
# # test to see all labels are in the right order
# data.frame(
#   Label = ci_total$diamondlabels,
#   label2 = ci_edutrack$diamondlabels,
#   label3 = ci_uncorrected$diamondlabels,
#   label4 = ci_sandwich) %&gt;% rowwise %&gt;% 
#   mutate(test1 = ifelse(Label == label2, &quot;OK&quot;,
#                         ifelse(label2 == label3, &quot;OK&quot;, 
#                                ifelse(label3 == label4, &quot;OK&quot;, &quot;DISCREPANCY&quot;))))

CI_widths %&gt;% summarise(meanClassroom...school = mean(Classroom...school), meanClassroom..school...track = mean(Classroom..school...track, na.rm = TRUE),
                        meanOnly.track = mean(Uncorrected), meanSandwich = mean(Sandwich, na.rm = TRUE))</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["meanClassroom...school"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["meanClassroom..school...track"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["meanOnly.track"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["meanSandwich"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"1.522327","2":"2.318084","3":"0.587922","4":"2.005593"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</div>
<div id="create-confidence-bounds-for-all-items-by-gender-and-intervention-allocation" class="section level2">
<h2>Create confidence bounds for all items by gender and intervention allocation</h2>
<p>These numbers are visualised with diamond plots later.</p>
<pre class="r"><code>names &lt;- df %&gt;% select(-id, -intervention, -group, -school, -girl, -track, -trackSchool, -contains(&quot;_T3&quot;), -contains(&quot;_diff&quot;)) %&gt;% names(.)

# Intercepts for boys; when boy is 1, girl is 0, but boy is a factor, so intercept is for boys even though boy is 1 for boys and 0 for girls.
m.boys &lt;- NA
mean.boys &lt;- NA
m_p.boys &lt;- NA
ci_low.boys &lt;- NA
ci_high.boys &lt;- NA
ICC_group.boys &lt;- NA
ICC_School.boys &lt;- NA
nonmissings.boys &lt;- NA

df.boys &lt;- df %&gt;% mutate(boy = factor(ifelse(girl == &quot;girl&quot;, 0, 1), levels = c(1, 0)))

for (i in names){
m.boys &lt;- lme4::lmer(paste0(i,&quot; ~ (1|school) + (1|group) + boy&quot;), data=df.boys)
mean.boys[i] &lt;- lme4::fixef(m.boys)[1]
m_p.boys &lt;- profile(m.boys, which = &quot;beta_&quot;)
ci_low.boys[i] &lt;- confint(m_p.boys)[1, 1]
ci_high.boys[i] &lt;- confint(m_p.boys)[1, 2]
ICC_group.boys[i] &lt;- sjstats::icc(m.boys)[1]
ICC_School.boys[i] &lt;- sjstats::icc(m.boys)[2]
nonmissings.boys[i] &lt;- length(m.boys@resp$y)
}
## Warning in optwrap(optimizer, par = thopt, fn = mkdevfun(rho, 0L), lower
## = fitted@lower): convergence code 3 from bobyqa: bobyqa -- a trust region
## step failed to reduce q

## Warning in optwrap(optimizer, par = thopt, fn = mkdevfun(rho, 0L), lower
## = fitted@lower): convergence code 3 from bobyqa: bobyqa -- a trust region
## step failed to reduce q
## Warning in nextpar(mat, cc, i, delta, lowcut, upcut): unexpected decrease
## in profile: using minstep
## Warning in profile.merMod(m.boys, which = &quot;beta_&quot;): non-monotonic profile
## for (Intercept)
## Warning in optwrap(optimizer, par = thopt, fn = mkdevfun(rho, 0L), lower
## = fitted@lower): convergence code 3 from bobyqa: bobyqa -- a trust region
## step failed to reduce q
## Warning in confint.thpr(m_p.boys): bad spline fit for (Intercept): falling
## back to linear interpolation

## Warning in confint.thpr(m_p.boys): bad spline fit for (Intercept): falling
## back to linear interpolation
## Warning in optwrap(optimizer, par = thopt, fn = mkdevfun(rho, 0L), lower
## = fitted@lower): convergence code 3 from bobyqa: bobyqa -- a trust region
## step failed to reduce q

## Warning in optwrap(optimizer, par = thopt, fn = mkdevfun(rho, 0L), lower
## = fitted@lower): convergence code 3 from bobyqa: bobyqa -- a trust region
## step failed to reduce q

## Warning in optwrap(optimizer, par = thopt, fn = mkdevfun(rho, 0L), lower
## = fitted@lower): convergence code 3 from bobyqa: bobyqa -- a trust region
## step failed to reduce q

## Warning in optwrap(optimizer, par = thopt, fn = mkdevfun(rho, 0L), lower
## = fitted@lower): convergence code 3 from bobyqa: bobyqa -- a trust region
## step failed to reduce q

## Warning in optwrap(optimizer, par = thopt, fn = mkdevfun(rho, 0L), lower
## = fitted@lower): convergence code 3 from bobyqa: bobyqa -- a trust region
## step failed to reduce q
## Warning in optwrap(optimizer, par = thopt, fn = mkdevfun(rho, 0L), lower =
## fitted@lower): convergence code 1 from bobyqa: bobyqa -- maximum number of
## function evaluations exceeded
## Warning in optwrap(optimizer, par = thopt, fn = mkdevfun(rho, 0L), lower
## = fitted@lower): convergence code 3 from bobyqa: bobyqa -- a trust region
## step failed to reduce q

## Warning in optwrap(optimizer, par = thopt, fn = mkdevfun(rho, 0L), lower
## = fitted@lower): convergence code 3 from bobyqa: bobyqa -- a trust region
## step failed to reduce q

## Warning in optwrap(optimizer, par = thopt, fn = mkdevfun(rho, 0L), lower
## = fitted@lower): convergence code 3 from bobyqa: bobyqa -- a trust region
## step failed to reduce q

## Warning in optwrap(optimizer, par = thopt, fn = mkdevfun(rho, 0L), lower
## = fitted@lower): convergence code 3 from bobyqa: bobyqa -- a trust region
## step failed to reduce q

## Warning in optwrap(optimizer, par = thopt, fn = mkdevfun(rho, 0L), lower
## = fitted@lower): convergence code 3 from bobyqa: bobyqa -- a trust region
## step failed to reduce q

## Warning in optwrap(optimizer, par = thopt, fn = mkdevfun(rho, 0L), lower
## = fitted@lower): convergence code 3 from bobyqa: bobyqa -- a trust region
## step failed to reduce q

cat(&quot;The labels are arranged such that intercept is not for girls:&quot;, labels(lme4::fixef(m.boys))[2] == &quot;boy0&quot;)
## The labels are arranged such that intercept is not for girls: TRUE

ci_boys &lt;- data.frame(ciLo = ci_low.boys, mean = mean.boys, ciHi = ci_high.boys)
diamondlabels &lt;- labels(ci_boys)[[1]]
ci_boys &lt;- data.frame(ci_boys, diamondlabels)

# Intercepts for girls; when boy is 1, girl is 0, but boy is a factor, so intercept is for girls even though girl is 1 for girls and 0 for boys.
m.girls &lt;- NA
mean.girls &lt;- NA
m_p.girls &lt;- NA
ci_low.girls &lt;- NA
ci_high.girls &lt;- NA
ICC_group.girls &lt;- NA
ICC_School.girls &lt;- NA
nonmissings.girls &lt;- NA

for (i in names){
m.girls &lt;- lme4::lmer(paste0(i,&quot; ~ (1|school) + (1|group) + girl&quot;), data=df)
mean.girls[i] &lt;- lme4::fixef(m.girls)[1]
m_p.girls &lt;- profile(m.girls, which = &quot;beta_&quot;)
ci_low.girls[i] &lt;- confint(m_p.girls)[1, 1]
ci_high.girls[i] &lt;- confint(m_p.girls)[1, 2]
ICC_group.girls[i] &lt;- sjstats::icc(m.girls)[1]
ICC_School.girls[i] &lt;- sjstats::icc(m.girls)[2]
nonmissings.girls[i] &lt;- length(m.girls@resp$y)
}
## Warning in optwrap(optimizer, par = thopt, fn = mkdevfun(rho, 0L), lower
## = fitted@lower): convergence code 3 from bobyqa: bobyqa -- a trust region
## step failed to reduce q

## Warning in optwrap(optimizer, par = thopt, fn = mkdevfun(rho, 0L), lower
## = fitted@lower): convergence code 3 from bobyqa: bobyqa -- a trust region
## step failed to reduce q
## Warning in optwrap(optimizer, devfun, x@theta, lower = x@lower, calc.derivs
## = TRUE, : convergence code 3 from bobyqa: bobyqa -- a trust region step
## failed to reduce q
## Warning in nextpar(mat, cc, i, delta, lowcut, upcut): unexpected decrease
## in profile: using minstep
## Warning in profile.merMod(m.girls, which = &quot;beta_&quot;): non-monotonic profile
## for (Intercept)
## Warning in optwrap(optimizer, par = thopt, fn = mkdevfun(rho, 0L), lower
## = fitted@lower): convergence code 3 from bobyqa: bobyqa -- a trust region
## step failed to reduce q
## Warning in confint.thpr(m_p.girls): bad spline fit for (Intercept): falling
## back to linear interpolation

## Warning in confint.thpr(m_p.girls): bad spline fit for (Intercept): falling
## back to linear interpolation
## Warning in optwrap(optimizer, par = thopt, fn = mkdevfun(rho, 0L), lower
## = fitted@lower): convergence code 3 from bobyqa: bobyqa -- a trust region
## step failed to reduce q

## Warning in optwrap(optimizer, par = thopt, fn = mkdevfun(rho, 0L), lower
## = fitted@lower): convergence code 3 from bobyqa: bobyqa -- a trust region
## step failed to reduce q

## Warning in optwrap(optimizer, par = thopt, fn = mkdevfun(rho, 0L), lower
## = fitted@lower): convergence code 3 from bobyqa: bobyqa -- a trust region
## step failed to reduce q
## Warning in optwrap(optimizer, devfun, x@theta, lower = x@lower, calc.derivs
## = TRUE, : convergence code 3 from bobyqa: bobyqa -- a trust region step
## failed to reduce q
## Warning in nextpar(mat, cc, i, delta, lowcut, upcut): unexpected decrease
## in profile: using minstep
## Warning in profile.merMod(m.girls, which = &quot;beta_&quot;): non-monotonic profile
## for (Intercept)
## Warning in optwrap(optimizer, par = thopt, fn = mkdevfun(rho, 0L), lower
## = fitted@lower): convergence code 3 from bobyqa: bobyqa -- a trust region
## step failed to reduce q
## Warning in confint.thpr(m_p.girls): bad spline fit for (Intercept): falling
## back to linear interpolation

## Warning in confint.thpr(m_p.girls): bad spline fit for (Intercept): falling
## back to linear interpolation

cat(&quot;The labels are arranged such that intercept is not for boys:&quot;, labels(lme4::fixef(m.girls))[2] == &quot;girl0&quot;)
## The labels are arranged such that intercept is not for boys: FALSE

ci_girls &lt;- data.frame(ciLo = ci_low.girls, mean = mean.girls, ciHi = ci_high.girls)
diamondlabels &lt;- labels(ci_girls)[[1]]
ci_girls &lt;- data.frame(ci_girls, diamondlabels)


# Intercepts for intervention
m.intervention &lt;- NA
mean.intervention &lt;- NA
m_p.intervention &lt;- NA
ci_low.intervention &lt;- NA
ci_high.intervention &lt;- NA
ICC_group.intervention &lt;- NA
ICC_School.intervention &lt;- NA
nonmissings.intervention &lt;- NA

## change &quot;intervention&quot; to be consistent regarding level order with &quot;girl&quot;.
df.intervention &lt;- df %&gt;% mutate(intervention = factor(intervention, levels = c(1, 0)))

for (i in names){
m.intervention &lt;- lme4::lmer(paste0(i,&quot; ~ (1|school) + (1|group) + intervention&quot;), data=df.intervention)
mean.intervention[i] &lt;- lme4::fixef(m.intervention)[1]
m_p.intervention &lt;- profile(m.intervention, which = &quot;beta_&quot;)
ci_low.intervention[i] &lt;- confint(m_p.intervention)[1, 1]
ci_high.intervention[i] &lt;- confint(m_p.intervention)[1, 2]
ICC_group.intervention[i] &lt;- sjstats::icc(m.intervention)[1]
ICC_School.intervention[i] &lt;- sjstats::icc(m.intervention)[2]
nonmissings.intervention[i] &lt;- length(m.intervention@resp$y)
}
## Warning in optwrap(optimizer, par = thopt, fn = mkdevfun(rho, 0L), lower
## = fitted@lower): convergence code 3 from bobyqa: bobyqa -- a trust region
## step failed to reduce q
## Warning in optwrap(optimizer, par = thopt, fn = mkdevfun(rho, 0L), lower
## = fitted@lower): convergence code 3 from bobyqa: bobyqa -- a trust region
## step failed to reduce q
## Warning in nextpar(mat, cc, i, delta, lowcut, upcut): unexpected decrease
## in profile: using minstep
## Warning in profile.merMod(m.intervention, which = &quot;beta_&quot;): non-monotonic
## profile for (Intercept)
## Warning in confint.thpr(m_p.intervention): bad spline fit for (Intercept):
## falling back to linear interpolation

## Warning in confint.thpr(m_p.intervention): bad spline fit for (Intercept):
## falling back to linear interpolation
## Warning in optwrap(optimizer, devfun, x@theta, lower = x@lower, calc.derivs
## = TRUE, : convergence code 3 from bobyqa: bobyqa -- a trust region step
## failed to reduce q
## Warning in nextpar(mat, cc, i, delta, lowcut, upcut): unexpected decrease
## in profile: using minstep
## Warning in profile.merMod(m.intervention, which = &quot;beta_&quot;): non-monotonic
## profile for (Intercept)
## Warning in confint.thpr(m_p.intervention): bad spline fit for (Intercept):
## falling back to linear interpolation

## Warning in confint.thpr(m_p.intervention): bad spline fit for (Intercept):
## falling back to linear interpolation
## Warning in nextpar(mat, cc, i, delta, lowcut, upcut): unexpected decrease
## in profile: using minstep
## Warning in profile.merMod(m.intervention, which = &quot;beta_&quot;): non-monotonic
## profile for (Intercept)
## Warning in nextpar(mat, cc, i, delta, lowcut, upcut): unexpected decrease
## in profile: using minstep
## Warning in profile.merMod(m.intervention, which = &quot;beta_&quot;): non-monotonic
## profile for intervention0
## Warning in confint.thpr(m_p.intervention): bad spline fit for (Intercept):
## falling back to linear interpolation
## Warning in confint.thpr(m_p.intervention): bad spline fit for
## intervention0: falling back to linear interpolation
## Warning in confint.thpr(m_p.intervention): bad spline fit for (Intercept):
## falling back to linear interpolation
## Warning in confint.thpr(m_p.intervention): bad spline fit for
## intervention0: falling back to linear interpolation
## Warning in optwrap(optimizer, par = thopt, fn = mkdevfun(rho, 0L), lower
## = fitted@lower): convergence code 3 from bobyqa: bobyqa -- a trust region
## step failed to reduce q

## Warning in optwrap(optimizer, par = thopt, fn = mkdevfun(rho, 0L), lower
## = fitted@lower): convergence code 3 from bobyqa: bobyqa -- a trust region
## step failed to reduce q
## Warning in nextpar(mat, cc, i, delta, lowcut, upcut): unexpected decrease
## in profile: using minstep
## Warning in optwrap(optimizer, par = thopt, fn = mkdevfun(rho, 0L), lower
## = fitted@lower): convergence code 3 from bobyqa: bobyqa -- a trust region
## step failed to reduce q

## Warning in optwrap(optimizer, par = thopt, fn = mkdevfun(rho, 0L), lower
## = fitted@lower): convergence code 3 from bobyqa: bobyqa -- a trust region
## step failed to reduce q
## Warning in profile.merMod(m.intervention, which = &quot;beta_&quot;): non-monotonic
## profile for (Intercept)
## Warning in nextpar(mat, cc, i, delta, lowcut, upcut): unexpected decrease
## in profile: using minstep
## Warning in profile.merMod(m.intervention, which = &quot;beta_&quot;): non-monotonic
## profile for intervention0
## Warning in confint.thpr(m_p.intervention): bad spline fit for (Intercept):
## falling back to linear interpolation
## Warning in confint.thpr(m_p.intervention): bad spline fit for
## intervention0: falling back to linear interpolation
## Warning in confint.thpr(m_p.intervention): bad spline fit for (Intercept):
## falling back to linear interpolation
## Warning in confint.thpr(m_p.intervention): bad spline fit for
## intervention0: falling back to linear interpolation
## Warning in nextpar(mat, cc, i, delta, lowcut, upcut): unexpected decrease
## in profile: using minstep
## Warning in profile.merMod(m.intervention, which = &quot;beta_&quot;): non-monotonic
## profile for (Intercept)
## Warning in nextpar(mat, cc, i, delta, lowcut, upcut): unexpected decrease
## in profile: using minstep
## Warning in profile.merMod(m.intervention, which = &quot;beta_&quot;): non-monotonic
## profile for intervention0
## Warning in confint.thpr(m_p.intervention): bad spline fit for (Intercept):
## falling back to linear interpolation
## Warning in confint.thpr(m_p.intervention): bad spline fit for
## intervention0: falling back to linear interpolation
## Warning in confint.thpr(m_p.intervention): bad spline fit for (Intercept):
## falling back to linear interpolation
## Warning in confint.thpr(m_p.intervention): bad spline fit for
## intervention0: falling back to linear interpolation

cat(&quot;The labels are arranged such that intercept is not for control:&quot;, labels(lme4::fixef(m.intervention))[2] == &quot;intervention0&quot;)
## The labels are arranged such that intercept is not for control: TRUE

ci_intervention &lt;- data.frame(ciLo = ci_low.intervention, mean = mean.intervention, ciHi = ci_high.intervention)
diamondlabels &lt;- labels(ci_intervention)[[1]]
ci_intervention &lt;- data.frame(ci_intervention, diamondlabels)

# Intercepts for control

m.control &lt;- NA
mean.control &lt;- NA
m_p.control &lt;- NA
ci_low.control &lt;- NA
ci_high.control &lt;- NA
ICC_group.control &lt;- NA
ICC_School.control &lt;- NA
nonmissings.control &lt;- NA

df.control &lt;- df %&gt;% mutate(control = factor(ifelse(intervention == 1, 0, 1), levels = c(1, 0)))

for (i in names){
m.control &lt;- lme4::lmer(paste0(i,&quot; ~ (1|school) + (1|group) + control&quot;), data=df.control)
mean.control[i] &lt;- lme4::fixef(m.control)[1]
m_p.control &lt;- profile(m.control, which = &quot;beta_&quot;)
ci_low.control[i] &lt;- confint(m_p.control)[1, 1]
ci_high.control[i] &lt;- confint(m_p.control)[1, 2]
ICC_group.control[i] &lt;- sjstats::icc(m.control)[1]
ICC_School.control[i] &lt;- sjstats::icc(m.control)[2]
nonmissings.control[i] &lt;- length(m.control@resp$y)
}
## Warning in nextpar(mat, cc, i, delta, lowcut, upcut): unexpected decrease
## in profile: using minstep
## Warning in optwrap(optimizer, par = thopt, fn = mkdevfun(rho, 0L), lower
## = fitted@lower): convergence code 3 from bobyqa: bobyqa -- a trust region
## step failed to reduce q
## Warning in nextpar(mat, cc, i, delta, lowcut, upcut): unexpected decrease
## in profile: using minstep
## Warning in profile.merMod(m.control, which = &quot;beta_&quot;): non-monotonic
## profile for (Intercept)
## Warning in confint.thpr(m_p.control): bad spline fit for (Intercept):
## falling back to linear interpolation

## Warning in confint.thpr(m_p.control): bad spline fit for (Intercept):
## falling back to linear interpolation
## Warning in optwrap(optimizer, par = thopt, fn = mkdevfun(rho, 0L), lower
## = fitted@lower): convergence code 3 from bobyqa: bobyqa -- a trust region
## step failed to reduce q

## Warning in optwrap(optimizer, par = thopt, fn = mkdevfun(rho, 0L), lower
## = fitted@lower): convergence code 3 from bobyqa: bobyqa -- a trust region
## step failed to reduce q
## Warning in nextpar(mat, cc, i, delta, lowcut, upcut): unexpected decrease
## in profile: using minstep
## Warning in profile.merMod(m.control, which = &quot;beta_&quot;): non-monotonic
## profile for control0
## Warning in confint.thpr(m_p.control): bad spline fit for control0: falling
## back to linear interpolation

## Warning in confint.thpr(m_p.control): bad spline fit for control0: falling
## back to linear interpolation
## Warning in optwrap(optimizer, par = thopt, fn = mkdevfun(rho, 0L), lower
## = fitted@lower): convergence code 3 from bobyqa: bobyqa -- a trust region
## step failed to reduce q
## Warning in nextpar(mat, cc, i, delta, lowcut, upcut): unexpected decrease
## in profile: using minstep
## Warning in optwrap(optimizer, par = thopt, fn = mkdevfun(rho, 0L), lower
## = fitted@lower): convergence code 3 from bobyqa: bobyqa -- a trust region
## step failed to reduce q
## Warning in nextpar(mat, cc, i, delta, lowcut, upcut): unexpected decrease
## in profile: using minstep
## Warning in profile.merMod(m.control, which = &quot;beta_&quot;): non-monotonic
## profile for (Intercept)
## Warning in nextpar(mat, cc, i, delta, lowcut, upcut): unexpected decrease
## in profile: using minstep
## Warning in profile.merMod(m.control, which = &quot;beta_&quot;): non-monotonic
## profile for control0
## Warning in confint.thpr(m_p.control): bad spline fit for (Intercept):
## falling back to linear interpolation
## Warning in confint.thpr(m_p.control): bad spline fit for control0: falling
## back to linear interpolation
## Warning in confint.thpr(m_p.control): bad spline fit for (Intercept):
## falling back to linear interpolation
## Warning in confint.thpr(m_p.control): bad spline fit for control0: falling
## back to linear interpolation
## Warning in optwrap(optimizer, par = thopt, fn = mkdevfun(rho, 0L), lower
## = fitted@lower): convergence code 3 from bobyqa: bobyqa -- a trust region
## step failed to reduce q

## Warning in optwrap(optimizer, par = thopt, fn = mkdevfun(rho, 0L), lower
## = fitted@lower): convergence code 3 from bobyqa: bobyqa -- a trust region
## step failed to reduce q

## Warning in optwrap(optimizer, par = thopt, fn = mkdevfun(rho, 0L), lower
## = fitted@lower): convergence code 3 from bobyqa: bobyqa -- a trust region
## step failed to reduce q

## Warning in optwrap(optimizer, par = thopt, fn = mkdevfun(rho, 0L), lower
## = fitted@lower): convergence code 3 from bobyqa: bobyqa -- a trust region
## step failed to reduce q
## Warning in nextpar(mat, cc, i, delta, lowcut, upcut): unexpected decrease
## in profile: using minstep
## Warning in profile.merMod(m.control, which = &quot;beta_&quot;): non-monotonic
## profile for control0
## Warning in confint.thpr(m_p.control): bad spline fit for control0: falling
## back to linear interpolation

## Warning in confint.thpr(m_p.control): bad spline fit for control0: falling
## back to linear interpolation
## Warning in nextpar(mat, cc, i, delta, lowcut, upcut): unexpected decrease
## in profile: using minstep
## Warning in profile.merMod(m.control, which = &quot;beta_&quot;): non-monotonic
## profile for (Intercept)
## Warning in confint.thpr(m_p.control): bad spline fit for (Intercept):
## falling back to linear interpolation

## Warning in confint.thpr(m_p.control): bad spline fit for (Intercept):
## falling back to linear interpolation

cat(&quot;The labels are arranged such that intercept is not for intervention:&quot;, labels(lme4::fixef(m.control))[2] == &quot;control0&quot;)
## The labels are arranged such that intercept is not for intervention: TRUE

ci_control &lt;- data.frame(ciLo = ci_low.control, mean = mean.control, ciHi = ci_high.control)
diamondlabels &lt;- labels(ci_control)[[1]]
ci_control &lt;- data.frame(ci_control, diamondlabels)

# Same ICC results you&#39;d get with e.g.:
# m1 &lt;- as.data.frame(VarCorr(m))
# m1$vcov[1] / (m1$vcov[1] + m1$vcov[3])

# Or from broom:
# tidy(m)$estimate[2]^2 / (tidy(m)$estimate[2]^2 + tidy(m)$estimate[4]^2)

# Or from sjstats:
# sum(get_re_var(m)) / (sum(get_re_var(m)) + get_re_var(m, &quot;sigma_2&quot;))

# save(ci_control, file = &quot;ci_control.Rdata&quot;)
# save(ci_intervention, file = &quot;ci_intervention.Rdata&quot;)
# save(ci_girls, file = &quot;ci_girls.Rdata&quot;)
# save(ci_boys, file = &quot;ci_boys.Rdata&quot;)

load(&quot;ci_control.Rdata&quot;)
load(&quot;ci_intervention.Rdata&quot;)
load(&quot;ci_girls.Rdata&quot;)
load(&quot;ci_boys.Rdata&quot;)</code></pre>
</div>
</div>
<div id="descriptive-tables" class="section level1">
<h1>Descriptive tables</h1>
<div id="prepare-data" class="section level2">
<h2>prepare data</h2>
<pre class="r"><code>
demographics &lt;- lmi %&gt;% dplyr::select(id = ID,
birthYear = Kys0004.1,
intervention = ryhma,
school = Aineisto.1,
girl = Kys0013.1,
ethnicity = Kys0005.1,
studyYear = Kys0014.1) %&gt;% 
  mutate(age = 2016 - birthYear,
         intervention = ifelse(intervention == 1, 1, 0),
         intervention = as.numeric(intervention),
         girl = ifelse(girl == 2, 1, 0),
          girl = as.numeric(girl, levels = c(&quot;1&quot;, &quot;0&quot;)),
         school = factor(school, levels = c(&quot;1&quot;, &quot;2&quot;, &quot;3&quot;, &quot;4&quot;, &quot;5&quot;)),
         bornInFinland = as.numeric(ifelse(ethnicity == 1, 1, 0)),
         studyYear = ifelse(studyYear == 0, NA, studyYear)) # Remove &quot;other&quot; from study year
## Error in mutate_impl(.data, dots): Evaluation error: `x` and `labels` must be same type.

# Insert track variable with those who answered &quot;other&quot; with one of the actual category labels given the appropriate category:
Track &lt;- lmi %&gt;% select(Kys0016.1, Kys0017.1) %&gt;% mutate(
  Kys0016.1 = ifelse(Kys0017.1 == &quot;Merkonomi&quot; | Kys0017.1 == &quot;merkonomi&quot;, 3,
                  ifelse(Kys0017.1 == &quot;Datanomi&quot; | Kys0017.1 == &quot;datanomi&quot;, 2, Kys0016.1)),
  Track = factor(Kys0016.1, # Fix track labels first
                     levels = c(0, 1, 2, 3, 4),
                     labels = c(&quot;Other&quot;, &quot;Business IT&quot;, &quot;Business Admin&quot;, &quot;HRC&quot;, &quot;Nursing&quot;))) %&gt;% 
  select(-Kys0016.1, -Kys0017.1)
## Error in mutate_impl(.data, dots): Evaluation error: `x` and `labels` must be same type.

demographics &lt;- bind_cols(demographics, Track)
## Error in dots_values(...): object &#39;demographics&#39; not found</code></pre>
</div>
<div id="create-demographic-tables" class="section level2">
<h2>Create demographic tables</h2>
<div id="by-educational-track" class="section level3">
<h3>By educational track</h3>
<pre class="r"><code>demotable &lt;- demographics %&gt;% 
  group_by(Track) %&gt;% 
  summarise(&quot;Mean age (range)&quot; = paste0(round(mean(age, na.rm = T), 1),&quot; (&quot;, 
                                        range(age, na.rm = T)[1], &quot;-&quot;,
                                        range(age, na.rm = T)[2], &quot;)&quot;),
            &quot;Mean study year (sd)&quot; = paste0(round(mean(studyYear, na.rm = T), 1),&quot; (&quot;, 
                                               round(sd(studyYear, na.rm = T), 1), &quot;)&quot;),
            &quot;% girl&quot; = round(mean(girl, na.rm = T)*100, 1),
            &quot;% intervention&quot; = round(mean(intervention, na.rm = T)*100, 1),
            &quot;% born in Finland&quot; = round(mean(bornInFinland, na.rm = T)*100, 1),
            n = n()) %&gt;% 
  filter(complete.cases(.)) %&gt;% 
  arrange(desc(Track)) 
## Error in eval(lhs, parent, parent): object &#39;demographics&#39; not found

demotable_total &lt;- demographics %&gt;% 
  summarise(&quot;Track&quot; = &quot;Full sample&quot;,
            &quot;Mean age (range)&quot; = paste0(round(mean(age, na.rm = T), 1),&quot; (&quot;, 
                                        range(age, na.rm = T)[1], &quot;-&quot;,
                                        range(age, na.rm = T)[2], &quot;)&quot;),
            &quot;Mean study year (sd)&quot; = paste0(round(mean(studyYear, na.rm = T), 1),&quot; (&quot;, 
                                               round(sd(studyYear, na.rm = T), 1), &quot;)&quot;),
            &quot;% girl&quot; = round(mean(girl, na.rm = T)*100, 1),
            &quot;% intervention&quot; = round(mean(intervention, na.rm = T)*100, 1),
            &quot;% born in Finland&quot; = round(mean(bornInFinland, na.rm = T)*100, 1),
            n = n())
## Error in eval(lhs, parent, parent): object &#39;demographics&#39; not found

demotable &lt;- bind_rows(demotable, demotable_total)
## Error in dots_values(...): object &#39;demotable&#39; not found

demotable &lt;- demotable %&gt;% tidyr::gather(Variable, val, 2:ncol(demotable)) %&gt;% tidyr::spread(Track, val)
## Error in eval(lhs, parent, parent): object &#39;demotable&#39; not found

# For some reason, sum of n&#39;s of all tracks is 1084.

papaja::apa_table(demotable, caption = &quot;Baseline demographics of educational tracks&quot;, digits = c(0, 1, 1, 1, 1, 1, 0))
## Error in papaja::apa_table(demotable, caption = &quot;Baseline demographics of educational tracks&quot;, : object &#39;demotable&#39; not found</code></pre>
</div>
<div id="by-gender" class="section level3">
<h3>By gender</h3>
<pre class="r"><code>demographics$Girl &lt;- factor(demographics$girl)
## Error in factor(demographics$girl): object &#39;demographics&#39; not found

demotable &lt;- demographics %&gt;% 
  group_by(Girl) %&gt;% 
  summarise(&quot;Mean age (range)&quot; = paste0(round(mean(age, na.rm = T), 1),&quot; (&quot;, 
                                        range(age, na.rm = T)[1], &quot;-&quot;,
                                        range(age, na.rm = T)[2], &quot;)&quot;),
            &quot;Mean study year (sd)&quot; = paste0(round(mean(studyYear, na.rm = T), 1),&quot; (&quot;, 
                                               round(sd(studyYear, na.rm = T), 1), &quot;)&quot;),
            &quot;% intervention&quot; = round(mean(intervention, na.rm = T)*100, 1),
            &quot;% born in Finland&quot; = round(mean(bornInFinland, na.rm = T)*100, 1),
            n = n()) %&gt;% 
  filter(complete.cases(.)) %&gt;% 
  arrange(desc(Girl)) 
## Error in eval(lhs, parent, parent): object &#39;demographics&#39; not found

demotable_total &lt;- demographics %&gt;% 
  summarise(&quot;Girl&quot; = &quot;Full sample&quot;,
            &quot;Mean age (range)&quot; = paste0(round(mean(age, na.rm = T), 1),&quot; (&quot;, 
                                        range(age, na.rm = T)[1], &quot;-&quot;,
                                        range(age, na.rm = T)[2], &quot;)&quot;),
            &quot;Mean study year (sd)&quot; = paste0(round(mean(studyYear, na.rm = T), 1),&quot; (&quot;, 
                                               round(sd(studyYear, na.rm = T), 1), &quot;)&quot;),
            &quot;% intervention&quot; = round(mean(intervention, na.rm = T)*100, 1),
            &quot;% born in Finland&quot; = round(mean(bornInFinland, na.rm = T)*100, 1),
            n = n())
## Error in eval(lhs, parent, parent): object &#39;demographics&#39; not found

demotable &lt;- bind_rows(demotable, demotable_total)
## Error in dots_values(...): object &#39;demotable&#39; not found

demotable &lt;- demotable %&gt;% tidyr::gather(Variable, val, 2:ncol(demotable)) %&gt;% tidyr::spread(Girl, val)
## Error in eval(lhs, parent, parent): object &#39;demotable&#39; not found

names(demotable) &lt;- c(&quot;&quot;, &quot;Boy&quot;, &quot;Girl&quot;, &quot;Full sample&quot;)
## Error in names(demotable) &lt;- c(&quot;&quot;, &quot;Boy&quot;, &quot;Girl&quot;, &quot;Full sample&quot;): object &#39;demotable&#39; not found

# For some reason, sum of n&#39;s of all tracks is 1084.

papaja::apa_table(demotable, caption = &quot;Baseline demographics of educational tracks&quot;, digits = c(0, 1, 1, 1, 1, 0))
## Error in papaja::apa_table(demotable, caption = &quot;Baseline demographics of educational tracks&quot;, : object &#39;demotable&#39; not found</code></pre>
</div>
<div id="by-intervention-participation" class="section level3">
<h3>By intervention participation</h3>
<pre class="r"><code>demographics$intervention &lt;- factor(demographics$intervention)
## Error in factor(demographics$intervention): object &#39;demographics&#39; not found
demographics$girl &lt;- as.numeric(demographics$girl)
## Error in eval(expr, envir, enclos): object &#39;demographics&#39; not found

demotable &lt;- demographics %&gt;% 
  group_by(intervention) %&gt;% 
  summarise(&quot;Mean age (range)&quot; = paste0(round(mean(age, na.rm = T), 1),&quot; (&quot;, 
                                        range(age, na.rm = T)[1], &quot;-&quot;,
                                        range(age, na.rm = T)[2], &quot;)&quot;),
            &quot;Mean study year (sd)&quot; = paste0(round(mean(studyYear, na.rm = T), 1),&quot; (&quot;, 
                                               round(sd(studyYear, na.rm = T), 1), &quot;)&quot;),
            &quot;% girl&quot; = round(mean(girl, na.rm = T)*100, 1),
            &quot;% born in Finland&quot; = round(mean(bornInFinland, na.rm = T)*100, 1),
            n = n()) %&gt;% 
  filter(complete.cases(.)) %&gt;% 
  arrange(desc(intervention)) 
## Error in eval(lhs, parent, parent): object &#39;demographics&#39; not found

demotable_total &lt;- demographics %&gt;% 
  summarise(&quot;intervention&quot; = &quot;Full sample&quot;,
            &quot;Mean age (range)&quot; = paste0(round(mean(age, na.rm = T), 1),&quot; (&quot;, 
                                        range(age, na.rm = T)[1], &quot;-&quot;,
                                        range(age, na.rm = T)[2], &quot;)&quot;),
            &quot;Mean study year (sd)&quot; = paste0(round(mean(studyYear, na.rm = T), 1),&quot; (&quot;, 
                                               round(sd(studyYear, na.rm = T), 1), &quot;)&quot;),
            &quot;% girl&quot; = round(mean(girl, na.rm = T)*100, 1),
            &quot;% born in Finland&quot; = round(mean(bornInFinland, na.rm = T)*100, 1),
            n = n())
## Error in eval(lhs, parent, parent): object &#39;demographics&#39; not found

demotable &lt;- bind_rows(demotable, demotable_total)
## Error in dots_values(...): object &#39;demotable&#39; not found

demotable &lt;- demotable %&gt;% tidyr::gather(Variable, val, 2:ncol(demotable)) %&gt;% tidyr::spread(intervention, val)
## Error in eval(lhs, parent, parent): object &#39;demotable&#39; not found

names(demotable) &lt;- c(&quot;&quot;, &quot;Control&quot;, &quot;Intervention&quot;, &quot;Full sample&quot;)
## Error in names(demotable) &lt;- c(&quot;&quot;, &quot;Control&quot;, &quot;Intervention&quot;, &quot;Full sample&quot;): object &#39;demotable&#39; not found

# For some reason, sum of n&#39;s of all tracks is 1084.

papaja::apa_table(demotable, caption = &quot;Baseline demographics of educational tracks&quot;, digits = c(0, 1, 1, 1, 1, 0))
## Error in papaja::apa_table(demotable, caption = &quot;Baseline demographics of educational tracks&quot;, : object &#39;demotable&#39; not found</code></pre>
</div>
</div>
<div id="create-outcome-tables" class="section level2">
<h2>Create outcome tables</h2>
<pre class="r"><code>
outtable_track &lt;- df %&gt;%
  select(paAccelerometer_T1, sitLieAccelerometer_T1, sitBreaks_T1, # Main outcomes 
          PA_actionplan_T1,
          PA_copingplan_T1,
          PA_agrbct_T1,
          PA_frqbct_T1,
          PA_amotivation_T1,
          PA_autonomous_T1,
          PA_controlled_T1,
          PA_goal_T1,
          PA_inorm_T1,
          PA_dnorm_T1,
          PA_intention_T1,
          PA_outcomeExpectations_T1,
          PA_opportunities_T1,
          PA_pbc_T1,
          PA_selfefficacy_T1,
          SB_dnorm_T1,
          SB_inorm_T1,
          SB_intention_T1,
          SB_outcomeExpectations_T1,
          SB_sePbc_T1,
         track, girl, intervention) %&gt;% 
  group_by(track) %&gt;% 
  summarise(
            &#39;PA action planning&#39; = paste0(round(mean(PA_actionplan_T1, na.rm = TRUE), 1), &quot; (&quot;, round(sd(PA_actionplan_T1, na.rm = T), 1), &quot;)&quot;),
            &#39;PA coping planning&#39; = paste0(round(mean(PA_copingplan_T1, na.rm = TRUE), 1), &#39; (&#39;, round(sd(PA_copingplan_T1, na.rm = T), 1), &#39;)&#39;),
            &#39;PA agreement-BCTs&#39; = paste0(round(mean(PA_agrbct_T1, na.rm = TRUE), 1), &#39; (&#39;, round(sd(PA_agrbct_T1, na.rm = T), 1), &#39;)&#39;),
            &#39;PA frequency-BCTs&#39; = paste0(round(mean(PA_frqbct_T1, na.rm = TRUE), 1), &#39; (&#39;, round(sd(PA_frqbct_T1, na.rm = T), 1), &#39;)&#39;),
            &#39;PA amotivation&#39; = paste0(round(mean(PA_amotivation_T1, na.rm = TRUE), 1), &#39; (&#39;, round(sd(PA_amotivation_T1, na.rm = T), 1), &#39;)&#39;),
            &#39;PA autonomous regulation&#39; = paste0(round(mean(PA_autonomous_T1, na.rm = TRUE), 1), &#39; (&#39;, round(sd(PA_autonomous_T1, na.rm = T), 1), &#39;)&#39;),
            &#39;PA controlled regulation&#39; = paste0(round(mean(PA_controlled_T1, na.rm = TRUE), 1), &#39; (&#39;, round(sd(PA_controlled_T1, na.rm = T), 1), &#39;)&#39;),
            &#39;PA injunctive norm&#39; = paste0(round(mean(PA_inorm_T1, na.rm = TRUE), 1), &#39; (&#39;, round(sd(PA_inorm_T1, na.rm = T), 1), &#39;)&#39;),
            &#39;PA descriptive norm&#39; = paste0(round(mean(PA_dnorm_T1, na.rm = TRUE), 1), &#39; (&#39;, round(sd(PA_dnorm_T1, na.rm = T), 1), &#39;)&#39;),
            &#39;PA intention&#39; = paste0(round(mean(PA_intention_T1, na.rm = TRUE), 1), &#39; (&#39;, round(sd(PA_intention_T1, na.rm = T), 1), &#39;)&#39;),
            &#39;PA outcome expectations&#39; = paste0(round(mean(PA_outcomeExpectations_T1, na.rm = TRUE), 1), &#39; (&#39;, round(sd(PA_outcomeExpectations_T1, na.rm = T), 1), &#39;)&#39;),
            &#39;PA opportunities&#39; = paste0(round(mean(PA_opportunities_T1, na.rm = TRUE), 1), &#39; (&#39;, round(sd(PA_opportunities_T1, na.rm = T), 1), &#39;)&#39;),
            &#39;PA perceived behavioural control&#39; = paste0(round(mean(PA_pbc_T1, na.rm = TRUE), 1), &#39; (&#39;, round(sd(PA_pbc_T1, na.rm = T), 1), &#39;)&#39;),
            &#39;PA self-efficacy&#39; = paste0(round(mean(PA_selfefficacy_T1, na.rm = TRUE), 1), &#39; (&#39;, round(sd(PA_selfefficacy_T1, na.rm = T), 1), &#39;)&#39;),
            &#39;SB descriptive norm&#39; = paste0(round(mean(SB_dnorm_T1, na.rm = TRUE), 1), &#39; (&#39;, round(sd(SB_dnorm_T1, na.rm = T), 1), &#39;)&#39;),
            &#39;SB injunctive norm&#39; = paste0(round(mean(SB_inorm_T1, na.rm = TRUE), 1), &#39; (&#39;, round(sd(SB_inorm_T1, na.rm = T), 1), &#39;)&#39;),
            &#39;SB intention&#39; = paste0(round(mean(SB_intention_T1, na.rm = TRUE), 1), &#39; (&#39;, round(sd(SB_intention_T1, na.rm = T), 1), &#39;)&#39;),
            &#39;SB outcome expectations&#39; = paste0(round(mean(SB_outcomeExpectations_T1, na.rm = TRUE), 1), &#39; (&#39;, round(sd(SB_outcomeExpectations_T1, na.rm = T), 1), &#39;)&#39;),
            &#39;SB self-efficacy &amp; perceived behavioural control&#39; = paste0(round(mean(SB_sePbc_T1, na.rm = TRUE), 1), &#39; (&#39;, round(sd(SB_sePbc_T1, na.rm = T), 1), &#39;)&#39;),

            &quot;Mean daily MVPA minutes&quot; = paste0(round(mean(paAccelerometer_T1, na.rm = T), 1),&quot; (&quot;, 
                                        round(sd(paAccelerometer_T1, na.rm = T), 1), &quot;)&quot;),
            &quot;Mean daily minutes spent sitting or lying down&quot; = paste0(round(mean(sitLieAccelerometer_T1, na.rm = T), 1),&quot; (&quot;, 
                                        round(sd(sitLieAccelerometer_T1, na.rm = T), 1), &quot;)&quot;),
            &quot;Mean daily breaks in sitting&quot; = paste0(round(mean(sitBreaks_T1, na.rm = T), 1),&quot; (&quot;, 
                                        round(sd(sitBreaks_T1, na.rm = T), 1), &quot;)&quot;),
            n = n()) %&gt;% 
  filter(complete.cases(.)) %&gt;% 
  arrange(desc(track)) %&gt;% 
  filter(track != &quot;Other&quot;)

outtable_intervention &lt;- df %&gt;%
  select(paAccelerometer_T1, sitLieAccelerometer_T1, sitBreaks_T1, # Main outcomes 
          PA_actionplan_T1,
          PA_copingplan_T1,
          PA_agrbct_T1,
          PA_frqbct_T1,
          PA_amotivation_T1,
          PA_autonomous_T1,
          PA_controlled_T1,
          PA_goal_T1,
          PA_inorm_T1,
          PA_dnorm_T1,
          PA_intention_T1,
          PA_outcomeExpectations_T1,
          PA_opportunities_T1,
          PA_pbc_T1,
          PA_selfefficacy_T1,
          SB_dnorm_T1,
          SB_inorm_T1,
          SB_intention_T1,
          SB_outcomeExpectations_T1,
          SB_sePbc_T1,
         track, girl, intervention) %&gt;% 
  group_by(intervention) %&gt;% 
  summarise(
            &#39;PA action planning&#39; = paste0(round(mean(PA_actionplan_T1, na.rm = TRUE), 1), &quot; (&quot;, round(sd(PA_actionplan_T1, na.rm = T), 1), &quot;)&quot;),
            &#39;PA coping planning&#39; = paste0(round(mean(PA_copingplan_T1, na.rm = TRUE), 1), &#39; (&#39;, round(sd(PA_copingplan_T1, na.rm = T), 1), &#39;)&#39;),
            &#39;PA agreement-BCTs&#39; = paste0(round(mean(PA_agrbct_T1, na.rm = TRUE), 1), &#39; (&#39;, round(sd(PA_agrbct_T1, na.rm = T), 1), &#39;)&#39;),
            &#39;PA frequency-BCTs&#39; = paste0(round(mean(PA_frqbct_T1, na.rm = TRUE), 1), &#39; (&#39;, round(sd(PA_frqbct_T1, na.rm = T), 1), &#39;)&#39;),
            &#39;PA amotivation&#39; = paste0(round(mean(PA_amotivation_T1, na.rm = TRUE), 1), &#39; (&#39;, round(sd(PA_amotivation_T1, na.rm = T), 1), &#39;)&#39;),
            &#39;PA autonomous regulation&#39; = paste0(round(mean(PA_autonomous_T1, na.rm = TRUE), 1), &#39; (&#39;, round(sd(PA_autonomous_T1, na.rm = T), 1), &#39;)&#39;),
            &#39;PA controlled regulation&#39; = paste0(round(mean(PA_controlled_T1, na.rm = TRUE), 1), &#39; (&#39;, round(sd(PA_controlled_T1, na.rm = T), 1), &#39;)&#39;),
            &#39;PA injunctive norm&#39; = paste0(round(mean(PA_inorm_T1, na.rm = TRUE), 1), &#39; (&#39;, round(sd(PA_inorm_T1, na.rm = T), 1), &#39;)&#39;),
            &#39;PA descriptive norm&#39; = paste0(round(mean(PA_dnorm_T1, na.rm = TRUE), 1), &#39; (&#39;, round(sd(PA_dnorm_T1, na.rm = T), 1), &#39;)&#39;),
            &#39;PA intention&#39; = paste0(round(mean(PA_intention_T1, na.rm = TRUE), 1), &#39; (&#39;, round(sd(PA_intention_T1, na.rm = T), 1), &#39;)&#39;),
            &#39;PA outcome expectations&#39; = paste0(round(mean(PA_outcomeExpectations_T1, na.rm = TRUE), 1), &#39; (&#39;, round(sd(PA_outcomeExpectations_T1, na.rm = T), 1), &#39;)&#39;),
            &#39;PA opportunities&#39; = paste0(round(mean(PA_opportunities_T1, na.rm = TRUE), 1), &#39; (&#39;, round(sd(PA_opportunities_T1, na.rm = T), 1), &#39;)&#39;),
            &#39;PA perceived behavioural control&#39; = paste0(round(mean(PA_pbc_T1, na.rm = TRUE), 1), &#39; (&#39;, round(sd(PA_pbc_T1, na.rm = T), 1), &#39;)&#39;),
            &#39;PA self-efficacy&#39; = paste0(round(mean(PA_selfefficacy_T1, na.rm = TRUE), 1), &#39; (&#39;, round(sd(PA_selfefficacy_T1, na.rm = T), 1), &#39;)&#39;),
            &#39;SB descriptive norm&#39; = paste0(round(mean(SB_dnorm_T1, na.rm = TRUE), 1), &#39; (&#39;, round(sd(SB_dnorm_T1, na.rm = T), 1), &#39;)&#39;),
            &#39;SB injunctive norm&#39; = paste0(round(mean(SB_inorm_T1, na.rm = TRUE), 1), &#39; (&#39;, round(sd(SB_inorm_T1, na.rm = T), 1), &#39;)&#39;),
            &#39;SB intention&#39; = paste0(round(mean(SB_intention_T1, na.rm = TRUE), 1), &#39; (&#39;, round(sd(SB_intention_T1, na.rm = T), 1), &#39;)&#39;),
            &#39;SB outcome expectations&#39; = paste0(round(mean(SB_outcomeExpectations_T1, na.rm = TRUE), 1), &#39; (&#39;, round(sd(SB_outcomeExpectations_T1, na.rm = T), 1), &#39;)&#39;),
            &#39;SB self-efficacy &amp; perceived behavioural control&#39; = paste0(round(mean(SB_sePbc_T1, na.rm = TRUE), 1), &#39; (&#39;, round(sd(SB_sePbc_T1, na.rm = T), 1), &#39;)&#39;),

            &quot;Mean daily MVPA minutes&quot; = paste0(round(mean(paAccelerometer_T1, na.rm = T), 1),&quot; (&quot;, 
                                        round(sd(paAccelerometer_T1, na.rm = T), 1), &quot;)&quot;),
            &quot;Mean daily minutes spent sitting or lying down&quot; = paste0(round(mean(sitLieAccelerometer_T1, na.rm = T), 1),&quot; (&quot;, 
                                        round(sd(sitLieAccelerometer_T1, na.rm = T), 1), &quot;)&quot;),
            &quot;Mean daily breaks in sitting&quot; = paste0(round(mean(sitBreaks_T1, na.rm = T), 1),&quot; (&quot;, 
                                        round(sd(sitBreaks_T1, na.rm = T), 1), &quot;)&quot;),
            n = n()) %&gt;% 
  filter(complete.cases(.))

outtable_girl &lt;- df %&gt;%
  select(paAccelerometer_T1, sitLieAccelerometer_T1, sitBreaks_T1, # Main outcomes 
          PA_actionplan_T1,
          PA_copingplan_T1,
          PA_agrbct_T1,
          PA_frqbct_T1,
          PA_amotivation_T1,
          PA_autonomous_T1,
          PA_controlled_T1,
          PA_goal_T1,
          PA_inorm_T1,
          PA_dnorm_T1,
          PA_intention_T1,
          PA_outcomeExpectations_T1,
          PA_opportunities_T1,
          PA_pbc_T1,
          PA_selfefficacy_T1,
          SB_dnorm_T1,
          SB_inorm_T1,
          SB_intention_T1,
          SB_outcomeExpectations_T1,
          SB_sePbc_T1,
         track, girl, intervention) %&gt;% 
  group_by(girl) %&gt;% 
  summarise(
            &#39;PA action planning&#39; = paste0(round(mean(PA_actionplan_T1, na.rm = TRUE), 1), &quot; (&quot;, round(sd(PA_actionplan_T1, na.rm = T), 1), &quot;)&quot;),
            &#39;PA coping planning&#39; = paste0(round(mean(PA_copingplan_T1, na.rm = TRUE), 1), &#39; (&#39;, round(sd(PA_copingplan_T1, na.rm = T), 1), &#39;)&#39;),
            &#39;PA agreement-BCTs&#39; = paste0(round(mean(PA_agrbct_T1, na.rm = TRUE), 1), &#39; (&#39;, round(sd(PA_agrbct_T1, na.rm = T), 1), &#39;)&#39;),
            &#39;PA frequency-BCTs&#39; = paste0(round(mean(PA_frqbct_T1, na.rm = TRUE), 1), &#39; (&#39;, round(sd(PA_frqbct_T1, na.rm = T), 1), &#39;)&#39;),
            &#39;PA amotivation&#39; = paste0(round(mean(PA_amotivation_T1, na.rm = TRUE), 1), &#39; (&#39;, round(sd(PA_amotivation_T1, na.rm = T), 1), &#39;)&#39;),
            &#39;PA autonomous regulation&#39; = paste0(round(mean(PA_autonomous_T1, na.rm = TRUE), 1), &#39; (&#39;, round(sd(PA_autonomous_T1, na.rm = T), 1), &#39;)&#39;),
            &#39;PA controlled regulation&#39; = paste0(round(mean(PA_controlled_T1, na.rm = TRUE), 1), &#39; (&#39;, round(sd(PA_controlled_T1, na.rm = T), 1), &#39;)&#39;),
            &#39;PA injunctive norm&#39; = paste0(round(mean(PA_inorm_T1, na.rm = TRUE), 1), &#39; (&#39;, round(sd(PA_inorm_T1, na.rm = T), 1), &#39;)&#39;),
            &#39;PA descriptive norm&#39; = paste0(round(mean(PA_dnorm_T1, na.rm = TRUE), 1), &#39; (&#39;, round(sd(PA_dnorm_T1, na.rm = T), 1), &#39;)&#39;),
            &#39;PA intention&#39; = paste0(round(mean(PA_intention_T1, na.rm = TRUE), 1), &#39; (&#39;, round(sd(PA_intention_T1, na.rm = T), 1), &#39;)&#39;),
            &#39;PA outcome expectations&#39; = paste0(round(mean(PA_outcomeExpectations_T1, na.rm = TRUE), 1), &#39; (&#39;, round(sd(PA_outcomeExpectations_T1, na.rm = T), 1), &#39;)&#39;),
            &#39;PA opportunities&#39; = paste0(round(mean(PA_opportunities_T1, na.rm = TRUE), 1), &#39; (&#39;, round(sd(PA_opportunities_T1, na.rm = T), 1), &#39;)&#39;),
            &#39;PA perceived behavioural control&#39; = paste0(round(mean(PA_pbc_T1, na.rm = TRUE), 1), &#39; (&#39;, round(sd(PA_pbc_T1, na.rm = T), 1), &#39;)&#39;),
            &#39;PA self-efficacy&#39; = paste0(round(mean(PA_selfefficacy_T1, na.rm = TRUE), 1), &#39; (&#39;, round(sd(PA_selfefficacy_T1, na.rm = T), 1), &#39;)&#39;),
            &#39;SB descriptive norm&#39; = paste0(round(mean(SB_dnorm_T1, na.rm = TRUE), 1), &#39; (&#39;, round(sd(SB_dnorm_T1, na.rm = T), 1), &#39;)&#39;),
            &#39;SB injunctive norm&#39; = paste0(round(mean(SB_inorm_T1, na.rm = TRUE), 1), &#39; (&#39;, round(sd(SB_inorm_T1, na.rm = T), 1), &#39;)&#39;),
            &#39;SB intention&#39; = paste0(round(mean(SB_intention_T1, na.rm = TRUE), 1), &#39; (&#39;, round(sd(SB_intention_T1, na.rm = T), 1), &#39;)&#39;),
            &#39;SB outcome expectations&#39; = paste0(round(mean(SB_outcomeExpectations_T1, na.rm = TRUE), 1), &#39; (&#39;, round(sd(SB_outcomeExpectations_T1, na.rm = T), 1), &#39;)&#39;),
            &#39;SB self-efficacy &amp; perceived behavioural control&#39; = paste0(round(mean(SB_sePbc_T1, na.rm = TRUE), 1), &#39; (&#39;, round(sd(SB_sePbc_T1, na.rm = T), 1), &#39;)&#39;),

            &quot;Mean daily MVPA minutes&quot; = paste0(round(mean(paAccelerometer_T1, na.rm = T), 1),&quot; (&quot;, 
                                        round(sd(paAccelerometer_T1, na.rm = T), 1), &quot;)&quot;),
            &quot;Mean daily minutes spent sitting or lying down&quot; = paste0(round(mean(sitLieAccelerometer_T1, na.rm = T), 1),&quot; (&quot;, 
                                        round(sd(sitLieAccelerometer_T1, na.rm = T), 1), &quot;)&quot;),
            &quot;Mean daily breaks in sitting&quot; = paste0(round(mean(sitBreaks_T1, na.rm = T), 1),&quot; (&quot;, 
                                        round(sd(sitBreaks_T1, na.rm = T), 1), &quot;)&quot;),
            n = n()) %&gt;% 
  filter(complete.cases(.))

outtable_total &lt;- df %&gt;% 
  summarise(&#39;girl&#39; = &quot;Full sample&quot;,
            &#39;PA action planning&#39; = paste0(round(mean(PA_actionplan_T1, na.rm = TRUE), 1), &quot; (&quot;, round(sd(PA_actionplan_T1, na.rm = T), 1), &quot;)&quot;),
            &#39;PA coping planning&#39; = paste0(round(mean(PA_copingplan_T1, na.rm = TRUE), 1), &#39; (&#39;, round(sd(PA_copingplan_T1, na.rm = T), 1), &#39;)&#39;),
            &#39;PA agreement-BCTs&#39; = paste0(round(mean(PA_agrbct_T1, na.rm = TRUE), 1), &#39; (&#39;, round(sd(PA_agrbct_T1, na.rm = T), 1), &#39;)&#39;),
            &#39;PA frequency-BCTs&#39; = paste0(round(mean(PA_frqbct_T1, na.rm = TRUE), 1), &#39; (&#39;, round(sd(PA_frqbct_T1, na.rm = T), 1), &#39;)&#39;),
            &#39;PA amotivation&#39; = paste0(round(mean(PA_amotivation_T1, na.rm = TRUE), 1), &#39; (&#39;, round(sd(PA_amotivation_T1, na.rm = T), 1), &#39;)&#39;),
            &#39;PA autonomous regulation&#39; = paste0(round(mean(PA_autonomous_T1, na.rm = TRUE), 1), &#39; (&#39;, round(sd(PA_autonomous_T1, na.rm = T), 1), &#39;)&#39;),
            &#39;PA controlled regulation&#39; = paste0(round(mean(PA_controlled_T1, na.rm = TRUE), 1), &#39; (&#39;, round(sd(PA_controlled_T1, na.rm = T), 1), &#39;)&#39;),
            &#39;PA injunctive norm&#39; = paste0(round(mean(PA_inorm_T1, na.rm = TRUE), 1), &#39; (&#39;, round(sd(PA_inorm_T1, na.rm = T), 1), &#39;)&#39;),
            &#39;PA descriptive norm&#39; = paste0(round(mean(PA_dnorm_T1, na.rm = TRUE), 1), &#39; (&#39;, round(sd(PA_dnorm_T1, na.rm = T), 1), &#39;)&#39;),
            &#39;PA intention&#39; = paste0(round(mean(PA_intention_T1, na.rm = TRUE), 1), &#39; (&#39;, round(sd(PA_intention_T1, na.rm = T), 1), &#39;)&#39;),
            &#39;PA outcome expectations&#39; = paste0(round(mean(PA_outcomeExpectations_T1, na.rm = TRUE), 1), &#39; (&#39;, round(sd(PA_outcomeExpectations_T1, na.rm = T), 1), &#39;)&#39;),
            &#39;PA opportunities&#39; = paste0(round(mean(PA_opportunities_T1, na.rm = TRUE), 1), &#39; (&#39;, round(sd(PA_opportunities_T1, na.rm = T), 1), &#39;)&#39;),
            &#39;PA perceived behavioural control&#39; = paste0(round(mean(PA_pbc_T1, na.rm = TRUE), 1), &#39; (&#39;, round(sd(PA_pbc_T1, na.rm = T), 1), &#39;)&#39;),
            &#39;PA self-efficacy&#39; = paste0(round(mean(PA_selfefficacy_T1, na.rm = TRUE), 1), &#39; (&#39;, round(sd(PA_selfefficacy_T1, na.rm = T), 1), &#39;)&#39;),
            &#39;SB descriptive norm&#39; = paste0(round(mean(SB_dnorm_T1, na.rm = TRUE), 1), &#39; (&#39;, round(sd(SB_dnorm_T1, na.rm = T), 1), &#39;)&#39;),
            &#39;SB injunctive norm&#39; = paste0(round(mean(SB_inorm_T1, na.rm = TRUE), 1), &#39; (&#39;, round(sd(SB_inorm_T1, na.rm = T), 1), &#39;)&#39;),
            &#39;SB intention&#39; = paste0(round(mean(SB_intention_T1, na.rm = TRUE), 1), &#39; (&#39;, round(sd(SB_intention_T1, na.rm = T), 1), &#39;)&#39;),
            &#39;SB outcome expectations&#39; = paste0(round(mean(SB_outcomeExpectations_T1, na.rm = TRUE), 1), &#39; (&#39;, round(sd(SB_outcomeExpectations_T1, na.rm = T), 1), &#39;)&#39;),
            &#39;SB self-efficacy &amp; perceived behavioural control&#39; = paste0(round(mean(SB_sePbc_T1, na.rm = TRUE), 1), &#39; (&#39;, round(sd(SB_sePbc_T1, na.rm = T), 1), &#39;)&#39;),

            &quot;Mean daily MVPA minutes&quot; = paste0(round(mean(paAccelerometer_T1, na.rm = T), 1),&quot; (&quot;, 
                                        round(sd(paAccelerometer_T1, na.rm = T), 1), &quot;)&quot;),
            &quot;Mean daily minutes spent sitting or lying down&quot; = paste0(round(mean(sitLieAccelerometer_T1, na.rm = T), 1),&quot; (&quot;, 
                                        round(sd(sitLieAccelerometer_T1, na.rm = T), 1), &quot;)&quot;),
            &quot;Mean daily breaks in sitting&quot; = paste0(round(mean(sitBreaks_T1, na.rm = T), 1),&quot; (&quot;, 
                                        round(sd(sitBreaks_T1, na.rm = T), 1), &quot;)&quot;),
            n = n())



# Transpose each table
outtable_track &lt;- outtable_track %&gt;% tidyr::gather(Variable, val, 2:ncol(.)) %&gt;% tidyr::spread(track, val)

outtable_intervention &lt;- outtable_intervention %&gt;% tidyr::gather(Variable, val, 2:ncol(.)) %&gt;% tidyr::spread(intervention, val)
names(outtable_intervention) &lt;- c(&quot;Variable&quot;, &quot;Control&quot;, &quot;Intervention&quot;)

## In the last table, have a column for total before transposing
outtable_girl &lt;- bind_rows(outtable_girl, outtable_total)
## Warning in bind_rows_(x, .id): binding factor and character vector,
## coercing into character vector
## Warning in bind_rows_(x, .id): binding character and factor vector,
## coercing into character vector
outtable_girl &lt;- outtable_girl %&gt;% tidyr::gather(Variable, val, 2:ncol(.)) %&gt;% tidyr::spread(girl, val)
names(outtable_girl) &lt;- c(&quot;Variable&quot;, &quot;Boy&quot;, &quot;Girl&quot;, &quot;Full sample&quot;)

# Are all variables the same?
identical(outtable_track$Variable, outtable_girl$Variable)</code></pre>
<p><a href="#section">1</a> TRUE</p>
<pre class="r"><code>identical(outtable_track$Variable, outtable_intervention$Variable)</code></pre>
<p><a href="#section">1</a> TRUE</p>
<pre class="r"><code>
# Create large table with all variables
outtable_mega &lt;- bind_cols(outtable_track, outtable_intervention, outtable_girl) %&gt;% 
  select(-Variable1, -Variable2) 

# Move n to be the first row
out1 &lt;- outtable_mega %&gt;% filter(Variable == &quot;n&quot;)
out2 &lt;- outtable_mega %&gt;% filter(Variable != &quot;n&quot;)
outtable_mega &lt;- bind_rows(out1, out2)

# Fix names: leave first blank, have the rest as they were
names(outtable_mega) &lt;- c(&quot;&quot;, names(outtable_mega)[2:(length(names(outtable_mega)))])

papaja::apa_table(outtable_mega, caption = &quot;Baseline demographics of educational tracks&quot;)</code></pre>
<caption>
(#tab:outcome-table)
</caption>
<caption>
<em>Baseline demographics of educational tracks</em>
</caption>
<table>
<thead>
<tr class="header">
<th></th>
<th align="left">Business IT</th>
<th align="left">Business Admin</th>
<th align="left">HRC</th>
<th align="left">Nursing</th>
<th align="left">Control</th>
<th align="left">Intervention</th>
<th align="left">Boy</th>
<th align="left">Girl</th>
<th align="left">Full sample</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>n</td>
<td align="left">163</td>
<td align="left">282</td>
<td align="left">213</td>
<td align="left">402</td>
<td align="left">503</td>
<td align="left">581</td>
<td align="left">471</td>
<td align="left">1165</td>
<td align="left">613</td>
</tr>
<tr class="even">
<td>Mean daily breaks in sitting</td>
<td align="left">20 (9)</td>
<td align="left">27.5 (10)</td>
<td align="left">27.5 (9.6)</td>
<td align="left">31.7 (11.3)</td>
<td align="left">27.2 (10.4)</td>
<td align="left">29 (11.6)</td>
<td align="left">23.4 (9.5)</td>
<td align="left">28.2 (11.1)</td>
<td align="left">31.3 (11)</td>
</tr>
<tr class="odd">
<td>Mean daily minutes spent sitting or lying down</td>
<td align="left">652.8 (86.3)</td>
<td align="left">586.8 (93)</td>
<td align="left">557.8 (101.2)</td>
<td align="left">554.4 (82.1)</td>
<td align="left">568.5 (100.9)</td>
<td align="left">585.9 (92.7)</td>
<td align="left">612.5 (95.6)</td>
<td align="left">578.2 (97.2)</td>
<td align="left">554.9 (90.9)</td>
</tr>
<tr class="even">
<td>Mean daily MVPA minutes</td>
<td align="left">141.3 (51.6)</td>
<td align="left">179.6 (48.4)</td>
<td align="left">183.1 (52.2)</td>
<td align="left">201.2 (49.2)</td>
<td align="left">179.5 (52)</td>
<td align="left">187.3 (55.1)</td>
<td align="left">173.5 (59.4)</td>
<td align="left">183.8 (53.8)</td>
<td align="left">190.4 (48.6)</td>
</tr>
<tr class="odd">
<td>PA action planning</td>
<td align="left">2.4 (1.1)</td>
<td align="left">2.9 (0.9)</td>
<td align="left">2.8 (0.9)</td>
<td align="left">2.8 (0.9)</td>
<td align="left">2.8 (1)</td>
<td align="left">2.7 (0.9)</td>
<td align="left">2.8 (1)</td>
<td align="left">2.8 (0.9)</td>
<td align="left">2.7 (0.9)</td>
</tr>
<tr class="even">
<td>PA agreement-BCTs</td>
<td align="left">2.6 (1.3)</td>
<td align="left">3.5 (1.2)</td>
<td align="left">3.1 (1.3)</td>
<td align="left">3 (1.3)</td>
<td align="left">3.2 (1.3)</td>
<td align="left">3 (1.3)</td>
<td align="left">3.1 (1.4)</td>
<td align="left">3.1 (1.3)</td>
<td align="left">3.1 (1.3)</td>
</tr>
<tr class="odd">
<td>PA amotivation</td>
<td align="left">1.8 (1)</td>
<td align="left">1.5 (0.8)</td>
<td align="left">1.5 (0.8)</td>
<td align="left">1.4 (0.7)</td>
<td align="left">1.6 (0.8)</td>
<td align="left">1.5 (0.8)</td>
<td align="left">1.6 (0.9)</td>
<td align="left">1.5 (0.8)</td>
<td align="left">1.5 (0.7)</td>
</tr>
<tr class="even">
<td>PA autonomous regulation</td>
<td align="left">2.9 (1.1)</td>
<td align="left">3.6 (1)</td>
<td align="left">3.4 (1.1)</td>
<td align="left">3.5 (1)</td>
<td align="left">3.5 (1)</td>
<td align="left">3.4 (1.1)</td>
<td align="left">3.5 (1.1)</td>
<td align="left">3.4 (1.1)</td>
<td align="left">3.4 (1)</td>
</tr>
<tr class="odd">
<td>PA controlled regulation</td>
<td align="left">1.9 (0.8)</td>
<td align="left">1.8 (0.8)</td>
<td align="left">1.8 (0.9)</td>
<td align="left">1.8 (0.8)</td>
<td align="left">1.9 (0.9)</td>
<td align="left">1.8 (0.8)</td>
<td align="left">1.8 (0.8)</td>
<td align="left">1.8 (0.8)</td>
<td align="left">1.9 (0.8)</td>
</tr>
<tr class="even">
<td>PA coping planning</td>
<td align="left">2.2 (0.9)</td>
<td align="left">2.7 (0.8)</td>
<td align="left">2.5 (0.9)</td>
<td align="left">2.5 (0.9)</td>
<td align="left">2.5 (0.9)</td>
<td align="left">2.5 (0.9)</td>
<td align="left">2.6 (0.9)</td>
<td align="left">2.5 (0.9)</td>
<td align="left">2.5 (0.8)</td>
</tr>
<tr class="odd">
<td>PA descriptive norm</td>
<td align="left">3.8 (1.6)</td>
<td align="left">4.8 (1.5)</td>
<td align="left">4.5 (1.5)</td>
<td align="left">4.2 (1.6)</td>
<td align="left">4.5 (1.6)</td>
<td align="left">4.3 (1.6)</td>
<td align="left">4.5 (1.6)</td>
<td align="left">4.4 (1.6)</td>
<td align="left">4.3 (1.6)</td>
</tr>
<tr class="even">
<td>PA frequency-BCTs</td>
<td align="left">2.2 (1.1)</td>
<td align="left">2.8 (1.2)</td>
<td align="left">2.5 (1.1)</td>
<td align="left">2.5 (1.1)</td>
<td align="left">2.6 (1.1)</td>
<td align="left">2.5 (1.1)</td>
<td align="left">2.6 (1.2)</td>
<td align="left">2.5 (1.1)</td>
<td align="left">2.5 (1.1)</td>
</tr>
<tr class="odd">
<td>PA injunctive norm</td>
<td align="left">4.7 (2)</td>
<td align="left">4.8 (2)</td>
<td align="left">4.7 (2)</td>
<td align="left">4.5 (2)</td>
<td align="left">4.8 (2)</td>
<td align="left">4.5 (2)</td>
<td align="left">4.8 (2)</td>
<td align="left">4.6 (2)</td>
<td align="left">4.6 (2)</td>
</tr>
<tr class="even">
<td>PA intention</td>
<td align="left">4.3 (2.1)</td>
<td align="left">5.7 (1.7)</td>
<td align="left">5.5 (1.8)</td>
<td align="left">5.5 (1.7)</td>
<td align="left">5.4 (1.9)</td>
<td align="left">5.4 (1.8)</td>
<td align="left">5.3 (1.9)</td>
<td align="left">5.4 (1.8)</td>
<td align="left">5.4 (1.8)</td>
</tr>
<tr class="odd">
<td>PA opportunities</td>
<td align="left">5.1 (0.9)</td>
<td align="left">5.2 (1)</td>
<td align="left">5.1 (0.9)</td>
<td align="left">5.1 (1)</td>
<td align="left">5.2 (0.9)</td>
<td align="left">5.1 (1)</td>
<td align="left">5.2 (0.9)</td>
<td align="left">5.1 (0.9)</td>
<td align="left">5.1 (1)</td>
</tr>
<tr class="even">
<td>PA outcome expectations</td>
<td align="left">4.3 (0.9)</td>
<td align="left">4.6 (0.9)</td>
<td align="left">4.6 (0.9)</td>
<td align="left">4.7 (0.9)</td>
<td align="left">4.6 (0.9)</td>
<td align="left">4.6 (0.9)</td>
<td align="left">4.5 (0.9)</td>
<td align="left">4.6 (0.9)</td>
<td align="left">4.7 (0.9)</td>
</tr>
<tr class="odd">
<td>PA perceived behavioural control</td>
<td align="left">5.3 (1.3)</td>
<td align="left">5.5 (1.2)</td>
<td align="left">5.2 (1.3)</td>
<td align="left">5.3 (1.3)</td>
<td align="left">5.3 (1.3)</td>
<td align="left">5.3 (1.3)</td>
<td align="left">5.5 (1.2)</td>
<td align="left">5.3 (1.3)</td>
<td align="left">5.2 (1.3)</td>
</tr>
<tr class="even">
<td>PA self-efficacy</td>
<td align="left">5.2 (1.3)</td>
<td align="left">5.4 (1.4)</td>
<td align="left">5.1 (1.2)</td>
<td align="left">5.2 (1.3)</td>
<td align="left">5.3 (1.3)</td>
<td align="left">5.2 (1.3)</td>
<td align="left">5.3 (1.3)</td>
<td align="left">5.2 (1.3)</td>
<td align="left">5.1 (1.3)</td>
</tr>
<tr class="odd">
<td>SB descriptive norm</td>
<td align="left">2.8 (1.5)</td>
<td align="left">3.2 (1.4)</td>
<td align="left">3.4 (1.4)</td>
<td align="left">3.4 (1.5)</td>
<td align="left">3.3 (1.4)</td>
<td align="left">3.2 (1.5)</td>
<td align="left">3.3 (1.5)</td>
<td align="left">3.2 (1.5)</td>
<td align="left">3.2 (1.4)</td>
</tr>
<tr class="even">
<td>SB injunctive norm</td>
<td align="left">4 (1.1)</td>
<td align="left">3.8 (1.3)</td>
<td align="left">4 (1.2)</td>
<td align="left">4.1 (1.3)</td>
<td align="left">4.1 (1.2)</td>
<td align="left">3.9 (1.3)</td>
<td align="left">4 (1.2)</td>
<td align="left">4 (1.3)</td>
<td align="left">4 (1.3)</td>
</tr>
<tr class="odd">
<td>SB intention</td>
<td align="left">3 (1.6)</td>
<td align="left">3.6 (1.5)</td>
<td align="left">3.7 (1.6)</td>
<td align="left">4 (1.6)</td>
<td align="left">3.7 (1.6)</td>
<td align="left">3.7 (1.6)</td>
<td align="left">3.5 (1.7)</td>
<td align="left">3.7 (1.6)</td>
<td align="left">3.9 (1.6)</td>
</tr>
<tr class="even">
<td>SB outcome expectations</td>
<td align="left">4.1 (1.1)</td>
<td align="left">4.4 (1)</td>
<td align="left">4.4 (1)</td>
<td align="left">4.5 (1)</td>
<td align="left">4.4 (1)</td>
<td align="left">4.4 (1.1)</td>
<td align="left">4.3 (1.1)</td>
<td align="left">4.4 (1)</td>
<td align="left">4.5 (1)</td>
</tr>
<tr class="odd">
<td>SB self-efficacy &amp; perceived behavioural control</td>
<td align="left">5 (1.3)</td>
<td align="left">4.9 (1.2)</td>
<td align="left">5.1 (1.2)</td>
<td align="left">4.9 (1.3)</td>
<td align="left">5.1 (1.2)</td>
<td align="left">4.9 (1.3)</td>
<td align="left">5 (1.3)</td>
<td align="left">4.9 (1.3)</td>
<td align="left">4.9 (1.2)</td>
</tr>
</tbody>
</table>
</div>
<div id="mediator-table-with-cis" class="section level2">
<h2>Mediator table with CIs</h2>
<pre class="r"><code>
mediatortable_intervention &lt;- ci_intervention %&gt;%
  dplyr::filter(grepl(&#39;PA_actionplan_T1|PA_copingplan_T1|PA_agrbct_T1|PA_frqbct_T1|PA_amotivation_T1|PA_autonomous_T1|PA_controlled_T1|PA_goal_T1|PA_inorm_T1|PA_dnorm_T1|PA_intention_T1|PA_outcomeExpectations_T1|PA_opportunities_T1|PA_pbc_T1|PA_selfefficacy_T1|SB_dnorm_T1|SB_inorm_T1|SB_intention_T1|SB_outcomeExpectations_T1&#39;, ci_intervention$diamondlabels)) %&gt;% 
  filter(diamondlabels != &quot;PA_goal_T1&quot;) %&gt;% 
  mutate(&quot;CI95&quot; = paste(round(ciLo, 1), &quot;-&quot;, round(ciHi, 1)),
         mean = round(mean, 1))

mediatortable_intervention$diamondlabels &lt;- gsub(&#39;PA_actionplan_T1&#39;, &#39;PA action planning&#39;, mediatortable_intervention$diamondlabels)
mediatortable_intervention$diamondlabels &lt;- gsub(&#39;PA_copingplan_T1&#39;, &#39;PA coping planning&#39;, mediatortable_intervention$diamondlabels)
mediatortable_intervention$diamondlabels &lt;- gsub(&#39;PA_agrbct_T1&#39;, &#39;PA agreement-BCTs&#39;, mediatortable_intervention$diamondlabels)
mediatortable_intervention$diamondlabels &lt;- gsub(&#39;PA_frqbct_T1&#39;, &#39;PA frequency-BCTs&#39;, mediatortable_intervention$diamondlabels)
mediatortable_intervention$diamondlabels &lt;- gsub(&#39;PA_amotivation_T1&#39;, &#39;PA amotivation&#39;, mediatortable_intervention$diamondlabels)
mediatortable_intervention$diamondlabels &lt;- gsub(&#39;PA_autonomous_T1&#39;, &#39;PA autonomous regulation&#39;, mediatortable_intervention$diamondlabels)
mediatortable_intervention$diamondlabels &lt;- gsub(&#39;PA_controlled_T1&#39;, &#39;PA controlled regulation&#39;, mediatortable_intervention$diamondlabels)
mediatortable_intervention$diamondlabels &lt;- gsub(&#39;PA_inorm_T1&#39;, &#39;PA injunctive norm&#39;, mediatortable_intervention$diamondlabels)
mediatortable_intervention$diamondlabels &lt;- gsub(&#39;PA_dnorm_T1&#39;, &#39;PA descriptive norm&#39;, mediatortable_intervention$diamondlabels)
mediatortable_intervention$diamondlabels &lt;- gsub(&#39;PA_intention_T1&#39;, &#39;PA intention&#39;, mediatortable_intervention$diamondlabels)
mediatortable_intervention$diamondlabels &lt;- gsub(&#39;PA_outcomeExpectations_T1&#39;, &#39;PA outcome expectations&#39;, mediatortable_intervention$diamondlabels)
mediatortable_intervention$diamondlabels &lt;- gsub(&#39;PA_opportunities_T1&#39;, &#39;PA opportunities&#39;, mediatortable_intervention$diamondlabels)
mediatortable_intervention$diamondlabels &lt;- gsub(&#39;PA_pbc_T1&#39;, &#39;PA perceived behavioural control&#39;, mediatortable_intervention$diamondlabels)
mediatortable_intervention$diamondlabels &lt;- gsub(&#39;PA_selfefficacy_T1&#39;, &#39;PA self-efficacy&#39;, mediatortable_intervention$diamondlabels)
mediatortable_intervention$diamondlabels &lt;- gsub(&#39;SB_dnorm_T1&#39;, &#39;SB descriptive norm&#39;, mediatortable_intervention$diamondlabels)
mediatortable_intervention$diamondlabels &lt;- gsub(&#39;SB_inorm_T1&#39;, &#39;SB injunctive norm&#39;, mediatortable_intervention$diamondlabels)
mediatortable_intervention$diamondlabels &lt;- gsub(&#39;SB_intention_T1&#39;, &#39;SB intention&#39;, mediatortable_intervention$diamondlabels)
mediatortable_intervention$diamondlabels &lt;- gsub(&#39;SB_outcomeExpectations_T1&#39;, &#39;SB outcome expectations&#39;, mediatortable_intervention$diamondlabels)

mediatortable_control &lt;- ci_control %&gt;%
  dplyr::filter(grepl(&#39;PA_actionplan_T1|PA_copingplan_T1|PA_agrbct_T1|PA_frqbct_T1|PA_amotivation_T1|PA_autonomous_T1|PA_controlled_T1|PA_goal_T1|PA_inorm_T1|PA_dnorm_T1|PA_intention_T1|PA_outcomeExpectations_T1|PA_opportunities_T1|PA_pbc_T1|PA_selfefficacy_T1|SB_dnorm_T1|SB_inorm_T1|SB_intention_T1|SB_outcomeExpectations_T1&#39;, ci_control$diamondlabels)) %&gt;% 
  filter(diamondlabels != &quot;PA_goal_T1&quot;) %&gt;% 
  mutate(&quot;CI95&quot; = paste(round(ciLo, 1), &quot;-&quot;, round(ciHi, 1)),
         mean = round(mean, 1))

mediatortable_control$diamondlabels &lt;- gsub(&#39;PA_actionplan_T1&#39;, &#39;PA action planning&#39;, mediatortable_control$diamondlabels)
mediatortable_control$diamondlabels &lt;- gsub(&#39;PA_copingplan_T1&#39;, &#39;PA coping planning&#39;, mediatortable_control$diamondlabels)
mediatortable_control$diamondlabels &lt;- gsub(&#39;PA_agrbct_T1&#39;, &#39;PA agreement-BCTs&#39;, mediatortable_control$diamondlabels)
mediatortable_control$diamondlabels &lt;- gsub(&#39;PA_frqbct_T1&#39;, &#39;PA frequency-BCTs&#39;, mediatortable_control$diamondlabels)
mediatortable_control$diamondlabels &lt;- gsub(&#39;PA_amotivation_T1&#39;, &#39;PA amotivation&#39;, mediatortable_control$diamondlabels)
mediatortable_control$diamondlabels &lt;- gsub(&#39;PA_autonomous_T1&#39;, &#39;PA autonomous regulation&#39;, mediatortable_control$diamondlabels)
mediatortable_control$diamondlabels &lt;- gsub(&#39;PA_controlled_T1&#39;, &#39;PA controlled regulation&#39;, mediatortable_control$diamondlabels)
mediatortable_control$diamondlabels &lt;- gsub(&#39;PA_inorm_T1&#39;, &#39;PA injunctive norm&#39;, mediatortable_control$diamondlabels)
mediatortable_control$diamondlabels &lt;- gsub(&#39;PA_dnorm_T1&#39;, &#39;PA descriptive norm&#39;, mediatortable_control$diamondlabels)
mediatortable_control$diamondlabels &lt;- gsub(&#39;PA_intention_T1&#39;, &#39;PA intention&#39;, mediatortable_control$diamondlabels)
mediatortable_control$diamondlabels &lt;- gsub(&#39;PA_outcomeExpectations_T1&#39;, &#39;PA outcome expectations&#39;, mediatortable_control$diamondlabels)
mediatortable_control$diamondlabels &lt;- gsub(&#39;PA_opportunities_T1&#39;, &#39;PA opportunities&#39;, mediatortable_control$diamondlabels)
mediatortable_control$diamondlabels &lt;- gsub(&#39;PA_pbc_T1&#39;, &#39;PA perceived behavioural control&#39;, mediatortable_control$diamondlabels)
mediatortable_control$diamondlabels &lt;- gsub(&#39;PA_selfefficacy_T1&#39;, &#39;PA self-efficacy&#39;, mediatortable_control$diamondlabels)
mediatortable_control$diamondlabels &lt;- gsub(&#39;SB_dnorm_T1&#39;, &#39;SB descriptive norm&#39;, mediatortable_control$diamondlabels)
mediatortable_control$diamondlabels &lt;- gsub(&#39;SB_inorm_T1&#39;, &#39;SB injunctive norm&#39;, mediatortable_control$diamondlabels)
mediatortable_control$diamondlabels &lt;- gsub(&#39;SB_intention_T1&#39;, &#39;SB intention&#39;, mediatortable_control$diamondlabels)
mediatortable_control$diamondlabels &lt;- gsub(&#39;SB_outcomeExpectations_T1&#39;, &#39;SB outcome expectations&#39;, mediatortable_control$diamondlabels)

mediatortable_girls &lt;- ci_girls %&gt;%
  dplyr::filter(grepl(&#39;PA_actionplan_T1|PA_copingplan_T1|PA_agrbct_T1|PA_frqbct_T1|PA_amotivation_T1|PA_autonomous_T1|PA_controlled_T1|PA_goal_T1|PA_inorm_T1|PA_dnorm_T1|PA_intention_T1|PA_outcomeExpectations_T1|PA_opportunities_T1|PA_pbc_T1|PA_selfefficacy_T1|SB_dnorm_T1|SB_inorm_T1|SB_intention_T1|SB_outcomeExpectations_T1&#39;, ci_girls$diamondlabels)) %&gt;% 
  filter(diamondlabels != &quot;PA_goal_T1&quot;) %&gt;% 
  mutate(&quot;CI95&quot; = paste(round(ciLo, 1), &quot;-&quot;, round(ciHi, 1)),
         mean = round(mean, 1))

mediatortable_girls$diamondlabels &lt;- gsub(&#39;PA_actionplan_T1&#39;, &#39;PA action planning&#39;, mediatortable_girls$diamondlabels)
mediatortable_girls$diamondlabels &lt;- gsub(&#39;PA_copingplan_T1&#39;, &#39;PA coping planning&#39;, mediatortable_girls$diamondlabels)
mediatortable_girls$diamondlabels &lt;- gsub(&#39;PA_agrbct_T1&#39;, &#39;PA agreement-BCTs&#39;, mediatortable_girls$diamondlabels)
mediatortable_girls$diamondlabels &lt;- gsub(&#39;PA_frqbct_T1&#39;, &#39;PA frequency-BCTs&#39;, mediatortable_girls$diamondlabels)
mediatortable_girls$diamondlabels &lt;- gsub(&#39;PA_amotivation_T1&#39;, &#39;PA amotivation&#39;, mediatortable_girls$diamondlabels)
mediatortable_girls$diamondlabels &lt;- gsub(&#39;PA_autonomous_T1&#39;, &#39;PA autonomous regulation&#39;, mediatortable_girls$diamondlabels)
mediatortable_girls$diamondlabels &lt;- gsub(&#39;PA_controlled_T1&#39;, &#39;PA controlled regulation&#39;, mediatortable_girls$diamondlabels)
mediatortable_girls$diamondlabels &lt;- gsub(&#39;PA_inorm_T1&#39;, &#39;PA injunctive norm&#39;, mediatortable_girls$diamondlabels)
mediatortable_girls$diamondlabels &lt;- gsub(&#39;PA_dnorm_T1&#39;, &#39;PA descriptive norm&#39;, mediatortable_girls$diamondlabels)
mediatortable_girls$diamondlabels &lt;- gsub(&#39;PA_intention_T1&#39;, &#39;PA intention&#39;, mediatortable_girls$diamondlabels)
mediatortable_girls$diamondlabels &lt;- gsub(&#39;PA_outcomeExpectations_T1&#39;, &#39;PA outcome expectations&#39;, mediatortable_girls$diamondlabels)
mediatortable_girls$diamondlabels &lt;- gsub(&#39;PA_opportunities_T1&#39;, &#39;PA opportunities&#39;, mediatortable_girls$diamondlabels)
mediatortable_girls$diamondlabels &lt;- gsub(&#39;PA_pbc_T1&#39;, &#39;PA perceived behavioural control&#39;, mediatortable_girls$diamondlabels)
mediatortable_girls$diamondlabels &lt;- gsub(&#39;PA_selfefficacy_T1&#39;, &#39;PA self-efficacy&#39;, mediatortable_girls$diamondlabels)
mediatortable_girls$diamondlabels &lt;- gsub(&#39;SB_dnorm_T1&#39;, &#39;SB descriptive norm&#39;, mediatortable_girls$diamondlabels)
mediatortable_girls$diamondlabels &lt;- gsub(&#39;SB_inorm_T1&#39;, &#39;SB injunctive norm&#39;, mediatortable_girls$diamondlabels)
mediatortable_girls$diamondlabels &lt;- gsub(&#39;SB_intention_T1&#39;, &#39;SB intention&#39;, mediatortable_girls$diamondlabels)
mediatortable_girls$diamondlabels &lt;- gsub(&#39;SB_outcomeExpectations_T1&#39;, &#39;SB outcome expectations&#39;, mediatortable_girls$diamondlabels)

mediatortable_boys &lt;- ci_boys %&gt;%
  dplyr::filter(grepl(&#39;PA_actionplan_T1|PA_copingplan_T1|PA_agrbct_T1|PA_frqbct_T1|PA_amotivation_T1|PA_autonomous_T1|PA_controlled_T1|PA_goal_T1|PA_inorm_T1|PA_dnorm_T1|PA_intention_T1|PA_outcomeExpectations_T1|PA_opportunities_T1|PA_pbc_T1|PA_selfefficacy_T1|SB_dnorm_T1|SB_inorm_T1|SB_intention_T1|SB_outcomeExpectations_T1&#39;, ci_boys$diamondlabels)) %&gt;% 
  filter(diamondlabels != &quot;PA_goal_T1&quot;) %&gt;% 
  mutate(&quot;CI95&quot; = paste(round(ciLo, 1), &quot;-&quot;, round(ciHi, 1)),
         mean = round(mean, 1))

mediatortable_boys$diamondlabels &lt;- gsub(&#39;PA_actionplan_T1&#39;, &#39;PA action planning&#39;, mediatortable_boys$diamondlabels)
mediatortable_boys$diamondlabels &lt;- gsub(&#39;PA_copingplan_T1&#39;, &#39;PA coping planning&#39;, mediatortable_boys$diamondlabels)
mediatortable_boys$diamondlabels &lt;- gsub(&#39;PA_agrbct_T1&#39;, &#39;PA agreement-BCTs&#39;, mediatortable_boys$diamondlabels)
mediatortable_boys$diamondlabels &lt;- gsub(&#39;PA_frqbct_T1&#39;, &#39;PA frequency-BCTs&#39;, mediatortable_boys$diamondlabels)
mediatortable_boys$diamondlabels &lt;- gsub(&#39;PA_amotivation_T1&#39;, &#39;PA amotivation&#39;, mediatortable_boys$diamondlabels)
mediatortable_boys$diamondlabels &lt;- gsub(&#39;PA_autonomous_T1&#39;, &#39;PA autonomous regulation&#39;, mediatortable_boys$diamondlabels)
mediatortable_boys$diamondlabels &lt;- gsub(&#39;PA_controlled_T1&#39;, &#39;PA controlled regulation&#39;, mediatortable_boys$diamondlabels)
mediatortable_boys$diamondlabels &lt;- gsub(&#39;PA_inorm_T1&#39;, &#39;PA injunctive norm&#39;, mediatortable_boys$diamondlabels)
mediatortable_boys$diamondlabels &lt;- gsub(&#39;PA_dnorm_T1&#39;, &#39;PA descriptive norm&#39;, mediatortable_boys$diamondlabels)
mediatortable_boys$diamondlabels &lt;- gsub(&#39;PA_intention_T1&#39;, &#39;PA intention&#39;, mediatortable_boys$diamondlabels)
mediatortable_boys$diamondlabels &lt;- gsub(&#39;PA_outcomeExpectations_T1&#39;, &#39;PA outcome expectations&#39;, mediatortable_boys$diamondlabels)
mediatortable_boys$diamondlabels &lt;- gsub(&#39;PA_opportunities_T1&#39;, &#39;PA opportunities&#39;, mediatortable_boys$diamondlabels)
mediatortable_boys$diamondlabels &lt;- gsub(&#39;PA_pbc_T1&#39;, &#39;PA perceived behavioural control&#39;, mediatortable_boys$diamondlabels)
mediatortable_boys$diamondlabels &lt;- gsub(&#39;PA_selfefficacy_T1&#39;, &#39;PA self-efficacy&#39;, mediatortable_boys$diamondlabels)
mediatortable_boys$diamondlabels &lt;- gsub(&#39;SB_dnorm_T1&#39;, &#39;SB descriptive norm&#39;, mediatortable_boys$diamondlabels)
mediatortable_boys$diamondlabels &lt;- gsub(&#39;SB_inorm_T1&#39;, &#39;SB injunctive norm&#39;, mediatortable_boys$diamondlabels)
mediatortable_boys$diamondlabels &lt;- gsub(&#39;SB_intention_T1&#39;, &#39;SB intention&#39;, mediatortable_boys$diamondlabels)
mediatortable_boys$diamondlabels &lt;- gsub(&#39;SB_outcomeExpectations_T1&#39;, &#39;SB outcome expectations&#39;, mediatortable_boys$diamondlabels)

mediatortable_total &lt;- ci_total %&gt;%
  dplyr::filter(grepl(&#39;PA_actionplan_T1|PA_copingplan_T1|PA_agrbct_T1|PA_frqbct_T1|PA_amotivation_T1|PA_autonomous_T1|PA_controlled_T1|PA_goal_T1|PA_inorm_T1|PA_dnorm_T1|PA_intention_T1|PA_outcomeExpectations_T1|PA_opportunities_T1|PA_pbc_T1|PA_selfefficacy_T1|SB_dnorm_T1|SB_inorm_T1|SB_intention_T1|SB_outcomeExpectations_T1&#39;, ci_total$diamondlabels)) %&gt;% 
  filter(diamondlabels != &quot;PA_goal_T1&quot;) %&gt;% 
  mutate(&quot;CI95&quot; = paste(round(ciLo, 1), &quot;-&quot;, round(ciHi, 1)),
         mean = round(mean, 1))

mediatortable_total$diamondlabels &lt;- gsub(&#39;PA_actionplan_T1&#39;, &#39;PA action planning&#39;, mediatortable_total$diamondlabels)
mediatortable_total$diamondlabels &lt;- gsub(&#39;PA_copingplan_T1&#39;, &#39;PA coping planning&#39;, mediatortable_total$diamondlabels)
mediatortable_total$diamondlabels &lt;- gsub(&#39;PA_agrbct_T1&#39;, &#39;PA agreement-BCTs&#39;, mediatortable_total$diamondlabels)
mediatortable_total$diamondlabels &lt;- gsub(&#39;PA_frqbct_T1&#39;, &#39;PA frequency-BCTs&#39;, mediatortable_total$diamondlabels)
mediatortable_total$diamondlabels &lt;- gsub(&#39;PA_amotivation_T1&#39;, &#39;PA amotivation&#39;, mediatortable_total$diamondlabels)
mediatortable_total$diamondlabels &lt;- gsub(&#39;PA_autonomous_T1&#39;, &#39;PA autonomous regulation&#39;, mediatortable_total$diamondlabels)
mediatortable_total$diamondlabels &lt;- gsub(&#39;PA_controlled_T1&#39;, &#39;PA controlled regulation&#39;, mediatortable_total$diamondlabels)
mediatortable_total$diamondlabels &lt;- gsub(&#39;PA_inorm_T1&#39;, &#39;PA injunctive norm&#39;, mediatortable_total$diamondlabels)
mediatortable_total$diamondlabels &lt;- gsub(&#39;PA_dnorm_T1&#39;, &#39;PA descriptive norm&#39;, mediatortable_total$diamondlabels)
mediatortable_total$diamondlabels &lt;- gsub(&#39;PA_intention_T1&#39;, &#39;PA intention&#39;, mediatortable_total$diamondlabels)
mediatortable_total$diamondlabels &lt;- gsub(&#39;PA_outcomeExpectations_T1&#39;, &#39;PA outcome expectations&#39;, mediatortable_total$diamondlabels)
mediatortable_total$diamondlabels &lt;- gsub(&#39;PA_opportunities_T1&#39;, &#39;PA opportunities&#39;, mediatortable_total$diamondlabels)
mediatortable_total$diamondlabels &lt;- gsub(&#39;PA_pbc_T1&#39;, &#39;PA perceived behavioural control&#39;, mediatortable_total$diamondlabels)
mediatortable_total$diamondlabels &lt;- gsub(&#39;PA_selfefficacy_T1&#39;, &#39;PA self-efficacy&#39;, mediatortable_total$diamondlabels)
mediatortable_total$diamondlabels &lt;- gsub(&#39;SB_dnorm_T1&#39;, &#39;SB descriptive norm&#39;, mediatortable_total$diamondlabels)
mediatortable_total$diamondlabels &lt;- gsub(&#39;SB_inorm_T1&#39;, &#39;SB injunctive norm&#39;, mediatortable_total$diamondlabels)
mediatortable_total$diamondlabels &lt;- gsub(&#39;SB_intention_T1&#39;, &#39;SB intention&#39;, mediatortable_total$diamondlabels)
mediatortable_total$diamondlabels &lt;- gsub(&#39;SB_outcomeExpectations_T1&#39;, &#39;SB outcome expectations&#39;, mediatortable_total$diamondlabels)

mega_mediatortable &lt;- data.frame(Variable = mediatortable_girls$diamondlabels, 
                                 &quot;Girls&quot; = paste0(round(mediatortable_girls$mean, 2), &quot; (&quot;, mediatortable_girls$CI95, &quot;)&quot;),
                                 &quot;Boys&quot; = paste0(round(mediatortable_boys$mean, 2), &quot; (&quot;, mediatortable_boys$CI95, &quot;)&quot;),
                                 &quot;Intervention&quot; = paste0(round(mediatortable_intervention$mean, 2), &quot; (&quot;, mediatortable_intervention$CI95, &quot;)&quot;),
                                 &quot;Control&quot; = paste0(round(mediatortable_control$mean, 2), &quot; (&quot;, mediatortable_control$CI95, &quot;)&quot;),
                                 &quot;Total&quot; = paste0(round(mediatortable_total$mean, 2), &quot; (&quot;, mediatortable_total$CI95, &quot;)&quot;)) %&gt;% 
  arrange(Variable)

papaja::apa_table(mega_mediatortable, caption = &quot;Main mediating variables of PA and SB&quot;)</code></pre>
<caption>
(#tab:outcome-table2)
</caption>
<caption>
<em>Main mediating variables of PA and SB</em>
</caption>
<table>
<thead>
<tr class="header">
<th align="left">Variable</th>
<th align="left">Girls</th>
<th align="left">Boys</th>
<th align="left">Intervention</th>
<th align="left">Control</th>
<th align="left">Total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">PA action planning</td>
<td align="left">2.7 (2.6 - 2.8)</td>
<td align="left">2.8 (2.7 - 2.9)</td>
<td align="left">2.7 (2.6 - 2.8)</td>
<td align="left">2.8 (2.7 - 2.9)</td>
<td align="left">2.8 (2.7 - 2.8)</td>
</tr>
<tr class="even">
<td align="left">PA agreement-BCTs</td>
<td align="left">3.1 (2.9 - 3.2)</td>
<td align="left">3.1 (3 - 3.3)</td>
<td align="left">3 (2.9 - 3.2)</td>
<td align="left">3.2 (3 - 3.4)</td>
<td align="left">3.1 (3 - 3.2)</td>
</tr>
<tr class="odd">
<td align="left">PA amotivation</td>
<td align="left">1.5 (1.4 - 1.5)</td>
<td align="left">1.6 (1.5 - 1.7)</td>
<td align="left">1.5 (1.4 - 1.6)</td>
<td align="left">1.5 (1.4 - 1.7)</td>
<td align="left">1.5 (1.5 - 1.6)</td>
</tr>
<tr class="even">
<td align="left">PA autonomous regulation</td>
<td align="left">3.3 (3.2 - 3.5)</td>
<td align="left">3.6 (3.4 - 3.7)</td>
<td align="left">3.3 (3.2 - 3.5)</td>
<td align="left">3.5 (3.3 - 3.6)</td>
<td align="left">3.4 (3.3 - 3.5)</td>
</tr>
<tr class="odd">
<td align="left">PA controlled regulation</td>
<td align="left">1.9 (1.8 - 2)</td>
<td align="left">1.8 (1.7 - 1.8)</td>
<td align="left">1.8 (1.7 - 1.9)</td>
<td align="left">1.9 (1.8 - 1.9)</td>
<td align="left">1.8 (1.8 - 1.9)</td>
</tr>
<tr class="even">
<td align="left">PA coping planning</td>
<td align="left">2.4 (2.4 - 2.5)</td>
<td align="left">2.6 (2.5 - 2.7)</td>
<td align="left">2.5 (2.4 - 2.6)</td>
<td align="left">2.5 (2.4 - 2.6)</td>
<td align="left">2.5 (2.4 - 2.6)</td>
</tr>
<tr class="odd">
<td align="left">PA descriptive norm</td>
<td align="left">4.3 (4.1 - 4.5)</td>
<td align="left">4.5 (4.4 - 4.7)</td>
<td align="left">4.3 (4.1 - 4.5)</td>
<td align="left">4.5 (4.3 - 4.7)</td>
<td align="left">4.4 (4.2 - 4.6)</td>
</tr>
<tr class="even">
<td align="left">PA frequency-BCTs</td>
<td align="left">2.5 (2.4 - 2.6)</td>
<td align="left">2.6 (2.5 - 2.7)</td>
<td align="left">2.5 (2.4 - 2.6)</td>
<td align="left">2.6 (2.4 - 2.7)</td>
<td align="left">2.5 (2.4 - 2.6)</td>
</tr>
<tr class="odd">
<td align="left">PA injunctive norm</td>
<td align="left">4.6 (4.4 - 4.8)</td>
<td align="left">4.8 (4.5 - 5)</td>
<td align="left">4.5 (4.3 - 4.7)</td>
<td align="left">4.8 (4.6 - 5)</td>
<td align="left">4.7 (4.5 - 4.8)</td>
</tr>
<tr class="even">
<td align="left">PA intention</td>
<td align="left">5.3 (5.1 - 5.5)</td>
<td align="left">5.5 (5.2 - 5.7)</td>
<td align="left">5.4 (5.1 - 5.7)</td>
<td align="left">5.4 (5.1 - 5.7)</td>
<td align="left">5.4 (5.2 - 5.6)</td>
</tr>
<tr class="odd">
<td align="left">PA opportunities</td>
<td align="left">5.1 (5 - 5.1)</td>
<td align="left">5.2 (5.1 - 5.3)</td>
<td align="left">5.1 (5 - 5.2)</td>
<td align="left">5.2 (5.1 - 5.3)</td>
<td align="left">5.1 (5.1 - 5.2)</td>
</tr>
<tr class="even">
<td align="left">PA outcome expectations</td>
<td align="left">4.7 (4.6 - 4.8)</td>
<td align="left">4.5 (4.4 - 4.6)</td>
<td align="left">4.6 (4.4 - 4.7)</td>
<td align="left">4.7 (4.5 - 4.8)</td>
<td align="left">4.6 (4.5 - 4.7)</td>
</tr>
<tr class="odd">
<td align="left">PA perceived behavioural control</td>
<td align="left">5.2 (5.1 - 5.3)</td>
<td align="left">5.5 (5.4 - 5.6)</td>
<td align="left">5.3 (5.1 - 5.5)</td>
<td align="left">5.3 (5.1 - 5.5)</td>
<td align="left">5.3 (5.2 - 5.5)</td>
</tr>
<tr class="even">
<td align="left">PA self-efficacy</td>
<td align="left">5.1 (5 - 5.3)</td>
<td align="left">5.3 (5.2 - 5.5)</td>
<td align="left">5.2 (5 - 5.3)</td>
<td align="left">5.3 (5.1 - 5.4)</td>
<td align="left">5.2 (5.1 - 5.4)</td>
</tr>
<tr class="odd">
<td align="left">SB descriptive norm</td>
<td align="left">3.2 (3 - 3.4)</td>
<td align="left">3.4 (3.1 - 3.6)</td>
<td align="left">3.2 (3 - 3.4)</td>
<td align="left">3.3 (3.1 - 3.5)</td>
<td align="left">3.2 (3.1 - 3.4)</td>
</tr>
<tr class="even">
<td align="left">SB injunctive norm</td>
<td align="left">4 (3.8 - 4.1)</td>
<td align="left">4.1 (3.9 - 4.3)</td>
<td align="left">3.9 (3.8 - 4.1)</td>
<td align="left">4.1 (4 - 4.2)</td>
<td align="left">4 (3.9 - 4.1)</td>
</tr>
<tr class="odd">
<td align="left">SB intention</td>
<td align="left">3.8 (3.5 - 4.1)</td>
<td align="left">3.6 (3.3 - 3.9)</td>
<td align="left">3.7 (3.2 - 4.2)</td>
<td align="left">3.7 (3.3 - 4.2)</td>
<td align="left">3.7 (3.4 - 4.1)</td>
</tr>
<tr class="even">
<td align="left">SB outcome expectations</td>
<td align="left">4.5 (4.4 - 4.6)</td>
<td align="left">4.3 (4.2 - 4.4)</td>
<td align="left">4.4 (4.2 - 4.6)</td>
<td align="left">4.4 (4.3 - 4.6)</td>
<td align="left">4.4 (4.3 - 4.5)</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="pa-psychosocial-determinants-self-report-scales-t1" class="section level1">
<h1>PA psychosocial determinants: self report scales T1</h1>
<pre class="r"><code>PA_ci_girls &lt;- ci_girls %&gt;% filter(diamondlabels %in% names(scales_T1) &amp; grepl(&quot;PA_&quot;, diamondlabels) &amp; !grepl(&quot;bct&quot;, diamondlabels))

PA_ci_boys &lt;- ci_boys %&gt;% filter(diamondlabels %in% names(scales_T1) &amp; grepl(&quot;PA_&quot;, diamondlabels) &amp; !grepl(&quot;bct&quot;, diamondlabels))

PA_ci_intervention &lt;- ci_intervention %&gt;% filter(diamondlabels %in% names(scales_T1) &amp; grepl(&quot;PA_&quot;, diamondlabels) &amp; !grepl(&quot;bct&quot;, diamondlabels))

PA_ci_control &lt;- ci_control %&gt;% filter(diamondlabels %in% names(scales_T1) &amp; grepl(&quot;PA_&quot;, diamondlabels) &amp; !grepl(&quot;bct&quot;, diamondlabels))

ICClabels &lt;- vardatatable_containing_edutrack %&gt;% filter(Variable %in% PA_ci_control$diamondlabels)

library(ggplot2)
plot1 &lt;- userfriendlyscience::diamondPlot(PA_ci_girls, color = &#39;green&#39;, alpha=.3, yLabels = PA_ci_girls$diamondlabels, fixedSize = 0.3, xlab = NULL) +
  userfriendlyscience::diamondPlot(PA_ci_boys, returnLayerOnly = TRUE, color=&#39;blue&#39;, alpha=.3, fixedSize = 0.3) +
  scale_x_continuous(limits = c(1, 7), breaks = 1:7)

plot2 &lt;- userfriendlyscience::diamondPlot(PA_ci_intervention, color = &#39;red&#39;, alpha=.3, yLabels = c(rep(&quot;&quot;, length(PA_ci_girls$diamondlabels))), fixedSize = 0.3, xlab = NULL, ylab = NULL) +
  userfriendlyscience::diamondPlot(PA_ci_control, returnLayerOnly = TRUE, color=&#39;black&#39;, alpha=.3, fixedSize = 0.3) +
  scale_x_continuous(limits = c(1, 7), breaks = 1:7)

grid::grid.newpage()
grid::grid.draw(cbind(ggplotGrob(plot1), ggplotGrob(plot2), size = &quot;first&quot;))</code></pre>
<p><img src="baseline-supplement_files/figure-html/unnamed-chunk-10-1.png" width="2100" /></p>
<pre class="r"><code>
# dat2 &lt;- data.frame(ciLo = c(3, 2), mean = c(4, 2.5), ciHi = c(6, 3));
# userfriendlyscience::diamondPlot(dat1, color = &#39;blue&#39;, alpha=.3, yLabels = dat1$diamondlabels) +
# userfriendlyscience::diamondPlot(dat2, returnLayerOnly = TRUE, color=&#39;red&#39;, alpha=.3)
 </code></pre>
<p>Note: action and coping planning on a scale from 1 to 4.</p>
</div>
<div id="visualising-random-effects-using-full-posterior-under-construction" class="section level1">
<h1>Visualising random effects using full posterior (UNDER CONSTRUCTION)</h1>
<div id="using-rstanarm" class="section level2">
<h2>Using rstanarm</h2>
<p>Plot below shows credible intervals deviations</p>
<pre class="r"><code>library(rstanarm)
## rstanarm (Version 2.17.3, packaged: 2018-02-17 05:11:16 UTC)
## - Do not expect the default priors to remain the same in future rstanarm versions.
## Thus, R scripts should specify priors explicitly, even if they are just the defaults.
## - For execution on a local, multicore CPU with excess RAM we recommend calling
## options(mc.cores = parallel::detectCores())
## - Plotting theme set to bayesplot::theme_default().
## 
## Attaching package: &#39;rstanarm&#39;
## The following objects are masked from &#39;package:brms&#39;:
## 
##     exponential, kfold, lasso, ngrps
## The following object is masked from &#39;package:papaja&#39;:
## 
##     se
# grep(&quot;PA_&quot;, names(df), value = TRUE)

# Centre the variable:
df &lt;- df %&gt;% mutate(paAccelerometer_T1_centred = paAccelerometer_T1 - mean(paAccelerometer_T1, na.rm = TRUE))

m_1 &lt;- stan_glmer(paAccelerometer_T1_centred ~ (1 | group), data = df, chains = 2, iter = 2000) 
## Found more than one class &quot;family&quot; in cache; using the first, from namespace &#39;lme4&#39;
## Also defined by &#39;MatrixModels&#39;
## Found more than one class &quot;family&quot; in cache; using the first, from namespace &#39;lme4&#39;
## Also defined by &#39;MatrixModels&#39;
## 
## SAMPLING FOR MODEL &#39;continuous&#39; NOW (CHAIN 1).
## 
## Gradient evaluation took 0.001 seconds
## 1000 transitions using 10 leapfrog steps per transition would take 10 seconds.
## Adjust your expectations accordingly!
## 
## 
## Iteration:    1 / 2000 [  0%]  (Warmup)
## Iteration:  200 / 2000 [ 10%]  (Warmup)
## Iteration:  400 / 2000 [ 20%]  (Warmup)
## Iteration:  600 / 2000 [ 30%]  (Warmup)
## Iteration:  800 / 2000 [ 40%]  (Warmup)
## Iteration: 1000 / 2000 [ 50%]  (Warmup)
## Iteration: 1001 / 2000 [ 50%]  (Sampling)
## Iteration: 1200 / 2000 [ 60%]  (Sampling)
## Iteration: 1400 / 2000 [ 70%]  (Sampling)
## Iteration: 1600 / 2000 [ 80%]  (Sampling)
## Iteration: 1800 / 2000 [ 90%]  (Sampling)
## Iteration: 2000 / 2000 [100%]  (Sampling)
## 
##  Elapsed Time: 2.699 seconds (Warm-up)
##                1.292 seconds (Sampling)
##                3.991 seconds (Total)
## 
## 
## SAMPLING FOR MODEL &#39;continuous&#39; NOW (CHAIN 2).
## 
## Gradient evaluation took 0 seconds
## 1000 transitions using 10 leapfrog steps per transition would take 0 seconds.
## Adjust your expectations accordingly!
## 
## 
## Iteration:    1 / 2000 [  0%]  (Warmup)
## Iteration:  200 / 2000 [ 10%]  (Warmup)
## Iteration:  400 / 2000 [ 20%]  (Warmup)
## Iteration:  600 / 2000 [ 30%]  (Warmup)
## Iteration:  800 / 2000 [ 40%]  (Warmup)
## Iteration: 1000 / 2000 [ 50%]  (Warmup)
## Iteration: 1001 / 2000 [ 50%]  (Sampling)
## Iteration: 1200 / 2000 [ 60%]  (Sampling)
## Iteration: 1400 / 2000 [ 70%]  (Sampling)
## Iteration: 1600 / 2000 [ 80%]  (Sampling)
## Iteration: 1800 / 2000 [ 90%]  (Sampling)
## Iteration: 2000 / 2000 [100%]  (Sampling)
## 
##  Elapsed Time: 2.11 seconds (Warm-up)
##                1.294 seconds (Sampling)
##                3.404 seconds (Total)
pt &lt;- ranef(m_1) 
posteriors &lt;- data.frame(posterior_interval(m_1, prob = 0.90)) 
school_int &lt;- posteriors[-c(1, nrow(posteriors)-1, nrow(posteriors)),] #remove intercept and sigma parameters, leaving only class intervals 

# This not needed any more:
# groupmeans &lt;- df %&gt;% select(paAccelerometer_T1, group) %&gt;% group_by(group) %&gt;% 
#   summarise(mean = mean(paAccelerometer_T1, na.rm = T)) %&gt;% filter(complete.cases(.))

dat_plt &lt;- data.frame(pt$group, school_int) 
colnames(dat_plt) &lt;- c(&quot;pt&quot;, &quot;low&quot;, &quot;up&quot;) 
dat_plt &lt;- dat_plt %&gt;% arrange(pt) 
dat_plt$index &lt;- 1:nrow(dat_plt) 
dat_plt %&gt;% ggplot(aes(x = index, y = pt)) + geom_errorbar(aes(ymin = low, ymax = up)) + geom_point(size = 4, shape = 18) + geom_point(size = 2.5, shape = 18, color = &quot;white&quot;) + theme_bw()</code></pre>
<p><img src="baseline-supplement_files/figure-html/randeff-plot-rstanarm-1.png" width="2100" /></p>
</div>
<div id="using-brms-and-diamondplot" class="section level2">
<h2>Using brms and diamondPlot</h2>
<p>Set Rtools folder, if not in C:/Rtools/:</p>
<pre class="r"><code># For some reason, having BINPREF in .Renviron doesn&#39;t work and I keep needing this:
Sys.setenv(&quot;BINPREF&quot; = &quot;C:/HYApp/Rtools3.4/mingw_$(WIN)/bin/&quot;)</code></pre>
<pre class="r"><code>
library(brms)

# Centre the variable:
df &lt;- df %&gt;% mutate(paAccelerometer_T1_centred = 
                      paAccelerometer_T1 - mean(paAccelerometer_T1, na.rm = TRUE))

m_1 &lt;- brms::bf(paAccelerometer_T1_centred ~ (1 | group)) 
get_prior(m_1, data = df)

fit_1 &lt;- brms::brm(m_1, df)

pt &lt;- brms::ranef(fit_1, robust = TRUE) %&gt;% 
  data.frame %&gt;% 
  select(credintLow = group.2.5.ile.Intercept,
         intercept = group.Estimate.Intercept, 
         credintHigh = group.97.5.ile.Intercept) %&gt;% 
  arrange(intercept)


plot1 &lt;- userfriendlyscience::diamondPlot(pt, color = &#39;green&#39;, alpha=.3, yLabels = 1:58, fixedSize = 0.3, xlab = NULL) +
  coord_flip(expand = TRUE) +
  labs(x = &quot;Deviance from average MVPA&quot;, y = &quot;Group&quot;)


df %&gt;% ggplot(aes(x = group, y = paAccelerometer_T1_centred)) +
  userfriendlyscience::diamondPlot(pt, color = &#39;green&#39;, alpha=.3, yLabels = 1:58, fixedSize = 0.3, xlab = NULL, returnLayerOnly = TRUE) +
  coord_flip(expand = TRUE) +
  labs(x = &quot;Deviance from average MVPA&quot;, y = &quot;Group&quot;)
   
forest(fit_1)</code></pre>
</div>
<div id="random-effects-in-autonomous-motivation" class="section level2">
<h2>Random effects in autonomous motivation</h2>
<pre class="r"><code>
# Centre the variable:
df &lt;- df %&gt;% mutate(PA_autonomous_T1_centred = PA_autonomous_T1 - mean(PA_autonomous_T1, na.rm = TRUE))

m_1 &lt;- brms::bf(PA_autonomous_T1_centred ~ (1 | group)) 
get_prior(m_1, data = df)
## Found more than one class &quot;family&quot; in cache; using the first, from namespace &#39;lme4&#39;
## Also defined by &#39;MatrixModels&#39;
## Warning: Rows containing NAs were excluded from the model</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["prior"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["coef"],"name":[3],"type":["chr"],"align":["left"]},{"label":["group"],"name":[4],"type":["chr"],"align":["left"]},{"label":["resp"],"name":[5],"type":["chr"],"align":["left"]},{"label":["dpar"],"name":[6],"type":["chr"],"align":["left"]},{"label":["nlpar"],"name":[7],"type":["chr"],"align":["left"]},{"label":["bound"],"name":[8],"type":["chr"],"align":["left"]}],"data":[{"1":"student_t(3, 0, 10)","2":"Intercept","3":"","4":"","5":"","6":"","7":"","8":"","_rn_":"1"},{"1":"student_t(3, 0, 10)","2":"sd","3":"","4":"","5":"","6":"","7":"","8":"","_rn_":"2"},{"1":"","2":"sd","3":"","4":"group","5":"","6":"","7":"","8":"","_rn_":"3"},{"1":"","2":"sd","3":"Intercept","4":"group","5":"","6":"","7":"","8":"","_rn_":"4"},{"1":"student_t(3, 0, 10)","2":"sigma","3":"","4":"","5":"","6":"","7":"","8":"","_rn_":"5"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<pre class="r"><code>
fit_1 &lt;- brms::brm(m_1, df)
## Found more than one class &quot;family&quot; in cache; using the first, from namespace &#39;lme4&#39;
## Also defined by &#39;MatrixModels&#39;
## Warning: Rows containing NAs were excluded from the model
## Compiling the C++ model
## Start sampling
## 
## SAMPLING FOR MODEL &#39;gaussian brms-model&#39; NOW (CHAIN 1).
## 
## Gradient evaluation took 0 seconds
## 1000 transitions using 10 leapfrog steps per transition would take 0 seconds.
## Adjust your expectations accordingly!
## 
## 
## Iteration:    1 / 2000 [  0%]  (Warmup)
## Iteration:  200 / 2000 [ 10%]  (Warmup)
## Iteration:  400 / 2000 [ 20%]  (Warmup)
## Iteration:  600 / 2000 [ 30%]  (Warmup)
## Iteration:  800 / 2000 [ 40%]  (Warmup)
## Iteration: 1000 / 2000 [ 50%]  (Warmup)
## Iteration: 1001 / 2000 [ 50%]  (Sampling)
## Iteration: 1200 / 2000 [ 60%]  (Sampling)
## Iteration: 1400 / 2000 [ 70%]  (Sampling)
## Iteration: 1600 / 2000 [ 80%]  (Sampling)
## Iteration: 1800 / 2000 [ 90%]  (Sampling)
## Iteration: 2000 / 2000 [100%]  (Sampling)
## 
##  Elapsed Time: 1.703 seconds (Warm-up)
##                0.849 seconds (Sampling)
##                2.552 seconds (Total)
## 
## 
## SAMPLING FOR MODEL &#39;gaussian brms-model&#39; NOW (CHAIN 2).
## 
## Gradient evaluation took 0 seconds
## 1000 transitions using 10 leapfrog steps per transition would take 0 seconds.
## Adjust your expectations accordingly!
## 
## 
## Iteration:    1 / 2000 [  0%]  (Warmup)
## Iteration:  200 / 2000 [ 10%]  (Warmup)
## Iteration:  400 / 2000 [ 20%]  (Warmup)
## Iteration:  600 / 2000 [ 30%]  (Warmup)
## Iteration:  800 / 2000 [ 40%]  (Warmup)
## Iteration: 1000 / 2000 [ 50%]  (Warmup)
## Iteration: 1001 / 2000 [ 50%]  (Sampling)
## Iteration: 1200 / 2000 [ 60%]  (Sampling)
## Iteration: 1400 / 2000 [ 70%]  (Sampling)
## Iteration: 1600 / 2000 [ 80%]  (Sampling)
## Iteration: 1800 / 2000 [ 90%]  (Sampling)
## Iteration: 2000 / 2000 [100%]  (Sampling)
## 
##  Elapsed Time: 1.743 seconds (Warm-up)
##                0.681 seconds (Sampling)
##                2.424 seconds (Total)
## 
## 
## SAMPLING FOR MODEL &#39;gaussian brms-model&#39; NOW (CHAIN 3).
## 
## Gradient evaluation took 0 seconds
## 1000 transitions using 10 leapfrog steps per transition would take 0 seconds.
## Adjust your expectations accordingly!
## 
## 
## Iteration:    1 / 2000 [  0%]  (Warmup)
## Iteration:  200 / 2000 [ 10%]  (Warmup)
## Iteration:  400 / 2000 [ 20%]  (Warmup)
## Iteration:  600 / 2000 [ 30%]  (Warmup)
## Iteration:  800 / 2000 [ 40%]  (Warmup)
## Iteration: 1000 / 2000 [ 50%]  (Warmup)
## Iteration: 1001 / 2000 [ 50%]  (Sampling)
## Iteration: 1200 / 2000 [ 60%]  (Sampling)
## Iteration: 1400 / 2000 [ 70%]  (Sampling)
## Iteration: 1600 / 2000 [ 80%]  (Sampling)
## Iteration: 1800 / 2000 [ 90%]  (Sampling)
## Iteration: 2000 / 2000 [100%]  (Sampling)
## 
##  Elapsed Time: 1.389 seconds (Warm-up)
##                1.19 seconds (Sampling)
##                2.579 seconds (Total)
## 
## 
## SAMPLING FOR MODEL &#39;gaussian brms-model&#39; NOW (CHAIN 4).
## 
## Gradient evaluation took 0 seconds
## 1000 transitions using 10 leapfrog steps per transition would take 0 seconds.
## Adjust your expectations accordingly!
## 
## 
## Iteration:    1 / 2000 [  0%]  (Warmup)
## Iteration:  200 / 2000 [ 10%]  (Warmup)
## Iteration:  400 / 2000 [ 20%]  (Warmup)
## Iteration:  600 / 2000 [ 30%]  (Warmup)
## Iteration:  800 / 2000 [ 40%]  (Warmup)
## Iteration: 1000 / 2000 [ 50%]  (Warmup)
## Iteration: 1001 / 2000 [ 50%]  (Sampling)
## Iteration: 1200 / 2000 [ 60%]  (Sampling)
## Iteration: 1400 / 2000 [ 70%]  (Sampling)
## Iteration: 1600 / 2000 [ 80%]  (Sampling)
## Iteration: 1800 / 2000 [ 90%]  (Sampling)
## Iteration: 2000 / 2000 [100%]  (Sampling)
## 
##  Elapsed Time: 1.505 seconds (Warm-up)
##                1.197 seconds (Sampling)
##                2.702 seconds (Total)

pt &lt;- brms::ranef(fit_1, robust = TRUE) %&gt;% 
  data.frame %&gt;% 
  select(credintLow = group.2.5.ile.Intercept,
         intercept = group.Estimate.Intercept, 
         credintHigh = group.97.5.ile.Intercept) %&gt;% 
  arrange(intercept)


plot1 &lt;- userfriendlyscience::diamondPlot(pt, color = &#39;blue&#39;, alpha=.3, yLabels = 1:59, fixedSize = 0.3, xlab = NULL) +
  coord_flip(expand = TRUE) +
  labs(x = &quot;Deviance from average motivation&quot;, y = &quot;Group&quot;)


df %&gt;% ggplot(aes(x = group, y = PA_autonomous_T1_centred)) +
  userfriendlyscience::diamondPlot(pt, color = &#39;blue&#39;, alpha=.3, yLabels = 1:59, fixedSize = 0.3, xlab = NULL, returnLayerOnly = TRUE) +
  coord_flip(expand = TRUE) +
  labs(x = &quot;Deviance from average motivation&quot;, y = &quot;Group&quot;)</code></pre>
<p><img src="baseline-supplement_files/figure-html/randeff-plot-brms-autonomous-1.png" width="3600" /></p>
</div>
</div>
<div id="ridge-plots" class="section level1">
<h1>Ridge plots</h1>
<div id="pa-motivation" class="section level2">
<h2>PA motivation</h2>
<pre class="r"><code>
plot1 &lt;- df %&gt;% dplyr::select(id,
  intervention,
  group,
  school,
  girl,
  &#39;PA autonomous \nmotivation&#39; = PA_autonomous_T1,
&#39;PA controlled \nmotivation&#39; = PA_controlled_T1,
&#39;PA amotivation&#39; = PA_amotivation_T1)  %&gt;%
  # select(noquote(order(colnames(.)))) %&gt;% # Orders columns alphabetically
  tidyr::gather(key = Variable, value = Value, 6:ncol(.)) %&gt;% 
  ggplot(aes(y = Variable)) +
  ggridges::geom_density_ridges(aes(x = Value, fill = paste(Variable, girl)), 
           alpha = .6, color = &quot;black&quot;, from = 1, to = 7, scale = 1) +
  labs(x = &quot;&quot;,
       y = &quot;&quot;) +
  scale_y_discrete(expand = c(0.01, 0)) +
  scale_x_continuous(expand = c(0.01, 0)) +
  ggridges::scale_fill_cyclical(breaks = c(&quot;PA amotivation Boy&quot;, &quot;PA amotivation Girl&quot;),
                      labels = c( &#39;PA amotivation Girl&#39; = &quot;Boy&quot;, &#39;PA amotivation Boy&#39; = &quot;Girl&quot;),
                      values = c(&quot;#3bc600&quot;, &quot;#0000ff&quot;, &quot;#9cc68b&quot;, &quot;#8080ff&quot;),
                      name = &quot;&quot;, guide = &quot;legend&quot;) +
  ggridges::theme_ridges(grid = FALSE) +
  theme(legend.position=&quot;bottom&quot;)

plot2 &lt;- df %&gt;% dplyr::select(id,
  intervention,
  group,
  school,
  girl,
  &#39;PA autonomous \nmotivation&#39; = PA_autonomous_T1,
&#39;PA controlled \nmotivation&#39; = PA_controlled_T1,
&#39;PA amotivation&#39; = PA_amotivation_T1) %&gt;%
  # select(noquote(order(colnames(.)))) %&gt;% # Orders columns alphabetically
  tidyr::gather(key = Variable, value = Value, 6:ncol(.)) %&gt;% 
  ggplot(aes(y = Variable)) +
  ggridges::geom_density_ridges(aes(x = Value, fill = paste(Variable, intervention)), 
           alpha = .6, color = &quot;black&quot;, from = 1, to = 7, scale = 1) +
  labs(x = &quot;&quot;,
       y = &quot;&quot;) +
  scale_y_discrete(expand = c(0.01, 0), labels = NULL) +
  scale_x_continuous(expand = c(0.01, 0)) +
  ggridges::scale_fill_cyclical(breaks = c(&quot;PA amotivation 1&quot;, &quot;PA amotivation 0&quot;),
                      labels = c(&#39;PA amotivation 1&#39; = &quot;Intervention&quot;, &#39;PA amotivation 0&#39; = &quot;Control&quot;),
                      values = c(&quot;#ff0000&quot;, &quot;#0000ff&quot;, &quot;#ff8080&quot;, &quot;#8080ff&quot;),
                      name = &quot;&quot;, guide = &quot;legend&quot;) +
  ggridges::theme_ridges(grid = FALSE) +
  theme(legend.position=&quot;bottom&quot;)

# grid.arrange(plot1, plot2, ncol = 2)

grid::grid.newpage()
grid::grid.draw(cbind(ggplotGrob(plot1), ggplotGrob(plot2), size = &quot;first&quot;))
## Picking joint bandwidth of 0.216
## Warning: Removed 272 rows containing non-finite values
## (stat_density_ridges).
## Picking joint bandwidth of 0.216
## Warning: Removed 272 rows containing non-finite values
## (stat_density_ridges).
## Error: nrow(x) == nrow(y) is not TRUE</code></pre>
</div>
<div id="big-5-personality-traits" class="section level2">
<h2>Big 5 personality traits</h2>
<pre class="r"><code>
plot1 &lt;- df %&gt;% dplyr::select(id,
  intervention,
  group,
  school,
  girl,
&#39;Agreeableness&#39; = big5_agreeableness_T1,
&#39;Conscientiousness&#39; = big5_conscientiousness_T1,
&#39;Extraversion&#39; = big5_extraversion_T1,
&#39;Neuroticism&#39; = big5_neuroticism_T1,
&#39;Openness&#39; = big5_openness_T1)  %&gt;%
  # select(noquote(order(colnames(.)))) %&gt;% # Orders columns alphabetically
  tidyr::gather(key = Variable, value = Value, 6:ncol(.)) %&gt;% 
  ggplot(aes(y = Variable)) +
  ggridges::geom_density_ridges(aes(x = Value, fill = paste(Variable, girl)), 
           alpha = .6, color = &quot;black&quot;, from = 1, to = 7) +
  labs(x = &quot;&quot;,
       y = &quot;&quot;) +
  scale_y_discrete(expand = c(0.01, 0)) +
  scale_x_continuous(expand = c(0.01, 0)) +
  ggridges::scale_fill_cyclical(breaks = c(&quot;Agreeableness 0&quot;, &quot;Agreeableness 1&quot;),
                      labels = c( &#39;Agreeableness 0&#39; = &quot;Boy&quot;, &#39;Agreeableness 1&#39; = &quot;Girl&quot;),
                      values = c(&quot;#3bc600&quot;, &quot;#0000ff&quot;, &quot;#9cc68b&quot;, &quot;#8080ff&quot;),
                      name = &quot;&quot;, guide = &quot;legend&quot;) +
  ggridges::theme_ridges(grid = FALSE) +
  theme(legend.position=&quot;bottom&quot;)
## Error in FUN(X[[i]], ...): object &#39;big5_agreeableness_T1&#39; not found

plot2 &lt;- df %&gt;% dplyr::select(id,
  intervention,
  group,
  school,
  girl,
&#39;Agreeableness&#39; = big5_agreeableness_T1,
&#39;Conscientiousness&#39; = big5_conscientiousness_T1,
&#39;Extraversion&#39; = big5_extraversion_T1,
&#39;Neuroticism&#39; = big5_neuroticism_T1,
&#39;Openness&#39; = big5_openness_T1) %&gt;%
  # select(noquote(order(colnames(.)))) %&gt;% # Orders columns alphabetically
  tidyr::gather(key = Variable, value = Value, 6:ncol(.)) %&gt;% 
  ggplot(aes(y = Variable)) +
  ggridges::geom_density_ridges(aes(x = Value, fill = paste(Variable, intervention)), 
           alpha = .6, color = &quot;black&quot;, from = 1, to = 7) +
  labs(x = &quot;&quot;,
       y = &quot;&quot;) +
  scale_y_discrete(expand = c(0.01, 0), labels = NULL) +
  scale_x_continuous(expand = c(0.01, 0)) +
  ggridges::scale_fill_cyclical(breaks = c(&quot;Agreeableness 1&quot;, &quot;Agreeableness 0&quot;),
                      labels = c(&#39;Agreeableness 1&#39; = &quot;Intervention&quot;, &#39;Agreeableness 0&#39; = &quot;Control&quot;),
                      values = c(&quot;#ff0000&quot;, &quot;#0000ff&quot;, &quot;#ff8080&quot;, &quot;#8080ff&quot;),
                      name = &quot;&quot;, guide = &quot;legend&quot;) +
  ggridges::theme_ridges(grid = FALSE) +
  theme(legend.position=&quot;bottom&quot;)
## Error in FUN(X[[i]], ...): object &#39;big5_agreeableness_T1&#39; not found

# grid.arrange(plot1, plot2, ncol = 2)

grid::grid.newpage()
grid::grid.draw(cbind(ggplotGrob(plot1), ggplotGrob(plot2), size = &quot;first&quot;))
## Picking joint bandwidth of 0.216
## Warning: Removed 272 rows containing non-finite values
## (stat_density_ridges).
## Picking joint bandwidth of 0.216
## Warning: Removed 272 rows containing non-finite values
## (stat_density_ridges).
## Error: nrow(x) == nrow(y) is not TRUE</code></pre>
</div>
<div id="bct-use" class="section level2">
<h2>BCT use</h2>
<div id="ridge-plots-for-means" class="section level3">
<h3>Ridge plots for means</h3>
<pre class="r"><code>
plot1 &lt;- df %&gt;% dplyr::select(id,
  intervention,
  group,
  school,
  girl,
&#39;Frequency-\nrelated BCTs&#39; = PA_frqbct_T1,
&#39;Agreement-\nrelated BCTs&#39; = PA_agrbct_T1)  %&gt;%
  # select(noquote(order(colnames(.)))) %&gt;% # Orders columns alphabetically
  tidyr::gather(key = Variable, value = Value, 6:ncol(.)) %&gt;% 
  ggplot(aes(y = Variable)) +
  ggridges::geom_density_ridges(aes(x = Value, fill = paste(Variable, girl)), 
           alpha = .6, color = &quot;black&quot;, from = 1, to = 7) +
  labs(x = &quot;&quot;,
       y = &quot;&quot;) +
  scale_y_discrete(expand = c(0.01, 0)) +
  scale_x_continuous(expand = c(0.01, 0)) +
  ggridges::scale_fill_cyclical(breaks = c(&quot;Agreement-\nrelated BCTs 0&quot;, &quot;Agreement-\nrelated BCTs 1&quot;),
                      labels = c( &#39;Agreement-\nrelated BCTs 0&#39; = &quot;Boy&quot;, &#39;Agreement-\nrelated BCTs 1&#39; = &quot;Girl&quot;),
                      values = c(&quot;#3bc600&quot;, &quot;#0000ff&quot;, &quot;#9cc68b&quot;, &quot;#8080ff&quot;),
                      name = &quot;&quot;, guide = &quot;legend&quot;) +
  ggridges::theme_ridges(grid = FALSE) +
  theme(legend.position=&quot;bottom&quot;)

plot2 &lt;- df %&gt;% dplyr::select(id,
  intervention,
  group,
  school,
  girl,
&#39;Frequency-\nrelated BCTs&#39; = PA_frqbct_T1,
&#39;Agreement-\nrelated BCTs&#39; = PA_agrbct_T1) %&gt;%
  # select(noquote(order(colnames(.)))) %&gt;% # Orders columns alphabetically
  tidyr::gather(key = Variable, value = Value, 6:ncol(.)) %&gt;% 
  ggplot(aes(y = Variable)) +
  ggridges::geom_density_ridges(aes(x = Value, fill = paste(Variable, intervention)), 
           alpha = .6, color = &quot;black&quot;, from = 1, to = 7) +
  labs(x = &quot;&quot;,
       y = &quot;&quot;) +
  scale_y_discrete(expand = c(0.01, 0), labels = NULL) +
  scale_x_continuous(expand = c(0.01, 0)) +
  ggridges::scale_fill_cyclical(breaks = c(&quot;Agreement-\nrelated BCTs 1&quot;, &quot;Agreement-\nrelated BCTs 0&quot;),
                      labels = c(&#39;Agreement-\nrelated BCTs 1&#39; = &quot;Intervention&quot;, &#39;Agreement-\nrelated BCTs 0&#39; = &quot;Control&quot;),
                      values = c(&quot;#ff0000&quot;, &quot;#0000ff&quot;, &quot;#ff8080&quot;, &quot;#8080ff&quot;),
                      name = &quot;&quot;, guide = &quot;legend&quot;) +
  ggridges::theme_ridges(grid = FALSE) +
  theme(legend.position=&quot;bottom&quot;)

grid::grid.newpage()
grid::grid.draw(cbind(ggplotGrob(plot1), ggplotGrob(plot2), size = &quot;first&quot;))
## Picking joint bandwidth of 0.319
## Warning: Removed 189 rows containing non-finite values
## (stat_density_ridges).
## Picking joint bandwidth of 0.318
## Warning: Removed 189 rows containing non-finite values
## (stat_density_ridges).
## Error: nrow(x) == nrow(y) is not TRUE



# grid.arrange(plot1, plot2, ncol = 2)</code></pre>
</div>
<div id="sm-kernel-density-plots-for-means" class="section level3">
<h3>sm kernel density plots for means</h3>
<div id="frequency-measured-bcts" class="section level4">
<h4>Frequency-measured BCTs</h4>
<pre class="r"><code>
colfill &lt;- c(1,2,3,4,5)

# Create data frame
densplot &lt;- df
levels(densplot$intervention) &lt;- list(&quot;Intervention&quot; = &quot;1&quot;, &quot;Control&quot; = &quot;0&quot;)
levels(densplot$girl) &lt;- list(&quot;Girl&quot; = &quot;1&quot;, &quot;Boy&quot; = &quot;0&quot;)

# This gives side-by-side plots
 layout(matrix(c(1,2,3,3), nrow = 2, ncol = 2, byrow = TRUE), heights=c(2.5, 2))

## Intervention vs. control
# Choose only the variables needed and drop NA
dens &lt;- densplot %&gt;% select(PA_frqbct_T1, intervention) %&gt;% 
  na.omit(.)

# Set random number generator for reproducibility of bootstrap test of equal densities
set.seed(10)
# Make plot
sm.PA_frqbct_T1_1 &lt;- sm.density.compare2(as.numeric(dens$PA_frqbct_T1), as.factor(dens$intervention), xlab=&quot;&quot;, col=colfill, lty=c(1,2), bandcol=&#39;LightGray&#39;, model=&quot;equal&quot;, lwd=(c(2,2)))
## 
## Test of equal densities:  p-value =  0.31
legend(&quot;topright&quot;, levels(dens$intervention), fill=c(1, 2))

## Girls vs. boys
# Choose only the variables needed and drop NA
dens &lt;- densplot %&gt;% select(PA_frqbct_T1, girl) %&gt;% 
  na.omit(.)

# Set random number generator for reproducibility of bootstrap test of equal densities
set.seed(10)
# Make plot
sm.PA_frqbct_T1_2 &lt;- sm.density.compare2(as.numeric(dens$PA_frqbct_T1), as.factor(dens$girl), xlab=&quot;&quot;, col=colfill, lty=c(1,2), bandcol=&#39;LightGray&#39;, model=&quot;equal&quot;, lwd=(c(2,2)))
## Warning in min(x): no non-missing arguments to min; returning Inf

## Warning in min(x): no non-missing arguments to min; returning Inf
## Warning in max(x): no non-missing arguments to max; returning -Inf

## Warning in max(x): no non-missing arguments to max; returning -Inf
## Warning in min(x): no non-missing arguments to min; returning Inf
## Warning in max(x): no non-missing arguments to max; returning -Inf
## Error in seq.default(opt$xlim[1], opt$xlim[2], length = opt$ngrid): &#39;from&#39; must be a finite number
legend(&quot;topright&quot;, levels(dens$girl), fill=c(1, 2))

## Differences in schools
# Choose only the variables needed and drop NA
dens &lt;- densplot %&gt;% select(PA_frqbct_T1, school) %&gt;% 
  na.omit(.)

# Set random number generator for reproducibility of bootstrap test of equal densities
set.seed(10)

# Intervention groups with solid thicker lines
linetypes &lt;- c(1,2,2,1,2)

# Set random number generator for reproducibility of bootstrap test of equal densities
set.seed(10)
# Make plot
sm.PA_frqbct_T1_3 &lt;- sm::sm.density.compare(as.numeric(dens$PA_frqbct_T1), dens$school, xlab=&quot;&quot;, col=colfill, lty=linetypes, model=&quot;none&quot;)
legend(&quot;topright&quot;, c(&quot;Intervention school&quot;, &quot;Control school&quot;), col = c(4, 3), lty = c(1, 2), lwd = c(2, 2))</code></pre>
<p><img src="baseline-supplement_files/figure-html/unnamed-chunk-15-1.png" width="2100" /></p>
</div>
<div id="agreement-measured-bcts" class="section level4">
<h4>Agreement-measured BCTs</h4>
<pre class="r"><code>
colfill &lt;- c(1,2,3,4,5)

# Create data frame
densplot &lt;- df
levels(densplot$intervention) &lt;- list(&quot;Intervention&quot; = &quot;1&quot;, &quot;Control&quot; = &quot;0&quot;)
levels(densplot$girl) &lt;- list(&quot;Girl&quot; = &quot;1&quot;, &quot;Boy&quot; = &quot;0&quot;)

# This gives side-by-side plots
 layout(matrix(c(1,2,3,3), nrow = 2, ncol = 2, byrow = TRUE), heights=c(2.5, 2))

## Intervention vs. control
# Choose only the variables needed and drop NA
dens &lt;- densplot %&gt;% select(PA_agrbct_T1, intervention) %&gt;% 
  na.omit(.)

# Set random number generator for reproducibility of bootstrap test of equal densities
set.seed(10)
# Make plot
sm.PA_agrbct_T1_1 &lt;- sm.density.compare2(as.numeric(dens$PA_agrbct_T1), as.factor(dens$intervention), xlab=&quot;&quot;, col=colfill, lty=c(1,2), bandcol=&#39;LightGray&#39;, model=&quot;equal&quot;, lwd=(c(2,2)))
## 
## Test of equal densities:  p-value =  0
legend(&quot;topright&quot;, levels(dens$intervention), fill=c(1, 2))

## Girls vs. boys
# Choose only the variables needed and drop NA
dens &lt;- densplot %&gt;% select(PA_agrbct_T1, girl) %&gt;% 
  na.omit(.)

# Set random number generator for reproducibility of bootstrap test of equal densities
set.seed(10)
# Make plot
sm.PA_agrbct_T1_2 &lt;- sm.density.compare2(as.numeric(dens$PA_agrbct_T1), as.factor(dens$girl), xlab=&quot;&quot;, col=colfill, lty=c(1,2), bandcol=&#39;LightGray&#39;, model=&quot;equal&quot;, lwd=(c(2,2)))
## Warning in min(x): no non-missing arguments to min; returning Inf

## Warning in min(x): no non-missing arguments to min; returning Inf
## Warning in max(x): no non-missing arguments to max; returning -Inf

## Warning in max(x): no non-missing arguments to max; returning -Inf
## Warning in min(x): no non-missing arguments to min; returning Inf
## Warning in max(x): no non-missing arguments to max; returning -Inf
## Error in seq.default(opt$xlim[1], opt$xlim[2], length = opt$ngrid): &#39;from&#39; must be a finite number
legend(&quot;topright&quot;, levels(dens$girl), fill=c(1, 2))

## Differences in schools
# Choose only the variables needed and drop NA
dens &lt;- densplot %&gt;% select(PA_agrbct_T1, school) %&gt;% 
  na.omit(.)

# Intervention groups with solid thicker lines
linetypes &lt;- c(1,2,2,1,2)

# Set random number generator for reproducibility of bootstrap test of equal densities
set.seed(10)
# Make plot
sm.PA_agrbct_T1_3 &lt;- sm::sm.density.compare(as.numeric(dens$PA_agrbct_T1), dens$school, xlab=&quot;&quot;, col=colfill, lty=linetypes, model=&quot;none&quot;)
legend(&quot;topright&quot;, c(&quot;Intervention school&quot;, &quot;Control school&quot;), col = c(4, 3), lty = c(1, 2), lwd = c(2, 2))</code></pre>
<p><img src="baseline-supplement_files/figure-html/unnamed-chunk-16-1.png" width="2100" /></p>
</div>
</div>
<div id="histograms-for-individual-items" class="section level3">
<h3>Histograms for individual items</h3>
<div id="frequency-measured-bcts-1" class="section level4">
<h4>Frequency-measured BCTs</h4>
<p>These questions were asked with the lead “Have you done the following during the last three weeks?”.</p>
<p>The answer scale was as follows:</p>
<p>0 = not once 1 = once 2 = twice 3 = weekly 4 = about every second day 5 = daily</p>
<p>Items are as follows:</p>
<ol style="list-style-type: decimal">
<li>I have reminded myself even in my spare time, what kind of positive consequences frequent PA would have in my life.</li>
<li>I have monitored my PA by marking the PA occasions on an exercise log on paper.</li>
<li>I have monitored my PA by using a smart phone, e.g. the Moves-app.</li>
<li>I use mnemonic cues with which I remember to implement my PA intention.</li>
<li>I have compared my actualized PA with the PA goal I have set.</li>
<li>I have thought about which reasons to do PA are important to me personally.</li>
<li>I have made changes in my home (e.g. my room or my computer), so that starting PA would be easier.</li>
<li>I have asked my friends or family for support to reach my PA goals.</li>
<li>If I haven’t reached my PA goal, I have evaluated, what went wrong.</li>
</ol>
<pre class="r"><code>
bctGirls &lt;- df %&gt;% dplyr::select(id,
  intervention,
  group,
  school,
  girl,
&#39;Reminded self of positive consequences&#39; = PA_frqbct_01_T1,
&#39;Has logged PA on paper&#39; = PA_frqbct_02_T1,
&#39;Has monitored PA on smartphone&#39; = PA_frqbct_03_T1,
&#39;Uses mnemonic cues&#39; = PA_frqbct_04_T1,
&#39;Has compared actual with goal&#39; = PA_frqbct_05_T1,
&#39;Has thought of relevance of PA&#39; = PA_frqbct_06_T1,
&#39;Has made changes at home&#39; = PA_frqbct_07_T1,
&#39;Has sought social support&#39; = PA_frqbct_08_T1,
&#39;Has evaluated why goal not reached&#39; = PA_frqbct_09_T1) %&gt;%
 tidyr::gather(key = Variable, value = Value, 6:ncol(.)) %&gt;%
  filter(girl == &quot;girl&quot;) %&gt;% 
 ggplot(aes(x = Value, y = Variable, group = Variable)) +
  ggridges::geom_density_ridges2(aes(fill = Variable), stat = &quot;binline&quot;, binwidth = 1, scale = 0.95) +
  scale_x_continuous(breaks = c(1:6), expand = c(0, 0),
                     name = &quot;&quot;) +
  scale_y_discrete(expand = c(0.01, 0), name = &quot;&quot;, labels = NULL) +
  ggridges::scale_fill_cyclical(values = c(&quot;darkolivegreen2&quot;, &quot;darkolivegreen4&quot;)) +
  labs(title = &quot;Girls&quot;) +
  guides(y = &quot;none&quot;) +
  ggridges::theme_ridges(grid = FALSE) +
  theme(axis.title.x = element_text(hjust = 0.5),
        axis.title.y = element_text(hjust = 0.5),
        plot.title = element_text(hjust = 0.5),
        axis.text=element_text(size=10, face=&quot;bold&quot;)) +
coord_cartesian(xlim = c(0.5, 6.5))
## Warning: attributes are not identical across measure variables;
## they will be dropped

bctBoys &lt;- df %&gt;% dplyr::select(id,
  intervention,
  group,
  school,
  girl,
&#39;Reminded self of positive consequences&#39; = PA_frqbct_01_T1,
&#39;Has logged PA on paper&#39; = PA_frqbct_02_T1,
&#39;Has monitored PA on smartphone&#39; = PA_frqbct_03_T1,
&#39;Uses mnemonic cues&#39; = PA_frqbct_04_T1,
&#39;Has compared actual with goal&#39; = PA_frqbct_05_T1,
&#39;Has thought of relevance of PA&#39; = PA_frqbct_06_T1,
&#39;Has made changes at home&#39; = PA_frqbct_07_T1,
&#39;Has sought social support&#39; = PA_frqbct_08_T1,
&#39;Has evaluated why goal not reached&#39; = PA_frqbct_09_T1) %&gt;%
 tidyr::gather(key = Variable, value = Value, 6:ncol(.)) %&gt;%
  filter(girl == &quot;boy&quot;) %&gt;% 
 ggplot(aes(x = Value, y = Variable, group = Variable)) +
  ggridges::geom_density_ridges2(aes(fill = Variable), stat = &quot;binline&quot;, binwidth = 1, scale = 0.95) +
  scale_x_continuous(breaks = c(1:6), expand = c(0, 0),
                     name = &quot;&quot;) +
  scale_y_discrete(expand = c(0.01, 0), name = &quot;&quot;, labels = NULL) +
  ggridges::scale_fill_cyclical(values = c(&quot;darkolivegreen2&quot;, &quot;darkolivegreen4&quot;)) +
  labs(title = &quot;Boys&quot;) +
  guides(y = &quot;none&quot;) +
  ggridges::theme_ridges(grid = FALSE) +
  theme(axis.title.x = element_text(hjust = 0.5),
        axis.title.y = element_text(hjust = 0.5),
        plot.title = element_text(hjust = 0.5),
        axis.text=element_text(size=10, face=&quot;bold&quot;)) +
coord_cartesian(xlim = c(0.5, 6.5))
## Warning: attributes are not identical across measure variables;
## they will be dropped

bctInt &lt;- df %&gt;% dplyr::select(id,
  intervention,
  group,
  school,
  girl,
&#39;Reminded self of positive consequences&#39; = PA_frqbct_01_T1,
&#39;Has logged PA on paper&#39; = PA_frqbct_02_T1,
&#39;Has monitored PA on smartphone&#39; = PA_frqbct_03_T1,
&#39;Uses mnemonic cues&#39; = PA_frqbct_04_T1,
&#39;Has compared actual with goal&#39; = PA_frqbct_05_T1,
&#39;Has thought of relevance of PA&#39; = PA_frqbct_06_T1,
&#39;Has made changes at home&#39; = PA_frqbct_07_T1,
&#39;Has sought social support&#39; = PA_frqbct_08_T1,
&#39;Has evaluated why goal not reached&#39; = PA_frqbct_09_T1) %&gt;%
 tidyr::gather(key = Variable, value = Value, 6:ncol(.)) %&gt;%
  filter(intervention == &quot;1&quot;) %&gt;% 
 ggplot(aes(x = Value, y = Variable, group = Variable)) +
  ggridges::geom_density_ridges2(aes(fill = Variable), stat = &quot;binline&quot;, binwidth = 1, scale = 0.95) +
  scale_x_continuous(breaks = c(1:6), expand = c(0, 0),
                     name = &quot;&quot;) +
  scale_y_discrete(expand = c(0.01, 0), name = &quot;&quot;) +
  ggridges::scale_fill_cyclical(values = c(&quot;deepskyblue&quot;, &quot;deepskyblue4&quot;)) +
  labs(title = &quot;Intervention&quot;) +
  guides(y = &quot;none&quot;) +
  ggridges::theme_ridges(grid = FALSE) +
  theme(axis.title.x = element_text(hjust = 0.5),
        axis.title.y = element_text(hjust = 0.5),
        axis.text=element_text(size=10, face=&quot;bold&quot;)) +
coord_cartesian(xlim = c(0.5, 6.5))
## Warning: attributes are not identical across measure variables;
## they will be dropped

bctCont &lt;- df %&gt;% dplyr::select(id,
  intervention,
  group,
  school,
  girl,
&#39;Reminded self of positive consequences&#39; = PA_frqbct_01_T1,
&#39;Has logged PA on paper&#39; = PA_frqbct_02_T1,
&#39;Has monitored PA on smartphone&#39; = PA_frqbct_03_T1,
&#39;Uses mnemonic cues&#39; = PA_frqbct_04_T1,
&#39;Has compared actual with goal&#39; = PA_frqbct_05_T1,
&#39;Has thought of relevance of PA&#39; = PA_frqbct_06_T1,
&#39;Has made changes at home&#39; = PA_frqbct_07_T1,
&#39;Has sought social support&#39; = PA_frqbct_08_T1,
&#39;Has evaluated why goal not reached&#39; = PA_frqbct_09_T1) %&gt;%
 tidyr::gather(key = Variable, value = Value, 6:ncol(.)) %&gt;%
  filter(intervention == &quot;0&quot;) %&gt;% 
 ggplot(aes(x = Value, y = Variable, group = Variable)) +
  ggridges::geom_density_ridges2(aes(fill = Variable), stat = &quot;binline&quot;, binwidth = 1, scale = 0.95) +
  scale_x_continuous(breaks = c(1:6), expand = c(0, 0),
                     name = &quot;&quot;) +
  scale_y_discrete(expand = c(0.01, 0), name = &quot;&quot;, labels = NULL) +
  ggridges::scale_fill_cyclical(values = c(&quot;deepskyblue&quot;, &quot;deepskyblue4&quot;)) +
  labs(title = &quot;Control&quot;) +
  guides(y = &quot;none&quot;) +
  ggridges::theme_ridges(grid = FALSE) +
  theme(axis.title.x = element_text(hjust = 0.5),
        axis.title.y = element_text(hjust = 0.5),
        axis.text=element_text(size=10, face=&quot;bold&quot;)) +
coord_cartesian(xlim = c(0.5, 6.5))
## Warning: attributes are not identical across measure variables;
## they will be dropped

#grid.arrange(bctInt, bctGirls, bctCont, bctBoys, ncol = 2)

# (&quot;Seldom or never&quot;, &quot;About once a month&quot;, &quot;About once a week&quot;, &quot;Almost daily&quot;)

# This draws all histograms next to each other:
grid::grid.newpage()
grid::grid.draw(cbind(ggplotGrob(bctInt), ggplotGrob(bctCont), ggplotGrob(bctGirls), ggplotGrob(bctBoys), size = &quot;last&quot;))
## Warning: Removed 54 rows containing non-finite values (stat_binline).
## Warning: Removed 72 rows containing non-finite values (stat_binline).
## Warning: Removed 54 rows containing non-finite values (stat_binline).
## Warning: Removed 72 rows containing non-finite values (stat_binline).</code></pre>
<p><img src="baseline-supplement_files/figure-html/unnamed-chunk-17-1.png" width="2100" /></p>
<pre class="r"><code>
# This draws 2 histograms per row:
# grid.newpage()
# grid.draw(rbind(cbind(ggplotGrob(bctInt), ggplotGrob(bctCont), size = &quot;last&quot;), cbind(ggplotGrob(bctGirls), ggplotGrob(bctBoys), size = &quot;last&quot;)))</code></pre>
</div>
<div id="agreement-measured-bcts-1" class="section level4">
<h4>Agreement-measured BCTs</h4>
<p>These questions were asked with the lead “Have you done the following during the last three weeks?”.</p>
<p>The answer scale was as follows:</p>
<p>0 = not at all true 1 … 4 [unlabeled] 5 = completely true</p>
<p>Items are as follows:</p>
<ol style="list-style-type: decimal">
<li>I have set PA goals for myself.</li>
<li>I have personally made a specific plan (“what, where, how”) to implement my PA.</li>
<li>I have a PA plan, which has been made by someone else, e.g. my sports club (e.g. a workout schedule).</li>
<li>I have a way by which I remind myself of my PA plan, e.g. I write it down in the calendar.</li>
<li>I have cut larger PA goals to smaller subgoals.</li>
<li>I have tried out new ways for me to be physically active.</li>
<li>I have pondered, what kind of difficult situations or barriers prevent me from implementing my PA plan.</li>
<li>I have planned for ways to overcome barriers to doing PA.</li>
<li>I have thought about how PA fits my identity (self concept).</li>
<li>I have attempted to find ways to exercise so, that it won’t obstruct but instead helps actualise my other life values.</li>
</ol>
<pre class="r"><code>
bctGirls &lt;- df %&gt;% dplyr::select(id,
  intervention,
  group,
  school,
  girl,
  &#39;Has set goals&#39; = PA_agrbct_01_T1,
  &#39;Has made plan&#39; = PA_agrbct_02_T1,
  &#39;Plan made by other&#39; = PA_agrbct_03_T1,
  &#39;Has reminder of plan&#39; = PA_agrbct_04_T1,
  &#39;Has cut goals to subgoals&#39; = PA_agrbct_05_T1,
  &#39;Has tried new PA options&#39; = PA_agrbct_06_T1,
  &#39;Has thought of barriers&#39; = PA_agrbct_07_T1,
  &#39;Has planned for barriers&#39; = PA_agrbct_08_T1,
  &#39;Has thought of PA identity&#39; = PA_agrbct_09_T1,
  &#39;Has fitted PA to life values&#39; = PA_agrbct_10_T1) %&gt;%
 tidyr::gather(key = Variable, value = Value, 6:ncol(.)) %&gt;%
  filter(girl == &quot;1&quot;) %&gt;% 
 ggplot(aes(x = Value, y = Variable, group = Variable)) +
  ggridges::geom_density_ridges2(aes(fill = Variable), stat = &quot;binline&quot;, binwidth = 1, scale = 0.95) +
  scale_x_continuous(breaks = c(1:6), expand = c(0, 0),
                     name = &quot;&quot;) +
  scale_y_discrete(expand = c(0.01, 0), name = &quot;&quot;, labels = NULL) +
  ggridges::scale_fill_cyclical(values = c(&quot;darkolivegreen2&quot;, &quot;darkolivegreen4&quot;)) +
  labs(title = &quot;Girls&quot;) +
  guides(y = &quot;none&quot;) +
  ggridges::theme_ridges(grid = FALSE) +
  theme(axis.title.x = element_text(hjust = 0.5),
        axis.title.y = element_text(hjust = 0.5),
        plot.title = element_text(hjust = 0.5),
        axis.text=element_text(size=10, face=&quot;bold&quot;)) +
coord_cartesian(xlim = c(0.5, 6.5))
## Warning: attributes are not identical across measure variables;
## they will be dropped

bctBoys &lt;- df %&gt;% dplyr::select(id,
  intervention,
  group,
  school,
  girl,
  &#39;Has set goals&#39; = PA_agrbct_01_T1,
  &#39;Has made plan&#39; = PA_agrbct_02_T1,
  &#39;Plan made by other&#39; = PA_agrbct_03_T1,
  &#39;Has reminder of plan&#39; = PA_agrbct_04_T1,
  &#39;Has cut goals to subgoals&#39; = PA_agrbct_05_T1,
  &#39;Has tried new PA options&#39; = PA_agrbct_06_T1,
  &#39;Has thought of barriers&#39; = PA_agrbct_07_T1,
  &#39;Has planned for barriers&#39; = PA_agrbct_08_T1,
  &#39;Has thought of PA identity&#39; = PA_agrbct_09_T1,
  &#39;Has fitted PA to life values&#39; = PA_agrbct_10_T1) %&gt;%
  tidyr::gather(key = Variable, value = Value, 6:ncol(.)) %&gt;%
  filter(girl == &quot;0&quot;) %&gt;% 
 ggplot(aes(x = Value, y = Variable, group = Variable)) +
  ggridges::geom_density_ridges2(aes(fill = Variable), stat = &quot;binline&quot;, binwidth = 1, scale = 0.95) +
  scale_x_continuous(breaks = c(1:6), expand = c(0, 0),
                     name = &quot;&quot;) +
  scale_y_discrete(expand = c(0.01, 0), name = &quot;&quot;, labels = NULL) +
  ggridges::scale_fill_cyclical(values = c(&quot;darkolivegreen2&quot;, &quot;darkolivegreen4&quot;)) +
  labs(title = &quot;Boys&quot;) +
  guides(y = &quot;none&quot;) +
  ggridges::theme_ridges(grid = FALSE) +
  theme(axis.title.x = element_text(hjust = 0.5),
        axis.title.y = element_text(hjust = 0.5),
        plot.title = element_text(hjust = 0.5),
        axis.text=element_text(size=10, face=&quot;bold&quot;)) +
coord_cartesian(xlim = c(0.5, 6.5))
## Warning: attributes are not identical across measure variables;
## they will be dropped

bctInt &lt;- df %&gt;% dplyr::select(id,
  intervention,
  group,
  school,
  girl,
  &#39;Has set goals&#39; = PA_agrbct_01_T1,
  &#39;Has made plan&#39; = PA_agrbct_02_T1,
  &#39;Plan made by other&#39; = PA_agrbct_03_T1,
  &#39;Has reminder of plan&#39; = PA_agrbct_04_T1,
  &#39;Has cut goals to subgoals&#39; = PA_agrbct_05_T1,
  &#39;Has tried new PA options&#39; = PA_agrbct_06_T1,
  &#39;Has thought of barriers&#39; = PA_agrbct_07_T1,
  &#39;Has planned for barriers&#39; = PA_agrbct_08_T1,
  &#39;Has thought of PA identity&#39; = PA_agrbct_09_T1,
  &#39;Has fitted PA to life values&#39; = PA_agrbct_10_T1) %&gt;%
 tidyr::gather(key = Variable, value = Value, 6:ncol(.)) %&gt;%
  filter(intervention == &quot;1&quot;) %&gt;% 
 ggplot(aes(x = Value, y = Variable, group = Variable)) +
  ggridges::geom_density_ridges2(aes(fill = Variable), stat = &quot;binline&quot;, binwidth = 1, scale = 0.95) +
  scale_x_continuous(breaks = c(1:6), expand = c(0, 0),
                     name = &quot;&quot;) +
  scale_y_discrete(expand = c(0.01, 0), name = &quot;&quot;) +
  ggridges::scale_fill_cyclical(values = c(&quot;deepskyblue&quot;, &quot;deepskyblue4&quot;)) +
  labs(title = &quot;Intervention&quot;) +
  guides(y = &quot;none&quot;) +
  ggridges::theme_ridges(grid = FALSE) +
  theme(axis.title.x = element_text(hjust = 0.5),
        axis.title.y = element_text(hjust = 0.5),
        axis.text=element_text(size=10, face=&quot;bold&quot;)) +
coord_cartesian(xlim = c(0.5, 6.5))
## Warning: attributes are not identical across measure variables;
## they will be dropped

bctCont &lt;- df %&gt;% dplyr::select(id,
  intervention,
  group,
  school,
  girl,
  &#39;Has set goals&#39; = PA_agrbct_01_T1,
  &#39;Has made plan&#39; = PA_agrbct_02_T1,
  &#39;Plan made by other&#39; = PA_agrbct_03_T1,
  &#39;Has reminder of plan&#39; = PA_agrbct_04_T1,
  &#39;Has cut goals to subgoals&#39; = PA_agrbct_05_T1,
  &#39;Has tried new PA options&#39; = PA_agrbct_06_T1,
  &#39;Has thought of barriers&#39; = PA_agrbct_07_T1,
  &#39;Has planned for barriers&#39; = PA_agrbct_08_T1,
  &#39;Has thought of PA identity&#39; = PA_agrbct_09_T1,
  &#39;Has fitted PA to life values&#39; = PA_agrbct_10_T1) %&gt;%
 tidyr::gather(key = Variable, value = Value, 6:ncol(.)) %&gt;%
  filter(intervention == &quot;0&quot;) %&gt;% 
 ggplot(aes(x = Value, y = Variable, group = Variable)) +
  ggridges::geom_density_ridges2(aes(fill = Variable), stat = &quot;binline&quot;, binwidth = 1, scale = 0.95) +
  scale_x_continuous(breaks = c(1:6), expand = c(0, 0),
                     name = &quot;&quot;) +
  scale_y_discrete(expand = c(0.01, 0), name = &quot;&quot;, labels = NULL) +
  ggridges::scale_fill_cyclical(values = c(&quot;deepskyblue&quot;, &quot;deepskyblue4&quot;)) +
  labs(title = &quot;Control&quot;) +
  guides(y = &quot;none&quot;) +
  ggridges::theme_ridges(grid = FALSE) +
  theme(axis.title.x = element_text(hjust = 0.5),
        axis.title.y = element_text(hjust = 0.5),
        axis.text=element_text(size=10, face=&quot;bold&quot;)) +
coord_cartesian(xlim = c(0.5, 6.5))
## Warning: attributes are not identical across measure variables;
## they will be dropped

#grid.arrange(bctInt, bctGirls, bctCont, bctBoys, ncol = 2)

# (&quot;Seldom or never&quot;, &quot;About once a month&quot;, &quot;About once a week&quot;, &quot;Almost daily&quot;)

# This draws all histograms next to each other:
grid::grid.newpage()
grid::grid.draw(cbind(ggplotGrob(bctInt), ggplotGrob(bctCont), ggplotGrob(bctGirls), ggplotGrob(bctBoys), size = &quot;last&quot;))
## Warning: Removed 60 rows containing non-finite values (stat_binline).
## Warning: Removed 70 rows containing non-finite values (stat_binline).</code></pre>
<p><img src="baseline-supplement_files/figure-html/unnamed-chunk-18-1.png" width="2100" /></p>
<pre class="r"><code>
# This draws 2 histograms per row:
# grid.newpage()
# grid.draw(rbind(cbind(ggplotGrob(bctInt), ggplotGrob(bctCont), size = &quot;last&quot;), cbind(ggplotGrob(bctGirls), ggplotGrob(bctBoys), size = &quot;last&quot;)))

# bctBoys &lt;- df %&gt;% dplyr::select(id,
#   intervention,
#   group,
#   school,
#   girl,
#   &#39;Has set goals&#39; = PA_agrbct_01_T1,
#   &#39;Has made plan&#39; = PA_agrbct_02_T1,
#   &#39;Plan made by other&#39; = PA_agrbct_03_T1,
#   &#39;Has reminder of plan&#39; = PA_agrbct_04_T1,
#   &#39;Has cut goals to subgoals&#39; = PA_agrbct_05_T1,
#   &#39;Has tried new PA options&#39; = PA_agrbct_06_T1,
#   &#39;Has thought of barriers&#39; = PA_agrbct_07_T1,
#   &#39;Has planned for barriers&#39; = PA_agrbct_08_T1,
#   &#39;Has thought of PA identity&#39; = PA_agrbct_09_T1,
#   &#39;Has fitted PA to life values&#39; = PA_agrbct_10_T1)
# 
# mean(bctBoys$`Has set goals`, na.rm = T)
# mean(bctBoys$`Has made plan`, na.rm = T)
# mean(bctBoys$`Plan made by other`, na.rm = T)
# mean(bctBoys$`Has reminder of plan`, na.rm = T)
# mean(bctBoys$`Has cut goals to subgoals`, na.rm = T)
# mean(bctBoys$`Has tried new PA options`, na.rm = T)
# mean(bctBoys$`Has thought of barriers`, na.rm = T)
# mean(bctBoys$`Has planned for barriers`, na.rm = T)
# mean(bctBoys$`Has thought of PA identity`, na.rm = T)
# mean(bctBoys$`Has fitted PA to life values`, na.rm = T)</code></pre>
</div>
</div>
</div>
<div id="pa-determinants" class="section level2">
<h2>PA determinants</h2>
<div id="plot-without-fill" class="section level3">
<h3>Plot without fill</h3>
</div>
</div>
</div>
<div id="taalla-lukee-muuttaako-mitaan" class="section level1">
<h1>TÄÄLLÄ LUKEE “MUUTTAAKO MITÄÄN?”</h1>
<pre class="r"><code>plot1 &lt;- df %&gt;% dplyr::select(id,
                              intervention,
                              group,
                              school,
                              girl,
                              &#39;PA intention&#39; = PA_intention_T1,
                              &#39;PA outcome\nexpectations&#39; = PA_outcomeExpectations_T1,
                              &#39;PA perceived\nbehavioural control&#39; = PA_pbc_T1,
                              &#39;PA self efficacy&#39; = PA_selfefficacy_T1,
                              &#39;PA perceived\nopportunities&#39; = PA_opportunities_T1,
                              &#39;PA descriptive\nnorm&#39; = PA_dnorm_T1,
                              &#39;PA injunctive\nnorm&#39; = PA_inorm_T1)  %&gt;%
  # select(noquote(order(colnames(.)))) %&gt;% # Orders columns alphabetically
  tidyr::gather(key = Variable, value = Value, 6:ncol(.), factor_key = TRUE) %&gt;%
  ggplot(aes(y = Variable)) +
  ggridges::geom_density_ridges(aes(x = Value, colour = paste(Variable, girl), 
                                    fill = paste(Variable, girl)), 
                                    alpha = 0, size = 0.75, from = 1, to = 7) +
  labs(x = &quot;&quot;,
       y = &quot;&quot;) +
  scale_y_discrete(expand = c(0.01, 0)) +
  scale_x_continuous(expand = c(0.01, 0)) +
  ggridges::scale_fill_cyclical(breaks = c(&quot;PA injunctive\nnorm 0&quot;, &quot;PA injunctive\nnorm 1&quot;),
                                labels = c( &#39;PA injunctive\nnorm 0&#39; = &quot;Boy&quot;, &#39;PA injunctive\nnorm 1&#39; = &quot;Girl&quot;),
                                values = viridis::viridis(4, end = 0.8)[c(1, 3)], #c(&quot;#3bc600&quot;, &quot;#0000ff&quot;, &quot;#9cc68b&quot;, &quot;#8080ff&quot;),
                                name = &quot;&quot;, guide = guide_legend(override.aes = list(alpha = 1))) +
  ggridges::scale_colour_cyclical(values = viridis::viridis(4, end = 0.8, alpha = 0.9)[c(1, 3)]) +
  ggridges::theme_ridges(grid = FALSE) +
  theme(legend.position=&quot;bottom&quot;, axis.text=element_text(size=10)) +
  geom_hline(yintercept = 1:7)
## Warning: attributes are not identical across measure variables;
## they will be dropped

target = c(
&quot;PA_intention_T1&quot;,
&quot;PA_outcomeExpectations_T1&quot;,
&quot;PA_pbc_T1&quot;,
&quot;PA_selfefficacy_T1&quot;,
&quot;PA_opportunities_T1&quot;,
&quot;PA_dnorm_T1&quot;,
&quot;PA_inorm_T1&quot;)

PA_ci_girls &lt;- ci_girls %&gt;% filter(diamondlabels %in% names(scales_T1) &amp; 
                                     grepl(&quot;PA_intention_T1&quot;, diamondlabels) | 
                                     grepl(&quot;PA_outcomeExpectations_T1&quot;, diamondlabels) | 
                                     grepl(&quot;PA_pbc_T1&quot;, diamondlabels) | 
                                     grepl(&quot;PA_selfefficacy_T1&quot;, diamondlabels) | 
                                     grepl(&quot;PA_opportunities_T1&quot;, diamondlabels) | 
                                     grepl(&quot;PA_dnorm_T1&quot;, diamondlabels) | 
                                     grepl(&quot;PA_inorm_T1&quot;, diamondlabels))

PA_ci_girls &lt;- PA_ci_girls[match(target, PA_ci_girls$diamondlabels), ]

PA_ci_boys &lt;- ci_boys %&gt;% filter(diamondlabels %in% names(scales_T1) &amp; 
                                     grepl(&quot;PA_intention_T1&quot;, diamondlabels) | 
                                     grepl(&quot;PA_outcomeExpectations_T1&quot;, diamondlabels) | 
                                     grepl(&quot;PA_pbc_T1&quot;, diamondlabels) | 
                                     grepl(&quot;PA_selfefficacy_T1&quot;, diamondlabels) | 
                                     grepl(&quot;PA_opportunities_T1&quot;, diamondlabels) | 
                                     grepl(&quot;PA_dnorm_T1&quot;, diamondlabels) | 
                                     grepl(&quot;PA_inorm_T1&quot;, diamondlabels))

PA_ci_boys &lt;- PA_ci_boys[match(target, PA_ci_boys$diamondlabels), ]

plot1 &lt;- plot1 + userfriendlyscience::diamondPlot(PA_ci_girls, returnLayerOnly = TRUE, color=viridis::viridis(4, end = 0.8)[c(3)], 
                alpha=.6, fixedSize = 0.15, otherAxisCol = (1:length(target) + .2)) +
  userfriendlyscience::diamondPlot(PA_ci_boys, returnLayerOnly = TRUE, color=viridis::viridis(4, end = 0.8)[c(1)],  
                alpha=.6, fixedSize = 0.15, otherAxisCol = (1:length(target) + .2))

plot2 &lt;- df %&gt;% dplyr::select(id,
                              intervention,
                              group,
                              school,
                              girl,
                              &#39;PA intention&#39; = PA_intention_T1,
                              &#39;PA outcome\nexpectations&#39; = PA_outcomeExpectations_T1,
                              &#39;PA perceived\nbehavioural control&#39; = PA_pbc_T1,
                              &#39;PA self efficacy&#39; = PA_selfefficacy_T1,
                              &#39;PA perceived\nopportunities&#39; = PA_opportunities_T1,
                              &#39;PA descriptive\nnorm&#39; = PA_dnorm_T1,
                              &#39;PA injunctive\nnorm&#39; = PA_inorm_T1)  %&gt;%
  # select(noquote(order(colnames(.)))) %&gt;% # Orders columns alphabetically
  tidyr::gather(key = Variable, value = Value, 6:ncol(.), factor_key = TRUE) %&gt;%
  ggplot(aes(y = Variable)) +
  ggridges::geom_density_ridges(aes(x = Value, colour = paste(Variable, intervention), 
                                    fill = paste(Variable, intervention)), 
                                    alpha = 0, size = 0.75, from = 1, to = 7) +
  labs(x = &quot;&quot;,
       y = &quot;&quot;) +
  scale_y_discrete(expand = c(0.01, 0), labels = NULL) +
  scale_x_continuous(expand = c(0.01, 0)) +
  ggridges::scale_fill_cyclical(breaks = c(&quot;PA injunctive\nnorm 0&quot;, &quot;PA injunctive\nnorm 1&quot;),
                                labels = c( &#39;PA injunctive\nnorm 0&#39; = &quot;Control&quot;, &#39;PA injunctive\nnorm 1&#39; = &quot;Intervention&quot;),
                                values = c(viridis::viridis(4, end = 0.8)[c(2, 4)], viridis::viridis(8, end = 0.8)[c(4, 8)]), # get 2 x 2 colors, close to each other MUUTTAAKO MITÄÄN?
                                name = &quot;&quot;, guide = guide_legend(override.aes = list(alpha = 1))) +
  ggridges::scale_colour_cyclical(values = viridis::viridis(4, end = 0.8, alpha = 0.9)[c(2, 4)]) +
  ggridges::theme_ridges(grid = FALSE) +
  theme(legend.position=&quot;bottom&quot;, axis.text=element_text(size=10)) +
  geom_hline(yintercept = 1:7)
## Warning: attributes are not identical across measure variables;
## they will be dropped

PA_ci_intervention &lt;- ci_intervention %&gt;% filter(diamondlabels %in% names(scales_T1) &amp; 
                                     grepl(&quot;PA_intention_T1&quot;, diamondlabels) | 
                                     grepl(&quot;PA_outcomeExpectations_T1&quot;, diamondlabels) | 
                                     grepl(&quot;PA_pbc_T1&quot;, diamondlabels) | 
                                     grepl(&quot;PA_selfefficacy_T1&quot;, diamondlabels) | 
                                     grepl(&quot;PA_opportunities_T1&quot;, diamondlabels) | 
                                     grepl(&quot;PA_dnorm_T1&quot;, diamondlabels) | 
                                     grepl(&quot;PA_inorm_T1&quot;, diamondlabels))

PA_ci_intervention &lt;- PA_ci_intervention[match(target, PA_ci_intervention$diamondlabels), ]

PA_ci_control &lt;- ci_control %&gt;% filter(diamondlabels %in% names(scales_T1) &amp; 
                                     grepl(&quot;PA_intention_T1&quot;, diamondlabels) | 
                                     grepl(&quot;PA_outcomeExpectations_T1&quot;, diamondlabels) | 
                                     grepl(&quot;PA_pbc_T1&quot;, diamondlabels) | 
                                     grepl(&quot;PA_selfefficacy_T1&quot;, diamondlabels) | 
                                     grepl(&quot;PA_opportunities_T1&quot;, diamondlabels) | 
                                     grepl(&quot;PA_dnorm_T1&quot;, diamondlabels) | 
                                     grepl(&quot;PA_inorm_T1&quot;, diamondlabels))

PA_ci_control &lt;- PA_ci_control[match(target, PA_ci_control$diamondlabels), ]

plot2 &lt;- plot2 + 
  userfriendlyscience::diamondPlot(PA_ci_intervention, returnLayerOnly = TRUE, color=viridis::viridis(4, end = 0.8)[c(4)],
              alpha=.6, fixedSize = 0.15, otherAxisCol = (1:length(target) + .2)) +
  userfriendlyscience::diamondPlot(PA_ci_control, returnLayerOnly = TRUE, color=viridis::viridis(4, end = 0.8)[c(2)], 
              alpha=.6, fixedSize = 0.15, otherAxisCol = (1:length(target) + .2))

# grid.arrange(plot1, plot2, ncol = 2)
grid::grid.newpage()
grid::grid.draw(cbind(ggplotGrob(plot1), ggplotGrob(plot2), size = &quot;first&quot;))
## Picking joint bandwidth of 0.355
## Warning: Removed 641 rows containing non-finite values
## (stat_density_ridges).
## Picking joint bandwidth of 0.359
## Warning: Removed 641 rows containing non-finite values
## (stat_density_ridges).
## Error: nrow(x) == nrow(y) is not TRUE</code></pre>
<div id="pretty-plot-with-fill" class="section level3">
<h3>Pretty plot with fill</h3>
</div>
</div>
<div id="kesken" class="section level1">
<h1>!!! KESKEN</h1>
<pre class="r"><code>
plot1 &lt;- df %&gt;% dplyr::select(id,
                              intervention,
                              group,
                              school,
                              girl,
                              &#39;PA intention&#39; = PA_intention_T1,
                              &#39;PA outcome\nexpectations&#39; = PA_outcomeExpectations_T1,
                              &#39;PA perceived\nbehavioural control&#39; = PA_pbc_T1,
                              &#39;PA self efficacy&#39; = PA_selfefficacy_T1,
                              &#39;PA perceived\nopportunities&#39; = PA_opportunities_T1,
                              &#39;PA descriptive\nnorm&#39; = PA_dnorm_T1)  %&gt;%
  # select(noquote(order(colnames(.)))) %&gt;% # Orders columns alphabetically
  tidyr::gather(key = Variable, value = Value, 6:ncol(.), factor_key = TRUE) %&gt;%
  ggplot(aes(y = Variable)) +
  ggridges::geom_density_ridges(aes(x = Value, colour = &quot;black&quot;, 
                                    fill = paste(Variable, girl)), 
                                    alpha = 0.6, size = 0.25, 
                                    from = 1, to = 7) +
  labs(x = &quot;&quot;,
       y = &quot;&quot;) +
  scale_y_discrete(expand = c(0.01, 0)) +
  scale_x_continuous(expand = c(0.01, 0)) +
  ggridges::scale_fill_cyclical(breaks = c(&quot;PA descriptive\nnorm 0&quot;, &quot;PA descriptive\nnorm 1&quot;),
                                labels = c( &#39;PA descriptive\nnorm 0&#39; = &quot;Boy&quot;, &#39;PA descriptive\nnorm 1&#39; = &quot;Girl&quot;),
                                values = viridis::viridis(4, end = 0.8)[c(1, 3)],
                                name = &quot;&quot;, guide = guide_legend(override.aes = list(alpha = 1))) +
  ggridges::scale_colour_cyclical(values = &quot;black&quot;) +
  ggridges::theme_ridges(grid = FALSE) +
  theme(legend.position=&quot;bottom&quot;, axis.text=element_text(size=10))

target = c(
&quot;PA_intention_T1&quot;,
&quot;PA_outcomeExpectations_T1&quot;,
&quot;PA_pbc_T1&quot;,
&quot;PA_selfefficacy_T1&quot;,
&quot;PA_opportunities_T1&quot;,
&quot;PA_dnorm_T1&quot;)

PA_ci_girls &lt;- ci_girls %&gt;% filter(diamondlabels %in% names(scales_T1) &amp; 
                                     grepl(&quot;PA_intention_T1&quot;, diamondlabels) | 
                                     grepl(&quot;PA_outcomeExpectations_T1&quot;, diamondlabels) | 
                                     grepl(&quot;PA_pbc_T1&quot;, diamondlabels) | 
                                     grepl(&quot;PA_selfefficacy_T1&quot;, diamondlabels) | 
                                     grepl(&quot;PA_opportunities_T1&quot;, diamondlabels) | 
                                     grepl(&quot;PA_dnorm_T1&quot;, diamondlabels))

PA_ci_girls &lt;- PA_ci_girls[match(target, PA_ci_girls$diamondlabels), ]

PA_ci_boys &lt;- ci_boys %&gt;% filter(diamondlabels %in% names(scales_T1) &amp; 
                                     grepl(&quot;PA_intention_T1&quot;, diamondlabels) | 
                                     grepl(&quot;PA_outcomeExpectations_T1&quot;, diamondlabels) | 
                                     grepl(&quot;PA_pbc_T1&quot;, diamondlabels) | 
                                     grepl(&quot;PA_selfefficacy_T1&quot;, diamondlabels) | 
                                     grepl(&quot;PA_opportunities_T1&quot;, diamondlabels) | 
                                     grepl(&quot;PA_dnorm_T1&quot;, diamondlabels))

PA_ci_boys &lt;- PA_ci_boys[match(target, PA_ci_boys$diamondlabels), ]

plot1 &lt;- plot1 + userfriendlyscience::diamondPlot(PA_ci_girls, returnLayerOnly = TRUE, lineColor = &quot;black&quot;, color=viridis::viridis(4, end = 0.8)[3], 
                alpha=.6, fixedSize = 0.15, otherAxisCol = (1:length(target) + .2)) +
  userfriendlyscience::diamondPlot(PA_ci_boys, returnLayerOnly = TRUE, lineColor = &quot;black&quot;, linetype = &quot;solid&quot;, color=viridis::viridis(4, end = 0.8)[1],  
                alpha=.6, fixedSize = 0.15, otherAxisCol = (1:length(target) + .2))

plot2 &lt;- df %&gt;% dplyr::select(id,
                              intervention,
                              group,
                              school,
                              girl,
                              &#39;PA intention&#39; = PA_intention_T1,
                              &#39;PA outcome\nexpectations&#39; = PA_outcomeExpectations_T1,
                              &#39;PA perceived\nbehavioural control&#39; = PA_pbc_T1,
                              &#39;PA self efficacy&#39; = PA_selfefficacy_T1,
                              &#39;PA perceived\nopportunities&#39; = PA_opportunities_T1,
                              &#39;PA descriptive\nnorm&#39; = PA_dnorm_T1)  %&gt;%
  # select(noquote(order(colnames(.)))) %&gt;% # Orders columns alphabetically
  tidyr::gather(key = Variable, value = Value, 6:ncol(.), factor_key = TRUE) %&gt;%
  ggplot(aes(y = Variable)) +
  ggridges::geom_density_ridges(aes(x = Value, colour = &quot;black&quot;, 
                                    fill = paste(Variable, intervention)), 
                                    alpha = 0.75, size = 0.25, from = 1, to = 7) +
  labs(x = &quot;&quot;,
       y = &quot;&quot;) +
  scale_y_discrete(expand = c(0.01, 0), labels = NULL) +
  scale_x_continuous(expand = c(0.01, 0)) +
  ggridges::scale_fill_cyclical(breaks = c(&quot;PA descriptive\nnorm 0&quot;, &quot;PA descriptive\nnorm 1&quot;),
                                labels = c( &#39;PA descriptive\nnorm 0&#39; = &quot;Control&quot;, &#39;PA descriptive\nnorm 1&#39; = &quot;Intervention&quot;),
                                values = viridis::viridis(4, end = 0.8)[c(2, 4)],
                                name = &quot;&quot;, guide = guide_legend(override.aes = list(alpha = 1))) +
  ggridges::scale_colour_cyclical(values = &quot;black&quot;) +
  ggridges::theme_ridges(grid = FALSE) +
  theme(legend.position=&quot;bottom&quot;, axis.text=element_text(size=10))

PA_ci_intervention &lt;- ci_intervention %&gt;% filter(diamondlabels %in% names(scales_T1) &amp; 
                                     grepl(&quot;PA_intention_T1&quot;, diamondlabels) | 
                                     grepl(&quot;PA_outcomeExpectations_T1&quot;, diamondlabels) | 
                                     grepl(&quot;PA_pbc_T1&quot;, diamondlabels) | 
                                     grepl(&quot;PA_selfefficacy_T1&quot;, diamondlabels) | 
                                     grepl(&quot;PA_opportunities_T1&quot;, diamondlabels) | 
                                     grepl(&quot;PA_dnorm_T1&quot;, diamondlabels))

PA_ci_intervention &lt;- PA_ci_intervention[match(target, PA_ci_intervention$diamondlabels), ]

PA_ci_control &lt;- ci_control %&gt;% filter(diamondlabels %in% names(scales_T1) &amp; 
                                     grepl(&quot;PA_intention_T1&quot;, diamondlabels) | 
                                     grepl(&quot;PA_outcomeExpectations_T1&quot;, diamondlabels) | 
                                     grepl(&quot;PA_pbc_T1&quot;, diamondlabels) | 
                                     grepl(&quot;PA_selfefficacy_T1&quot;, diamondlabels) | 
                                     grepl(&quot;PA_opportunities_T1&quot;, diamondlabels) | 
                                     grepl(&quot;PA_dnorm_T1&quot;, diamondlabels))

PA_ci_control &lt;- PA_ci_control[match(target, PA_ci_control$diamondlabels), ]

plot2 &lt;- plot2 + 
  userfriendlyscience::diamondPlot(PA_ci_intervention, returnLayerOnly = TRUE, lineColor = &quot;black&quot;, color=viridis::viridis(4, end = 0.8)[4],
              alpha=.6, fixedSize = 0.15, otherAxisCol = (1:length(target) + .2)) +
  userfriendlyscience::diamondPlot(PA_ci_control, returnLayerOnly = TRUE, lineColor = &quot;black&quot;, color=viridis::viridis(4, end = 0.8)[2], 
              alpha=.6, fixedSize = 0.15, otherAxisCol = (1:length(target) + .2))

# grid.arrange(plot1, plot2, ncol = 2)
grid::grid.newpage()
grid::grid.draw(cbind(ggplotGrob(plot1), ggplotGrob(plot2), size = &quot;first&quot;))
## Picking joint bandwidth of 0.327
## Warning: Removed 549 rows containing non-finite values
## (stat_density_ridges).
## Picking joint bandwidth of 0.332
## Warning: Removed 549 rows containing non-finite values
## (stat_density_ridges).
## Error: nrow(x) == nrow(y) is not TRUE
plot1
## Picking joint bandwidth of 0.327
## Warning: Removed 549 rows containing non-finite values
## (stat_density_ridges).</code></pre>
<p><img src="baseline-supplement_files/figure-html/unnamed-chunk-20-1.png" width="2100" /></p>
<pre class="r"><code>plot2
## Picking joint bandwidth of 0.332
## Warning: Removed 549 rows containing non-finite values
## (stat_density_ridges).</code></pre>
<p><img src="baseline-supplement_files/figure-html/unnamed-chunk-20-2.png" width="2100" /></p>
<pre class="r"><code># Test that the legend is right; descriptive norms are smaller for girls
df %&gt;% group_by(girl) %&gt;% summarise(mean = mean(PA_dnorm_T1, na.rm = T)) %&gt;% filter(girl == &quot;1&quot;) %&gt;% select(mean) &lt; df %&gt;% group_by(girl) %&gt;% summarise(mean = mean(PA_dnorm_T1, na.rm = T)) %&gt;% filter(girl == &quot;0&quot;) %&gt;% select(mean)
## Error in matrix(unlist(value, recursive = FALSE, use.names = FALSE), nrow = nr, : length of &#39;dimnames&#39; [2] not equal to array extent

# KESKEN: iv/ctrl-legend
df %&gt;% group_by(intervention) %&gt;% summarise(mean = mean(PA_dnorm_T1, na.rm = TRUE)) %&gt;% filter(intervention == &quot;1&quot;) %&gt;% select(mean) &lt; df %&gt;% group_by(intervention) %&gt;% summarise(mean = mean(PA_dnorm_T1, na.rm = T)) %&gt;% filter(intervention == &quot;0&quot;) %&gt;% select(mean)
##      mean
## [1,] TRUE</code></pre>
<div id="mvpa-girls-and-boys-in-different-educational-tracks" class="section level3">
<h3>MVPA, girls and boys in different educational tracks</h3>
<p>Accelerometer-measured PA:</p>
<p>Get credibility intervals track:school</p>
</div>
</div>
<div id="kesken-timantit-plottiin" class="section level1">
<h1>KESKEN!!!!! Timantit plottiin</h1>
<pre class="r"><code>m_paAccelerometer_trackgirl &lt;- brms::bf(paAccelerometer_T1 ~ (1 | track:girl)) %&gt;% 
  brms::brm(., data = df, chains = 4, iter = 4000, control = list(adapt_delta = 0.95))
## Found more than one class &quot;family&quot; in cache; using the first, from namespace &#39;lme4&#39;
## Also defined by &#39;MatrixModels&#39;
## Warning: Rows containing NAs were excluded from the model
## Compiling the C++ model
## Start sampling
## 
## SAMPLING FOR MODEL &#39;gaussian brms-model&#39; NOW (CHAIN 1).
## 
## Gradient evaluation took 0 seconds
## 1000 transitions using 10 leapfrog steps per transition would take 0 seconds.
## Adjust your expectations accordingly!
## 
## 
## Iteration:    1 / 4000 [  0%]  (Warmup)
## Iteration:  400 / 4000 [ 10%]  (Warmup)
## Iteration:  800 / 4000 [ 20%]  (Warmup)
## Iteration: 1200 / 4000 [ 30%]  (Warmup)
## Iteration: 1600 / 4000 [ 40%]  (Warmup)
## Iteration: 2000 / 4000 [ 50%]  (Warmup)
## Iteration: 2001 / 4000 [ 50%]  (Sampling)
## Iteration: 2400 / 4000 [ 60%]  (Sampling)
## Iteration: 2800 / 4000 [ 70%]  (Sampling)
## Iteration: 3200 / 4000 [ 80%]  (Sampling)
## Iteration: 3600 / 4000 [ 90%]  (Sampling)
## Iteration: 4000 / 4000 [100%]  (Sampling)
## 
##  Elapsed Time: 2.497 seconds (Warm-up)
##                2.186 seconds (Sampling)
##                4.683 seconds (Total)
## 
## 
## SAMPLING FOR MODEL &#39;gaussian brms-model&#39; NOW (CHAIN 2).
## 
## Gradient evaluation took 0 seconds
## 1000 transitions using 10 leapfrog steps per transition would take 0 seconds.
## Adjust your expectations accordingly!
## 
## 
## Iteration:    1 / 4000 [  0%]  (Warmup)
## Iteration:  400 / 4000 [ 10%]  (Warmup)
## Iteration:  800 / 4000 [ 20%]  (Warmup)
## Iteration: 1200 / 4000 [ 30%]  (Warmup)
## Iteration: 1600 / 4000 [ 40%]  (Warmup)
## Iteration: 2000 / 4000 [ 50%]  (Warmup)
## Iteration: 2001 / 4000 [ 50%]  (Sampling)
## Iteration: 2400 / 4000 [ 60%]  (Sampling)
## Iteration: 2800 / 4000 [ 70%]  (Sampling)
## Iteration: 3200 / 4000 [ 80%]  (Sampling)
## Iteration: 3600 / 4000 [ 90%]  (Sampling)
## Iteration: 4000 / 4000 [100%]  (Sampling)
## 
##  Elapsed Time: 2.815 seconds (Warm-up)
##                1.833 seconds (Sampling)
##                4.648 seconds (Total)
## 
## 
## SAMPLING FOR MODEL &#39;gaussian brms-model&#39; NOW (CHAIN 3).
## 
## Gradient evaluation took 0 seconds
## 1000 transitions using 10 leapfrog steps per transition would take 0 seconds.
## Adjust your expectations accordingly!
## 
## 
## Iteration:    1 / 4000 [  0%]  (Warmup)
## Iteration:  400 / 4000 [ 10%]  (Warmup)
## Iteration:  800 / 4000 [ 20%]  (Warmup)
## Iteration: 1200 / 4000 [ 30%]  (Warmup)
## Iteration: 1600 / 4000 [ 40%]  (Warmup)
## Iteration: 2000 / 4000 [ 50%]  (Warmup)
## Iteration: 2001 / 4000 [ 50%]  (Sampling)
## Iteration: 2400 / 4000 [ 60%]  (Sampling)
## Iteration: 2800 / 4000 [ 70%]  (Sampling)
## Iteration: 3200 / 4000 [ 80%]  (Sampling)
## Iteration: 3600 / 4000 [ 90%]  (Sampling)
## Iteration: 4000 / 4000 [100%]  (Sampling)
## 
##  Elapsed Time: 2.527 seconds (Warm-up)
##                1.666 seconds (Sampling)
##                4.193 seconds (Total)
## 
## 
## SAMPLING FOR MODEL &#39;gaussian brms-model&#39; NOW (CHAIN 4).
## 
## Gradient evaluation took 0 seconds
## 1000 transitions using 10 leapfrog steps per transition would take 0 seconds.
## Adjust your expectations accordingly!
## 
## 
## Iteration:    1 / 4000 [  0%]  (Warmup)
## Iteration:  400 / 4000 [ 10%]  (Warmup)
## Iteration:  800 / 4000 [ 20%]  (Warmup)
## Iteration: 1200 / 4000 [ 30%]  (Warmup)
## Iteration: 1600 / 4000 [ 40%]  (Warmup)
## Iteration: 2000 / 4000 [ 50%]  (Warmup)
## Iteration: 2001 / 4000 [ 50%]  (Sampling)
## Iteration: 2400 / 4000 [ 60%]  (Sampling)
## Iteration: 2800 / 4000 [ 70%]  (Sampling)
## Iteration: 3200 / 4000 [ 80%]  (Sampling)
## Iteration: 3600 / 4000 [ 90%]  (Sampling)
## Iteration: 4000 / 4000 [100%]  (Sampling)
## 
##  Elapsed Time: 2.39 seconds (Warm-up)
##                1.509 seconds (Sampling)
##                3.899 seconds (Total)

brms::get_prior(m_paAccelerometer_trackgirl, data = df)
## Error: Use &#39;prior_summary&#39; to extract priors from &#39;brmsfit&#39; objects.

b_intercept &lt;- brms::fixef(m_paAccelerometer_trackgirl)[1]

# This gives estimates only:
PA_trackgirl_estimates &lt;- brms::ranef(m_paAccelerometer_trackgirl)[[1]][1:10]

# The 2.5%ile:
PA_trackgirl_CIL &lt;- brms::ranef(m_paAccelerometer_trackgirl)[[1]][21:30]

# The 97.5%ile:
PA_trackgirl_CIH &lt;- brms::ranef(m_paAccelerometer_trackgirl)[[1]][31:40]

PA_trackgirl_ci &lt;- data.frame(PA_trackgirl_CIL, PA_trackgirl_estimates, PA_trackgirl_CIH, Variable = labels(brms::ranef(m_paAccelerometer_trackgirl))) %&gt;% 
  mutate(b_intercept = rep(b_intercept, 10)) %&gt;% 
  mutate(PA_trackgirl_CIL = PA_trackgirl_CIL + b_intercept,
         PA_trackgirl_estimates = PA_trackgirl_estimates + b_intercept,
         PA_trackgirl_CIH = PA_trackgirl_CIH + b_intercept,
         track = c(&#39;Business Admin_boy&#39;,
                   &#39;Business Admin_girl&#39;,
                   &#39;Business IT_boy&#39;,
                   &#39;Business IT_girl&#39;,
                   &#39;HRC_boy&#39;,
                   &#39;HRC_girl&#39;,
                   &#39;Nursing_boy&#39;,
                   &#39;Nursing_girl&#39;,
                   &#39;Other_boy&#39;,
                   &#39;Other_girl&#39;
))

PA_trackgirl_diamonds_girl &lt;- rbind(
PA_trackgirl_ci %&gt;% filter(track == &quot;Nursing_girl&quot;),
PA_trackgirl_ci %&gt;% filter(track == &quot;HRC_girl&quot;),
PA_trackgirl_ci %&gt;% filter(track == &quot;Business Admin_girl&quot;),
PA_trackgirl_ci %&gt;% filter(track == &quot;Business IT_girl&quot;)) %&gt;% 
  arrange(-row_number()) # reverse order of rows to make them right for the plot to come

PA_trackgirl_diamonds_boy &lt;- rbind(
PA_trackgirl_ci %&gt;% filter(track == &quot;Nursing_boy&quot;),
PA_trackgirl_ci %&gt;% filter(track == &quot;HRC_boy&quot;),
PA_trackgirl_ci %&gt;% filter(track == &quot;Business Admin_boy&quot;),
PA_trackgirl_ci %&gt;% filter(track == &quot;Business IT_boy&quot;)) %&gt;% 
  arrange(-row_number()) # reverse order of rows to make them right for the plot to come
</code></pre>
<pre class="r"><code>plot1 &lt;- df %&gt;% dplyr::select(id,
                              track = track,
                              girl,
                              Intrinsic = PA_intrinsic_T1,
                              Identified = PA_identified_T1,
                              Integrated = PA_integrated_T1,
                              Introjected = PA_introjected_T1,
                              Extrinsic = PA_extrinsic_T1)  %&gt;%
  filter(!is.na(track), track != &quot;Other&quot;) %&gt;% # Drop category &quot;Other&quot;
  gather(Regulation, value, Intrinsic:Extrinsic) %&gt;% 
  data.frame %&gt;% 
  ggplot(aes(y = Regulation)) +
  ggridges::geom_density_ridges2(aes(x = value, colour = &quot;black&quot;,
                                     fill = paste(Regulation, track)),
                                  scale = 1,
                                  alpha = 0.4, size = 0.25,
                                  from = 1, to = 7) +
  labs(x = &quot;Mean daily MVPA minutes (accelerometer)&quot;,
       y = &quot;&quot;) +
  scale_y_discrete(expand = c(0.01, 0)) +
  scale_x_continuous(expand = c(0.01, 0)) +
  ggridges::scale_fill_cyclical(
                                labels = c(&#39;Extrinsic Business Admin&#39; = &quot;Business admin&quot;, &#39;Extrinsic Business IT&#39; = &quot;Business IT&quot;, &#39;Extrinsic HRC&#39; = &quot;HRC&quot;, &#39;Extrinsic Nursing&#39; = &quot;Nursing&quot;),
                                values = viridis::viridis(4, end = 0.8),
                                name = &quot;&quot;, guide = guide_legend(override.aes = list(alpha = 1))) +
  ggridges::scale_colour_cyclical(values = &quot;black&quot;) +
  ggridges::theme_ridges(grid = FALSE) +
  papaja::theme_apa() </code></pre>
<div id="mvpa-different-tracks-with-gender-as-diamond" class="section level2">
<h2>MVPA: Different tracks, with gender as diamond</h2>
<pre class="r"><code>
plot1 &lt;- df %&gt;% dplyr::select(id,
                              track = track,
                              girl,
                              PA = paAccelerometer_T1)  %&gt;%
  filter(!is.na(track), track != &quot;Other&quot;) %&gt;% # Drop category &quot;Other&quot;
  ggplot(aes(y = track)) +
  ggridges::geom_density_ridges2(aes(x = PA, colour = &quot;black&quot;, 
                                    fill = paste(track, girl)),
                                  scale = 1,
                                  alpha = 0.6, size = 0.25,
                                  from = 0, to = 450,
                                  jittered_points=TRUE, point_shape=21,
                                  point_fill=&quot;black&quot;) +
  labs(x = &quot;Mean daily MVPA minutes (accelerometer)&quot;,
       y = &quot;&quot;) +
  scale_y_discrete(expand = c(0.01, 0)) +
  scale_x_continuous(expand = c(0.01, 0)) +
  ggridges::scale_fill_cyclical(
                                labels = c(&#39;Business Admin boy&#39; = &quot;Boy&quot;, &#39;Business Admin girl&#39; = &quot;Girl&quot;),
                                values = viridis::viridis(4, end = 0.8)[c(1, 3)],
                                name = &quot;&quot;, guide = guide_legend(override.aes = list(alpha = 1))) +
  ggridges::scale_colour_cyclical(values = &quot;black&quot;) +
  ggridges::theme_ridges(grid = FALSE) +
  papaja::theme_apa() 

df %&gt;% select(paAccelerometer_T1, girl, track) %&gt;% 
  group_by(girl, track) %&gt;% 
  summarise(mean = mean(paAccelerometer_T1, na.rm = TRUE),
            median = median(paAccelerometer_T1, na.rm = TRUE),
            max = max(paAccelerometer_T1, na.rm = TRUE),
            min = min(paAccelerometer_T1, na.rm = TRUE),
            sd = sd(paAccelerometer_T1, na.rm = TRUE),
            n = n())</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["girl"],"name":[1],"type":["fctr"],"align":["left"]},{"label":["track"],"name":[2],"type":["fctr"],"align":["left"]},{"label":["mean"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["median"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["max"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["min"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["sd"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["n"],"name":[8],"type":["int"],"align":["right"]}],"data":[{"1":"girl","2":"Other","3":"187.5807","4":"197.8500","5":"264.4714","6":"101.65000","7":"48.55376","8":"17"},{"1":"girl","2":"Business IT","3":"122.3537","4":"113.7857","5":"197.4000","6":"75.66667","7":"37.71910","8":"26"},{"1":"girl","2":"Business Admin","3":"179.1121","4":"176.4914","5":"288.4200","6":"71.20000","7":"43.47136","8":"110"},{"1":"girl","2":"HRC","3":"185.2085","4":"177.7714","5":"367.2143","6":"76.04286","7":"49.82225","8":"129"},{"1":"girl","2":"Nursing","3":"201.3262","4":"201.1571","5":"338.7500","6":"92.13333","7":"44.91972","8":"331"},{"1":"boy","2":"Other","3":"181.6343","4":"217.4286","5":"262.0714","6":"73.38571","7":"75.89630","8":"7"},{"1":"boy","2":"Business IT","3":"145.6664","4":"136.6857","5":"366.9800","6":"67.57143","7":"53.51442","8":"137"},{"1":"boy","2":"Business Admin","3":"180.0059","4":"176.3950","5":"284.1857","6":"83.22000","7":"52.16270","8":"172"},{"1":"boy","2":"HRC","3":"179.4194","4":"176.5012","5":"320.2400","6":"66.48571","7":"56.33179","8":"84"},{"1":"boy","2":"Nursing","3":"200.7605","4":"203.2667","5":"342.3571","6":"61.52500","7":"65.85193","8":"71"},{"1":"NA","2":"NA","3":"193.5746","4":"161.6500","5":"291.3400","6":"137.60000","7":"65.91078","8":"81"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<pre class="r"><code>
df %&gt;% select(paAccelerometer_T1, girl, track) %&gt;% 
  group_by(girl) %&gt;% 
  summarise(mean = mean(paAccelerometer_T1, na.rm = TRUE),
            median = median(paAccelerometer_T1, na.rm = TRUE),
            max = max(paAccelerometer_T1, na.rm = TRUE),
            min = min(paAccelerometer_T1, na.rm = TRUE),
            sd = sd(paAccelerometer_T1, na.rm = TRUE),
            n = n())</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["girl"],"name":[1],"type":["fctr"],"align":["left"]},{"label":["mean"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["median"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["max"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["min"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["sd"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["n"],"name":[7],"type":["int"],"align":["right"]}],"data":[{"1":"girl","2":"190.3587","3":"189.1857","4":"367.2143","5":"71.200","6":"48.60014","7":"613"},{"1":"boy","2":"173.5460","3":"164.6571","4":"366.9800","5":"61.525","6":"59.39425","7":"471"},{"1":"NA","2":"193.5746","3":"161.6500","4":"291.3400","5":"137.600","6":"65.91078","7":"81"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<pre class="r"><code>
# target = c(
# &quot;PA_intention_T1&quot;,
# &quot;PA_outcomeExpectations_T1&quot;,
# &quot;PA_pbc_T1&quot;,
# &quot;PA_selfefficacy_T1&quot;,
# &quot;PA_opportunities_T1&quot;,
# &quot;PA_dnorm_T1&quot;)
# 
# PA_ci_girls &lt;- ci_girls %&gt;% filter(paAccelerometer)
# 
# PA_ci_girls &lt;- PA_ci_girls[match(target, PA_ci_girls$diamondlabels), ]
# 
# PA_ci_boys &lt;- ci_boys %&gt;% filter(diamondlabels %in% names(scales_T1) &amp; 
#                                      grepl(&quot;PA_intention_T1&quot;, diamondlabels) | 
#                                      grepl(&quot;PA_outcomeExpectations_T1&quot;, diamondlabels) | 
#                                      grepl(&quot;PA_pbc_T1&quot;, diamondlabels) | 
#                                      grepl(&quot;PA_selfefficacy_T1&quot;, diamondlabels) | 
#                                      grepl(&quot;PA_opportunities_T1&quot;, diamondlabels) | 
#                                      grepl(&quot;PA_dnorm_T1&quot;, diamondlabels))
# 
# PA_ci_boys &lt;- PA_ci_boys[match(target, PA_ci_boys$diamondlabels), ]
# 
plot1 &lt;- plot1 + userfriendlyscience::diamondPlot(PA_trackgirl_diamonds_girl, 
                                                  returnLayerOnly = TRUE, 
                                                  lineColor = &quot;black&quot;, 
                                                  color=viridis::viridis(4, end = 0.8)[3],
                                                  alpha=.6, 
                                                  fixedSize = 0.15, 
                                                  otherAxisCol = (1:4 + .2)) + # specify y-position and lift the diamonds up 0.2
  userfriendlyscience::diamondPlot(PA_trackgirl_diamonds_boy, 
                                   returnLayerOnly = TRUE, 
                                   lineColor = &quot;black&quot;, 
                                   linetype = &quot;solid&quot;, 
                                   color=viridis::viridis(4, end = 0.8)[1],
                                   alpha=.6, 
                                   fixedSize = 0.15, 
                                   otherAxisCol = (1:4 + .2))

plot1 
## Picking joint bandwidth of 18.1
## Warning: Removed 370 rows containing non-finite values
## (stat_density_ridges).</code></pre>
<p><img src="baseline-supplement_files/figure-html/unnamed-chunk-23-1.png" width="2100" /></p>
<div id="mvpa-girls-and-boys-in-different-educational-tracks-and-schools" class="section level3">
<h3>MVPA, girls and boys in different educational tracks and schools</h3>
<pre class="r"><code>
plot1 &lt;- df %&gt;% dplyr::select(id,
                              trackSchool = trackSchool,
                              girl,
                              PA = paAccelerometer_T1)  %&gt;%
  filter(!is.na(trackSchool), !grepl(&#39;Other|NANA|Business Admin4|HRC2|Nursing2&#39;, trackSchool)) %&gt;% # Drop categories with just few participants
  ggplot(aes(y = trackSchool)) +
  ggridges::geom_density_ridges2(aes(x = PA, colour = &quot;black&quot;, 
                                    fill = paste(trackSchool, girl)),
                                  scale = 1,
                                  alpha = 0.6, size = 0.25,
                                  from = 0, to = 450,
                                  jittered_points=TRUE, point_shape=21,
                                  point_fill=&quot;black&quot;) +
  labs(x = &quot;&quot;,
       y = &quot;&quot;) +
  scale_y_discrete(expand = c(0.01, 0)) +
  scale_x_continuous(expand = c(0.01, 0)) +
  ggridges::scale_fill_cyclical(
                                labels = c(&#39;Business Admin1 boy&#39; = &quot;Boy&quot;, &#39;Business Admin1 girl&#39; = &quot;Girl&quot;),
                                values = viridis::viridis(4, end = 0.8)[c(1, 3)],
                                name = &quot;&quot;, guide = guide_legend(override.aes = list(alpha = 1))) +
  ggridges::scale_colour_cyclical(values = &quot;black&quot;) +
  ggridges::theme_ridges(grid = FALSE) +
  theme(legend.position=&quot;bottom&quot;, axis.text=element_text(size=10))
plot1
## Picking joint bandwidth of 20.3
## Warning: Removed 367 rows containing non-finite values
## (stat_density_ridges).</code></pre>
<p><img src="baseline-supplement_files/figure-html/unnamed-chunk-24-1.png" width="2100" /></p>
<pre class="r"><code>
df %&gt;% select(paAccelerometer_T1, girl, trackSchool) %&gt;% 
  group_by(girl, trackSchool) %&gt;% 
  summarise(mean = mean(paAccelerometer_T1, na.rm = TRUE),
            median = median(paAccelerometer_T1, na.rm = TRUE),
            max = max(paAccelerometer_T1, na.rm = TRUE),
            min = min(paAccelerometer_T1, na.rm = TRUE),
            sd = sd(paAccelerometer_T1, na.rm = TRUE),
            n = n())</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["girl"],"name":[1],"type":["fctr"],"align":["left"]},{"label":["trackSchool"],"name":[2],"type":["chr"],"align":["left"]},{"label":["mean"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["median"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["max"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["min"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["sd"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["n"],"name":[8],"type":["int"],"align":["right"]}],"data":[{"1":"girl","2":"Business Admin1","3":"179.1147","4":"171.7167","5":"284.4833","6":"99.14000","7":"42.68773","8":"56"},{"1":"girl","2":"Business Admin2","3":"179.1093","4":"185.7500","5":"288.4200","6":"71.20000","7":"44.95054","8":"53"},{"1":"girl","2":"Business Admin4","3":"NaN","4":"NA","5":"-Inf","6":"Inf","7":"NaN","8":"1"},{"1":"girl","2":"Business IT1","3":"134.1119","4":"135.4774","5":"197.4000","6":"76.15000","7":"48.37838","8":"12"},{"1":"girl","2":"Business IT2","3":"113.8023","4":"113.7857","5":"178.3833","6":"75.66667","7":"27.04705","8":"14"},{"1":"girl","2":"HRC1","3":"169.1639","4":"176.0800","5":"290.1857","6":"76.04286","7":"52.55204","8":"39"},{"1":"girl","2":"HRC5","3":"191.1072","4":"182.4714","5":"367.2143","6":"106.15000","7":"47.83128","8":"90"},{"1":"girl","2":"Nursing3","3":"198.2817","4":"203.1798","5":"307.5500","6":"92.13333","7":"48.35077","8":"104"},{"1":"girl","2":"Nursing4","3":"202.7343","4":"200.8821","5":"338.7500","6":"103.65000","7":"43.32709","8":"227"},{"1":"girl","2":"Other1","3":"141.5857","4":"141.5857","5":"141.5857","6":"141.58571","7":"NaN","8":"1"},{"1":"girl","2":"Other3","3":"193.6221","4":"186.8514","5":"243.7857","6":"157.00000","7":"39.27256","8":"7"},{"1":"girl","2":"Other4","3":"189.8926","4":"201.1667","5":"264.4714","6":"101.65000","7":"64.33109","8":"7"},{"1":"girl","2":"Other5","3":"197.8500","4":"197.8500","5":"197.8500","6":"197.85000","7":"NaN","8":"2"},{"1":"boy","2":"Business Admin1","3":"181.6179","4":"193.6625","5":"284.1857","6":"83.22000","7":"53.56172","8":"93"},{"1":"boy","2":"Business Admin2","3":"178.3938","4":"169.0631","5":"273.1833","6":"91.70000","7":"51.29324","8":"78"},{"1":"boy","2":"Business Admin4","3":"NaN","4":"NA","5":"-Inf","6":"Inf","7":"NaN","8":"1"},{"1":"boy","2":"Business IT1","3":"145.8302","4":"136.5018","5":"366.9800","6":"69.84286","7":"57.55756","8":"64"},{"1":"boy","2":"Business IT2","3":"145.4815","4":"139.8714","5":"284.1000","6":"67.57143","7":"49.30437","8":"73"},{"1":"boy","2":"HRC1","3":"187.7306","4":"184.9100","5":"320.2400","6":"109.12500","7":"65.83682","8":"28"},{"1":"boy","2":"HRC2","3":"NaN","4":"NA","5":"-Inf","6":"Inf","7":"NaN","8":"1"},{"1":"boy","2":"HRC5","3":"175.2638","4":"174.4143","5":"297.5600","6":"66.48571","7":"51.44539","8":"55"},{"1":"boy","2":"Nursing2","3":"210.4143","4":"210.4143","5":"210.4143","6":"210.41429","7":"NaN","8":"1"},{"1":"boy","2":"Nursing3","3":"180.9549","4":"169.9429","5":"263.4833","6":"85.77500","7":"51.49774","8":"20"},{"1":"boy","2":"Nursing4","3":"207.4583","4":"205.7750","5":"342.3571","6":"61.52500","7":"70.34581","8":"50"},{"1":"boy","2":"Other2","3":"104.4786","4":"104.4786","5":"135.5714","6":"73.38571","7":"43.97194","8":"3"},{"1":"boy","2":"Other3","3":"262.0714","4":"262.0714","5":"262.0714","6":"262.07143","7":"NaN","8":"1"},{"1":"boy","2":"Other4","3":"219.7143","4":"219.7143","5":"219.7143","6":"219.71429","7":"NaN","8":"2"},{"1":"boy","2":"Other5","3":"217.4286","4":"217.4286","5":"217.4286","6":"217.42857","7":"NaN","8":"1"},{"1":"NA","2":"NANA","3":"193.5746","4":"161.6500","5":"291.3400","6":"137.60000","7":"65.91078","8":"81"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<pre class="r"><code>
df %&gt;% select(paAccelerometer_T1, girl, trackSchool) %&gt;% 
  group_by(girl) %&gt;% 
  summarise(mean = mean(paAccelerometer_T1, na.rm = TRUE),
            median = median(paAccelerometer_T1, na.rm = TRUE),
            max = max(paAccelerometer_T1, na.rm = TRUE),
            min = min(paAccelerometer_T1, na.rm = TRUE),
            sd = sd(paAccelerometer_T1, na.rm = TRUE),
            n = n())</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["girl"],"name":[1],"type":["fctr"],"align":["left"]},{"label":["mean"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["median"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["max"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["min"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["sd"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["n"],"name":[7],"type":["int"],"align":["right"]}],"data":[{"1":"girl","2":"190.3587","3":"189.1857","4":"367.2143","5":"71.200","6":"48.60014","7":"613"},{"1":"boy","2":"173.5460","3":"164.6571","4":"366.9800","5":"61.525","6":"59.39425","7":"471"},{"1":"NA","2":"193.5746","3":"161.6500","4":"291.3400","5":"137.600","6":"65.91078","7":"81"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<pre class="r"><code>library(viridis::viridis)
## Error in library(viridis::viridis): &#39;package&#39; must be of length 1
plot1 &lt;- df %&gt;% dplyr::select(id,
  intervention,
  group,
  school,
  girl,
&#39;PA action and\ncoping planning&#39; = PA_actCop_T1,
&#39;PA intention&#39; = PA_intention_T1,
&#39;PA outcome\nexpectations&#39; = PA_outcomeExpectations_T1,
&#39;PA perceived\nbehavioural control&#39; = PA_pbc_T1,
&#39;PA self efficacy&#39; = PA_selfefficacy_T1,
&#39;PA perceived\nopportunities&#39; = PA_opportunities_T1,
&#39;PA descriptive\nnorm&#39; = PA_dnorm_T1,
&#39;PA injunctive\nnorm&#39; = PA_inorm_T1)  %&gt;%
  # select(noquote(order(colnames(.)))) %&gt;% # Orders columns alphabetically
  tidyr::gather(key = Variable, value = Value, 6:ncol(.), factor_key = TRUE) %&gt;% 
  ggplot(aes(y = Variable)) +
  ggridges::geom_density_ridges(aes(x = Value, fill = paste(Variable, girl)), 
           alpha = .1, color = &quot;black&quot;, from = 1, to = 7) +
  labs(x = &quot;&quot;,
       y = &quot;&quot;) +
  scale_y_discrete(expand = c(0.01, 0)) +
  scale_x_continuous(expand = c(0.01, 0)) +
  ggridges::scale_fill_cyclical(breaks = c(&quot;PA injunctive\nnorm 0&quot;, &quot;PA injunctive\nnorm 1&quot;),
                      labels = c( &#39;PA injunctive\nnorm 0&#39; = &quot;Boy&quot;, &#39;PA injunctive\nnorm 1&#39; = &quot;Girl&quot;),
                      values = viridis::viridis(4, end = 0.8)[1:2], #c(&quot;#3bc600&quot;, &quot;#0000ff&quot;, &quot;#9cc68b&quot;, &quot;#8080ff&quot;),
                      name = &quot;&quot;, guide = &quot;legend&quot;) +
  ggridges::theme_ridges(grid = FALSE) +
  theme(legend.position=&quot;bottom&quot;, axis.text=element_text(size=10))
## Warning: attributes are not identical across measure variables;
## they will be dropped

plot2 &lt;- df %&gt;% dplyr::select(id,
  intervention,
  group,
  school,
  girl,
&#39;PA action and\ncoping planning&#39; = PA_actCop_T1,
&#39;PA intention&#39; = PA_intention_T1,
&#39;PA outcome\nexpectations&#39; = PA_outcomeExpectations_T1,
&#39;PA perceived\nbehavioural control&#39; = PA_pbc_T1,
&#39;PA self efficacy&#39; = PA_selfefficacy_T1,
&#39;PA perceived\nopportunities&#39; = PA_opportunities_T1,
&#39;PA descriptive\nnorm&#39; = PA_dnorm_T1,
&#39;PA injunctive\nnorm&#39; = PA_inorm_T1) %&gt;%
  # select(noquote(order(colnames(.)))) %&gt;% # Orders columns alphabetically
  tidyr::gather(key = Variable, value = Value, 6:ncol(.), factor_key = TRUE) %&gt;% 
  ggplot(aes(y = Variable)) +
  ggridges::geom_density_ridges(aes(x = Value, fill = paste(Variable, intervention)), 
           alpha = .9, color = &quot;black&quot;, from = 1, to = 7) +
  labs(x = &quot;&quot;,
       y = &quot;&quot;) +
  scale_y_discrete(expand = c(0.01, 0), labels = NULL) +
  scale_x_continuous(expand = c(0.01, 0)) +
  ggridges::scale_fill_cyclical(breaks = c(&quot;PA injunctive\nnorm 1&quot;, &quot;PA injunctive\nnorm 0&quot;),
                      labels = c(&#39;PA injunctive\nnorm 1&#39; = &quot;Intervention&quot;, &#39;PA injunctive\nnorm 0&#39; = &quot;Control&quot;),
                      values = viridis::viridis(4, end = 0.8)[3:4], #c(&quot;#ff0000&quot;, &quot;#0000ff&quot;, &quot;#ff8080&quot;, &quot;#8080ff&quot;),
                      name = &quot;&quot;, guide = &quot;legend&quot;) +
  ggridges::theme_ridges(grid = FALSE) +
  theme(legend.position=&quot;bottom&quot;, axis.text=element_text(size=10))
## Warning: attributes are not identical across measure variables;
## they will be dropped

target = c(&quot;PA_actCop_T1&quot;,
&quot;PA_intention_T1&quot;,
&quot;PA_outcomeExpectations_T1&quot;,
&quot;PA_pbc_T1&quot;,
&quot;PA_selfefficacy_T1&quot;,
&quot;PA_opportunities_T1&quot;,
&quot;PA_dnorm_T1&quot;,
&quot;PA_inorm_T1&quot;)

PA_ci_girls &lt;- ci_girls %&gt;% filter(diamondlabels %in% names(scales_T1) &amp; 
                                     grepl(&quot;PA_actCop_T1&quot;, diamondlabels) | 
                                     grepl(&quot;PA_intention_T1&quot;, diamondlabels) | 
                                     grepl(&quot;PA_outcomeExpectations_T1&quot;, diamondlabels) | 
                                     grepl(&quot;PA_pbc_T1&quot;, diamondlabels) | 
                                     grepl(&quot;PA_selfefficacy_T1&quot;, diamondlabels) | 
                                     grepl(&quot;PA_opportunities_T1&quot;, diamondlabels) | 
                                     grepl(&quot;PA_dnorm_T1&quot;, diamondlabels) | 
                                     grepl(&quot;PA_inorm_T1&quot;, diamondlabels))

PA_ci_girls &lt;- PA_ci_girls[match(target, PA_ci_girls$diamondlabels), ]

PA_ci_boys &lt;- ci_boys %&gt;% filter(diamondlabels %in% names(scales_T1) &amp; 
                                     grepl(&quot;PA_actCop_T1&quot;, diamondlabels) | 
                                     grepl(&quot;PA_intention_T1&quot;, diamondlabels) | 
                                     grepl(&quot;PA_outcomeExpectations_T1&quot;, diamondlabels) | 
                                     grepl(&quot;PA_pbc_T1&quot;, diamondlabels) | 
                                     grepl(&quot;PA_selfefficacy_T1&quot;, diamondlabels) | 
                                     grepl(&quot;PA_opportunities_T1&quot;, diamondlabels) | 
                                     grepl(&quot;PA_dnorm_T1&quot;, diamondlabels) | 
                                     grepl(&quot;PA_inorm_T1&quot;, diamondlabels))

PA_ci_boys &lt;- PA_ci_boys[match(target, PA_ci_boys$diamondlabels), ]

plot1 &lt;- plot1 + 
  userfriendlyscience::diamondPlot(PA_ci_girls, returnLayerOnly = TRUE, color=viridis::viridis(4, end = 0.8)[1],# &#39;blue&#39;, 
                alpha=.95, fixedSize = 0.15, otherAxisCol = (1:length(target) + .2)) +
  userfriendlyscience::diamondPlot(PA_ci_boys, returnLayerOnly = TRUE, color=viridis::viridis(4, end = 0.8)[2], #&#39;green&#39;, 
                alpha=.95, fixedSize = 0.15, otherAxisCol = (1:length(target) + .2))

PA_ci_intervention &lt;- ci_intervention %&gt;% filter(diamondlabels %in% names(scales_T1) &amp; 
                                     grepl(&quot;PA_actCop_T1&quot;, diamondlabels) | 
                                     grepl(&quot;PA_intention_T1&quot;, diamondlabels) | 
                                     grepl(&quot;PA_outcomeExpectations_T1&quot;, diamondlabels) | 
                                     grepl(&quot;PA_pbc_T1&quot;, diamondlabels) | 
                                     grepl(&quot;PA_selfefficacy_T1&quot;, diamondlabels) | 
                                     grepl(&quot;PA_opportunities_T1&quot;, diamondlabels) | 
                                     grepl(&quot;PA_dnorm_T1&quot;, diamondlabels) | 
                                     grepl(&quot;PA_inorm_T1&quot;, diamondlabels))

PA_ci_intervention &lt;- PA_ci_intervention[match(target, PA_ci_intervention$diamondlabels), ]

PA_ci_control &lt;- ci_control %&gt;% filter(diamondlabels %in% names(scales_T1) &amp; 
                                     grepl(&quot;PA_actCop_T1&quot;, diamondlabels) | 
                                     grepl(&quot;PA_intention_T1&quot;, diamondlabels) | 
                                     grepl(&quot;PA_outcomeExpectations_T1&quot;, diamondlabels) | 
                                     grepl(&quot;PA_pbc_T1&quot;, diamondlabels) | 
                                     grepl(&quot;PA_selfefficacy_T1&quot;, diamondlabels) | 
                                     grepl(&quot;PA_opportunities_T1&quot;, diamondlabels) | 
                                     grepl(&quot;PA_dnorm_T1&quot;, diamondlabels) | 
                                     grepl(&quot;PA_inorm_T1&quot;, diamondlabels))

PA_ci_control &lt;- PA_ci_control[match(target, PA_ci_control$diamondlabels), ]

plot2 &lt;- plot2 + 
  userfriendlyscience::diamondPlot(PA_ci_intervention, returnLayerOnly = TRUE, color=viridis::viridis(4, end = 0.8)[4],# &#39;blue&#39;,
              alpha=.95, fixedSize = 0.15, otherAxisCol = (1:length(target) + .2)) +
  userfriendlyscience::diamondPlot(PA_ci_control, returnLayerOnly = TRUE, color=viridis::viridis(4, end = 0.8)[3], #&#39;red&#39;, 
              alpha=.95, fixedSize = 0.15, otherAxisCol = (1:length(target) + .2))

# grid.arrange(plot1, plot2, ncol = 2)
grid::grid.newpage()
grid::grid.draw(cbind(ggplotGrob(plot1), ggplotGrob(plot2), size = &quot;first&quot;))
## Picking joint bandwidth of 0.337
## Warning: Removed 733 rows containing non-finite values
## (stat_density_ridges).
## Picking joint bandwidth of 0.341
## Warning: Removed 733 rows containing non-finite values
## (stat_density_ridges).
## Error: nrow(x) == nrow(y) is not TRUE</code></pre>
<pre class="r"><code>library(visreg)
library(broom)

m_pbcgirl &lt;- lme4::lmer(PA_pbc_T1 ~ girl + (1 | school), data = df)
summary(m_pbcgirl)
## Linear mixed model fit by REML [&#39;lmerMod&#39;]
## Formula: PA_pbc_T1 ~ girl + (1 | school)
##    Data: df
## 
## REML criterion at convergence: 3561.2
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -3.2903 -0.6705  0.1155  0.9014  1.4253 
## 
## Random effects:
##  Groups   Name        Variance  Std.Dev. 
##  school   (Intercept) 1.393e-14 1.180e-07
##  Residual             1.619e+00 1.272e+00
## Number of obs: 1071, groups:  school, 5
## 
## Fixed effects:
##             Estimate Std. Error t value
## (Intercept)  5.18644    0.05164  100.43
## girlboy      0.32578    0.07846    4.15
## 
## Correlation of Fixed Effects:
##         (Intr)
## girlboy -0.658

visreg::visreg(m_pbcgirl, &quot;school&quot;, type = &quot;contrast&quot;)</code></pre>
<p><img src="baseline-supplement_files/figure-html/unnamed-chunk-26-1.png" width="2100" /></p>
<pre class="r"><code>
visreg(m_pbcgirl, &quot;girl&quot;, by=&quot;school&quot;, re.form=~(1|school))</code></pre>
<p><img src="baseline-supplement_files/figure-html/unnamed-chunk-26-2.png" width="2100" /></p>
<pre class="r"><code>
glance(m_pbcgirl)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["sigma"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["logLik"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["AIC"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["BIC"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["deviance"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["df.residual"],"name":[6],"type":["int"],"align":["right"]}],"data":[{"1":"1.272372","2":"-1780.624","3":"3569.247","4":"3589.153","5":"3553.336","6":"1067"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div id="sb-determinants" class="section level2">
<h2>SB determinants</h2>
<pre class="r"><code>
plot1 &lt;- df %&gt;% dplyr::select(id,
  intervention,
  group,
  school,
  girl,
&#39;SB intention&#39; = SB_intention_T1,
&#39;SB outcome\nexpectations&#39; = SB_outcomeExpectations_T1,
&#39;SB self-efficacy\nand perceived\nbehavioural control&#39; = SB_sePbc_T1,
&#39;SB descriptive\nnorm&#39; = SB_dnorm_T1,
&#39;SB injunctive\nnorm&#39; = SB_inorm_T1)  %&gt;%
  # select(noquote(order(colnames(.)))) %&gt;% # Orders columns alphabetically
  tidyr::gather(key = Variable, value = Value, 6:ncol(.)) %&gt;% 
  ggplot(aes(y = Variable)) +
  ggridges::geom_density_ridges(aes(x = Value, fill = paste(Variable, girl)), 
           alpha = .6, color = &quot;black&quot;, from = 1, to = 7) +
  labs(x = &quot;&quot;,
       y = &quot;&quot;) +
  scale_y_discrete(expand = c(0.01, 0)) +
  scale_x_continuous(expand = c(0.01, 0)) +
  ggridges::scale_fill_cyclical(breaks = c(&quot;SB injunctive\nnorm 0&quot;, &quot;SB injunctive\nnorm 1&quot;),
                      labels = c( &#39;SB injunctive\nnorm 0&#39; = &quot;Boy&quot;, &#39;SB injunctive\nnorm 1&#39; = &quot;Girl&quot;),
                      values = c(&quot;#3bc600&quot;, &quot;#0000ff&quot;, &quot;#9cc68b&quot;, &quot;#8080ff&quot;),
                      name = &quot;&quot;, guide = &quot;legend&quot;) +
  ggridges::theme_ridges(grid = FALSE) +
  theme(legend.position=&quot;bottom&quot;)

plot2 &lt;- df %&gt;% dplyr::select(id,
  intervention,
  group,
  school,
  girl,
&#39;SB intention&#39; = SB_intention_T1,
&#39;SB outcome\nexpectations&#39; = SB_outcomeExpectations_T1,
&#39;SB self-efficacy\nand perceived\nbehavioural control&#39; = SB_sePbc_T1,
&#39;SB descriptive\nnorm&#39; = SB_dnorm_T1,
&#39;SB injunctive\nnorm&#39; = SB_inorm_T1) %&gt;%
  # select(noquote(order(colnames(.)))) %&gt;% # Orders columns alphabetically
  tidyr::gather(key = Variable, value = Value, 6:ncol(.)) %&gt;% 
  ggplot(aes(y = Variable)) +
  ggridges::geom_density_ridges(aes(x = Value, fill = paste(Variable, intervention)), 
           alpha = .6, color = &quot;black&quot;, from = 1, to = 7) +
  labs(x = &quot;&quot;,
       y = &quot;&quot;) +
  scale_y_discrete(expand = c(0.01, 0), labels = NULL) +
  scale_x_continuous(expand = c(0.01, 0)) +
  ggridges::scale_fill_cyclical(breaks = c(&quot;SB injunctive\nnorm 1&quot;, &quot;SB injunctive\nnorm 0&quot;),
                      labels = c(&#39;SB injunctive\nnorm 1&#39; = &quot;Intervention&quot;, &#39;SB injunctive\nnorm 0&#39; = &quot;Control&quot;),
                      values = c(&quot;#ff0000&quot;, &quot;#0000ff&quot;, &quot;#ff8080&quot;, &quot;#8080ff&quot;),
                      name = &quot;&quot;, guide = &quot;legend&quot;) +
  ggridges::theme_ridges(grid = FALSE) +
  theme(legend.position=&quot;bottom&quot;)

gridExtra::grid.arrange(plot1, plot2, ncol = 2)
## Picking joint bandwidth of 0.311
## Warning: Removed 507 rows containing non-finite values
## (stat_density_ridges).
## Picking joint bandwidth of 0.317
## Warning: Removed 507 rows containing non-finite values
## (stat_density_ridges).</code></pre>
<p><img src="baseline-supplement_files/figure-html/unnamed-chunk-27-1.png" width="2100" /></p>
</div>
</div>
<div id="ciber-not-included-for-now" class="section level1">
<h1>CIBER (not included for now)</h1>
<pre class="r"><code>#p_install(&quot;userfriendlyscience&quot;)

# cat(names(df), sep = &quot;\&quot;,\n\&quot;&quot;)

# Make variables numeric, and d as data frame
d_num &lt;- df %&gt;% mutate_all(as.numeric) 
d_num &lt;- as.data.frame(d_num)

userfriendlyscience::CIBER(data = d_num,
      determinants = c(
        &quot;actCop_T1&quot;,
        &quot;agrbct_T1&quot;,
        &quot;amotivation_T1&quot;,
        &quot;autonomous_T1&quot;,
        &quot;big5_agreeableness_T1.1&quot;,
        &quot;big5_conscientiousness_T1.1&quot;,
        &quot;big5_extraversion_T1.1&quot;,
        &quot;big5_neuroticism_T1.1&quot;,
        &quot;big5_openness_T1.1&quot;,
        &quot;controlled_T1&quot;,
        &quot;dnorm_T1&quot;,
        &quot;frqbct_T1&quot;,
        &quot;goal_T1&quot;,
        &quot;inorm_T1&quot;,
        &quot;intention_T1&quot;,
        &quot;outcomeExpectations_T1&quot;,
        &quot;opportunities_T1&quot;,
        &quot;pbc_T1&quot;,
        &quot;selfefficacy_T1&quot;),
      targets = c(&quot;paT1&quot;, &quot;fatpct_T1&quot;),
      conf.level = list(means = 0.9999,
                        associations = 0.99)
      )

userfriendlyscience::CIBER(data = d_num,
      determinants = c(
        &quot;actCop_T1&quot;,
        &quot;agrbct_T1&quot;,
        &quot;frqbct_T1&quot;,
        &quot;amotivation_T1&quot;,
        &quot;autonomous_T1&quot;,
        &quot;controlled_T1&quot;,
        &quot;dnorm_T1&quot;,
        &quot;intention_T1&quot;,
        &quot;outcomeExpectations_T1&quot;,
        &quot;opportunities_T1&quot;,
        &quot;sePbc_T1&quot;),
      targets = c(&quot;paT1&quot;, &quot;fatpct_T1&quot;),
      conf.level = list(means = 0.9999,
                        associations = 0.99)
      )

# to create variable list for CIBER:
# cat(names(d), sep = &quot;\&quot;,\n\&quot;&quot;)

userfriendlyscience::CIBER(data = d_num,
  determinants = c(
  &quot;agrbct_01_T1&quot;,
  &quot;agrbct_02_T1&quot;,
  &quot;agrbct_03_T1&quot;,
  &quot;agrbct_04_T1&quot;,
  &quot;agrbct_05_T1&quot;,
  &quot;agrbct_06_T1&quot;,
  &quot;agrbct_07_T1&quot;,
  &quot;agrbct_08_T1&quot;,
  &quot;agrbct_09_T1&quot;,
  &quot;agrbct_10_T1&quot;,
  &quot;frqbct_01_T1&quot;,
  &quot;frqbct_02_T1&quot;,
  &quot;frqbct_03_T1&quot;,
  &quot;frqbct_04_T1&quot;,
  &quot;frqbct_05_T1&quot;,
  &quot;frqbct_06_T1&quot;,
  &quot;frqbct_07_T1&quot;,
  &quot;frqbct_08_T1&quot;,
  &quot;frqbct_09_T1&quot;),
   targets = c(&quot;MVPA&quot;, &quot;SB&quot;),
  leftAnchors = rep(&quot;&quot;, 19),
  rightAnchors = rep(&quot;&quot;, 19))

userfriendlyscience::CIBER(data = d_num,
  determinants = c(
  &quot;autonomous_01_T1&quot;,
  &quot;autonomous_02_T1&quot;,
  &quot;autonomous_03_T1&quot;,
  &quot;autonomous_04_T1&quot;,
  &quot;autonomous_05_T1&quot;,
  &quot;autonomous_06_T1&quot;,
  &quot;autonomous_07_T1&quot;,
  &quot;autonomous_08_T1&quot;,
  &quot;autonomous_09_T1&quot;),
   targets = c(&quot;MVPA&quot;, &quot;SB&quot;),
  leftAnchors = rep(&quot;&quot;, 9),
  rightAnchors = rep(&quot;&quot;, 9))

userfriendlyscience::CIBER(data = d_num,
  determinants = c(
  &quot;intention_01_T1&quot;,
  &quot;intention_02_T1&quot;,
  &quot;selfefficacy_01_T1&quot;,
  &quot;selfefficacy_02_T1&quot;,
  &quot;pbc_01_T1&quot;,
  &quot;pbc_02_T1&quot;,
  &quot;pbc_03_T1&quot;,
  &quot;norm_01_T1&quot;,
  &quot;norm_02_T1&quot;,
  &quot;outcomeExpectations_01_T1&quot;,
  &quot;outcomeExpectations_02_T1&quot;,
  &quot;outcomeExpectations_03_T1&quot;,
  &quot;outcomeExpectations_04_T1&quot;,
  &quot;outcomeExpectations_05_T1&quot;,
  &quot;outcomeExpectations_06_T1&quot;,
  &quot;outcomeExpectations_07_T1&quot;,
  &quot;outcomeExpectations_08_T1&quot;,
  &quot;outcomeExpectations_09_T1&quot;,
  &quot;outcomeExpectations_10_T1&quot;,
  &quot;outcomeExpectations_11_T1&quot;,
  &quot;outcomeExpectations_12_T1&quot;),
   targets = c(&quot;MVPA&quot;, &quot;SB&quot;),
  leftAnchors = rep(&quot;&quot;, 21),
  rightAnchors = rep(&quot;&quot;, 21))</code></pre>
</div>
<div id="density-plots" class="section level1">
<h1>Density plots</h1>
<div id="accelerometer-measured-pa" class="section level2">
<h2>Accelerometer-measured PA</h2>
<p>Contrary to some other findings, in our sample girls were more active than boys.</p>
<pre class="r"><code>
MVPAgirl_df &lt;- df %&gt;% group_by(girl) %&gt;% select(girl, paAccelerometer_T1) %&gt;% summarise(mean = mean(paAccelerometer_T1, na.rm = TRUE), median = median(paAccelerometer_T1, na.rm = TRUE))
MVPAgirl_df[1, 2] - MVPAgirl_df[2, 2]</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["mean"],"name":[1],"type":["dbl"],"align":["right"]}],"data":[{"1":"16.81268"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<pre class="r"><code>MVPAgirl_df[1, 3] - MVPAgirl_df[2, 3]</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["median"],"name":[1],"type":["dbl"],"align":["right"]}],"data":[{"1":"24.52857"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<pre class="r"><code>
userfriendlyscience::meanDiff(df$girl, df$paAccelerometer_T1)
## Input variables:
## 
##   girl (grouping variable)
##   paAccelerometer_T1 (dependent variable)
##   Mean 1 (girl) = 190.36, sd = 48.6, n = 425
##   Mean 2 (boy)= 173.55, sd = 59.39, n = 281
## 
## Independent samples t-test (tested for equal variances, p &lt; .001, so unequal variances)
##   (standard deviation used of largest sample, 48.6)
## 
## 95% confidence intervals:
##   Absolute mean difference: [8.45, 25.17] (Absolute mean difference: 16.81)
##   Cohen&#39;s d for difference: [0.19, 0.5] (Cohen&#39;s d point estimate: 0.35)
##   Hedges g for difference:  [0.19, 0.5] (Hedges g point estimate:  0.35)
## 
## Achieved power for d=0.35: 0.9957 (for small: 0.756; medium: 1; large: 1)
## 
## (secondary information (NHST): t[516] = 3.95, p &lt; .001)
## 
## 
## NOTE: because the t-test is based on unequal variances, the NHST p-value may be inconsistent with the confidence interval. Although this is not a problem, if you wish to ensure consistency, you can use parameter &quot;var.equal = &#39;yes&#39;&quot; to force equal variances.</code></pre>
<pre class="r"><code>
colfill &lt;- c(1,2,3,4,5)

# Create data frame
densplot &lt;- d
levels(densplot$intervention) &lt;- list(&quot;Intervention&quot; = &quot;1&quot;, &quot;Control&quot; = &quot;0&quot;)
levels(densplot$girl) &lt;- list(&quot;Girl&quot; = &quot;1&quot;, &quot;Boy&quot; = &quot;0&quot;)

# This gives side-by-side plots
 layout(matrix(c(1,2,3,3), nrow = 2, ncol = 2, byrow = TRUE), heights=c(2.5, 2))

## Intervention vs. control
# Choose only the variables needed and drop NA
dens &lt;- densplot %&gt;% select(paAccelerometer_T1, intervention) %&gt;% 
  filter(complete.cases(.))

# Set random number generator for reproducibility of bootstrap test of equal densities
set.seed(10)
# Make plot
sm.paAccelerometer_T1_1 &lt;- sm.density.compare2(as.numeric(dens$paAccelerometer_T1), as.factor(dens$intervention), xlab=&quot;&quot;, col=colfill, lty=c(1,2), bandcol=&#39;LightGray&#39;, model=&quot;equal&quot;, lwd=(c(2,2)))
## 
## Test of equal densities:  p-value =  0.25
legend(&quot;topright&quot;, levels(dens$intervention), fill=c(1, 2))

## Girls vs. boys
# Choose only the variables needed and drop NA
dens &lt;- densplot %&gt;% select(paAccelerometer_T1, girl) %&gt;% 
  filter(complete.cases(.))

# Set random number generator for reproducibility of bootstrap test of equal densities
set.seed(10)
# Make plot
sm.paAccelerometer_T1_2 &lt;- sm.density.compare2(as.numeric(dens$paAccelerometer_T1), as.factor(dens$girl), xlab=&quot;&quot;, col=colfill, lty=c(1,2), bandcol=&#39;LightGray&#39;, model=&quot;equal&quot;, lwd=(c(2,2)))
## Warning in min(x): no non-missing arguments to min; returning Inf

## Warning in min(x): no non-missing arguments to min; returning Inf
## Warning in max(x): no non-missing arguments to max; returning -Inf

## Warning in max(x): no non-missing arguments to max; returning -Inf
## Warning in min(x): no non-missing arguments to min; returning Inf
## Warning in max(x): no non-missing arguments to max; returning -Inf
## Error in seq.default(opt$xlim[1], opt$xlim[2], length = opt$ngrid): &#39;from&#39; must be a finite number
legend(&quot;topright&quot;, levels(dens$girl), fill=c(1, 2))

## Differences in schools
# Choose only the variables needed and drop NA
dens &lt;- densplot %&gt;% select(paAccelerometer_T1, school) %&gt;% 
  filter(complete.cases(.))

# Set random number generator for reproducibility of bootstrap test of equal densities
set.seed(10)

# Intervention groups with solid thicker lines
linetypes &lt;- c(1,2,2,1,2)

# Make plot
sm.paAccelerometer_T1_3 &lt;- sm::sm.density.compare(as.numeric(dens$paAccelerometer_T1), dens$school, xlab=&quot;&quot;, col=colfill, lty=linetypes, model=&quot;none&quot;)
legend(&quot;topright&quot;, c(&quot;Intervention school&quot;, &quot;Control school&quot;), col = c(4, 3), lty = c(1, 2), lwd = c(2, 2))</code></pre>
<p><img src="baseline-supplement_files/figure-html/unnamed-chunk-30-1.png" width="2100" /></p>
</div>
<div id="time-spent-sitting-and-lying-down" class="section level2">
<h2>Time spent sitting and lying down</h2>
<pre class="r"><code>
colfill &lt;- c(1,2,3,4,5)

# Create data frame
densplot &lt;- d
levels(densplot$intervention) &lt;- list(&quot;Intervention&quot; = &quot;1&quot;, &quot;Control&quot; = &quot;0&quot;)
levels(densplot$girl) &lt;- list(&quot;Girl&quot; = &quot;1&quot;, &quot;Boy&quot; = &quot;0&quot;)

# This gives side-by-side plots
 layout(matrix(c(1,2,3,3), nrow = 2, ncol = 2, byrow = TRUE), heights=c(2.5, 2))

## Intervention vs. control
# Choose only the variables needed and drop NA
dens &lt;- densplot %&gt;% select(sitLieAccelerometer_T1, intervention) %&gt;% 
  filter(complete.cases(.))

# Set random number generator for reproducibility of bootstrap test of equal densities
set.seed(10)

# Make plot
sm.sitLieAccelerometer_T1_1 &lt;- sm.density.compare2(as.numeric(dens$sitLieAccelerometer_T1), as.factor(dens$intervention), xlab=&quot;&quot;, col=colfill, lty=c(1,2), bandcol=&#39;LightGray&#39;, model=&quot;equal&quot;, lwd=(c(2,2)))
## 
## Test of equal densities:  p-value =  0.09
legend(&quot;topright&quot;, levels(dens$intervention), fill=c(1, 2))

## Girls vs. boys
# Choose only the variables needed and drop NA
dens &lt;- densplot %&gt;% select(sitLieAccelerometer_T1, girl) %&gt;% 
  filter(complete.cases(.))

# Set random number generator for reproducibility of bootstrap test of equal densities
set.seed(10)

# Make plot
sm.sitLieAccelerometer_T1_2 &lt;- sm.density.compare2(as.numeric(dens$sitLieAccelerometer_T1), as.factor(dens$girl), xlab=&quot;&quot;, col=colfill, lty=c(1,2), bandcol=&#39;LightGray&#39;, model=&quot;equal&quot;, lwd=(c(2,2)))
## Warning in min(x): no non-missing arguments to min; returning Inf

## Warning in min(x): no non-missing arguments to min; returning Inf
## Warning in max(x): no non-missing arguments to max; returning -Inf

## Warning in max(x): no non-missing arguments to max; returning -Inf
## Warning in min(x): no non-missing arguments to min; returning Inf
## Warning in max(x): no non-missing arguments to max; returning -Inf
## Error in seq.default(opt$xlim[1], opt$xlim[2], length = opt$ngrid): &#39;from&#39; must be a finite number
legend(&quot;topright&quot;, levels(dens$girl), fill=c(1, 2))

## Differences in schools
# Choose only the variables needed and drop NA
dens &lt;- densplot %&gt;% select(sitLieAccelerometer_T1, school) %&gt;% 
  filter(complete.cases(.))

# Set random number generator for reproducibility of bootstrap test of equal densities
set.seed(10)

# Intervention groups with solid thicker lines
linetypes &lt;- c(1,2,2,1,2)

# Make plot
sm.sitLieAccelerometer_T1_3 &lt;- sm::sm.density.compare(as.numeric(dens$sitLieAccelerometer_T1), dens$school, xlab=&quot;&quot;, col=colfill, lty=linetypes, model=&quot;none&quot;)
legend(&quot;topright&quot;, c(&quot;Intervention school&quot;, &quot;Control school&quot;), col = c(4, 3), lty = c(1, 2), lwd = c(2, 2))</code></pre>
<p><img src="baseline-supplement_files/figure-html/unnamed-chunk-31-1.png" width="2100" /></p>
</div>
</div>
<div id="symptoms" class="section level1">
<h1>Symptoms</h1>
<pre class="r"><code>
colfill &lt;- c(1,2,3,4,5)

# Create data frame
densplot &lt;- df
levels(densplot$intervention) &lt;- list(&quot;Intervention&quot; = &quot;1&quot;, &quot;Control&quot; = &quot;0&quot;)
levels(densplot$girl) &lt;- list(&quot;Girl&quot; = &quot;1&quot;, &quot;Boy&quot; = &quot;0&quot;)

# This gives side-by-side plots
 layout(matrix(c(1,2,3,3), nrow = 2, ncol = 2, byrow = TRUE), heights=c(2.5, 2))

## Intervention vs. control
# Choose only the variables needed and drop NA
dens &lt;- densplot %&gt;% select(symptom_T1, intervention) %&gt;% na.omit(densplot)

# Set random number generator for reproducibility of bootstrap test of equal densities
set.seed(10)

# Make plot
sm.symptom_T1_1 &lt;- sm.density.compare2(as.numeric(dens$symptom_T1), as.factor(dens$intervention), xlab=&quot;&quot;, col=colfill, lty=c(1,2), bandcol=&#39;LightGray&#39;, model=&quot;equal&quot;, lwd=(c(2,2)))
## 
## Test of equal densities:  p-value =  0.59
legend(&quot;topright&quot;, levels(dens$intervention), fill=c(1, 2))

## Girls vs. boys
# Choose only the variables needed and drop NA
dens &lt;- densplot %&gt;% select(symptom_T1, girl)  %&gt;% na.omit(densplot)

# Set random number generator for reproducibility of bootstrap test of equal densities
set.seed(10)

# Make plot
sm.symptom_T1_2 &lt;- sm.density.compare2(as.numeric(dens$symptom_T1), as.factor(dens$girl), xlab=&quot;&quot;, col=colfill, lty=c(1,2), bandcol=&#39;LightGray&#39;, model=&quot;equal&quot;, lwd=(c(2,2)))
## Warning in min(x): no non-missing arguments to min; returning Inf

## Warning in min(x): no non-missing arguments to min; returning Inf
## Warning in max(x): no non-missing arguments to max; returning -Inf

## Warning in max(x): no non-missing arguments to max; returning -Inf
## Warning in min(x): no non-missing arguments to min; returning Inf
## Warning in max(x): no non-missing arguments to max; returning -Inf
## Error in seq.default(opt$xlim[1], opt$xlim[2], length = opt$ngrid): &#39;from&#39; must be a finite number
legend(&quot;topright&quot;, levels(dens$girl), fill=c(1, 2))

## Differences in schools
# Choose only the variables needed and drop NA
dens &lt;- densplot %&gt;% select(&quot;Symptom sum score&quot; = symptom_T1, school) %&gt;% na.omit(densplot)

# Set random number generator for reproducibility of bootstrap test of equal densities
set.seed(10)

# Intervention groups with solid thicker lines
linetypes &lt;- c(1,2,2,1,2)
linewidths &lt;- c(2,1,1,2,1)

# Make plot
sm.symptom_T1_3 &lt;- sm::sm.density.compare(dens$`Symptom sum score`, dens$school, xlab=&quot;&quot;, col=colfill, lty=linetypes, model=&quot;equal&quot;, lwd=linewidths)
## Reference band available to compare two groups only.
## 
## Test of equal densities:  p-value =  0
xlab = &quot;&quot;
</code></pre>
<p><img src="baseline-supplement_files/figure-html/unnamed-chunk-32-1.png" width="2100" /></p>
<div id="symptom-histograms" class="section level2">
<h2>Symptom histograms</h2>
<div id="intervention-gender" class="section level3">
<h3>intervention / gender</h3>
<pre class="r"><code>
sympGirls &lt;- df %&gt;% dplyr::select(id,
  intervention,
  group,
  school,
  girl,
  &quot;Neck and shoulder pain&quot; = symptom_neckShoulderPain_T1,
  &quot;Lower back pain&quot; = symptom_lowerBackPain_T1,
  &quot;Stomach ache&quot; = symptom_stomachAche_T1,
  &quot;Tension or nervousness&quot; = symptom_tensionNervousness_T1,
  &quot;Irritability or anger bursts&quot; = symptom_irritabilityAngerbursts_T1,
  &quot;Difficulty with sleep&quot; = symptom_sleepDifficulty_T1,
  &quot;Headache&quot; = symptom_headAche_T1,
  &quot;Tiredness or faintness&quot; = symptom_tirednessFaintness_T1) %&gt;%
 tidyr::gather(key = Variable, value = Value, 6:ncol(.)) %&gt;%
  filter(girl == &quot;1&quot;) %&gt;% 
 ggplot(aes(x = Value, y = Variable, group = Variable)) +
  ggridges::geom_density_ridges2(aes(fill = Variable), stat = &quot;binline&quot;, binwidth = 1, scale = 0.95) +
  scale_x_continuous(breaks = c(1:4), expand = c(0, 0),
                     name = &quot;&quot;) +
  scale_y_discrete(expand = c(0.01, 0), name = &quot;&quot;, labels = NULL) +
  ggridges::scale_fill_cyclical(values = c(&quot;darkolivegreen2&quot;, &quot;darkolivegreen4&quot;)) +
  labs(title = &quot;Girls&quot;) +
  guides(y = &quot;none&quot;) +
  ggridges::theme_ridges(grid = FALSE) +
  theme(axis.title.x = element_text(hjust = 0.5),
        axis.title.y = element_text(hjust = 0.5),
        plot.title = element_text(hjust = 0.5, size = 10),
        axis.text=element_text(size=10, face=&quot;bold&quot;)) +
coord_cartesian(xlim = c(0.5, 4.5))
## Warning: attributes are not identical across measure variables;
## they will be dropped

sympBoys &lt;- df %&gt;% dplyr::select(id,
  intervention,
  group,
  school,
  girl,
  &quot;Neck and shoulder pain&quot; = symptom_neckShoulderPain_T1,
  &quot;Lower back pain&quot; = symptom_lowerBackPain_T1,
  &quot;Stomach ache&quot; = symptom_stomachAche_T1,
  &quot;Tension or nervousness&quot; = symptom_tensionNervousness_T1,
  &quot;Irritability or anger bursts&quot; = symptom_irritabilityAngerbursts_T1,
  &quot;Difficulty with sleep&quot; = symptom_sleepDifficulty_T1,
  &quot;Headache&quot; = symptom_headAche_T1,
  &quot;Tiredness or faintness&quot; = symptom_tirednessFaintness_T1) %&gt;%
 tidyr::gather(key = Variable, value = Value, 6:ncol(.)) %&gt;%
  filter(girl == &quot;0&quot;) %&gt;% 
 ggplot(aes(x = Value, y = Variable, group = Variable)) +
  ggridges::geom_density_ridges2(aes(fill = Variable), stat = &quot;binline&quot;, binwidth = 1, scale = 0.95) +
  scale_x_continuous(breaks = c(1:4), expand = c(0, 0),
                     name = &quot;&quot;) +
  scale_y_discrete(expand = c(0.01, 0), name = &quot;&quot;, labels = NULL) +
  ggridges::scale_fill_cyclical(values = c(&quot;darkolivegreen2&quot;, &quot;darkolivegreen4&quot;)) +
  labs(title = &quot;Boys&quot;) +
  guides(y = &quot;none&quot;) +
  ggridges::theme_ridges(grid = FALSE) +
  theme(axis.title.x = element_text(hjust = 0.5),
        axis.title.y = element_text(hjust = 0.5),
        plot.title = element_text(hjust = 0.5, size = 10),
        axis.text=element_text(size=10, face=&quot;bold&quot;)) +
coord_cartesian(xlim = c(0.5, 4.5))
## Warning: attributes are not identical across measure variables;
## they will be dropped

sympInt &lt;- df %&gt;% dplyr::select(id,
  intervention,
  group,
  school,
  girl,
  &quot;Neck and shoulder pain&quot; = symptom_neckShoulderPain_T1,
  &quot;Lower back pain&quot; = symptom_lowerBackPain_T1,
  &quot;Stomach ache&quot; = symptom_stomachAche_T1,
  &quot;Tension or nervousness&quot; = symptom_tensionNervousness_T1,
  &quot;Irritability or anger bursts&quot; = symptom_irritabilityAngerbursts_T1,
  &quot;Difficulty with sleep&quot; = symptom_sleepDifficulty_T1,
  &quot;Headache&quot; = symptom_headAche_T1,
  &quot;Tiredness or faintness&quot; = symptom_tirednessFaintness_T1) %&gt;%
 tidyr::gather(key = Variable, value = Value, 6:ncol(.)) %&gt;%
  filter(intervention == &quot;1&quot;) %&gt;% 
 ggplot(aes(x = Value, y = Variable, group = Variable)) +
  ggridges::geom_density_ridges2(aes(fill = Variable), stat = &quot;binline&quot;, binwidth = 1, scale = 0.95) +
  scale_x_continuous(breaks = c(1:4), expand = c(0, 0),
                     name = &quot;&quot;) +
  scale_y_discrete(expand = c(0.01, 0), name = &quot;&quot;) +
  ggridges::scale_fill_cyclical(values = c(&quot;deepskyblue&quot;, &quot;deepskyblue4&quot;)) +
  labs(title = &quot;Intervention&quot;) +
  guides(y = &quot;none&quot;) +
  ggridges::theme_ridges(grid = FALSE) +
  theme(axis.title.x = element_text(hjust = 0.5),
        axis.title.y = element_text(hjust = 0.5),
        plot.title = element_text(hjust = 0.5, size = 10),
        axis.text=element_text(size=10)) +
coord_cartesian(xlim = c(0.5, 4.5))
## Warning: attributes are not identical across measure variables;
## they will be dropped

sympCont &lt;- df %&gt;% dplyr::select(id,
  intervention,
  group,
  school,
  girl,
  &quot;Neck and shoulder pain&quot; = symptom_neckShoulderPain_T1,
  &quot;Lower back pain&quot; = symptom_lowerBackPain_T1,
  &quot;Stomach ache&quot; = symptom_stomachAche_T1,
  &quot;Tension or nervousness&quot; = symptom_tensionNervousness_T1,
  &quot;Irritability or anger bursts&quot; = symptom_irritabilityAngerbursts_T1,
  &quot;Difficulty with sleep&quot; = symptom_sleepDifficulty_T1,
  &quot;Headache&quot; = symptom_headAche_T1,
  &quot;Tiredness or faintness&quot; = symptom_tirednessFaintness_T1) %&gt;%
 tidyr::gather(key = Variable, value = Value, 6:ncol(.)) %&gt;%
  filter(intervention == &quot;0&quot;) %&gt;% 
 ggplot(aes(x = Value, y = Variable, group = Variable)) +
  ggridges::geom_density_ridges2(aes(fill = Variable), stat = &quot;binline&quot;, binwidth = 1, scale = 0.95) +
  scale_x_continuous(breaks = c(1:4), expand = c(0, 0),
                     name = &quot;&quot;) +
  scale_y_discrete(expand = c(0.01, 0), name = &quot;&quot;, labels = NULL) +
  ggridges::scale_fill_cyclical(values = c(&quot;deepskyblue&quot;, &quot;deepskyblue4&quot;)) +
  labs(title = &quot;Control&quot;) +
  guides(y = &quot;none&quot;) +
  ggridges::theme_ridges(grid = FALSE) +
  theme(axis.title.x = element_text(hjust = 0.5),
        axis.title.y = element_text(hjust = 0.5),
        plot.title = element_text(hjust = 0.5, size = 10),
        axis.text=element_text(size=10, face=&quot;bold&quot;)) +
coord_cartesian(xlim = c(0.5, 4.5))
## Warning: attributes are not identical across measure variables;
## they will be dropped

#grid.arrange(sympInt, sympGirls, sympCont, sympBoys, ncol = 2)

# (&quot;Seldom or never&quot;, &quot;About once a month&quot;, &quot;About once a week&quot;, &quot;Almost daily&quot;)

# This draws all histograms next to each other:
grid::grid.newpage()
grid::grid.draw(cbind(ggplotGrob(sympInt), ggplotGrob(sympCont), ggplotGrob(sympGirls), ggplotGrob(sympBoys), size = &quot;last&quot;))
## Warning: Removed 198 rows containing non-finite values (stat_binline).
## Warning: Removed 93 rows containing non-finite values (stat_binline).</code></pre>
<p><img src="baseline-supplement_files/figure-html/unnamed-chunk-33-1.png" width="2100" /></p>
<pre class="r"><code>
# This draws 2 histograms per row:
#grid.newpage()
#grid.draw(rbind(cbind(ggplotGrob(sympInt), ggplotGrob(sympCont), size = &quot;last&quot;), cbind(ggplotGrob(sympGirls), ggplotGrob(sympBoys), size = &quot;last&quot;)))
</code></pre>
</div>
<div id="educational-track" class="section level3">
<h3>educational track</h3>
<pre class="r"><code>
sympHRC &lt;- df %&gt;% dplyr::select(id,
  intervention,
  track,
  school,
  girl,
  &quot;Neck and shoulder pain&quot; = symptom_neckShoulderPain_T1,
  &quot;Lower back pain&quot; = symptom_lowerBackPain_T1,
  &quot;Stomach ache&quot; = symptom_stomachAche_T1,
  &quot;Tension or nervousness&quot; = symptom_tensionNervousness_T1,
  &quot;Irritability or anger bursts&quot; = symptom_irritabilityAngerbursts_T1,
  &quot;Difficulty with sleep&quot; = symptom_sleepDifficulty_T1,
  &quot;Headache&quot; = symptom_headAche_T1,
  &quot;Tiredness or faintness&quot; = symptom_tirednessFaintness_T1) %&gt;%
 tidyr::gather(key = Variable, value = Value, 6:ncol(.)) %&gt;%
  filter(track == &quot;HRC&quot;) %&gt;% 
 ggplot(aes(x = Value, y = Variable, group = Variable)) +
  ggridges::geom_density_ridges2(aes(fill = Variable), stat = &quot;binline&quot;, binwidth = 1, scale = 0.95) +
  scale_x_continuous(breaks = c(1:4), expand = c(0, 0),
                     name = &quot;&quot;) +
  scale_y_discrete(expand = c(0.01, 0), name = &quot;&quot;, labels = NULL) +
  ggridges::scale_fill_cyclical(values = c(&quot;darkolivegreen2&quot;, &quot;darkolivegreen4&quot;)) +
  labs(title = &quot;HRC&quot;) +
  guides(y = &quot;none&quot;) +
  ggridges::theme_ridges(grid = FALSE) +
  theme(axis.title.x = element_text(hjust = 0.5),
        axis.title.y = element_text(hjust = 0.5),
        plot.title = element_text(hjust = 0.5, size = 10),
        axis.text=element_text(size=10, face=&quot;bold&quot;)) +
coord_cartesian(xlim = c(0.5, 4.5))
## Warning: attributes are not identical across measure variables;
## they will be dropped

sympNursing &lt;- df %&gt;% dplyr::select(id,
  intervention,
  track,
  school,
  girl,
  &quot;Neck and shoulder pain&quot; = symptom_neckShoulderPain_T1,
  &quot;Lower back pain&quot; = symptom_lowerBackPain_T1,
  &quot;Stomach ache&quot; = symptom_stomachAche_T1,
  &quot;Tension or nervousness&quot; = symptom_tensionNervousness_T1,
  &quot;Irritability or anger bursts&quot; = symptom_irritabilityAngerbursts_T1,
  &quot;Difficulty with sleep&quot; = symptom_sleepDifficulty_T1,
  &quot;Headache&quot; = symptom_headAche_T1,
  &quot;Tiredness or faintness&quot; = symptom_tirednessFaintness_T1) %&gt;%
 tidyr::gather(key = Variable, value = Value, 6:ncol(.)) %&gt;%
  filter(track == &quot;Nursing&quot;) %&gt;% 
 ggplot(aes(x = Value, y = Variable, group = Variable)) +
  ggridges::geom_density_ridges2(aes(fill = Variable), stat = &quot;binline&quot;, binwidth = 1, scale = 0.95) +
  scale_x_continuous(breaks = c(1:4), expand = c(0, 0),
                     name = &quot;&quot;) +
  scale_y_discrete(expand = c(0.01, 0), name = &quot;&quot;, labels = NULL) +
  ggridges::scale_fill_cyclical(values = c(&quot;darkolivegreen2&quot;, &quot;darkolivegreen4&quot;)) +
  labs(title = &quot;Nursing&quot;) +
  guides(y = &quot;none&quot;) +
  ggridges::theme_ridges(grid = FALSE) +
  theme(axis.title.x = element_text(hjust = 0.5),
        axis.title.y = element_text(hjust = 0.5),
        plot.title = element_text(hjust = 0.5, size = 10),
        axis.text=element_text(size=10, face=&quot;bold&quot;)) +
coord_cartesian(xlim = c(0.5, 4.5))
## Warning: attributes are not identical across measure variables;
## they will be dropped

sympIT &lt;- df %&gt;% dplyr::select(id,
  intervention,
  track,
  school,
  girl,
  &quot;Neck and shoulder pain&quot; = symptom_neckShoulderPain_T1,
  &quot;Lower back pain&quot; = symptom_lowerBackPain_T1,
  &quot;Stomach ache&quot; = symptom_stomachAche_T1,
  &quot;Tension or nervousness&quot; = symptom_tensionNervousness_T1,
  &quot;Irritability or anger bursts&quot; = symptom_irritabilityAngerbursts_T1,
  &quot;Difficulty with sleep&quot; = symptom_sleepDifficulty_T1,
  &quot;Headache&quot; = symptom_headAche_T1,
  &quot;Tiredness or faintness&quot; = symptom_tirednessFaintness_T1) %&gt;%
 tidyr::gather(key = Variable, value = Value, 6:ncol(.)) %&gt;%
  filter(track == &quot;Business IT&quot;) %&gt;% 
 ggplot(aes(x = Value, y = Variable, group = Variable)) +
  ggridges::geom_density_ridges2(aes(fill = Variable), stat = &quot;binline&quot;, binwidth = 1, scale = 0.95) +
  scale_x_continuous(breaks = c(1:4), expand = c(0, 0),
                     name = &quot;&quot;) +
  scale_y_discrete(expand = c(0.01, 0), name = &quot;&quot;) +
  ggridges::scale_fill_cyclical(values = c(&quot;deepskyblue&quot;, &quot;deepskyblue4&quot;)) +
  labs(title = &quot;Business IT&quot;) +
  guides(y = &quot;none&quot;) +
  ggridges::theme_ridges(grid = FALSE) +
  theme(axis.title.x = element_text(hjust = 0.5),
        axis.title.y = element_text(hjust = 0.5),
        plot.title = element_text(hjust = 0.5, size = 10),
        axis.text=element_text(size=10)) +
coord_cartesian(xlim = c(0.5, 4.5))
## Warning: attributes are not identical across measure variables;
## they will be dropped

sympBA &lt;- df %&gt;% dplyr::select(id,
  intervention,
  track,
  school,
  girl,
  &quot;Neck and shoulder pain&quot; = symptom_neckShoulderPain_T1,
  &quot;Lower back pain&quot; = symptom_lowerBackPain_T1,
  &quot;Stomach ache&quot; = symptom_stomachAche_T1,
  &quot;Tension or nervousness&quot; = symptom_tensionNervousness_T1,
  &quot;Irritability or anger bursts&quot; = symptom_irritabilityAngerbursts_T1,
  &quot;Difficulty with sleep&quot; = symptom_sleepDifficulty_T1,
  &quot;Headache&quot; = symptom_headAche_T1,
  &quot;Tiredness or faintness&quot; = symptom_tirednessFaintness_T1) %&gt;%
 tidyr::gather(key = Variable, value = Value, 6:ncol(.)) %&gt;%
  filter(track == &quot;Business Admin&quot;) %&gt;% 
 ggplot(aes(x = Value, y = Variable, group = Variable)) +
  ggridges::geom_density_ridges2(aes(fill = Variable), stat = &quot;binline&quot;, binwidth = 1, scale = 0.95) +
  scale_x_continuous(breaks = c(1:4), expand = c(0, 0),
                     name = &quot;&quot;) +
  scale_y_discrete(expand = c(0.01, 0), name = &quot;&quot;, labels = NULL) +
  ggridges::scale_fill_cyclical(values = c(&quot;deepskyblue&quot;, &quot;deepskyblue4&quot;)) +
  labs(title = &quot;Business Admin&quot;) +
  guides(y = &quot;none&quot;) +
  ggridges::theme_ridges(grid = FALSE) +
  theme(axis.title.x = element_text(hjust = 0.5),
        axis.title.y = element_text(hjust = 0.5),
        plot.title = element_text(hjust = 0.5, size = 10),
        axis.text=element_text(size=10, face=&quot;bold&quot;)) +
coord_cartesian(xlim = c(0.5, 4.5))
## Warning: attributes are not identical across measure variables;
## they will be dropped

#grid.arrange(sympIT, sympHRC, sympBA, sympNursing, ncol = 2)

# (&quot;Seldom or never&quot;, &quot;About once a month&quot;, &quot;About once a week&quot;, &quot;Almost daily&quot;)

# This draws all histograms next to each other:
grid::grid.newpage()
grid::grid.draw(cbind(ggplotGrob(sympIT), ggplotGrob(sympBA), ggplotGrob(sympHRC), ggplotGrob(sympNursing), size = &quot;last&quot;))
## Warning: Removed 26 rows containing non-finite values (stat_binline).
## Warning: Removed 49 rows containing non-finite values (stat_binline).

## Warning: Removed 49 rows containing non-finite values (stat_binline).
## Warning: Removed 141 rows containing non-finite values (stat_binline).</code></pre>
<p><img src="baseline-supplement_files/figure-html/unnamed-chunk-34-1.png" width="2100" /></p>
<pre class="r"><code>
# This draws 2 histograms per row:
#grid.newpage()
#grid.draw(rbind(cbind(ggplotGrob(sympIT), ggplotGrob(sympBA), size = &quot;last&quot;), cbind(ggplotGrob(sympHRC), ggplotGrob(sympNursing), size = &quot;last&quot;)))
</code></pre>
</div>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
