<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title>Network analyses</title>

<script src="site_libs/jquery-1.12.4/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<script src="site_libs/htmlwidgets-1.2/htmlwidgets.js"></script>
<link href="site_libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="site_libs/datatables-binding-0.4/datatables.js"></script>
<link href="site_libs/dt-core-1.10.16/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="site_libs/dt-core-1.10.16/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="site_libs/dt-core-1.10.16/js/jquery.dataTables.min.js"></script>
<link href="site_libs/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
<script src="site_libs/crosstalk-1.0.0/js/crosstalk.min.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; background-color: #f8f8f8; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
pre, code { background-color: #f8f8f8; }
code > span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code > span.dt { color: #204a87; } /* DataType */
code > span.dv { color: #0000cf; } /* DecVal */
code > span.bn { color: #0000cf; } /* BaseN */
code > span.fl { color: #0000cf; } /* Float */
code > span.ch { color: #4e9a06; } /* Char */
code > span.st { color: #4e9a06; } /* String */
code > span.co { color: #8f5902; font-style: italic; } /* Comment */
code > span.ot { color: #8f5902; } /* Other */
code > span.al { color: #ef2929; } /* Alert */
code > span.fu { color: #000000; } /* Function */
code > span.er { color: #a40000; font-weight: bold; } /* Error */
code > span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #000000; } /* Constant */
code > span.sc { color: #000000; } /* SpecialChar */
code > span.vs { color: #4e9a06; } /* VerbatimString */
code > span.ss { color: #4e9a06; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #000000; } /* Variable */
code > span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code > span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code > span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code > span.ex { } /* Extension */
code > span.at { color: #c4a000; } /* Attribute */
code > span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code > span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
div.sourceCode {
  overflow-x: visible;
}
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>


</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 66px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 71px;
  margin-top: -71px;
}

.section h2 {
  padding-top: 71px;
  margin-top: -71px;
}
.section h3 {
  padding-top: 71px;
  margin-top: -71px;
}
.section h4 {
  padding-top: 71px;
  margin-top: -71px;
}
.section h5 {
  padding-top: 71px;
  margin-top: -71px;
}
.section h6 {
  padding-top: 71px;
  margin-top: -71px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>




<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
  padding-left: 25px;
  text-indent: 0;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>

<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Visualising baseline characteristics</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">About</a>
</li>
<li>
  <a href="baseline-manuscript.html">Manuscript</a>
</li>
<li>
  <a href="baseline-tables.html">Descriptive tables</a>
</li>
<li>
  <a href="baseline-supplement.html">Descriptive plots</a>
</li>
<li>
  <a href="baseline-networks.html">Networks &amp; correlations</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">

<div class="btn-group pull-right">
<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Network analyses</h1>

</div>


<p>This section describes network analyses and displays correlation structures in the data. Here, physical activity (PA) is used interchangeably with moderate-to-vigorous physical activity (MVPA); all measures of activity relate to MVPA.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">source</span>(<span class="st">&quot;baseline-datasetup.R&quot;</span>)</code></pre></div>
<p>Clicking the “Code”-buttons on the right shows code for each chunk. <span class="math inline">\(~\)</span> <span class="math inline">\(~\)</span> <a id="network"></a></p>
<div id="network-featured-in-manuscript" class="section level1 tabset">
<h1>Network featured in manuscript</h1>
<div id="network" class="section level2">
<h2>Network</h2>
<p>All BCTs are shown here separately; exceptions: mnemonic cues which seems quite unclear a question, as well as and failure contemplation, which only concerns those who have not reached their goals (for which an option on the scale was given, making it differ from the other BCTs).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">bctdf_mgm_T1 &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(
<span class="co">#  id,</span>
<span class="co">#  intervention,</span>
<span class="co">#  group,</span>
<span class="co">#  school,</span>
<span class="co">#  girl,</span>
  <span class="st">&#39;goal setting&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_01_T1,
  <span class="st">&#39;implementation plan&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_02_T1,
  <span class="st">&#39;plan by other&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_03_T1,
  <span class="st">&#39;reminder of plan&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_04_T1,
  <span class="st">&#39;subgoals&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_05_T1,
  <span class="st">&#39;new PA options&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_06_T1,
  <span class="st">&#39;barrier identification&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_07_T1,
  <span class="st">&#39;coping planning&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_08_T1,
  <span class="st">&#39;PA identity&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_09_T1,
  <span class="st">&#39;PA life values&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_10_T1,
  <span class="st">&#39;positive consequences&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_01_T1,
  <span class="st">&#39;log on paper&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_02_T1,
  <span class="st">&#39;smartphone&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_03_T1,
<span class="co">#  &#39;mnemonic cues&#39; = PA_frequencyDependentBCT_04_T1, # Issues with clarity of item wording </span>
  <span class="st">&#39;goal contrast&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_05_T1,
  <span class="st">&#39;relevance of PA&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_06_T1,
  <span class="st">&#39;changes at home&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_07_T1,
  <span class="st">&#39;social support&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_08_T1,
  <span class="st">&#39;failure contemplation&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_09_T1,
  <span class="st">&#39;MVPA survey&#39;</span> =<span class="st"> </span>padaysLastweek_T1,
  <span class="st">&#39;MVPA accelerometer&#39;</span> =<span class="st"> </span>mvpaAccelerometer_T1,
  <span class="st">&#39;intrinsic&#39;</span> =<span class="st"> </span>PA_intrinsic_T1,
  <span class="st">&#39;identified&#39;</span> =<span class="st"> </span>PA_identified_T1, <span class="st">&#39;integrated&#39;</span> =<span class="st"> </span>PA_integrated_T1,
  <span class="st">&#39;controlled motivation&#39;</span> =<span class="st"> </span>PA_controlled_T1) <span class="op">%&gt;%</span>
<span class="st"> </span><span class="kw">rowwise</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st"> </span><span class="kw">mutate</span>(
  <span class="st">&#39;goal setting&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">goal setting</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
<span class="co">#  &#39;has plan&#39; = ifelse(`implementation plan` == 1 &amp; `plan by other` == 1, 0, 1),</span>
  <span class="st">&#39;implementation plan&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">implementation plan</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
  <span class="st">&#39;plan by other&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">plan by other</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
  <span class="st">&#39;reminder of plan&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">reminder of plan</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
  <span class="st">&#39;subgoals&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">subgoals</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
  <span class="st">&#39;new PA options&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">new PA options</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
  <span class="st">&#39;barrier identification&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">barrier identification</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
  <span class="st">&#39;coping planning&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">coping planning</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
  <span class="co"># &#39;barriers identified or planned for&#39; = ifelse(`coping planning` == 1 &amp; `barrier identification` == 1, 0, 1),</span>
  <span class="st">&#39;PA identity&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">PA identity</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
  <span class="st">&#39;PA life values&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">PA life values</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
  <span class="co"># &#39;identity, life values&#39; = ifelse(`PA identity` == 1 &amp; `PA life values` == 1, 0, 1),</span>
  <span class="st">&#39;positive consequences&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">positive consequences</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
  <span class="st">&#39;monitoring PA&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">log on paper</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span> <span class="op">&amp;</span><span class="st"> `</span><span class="dt">smartphone</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
<span class="co">#  &#39;mnemonic cues&#39; = ifelse(`mnemonic cues` == 1, 0, 1),</span>
  <span class="st">&#39;goal contrast&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">goal contrast</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
  <span class="st">&#39;relevance of PA&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">relevance of PA</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
  <span class="st">&#39;changes at home&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">changes at home</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
  <span class="st">&#39;social support&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">social support</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
  <span class="st">&#39;failure contemplation&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">failure contemplation</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
  <span class="st">&#39;autonomous motivation&#39;</span> =<span class="st"> </span><span class="kw">mean</span>(<span class="kw">c</span>(identified, intrinsic, integrated), <span class="dt">na.rm =</span> T),
<span class="co">#  &#39;girl&#39; = ifelse(girl == &quot;girl&quot;, 1, 0),</span>
  <span class="st">&#39;controlled motivation&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">controlled motivation</span><span class="st">`</span> <span class="op">&lt;</span><span class="st"> </span><span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">1</span>)) <span class="op">%&gt;%</span><span class="st">  </span><span class="co"># If &quot;at least partly&quot; or more true, input 1. Normality otherwise a problem. </span>
<span class="co">#  &#39;intervention&#39; = ifelse(intervention == &quot;1&quot;, 1, 0)) %&gt;% </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span><span class="st">`</span><span class="dt">log on paper</span><span class="st">`</span>, <span class="op">-</span><span class="st">`</span><span class="dt">smartphone</span><span class="st">`</span>, 
                <span class="co"># -`plan by other`, -`implementation plan`, </span>
                <span class="op">-</span>identified, <span class="op">-</span>intrinsic, <span class="op">-</span>integrated,
         <span class="op">-</span><span class="st">`</span><span class="dt">failure contemplation</span><span class="st">`</span> <span class="co"># only concerns those who haven&#39;t reached goals</span>
         <span class="co"># -`barrier identification`, -`coping planning`, # closely related</span>
           ) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="co">#  dplyr::select(-controlled) %&gt;% # Not really gaussian at all </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="st">&#39;MVPA survey&#39;</span>, <span class="st">&#39;MVPA accelerometer&#39;</span>, <span class="kw">everything</span>())

bctdf_mgm_T1<span class="op">$</span><span class="st">`</span><span class="dt">autonomous motivation</span><span class="st">`</span>[<span class="kw">is.nan</span>(bctdf_mgm_T1<span class="op">$</span><span class="st">`</span><span class="dt">autonomous motivation</span><span class="st">`</span>)] &lt;-<span class="st"> </span><span class="ot">NA</span>

labs &lt;-<span class="st"> </span><span class="kw">names</span>(bctdf_mgm_T1)

<span class="co"># mgm wants full data, see package missForest for imputation methods</span>
bctdf_mgm_T1 &lt;-<span class="st"> </span>bctdf_mgm_T1 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">na.omit</span>(.)
<span class="co"># bctdf_mgm %&gt;% names()</span>
mgm_variable_types &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;g&quot;</span>, <span class="st">&quot;g&quot;</span>, <span class="kw">rep</span>(<span class="st">&quot;c&quot;</span>, <span class="dv">17</span>), <span class="st">&quot;g&quot;</span>)
mgm_variable_levels &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;1&quot;</span>, <span class="st">&quot;1&quot;</span>, <span class="kw">rep</span>(<span class="st">&quot;2&quot;</span>, <span class="dv">17</span>), <span class="st">&quot;1&quot;</span>)
<span class="co"># data.frame(mgm_variable_types, mgm_variable_levels, names(bctdf_mgm))</span>

mgm_obj_T1 &lt;-<span class="st"> </span>mgm<span class="op">::</span><span class="kw">mgm</span>(<span class="dt">data =</span> bctdf_mgm_T1,
  <span class="dt">type =</span> mgm_variable_types,
  <span class="dt">level =</span> mgm_variable_levels,
  <span class="dt">lambdaSel =</span> <span class="st">&quot;EBIC&quot;</span>,
  <span class="co"># lambdaFolds = 10,</span>
  <span class="dt">pbar =</span> <span class="ot">FALSE</span>, 
  <span class="dt">binarySign =</span> <span class="ot">TRUE</span>)
## Note that the sign of parameter estimates is stored separately; see ?mgm

<span class="co"># Node pies:</span>
pies_T1 &lt;-<span class="st"> </span>bctdf_mgm_T1 <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">summarise_all</span>(<span class="op">~</span><span class="kw">mean</span>(., <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)) <span class="co"># results in a series of means, which is ok for dichotomous vars</span>
pies_T1[<span class="dv">1</span>] &lt;-<span class="st"> </span>pies_T1[<span class="dv">1</span>] <span class="op">/</span><span class="st"> </span><span class="dv">7</span>
pies_T1[<span class="dv">2</span>] &lt;-<span class="st"> </span>pies_T1[<span class="dv">2</span>] <span class="op">/</span><span class="st"> </span><span class="kw">max</span>(bctdf_mgm_T1<span class="op">$</span><span class="st">`</span><span class="dt">MVPA accelerometer</span><span class="st">`</span>, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)
pies_T1[<span class="dv">20</span>] &lt;-<span class="st"> </span>pies_T1[<span class="dv">20</span>] <span class="op">/</span><span class="st"> </span><span class="dv">5</span>


node_colors &lt;-<span class="st"> </span><span class="kw">c</span>(viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">3</span>, <span class="dt">begin =</span> <span class="fl">0.4</span>, <span class="dt">end =</span> <span class="fl">0.99</span>)[<span class="dv">1</span>], <span class="co"># Color 1 for MVPA (questionnaire)</span>
                 viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">3</span>, <span class="dt">begin =</span> <span class="fl">0.4</span>, <span class="dt">end =</span> <span class="fl">0.99</span>)[<span class="dv">1</span>], <span class="co"># Color 1 for MVPA (accelerometer)</span>
                 <span class="kw">rep</span>(viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">3</span>, <span class="dt">begin =</span> <span class="fl">0.4</span>, <span class="dt">end =</span> <span class="fl">0.99</span>)[<span class="dv">2</span>], <span class="dv">15</span>), <span class="co"># 11x Color 2 for BCTs</span>
                 <span class="kw">rep</span>(viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">3</span>, <span class="dt">begin =</span> <span class="fl">0.4</span>, <span class="dt">end =</span> <span class="fl">0.99</span>)[<span class="dv">3</span>], <span class="dv">1</span>), <span class="co"># Color 3 for motivation (controlled)  </span>
                 <span class="kw">rep</span>(viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">3</span>, <span class="dt">begin =</span> <span class="fl">0.4</span>, <span class="dt">end =</span> <span class="fl">0.99</span>)[<span class="dv">2</span>], <span class="dv">1</span>), <span class="co"># 1x Color 2 for BCTs</span>
                 viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">3</span>, <span class="dt">begin =</span> <span class="fl">0.4</span>, <span class="dt">end =</span> <span class="fl">0.99</span>)[<span class="dv">3</span>]) <span class="co"># Color 3 for motivation (autonomous) </span>

BCT_mgm_T1 &lt;-<span class="st"> </span>qgraph<span class="op">::</span><span class="kw">qgraph</span>(mgm_obj_T1<span class="op">$</span>pairwise<span class="op">$</span>wadj, 
            <span class="dt">layout =</span> <span class="st">&quot;spring&quot;</span>,
            <span class="dt">repulsion =</span> <span class="fl">0.99</span>, <span class="co"># To nudge the network from originally bad visual state</span>
            <span class="dt">edge.color =</span> <span class="kw">ifelse</span>(mgm_obj_T1<span class="op">$</span>pairwise<span class="op">$</span>edgecolor <span class="op">==</span><span class="st"> &quot;darkgreen&quot;</span>, <span class="st">&quot;blue&quot;</span>, mgm_obj_T1<span class="op">$</span>pairwise<span class="op">$</span>edgecolor),
            <span class="dt">pie =</span> pies_T1,
            <span class="co"># pieColor = pie_colors_T1,</span>
            <span class="dt">pieColor =</span> node_colors,
            <span class="dt">labels =</span> <span class="kw">names</span>(bctdf_mgm_T1),
            <span class="dt">pieBorder =</span> <span class="dv">1</span>,
            <span class="dt">label.cex =</span> <span class="fl">0.75</span>,
            <span class="dt">cut =</span> <span class="dv">0</span>,
            <span class="dt">edge.labels =</span> <span class="ot">TRUE</span>,
            <span class="dt">label.scale =</span> <span class="ot">FALSE</span>)</code></pre></div>
<p><img src="baseline-networks_files/figure-html/unnamed-chunk-1-1.png" width="2100" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
BCT_mgm_T1_circle &lt;-<span class="st"> </span>qgraph<span class="op">::</span><span class="kw">qgraph</span>(mgm_obj_T1<span class="op">$</span>pairwise<span class="op">$</span>wadj, 
            <span class="dt">layout =</span> <span class="st">&quot;circle&quot;</span>,
            <span class="dt">title =</span> <span class="st">&quot;Mixed graphical model: PA, BCTs &amp; motivation&quot;</span>,
            <span class="dt">edge.color =</span> <span class="kw">ifelse</span>(mgm_obj_T1<span class="op">$</span>pairwise<span class="op">$</span>edgecolor <span class="op">==</span><span class="st"> &quot;darkgreen&quot;</span>, <span class="st">&quot;blue&quot;</span>, mgm_obj_T1<span class="op">$</span>pairwise<span class="op">$</span>edgecolor),
            <span class="dt">pie =</span> pies_T1,
            <span class="dt">pieColor =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">5</span>, <span class="dt">begin =</span> <span class="fl">0.3</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">5</span>],
            <span class="dt">color =</span> node_colors,
            <span class="dt">labels =</span> <span class="kw">names</span>(bctdf_mgm_T1),
            <span class="dt">label.cex =</span> <span class="fl">0.75</span>,
            <span class="dt">cut =</span> <span class="dv">0</span>,
            <span class="dt">label.scale =</span> <span class="ot">FALSE</span>)</code></pre></div>
<p><img src="baseline-networks_files/figure-html/unnamed-chunk-1-2.png" width="2100" /></p>
</div>
<div id="bootstrap-stability" class="section level2">
<h2>Bootstrap stability</h2>
<p>Omitted for now, due to technical problems.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># all_BCTs_mgm_stability &lt;- mgm::resample(object = mgm_obj_T1 %&gt;% na.omit(.), data = bctdf_mgm, nB = 100)</span>
<span class="co"># # save(all_BCTs_mgm_stability, file = &quot;./Rdata_files/all_BCTs_mgm_stability.Rdata&quot;)</span>
<span class="co"># load(&quot;./Rdata_files/all_BCTs_mgm_stability.Rdata&quot;)</span>
<span class="co"># </span>
<span class="co"># mgm::plotRes(object = all_BCTs_mgm_stability, </span>
<span class="co">#         quantiles = c(.05, .95), </span>
<span class="co">#         cex.label = 0.5,</span>
<span class="co">#         lwd.qtl = 2.5, </span>
<span class="co">#         cex.mean = .5,</span>
<span class="co">#        labels = names(bctdf_mgm))</span>

<span class="co"># Error in data[, ind_cat[i]] : subscript out of bounds</span></code></pre></div>
</div>
<div id="edge-weights-matrix" class="section level2">
<h2>Edge weights matrix</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
edgeweights &lt;-<span class="st"> </span>mgm_obj_T1<span class="op">$</span>pairwise<span class="op">$</span>wadj <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">round</span>(., <span class="dv">3</span>)
<span class="kw">colnames</span>(edgeweights) &lt;-<span class="st"> </span>labs
<span class="kw">rownames</span>(edgeweights) &lt;-<span class="st"> </span>labs

edgeweights
##                        MVPA survey MVPA accelerometer goal setting
## MVPA survey                  0.000              0.126        0.000
## MVPA accelerometer           0.126              0.000        0.000
## goal setting                 0.000              0.000        0.000
## implementation plan          0.000              0.000        1.308
## plan by other                0.168              0.000        0.000
## reminder of plan             0.000              0.000        0.171
## subgoals                     0.000              0.000        0.000
## new PA options               0.136              0.000        0.222
## barrier identification       0.000              0.000        0.000
## coping planning              0.000              0.000        0.394
## PA identity                  0.000              0.000        0.000
## PA life values               0.000              0.000        0.000
## positive consequences        0.000              0.000        0.000
## goal contrast                0.000              0.000        0.000
## relevance of PA              0.000              0.000        0.000
## changes at home              0.000              0.000        0.000
## social support               0.000              0.000        0.244
## controlled motivation        0.000              0.000        0.000
## monitoring PA                0.000              0.000        0.000
## autonomous motivation        0.314              0.074        0.198
##                        implementation plan plan by other reminder of plan
## MVPA survey                          0.000         0.168            0.000
## MVPA accelerometer                   0.000         0.000            0.000
## goal setting                         1.308         0.000            0.171
## implementation plan                  0.000         0.481            0.206
## plan by other                        0.481         0.000            0.511
## reminder of plan                     0.206         0.511            0.000
## subgoals                             0.436         0.395            0.699
## new PA options                       0.000         0.000            0.255
## barrier identification               0.000         0.000            0.360
## coping planning                      0.000         0.000            0.215
## PA identity                          0.000         0.000            0.000
## PA life values                       0.000         0.000            0.000
## positive consequences                0.000         0.000            0.000
## goal contrast                        0.277         0.000            0.243
## relevance of PA                      0.000         0.000            0.000
## changes at home                      0.000         0.000            0.000
## social support                       0.000         0.000            0.000
## controlled motivation                0.000         0.000            0.000
## monitoring PA                        0.000         0.088            0.452
## autonomous motivation                0.224         0.000            0.000
##                        subgoals new PA options barrier identification
## MVPA survey               0.000          0.136                  0.000
## MVPA accelerometer        0.000          0.000                  0.000
## goal setting              0.000          0.222                  0.000
## implementation plan       0.436          0.000                  0.000
## plan by other             0.395          0.000                  0.000
## reminder of plan          0.699          0.255                  0.360
## subgoals                  0.000          0.379                  0.000
## new PA options            0.379          0.000                  0.199
## barrier identification    0.000          0.199                  0.000
## coping planning           0.495          0.000                  1.096
## PA identity               0.228          0.230                  0.383
## PA life values            0.284          0.264                  0.276
## positive consequences     0.000          0.000                  0.000
## goal contrast             0.131          0.098                  0.000
## relevance of PA           0.000          0.000                  0.000
## changes at home           0.000          0.216                  0.000
## social support            0.000          0.000                  0.000
## controlled motivation     0.000          0.000                  0.000
## monitoring PA             0.062          0.090                  0.000
## autonomous motivation     0.000          0.128                  0.000
##                        coping planning PA identity PA life values
## MVPA survey                      0.000       0.000          0.000
## MVPA accelerometer               0.000       0.000          0.000
## goal setting                     0.394       0.000          0.000
## implementation plan              0.000       0.000          0.000
## plan by other                    0.000       0.000          0.000
## reminder of plan                 0.215       0.000          0.000
## subgoals                         0.495       0.228          0.284
## new PA options                   0.000       0.230          0.264
## barrier identification           1.096       0.383          0.276
## coping planning                  0.000       0.493          0.435
## PA identity                      0.493       0.000          0.826
## PA life values                   0.435       0.826          0.000
## positive consequences            0.000       0.196          0.175
## goal contrast                    0.000       0.000          0.155
## relevance of PA                  0.000       0.314          0.204
## changes at home                  0.000       0.000          0.000
## social support                   0.000       0.000          0.000
## controlled motivation            0.000       0.000          0.000
## monitoring PA                    0.000       0.000          0.000
## autonomous motivation            0.000       0.000          0.091
##                        positive consequences goal contrast relevance of PA
## MVPA survey                            0.000         0.000           0.000
## MVPA accelerometer                     0.000         0.000           0.000
## goal setting                           0.000         0.000           0.000
## implementation plan                    0.000         0.277           0.000
## plan by other                          0.000         0.000           0.000
## reminder of plan                       0.000         0.243           0.000
## subgoals                               0.000         0.131           0.000
## new PA options                         0.000         0.098           0.000
## barrier identification                 0.000         0.000           0.000
## coping planning                        0.000         0.000           0.000
## PA identity                            0.196         0.000           0.314
## PA life values                         0.175         0.155           0.204
## positive consequences                  0.000         0.000           0.906
## goal contrast                          0.000         0.000           0.866
## relevance of PA                        0.906         0.866           0.000
## changes at home                        0.000         0.310           0.340
## social support                         0.000         0.244           0.370
## controlled motivation                  0.000         0.000           0.000
## monitoring PA                          0.000         0.452           0.000
## autonomous motivation                  0.000         0.071           0.271
##                        changes at home social support
## MVPA survey                      0.000          0.000
## MVPA accelerometer               0.000          0.000
## goal setting                     0.000          0.244
## implementation plan              0.000          0.000
## plan by other                    0.000          0.000
## reminder of plan                 0.000          0.000
## subgoals                         0.000          0.000
## new PA options                   0.216          0.000
## barrier identification           0.000          0.000
## coping planning                  0.000          0.000
## PA identity                      0.000          0.000
## PA life values                   0.000          0.000
## positive consequences            0.000          0.000
## goal contrast                    0.310          0.244
## relevance of PA                  0.340          0.370
## changes at home                  0.000          0.593
## social support                   0.593          0.000
## controlled motivation            0.000          0.000
## monitoring PA                    0.348          0.000
## autonomous motivation            0.000          0.000
##                        controlled motivation monitoring PA
## MVPA survey                                0         0.000
## MVPA accelerometer                         0         0.000
## goal setting                               0         0.000
## implementation plan                        0         0.000
## plan by other                              0         0.088
## reminder of plan                           0         0.452
## subgoals                                   0         0.062
## new PA options                             0         0.090
## barrier identification                     0         0.000
## coping planning                            0         0.000
## PA identity                                0         0.000
## PA life values                             0         0.000
## positive consequences                      0         0.000
## goal contrast                              0         0.452
## relevance of PA                            0         0.000
## changes at home                            0         0.348
## social support                             0         0.000
## controlled motivation                      0         0.000
## monitoring PA                              0         0.000
## autonomous motivation                      0         0.000
##                        autonomous motivation
## MVPA survey                            0.314
## MVPA accelerometer                     0.074
## goal setting                           0.198
## implementation plan                    0.224
## plan by other                          0.000
## reminder of plan                       0.000
## subgoals                               0.000
## new PA options                         0.128
## barrier identification                 0.000
## coping planning                        0.000
## PA identity                            0.000
## PA life values                         0.091
## positive consequences                  0.000
## goal contrast                          0.071
## relevance of PA                        0.271
## changes at home                        0.000
## social support                         0.000
## controlled motivation                  0.000
## monitoring PA                          0.000
## autonomous motivation                  0.000</code></pre></div>
</div>
<div id="other-estimation-methods-mgm-cv-ggm" class="section level2">
<h2>Other estimation methods (mgm CV, GGM)</h2>
<p>This section estimates models with different methods: mgm with cross-validation, the standard Gaussian Graphical Model (GGM), and unregularised GGM. The distributions violate normality assumptions of the GGM.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">#### CV model selection for mgm 

mgm_obj_T1_CV &lt;-<span class="st"> </span>mgm<span class="op">::</span><span class="kw">mgm</span>(<span class="dt">data =</span> bctdf_mgm_T1,
  <span class="dt">type =</span> mgm_variable_types,
  <span class="dt">level =</span> mgm_variable_levels,
  <span class="dt">lambdaSel =</span> <span class="st">&quot;CV&quot;</span>,
  <span class="dt">lambdaFolds =</span> <span class="dv">10</span>,
  <span class="dt">pbar =</span> <span class="ot">FALSE</span>, 
  <span class="dt">binarySign =</span> <span class="ot">TRUE</span>)
## Note that the sign of parameter estimates is stored separately; see ?mgm

<span class="co"># Node pies:</span>
pies_T1 &lt;-<span class="st"> </span>bctdf_mgm_T1 <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">summarise_all</span>(<span class="op">~</span><span class="kw">mean</span>(., <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)) <span class="co"># results in a series of means, which is ok for dichotomous vars</span>
pies_T1[<span class="dv">1</span>] &lt;-<span class="st"> </span>pies_T1[<span class="dv">1</span>] <span class="op">/</span><span class="st"> </span><span class="dv">7</span>
pies_T1[<span class="dv">2</span>] &lt;-<span class="st"> </span>pies_T1[<span class="dv">2</span>] <span class="op">/</span><span class="st"> </span><span class="kw">max</span>(bctdf_mgm_T1<span class="op">$</span><span class="st">`</span><span class="dt">MVPA accelerometer</span><span class="st">`</span>, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)
pies_T1[<span class="dv">20</span>] &lt;-<span class="st"> </span>pies_T1[<span class="dv">20</span>] <span class="op">/</span><span class="st"> </span><span class="dv">5</span>


node_colors &lt;-<span class="st"> </span><span class="kw">c</span>(viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">3</span>, <span class="dt">begin =</span> <span class="fl">0.4</span>, <span class="dt">end =</span> <span class="fl">0.99</span>)[<span class="dv">1</span>], <span class="co"># Color 1 for MVPA (questionnaire)</span>
                 viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">3</span>, <span class="dt">begin =</span> <span class="fl">0.4</span>, <span class="dt">end =</span> <span class="fl">0.99</span>)[<span class="dv">1</span>], <span class="co"># Color 1 for MVPA (accelerometer)</span>
                 <span class="kw">rep</span>(viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">3</span>, <span class="dt">begin =</span> <span class="fl">0.4</span>, <span class="dt">end =</span> <span class="fl">0.99</span>)[<span class="dv">2</span>], <span class="dv">15</span>), <span class="co"># 11x Color 2 for BCTs</span>
                 <span class="kw">rep</span>(viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">3</span>, <span class="dt">begin =</span> <span class="fl">0.4</span>, <span class="dt">end =</span> <span class="fl">0.99</span>)[<span class="dv">3</span>], <span class="dv">1</span>), <span class="co"># Color 3 for motivation (controlled)  </span>
                 <span class="kw">rep</span>(viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">3</span>, <span class="dt">begin =</span> <span class="fl">0.4</span>, <span class="dt">end =</span> <span class="fl">0.99</span>)[<span class="dv">2</span>], <span class="dv">1</span>), <span class="co"># 1x Color 2 for BCTs</span>
                 viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">3</span>, <span class="dt">begin =</span> <span class="fl">0.4</span>, <span class="dt">end =</span> <span class="fl">0.99</span>)[<span class="dv">3</span>]) <span class="co"># Color 3 for motivation (autonomous) </span>

BCT_mgm_T1_CV &lt;-<span class="st"> </span>qgraph<span class="op">::</span><span class="kw">qgraph</span>(mgm_obj_T1_CV<span class="op">$</span>pairwise<span class="op">$</span>wadj, 
            <span class="dt">layout =</span> BCT_mgm_T1<span class="op">$</span>layout,
            <span class="dt">repulsion =</span> <span class="fl">0.99</span>, <span class="co"># To nudge the network from originally bad visual state</span>
            <span class="dt">edge.color =</span> <span class="kw">ifelse</span>(mgm_obj_T1<span class="op">$</span>pairwise<span class="op">$</span>edgecolor <span class="op">==</span><span class="st"> &quot;darkgreen&quot;</span>, <span class="st">&quot;blue&quot;</span>, mgm_obj_T1<span class="op">$</span>pairwise<span class="op">$</span>edgecolor),
            <span class="dt">pie =</span> pies_T1,
            <span class="co"># pieColor = pie_colors_T1,</span>
            <span class="dt">pieColor =</span> node_colors,
            <span class="dt">labels =</span> <span class="kw">names</span>(bctdf_mgm_T1),
            <span class="dt">pieBorder =</span> <span class="dv">1</span>,
            <span class="dt">label.cex =</span> <span class="fl">0.75</span>,
            <span class="dt">cut =</span> <span class="dv">0</span>,
            <span class="dt">label.scale =</span> <span class="ot">FALSE</span>,
            <span class="dt">title =</span> <span class="st">&quot;MGM with cross-validation&quot;</span>)</code></pre></div>
<p><img src="baseline-networks_files/figure-html/unnamed-chunk-4-1.png" width="2100" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
#### GGM

bctdf_ggm_T1 &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(
  <span class="st">&#39;goal setting&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_01_T1,
  <span class="st">&#39;implementation plan&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_02_T1,
  <span class="st">&#39;plan by other&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_03_T1,
  <span class="st">&#39;reminder of plan&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_04_T1,
  <span class="st">&#39;subgoals&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_05_T1,
  <span class="st">&#39;new PA options&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_06_T1,
  <span class="st">&#39;barrier identification&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_07_T1,
  <span class="st">&#39;coping planning&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_08_T1,
  <span class="st">&#39;PA identity&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_09_T1,
  <span class="st">&#39;PA life values&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_10_T1,
  <span class="st">&#39;positive consequences&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_01_T1,
  <span class="st">&#39;log on paper&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_02_T1,
  <span class="st">&#39;smartphone&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_03_T1,
<span class="co">#  &#39;mnemonic cues&#39; = PA_frequencyDependentBCT_04_T1, # Issues with clarity of item wording </span>
  <span class="st">&#39;goal contrast&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_05_T1,
  <span class="st">&#39;relevance of PA&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_06_T1,
  <span class="st">&#39;changes at home&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_07_T1,
  <span class="st">&#39;social support&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_08_T1,
  <span class="st">&#39;failure contemplation&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_09_T1,
  <span class="st">&#39;MVPA survey&#39;</span> =<span class="st"> </span>padaysLastweek_T1,
  <span class="st">&#39;MVPA accelerometer&#39;</span> =<span class="st"> </span>mvpaAccelerometer_T1,
  <span class="st">&#39;intrinsic&#39;</span> =<span class="st"> </span>PA_intrinsic_T1,
  <span class="st">&#39;identified&#39;</span> =<span class="st"> </span>PA_identified_T1, <span class="st">&#39;integrated&#39;</span> =<span class="st"> </span>PA_integrated_T1,
  <span class="st">&#39;controlled motivation&#39;</span> =<span class="st"> </span>PA_controlled_T1) <span class="op">%&gt;%</span>
<span class="st"> </span><span class="kw">rowwise</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st"> </span><span class="kw">mutate</span>(
  <span class="co"># &#39;goal setting&#39; = ifelse(`goal setting` == 1, 0, 1),</span>
  <span class="co"># &#39;implementation plan&#39; = ifelse(`implementation plan` == 1, 0, 1),</span>
  <span class="co"># &#39;plan by other&#39; = ifelse(`plan by other` == 1, 0, 1),</span>
  <span class="co"># &#39;reminder of plan&#39; = ifelse(`reminder of plan` == 1, 0, 1),</span>
  <span class="co"># &#39;subgoals&#39; = ifelse(`subgoals` == 1, 0, 1),</span>
  <span class="co"># &#39;new PA options&#39; = ifelse(`new PA options` == 1, 0, 1),</span>
  <span class="co"># &#39;barrier identification&#39; = ifelse(`barrier identification` == 1, 0, 1),</span>
  <span class="co"># &#39;coping planning&#39; = ifelse(`coping planning` == 1, 0, 1),</span>
  <span class="co"># &#39;PA identity&#39; = ifelse(`PA identity` == 1, 0, 1),</span>
  <span class="co"># &#39;PA life values&#39; = ifelse(`PA life values` == 1, 0, 1),</span>
  <span class="co"># &#39;positive consequences&#39; = ifelse(`positive consequences` == 1, 0, 1),</span>
  <span class="st">&#39;monitoring PA&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">log on paper</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span> <span class="op">&amp;</span><span class="st"> `</span><span class="dt">smartphone</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
  <span class="co"># &#39;goal contrast&#39; = ifelse(`goal contrast` == 1, 0, 1),</span>
  <span class="co"># &#39;relevance of PA&#39; = ifelse(`relevance of PA` == 1, 0, 1),</span>
  <span class="co"># &#39;changes at home&#39; = ifelse(`changes at home` == 1, 0, 1),</span>
  <span class="co"># &#39;social support&#39; = ifelse(`social support` == 1, 0, 1),</span>
  <span class="co"># &#39;failure contemplation&#39; = ifelse(`failure contemplation` == 1, 0, 1),</span>
  <span class="st">&#39;autonomous motivation&#39;</span> =<span class="st"> </span><span class="kw">mean</span>(<span class="kw">c</span>(identified, intrinsic, integrated), <span class="dt">na.rm =</span> T),
  <span class="st">&#39;controlled motivation&#39;</span> =<span class="st"> `</span><span class="dt">controlled motivation</span><span class="st">`</span> <span class="op">*</span><span class="st"> </span><span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span><span class="st">`</span><span class="dt">log on paper</span><span class="st">`</span>, <span class="op">-</span><span class="st">`</span><span class="dt">smartphone</span><span class="st">`</span>, 
                <span class="op">-</span>identified, <span class="op">-</span>intrinsic, <span class="op">-</span>integrated,
         <span class="op">-</span><span class="st">`</span><span class="dt">failure contemplation</span><span class="st">`</span> <span class="co"># only concerns those who haven&#39;t reached goals</span>
           ) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="st">&#39;MVPA survey&#39;</span>, <span class="st">&#39;MVPA accelerometer&#39;</span>, <span class="kw">everything</span>()) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate_all</span>(as.numeric)

nwBCT_ggm &lt;-<span class="st"> </span>bootnet<span class="op">::</span><span class="kw">estimateNetwork</span>(bctdf_ggm_T1, <span class="dt">default=</span><span class="st">&quot;EBICglasso&quot;</span>)

BCT_ggm &lt;-<span class="st"> </span><span class="kw">plot</span>(nwBCT_ggm, 
                <span class="dt">layout =</span> BCT_mgm_T1<span class="op">$</span>layout, 
                <span class="dt">label.scale =</span> <span class="ot">FALSE</span>, 
                <span class="dt">title =</span> <span class="st">&quot;GGM: MVPA, BCTs &amp; motivation&quot;</span>, 
                <span class="dt">label.cex =</span> <span class="fl">0.75</span>,
                <span class="co"># pie = piefill_ggm,</span>
                <span class="dt">color =</span> node_colors,
                <span class="dt">pieBorder =</span> <span class="dv">1</span>)</code></pre></div>
<p><img src="baseline-networks_files/figure-html/unnamed-chunk-4-2.png" width="2100" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
modSelect_<span class="dv">0</span> &lt;-<span class="st"> </span>qgraph<span class="op">::</span><span class="kw">ggmModSelect</span>(qgraph<span class="op">::</span><span class="kw">cor_auto</span>(bctdf_ggm_T1), <span class="dt">n =</span> <span class="kw">nrow</span>(bctdf_ggm_T1), <span class="dt">gamma =</span> <span class="dv">0</span>)

g3 &lt;-<span class="st"> </span>qgraph<span class="op">::</span><span class="kw">qgraph</span>(modSelect_<span class="dv">0</span><span class="op">$</span>graph, 
                     <span class="dt">layout =</span> BCT_mgm_T1<span class="op">$</span>layout, 
                     <span class="dt">label.scale =</span> <span class="ot">FALSE</span>,
                     <span class="dt">label.cex =</span> <span class="fl">0.75</span>,
                     <span class="dt">labels =</span> labs,
                     <span class="dt">theme =</span> <span class="st">&quot;colorblind&quot;</span>,
                     <span class="dt">title =</span> <span class="st">&quot;ggmModSelect (gamma = 0)&quot;</span>, 
                     <span class="dt">color =</span> node_colors, 
                     <span class="dt">cut =</span> <span class="dv">0</span>)</code></pre></div>
<p><img src="baseline-networks_files/figure-html/unnamed-chunk-4-3.png" width="2100" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
modSelect_<span class="fl">0.5</span> &lt;-<span class="st"> </span>qgraph<span class="op">::</span><span class="kw">ggmModSelect</span>(qgraph<span class="op">::</span><span class="kw">cor_auto</span>(bctdf_ggm_T1), <span class="dt">n =</span> <span class="kw">nrow</span>(bctdf_ggm_T1), <span class="dt">gamma =</span> <span class="fl">0.5</span>)

g4 &lt;-<span class="st"> </span>qgraph<span class="op">::</span><span class="kw">qgraph</span>(modSelect_<span class="fl">0.5</span><span class="op">$</span>graph, 
                     <span class="dt">layout =</span> BCT_mgm_T1<span class="op">$</span>layout, 
                     <span class="dt">label.scale =</span> <span class="ot">FALSE</span>,
                     <span class="dt">label.cex =</span> <span class="fl">0.75</span>,
                     <span class="dt">labels =</span> labs,
                     <span class="dt">theme =</span> <span class="st">&quot;colorblind&quot;</span>, 
                     <span class="dt">title =</span> <span class="st">&quot;ggmModSelect (gamma = 0.5)&quot;</span>,
                     <span class="dt">color =</span> node_colors, 
                     <span class="dt">cut =</span> <span class="dv">0</span>)</code></pre></div>
<p><img src="baseline-networks_files/figure-html/unnamed-chunk-4-4.png" width="2100" /></p>
</div>
<div id="centrality" class="section level2">
<h2>Centrality</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">qgraph<span class="op">::</span><span class="kw">centralityPlot</span>(
  <span class="kw">list</span>(
    <span class="co"># mgm_EBIC = BCT_mgm_T1,</span>
    <span class="co"># mgm_CV = mgm_obj_T1_CV,</span>
       <span class="dt">ggm =</span> BCT_ggm,
       <span class="dt">ggmModSelect_0 =</span> g3,
       <span class="dt">ggmModSelect_0.5 =</span> g4
       ),
  <span class="dt">include =</span> <span class="kw">c</span>(<span class="st">&quot;Strength&quot;</span>,<span class="st">&quot;ExpectedInfluence&quot;</span>),
               <span class="dt">orderBy =</span> <span class="st">&quot;ExpectedInfluence&quot;</span>)</code></pre></div>
<p><img src="baseline-networks_files/figure-html/unnamed-chunk-5-1.png" width="2100" /></p>
</div>
</div>
<div id="combined-bct-chunks" class="section level1">
<h1>Combined BCT chunks</h1>
<p>The following network depicts a mixed graphical model, with the following variables:</p>
<ul>
<li><p>Two measures of physical activity. <code>MVPA accelerometer</code> is the mean accelerometer-measured Moderate-to-Vigorous Physical Activity (MVPA) during a day in the measurement period, <code>MVPA questionnaire</code> is a survey item which asked “on how many days the previous week were you active for at least 30 minutes so, that you were out of breath”.</p></li>
<li><p>One Behaviour Change Technique usage node (BCT usage is the mean of all techniques participants reported having used).</p></li>
<li><p>Four motivation types (Intrinsic and Identified, which are facets of “autonomous regulation” according to the self-determination theory, looked normal so used as continuous. Introjected and Extrinsic - facets of “controlled regulation” - were heavily skewed, so they were dichotomised: if “at least partly” or more true, a participant gets 1, otherwise 0.</p></li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
bctdf_mgm &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(
  <span class="st">&#39;agr-BCTs&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_T1,
  <span class="st">&#39;frq-BCTs&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_T1,
  <span class="st">&#39;MVPA questionnaire&#39;</span> =<span class="st"> </span>padaysLastweek_T1,
  <span class="st">&#39;MVPA accelerometer&#39;</span> =<span class="st"> </span>mvpaAccelerometer_T1,
  <span class="st">&#39;Intrinsic&#39;</span> =<span class="st"> </span>PA_intrinsic_T1,
  <span class="st">&#39;Identified&#39;</span> =<span class="st"> </span>PA_identified_T1,
  <span class="st">&#39;Introjected&#39;</span> =<span class="st"> </span>PA_introjected_T1,
  <span class="st">&#39;Extrinsic&#39;</span> =<span class="st"> </span>PA_extrinsic_T1) <span class="op">%&gt;%</span>
<span class="st"> </span><span class="kw">rowwise</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st"> </span><span class="kw">mutate</span>(
  <span class="st">&#39;BCT usage&#39;</span> =<span class="st"> </span><span class="kw">mean</span>(<span class="kw">c</span>(<span class="st">`</span><span class="dt">agr-BCTs</span><span class="st">`</span>, <span class="st">`</span><span class="dt">frq-BCTs</span><span class="st">`</span>), <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),
  <span class="co"># &#39;autonomous motivation&#39; = mean(c(identified, intrinsic), na.rm = TRUE),</span>
  <span class="st">&#39;Extrinsic&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">Extrinsic</span><span class="st">`</span> <span class="op">&lt;</span><span class="st"> </span><span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">1</span>), <span class="co"># If &quot;at least partly&quot; or more true, input 1. Normality otherwise a problem. </span>
  <span class="st">&#39;Introjected&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">Introjected</span><span class="st">`</span> <span class="op">&lt;</span><span class="st"> </span><span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">1</span>)) <span class="op">%&gt;%</span><span class="st">  </span><span class="co"># If &quot;at least partly&quot; or more true, input 1. Normality otherwise a problem. </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="st">&#39;MVPA questionnaire&#39;</span>, <span class="st">&#39;MVPA accelerometer&#39;</span>, <span class="st">&#39;BCT usage&#39;</span>, <span class="kw">everything</span>(), <span class="op">-</span><span class="kw">contains</span>(<span class="st">&quot;-BCTs&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate_all</span>(as.numeric)

bctdf_mgm<span class="op">$</span><span class="st">`</span><span class="dt">BCT usage</span><span class="st">`</span>[<span class="kw">is.nan</span>(bctdf_mgm<span class="op">$</span><span class="st">`</span><span class="dt">BCT usage</span><span class="st">`</span>)] &lt;-<span class="st"> </span><span class="ot">NA</span>



<span class="co"># If you need mock data:</span>
<span class="co"># bctdf_mgm &lt;- data.frame(</span>
<span class="co">#   &#39;MVPA questionnaire&#39; = sample(1:8, size = 700, replace = TRUE),</span>
<span class="co">#   &#39;MVPA accelerometer&#39; = rnorm(mean = 130, sd = 40, n = 700),</span>
<span class="co">#   &#39;BCT usage&#39; = replicate(19, sample(1:5, 700, rep = TRUE)) %&gt;% as.data.frame() %&gt;% rowMeans(.),</span>
<span class="co">#   &#39;Intrinsic&#39; = replicate(3, sample(1:5, 700, rep = TRUE)) %&gt;% as.data.frame() %&gt;% rowMeans(.),</span>
<span class="co">#   &#39;Identified&#39; = replicate(3, sample(1:5, 700, rep = TRUE)) %&gt;% as.data.frame() %&gt;% rowMeans(.),</span>
<span class="co">#   &#39;Introjected&#39; = sample(0:1, 700, rep = TRUE) %&gt;% as.data.frame() %&gt;% rowMeans(.),</span>
<span class="co">#   &#39;Extrinsic&#39; = sample(0:1, 700, rep = TRUE) %&gt;% as.data.frame() %&gt;% rowMeans(.)</span>
<span class="co"># )</span>

labs &lt;-<span class="st"> </span><span class="kw">names</span>(bctdf_mgm)

<span class="co"># mgm wants full data, see package missForest for imputation methods</span>
bctdf_mgm &lt;-<span class="st"> </span>bctdf_mgm <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">na.omit</span>(.)
<span class="co"># bctdf_mgm %&gt;% names()</span>
mgm_variable_types &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">&quot;g&quot;</span>, <span class="dv">5</span>), <span class="st">&quot;c&quot;</span>, <span class="st">&quot;c&quot;</span>)
mgm_variable_levels &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">&quot;1&quot;</span>, <span class="dv">5</span>), <span class="st">&quot;2&quot;</span>, <span class="st">&quot;2&quot;</span>)
<span class="co"># data.frame(mgm_variable_types, mgm_variable_levels, names(bctdf_mgm))</span>

mgm_obj &lt;-<span class="st"> </span>mgm<span class="op">::</span><span class="kw">mgm</span>(<span class="dt">data =</span> bctdf_mgm,
  <span class="dt">type =</span> mgm_variable_types,
  <span class="dt">level =</span> mgm_variable_levels,
  <span class="dt">lambdaSel =</span> <span class="st">&quot;CV&quot;</span>,
  <span class="dt">lambdaFolds =</span> <span class="dv">10</span>,
  <span class="dt">pbar =</span> <span class="ot">FALSE</span>, 
  <span class="dt">binarySign =</span> <span class="ot">TRUE</span>)
## Note that the sign of parameter estimates is stored separately; see ?mgm

pred_obj &lt;-<span class="st"> </span><span class="kw">predict</span>(<span class="dt">object =</span> mgm_obj,
                         <span class="dt">data =</span> bctdf_mgm)

pred_obj<span class="op">$</span>errors</code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Variable"],"name":[1],"type":["chr"],"align":["left"]},{"label":["RMSE"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["R2"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["CC"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["nCC"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["CCmarg"],"name":[6],"type":["dbl"],"align":["right"]}],"data":[{"1":"MVPA questionnaire","2":"0.849","3":"0.278","4":"NA","5":"NA","6":"NA","_rn_":"1"},{"1":"MVPA accelerometer","2":"0.960","3":"0.078","4":"NA","5":"NA","6":"NA","_rn_":"2"},{"1":"BCT usage","2":"0.766","3":"0.413","4":"NA","5":"NA","6":"NA","_rn_":"3"},{"1":"Intrinsic","2":"0.626","3":"0.607","4":"NA","5":"NA","6":"NA","_rn_":"4"},{"1":"Identified","2":"0.631","3":"0.602","4":"NA","5":"NA","6":"NA","_rn_":"5"},{"1":"Introjected","2":"NA","3":"NA","4":"0.7","5":"0.157","6":"0.644","_rn_":"6"},{"1":"Extrinsic","2":"NA","3":"NA","4":"0.9","5":"0.011","6":"0.899","_rn_":"7"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[15],"max":[15]},"pages":{}}}
  </script>
</div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># Take R2 from gaussian, CC from categorical variables </span>
pie_errors &lt;-<span class="st"> </span><span class="kw">c</span>(pred_obj<span class="op">$</span>errors[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>, <span class="dv">3</span>],
                pred_obj<span class="op">$</span>errors[<span class="dv">6</span><span class="op">:</span><span class="dv">7</span>, <span class="dv">4</span>])

<span class="co"># Coloring nodes: make a sequence of colors from the viridis palette. We need three colors (MVPA, BCTs, motivation), and &quot;begin&quot; from ones that are not too dark, so that black text shows up ok.</span>

node_colors &lt;-<span class="st"> </span><span class="kw">c</span>(viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">5</span>, <span class="dt">begin =</span> <span class="fl">0.4</span>, <span class="dt">end =</span> <span class="fl">0.99</span>)[<span class="dv">1</span>], <span class="co"># Color 1 for MVPA (questionnaire)</span>
                 viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">5</span>, <span class="dt">begin =</span> <span class="fl">0.4</span>, <span class="dt">end =</span> <span class="fl">0.99</span>)[<span class="dv">1</span>], <span class="co"># Color 1 for MVPA (accelerometer)</span>
                 <span class="kw">rep</span>(viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">5</span>, <span class="dt">begin =</span> <span class="fl">0.4</span>, <span class="dt">end =</span> <span class="fl">0.99</span>)[<span class="dv">4</span>], <span class="dv">1</span>), <span class="co"># 1x Color 4 for BCTs</span>
                 <span class="kw">rep</span>(viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">5</span>, <span class="dt">begin =</span> <span class="fl">0.4</span>, <span class="dt">end =</span> <span class="fl">0.99</span>)[<span class="dv">2</span>], <span class="dv">2</span>), <span class="co"># 2x Color 2 for autonomous</span>
                 <span class="kw">rep</span>(viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">5</span>, <span class="dt">begin =</span> <span class="fl">0.4</span>, <span class="dt">end =</span> <span class="fl">0.99</span>)[<span class="dv">3</span>], <span class="dv">2</span>)) <span class="co"># 2x Color 3 for controlled</span>

BCT_mgm &lt;-<span class="st"> </span>qgraph<span class="op">::</span><span class="kw">qgraph</span>(mgm_obj<span class="op">$</span>pairwise<span class="op">$</span>wadj, 
            <span class="dt">layout =</span> <span class="st">&quot;spring&quot;</span>,
            <span class="dt">repulsion =</span> <span class="dv">1</span>, <span class="co"># To nudge the network from originally bad visual state</span>
            <span class="co"># title = &quot;Mixed graphical model: PA, BCTs &amp; motivation&quot;,</span>
            <span class="dt">edge.color =</span> <span class="kw">ifelse</span>(mgm_obj<span class="op">$</span>pairwise<span class="op">$</span>edgecolor <span class="op">==</span><span class="st"> &quot;darkgreen&quot;</span>, <span class="st">&quot;blue&quot;</span>, mgm_obj<span class="op">$</span>pairwise<span class="op">$</span>edgecolor),
            <span class="dt">pie =</span> pie_errors,
            <span class="dt">pieColor =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">5</span>, <span class="dt">begin =</span> <span class="fl">0.3</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">5</span>],
            <span class="dt">color =</span> node_colors,
            <span class="dt">labels =</span> <span class="kw">names</span>(bctdf_mgm),
            <span class="dt">label.cex =</span> <span class="fl">0.8</span>,
            <span class="dt">label.scale =</span> <span class="ot">FALSE</span>,
            <span class="dt">node.width =</span> <span class="fl">1.65</span>)</code></pre></div>
<p><img src="baseline-networks_files/figure-html/unnamed-chunk-6-1.png" width="2100" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># adjacency_noAmotivation &lt;- mgm_obj$pairwise$wadj</span>
<span class="co"># save(adjacency_noAmotivation, file = &quot;./Rdata_files/adjacency_noAmotivation.Rdata&quot;)</span>
<span class="co"># signs_noAmotivation &lt;- mgm_obj$pairwise$signs</span>
<span class="co"># save(signs_noAmotivation, file = &quot;./Rdata_files/signs_noAmotivation.Rdata&quot;)</span>

<span class="co"># BCT_mgm_noAmotivation_stability &lt;- mgm::resample(object = mgm_obj, data = bctdf_mgm, nB = 100)</span>
<span class="co"># save(BCT_mgm_noAmotivation_stability, file = &quot;./Rdata_files/BCT_mgm_noAmotivation_stability.Rdata&quot;)</span>
<span class="kw">load</span>(<span class="st">&quot;./Rdata_files/BCT_mgm_noAmotivation_stability.Rdata&quot;</span>)

<span class="co"># # Plotting the bootstrapped edge between variables 1 and 4:</span>
<span class="co"># hist(BCT_mgm_noAmotivation_stability$bootParameters[1, 4, ],</span>
<span class="co"># main = &quot;&quot;,</span>
<span class="co"># xlab = &quot;Parameter Estimate&quot;)</span>

mgm<span class="op">::</span><span class="kw">plotRes</span>(<span class="dt">object =</span> BCT_mgm_noAmotivation_stability, 
        <span class="dt">quantiles =</span> <span class="kw">c</span>(.<span class="dv">05</span>, .<span class="dv">95</span>), 
        <span class="dt">cex.label =</span> <span class="fl">0.5</span>,
        <span class="dt">lwd.qtl =</span> <span class="fl">2.5</span>, 
        <span class="dt">cex.mean =</span> .<span class="dv">5</span>,
        <span class="dt">labels =</span> <span class="kw">names</span>(bctdf_mgm))</code></pre></div>
<p><img src="baseline-networks_files/figure-html/unnamed-chunk-6-2.png" width="2100" /></p>
<p>The bootstrap stability plot above shows the proportion of re-samples, which contain a non-zero link between two edges (for a tutorial, see <a href="http://psych-networks.com/bootstrapping-edges-after-regularization-clarifications-tutorial/">this link</a> – or, if it’s down, this <a href="https://web.archive.org/web/20180809113839/http://psych-networks.com/bootstrapping-edges-after-regularization-clarifications-tutorial/">archived page</a>). For example, when we draw observations from the current sample with replacement a 100 times, 99% of these times a non-zero link between questionnaire-measured MVPA and intrinsic motivation is estimated.</p>
</div>
<div id="correlation-network-and-mixed-graphical-model-compared" class="section level1">
<h1>Correlation network and mixed graphical model compared</h1>
<pre><code>## Note that the sign of parameter estimates is stored separately; see ?mgm</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Variable"],"name":[1],"type":["chr"],"align":["left"]},{"label":["RMSE"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["R2"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["CC"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["nCC"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["CCmarg"],"name":[6],"type":["dbl"],"align":["right"]}],"data":[{"1":"MVPA survey","2":"0.849","3":"0.278","4":"NA","5":"NA","6":"NA","_rn_":"1"},{"1":"MVPA accelerom.","2":"0.960","3":"0.077","4":"NA","5":"NA","6":"NA","_rn_":"2"},{"1":"Intrinsic","2":"0.627","3":"0.607","4":"NA","5":"NA","6":"NA","_rn_":"3"},{"1":"Identified","2":"0.631","3":"0.602","4":"NA","5":"NA","6":"NA","_rn_":"4"},{"1":"Introjected","2":"NA","3":"NA","4":"0.702","5":"0.160","6":"0.645","_rn_":"5"},{"1":"Extrinsic","2":"NA","3":"NA","4":"0.900","5":"0.011","6":"0.899","_rn_":"6"},{"1":"BCT usage","2":"0.766","3":"0.413","4":"NA","5":"NA","6":"NA","_rn_":"7"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[15],"max":[15]},"pages":{}}}
  </script>
</div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
averagedLayout &lt;-<span class="st"> </span>qgraph<span class="op">::</span><span class="kw">averageLayout</span>(BCT_mgm, corgraph)

<span class="kw">layout</span>(<span class="kw">t</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>))

BCT_mgm &lt;-<span class="st"> </span>qgraph<span class="op">::</span><span class="kw">qgraph</span>(mgm_obj<span class="op">$</span>pairwise<span class="op">$</span>wadj, 
            <span class="dt">layout =</span> averagedLayout,
            <span class="dt">edge.color =</span> <span class="kw">ifelse</span>(mgm_obj<span class="op">$</span>pairwise<span class="op">$</span>edgecolor <span class="op">==</span><span class="st"> &quot;darkgreen&quot;</span>, <span class="st">&quot;blue&quot;</span>, mgm_obj<span class="op">$</span>pairwise<span class="op">$</span>edgecolor),
            <span class="dt">pie =</span> pie_errors,
            <span class="dt">pieColor =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">5</span>, <span class="dt">begin =</span> <span class="fl">0.3</span>, <span class="dt">end =</span> <span class="fl">0.99</span>)[<span class="dv">2</span>],
            <span class="dt">color =</span> node_colors,
            <span class="dt">labels =</span> <span class="kw">names</span>(bctdf_mgm),
            <span class="co"># label.cex = 1,</span>
            <span class="dt">label.scale =</span> <span class="ot">FALSE</span>,
            <span class="co"># node.width = 1,</span>
            <span class="dt">edge.labels =</span> <span class="ot">TRUE</span>,
            <span class="dt">title =</span> <span class="st">&quot;A)&quot;</span>)

corgraph &lt;-<span class="st"> </span>qgraph<span class="op">::</span><span class="kw">qgraph</span>(qgraph<span class="op">::</span><span class="kw">cor_auto</span>(bctdf_mgm), 
              <span class="dt">layout =</span> averagedLayout,
              <span class="dt">graph =</span> <span class="st">&quot;cor&quot;</span>,
              <span class="dt">pie =</span> piefill,
              <span class="dt">pieBorder =</span> <span class="dv">1</span>,
              <span class="dt">nodeColor =</span> node_colors,
              <span class="dt">labels =</span> <span class="kw">names</span>(bctdf_mgm),
              <span class="co"># label.cex = 1,</span>
              <span class="dt">label.scale =</span> <span class="ot">FALSE</span>,
              <span class="co"># node.width = 1,</span>
              <span class="dt">edge.labels =</span> <span class="ot">TRUE</span>, 
              <span class="dt">title =</span> <span class="st">&quot;B)&quot;</span>)</code></pre></div>
<div class="figure">
<img src="baseline-networks_files/figure-html/network-plot-1.png" alt="A) Mixed graphical model with LASSO regularisation and model selection by cross-validation. Pie indicates node predictability. B) Bivariate correlation network. Pie indicates node mean as % of theoretical maximum (for MVPA accelerometer, mean as % average weartime)." width="3600" />
<p class="caption">
<ol style="list-style-type: upper-alpha">
<li>Mixed graphical model with LASSO regularisation and model selection by cross-validation. Pie indicates node predictability. B) Bivariate correlation network. Pie indicates node mean as % of theoretical maximum (for MVPA accelerometer, mean as % average weartime).
</p>
</div></li>
</ol>
<p>The “last motivation type”, i.e. the fifth, is Amotivation (dichotomised due to skew). A node for that is added in the network below:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
bctdf_mgm &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(
  <span class="st">&#39;agr-BCTs&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_T1,
  <span class="st">&#39;frq-BCTs&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_T1,
  <span class="st">&#39;MVPA questionnaire&#39;</span> =<span class="st"> </span>padaysLastweek_T1,
  <span class="st">&#39;MVPA accelerometer&#39;</span> =<span class="st"> </span>mvpaAccelerometer_T1,
  <span class="st">&#39;Intrinsic&#39;</span> =<span class="st"> </span>PA_intrinsic_T1,
  <span class="st">&#39;Identified&#39;</span> =<span class="st"> </span>PA_identified_T1,
  <span class="st">&#39;Introjected&#39;</span> =<span class="st"> </span>PA_introjected_T1,
  <span class="st">&#39;Extrinsic&#39;</span> =<span class="st"> </span>PA_extrinsic_T1,
  <span class="st">&#39;Amotivation&#39;</span> =<span class="st"> </span>PA_amotivation_T1) <span class="op">%&gt;%</span>
<span class="st"> </span><span class="kw">rowwise</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st"> </span><span class="kw">mutate</span>(
  <span class="st">&#39;BCT usage&#39;</span> =<span class="st"> </span><span class="kw">mean</span>(<span class="kw">c</span>(<span class="st">`</span><span class="dt">agr-BCTs</span><span class="st">`</span>, <span class="st">`</span><span class="dt">frq-BCTs</span><span class="st">`</span>), <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),
  <span class="co"># &#39;autonomous motivation&#39; = mean(c(identified, intrinsic), na.rm = TRUE),</span>
  <span class="st">&#39;Extrinsic&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">Extrinsic</span><span class="st">`</span> <span class="op">&lt;</span><span class="st"> </span><span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">1</span>), <span class="co"># If &quot;at least partly&quot; or more true, input 1. Normality otherwise a problem.</span>
  <span class="st">&#39;Amotivation&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">Amotivation</span><span class="st">`</span> <span class="op">&lt;</span><span class="st"> </span><span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">1</span>), <span class="co"># If &quot;at least partly&quot; or more true, input 1. Normality otherwise a problem.</span>
  <span class="st">&#39;Introjected&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">Introjected</span><span class="st">`</span> <span class="op">&lt;</span><span class="st"> </span><span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">1</span>)) <span class="op">%&gt;%</span><span class="st">  </span><span class="co"># If &quot;at least partly&quot; or more true, input 1. Normality otherwise a problem. </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="st">&#39;MVPA questionnaire&#39;</span>, <span class="st">&#39;MVPA accelerometer&#39;</span>, <span class="st">&#39;BCT usage&#39;</span>, <span class="kw">everything</span>(), <span class="op">-</span><span class="kw">contains</span>(<span class="st">&quot;-BCTs&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate_all</span>(as.numeric)

bctdf_mgm<span class="op">$</span><span class="st">`</span><span class="dt">BCT usage</span><span class="st">`</span>[<span class="kw">is.nan</span>(bctdf_mgm<span class="op">$</span><span class="st">`</span><span class="dt">BCT usage</span><span class="st">`</span>)] &lt;-<span class="st"> </span><span class="ot">NA</span>

labs &lt;-<span class="st"> </span><span class="kw">names</span>(bctdf_mgm)

<span class="co"># mgm wants full data, see package missForest for imputation methods</span>
bctdf_mgm &lt;-<span class="st"> </span>bctdf_mgm <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">na.omit</span>(.)
<span class="co"># bctdf_mgm %&gt;% names()</span>
mgm_variable_types &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">&quot;g&quot;</span>, <span class="dv">5</span>), <span class="st">&quot;c&quot;</span>, <span class="st">&quot;c&quot;</span>, <span class="st">&quot;c&quot;</span>)
mgm_variable_levels &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">&quot;1&quot;</span>, <span class="dv">5</span>), <span class="st">&quot;2&quot;</span>, <span class="st">&quot;2&quot;</span>, <span class="st">&quot;2&quot;</span>)
<span class="co"># data.frame(mgm_variable_types, mgm_variable_levels, names(bctdf_mgm))</span>

mgm_obj &lt;-<span class="st"> </span>mgm<span class="op">::</span><span class="kw">mgm</span>(<span class="dt">data =</span> bctdf_mgm,
  <span class="dt">type =</span> mgm_variable_types,
  <span class="dt">level =</span> mgm_variable_levels,
  <span class="dt">lambdaSel =</span> <span class="st">&quot;CV&quot;</span>,
  <span class="dt">lambdaFolds =</span> <span class="dv">10</span>,
  <span class="dt">pbar =</span> <span class="ot">FALSE</span>, 
  <span class="dt">binarySign =</span> <span class="ot">TRUE</span>)
## Note that the sign of parameter estimates is stored separately; see ?mgm

pred_obj &lt;-<span class="st"> </span><span class="kw">predict</span>(<span class="dt">object =</span> mgm_obj,
                         <span class="dt">data =</span> bctdf_mgm)

pred_obj<span class="op">$</span>errors</code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Variable"],"name":[1],"type":["chr"],"align":["left"]},{"label":["RMSE"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["R2"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["CC"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["nCC"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["CCmarg"],"name":[6],"type":["dbl"],"align":["right"]}],"data":[{"1":"MVPA questionnaire","2":"0.850","3":"0.276","4":"NA","5":"NA","6":"NA","_rn_":"1"},{"1":"MVPA accelerometer","2":"0.959","3":"0.079","4":"NA","5":"NA","6":"NA","_rn_":"2"},{"1":"BCT usage","2":"0.761","3":"0.421","4":"NA","5":"NA","6":"NA","_rn_":"3"},{"1":"Intrinsic","2":"0.621","3":"0.614","4":"NA","5":"NA","6":"NA","_rn_":"4"},{"1":"Identified","2":"0.628","3":"0.606","4":"NA","5":"NA","6":"NA","_rn_":"5"},{"1":"Introjected","2":"NA","3":"NA","4":"0.702","5":"0.160","6":"0.645","_rn_":"6"},{"1":"Extrinsic","2":"NA","3":"NA","4":"0.912","5":"0.135","6":"0.898","_rn_":"7"},{"1":"Amotivation","2":"NA","3":"NA","4":"0.907","5":"0.012","6":"0.906","_rn_":"8"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[15],"max":[15]},"pages":{}}}
  </script>
</div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># Take R2 from gaussian, CC from categorical variables </span>
pie_errors &lt;-<span class="st"> </span><span class="kw">c</span>(pred_obj<span class="op">$</span>errors[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>, <span class="dv">3</span>],
                pred_obj<span class="op">$</span>errors[<span class="dv">6</span><span class="op">:</span><span class="dv">8</span>, <span class="dv">4</span>])

<span class="co"># Coloring nodes: make a sequence of colors from the viridis palette. We need three colors (MVPA, BCTs, motivation), and &quot;begin&quot; from ones that are not too dark, so that black text shows up ok.</span>

node_colors &lt;-<span class="st"> </span><span class="kw">c</span>(viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">5</span>, <span class="dt">begin =</span> <span class="fl">0.4</span>, <span class="dt">end =</span> <span class="fl">0.99</span>)[<span class="dv">1</span>], <span class="co"># Color 1 for MVPA (questionnaire)</span>
                 viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">5</span>, <span class="dt">begin =</span> <span class="fl">0.4</span>, <span class="dt">end =</span> <span class="fl">0.99</span>)[<span class="dv">1</span>], <span class="co"># Color 1 for MVPA (accelerometer)</span>
                 <span class="kw">rep</span>(viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">5</span>, <span class="dt">begin =</span> <span class="fl">0.4</span>, <span class="dt">end =</span> <span class="fl">0.99</span>)[<span class="dv">4</span>], <span class="dv">1</span>), <span class="co"># 1x Color 4 for BCTs</span>
                 <span class="kw">rep</span>(viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">5</span>, <span class="dt">begin =</span> <span class="fl">0.4</span>, <span class="dt">end =</span> <span class="fl">0.99</span>)[<span class="dv">2</span>], <span class="dv">2</span>), <span class="co"># 2x Color 2 for autonomous</span>
                 <span class="kw">rep</span>(viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">5</span>, <span class="dt">begin =</span> <span class="fl">0.4</span>, <span class="dt">end =</span> <span class="fl">0.99</span>)[<span class="dv">3</span>], <span class="dv">3</span>)) <span class="co"># 3x Color 3 for controlled/amotivation</span>

BCT_mgm &lt;-<span class="st"> </span>qgraph<span class="op">::</span><span class="kw">qgraph</span>(mgm_obj<span class="op">$</span>pairwise<span class="op">$</span>wadj, 
            <span class="dt">layout =</span> <span class="st">&quot;spring&quot;</span>,
            <span class="dt">repulsion =</span> <span class="dv">1</span>, <span class="co"># To nudge the network from originally bad visual state</span>
            <span class="co"># title = &quot;Mixed graphical model: PA, BCTs &amp; motivation&quot;,</span>
            <span class="dt">edge.color =</span> <span class="kw">ifelse</span>(mgm_obj<span class="op">$</span>pairwise<span class="op">$</span>edgecolor <span class="op">==</span><span class="st"> &quot;darkgreen&quot;</span>, <span class="st">&quot;blue&quot;</span>, mgm_obj<span class="op">$</span>pairwise<span class="op">$</span>edgecolor),
            <span class="dt">pie =</span> pie_errors,
            <span class="dt">pieColor =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">5</span>, <span class="dt">begin =</span> <span class="fl">0.3</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">5</span>],
            <span class="dt">color =</span> node_colors,
            <span class="dt">labels =</span> <span class="kw">names</span>(bctdf_mgm),
            <span class="dt">label.cex =</span> <span class="fl">0.8</span>,
            <span class="dt">label.scale =</span> <span class="ot">FALSE</span>,
            <span class="dt">node.width =</span> <span class="fl">1.65</span>)</code></pre></div>
<p><img src="baseline-networks_files/figure-html/unnamed-chunk-7-1.png" width="2100" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># BCT_mgm_withAmotivation_stability &lt;- mgm::resample(object = mgm_obj, data = bctdf_mgm, nB = 100)</span>
<span class="co"># save(BCT_mgm_withAmotivation_stability, file = &quot;./Rdata_files/BCT_mgm_withAmotivation_stability.Rdata&quot;)</span>
<span class="kw">load</span>(<span class="st">&quot;./Rdata_files/BCT_mgm_withAmotivation_stability.Rdata&quot;</span>)

mgm<span class="op">::</span><span class="kw">plotRes</span>(<span class="dt">object =</span> BCT_mgm_withAmotivation_stability, 
        <span class="dt">quantiles =</span> <span class="kw">c</span>(.<span class="dv">05</span>, .<span class="dv">95</span>), 
        <span class="dt">cex.label =</span> <span class="fl">1.25</span>, 
        <span class="dt">lwd.qtl =</span> <span class="fl">2.5</span>, 
        <span class="dt">cex.mean =</span> .<span class="dv">5</span>)</code></pre></div>
<p><img src="baseline-networks_files/figure-html/unnamed-chunk-7-2.png" width="2100" /></p>
<p>Theory-wise, Amotivation should be negatively correlated with everything but Extrinsic and Introjected. Given that BCT usage is 19 items, there are probably a lot of ways there can be a positive correlation, although that would be unexpected. But the positive relation with MVPA questionnaire would mean, that people who report having done physical activity on more days last week, would also say they don’t see any point in doing physical activity (another example item: I think exercising is a waste of time). One explanation would be some form of <a href="https://web.archive.org/web/20180807095037/http://www.the100.ci/2017/03/14/that-one-weird-third-variable-problem-nobody-ever-mentions-conditioning-on-a-collider/">conditioning on a collider</a>.</p>
<p>One option would be, that (as the model drops incomplete observations), there is some selection effects based on motivation types and/or BCT usage. To check for this, we estimate a Gaussian Graphical Model, which assumes normally distributed data but uses all observations.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">bctdf_ggm &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(
  <span class="st">&#39;agr-BCTs&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_T1,
  <span class="st">&#39;frq-BCTs&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_T1,
  <span class="st">&#39;MVPA questionnaire&#39;</span> =<span class="st"> </span>padaysLastweek_T1,
  <span class="st">&#39;MVPA accelerometer&#39;</span> =<span class="st"> </span>mvpaAccelerometer_T1,
  <span class="st">&#39;Intrinsic&#39;</span> =<span class="st"> </span>PA_intrinsic_T1,
  <span class="st">&#39;Identified&#39;</span> =<span class="st"> </span>PA_identified_T1,
  <span class="st">&#39;Introjected&#39;</span> =<span class="st"> </span>PA_introjected_T1,
  <span class="st">&#39;Extrinsic&#39;</span> =<span class="st"> </span>PA_extrinsic_T1,
  <span class="st">&#39;Amotivation&#39;</span> =<span class="st"> </span>PA_amotivation_T1) <span class="op">%&gt;%</span>
<span class="st"> </span><span class="kw">rowwise</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st"> </span><span class="kw">mutate</span>(
  <span class="st">&#39;BCT usage&#39;</span> =<span class="st"> </span><span class="kw">mean</span>(<span class="kw">c</span>(<span class="st">`</span><span class="dt">agr-BCTs</span><span class="st">`</span>, <span class="st">`</span><span class="dt">frq-BCTs</span><span class="st">`</span>), <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),
  <span class="co"># &#39;autonomous motivation&#39; = mean(c(identified, intrinsic), na.rm = TRUE),</span>
  <span class="st">&#39;Extrinsic&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">Extrinsic</span><span class="st">`</span> <span class="op">&lt;</span><span class="st"> </span><span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">1</span>), <span class="co"># If &quot;at least partly&quot; or more true, input 1. Normality otherwise a problem.</span>
  <span class="st">&#39;Amotivation&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">Amotivation</span><span class="st">`</span> <span class="op">&lt;</span><span class="st"> </span><span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">1</span>), <span class="co"># If &quot;at least partly&quot; or more true, input 1. Normality otherwise a problem.</span>
  <span class="st">&#39;Introjected&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">Introjected</span><span class="st">`</span> <span class="op">&lt;</span><span class="st"> </span><span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">1</span>)) <span class="op">%&gt;%</span><span class="st">  </span><span class="co"># If &quot;at least partly&quot; or more true, input 1. Normality otherwise a problem. </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="st">&#39;MVPA questionnaire&#39;</span>, <span class="st">&#39;MVPA accelerometer&#39;</span>, <span class="st">&#39;BCT usage&#39;</span>, <span class="kw">everything</span>(), <span class="op">-</span><span class="kw">contains</span>(<span class="st">&quot;-BCTs&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate_all</span>(as.numeric)

bctdf_ggm<span class="op">$</span><span class="st">`</span><span class="dt">BCT usage</span><span class="st">`</span>[<span class="kw">is.nan</span>(bctdf_ggm<span class="op">$</span><span class="st">`</span><span class="dt">BCT usage</span><span class="st">`</span>)] &lt;-<span class="st"> </span><span class="ot">NA</span>

<span class="co"># Network for all participants</span>
S.total_ggm &lt;-<span class="st"> </span>bctdf_ggm
nwBCT_ggm &lt;-<span class="st"> </span>bootnet<span class="op">::</span><span class="kw">estimateNetwork</span>(S.total_ggm, <span class="dt">default=</span><span class="st">&quot;EBICglasso&quot;</span>)

labs_ggm &lt;-<span class="st"> </span><span class="kw">colnames</span>(S.total_ggm)

<span class="co"># Create means for filling nodes</span>
<span class="co"># piefill_ggm &lt;- S.total_ggm %&gt;% </span>
<span class="co">#   dplyr::select(-contains(&quot;MVPA&quot;), -contains(&quot;motivation&quot;)) %&gt;% data.frame %&gt;% </span>
<span class="co">#   dplyr::summarise_all(funs(mean(., na.rm = TRUE) /6))</span>
<span class="co"># </span>
<span class="co"># piefill_ggm$`MVPA accelerometer` &lt;- median(S.total_ggm$`MVPA accelerometer`, na.rm = TRUE) / (60 * 24)</span>
<span class="co"># piefill_ggm$`MVPA questionnaire` &lt;- median(S.total_ggm$`MVPA questionnaire`, na.rm = TRUE) / 7</span>
<span class="co"># piefill_ggm$autonomous &lt;- median(S.total_ggm$`autonomous motivation`, na.rm = TRUE) / 5</span>
<span class="co"># piefill_ggm$controlled &lt;- median(S.total_ggm$`controlled motivation`, na.rm = TRUE) / 5</span>
<span class="co">#   </span>
<span class="co"># piefill_ggm &lt;- piefill_ggm %&gt;% </span>
<span class="co">#   dplyr::select(&quot;MVPA questionnaire&quot;, &quot;MVPA accelerometer&quot;, autonomous, controlled, everything())</span>

<span class="co"># Plot network</span>

BCT_ggm &lt;-<span class="st"> </span><span class="kw">plot</span>(nwBCT_ggm, 
                <span class="dt">layout =</span> <span class="st">&quot;spring&quot;</span>, 
                <span class="dt">repulsion =</span> <span class="fl">0.99</span>, <span class="co"># To nudge the network from originally bad visual state</span>
                <span class="dt">label.scale =</span> <span class="ot">FALSE</span>, 
                <span class="dt">title =</span> <span class="st">&quot;GGM: MVPA, BCTs &amp; motivation&quot;</span>, 
                <span class="dt">label.cex =</span> <span class="fl">0.75</span>,
                <span class="co"># pie = piefill_ggm,</span>
                <span class="dt">color =</span> <span class="st">&quot;skyblue&quot;</span>,
                <span class="dt">pieBorder =</span> <span class="dv">1</span>)</code></pre></div>
<p><img src="baseline-networks_files/figure-html/selection-collider-check-ggm-1.png" width="2100" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">

qgraph<span class="op">::</span><span class="kw">flow</span>(BCT_ggm, <span class="st">&quot;MVPA accelerometer&quot;</span>, <span class="dt">theme =</span> <span class="st">&quot;colorblind&quot;</span>, <span class="dt">vsize =</span> <span class="dv">8</span>)</code></pre></div>
<p><img src="baseline-networks_files/figure-html/selection-collider-check-ggm-2.png" width="2100" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">qgraph<span class="op">::</span><span class="kw">flow</span>(BCT_ggm, <span class="st">&quot;MVPA questionnaire&quot;</span>, <span class="dt">theme =</span> <span class="st">&quot;colorblind&quot;</span>, <span class="dt">vsize =</span> <span class="dv">8</span>)</code></pre></div>
<p><img src="baseline-networks_files/figure-html/selection-collider-check-ggm-3.png" width="2100" /></p>
<p>From the network above, we see that the positive connection between amotivation and questionnaire-measured MVPA has almost completely disappered. Bootstrapping to inspect stability shows, that the connection is likely to be zero (see 13th edge from the bottom; “MVPA questionnaire–Amotivation”).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># collider_boot &lt;- bootnet(nwBCT_ggm, nBoots = 2500)</span>
<span class="co"># save(collider_boot, file = &quot;./Rdata_files/collider_boot.Rdata&quot;)</span>
<span class="kw">load</span>(<span class="st">&quot;./Rdata_files/collider_boot.Rdata&quot;</span>)
<span class="kw">plot</span>(collider_boot, <span class="dt">plot =</span> <span class="st">&quot;interval&quot;</span>, <span class="dt">split0 =</span> <span class="ot">TRUE</span>, <span class="dt">order =</span> <span class="st">&quot;sample&quot;</span>, <span class="dt">labels =</span> <span class="ot">TRUE</span>)</code></pre></div>
<p><img src="baseline-networks_files/figure-html/stability-1.png" width="2100" /></p>
<p>The bootstrap stability plot above (for a tutorial, see <a href="http://psych-networks.com/bootstrapping-edges-after-regularization-clarifications-tutorial/">this link</a> – or, if it’s down, this <a href="https://web.archive.org/web/20180809113839/http://psych-networks.com/bootstrapping-edges-after-regularization-clarifications-tutorial/">archived page</a>) shows, that when we draw observations from the sample with replacement 2500 times, the connection between amotivation and questionnaire-measured MVPA was estimated as non-zero only about 30% of time.</p>
</div>
<div id="combining-some-bct-items" class="section level1">
<h1>Combining some BCT items</h1>
<p>This section presents a Mixed Graphical Model (MGM) and a Gaussian Graphical Model (GGM). In the MGM, we opted to dichotomise the BCTs in order to increase interpretability while not violating model assumptions. Results do not differ very much. Some nodes were still combined, to reduce estimation burden.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">bctdf_mgm &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(
<span class="co">#  id,</span>
<span class="co">#  intervention,</span>
<span class="co">#  group,</span>
<span class="co">#  school,</span>
<span class="co">#  girl,</span>
  <span class="st">&#39;goal setting&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_01_T1,
  <span class="st">&#39;implementation plan&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_02_T1,
  <span class="st">&#39;plan by other&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_03_T1,
  <span class="st">&#39;reminder of plan&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_04_T1,
  <span class="st">&#39;subgoals&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_05_T1,
  <span class="st">&#39;new PA options&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_06_T1,
  <span class="st">&#39;barrier identification&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_07_T1,
  <span class="st">&#39;coping planning&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_08_T1,
  <span class="st">&#39;PA identity&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_09_T1,
  <span class="st">&#39;PA life values&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_10_T1,
  <span class="st">&#39;positive consequences&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_01_T1,
  <span class="st">&#39;log on paper&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_02_T1,
  <span class="st">&#39;smartphone&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_03_T1,
<span class="co">#  &#39;mnemonic cues&#39; = PA_frequencyDependentBCT_04_T1, # Issues with clarity of item wording </span>
  <span class="st">&#39;goal contrast&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_05_T1,
  <span class="st">&#39;relevance of PA&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_06_T1,
  <span class="st">&#39;changes at home&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_07_T1,
  <span class="st">&#39;social support&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_08_T1,
  <span class="st">&#39;failure contemplation&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_09_T1,
  <span class="st">&#39;MVPA questionnaire&#39;</span> =<span class="st"> </span>padaysLastweek_T1,
  <span class="st">&#39;MVPA accelerometer&#39;</span> =<span class="st"> </span>mvpaAccelerometer_T1,
  <span class="st">&#39;intrinsic&#39;</span> =<span class="st"> </span>PA_intrinsic_T1,
  <span class="st">&#39;identified&#39;</span> =<span class="st"> </span>PA_identified_T1,
  <span class="st">&#39;controlled motivation&#39;</span> =<span class="st"> </span>PA_controlled_T1) <span class="op">%&gt;%</span>
<span class="st"> </span><span class="kw">rowwise</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st"> </span><span class="kw">mutate</span>(
  <span class="st">&#39;goal setting&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">goal setting</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
<span class="co">#  &#39;has plan&#39; = ifelse(`implementation plan` == 1 &amp; `plan by other` == 1, 0, 1),</span>
  <span class="st">&#39;implementation plan&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">implementation plan</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
  <span class="st">&#39;plan by other&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">plan by other</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
  <span class="st">&#39;reminder of plan&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">reminder of plan</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
  <span class="st">&#39;subgoals&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">subgoals</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
  <span class="st">&#39;new PA options&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">new PA options</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
<span class="co">#  &#39;barrier identification&#39; = ifelse(`barrier identification` == 1, 0, 1),</span>
<span class="co">#  &#39;coping planning&#39; = ifelse(`coping planning` == 1, 0, 1),</span>
  <span class="st">&#39;barriers identified or planned for&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">coping planning</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span> <span class="op">&amp;</span><span class="st"> `</span><span class="dt">barrier identification</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
<span class="co">#  &#39;PA identity&#39; = ifelse(`PA identity` == 1, 0, 1),</span>
<span class="co">#  &#39;PA life values&#39; = ifelse(`PA life values` == 1, 0, 1),</span>
  <span class="st">&#39;identity, life values&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">PA identity</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span> <span class="op">&amp;</span><span class="st"> `</span><span class="dt">PA life values</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
  <span class="st">&#39;positive consequences&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">positive consequences</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
  <span class="st">&#39;monitoring PA&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">log on paper</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span> <span class="op">&amp;</span><span class="st"> `</span><span class="dt">smartphone</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
<span class="co">#  &#39;mnemonic cues&#39; = ifelse(`mnemonic cues` == 1, 0, 1),</span>
  <span class="st">&#39;goal contrast&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">goal contrast</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
  <span class="st">&#39;relevance of PA&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">relevance of PA</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
  <span class="st">&#39;changes at home&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">changes at home</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
  <span class="st">&#39;social support&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">social support</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
  <span class="st">&#39;failure contemplation&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">failure contemplation</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
  <span class="st">&#39;autonomous motivation&#39;</span> =<span class="st"> </span><span class="kw">mean</span>(<span class="kw">c</span>(identified, intrinsic), <span class="dt">na.rm =</span> T),
<span class="co">#  &#39;girl&#39; = ifelse(girl == &quot;girl&quot;, 1, 0),</span>
  <span class="st">&#39;controlled motivation&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">controlled motivation</span><span class="st">`</span> <span class="op">&lt;</span><span class="st"> </span><span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">1</span>)) <span class="op">%&gt;%</span><span class="st">  </span><span class="co"># If &quot;at least partly&quot; or more true, input 1. Normality otherwise a problem. </span>
<span class="co">#  &#39;intervention&#39; = ifelse(intervention == &quot;1&quot;, 1, 0)) %&gt;% </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span><span class="st">`</span><span class="dt">log on paper</span><span class="st">`</span>, <span class="op">-</span><span class="st">`</span><span class="dt">smartphone</span><span class="st">`</span>, 
                <span class="co"># -`plan by other`, -`implementation plan`, </span>
                <span class="op">-</span>identified, <span class="op">-</span>intrinsic,
         <span class="op">-</span><span class="st">`</span><span class="dt">failure contemplation</span><span class="st">`</span>, <span class="co"># only concerns those who haven&#39;t reached goals</span>
         <span class="op">-</span><span class="st">`</span><span class="dt">barrier identification</span><span class="st">`</span>, <span class="op">-</span><span class="st">`</span><span class="dt">coping planning</span><span class="st">`</span>, <span class="co"># closely related</span>
         <span class="op">-</span><span class="st">`</span><span class="dt">PA identity</span><span class="st">`</span>, <span class="op">-</span><span class="st">`</span><span class="dt">PA life values</span><span class="st">`</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># closely related</span>
<span class="co">#  dplyr::select(-controlled) %&gt;% # Not really gaussian at all </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="st">&#39;MVPA questionnaire&#39;</span>, <span class="st">&#39;MVPA accelerometer&#39;</span>, <span class="kw">everything</span>())

bctdf_mgm<span class="op">$</span><span class="st">`</span><span class="dt">autonomous motivation</span><span class="st">`</span>[<span class="kw">is.nan</span>(bctdf_mgm<span class="op">$</span><span class="st">`</span><span class="dt">autonomous motivation</span><span class="st">`</span>)] &lt;-<span class="st"> </span><span class="ot">NA</span>

labs &lt;-<span class="st"> </span><span class="kw">names</span>(bctdf_mgm)</code></pre></div>
<div id="mgm-estimation" class="section level4">
<h4>mgm estimation</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># devtools::install_github(&quot;jmbh/mgm&quot;)</span>
<span class="co"># Restart R for the latest package</span>
<span class="co"># .r.restartR()</span>

<span class="co"># mgm wants full data, see package missForest for imputation methods</span>
bctdf_mgm &lt;-<span class="st"> </span>bctdf_mgm <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">na.omit</span>(.)
<span class="co"># bctdf_mgm %&gt;% names()</span>
mgm_variable_types &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;g&quot;</span>, <span class="st">&quot;g&quot;</span>, <span class="kw">rep</span>(<span class="st">&quot;c&quot;</span>, <span class="dv">15</span>), <span class="st">&quot;g&quot;</span>)
mgm_variable_levels &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;1&quot;</span>, <span class="st">&quot;1&quot;</span>, <span class="kw">rep</span>(<span class="st">&quot;2&quot;</span>, <span class="dv">15</span>), <span class="st">&quot;1&quot;</span>)
<span class="co"># data.frame(mgm_variable_types, mgm_variable_levels, names(bctdf_mgm))</span>

mgm_obj &lt;-<span class="st"> </span>mgm<span class="op">::</span><span class="kw">mgm</span>(<span class="dt">data =</span> bctdf_mgm,
  <span class="dt">type =</span> mgm_variable_types,
  <span class="dt">level =</span> mgm_variable_levels,
  <span class="dt">lambdaSel =</span> <span class="st">&quot;CV&quot;</span>,
  <span class="dt">lambdaFolds =</span> <span class="dv">10</span>,
  <span class="dt">pbar =</span> <span class="ot">FALSE</span>, 
  <span class="dt">binarySign =</span> <span class="ot">TRUE</span>)
## Note that the sign of parameter estimates is stored separately; see ?mgm

pred_obj &lt;-<span class="st"> </span><span class="kw">predict</span>(<span class="dt">object =</span> mgm_obj,
                         <span class="dt">data =</span> bctdf_mgm)

pred_obj<span class="op">$</span>errors</code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Variable"],"name":[1],"type":["chr"],"align":["left"]},{"label":["RMSE"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["R2"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["CC"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["nCC"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["CCmarg"],"name":[6],"type":["dbl"],"align":["right"]}],"data":[{"1":"MVPA questionnaire","2":"0.847","3":"0.282","4":"NA","5":"NA","6":"NA","_rn_":"1"},{"1":"MVPA accelerometer","2":"0.961","3":"0.075","4":"NA","5":"NA","6":"NA","_rn_":"2"},{"1":"goal setting","2":"NA","3":"NA","4":"0.906","5":"0.563","6":"0.785","_rn_":"3"},{"1":"implementation plan","2":"NA","3":"NA","4":"0.890","5":"0.621","6":"0.710","_rn_":"4"},{"1":"plan by other","2":"NA","3":"NA","4":"0.785","5":"0.549","6":"0.523","_rn_":"5"},{"1":"reminder of plan","2":"NA","3":"NA","4":"0.842","5":"0.651","6":"0.547","_rn_":"6"},{"1":"subgoals","2":"NA","3":"NA","4":"0.861","5":"0.641","6":"0.613","_rn_":"7"},{"1":"new PA options","2":"NA","3":"NA","4":"0.844","5":"0.422","6":"0.730","_rn_":"8"},{"1":"positive consequences","2":"NA","3":"NA","4":"0.901","5":"0.250","6":"0.868","_rn_":"9"},{"1":"goal contrast","2":"NA","3":"NA","4":"0.820","5":"0.617","6":"0.530","_rn_":"10"},{"1":"relevance of PA","2":"NA","3":"NA","4":"0.881","5":"0.467","6":"0.777","_rn_":"11"},{"1":"changes at home","2":"NA","3":"NA","4":"0.752","5":"0.452","6":"0.547","_rn_":"12"},{"1":"social support","2":"NA","3":"NA","4":"0.761","5":"0.496","6":"0.526","_rn_":"13"},{"1":"controlled motivation","2":"NA","3":"NA","4":"0.883","5":"0.000","6":"0.883","_rn_":"14"},{"1":"barriers identified or planned for","2":"NA","3":"NA","4":"0.890","5":"0.461","6":"0.796","_rn_":"15"},{"1":"identity, life values","2":"NA","3":"NA","4":"0.924","5":"0.442","6":"0.864","_rn_":"16"},{"1":"monitoring PA","2":"NA","3":"NA","4":"0.744","5":"0.432","6":"0.549","_rn_":"17"},{"1":"autonomous motivation","2":"0.785","3":"0.382","4":"NA","5":"NA","6":"NA","_rn_":"18"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[15],"max":[15]},"pages":{}}}
  </script>
</div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># Take R2 from gaussian, CC from categorical variables </span>
pie_errors &lt;-<span class="st"> </span><span class="kw">c</span>(pred_obj<span class="op">$</span>errors[<span class="dv">1</span>, <span class="dv">3</span>],
                pred_obj<span class="op">$</span>errors[<span class="dv">2</span>, <span class="dv">3</span>],
                pred_obj<span class="op">$</span>errors[<span class="dv">3</span><span class="op">:</span><span class="dv">17</span>, <span class="dv">4</span>],
                pred_obj<span class="op">$</span>errors[<span class="dv">18</span>, <span class="dv">3</span>])</code></pre></div>
</div>
<div id="mgm-plotting" class="section level4">
<h4>mgm plotting</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Coloring nodes: make a sequence of colors from the viridis palette. We need three colors (MVPA, BCTs, motivation), and &quot;begin&quot; from ones that are not too dark, so that black text shows up ok.</span>

node_colors &lt;-<span class="st"> </span><span class="kw">c</span>(viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">3</span>, <span class="dt">begin =</span> <span class="fl">0.4</span>, <span class="dt">end =</span> <span class="fl">0.99</span>)[<span class="dv">1</span>], <span class="co"># Color 1 for MVPA (questionnaire)</span>
                 viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">3</span>, <span class="dt">begin =</span> <span class="fl">0.4</span>, <span class="dt">end =</span> <span class="fl">0.99</span>)[<span class="dv">1</span>], <span class="co"># Color 1 for MVPA (accelerometer)</span>
                 <span class="kw">rep</span>(viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">3</span>, <span class="dt">begin =</span> <span class="fl">0.4</span>, <span class="dt">end =</span> <span class="fl">0.99</span>)[<span class="dv">2</span>], <span class="dv">11</span>), <span class="co"># 11x Color 2 for BCTs</span>
                 <span class="kw">rep</span>(viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">3</span>, <span class="dt">begin =</span> <span class="fl">0.4</span>, <span class="dt">end =</span> <span class="fl">0.99</span>)[<span class="dv">3</span>], <span class="dv">1</span>), <span class="co"># Color 3 for motivation (controlled)  </span>
                 <span class="kw">rep</span>(viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">3</span>, <span class="dt">begin =</span> <span class="fl">0.4</span>, <span class="dt">end =</span> <span class="fl">0.99</span>)[<span class="dv">2</span>], <span class="dv">3</span>), <span class="co"># 3x Color 2 for BCTs</span>
                 viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">3</span>, <span class="dt">begin =</span> <span class="fl">0.4</span>, <span class="dt">end =</span> <span class="fl">0.99</span>)[<span class="dv">3</span>]) <span class="co"># Color 3 for motivation (autonomous) </span>

BCT_mgm &lt;-<span class="st"> </span>qgraph<span class="op">::</span><span class="kw">qgraph</span>(mgm_obj<span class="op">$</span>pairwise<span class="op">$</span>wadj, 
            <span class="dt">layout =</span> <span class="st">&quot;spring&quot;</span>,
            <span class="dt">repulsion =</span> <span class="fl">0.9999</span>, <span class="co"># To nudge the network from originally bad visual state</span>
            <span class="dt">title =</span> <span class="st">&quot;Mixed graphical model: PA, BCTs &amp; motivation&quot;</span>,
            <span class="dt">edge.color =</span> <span class="kw">ifelse</span>(mgm_obj<span class="op">$</span>pairwise<span class="op">$</span>edgecolor <span class="op">==</span><span class="st"> &quot;darkgreen&quot;</span>, <span class="st">&quot;blue&quot;</span>, mgm_obj<span class="op">$</span>pairwise<span class="op">$</span>edgecolor),
            <span class="dt">pie =</span> pie_errors,
            <span class="dt">pieColor =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">5</span>, <span class="dt">begin =</span> <span class="fl">0.3</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">5</span>],
            <span class="dt">color =</span> node_colors,
            <span class="dt">labels =</span> <span class="kw">names</span>(bctdf_mgm),
            <span class="dt">label.cex =</span> <span class="fl">0.75</span>,
            <span class="dt">label.scale =</span> <span class="ot">FALSE</span>)</code></pre></div>
<p><img src="baseline-networks_files/figure-html/allBctsMotiSurveyPA-mgm-plot-1.png" width="2100" /></p>
</div>
<div id="ggm-estimation-plotting" class="section level3">
<h3>ggm estimation &amp; plotting</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
bctdf_ggm &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(
<span class="co">#  id,</span>
<span class="co">#  intervention,</span>
<span class="co">#  group,</span>
<span class="co">#  school,</span>
<span class="co">#  girl,</span>
  <span class="st">&#39;goal setting&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_01_T1,
  <span class="st">&#39;implementation plan&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_02_T1,
  <span class="st">&#39;plan by other&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_03_T1,
  <span class="st">&#39;reminder of plan&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_04_T1,
  <span class="st">&#39;subgoals&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_05_T1,
  <span class="st">&#39;new PA options&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_06_T1,
  <span class="st">&#39;barrier identification&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_07_T1,
  <span class="st">&#39;coping planning&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_08_T1,
  <span class="st">&#39;PA identity&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_09_T1,
  <span class="st">&#39;PA life values&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_10_T1,
  <span class="st">&#39;positive consequences&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_01_T1,
  <span class="st">&#39;log on paper&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_02_T1,
  <span class="st">&#39;smartphone&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_03_T1,
<span class="co">#  &#39;mnemonic cues&#39; = PA_frequencyDependentBCT_04_T1,</span>
  <span class="st">&#39;goal contrast&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_05_T1,
  <span class="st">&#39;relevance of PA&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_06_T1,
  <span class="st">&#39;changes at home&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_07_T1,
  <span class="st">&#39;social support&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_08_T1,
  <span class="st">&#39;failure contemplated&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_09_T1,
  <span class="st">&#39;MVPA questionnaire&#39;</span> =<span class="st"> </span>padaysLastweek_T1,
  <span class="st">&#39;MVPA accelerometer&#39;</span> =<span class="st"> </span>mvpaAccelerometer_T1,
  <span class="st">&#39;intrinsic&#39;</span> =<span class="st"> </span>PA_intrinsic_T1,
  <span class="st">&#39;identified&#39;</span> =<span class="st"> </span>PA_identified_T1,
  <span class="st">&#39;controlled motivation&#39;</span> =<span class="st"> </span>PA_controlled_T1) <span class="op">%&gt;%</span>
<span class="st"> </span><span class="kw">rowwise</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st"> </span><span class="kw">mutate</span>(
<span class="co">#  &#39;has plan&#39; = mean(c(`implementation plan`, `plan by other`), na.rm = TRUE),</span>
  <span class="st">&#39;barriers identified or planned for&#39;</span> =<span class="st"> </span><span class="kw">mean</span>(<span class="kw">c</span>(<span class="st">`</span><span class="dt">coping planning</span><span class="st">`</span>, <span class="st">`</span><span class="dt">barrier identification</span><span class="st">`</span>), <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),
  <span class="st">&#39;identity, life values&#39;</span> =<span class="st"> </span><span class="kw">mean</span>(<span class="kw">c</span>(<span class="st">`</span><span class="dt">PA identity</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="st">`</span><span class="dt">PA life values</span><span class="st">`</span>), <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),
  <span class="st">&#39;monitoring PA&#39;</span> =<span class="st"> </span><span class="kw">mean</span>(<span class="kw">c</span>(<span class="st">`</span><span class="dt">log on paper</span><span class="st">`</span>, <span class="st">`</span><span class="dt">smartphone</span><span class="st">`</span>), <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),
  <span class="st">&#39;autonomous motivation&#39;</span> =<span class="st"> </span><span class="kw">mean</span>(<span class="kw">c</span>(identified, intrinsic), <span class="dt">na.rm =</span> T)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="co">#  &#39;girl&#39; = ifelse(girl == &quot;girl&quot;, 1, 0),</span>
<span class="co">#  &#39;intervention&#39; = ifelse(intervention == &quot;1&quot;, 1, 0)) %&gt;% </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span><span class="st">`</span><span class="dt">log on paper</span><span class="st">`</span>, <span class="op">-</span><span class="st">`</span><span class="dt">smartphone</span><span class="st">`</span>, 
<span class="co">#                -`plan by other`, -`implementation plan`,</span>
                <span class="op">-</span>identified, <span class="op">-</span>intrinsic,
         <span class="op">-</span><span class="st">`</span><span class="dt">failure contemplated</span><span class="st">`</span>, <span class="co"># only concerns those who haven&#39;t reached goals</span>
         <span class="op">-</span><span class="st">`</span><span class="dt">barrier identification</span><span class="st">`</span>, <span class="op">-</span><span class="st">`</span><span class="dt">coping planning</span><span class="st">`</span>, <span class="co"># closely related</span>
         <span class="op">-</span><span class="st">`</span><span class="dt">PA identity</span><span class="st">`</span>, <span class="op">-</span><span class="st">`</span><span class="dt">PA life values</span><span class="st">`</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># closely related</span>
<span class="co">#  dplyr::select(-controlled) %&gt;% # Not really gaussian at all </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="st">&quot;MVPA questionnaire&quot;</span>, <span class="st">&quot;MVPA accelerometer&quot;</span>, <span class="st">&quot;autonomous motivation&quot;</span>, <span class="st">&quot;controlled motivation&quot;</span>, <span class="kw">everything</span>()) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate_all</span>(as.numeric)

<span class="co"># Network for all participants</span>
S.total_ggm &lt;-<span class="st"> </span>bctdf_ggm
nwBCT_ggm &lt;-<span class="st"> </span>bootnet<span class="op">::</span><span class="kw">estimateNetwork</span>(S.total_ggm, <span class="dt">default=</span><span class="st">&quot;EBICglasso&quot;</span>)

labs_ggm &lt;-<span class="st"> </span><span class="kw">colnames</span>(S.total_ggm)

<span class="co"># Create means for filling nodes</span>
piefill_ggm &lt;-<span class="st"> </span>S.total_ggm <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span><span class="kw">contains</span>(<span class="st">&quot;MVPA&quot;</span>), <span class="op">-</span><span class="kw">contains</span>(<span class="st">&quot;motivation&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>data.frame <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">summarise_all</span>(<span class="kw">funs</span>(<span class="kw">mean</span>(., <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">/</span><span class="dv">6</span>))

piefill_ggm<span class="op">$</span><span class="st">`</span><span class="dt">MVPA accelerometer</span><span class="st">`</span> &lt;-<span class="st"> </span><span class="kw">median</span>(S.total_ggm<span class="op">$</span><span class="st">`</span><span class="dt">MVPA accelerometer</span><span class="st">`</span>, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">/</span><span class="st"> </span>(<span class="dv">60</span> <span class="op">*</span><span class="st"> </span><span class="dv">24</span>)
piefill_ggm<span class="op">$</span><span class="st">`</span><span class="dt">MVPA questionnaire</span><span class="st">`</span> &lt;-<span class="st"> </span><span class="kw">median</span>(S.total_ggm<span class="op">$</span><span class="st">`</span><span class="dt">MVPA questionnaire</span><span class="st">`</span>, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">/</span><span class="st"> </span><span class="dv">7</span>
piefill_ggm<span class="op">$</span>autonomous &lt;-<span class="st"> </span><span class="kw">median</span>(S.total_ggm<span class="op">$</span><span class="st">`</span><span class="dt">autonomous motivation</span><span class="st">`</span>, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">/</span><span class="st"> </span><span class="dv">5</span>
piefill_ggm<span class="op">$</span>controlled &lt;-<span class="st"> </span><span class="kw">median</span>(S.total_ggm<span class="op">$</span><span class="st">`</span><span class="dt">controlled motivation</span><span class="st">`</span>, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">/</span><span class="st"> </span><span class="dv">5</span>
  
piefill_ggm &lt;-<span class="st"> </span>piefill_ggm <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="st">&quot;MVPA questionnaire&quot;</span>, <span class="st">&quot;MVPA accelerometer&quot;</span>, autonomous, controlled, <span class="kw">everything</span>())

<span class="co"># Plot network</span>

BCT_ggm &lt;-<span class="st"> </span><span class="kw">plot</span>(nwBCT_ggm, 
                <span class="dt">layout =</span> <span class="st">&quot;spring&quot;</span>, 
                <span class="dt">repulsion =</span> <span class="fl">0.99</span>, <span class="co"># To nudge the network from originally bad visual state</span>
                <span class="dt">label.scale =</span> <span class="ot">FALSE</span>, 
                <span class="dt">title =</span> <span class="st">&quot;GGM: MVPA, BCTs &amp; motivation&quot;</span>, 
                <span class="dt">label.cex =</span> <span class="fl">0.75</span>,
                <span class="dt">pie =</span> piefill_ggm,
                <span class="dt">color =</span> <span class="st">&quot;skyblue&quot;</span>,
                <span class="dt">pieBorder =</span> <span class="dv">1</span>)</code></pre></div>
<p><img src="baseline-networks_files/figure-html/allBctsMotiSurveyPA-ggm-1.png" width="2100" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">

qgraph<span class="op">::</span><span class="kw">flow</span>(BCT_ggm, <span class="st">&quot;MVPA accelerometer&quot;</span>, <span class="dt">theme =</span> <span class="st">&quot;colorblind&quot;</span>, <span class="dt">vsize =</span> <span class="dv">8</span>)</code></pre></div>
<p><img src="baseline-networks_files/figure-html/allBctsMotiSurveyPA-ggm-2.png" width="2100" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">qgraph<span class="op">::</span><span class="kw">flow</span>(BCT_ggm, <span class="st">&quot;MVPA questionnaire&quot;</span>, <span class="dt">theme =</span> <span class="st">&quot;colorblind&quot;</span>, <span class="dt">vsize =</span> <span class="dv">8</span>)</code></pre></div>
<p><img src="baseline-networks_files/figure-html/allBctsMotiSurveyPA-ggm-3.png" width="2100" /></p>
</div>
<div id="centrality-and-stability" class="section level3">
<h3>Centrality and stability</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
allBctsMotiSurveyPA &lt;-<span class="st"> </span>nwBCT_ggm

allBctsMotiSurveyPA_centralityPlot &lt;-<span class="st"> </span>qgraph<span class="op">::</span><span class="kw">centralityPlot</span>(allBctsMotiSurveyPA)</code></pre></div>
<p><img src="baseline-networks_files/figure-html/allBctsMotiSurveyPA-ggm-stability-1.png" width="2100" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
qgraph<span class="op">::</span><span class="kw">centrality</span>(allBctsMotiSurveyPA)<span class="op">$</span>InDegree <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">data.frame</span>(<span class="st">&quot;Node&quot;</span> =<span class="st"> </span><span class="kw">names</span>(.), <span class="st">&quot;Strength&quot;</span> =<span class="st"> </span>.) <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">arrange</span>(<span class="kw">desc</span>(Strength)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>papaja<span class="op">::</span><span class="kw">apa_table</span>()
## &lt;caption&gt;(\#tab:allBctsMotiSurveyPA-ggm-stability)&lt;/caption&gt;
## 
## &lt;caption&gt;**&lt;/caption&gt;
## 
## 
## 
## Node                                 Strength 
## -----------------------------------  ---------
## relevance of PA                      1.23     
## reminder of plan                     1.21     
## goal contrast                        1.18     
## implementation plan                  1.15     
## goal setting                         1.14     
## changes at home                      1.06     
## subgoals                             1.06     
## autonomous motivation                0.98     
## barriers identified or planned for   0.96     
## social support                       0.91     
## new PA options                       0.89     
## identity, life values                0.87     
## plan by other                        0.85     
## positive consequences                0.82     
## monitoring PA                        0.73     
## MVPA questionnaire                   0.68     
## MVPA accelerometer                   0.35     
## controlled motivation                0.27

<span class="kw">scale</span>(qgraph<span class="op">::</span><span class="kw">centrality</span>(allBctsMotiSurveyPA)<span class="op">$</span>InDegree) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">data.frame</span>(<span class="dt">Node =</span> <span class="kw">labels</span>(.), <span class="st">`</span><span class="dt">Standardised strength</span><span class="st">`</span> =<span class="st"> </span>.) <span class="op">%&gt;%</span>
<span class="st">  </span>plyr<span class="op">::</span><span class="kw">arrange</span>(<span class="kw">desc</span>(<span class="st">`</span><span class="dt">Standardised.strength</span><span class="st">`</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>papaja<span class="op">::</span><span class="kw">apa_table</span>()
## &lt;caption&gt;(\#tab:allBctsMotiSurveyPA-ggm-stability)&lt;/caption&gt;
## 
## &lt;caption&gt;**&lt;/caption&gt;
## 
## 
## 
## Node.c..MVPA.questionnaire....MVPA.accelerometer....autonomous.motivation...   Node..1.   Standardised.strength 
## -----------------------------------------------------------------------------  ---------  ----------------------
## relevance of PA                                                                1          1.20                  
## reminder of plan                                                               1          1.12                  
## goal contrast                                                                  1          0.99                  
## implementation plan                                                            1          0.88                  
## goal setting                                                                   1          0.87                  
## changes at home                                                                1          0.57                  
## subgoals                                                                       1          0.57                  
## autonomous motivation                                                          1          0.26                  
## barriers identified or planned for                                             1          0.19                  
## social support                                                                 1          -0.01                 
## new PA options                                                                 1          -0.05                 
## identity, life values                                                          1          -0.13                 
## plan by other                                                                  1          -0.22                 
## positive consequences                                                          1          -0.33                 
## monitoring PA                                                                  1          -0.66                 
## MVPA questionnaire                                                             1          -0.85                 
## MVPA accelerometer                                                             1          -2.04                 
## controlled motivation                                                          1          -2.35
  
qgraph<span class="op">::</span><span class="kw">centrality</span>(allBctsMotiSurveyPA)<span class="op">$</span>Closeness <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">Closeness =</span> .) <span class="op">%&gt;%</span><span class="st"> </span>papaja<span class="op">::</span><span class="kw">apa_table</span>()
## &lt;caption&gt;(\#tab:allBctsMotiSurveyPA-ggm-stability)&lt;/caption&gt;
## 
## &lt;caption&gt;**&lt;/caption&gt;
## 
## 
## 
##                                      Closeness 
## -----------------------------------  ----------
## MVPA questionnaire                   0.00      
## MVPA accelerometer                   0.00      
## autonomous motivation                0.00      
## controlled motivation                0.00      
## goal setting                         0.00      
## implementation plan                  0.00      
## plan by other                        0.00      
## reminder of plan                     0.01      
## subgoals                             0.00      
## new PA options                       0.00      
## positive consequences                0.00      
## goal contrast                        0.00      
## relevance of PA                      0.01      
## changes at home                      0.00      
## social support                       0.00      
## barriers identified or planned for   0.00      
## identity, life values                0.00      
## monitoring PA                        0.01

qgraph<span class="op">::</span><span class="kw">centrality</span>(allBctsMotiSurveyPA)<span class="op">$</span>Betweenness <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">names</span>(.), .) <span class="op">%&gt;%</span><span class="st"> </span>papaja<span class="op">::</span><span class="kw">apa_table</span>()
## &lt;caption&gt;(\#tab:allBctsMotiSurveyPA-ggm-stability)&lt;/caption&gt;
## 
## &lt;caption&gt;**&lt;/caption&gt;
## 
## 
## 
##                                      names...                             .     
## -----------------------------------  -----------------------------------  ------
## MVPA questionnaire                   MVPA questionnaire                   34.00 
## MVPA accelerometer                   MVPA accelerometer                   0.00  
## autonomous motivation                autonomous motivation                36.00 
## controlled motivation                controlled motivation                0.00  
## goal setting                         goal setting                         14.00 
## implementation plan                  implementation plan                  18.00 
## plan by other                        plan by other                        20.00 
## reminder of plan                     reminder of plan                     50.00 
## subgoals                             subgoals                             24.00 
## new PA options                       new PA options                       0.00  
## positive consequences                positive consequences                6.00  
## goal contrast                        goal contrast                        20.00 
## relevance of PA                      relevance of PA                      56.00 
## changes at home                      changes at home                      24.00 
## social support                       social support                       24.00 
## barriers identified or planned for   barriers identified or planned for   14.00 
## identity, life values                identity, life values                16.00 
## monitoring PA                        monitoring PA                        30.00

<span class="kw">cor</span>(qgraph<span class="op">::</span><span class="kw">centrality</span>(allBctsMotiSurveyPA)<span class="op">$</span>InDegree, qgraph<span class="op">::</span><span class="kw">centrality</span>(allBctsMotiSurveyPA)<span class="op">$</span>Betweenness, 
    <span class="dt">method =</span> <span class="st">&quot;spearman&quot;</span>) 
## [1] 0.4678486

<span class="co"># bootnet_stability_allBctsMotiSurveyPA &lt;- bootnet::bootnet(allBctsMotiSurveyPA, nBoots=1000)</span>
<span class="co"># save(bootnet_stability_allBctsMotiSurveyPA, file = &quot;./Rdata_files/bootnet_stability_allBctsMotiSurveyPA.Rdata&quot;)</span>
<span class="kw">load</span>(<span class="st">&quot;./Rdata_files/bootnet_stability_allBctsMotiSurveyPA.Rdata&quot;</span>)

<span class="kw">plot</span>(bootnet_stability_allBctsMotiSurveyPA, <span class="dt">labels =</span> <span class="ot">FALSE</span>, <span class="dt">order =</span> <span class="st">&quot;sample&quot;</span>) </code></pre></div>
<p><img src="baseline-networks_files/figure-html/allBctsMotiSurveyPA-ggm-stability-2.png" width="2100" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(bootnet_stability_allBctsMotiSurveyPA, <span class="dt">labels =</span> <span class="ot">FALSE</span>, <span class="st">&quot;edge&quot;</span>, <span class="dt">plot =</span> <span class="st">&quot;difference&quot;</span>, <span class="dt">onlyNonZero =</span> <span class="ot">TRUE</span>, <span class="dt">order =</span> <span class="st">&quot;sample&quot;</span>)</code></pre></div>
<p><img src="baseline-networks_files/figure-html/allBctsMotiSurveyPA-ggm-stability-3.png" width="2100" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># bootnet_centrality_stability_allBctsMotiSurveyPA &lt;- bootnet::bootnet(allBctsMotiSurveyPA, nBoots=1000,nCores=8, type=&quot;case&quot;)</span>
<span class="co"># save(bootnet_centrality_stability_allBctsMotiSurveyPA, file = &quot;./Rdata_files/bootnet_centrality_stability_allBctsMotiSurveyPA.Rdata&quot;)</span>
<span class="kw">load</span>(<span class="st">&quot;./Rdata_files/bootnet_centrality_stability_allBctsMotiSurveyPA.Rdata&quot;</span>)

<span class="kw">plot</span>(bootnet_centrality_stability_allBctsMotiSurveyPA)</code></pre></div>
<p><img src="baseline-networks_files/figure-html/allBctsMotiSurveyPA-ggm-stability-4.png" width="2100" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(bootnet_centrality_stability_allBctsMotiSurveyPA, <span class="dt">perNode=</span>T, <span class="st">&quot;strength&quot;</span>)</code></pre></div>
<p><img src="baseline-networks_files/figure-html/allBctsMotiSurveyPA-ggm-stability-5.png" width="2100" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
bootnet<span class="op">::</span><span class="kw">corStability</span>(bootnet_centrality_stability_allBctsMotiSurveyPA)
## === Correlation Stability Analysis === 
## 
## Sampling levels tested:
##    nPerson Drop%   n
## 1      291  75.0 126
## 2      382  67.2  86
## 3      472  59.5  97
## 4      563  51.7  92
## 5      654  43.9  87
## 6      744  36.1 103
## 7      835  28.3 107
## 8      926  20.5  90
## 9     1016  12.8 104
## 10    1107   5.0 108
## 
## Maximum drop proportions to retain correlation of 0.7 in at least 95% of the samples:
## 
## betweenness: 0.361
##   - For more accuracy, run bootnet(..., caseMin = 0.283, caseMax = 0.439) 
## 
## closeness: 0.75
##   - For more accuracy, run bootnet(..., caseMin = 0.672, caseMax = 1) 
## 
## strength: 0.75
##   - For more accuracy, run bootnet(..., caseMin = 0.672, caseMax = 1) 
## 
## Accuracy can also be increased by increasing both &#39;nBoots&#39; and &#39;caseN&#39;.</code></pre></div>
<!-- ## Visually compare ggm and mgm -->
<!-- TODO -->
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
layout_mgm_ggm &lt;-<span class="st"> </span>qgraph<span class="op">::</span><span class="kw">averageLayout</span>(BCT_ggm, BCT_mgm)

<span class="kw">layout</span>(<span class="kw">t</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>))

<span class="kw">plot</span>(nwBCT_ggm, <span class="dt">layout =</span> layout_mgm_ggm, <span class="dt">label.scale =</span> <span class="ot">FALSE</span>, <span class="dt">title =</span> <span class="st">&quot;GGM: MVPA, BCTs &amp; motivation&quot;</span>, <span class="dt">label.cex =</span> <span class="fl">0.75</span>,
     <span class="dt">pie =</span> piefill_ggm,
     <span class="dt">color =</span> <span class="st">&quot;skyblue&quot;</span>,
     <span class="dt">pieBorder =</span> <span class="dv">1</span>)

qgraph<span class="op">::</span><span class="kw">qgraph</span>(mgm_obj<span class="op">$</span>pairwise<span class="op">$</span>wadj,
            <span class="dt">layout =</span> layout_mgm_ggm,
            <span class="dt">title =</span> <span class="st">&quot;MGM: MVPA, BCTs &amp; motivation&quot;</span>,
            <span class="dt">edge.color =</span> <span class="kw">ifelse</span>(mgm_obj<span class="op">$</span>pairwise<span class="op">$</span>edgecolor <span class="op">==</span><span class="st"> &quot;darkgreen&quot;</span>, <span class="st">&quot;blue&quot;</span>, mgm_obj<span class="op">$</span>pairwise<span class="op">$</span>edgecolor),
            <span class="dt">pie =</span> pie_errors,
            <span class="dt">pieColor =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">6</span>, <span class="dt">begin =</span> <span class="fl">0.3</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">6</span>],
            <span class="dt">color =</span> node_colors,
            <span class="dt">labels =</span> <span class="kw">names</span>(bctdf_mgm),
            <span class="dt">label.cex =</span> <span class="fl">0.75</span>,
            <span class="dt">label.scale =</span> <span class="ot">FALSE</span>)</code></pre></div>
</div>
<div id="correlation-and-partial-correlation-networks-visualised" class="section level2">
<h2>Correlation and partial correlation networks visualised</h2>
<p>As we can see, the bivariate correlation network is uninterpretable due to high number of edges.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
corgraph &lt;-<span class="st"> </span>qgraph<span class="op">::</span><span class="kw">qgraph</span>(qgraph<span class="op">::</span><span class="kw">cor_auto</span>(bctdf_ggm), <span class="dt">graph =</span> <span class="st">&quot;cor&quot;</span>,
                           <span class="dt">repulsion =</span> <span class="fl">0.99</span>,
       <span class="dt">labels =</span> <span class="kw">names</span>(bctdf_ggm),
       <span class="dt">edge.labels =</span> <span class="ot">TRUE</span>,
       <span class="dt">edge.label.cex =</span> <span class="fl">0.75</span>,
       <span class="dt">label.scale =</span> <span class="ot">FALSE</span>,
       <span class="dt">layout =</span> qgraph<span class="op">::</span><span class="kw">averageLayout</span>(BCT_ggm, BCT_mgm), <span class="co"># get the mgm layout </span>
       <span class="dt">title =</span> <span class="st">&quot;bivariate correlation network&quot;</span>,
       <span class="dt">theme =</span> <span class="st">&quot;colorblind&quot;</span>,
       <span class="dt">label.cex =</span> <span class="fl">0.75</span>,
       <span class="dt">pie =</span> piefill_ggm,
       <span class="dt">pieBorder =</span> <span class="dv">1</span>,
       <span class="dt">color =</span> <span class="st">&quot;skyblue&quot;</span>)</code></pre></div>
<p><img src="baseline-networks_files/figure-html/pa-bct-moti-compare-correlation-partialcorrelation-1.png" width="2100" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">

pcorgraph &lt;-<span class="st"> </span>qgraph<span class="op">::</span><span class="kw">qgraph</span>(qgraph<span class="op">::</span><span class="kw">cor_auto</span>(bctdf_ggm), <span class="dt">graph =</span> <span class="st">&quot;pcor&quot;</span>,
                           <span class="dt">repulsion =</span> <span class="fl">0.99</span>,
       <span class="dt">labels =</span> <span class="kw">names</span>(bctdf_ggm),
       <span class="dt">edge.labels =</span> <span class="ot">TRUE</span>,
       <span class="dt">edge.label.cex =</span> <span class="fl">0.75</span>,
       <span class="dt">label.scale =</span> <span class="ot">FALSE</span>,
       <span class="dt">layout =</span> qgraph<span class="op">::</span><span class="kw">averageLayout</span>(BCT_ggm, BCT_mgm), <span class="co"># get the mgm layout </span>
       <span class="dt">title =</span> <span class="st">&quot;Partial correlation network&quot;</span>,
       <span class="dt">theme =</span> <span class="st">&quot;colorblind&quot;</span>,
       <span class="dt">label.cex =</span> <span class="fl">0.75</span>,
       <span class="dt">pie =</span> piefill_ggm,
       <span class="dt">pieBorder =</span> <span class="dv">1</span>,
       <span class="dt">color =</span> <span class="st">&quot;skyblue&quot;</span>)</code></pre></div>
<p><img src="baseline-networks_files/figure-html/pa-bct-moti-compare-correlation-partialcorrelation-2.png" width="2100" /></p>
</div>
<div id="correlation-matrix-visualised" class="section level2">
<h2>Correlation matrix visualised</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
bivariate_BCTs &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(
  <span class="st">&#39;goal setting&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_01_T1,
  <span class="st">&#39;implementation plan&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_02_T1,
  <span class="st">&#39;plan by other&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_03_T1,
  <span class="st">&#39;reminder of plan&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_04_T1,
  <span class="st">&#39;subgoals&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_05_T1,
  <span class="st">&#39;new PA options&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_06_T1,
  <span class="st">&#39;barrier identification&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_07_T1,
  <span class="st">&#39;coping planning&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_08_T1,
  <span class="st">&#39;PA identity&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_09_T1,
  <span class="st">&#39;PA life values&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_10_T1,
  <span class="st">&#39;positive consequences&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_01_T1,
  <span class="st">&#39;log on paper&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_02_T1,
  <span class="st">&#39;smartphone&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_03_T1,
  <span class="st">&#39;mnemonic cues&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_04_T1,
  <span class="st">&#39;goal contrast&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_05_T1,
  <span class="st">&#39;relevance of PA&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_06_T1,
  <span class="st">&#39;changes at home&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_07_T1,
  <span class="st">&#39;social support&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_08_T1,
  <span class="st">&#39;failure contemplated&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_09_T1,
  <span class="st">&#39;PA accelerometer&#39;</span> =<span class="st"> </span>mvpaAccelerometer_T1,
  <span class="st">&#39;PA self-report&#39;</span> =<span class="st"> </span>padaysLastweek_T1,
  <span class="st">&#39;autonomous&#39;</span> =<span class="st"> </span>PA_autonomous_T1,
  <span class="st">&#39;controlled&#39;</span> =<span class="st"> </span>PA_controlled_T1) <span class="op">%&gt;%</span>
<span class="st"> </span><span class="kw">rowwise</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="st">`</span><span class="dt">PA accelerometer</span><span class="st">`</span>, <span class="st">`</span><span class="dt">PA self-report</span><span class="st">`</span>, autonomous, controlled, <span class="kw">everything</span>()) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate_all</span>(as.numeric)

<span class="co"># Create a covariance matrix of the data</span>
covMatrix &lt;-<span class="st"> </span>bctdf_ggm <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">cov</span>(<span class="dt">use =</span> <span class="st">&quot;pairwise.complete.obs&quot;</span>)

<span class="co"># Transform the matrix so, that lower diagonal of the matrix shows partial correlations,</span>
<span class="co"># while the upper one shows bivariate correlations.</span>
matrix_corLower_parcorUpper &lt;-<span class="st"> </span>covMatrix <span class="op">%&gt;%</span><span class="st"> </span>ggm<span class="op">::</span><span class="kw">correlations</span>()

<span class="co"># Show the matrix</span>
matrix_corLower_parcorUpper <span class="op">%&gt;%</span><span class="st"> </span>papaja<span class="op">::</span><span class="kw">apa_table</span>(<span class="dt">caption =</span> <span class="st">&quot;Correlation matrix of key variables of interest. Lower diagonal shows bivariate correlations, upper diagonal shows partial correlations&quot;</span>)</code></pre></div>
<caption>
(#tab:allBctsMotiSurveyPA-corrmatrix)
</caption>
<caption>
<em>Correlation matrix of key variables of interest. Lower diagonal shows bivariate correlations, upper diagonal shows partial correlations</em>
</caption>
<table>
<thead>
<tr class="header">
<th></th>
<th align="left">MVPA questionnaire</th>
<th align="left">MVPA accelerometer</th>
<th align="left">autonomous motivation</th>
<th align="left">controlled motivation</th>
<th align="left">goal setting</th>
<th align="left">implementation plan</th>
<th align="left">plan by other</th>
<th align="left">reminder of plan</th>
<th align="left">subgoals</th>
<th align="left">new PA options</th>
<th align="left">positive consequences</th>
<th align="left">goal contrast</th>
<th align="left">relevance of PA</th>
<th align="left">changes at home</th>
<th align="left">social support</th>
<th align="left">barriers identified or planned for</th>
<th align="left">identity, life values</th>
<th align="left">monitoring PA</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>MVPA questionnaire</td>
<td align="left">1.00</td>
<td align="left">0.16</td>
<td align="left">0.19</td>
<td align="left">-0.03</td>
<td align="left">0.03</td>
<td align="left">0.03</td>
<td align="left">0.15</td>
<td align="left">-0.05</td>
<td align="left">0.06</td>
<td align="left">0.10</td>
<td align="left">0.00</td>
<td align="left">0.05</td>
<td align="left">0.01</td>
<td align="left">-0.01</td>
<td align="left">0.01</td>
<td align="left">-0.06</td>
<td align="left">-0.01</td>
<td align="left">0.07</td>
</tr>
<tr class="even">
<td>MVPA accelerometer</td>
<td align="left">0.26</td>
<td align="left">1.00</td>
<td align="left">0.07</td>
<td align="left">-0.01</td>
<td align="left">0.03</td>
<td align="left">-0.06</td>
<td align="left">0.08</td>
<td align="left">-0.04</td>
<td align="left">0.04</td>
<td align="left">0.03</td>
<td align="left">0.01</td>
<td align="left">0.03</td>
<td align="left">0.00</td>
<td align="left">0.02</td>
<td align="left">0.03</td>
<td align="left">-0.07</td>
<td align="left">0.00</td>
<td align="left">-0.02</td>
</tr>
<tr class="odd">
<td>autonomous motivation</td>
<td align="left">0.43</td>
<td align="left">0.20</td>
<td align="left">1.00</td>
<td align="left">0.02</td>
<td align="left">0.15</td>
<td align="left">0.07</td>
<td align="left">0.08</td>
<td align="left">-0.03</td>
<td align="left">-0.01</td>
<td align="left">0.10</td>
<td align="left">0.14</td>
<td align="left">0.01</td>
<td align="left">0.16</td>
<td align="left">-0.07</td>
<td align="left">-0.04</td>
<td align="left">-0.02</td>
<td align="left">0.16</td>
<td align="left">0.00</td>
</tr>
<tr class="even">
<td>controlled motivation</td>
<td align="left">0.05</td>
<td align="left">0.01</td>
<td align="left">0.12</td>
<td align="left">1.00</td>
<td align="left">-0.02</td>
<td align="left">0.04</td>
<td align="left">0.00</td>
<td align="left">0.05</td>
<td align="left">0.01</td>
<td align="left">-0.02</td>
<td align="left">0.06</td>
<td align="left">-0.04</td>
<td align="left">0.02</td>
<td align="left">0.02</td>
<td align="left">0.11</td>
<td align="left">0.10</td>
<td align="left">-0.10</td>
<td align="left">-0.01</td>
</tr>
<tr class="odd">
<td>goal setting</td>
<td align="left">0.35</td>
<td align="left">0.13</td>
<td align="left">0.54</td>
<td align="left">0.14</td>
<td align="left">1.00</td>
<td align="left">0.49</td>
<td align="left">-0.01</td>
<td align="left">-0.01</td>
<td align="left">0.06</td>
<td align="left">0.00</td>
<td align="left">0.14</td>
<td align="left">0.05</td>
<td align="left">-0.01</td>
<td align="left">-0.04</td>
<td align="left">0.07</td>
<td align="left">0.09</td>
<td align="left">0.06</td>
<td align="left">-0.06</td>
</tr>
<tr class="even">
<td>implementation plan</td>
<td align="left">0.36</td>
<td align="left">0.10</td>
<td align="left">0.51</td>
<td align="left">0.16</td>
<td align="left">0.74</td>
<td align="left">1.00</td>
<td align="left">0.13</td>
<td align="left">0.15</td>
<td align="left">0.11</td>
<td align="left">0.05</td>
<td align="left">-0.03</td>
<td align="left">0.07</td>
<td align="left">-0.01</td>
<td align="left">0.01</td>
<td align="left">0.00</td>
<td align="left">0.03</td>
<td align="left">0.07</td>
<td align="left">-0.02</td>
</tr>
<tr class="odd">
<td>plan by other</td>
<td align="left">0.37</td>
<td align="left">0.17</td>
<td align="left">0.37</td>
<td align="left">0.11</td>
<td align="left">0.40</td>
<td align="left">0.48</td>
<td align="left">1.00</td>
<td align="left">0.19</td>
<td align="left">0.12</td>
<td align="left">-0.03</td>
<td align="left">-0.07</td>
<td align="left">0.00</td>
<td align="left">0.02</td>
<td align="left">0.03</td>
<td align="left">0.02</td>
<td align="left">-0.02</td>
<td align="left">0.03</td>
<td align="left">0.03</td>
</tr>
<tr class="even">
<td>reminder of plan</td>
<td align="left">0.29</td>
<td align="left">0.08</td>
<td align="left">0.35</td>
<td align="left">0.17</td>
<td align="left">0.47</td>
<td align="left">0.57</td>
<td align="left">0.50</td>
<td align="left">1.00</td>
<td align="left">0.26</td>
<td align="left">0.05</td>
<td align="left">-0.02</td>
<td align="left">0.11</td>
<td align="left">-0.04</td>
<td align="left">-0.01</td>
<td align="left">-0.02</td>
<td align="left">0.10</td>
<td align="left">0.03</td>
<td align="left">0.27</td>
</tr>
<tr class="odd">
<td>subgoals</td>
<td align="left">0.36</td>
<td align="left">0.13</td>
<td align="left">0.42</td>
<td align="left">0.15</td>
<td align="left">0.54</td>
<td align="left">0.60</td>
<td align="left">0.48</td>
<td align="left">0.64</td>
<td align="left">1.00</td>
<td align="left">0.12</td>
<td align="left">-0.02</td>
<td align="left">0.04</td>
<td align="left">-0.01</td>
<td align="left">0.01</td>
<td align="left">0.01</td>
<td align="left">0.19</td>
<td align="left">0.06</td>
<td align="left">0.04</td>
</tr>
<tr class="even">
<td>new PA options</td>
<td align="left">0.37</td>
<td align="left">0.14</td>
<td align="left">0.46</td>
<td align="left">0.11</td>
<td align="left">0.47</td>
<td align="left">0.51</td>
<td align="left">0.35</td>
<td align="left">0.47</td>
<td align="left">0.54</td>
<td align="left">1.00</td>
<td align="left">-0.06</td>
<td align="left">0.09</td>
<td align="left">0.04</td>
<td align="left">0.08</td>
<td align="left">0.01</td>
<td align="left">0.17</td>
<td align="left">0.14</td>
<td align="left">0.00</td>
</tr>
<tr class="odd">
<td>positive consequences</td>
<td align="left">0.27</td>
<td align="left">0.12</td>
<td align="left">0.47</td>
<td align="left">0.18</td>
<td align="left">0.47</td>
<td align="left">0.40</td>
<td align="left">0.23</td>
<td align="left">0.31</td>
<td align="left">0.35</td>
<td align="left">0.34</td>
<td align="left">1.00</td>
<td align="left">0.05</td>
<td align="left">0.34</td>
<td align="left">0.00</td>
<td align="left">0.09</td>
<td align="left">0.06</td>
<td align="left">0.04</td>
<td align="left">0.04</td>
</tr>
<tr class="even">
<td>goal contrast</td>
<td align="left">0.36</td>
<td align="left">0.15</td>
<td align="left">0.43</td>
<td align="left">0.14</td>
<td align="left">0.50</td>
<td align="left">0.53</td>
<td align="left">0.39</td>
<td align="left">0.55</td>
<td align="left">0.53</td>
<td align="left">0.50</td>
<td align="left">0.46</td>
<td align="left">1.00</td>
<td align="left">0.21</td>
<td align="left">0.09</td>
<td align="left">0.09</td>
<td align="left">0.04</td>
<td align="left">-0.01</td>
<td align="left">0.25</td>
</tr>
<tr class="odd">
<td>relevance of PA</td>
<td align="left">0.33</td>
<td align="left">0.14</td>
<td align="left">0.53</td>
<td align="left">0.17</td>
<td align="left">0.49</td>
<td align="left">0.47</td>
<td align="left">0.33</td>
<td align="left">0.40</td>
<td align="left">0.44</td>
<td align="left">0.47</td>
<td align="left">0.62</td>
<td align="left">0.58</td>
<td align="left">1.00</td>
<td align="left">0.12</td>
<td align="left">0.11</td>
<td align="left">0.09</td>
<td align="left">0.17</td>
<td align="left">-0.04</td>
</tr>
<tr class="even">
<td>changes at home</td>
<td align="left">0.24</td>
<td align="left">0.11</td>
<td align="left">0.25</td>
<td align="left">0.16</td>
<td align="left">0.31</td>
<td align="left">0.34</td>
<td align="left">0.30</td>
<td align="left">0.39</td>
<td align="left">0.38</td>
<td align="left">0.38</td>
<td align="left">0.34</td>
<td align="left">0.50</td>
<td align="left">0.45</td>
<td align="left">1.00</td>
<td align="left">0.33</td>
<td align="left">-0.01</td>
<td align="left">0.03</td>
<td align="left">0.27</td>
</tr>
<tr class="odd">
<td>social support</td>
<td align="left">0.24</td>
<td align="left">0.12</td>
<td align="left">0.30</td>
<td align="left">0.22</td>
<td align="left">0.38</td>
<td align="left">0.37</td>
<td align="left">0.29</td>
<td align="left">0.35</td>
<td align="left">0.37</td>
<td align="left">0.35</td>
<td align="left">0.41</td>
<td align="left">0.48</td>
<td align="left">0.48</td>
<td align="left">0.56</td>
<td align="left">1.00</td>
<td align="left">0.04</td>
<td align="left">-0.01</td>
<td align="left">0.05</td>
</tr>
<tr class="even">
<td>barriers identified or planned for</td>
<td align="left">0.27</td>
<td align="left">0.06</td>
<td align="left">0.43</td>
<td align="left">0.20</td>
<td align="left">0.54</td>
<td align="left">0.55</td>
<td align="left">0.37</td>
<td align="left">0.54</td>
<td align="left">0.60</td>
<td align="left">0.56</td>
<td align="left">0.44</td>
<td align="left">0.52</td>
<td align="left">0.53</td>
<td align="left">0.37</td>
<td align="left">0.40</td>
<td align="left">1.00</td>
<td align="left">0.25</td>
<td align="left">0.04</td>
</tr>
<tr class="odd">
<td>identity, life values</td>
<td align="left">0.30</td>
<td align="left">0.11</td>
<td align="left">0.52</td>
<td align="left">0.08</td>
<td align="left">0.53</td>
<td align="left">0.53</td>
<td align="left">0.36</td>
<td align="left">0.43</td>
<td align="left">0.50</td>
<td align="left">0.52</td>
<td align="left">0.43</td>
<td align="left">0.45</td>
<td align="left">0.55</td>
<td align="left">0.32</td>
<td align="left">0.33</td>
<td align="left">0.60</td>
<td align="left">1.00</td>
<td align="left">-0.10</td>
</tr>
<tr class="even">
<td>monitoring PA</td>
<td align="left">0.29</td>
<td align="left">0.09</td>
<td align="left">0.27</td>
<td align="left">0.13</td>
<td align="left">0.31</td>
<td align="left">0.37</td>
<td align="left">0.36</td>
<td align="left">0.55</td>
<td align="left">0.45</td>
<td align="left">0.37</td>
<td align="left">0.31</td>
<td align="left">0.57</td>
<td align="left">0.37</td>
<td align="left">0.53</td>
<td align="left">0.41</td>
<td align="left">0.40</td>
<td align="left">0.27</td>
<td align="left">1.00</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
labs &lt;-<span class="st"> </span><span class="kw">names</span>(bctdf_ggm)
<span class="co"># Plot the matrix as a correlogram</span>
matrix_corLower_parcorUpper <span class="op">%&gt;%</span><span class="st"> </span>corrgram<span class="op">::</span><span class="kw">corrgram</span>(
  <span class="dt">type =</span> <span class="st">&quot;cor&quot;</span>,
  <span class="dt">lower.panel =</span> corrgram<span class="op">::</span>panel.pie,
  <span class="dt">upper.panel =</span> corrgram<span class="op">::</span>panel.pie,
  <span class="dt">outer.labels =</span> <span class="kw">list</span>(<span class="dt">bottom =</span> <span class="kw">list</span>(<span class="dt">labels =</span> labs, <span class="dt">cex =</span> <span class="fl">0.75</span>, <span class="dt">srt =</span> <span class="dv">30</span>),
                      <span class="dt">left =</span> <span class="kw">list</span>(<span class="dt">labels =</span> labs, <span class="dt">cex =</span> <span class="fl">0.75</span>, <span class="dt">srt =</span> <span class="dv">30</span>)),
  <span class="dt">main =</span> <span class="st">&quot;Bivariate (upper diagonal) and partial (lower diagonal)</span><span class="ch">\n</span><span class="st">correlations of BCTs, motivation and self-reported PA&quot;</span>)</code></pre></div>
<p><img src="baseline-networks_files/figure-html/allBctsMotiSurveyPA-corrmatrix-1.png" width="2100" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
corMatrix_BCTs &lt;-<span class="st"> </span>bivariate_BCTs <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">cor</span>(<span class="dt">use =</span> <span class="st">&quot;pairwise.complete.obs&quot;</span>, <span class="dt">method =</span> <span class="st">&quot;spearman&quot;</span>)

<span class="kw">as.data.frame</span>(<span class="kw">as.table</span>(corMatrix_BCTs)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(Var1 <span class="op">==</span><span class="st"> &quot;PA accelerometer&quot;</span> <span class="op">|</span><span class="st"> </span>Var1 <span class="op">==</span><span class="st"> &quot;PA self report&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="st">&quot;Spearman correlation&quot;</span> =<span class="st"> </span>Freq) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>Freq) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="st">`</span><span class="dt">Spearman correlation</span><span class="st">`</span> <span class="op">!=</span><span class="st"> </span><span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">arrange</span>(<span class="kw">desc</span>(<span class="st">`</span><span class="dt">Spearman correlation</span><span class="st">`</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>papaja<span class="op">::</span><span class="kw">apa_table</span>(<span class="dt">caption =</span> <span class="st">&quot;Bivariate correlations between BCTs, motivation and self-reported PA. Sorted by strength.&quot;</span>)</code></pre></div>
<caption>
(#tab:allBctsMotiSurveyPA-corrmatrix)
</caption>
<caption>
<em>Bivariate correlations between BCTs, motivation and self-reported PA. Sorted by strength.</em>
</caption>
<table>
<thead>
<tr class="header">
<th align="left">Var1</th>
<th align="left">Var2</th>
<th align="left">Spearman correlation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">PA accelerometer</td>
<td align="left">PA self-report</td>
<td align="left">0.25</td>
</tr>
<tr class="even">
<td align="left">PA accelerometer</td>
<td align="left">autonomous</td>
<td align="left">0.23</td>
</tr>
<tr class="odd">
<td align="left">PA accelerometer</td>
<td align="left">plan by other</td>
<td align="left">0.16</td>
</tr>
<tr class="even">
<td align="left">PA accelerometer</td>
<td align="left">new PA options</td>
<td align="left">0.15</td>
</tr>
<tr class="odd">
<td align="left">PA accelerometer</td>
<td align="left">goal setting</td>
<td align="left">0.14</td>
</tr>
<tr class="even">
<td align="left">PA accelerometer</td>
<td align="left">goal contrast</td>
<td align="left">0.14</td>
</tr>
<tr class="odd">
<td align="left">PA accelerometer</td>
<td align="left">relevance of PA</td>
<td align="left">0.14</td>
</tr>
<tr class="even">
<td align="left">PA accelerometer</td>
<td align="left">social support</td>
<td align="left">0.13</td>
</tr>
<tr class="odd">
<td align="left">PA accelerometer</td>
<td align="left">subgoals</td>
<td align="left">0.12</td>
</tr>
<tr class="even">
<td align="left">PA accelerometer</td>
<td align="left">PA life values</td>
<td align="left">0.12</td>
</tr>
<tr class="odd">
<td align="left">PA accelerometer</td>
<td align="left">positive consequences</td>
<td align="left">0.12</td>
</tr>
<tr class="even">
<td align="left">PA accelerometer</td>
<td align="left">PA identity</td>
<td align="left">0.11</td>
</tr>
<tr class="odd">
<td align="left">PA accelerometer</td>
<td align="left">failure contemplated</td>
<td align="left">0.10</td>
</tr>
<tr class="even">
<td align="left">PA accelerometer</td>
<td align="left">implementation plan</td>
<td align="left">0.10</td>
</tr>
<tr class="odd">
<td align="left">PA accelerometer</td>
<td align="left">log on paper</td>
<td align="left">0.10</td>
</tr>
<tr class="even">
<td align="left">PA accelerometer</td>
<td align="left">changes at home</td>
<td align="left">0.10</td>
</tr>
<tr class="odd">
<td align="left">PA accelerometer</td>
<td align="left">mnemonic cues</td>
<td align="left">0.08</td>
</tr>
<tr class="even">
<td align="left">PA accelerometer</td>
<td align="left">reminder of plan</td>
<td align="left">0.08</td>
</tr>
<tr class="odd">
<td align="left">PA accelerometer</td>
<td align="left">smartphone</td>
<td align="left">0.05</td>
</tr>
<tr class="even">
<td align="left">PA accelerometer</td>
<td align="left">barrier identification</td>
<td align="left">0.05</td>
</tr>
<tr class="odd">
<td align="left">PA accelerometer</td>
<td align="left">coping planning</td>
<td align="left">0.05</td>
</tr>
<tr class="even">
<td align="left">PA accelerometer</td>
<td align="left">controlled</td>
<td align="left">0.00</td>
</tr>
</tbody>
</table>
</div>
<div id="cognitive-bcts-only-added-one-at-a-time" class="section level2">
<h2>Cognitive BCTs only, added one at a time</h2>
<p>Four BCTs can be categorised as being completely cognitive, i.e. not being observable to an outsider. These are (in order of correlation with accelerometer-measured MVPA:</p>
<ol style="list-style-type: decimal">
<li>I have attempted to find ways to exercise so, that it won’t obstruct but instead helps actualise my other life values.</li>
<li>I have thought about which reasons to do PA are important to me personally.</li>
<li>I have reminded myself even in my spare time, what kind of positive consequences frequent PA would have in my life.</li>
<li>I have thought about how PA fits my identity (self concept).</li>
</ol>
<p>First, we fit a model with only the first one:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">bctdf_mgm &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(
<span class="co">#  id,</span>
<span class="co">#  intervention,</span>
<span class="co">#  group,</span>
<span class="co">#  school,</span>
<span class="co">#  girl,</span>
  <span class="st">&#39;goal setting&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_01_T1,
  <span class="st">&#39;implementation plan&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_02_T1,
  <span class="st">&#39;plan by other&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_03_T1,
  <span class="st">&#39;reminder of plan&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_04_T1,
  <span class="st">&#39;subgoals&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_05_T1,
  <span class="st">&#39;new PA options&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_06_T1,
  <span class="st">&#39;barrier identification&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_07_T1,
  <span class="st">&#39;coping planning&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_08_T1,
  <span class="st">&#39;PA identity&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_09_T1,
  <span class="st">&#39;PA life values&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_10_T1,
  <span class="st">&#39;positive consequences&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_01_T1,
  <span class="st">&#39;log on paper&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_02_T1,
  <span class="st">&#39;smartphone&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_03_T1,
<span class="co">#  &#39;mnemonic cues&#39; = PA_frequencyDependentBCT_04_T1, # Issues with clarity of item wording </span>
  <span class="st">&#39;goal contrast&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_05_T1,
  <span class="st">&#39;relevance of PA&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_06_T1,
  <span class="st">&#39;changes at home&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_07_T1,
  <span class="st">&#39;social support&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_08_T1,
  <span class="st">&#39;failure contemplation&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_09_T1,
  <span class="st">&#39;MVPA questionnaire&#39;</span> =<span class="st"> </span>padaysLastweek_T1,
  <span class="st">&#39;MVPA accelerometer&#39;</span> =<span class="st"> </span>mvpaAccelerometer_T1,
  <span class="st">&#39;intrinsic&#39;</span> =<span class="st"> </span>PA_intrinsic_T1,
  <span class="st">&#39;identified&#39;</span> =<span class="st"> </span>PA_identified_T1,
  <span class="st">&#39;controlled motivation&#39;</span> =<span class="st"> </span>PA_controlled_T1) <span class="op">%&gt;%</span>
<span class="st"> </span><span class="kw">rowwise</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st"> </span>dplyr<span class="op">::</span><span class="kw">transmute</span>(
  <span class="co"># &#39;goal setting&#39; = ifelse(`goal setting` == 1, 0, 1),</span>
  <span class="co"># &#39;has plan&#39; = ifelse(`implementation plan` == 1 &amp; `plan by other` == 1, 0, 1),</span>
  <span class="co"># &#39;implementation plan&#39; = ifelse(`implementation plan` == 1, 0, 1),</span>
  <span class="co"># &#39;plan by other&#39; = ifelse(`plan by other` == 1, 0, 1),</span>
  <span class="co"># &#39;reminder of plan&#39; = ifelse(`reminder of plan` == 1, 0, 1),</span>
  <span class="co"># &#39;subgoals&#39; = ifelse(`subgoals` == 1, 0, 1),</span>
  <span class="co"># &#39;new PA options&#39; = ifelse(`new PA options` == 1, 0, 1),</span>
  <span class="co"># &#39;barrier identification&#39; = ifelse(`barrier identification` == 1, 0, 1),</span>
  <span class="co"># &#39;coping planning&#39; = ifelse(`coping planning` == 1, 0, 1),</span>
  <span class="co"># &#39;barriers identified or planned for&#39; = ifelse(`coping planning` == 1 &amp; `barrier identification` == 1, 0, 1),</span>
 <span class="co"># &#39;PA identity&#39; = ifelse(`PA identity` == 1, 0, 1),</span>
 <span class="st">&#39;PA life values&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">PA life values</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
  <span class="co"># &#39;identity, life values&#39; = ifelse(`PA identity` == 1 &amp; `PA life values` == 1, 0, 1),</span>
  <span class="co"># &#39;positive consequences&#39; = ifelse(`positive consequences` == 1, 0, 1),</span>
  <span class="co"># &#39;monitoring PA&#39; = ifelse(`log on paper` == 1 &amp; `smartphone` == 1, 0, 1),</span>
  <span class="co"># &#39;mnemonic cues&#39; = ifelse(`mnemonic cues` == 1, 0, 1),</span>
  <span class="co"># &#39;goal contrast&#39; = ifelse(`goal contrast` == 1, 0, 1),</span>
  <span class="co"># &#39;relevance of PA&#39; = ifelse(`relevance of PA` == 1, 0, 1),</span>
  <span class="co"># &#39;changes at home&#39; = ifelse(`changes at home` == 1, 0, 1),</span>
  <span class="co"># &#39;social support&#39; = ifelse(`social support` == 1, 0, 1),</span>
  <span class="co"># &#39;failure contemplation&#39; = ifelse(`failure contemplation` == 1, 0, 1),</span>
  <span class="st">&#39;autonomous motivation&#39;</span> =<span class="st"> </span><span class="kw">mean</span>(<span class="kw">c</span>(identified, intrinsic), <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),
<span class="co">#  &#39;girl&#39; = ifelse(girl == &quot;girl&quot;, 1, 0),</span>
  <span class="st">&#39;controlled motivation&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">controlled motivation</span><span class="st">`</span> <span class="op">&lt;</span><span class="st"> </span><span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">1</span>), <span class="co"># If &quot;at least partly&quot; or more true, input 1. Normality otherwise a problem.</span>
  <span class="st">&#39;MVPA questionnaire&#39;</span> =<span class="st"> `</span><span class="dt">MVPA questionnaire</span><span class="st">`</span> <span class="op">*</span><span class="st"> </span><span class="dv">1</span>, 
  <span class="st">&#39;MVPA accelerometer&#39;</span> =<span class="st"> `</span><span class="dt">MVPA accelerometer</span><span class="st">`</span> <span class="op">*</span><span class="st"> </span><span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st">  </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="st">&#39;MVPA questionnaire&#39;</span>, <span class="st">&#39;MVPA accelerometer&#39;</span>, <span class="kw">everything</span>())

bctdf_mgm<span class="op">$</span><span class="st">`</span><span class="dt">autonomous motivation</span><span class="st">`</span>[<span class="kw">is.nan</span>(bctdf_mgm<span class="op">$</span><span class="st">`</span><span class="dt">autonomous motivation</span><span class="st">`</span>)] &lt;-<span class="st"> </span><span class="ot">NA</span>

labs &lt;-<span class="st"> </span><span class="kw">names</span>(bctdf_mgm)

bctdf_mgm &lt;-<span class="st"> </span>bctdf_mgm <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">na.omit</span>(.)
<span class="co"># bctdf_mgm %&gt;% names()</span>
mgm_variable_types &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;g&quot;</span>, <span class="st">&quot;g&quot;</span>, <span class="kw">rep</span>(<span class="st">&quot;c&quot;</span>, <span class="dv">1</span>), <span class="st">&quot;g&quot;</span>, <span class="st">&quot;c&quot;</span>)
mgm_variable_levels &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;1&quot;</span>, <span class="st">&quot;1&quot;</span>, <span class="kw">rep</span>(<span class="st">&quot;2&quot;</span>, <span class="dv">1</span>), <span class="st">&quot;1&quot;</span>, <span class="st">&quot;2&quot;</span>)
<span class="co"># data.frame(mgm_variable_types, mgm_variable_levels, names(bctdf_mgm))</span>

mgm_obj &lt;-<span class="st"> </span>mgm<span class="op">::</span><span class="kw">mgm</span>(<span class="dt">data =</span> bctdf_mgm,
  <span class="dt">type =</span> mgm_variable_types,
  <span class="dt">level =</span> mgm_variable_levels,
  <span class="dt">lambdaSel =</span> <span class="st">&quot;CV&quot;</span>,
  <span class="dt">lambdaFolds =</span> <span class="dv">10</span>,
  <span class="dt">pbar =</span> <span class="ot">FALSE</span>, 
  <span class="dt">binarySign =</span> <span class="ot">TRUE</span>)
## Note that the sign of parameter estimates is stored separately; see ?mgm

pred_obj &lt;-<span class="st"> </span><span class="kw">predict</span>(<span class="dt">object =</span> mgm_obj,
                         <span class="dt">data =</span> bctdf_mgm)

pred_obj<span class="op">$</span>errors</code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Variable"],"name":[1],"type":["chr"],"align":["left"]},{"label":["RMSE"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["R2"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["CC"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["nCC"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["CCmarg"],"name":[6],"type":["dbl"],"align":["right"]}],"data":[{"1":"MVPA questionnaire","2":"0.870","3":"0.242","4":"NA","5":"NA","6":"NA","_rn_":"1"},{"1":"MVPA accelerometer","2":"0.962","3":"0.074","4":"NA","5":"NA","6":"NA","_rn_":"2"},{"1":"PA life values","2":"NA","3":"NA","4":"0.842","5":"0.173","6":"0.809","_rn_":"3"},{"1":"autonomous motivation","2":"0.843","3":"0.289","4":"NA","5":"NA","6":"NA","_rn_":"4"},{"1":"controlled motivation","2":"NA","3":"NA","4":"0.883","5":"0.000","6":"0.883","_rn_":"5"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[15],"max":[15]},"pages":{}}}
  </script>
</div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># Take R2 from gaussian, CC from categorical variables </span>
pie_errors &lt;-<span class="st"> </span><span class="kw">c</span>(pred_obj<span class="op">$</span>errors[<span class="dv">1</span>, <span class="dv">3</span>],
                pred_obj<span class="op">$</span>errors[<span class="dv">2</span>, <span class="dv">3</span>],
                pred_obj<span class="op">$</span>errors[<span class="dv">3</span>, <span class="dv">4</span>],
                pred_obj<span class="op">$</span>errors[<span class="dv">4</span>, <span class="dv">3</span>],
                pred_obj<span class="op">$</span>errors[<span class="dv">5</span>, <span class="dv">4</span>])

<span class="co"># Coloring nodes: make a sequence of colors from the viridis palette. We need three colors (MVPA, BCTs, motivation), and &quot;begin&quot; from ones that are not too dark, so that black text shows up ok.</span>

node_colors &lt;-<span class="st"> </span><span class="kw">c</span>(viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">3</span>, <span class="dt">begin =</span> <span class="fl">0.4</span>, <span class="dt">end =</span> <span class="fl">0.99</span>)[<span class="dv">1</span>], <span class="co"># Color 1 for MVPA (questionnaire)</span>
                 viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">3</span>, <span class="dt">begin =</span> <span class="fl">0.4</span>, <span class="dt">end =</span> <span class="fl">0.99</span>)[<span class="dv">1</span>], <span class="co"># Color 1 for MVPA (accelerometer)</span>
                 <span class="kw">rep</span>(viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">3</span>, <span class="dt">begin =</span> <span class="fl">0.4</span>, <span class="dt">end =</span> <span class="fl">0.99</span>)[<span class="dv">2</span>], <span class="dv">1</span>), <span class="co"># 4x Color 2 for BCTs</span>
                 <span class="kw">rep</span>(viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">3</span>, <span class="dt">begin =</span> <span class="fl">0.4</span>, <span class="dt">end =</span> <span class="fl">0.99</span>)[<span class="dv">3</span>], <span class="dv">1</span>), <span class="co"># Color 3 for motivation (controlled)</span>
                 viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">3</span>, <span class="dt">begin =</span> <span class="fl">0.4</span>, <span class="dt">end =</span> <span class="fl">0.99</span>)[<span class="dv">3</span>]) <span class="co"># Color 3 for motivation (autonomous) </span>

BCT_mgm &lt;-<span class="st"> </span>qgraph<span class="op">::</span><span class="kw">qgraph</span>(mgm_obj<span class="op">$</span>pairwise<span class="op">$</span>wadj, 
            <span class="dt">layout =</span> <span class="st">&quot;spring&quot;</span>,
            <span class="dt">repulsion =</span> <span class="fl">0.99</span>, <span class="co"># To nudge the network from originally bad visual state</span>
            <span class="dt">title =</span> <span class="st">&quot;cognitive/motivational BCTs, PA &amp; motivation&quot;</span>,
            <span class="dt">edge.color =</span> <span class="kw">ifelse</span>(mgm_obj<span class="op">$</span>pairwise<span class="op">$</span>edgecolor <span class="op">==</span><span class="st"> &quot;darkgreen&quot;</span>, <span class="st">&quot;blue&quot;</span>, mgm_obj<span class="op">$</span>pairwise<span class="op">$</span>edgecolor),
            <span class="dt">pie =</span> pie_errors,
            <span class="dt">pieColor =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">5</span>, <span class="dt">begin =</span> <span class="fl">0.3</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">5</span>],
            <span class="dt">color =</span> node_colors,
            <span class="dt">labels =</span> <span class="kw">names</span>(bctdf_mgm),
            <span class="dt">label.cex =</span> <span class="fl">0.75</span>,
            <span class="dt">label.scale =</span> <span class="ot">FALSE</span>,
            <span class="dt">vertex.label.dist =</span> <span class="dv">2</span>)</code></pre></div>
<p><img src="baseline-networks_files/figure-html/cognitiveBCTs1-1.png" width="2100" /></p>
<p>Adding the second (I have thought about which reasons to do PA are important to me personally):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">bctdf_mgm &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(
<span class="co">#  id,</span>
<span class="co">#  intervention,</span>
<span class="co">#  group,</span>
<span class="co">#  school,</span>
<span class="co">#  girl,</span>
  <span class="st">&#39;goal setting&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_01_T1,
  <span class="st">&#39;implementation plan&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_02_T1,
  <span class="st">&#39;plan by other&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_03_T1,
  <span class="st">&#39;reminder of plan&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_04_T1,
  <span class="st">&#39;subgoals&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_05_T1,
  <span class="st">&#39;new PA options&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_06_T1,
  <span class="st">&#39;barrier identification&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_07_T1,
  <span class="st">&#39;coping planning&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_08_T1,
  <span class="st">&#39;PA identity&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_09_T1,
  <span class="st">&#39;PA life values&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_10_T1,
  <span class="st">&#39;positive consequences&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_01_T1,
  <span class="st">&#39;log on paper&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_02_T1,
  <span class="st">&#39;smartphone&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_03_T1,
<span class="co">#  &#39;mnemonic cues&#39; = PA_frequencyDependentBCT_04_T1, # Issues with clarity of item wording </span>
  <span class="st">&#39;goal contrast&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_05_T1,
  <span class="st">&#39;relevance of PA&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_06_T1,
  <span class="st">&#39;changes at home&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_07_T1,
  <span class="st">&#39;social support&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_08_T1,
  <span class="st">&#39;failure contemplation&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_09_T1,
  <span class="st">&#39;MVPA questionnaire&#39;</span> =<span class="st"> </span>padaysLastweek_T1,
  <span class="st">&#39;MVPA accelerometer&#39;</span> =<span class="st"> </span>mvpaAccelerometer_T1,
  <span class="st">&#39;intrinsic&#39;</span> =<span class="st"> </span>PA_intrinsic_T1,
  <span class="st">&#39;identified&#39;</span> =<span class="st"> </span>PA_identified_T1,
  <span class="st">&#39;controlled motivation&#39;</span> =<span class="st"> </span>PA_controlled_T1) <span class="op">%&gt;%</span>
<span class="st"> </span><span class="kw">rowwise</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st"> </span>dplyr<span class="op">::</span><span class="kw">transmute</span>(
  <span class="co"># &#39;goal setting&#39; = ifelse(`goal setting` == 1, 0, 1),</span>
  <span class="co"># &#39;has plan&#39; = ifelse(`implementation plan` == 1 &amp; `plan by other` == 1, 0, 1),</span>
  <span class="co"># &#39;implementation plan&#39; = ifelse(`implementation plan` == 1, 0, 1),</span>
  <span class="co"># &#39;plan by other&#39; = ifelse(`plan by other` == 1, 0, 1),</span>
  <span class="co"># &#39;reminder of plan&#39; = ifelse(`reminder of plan` == 1, 0, 1),</span>
  <span class="co"># &#39;subgoals&#39; = ifelse(`subgoals` == 1, 0, 1),</span>
  <span class="co"># &#39;new PA options&#39; = ifelse(`new PA options` == 1, 0, 1),</span>
  <span class="co"># &#39;barrier identification&#39; = ifelse(`barrier identification` == 1, 0, 1),</span>
  <span class="co"># &#39;coping planning&#39; = ifelse(`coping planning` == 1, 0, 1),</span>
  <span class="co"># &#39;barriers identified or planned for&#39; = ifelse(`coping planning` == 1 &amp; `barrier identification` == 1, 0, 1),</span>
 <span class="co"># &#39;PA identity&#39; = ifelse(`PA identity` == 1, 0, 1),</span>
 <span class="st">&#39;PA life values&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">PA life values</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
  <span class="co"># &#39;identity, life values&#39; = ifelse(`PA identity` == 1 &amp; `PA life values` == 1, 0, 1),</span>
  <span class="co"># &#39;positive consequences&#39; = ifelse(`positive consequences` == 1, 0, 1),</span>
  <span class="co"># &#39;monitoring PA&#39; = ifelse(`log on paper` == 1 &amp; `smartphone` == 1, 0, 1),</span>
  <span class="co"># &#39;mnemonic cues&#39; = ifelse(`mnemonic cues` == 1, 0, 1),</span>
  <span class="co"># &#39;goal contrast&#39; = ifelse(`goal contrast` == 1, 0, 1),</span>
  <span class="st">&#39;relevance of PA&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">relevance of PA</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
  <span class="co"># &#39;changes at home&#39; = ifelse(`changes at home` == 1, 0, 1),</span>
  <span class="co"># &#39;social support&#39; = ifelse(`social support` == 1, 0, 1),</span>
  <span class="co"># &#39;failure contemplation&#39; = ifelse(`failure contemplation` == 1, 0, 1),</span>
  <span class="st">&#39;autonomous motivation&#39;</span> =<span class="st"> </span><span class="kw">mean</span>(<span class="kw">c</span>(identified, intrinsic), <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),
<span class="co">#  &#39;girl&#39; = ifelse(girl == &quot;girl&quot;, 1, 0),</span>
  <span class="st">&#39;controlled motivation&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">controlled motivation</span><span class="st">`</span> <span class="op">&lt;</span><span class="st"> </span><span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">1</span>), <span class="co"># If &quot;at least partly&quot; or more true, input 1. Normality otherwise a problem.</span>
  <span class="st">&#39;MVPA questionnaire&#39;</span> =<span class="st"> `</span><span class="dt">MVPA questionnaire</span><span class="st">`</span> <span class="op">*</span><span class="st"> </span><span class="dv">1</span>, 
  <span class="st">&#39;MVPA accelerometer&#39;</span> =<span class="st"> `</span><span class="dt">MVPA accelerometer</span><span class="st">`</span> <span class="op">*</span><span class="st"> </span><span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st">  </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="st">&#39;MVPA questionnaire&#39;</span>, <span class="st">&#39;MVPA accelerometer&#39;</span>, <span class="kw">everything</span>())

bctdf_mgm<span class="op">$</span><span class="st">`</span><span class="dt">autonomous motivation</span><span class="st">`</span>[<span class="kw">is.nan</span>(bctdf_mgm<span class="op">$</span><span class="st">`</span><span class="dt">autonomous motivation</span><span class="st">`</span>)] &lt;-<span class="st"> </span><span class="ot">NA</span>

labs &lt;-<span class="st"> </span><span class="kw">names</span>(bctdf_mgm)

bctdf_mgm &lt;-<span class="st"> </span>bctdf_mgm <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">na.omit</span>(.)
<span class="co"># bctdf_mgm %&gt;% names()</span>
mgm_variable_types &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;g&quot;</span>, <span class="st">&quot;g&quot;</span>, <span class="kw">rep</span>(<span class="st">&quot;c&quot;</span>, <span class="dv">2</span>), <span class="st">&quot;g&quot;</span>, <span class="st">&quot;c&quot;</span>)
mgm_variable_levels &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;1&quot;</span>, <span class="st">&quot;1&quot;</span>, <span class="kw">rep</span>(<span class="st">&quot;2&quot;</span>, <span class="dv">2</span>), <span class="st">&quot;1&quot;</span>, <span class="st">&quot;2&quot;</span>)
<span class="co"># data.frame(mgm_variable_types, mgm_variable_levels, names(bctdf_mgm))</span>

mgm_obj &lt;-<span class="st"> </span>mgm<span class="op">::</span><span class="kw">mgm</span>(<span class="dt">data =</span> bctdf_mgm,
  <span class="dt">type =</span> mgm_variable_types,
  <span class="dt">level =</span> mgm_variable_levels,
  <span class="dt">lambdaSel =</span> <span class="st">&quot;CV&quot;</span>,
  <span class="dt">lambdaFolds =</span> <span class="dv">10</span>,
  <span class="dt">pbar =</span> <span class="ot">FALSE</span>, 
  <span class="dt">binarySign =</span> <span class="ot">TRUE</span>)
## Note that the sign of parameter estimates is stored separately; see ?mgm

pred_obj &lt;-<span class="st"> </span><span class="kw">predict</span>(<span class="dt">object =</span> mgm_obj,
                         <span class="dt">data =</span> bctdf_mgm)

pred_obj<span class="op">$</span>errors</code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Variable"],"name":[1],"type":["chr"],"align":["left"]},{"label":["RMSE"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["R2"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["CC"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["nCC"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["CCmarg"],"name":[6],"type":["dbl"],"align":["right"]}],"data":[{"1":"MVPA questionnaire","2":"0.871","3":"0.241","4":"NA","5":"NA","6":"NA","_rn_":"1"},{"1":"MVPA accelerometer","2":"0.961","3":"0.075","4":"NA","5":"NA","6":"NA","_rn_":"2"},{"1":"PA life values","2":"NA","3":"NA","4":"0.858","5":"0.256","6":"0.809","_rn_":"3"},{"1":"relevance of PA","2":"NA","3":"NA","4":"0.844","5":"0.305","6":"0.776","_rn_":"4"},{"1":"autonomous motivation","2":"0.816","3":"0.333","4":"NA","5":"NA","6":"NA","_rn_":"5"},{"1":"controlled motivation","2":"NA","3":"NA","4":"0.883","5":"0.000","6":"0.883","_rn_":"6"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[15],"max":[15]},"pages":{}}}
  </script>
</div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># Take R2 from gaussian, CC from categorical variables </span>
pie_errors &lt;-<span class="st"> </span><span class="kw">c</span>(pred_obj<span class="op">$</span>errors[<span class="dv">1</span>, <span class="dv">3</span>],
                pred_obj<span class="op">$</span>errors[<span class="dv">2</span>, <span class="dv">3</span>],
                pred_obj<span class="op">$</span>errors[<span class="dv">3</span><span class="op">:</span><span class="dv">4</span>, <span class="dv">4</span>],
                pred_obj<span class="op">$</span>errors[<span class="dv">5</span>, <span class="dv">3</span>],
                pred_obj<span class="op">$</span>errors[<span class="dv">6</span>, <span class="dv">4</span>])

<span class="co"># Coloring nodes: make a sequence of colors from the viridis palette. We need three colors (MVPA, BCTs, motivation), and &quot;begin&quot; from ones that are not too dark, so that black text shows up ok.</span>

node_colors &lt;-<span class="st"> </span><span class="kw">c</span>(viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">3</span>, <span class="dt">begin =</span> <span class="fl">0.4</span>, <span class="dt">end =</span> <span class="fl">0.99</span>)[<span class="dv">1</span>], <span class="co"># Color 1 for MVPA (questionnaire)</span>
                 viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">3</span>, <span class="dt">begin =</span> <span class="fl">0.4</span>, <span class="dt">end =</span> <span class="fl">0.99</span>)[<span class="dv">1</span>], <span class="co"># Color 1 for MVPA (accelerometer)</span>
                 <span class="kw">rep</span>(viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">3</span>, <span class="dt">begin =</span> <span class="fl">0.4</span>, <span class="dt">end =</span> <span class="fl">0.99</span>)[<span class="dv">2</span>], <span class="dv">2</span>), <span class="co"># 2x Color 2 for BCTs</span>
                 <span class="kw">rep</span>(viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">3</span>, <span class="dt">begin =</span> <span class="fl">0.4</span>, <span class="dt">end =</span> <span class="fl">0.99</span>)[<span class="dv">3</span>], <span class="dv">1</span>), <span class="co"># Color 3 for motivation (controlled)</span>
                 viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">3</span>, <span class="dt">begin =</span> <span class="fl">0.4</span>, <span class="dt">end =</span> <span class="fl">0.99</span>)[<span class="dv">3</span>]) <span class="co"># Color 3 for motivation (autonomous) </span>

BCT_mgm &lt;-<span class="st"> </span>qgraph<span class="op">::</span><span class="kw">qgraph</span>(mgm_obj<span class="op">$</span>pairwise<span class="op">$</span>wadj, 
            <span class="dt">layout =</span> <span class="st">&quot;spring&quot;</span>,
            <span class="dt">repulsion =</span> <span class="fl">0.99</span>, <span class="co"># To nudge the network from originally bad visual state</span>
            <span class="dt">title =</span> <span class="st">&quot;cognitive/motivational BCTs, PA &amp; motivation&quot;</span>,
            <span class="dt">edge.color =</span> <span class="kw">ifelse</span>(mgm_obj<span class="op">$</span>pairwise<span class="op">$</span>edgecolor <span class="op">==</span><span class="st"> &quot;darkgreen&quot;</span>, <span class="st">&quot;blue&quot;</span>, mgm_obj<span class="op">$</span>pairwise<span class="op">$</span>edgecolor),
            <span class="dt">pie =</span> pie_errors,
            <span class="dt">pieColor =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">5</span>, <span class="dt">begin =</span> <span class="fl">0.3</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">5</span>],
            <span class="dt">color =</span> node_colors,
            <span class="dt">labels =</span> <span class="kw">names</span>(bctdf_mgm),
            <span class="dt">label.cex =</span> <span class="fl">0.75</span>,
            <span class="dt">label.scale =</span> <span class="ot">FALSE</span>)</code></pre></div>
<p><img src="baseline-networks_files/figure-html/cognitiveBCTs2-1.png" width="2100" /></p>
<p>Adding the third (I have reminded myself even in my spare time, what kind of positive consequences frequent PA would have in my life):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">bctdf_mgm &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(
<span class="co">#  id,</span>
<span class="co">#  intervention,</span>
<span class="co">#  group,</span>
<span class="co">#  school,</span>
<span class="co">#  girl,</span>
  <span class="st">&#39;goal setting&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_01_T1,
  <span class="st">&#39;implementation plan&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_02_T1,
  <span class="st">&#39;plan by other&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_03_T1,
  <span class="st">&#39;reminder of plan&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_04_T1,
  <span class="st">&#39;subgoals&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_05_T1,
  <span class="st">&#39;new PA options&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_06_T1,
  <span class="st">&#39;barrier identification&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_07_T1,
  <span class="st">&#39;coping planning&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_08_T1,
  <span class="st">&#39;PA identity&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_09_T1,
  <span class="st">&#39;PA life values&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_10_T1,
  <span class="st">&#39;positive consequences&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_01_T1,
  <span class="st">&#39;log on paper&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_02_T1,
  <span class="st">&#39;smartphone&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_03_T1,
<span class="co">#  &#39;mnemonic cues&#39; = PA_frequencyDependentBCT_04_T1, # Issues with clarity of item wording </span>
  <span class="st">&#39;goal contrast&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_05_T1,
  <span class="st">&#39;relevance of PA&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_06_T1,
  <span class="st">&#39;changes at home&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_07_T1,
  <span class="st">&#39;social support&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_08_T1,
  <span class="st">&#39;failure contemplation&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_09_T1,
  <span class="st">&#39;MVPA questionnaire&#39;</span> =<span class="st"> </span>padaysLastweek_T1,
  <span class="st">&#39;MVPA accelerometer&#39;</span> =<span class="st"> </span>mvpaAccelerometer_T1,
  <span class="st">&#39;intrinsic&#39;</span> =<span class="st"> </span>PA_intrinsic_T1,
  <span class="st">&#39;identified&#39;</span> =<span class="st"> </span>PA_identified_T1,
  <span class="st">&#39;controlled motivation&#39;</span> =<span class="st"> </span>PA_controlled_T1) <span class="op">%&gt;%</span>
<span class="st"> </span><span class="kw">rowwise</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st"> </span>dplyr<span class="op">::</span><span class="kw">transmute</span>(
  <span class="co"># &#39;goal setting&#39; = ifelse(`goal setting` == 1, 0, 1),</span>
  <span class="co"># &#39;has plan&#39; = ifelse(`implementation plan` == 1 &amp; `plan by other` == 1, 0, 1),</span>
  <span class="co"># &#39;implementation plan&#39; = ifelse(`implementation plan` == 1, 0, 1),</span>
  <span class="co"># &#39;plan by other&#39; = ifelse(`plan by other` == 1, 0, 1),</span>
  <span class="co"># &#39;reminder of plan&#39; = ifelse(`reminder of plan` == 1, 0, 1),</span>
  <span class="co"># &#39;subgoals&#39; = ifelse(`subgoals` == 1, 0, 1),</span>
  <span class="co"># &#39;new PA options&#39; = ifelse(`new PA options` == 1, 0, 1),</span>
  <span class="co"># &#39;barrier identification&#39; = ifelse(`barrier identification` == 1, 0, 1),</span>
  <span class="co"># &#39;coping planning&#39; = ifelse(`coping planning` == 1, 0, 1),</span>
  <span class="co"># &#39;barriers identified or planned for&#39; = ifelse(`coping planning` == 1 &amp; `barrier identification` == 1, 0, 1),</span>
 <span class="co"># &#39;PA identity&#39; = ifelse(`PA identity` == 1, 0, 1),</span>
 <span class="st">&#39;PA life values&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">PA life values</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
  <span class="co"># &#39;identity, life values&#39; = ifelse(`PA identity` == 1 &amp; `PA life values` == 1, 0, 1),</span>
  <span class="st">&#39;positive consequences&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">positive consequences</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
  <span class="co"># &#39;monitoring PA&#39; = ifelse(`log on paper` == 1 &amp; `smartphone` == 1, 0, 1),</span>
  <span class="co"># &#39;mnemonic cues&#39; = ifelse(`mnemonic cues` == 1, 0, 1),</span>
  <span class="co"># &#39;goal contrast&#39; = ifelse(`goal contrast` == 1, 0, 1),</span>
  <span class="st">&#39;relevance of PA&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">relevance of PA</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
  <span class="co"># &#39;changes at home&#39; = ifelse(`changes at home` == 1, 0, 1),</span>
  <span class="co"># &#39;social support&#39; = ifelse(`social support` == 1, 0, 1),</span>
  <span class="co"># &#39;failure contemplation&#39; = ifelse(`failure contemplation` == 1, 0, 1),</span>
  <span class="st">&#39;autonomous motivation&#39;</span> =<span class="st"> </span><span class="kw">mean</span>(<span class="kw">c</span>(identified, intrinsic), <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),
<span class="co">#  &#39;girl&#39; = ifelse(girl == &quot;girl&quot;, 1, 0),</span>
  <span class="st">&#39;controlled motivation&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">controlled motivation</span><span class="st">`</span> <span class="op">&lt;</span><span class="st"> </span><span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">1</span>), <span class="co"># If &quot;at least partly&quot; or more true, input 1. Normality otherwise a problem.</span>
  <span class="st">&#39;MVPA questionnaire&#39;</span> =<span class="st"> `</span><span class="dt">MVPA questionnaire</span><span class="st">`</span> <span class="op">*</span><span class="st"> </span><span class="dv">1</span>, 
  <span class="st">&#39;MVPA accelerometer&#39;</span> =<span class="st"> `</span><span class="dt">MVPA accelerometer</span><span class="st">`</span> <span class="op">*</span><span class="st"> </span><span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st">  </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="st">&#39;MVPA questionnaire&#39;</span>, <span class="st">&#39;MVPA accelerometer&#39;</span>, <span class="kw">everything</span>())

bctdf_mgm<span class="op">$</span><span class="st">`</span><span class="dt">autonomous motivation</span><span class="st">`</span>[<span class="kw">is.nan</span>(bctdf_mgm<span class="op">$</span><span class="st">`</span><span class="dt">autonomous motivation</span><span class="st">`</span>)] &lt;-<span class="st"> </span><span class="ot">NA</span>

labs &lt;-<span class="st"> </span><span class="kw">names</span>(bctdf_mgm)

bctdf_mgm &lt;-<span class="st"> </span>bctdf_mgm <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">na.omit</span>(.)
<span class="co"># bctdf_mgm %&gt;% names()</span>
mgm_variable_types &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;g&quot;</span>, <span class="st">&quot;g&quot;</span>, <span class="kw">rep</span>(<span class="st">&quot;c&quot;</span>, <span class="dv">3</span>), <span class="st">&quot;g&quot;</span>, <span class="st">&quot;c&quot;</span>)
mgm_variable_levels &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;1&quot;</span>, <span class="st">&quot;1&quot;</span>, <span class="kw">rep</span>(<span class="st">&quot;2&quot;</span>, <span class="dv">3</span>), <span class="st">&quot;1&quot;</span>, <span class="st">&quot;2&quot;</span>)
<span class="co"># data.frame(mgm_variable_types, mgm_variable_levels, names(bctdf_mgm))</span>

mgm_obj &lt;-<span class="st"> </span>mgm<span class="op">::</span><span class="kw">mgm</span>(<span class="dt">data =</span> bctdf_mgm,
  <span class="dt">type =</span> mgm_variable_types,
  <span class="dt">level =</span> mgm_variable_levels,
  <span class="dt">lambdaSel =</span> <span class="st">&quot;CV&quot;</span>,
  <span class="dt">lambdaFolds =</span> <span class="dv">10</span>,
  <span class="dt">pbar =</span> <span class="ot">FALSE</span>, 
  <span class="dt">binarySign =</span> <span class="ot">TRUE</span>)
## Note that the sign of parameter estimates is stored separately; see ?mgm

pred_obj &lt;-<span class="st"> </span><span class="kw">predict</span>(<span class="dt">object =</span> mgm_obj,
                         <span class="dt">data =</span> bctdf_mgm)

pred_obj<span class="op">$</span>errors</code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Variable"],"name":[1],"type":["chr"],"align":["left"]},{"label":["RMSE"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["R2"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["CC"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["nCC"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["CCmarg"],"name":[6],"type":["dbl"],"align":["right"]}],"data":[{"1":"MVPA questionnaire","2":"0.867","3":"0.248","4":"NA","5":"NA","6":"NA","_rn_":"1"},{"1":"MVPA accelerometer","2":"0.962","3":"0.074","4":"NA","5":"NA","6":"NA","_rn_":"2"},{"1":"PA life values","2":"NA","3":"NA","4":"0.867","5":"0.304","6":"0.809","_rn_":"3"},{"1":"positive consequences","2":"NA","3":"NA","4":"0.900","5":"0.241","6":"0.868","_rn_":"4"},{"1":"relevance of PA","2":"NA","3":"NA","4":"0.867","5":"0.406","6":"0.776","_rn_":"5"},{"1":"autonomous motivation","2":"0.812","3":"0.340","4":"NA","5":"NA","6":"NA","_rn_":"6"},{"1":"controlled motivation","2":"NA","3":"NA","4":"0.883","5":"0.000","6":"0.883","_rn_":"7"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[15],"max":[15]},"pages":{}}}
  </script>
</div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># Take R2 from gaussian, CC from categorical variables </span>
pie_errors &lt;-<span class="st"> </span><span class="kw">c</span>(pred_obj<span class="op">$</span>errors[<span class="dv">1</span>, <span class="dv">3</span>],
                pred_obj<span class="op">$</span>errors[<span class="dv">2</span>, <span class="dv">3</span>],
                pred_obj<span class="op">$</span>errors[<span class="dv">3</span><span class="op">:</span><span class="dv">5</span>, <span class="dv">4</span>],
                pred_obj<span class="op">$</span>errors[<span class="dv">6</span>, <span class="dv">3</span>],
                pred_obj<span class="op">$</span>errors[<span class="dv">7</span>, <span class="dv">4</span>])

<span class="co"># Coloring nodes: make a sequence of colors from the viridis palette. We need three colors (MVPA, BCTs, motivation), and &quot;begin&quot; from ones that are not too dark, so that black text shows up ok.</span>

node_colors &lt;-<span class="st"> </span><span class="kw">c</span>(viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">3</span>, <span class="dt">begin =</span> <span class="fl">0.4</span>, <span class="dt">end =</span> <span class="fl">0.99</span>)[<span class="dv">1</span>], <span class="co"># Color 1 for MVPA (questionnaire)</span>
                 viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">3</span>, <span class="dt">begin =</span> <span class="fl">0.4</span>, <span class="dt">end =</span> <span class="fl">0.99</span>)[<span class="dv">1</span>], <span class="co"># Color 1 for MVPA (accelerometer)</span>
                 <span class="kw">rep</span>(viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">3</span>, <span class="dt">begin =</span> <span class="fl">0.4</span>, <span class="dt">end =</span> <span class="fl">0.99</span>)[<span class="dv">2</span>], <span class="dv">3</span>), <span class="co"># 3x Color 2 for BCTs</span>
                 <span class="kw">rep</span>(viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">3</span>, <span class="dt">begin =</span> <span class="fl">0.4</span>, <span class="dt">end =</span> <span class="fl">0.99</span>)[<span class="dv">3</span>], <span class="dv">1</span>), <span class="co"># Color 3 for motivation (controlled)</span>
                 viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">3</span>, <span class="dt">begin =</span> <span class="fl">0.4</span>, <span class="dt">end =</span> <span class="fl">0.99</span>)[<span class="dv">3</span>]) <span class="co"># Color 3 for motivation (autonomous) </span>

BCT_mgm &lt;-<span class="st"> </span>qgraph<span class="op">::</span><span class="kw">qgraph</span>(mgm_obj<span class="op">$</span>pairwise<span class="op">$</span>wadj, 
            <span class="dt">layout =</span> <span class="st">&quot;spring&quot;</span>,
            <span class="dt">repulsion =</span> <span class="fl">0.99</span>, <span class="co"># To nudge the network from originally bad visual state</span>
            <span class="dt">title =</span> <span class="st">&quot;cognitive/motivational BCTs, PA &amp; motivation&quot;</span>,
            <span class="dt">edge.color =</span> <span class="kw">ifelse</span>(mgm_obj<span class="op">$</span>pairwise<span class="op">$</span>edgecolor <span class="op">==</span><span class="st"> &quot;darkgreen&quot;</span>, <span class="st">&quot;blue&quot;</span>, mgm_obj<span class="op">$</span>pairwise<span class="op">$</span>edgecolor),
            <span class="dt">pie =</span> pie_errors,
            <span class="dt">pieColor =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">5</span>, <span class="dt">begin =</span> <span class="fl">0.3</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">5</span>],
            <span class="dt">color =</span> node_colors,
            <span class="dt">labels =</span> <span class="kw">names</span>(bctdf_mgm),
            <span class="dt">label.cex =</span> <span class="fl">0.75</span>,
            <span class="dt">label.scale =</span> <span class="ot">FALSE</span>)</code></pre></div>
<p><img src="baseline-networks_files/figure-html/cognitiveBCTs3-1.png" width="2100" /></p>
<p>Adding the fourth (I have thought about how PA fits my identity (self concept)):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">bctdf_mgm &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(
<span class="co">#  id,</span>
<span class="co">#  intervention,</span>
<span class="co">#  group,</span>
<span class="co">#  school,</span>
<span class="co">#  girl,</span>
  <span class="st">&#39;goal setting&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_01_T1,
  <span class="st">&#39;implementation plan&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_02_T1,
  <span class="st">&#39;plan by other&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_03_T1,
  <span class="st">&#39;reminder of plan&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_04_T1,
  <span class="st">&#39;subgoals&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_05_T1,
  <span class="st">&#39;new PA options&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_06_T1,
  <span class="st">&#39;barrier identification&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_07_T1,
  <span class="st">&#39;coping planning&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_08_T1,
  <span class="st">&#39;PA identity&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_09_T1,
  <span class="st">&#39;PA life values&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_10_T1,
  <span class="st">&#39;positive consequences&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_01_T1,
  <span class="st">&#39;log on paper&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_02_T1,
  <span class="st">&#39;smartphone&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_03_T1,
<span class="co">#  &#39;mnemonic cues&#39; = PA_frequencyDependentBCT_04_T1, # Issues with clarity of item wording </span>
  <span class="st">&#39;goal contrast&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_05_T1,
  <span class="st">&#39;relevance of PA&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_06_T1,
  <span class="st">&#39;changes at home&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_07_T1,
  <span class="st">&#39;social support&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_08_T1,
  <span class="st">&#39;failure contemplation&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_09_T1,
  <span class="st">&#39;MVPA questionnaire&#39;</span> =<span class="st"> </span>padaysLastweek_T1,
  <span class="st">&#39;MVPA accelerometer&#39;</span> =<span class="st"> </span>mvpaAccelerometer_T1,
  <span class="st">&#39;intrinsic&#39;</span> =<span class="st"> </span>PA_intrinsic_T1,
  <span class="st">&#39;identified&#39;</span> =<span class="st"> </span>PA_identified_T1,
  <span class="st">&#39;controlled motivation&#39;</span> =<span class="st"> </span>PA_controlled_T1) <span class="op">%&gt;%</span>
<span class="st"> </span><span class="kw">rowwise</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st"> </span>dplyr<span class="op">::</span><span class="kw">transmute</span>(
  <span class="co"># &#39;goal setting&#39; = ifelse(`goal setting` == 1, 0, 1),</span>
  <span class="co"># &#39;has plan&#39; = ifelse(`implementation plan` == 1 &amp; `plan by other` == 1, 0, 1),</span>
  <span class="co"># &#39;implementation plan&#39; = ifelse(`implementation plan` == 1, 0, 1),</span>
  <span class="co"># &#39;plan by other&#39; = ifelse(`plan by other` == 1, 0, 1),</span>
  <span class="co"># &#39;reminder of plan&#39; = ifelse(`reminder of plan` == 1, 0, 1),</span>
  <span class="co"># &#39;subgoals&#39; = ifelse(`subgoals` == 1, 0, 1),</span>
  <span class="co"># &#39;new PA options&#39; = ifelse(`new PA options` == 1, 0, 1),</span>
  <span class="co"># &#39;barrier identification&#39; = ifelse(`barrier identification` == 1, 0, 1),</span>
  <span class="co"># &#39;coping planning&#39; = ifelse(`coping planning` == 1, 0, 1),</span>
  <span class="co"># &#39;barriers identified or planned for&#39; = ifelse(`coping planning` == 1 &amp; `barrier identification` == 1, 0, 1),</span>
 <span class="st">&#39;PA identity&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">PA identity</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
 <span class="st">&#39;PA life values&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">PA life values</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
  <span class="co"># &#39;identity, life values&#39; = ifelse(`PA identity` == 1 &amp; `PA life values` == 1, 0, 1),</span>
  <span class="st">&#39;positive consequences&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">positive consequences</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
  <span class="co"># &#39;monitoring PA&#39; = ifelse(`log on paper` == 1 &amp; `smartphone` == 1, 0, 1),</span>
  <span class="co"># &#39;mnemonic cues&#39; = ifelse(`mnemonic cues` == 1, 0, 1),</span>
  <span class="co"># &#39;goal contrast&#39; = ifelse(`goal contrast` == 1, 0, 1),</span>
  <span class="st">&#39;relevance of PA&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">relevance of PA</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
  <span class="co"># &#39;changes at home&#39; = ifelse(`changes at home` == 1, 0, 1),</span>
  <span class="co"># &#39;social support&#39; = ifelse(`social support` == 1, 0, 1),</span>
  <span class="co"># &#39;failure contemplation&#39; = ifelse(`failure contemplation` == 1, 0, 1),</span>
  <span class="st">&#39;autonomous motivation&#39;</span> =<span class="st"> </span><span class="kw">mean</span>(<span class="kw">c</span>(identified, intrinsic), <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),
<span class="co">#  &#39;girl&#39; = ifelse(girl == &quot;girl&quot;, 1, 0),</span>
  <span class="st">&#39;controlled motivation&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">controlled motivation</span><span class="st">`</span> <span class="op">&lt;</span><span class="st"> </span><span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">1</span>), <span class="co"># If &quot;at least partly&quot; or more true, input 1. Normality otherwise a problem.</span>
  <span class="st">&#39;MVPA questionnaire&#39;</span> =<span class="st"> `</span><span class="dt">MVPA questionnaire</span><span class="st">`</span> <span class="op">*</span><span class="st"> </span><span class="dv">1</span>, 
  <span class="st">&#39;MVPA accelerometer&#39;</span> =<span class="st"> `</span><span class="dt">MVPA accelerometer</span><span class="st">`</span> <span class="op">*</span><span class="st"> </span><span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st">  </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="st">&#39;MVPA questionnaire&#39;</span>, <span class="st">&#39;MVPA accelerometer&#39;</span>, <span class="kw">everything</span>())

bctdf_mgm<span class="op">$</span><span class="st">`</span><span class="dt">autonomous motivation</span><span class="st">`</span>[<span class="kw">is.nan</span>(bctdf_mgm<span class="op">$</span><span class="st">`</span><span class="dt">autonomous motivation</span><span class="st">`</span>)] &lt;-<span class="st"> </span><span class="ot">NA</span>

labs &lt;-<span class="st"> </span><span class="kw">names</span>(bctdf_mgm)

bctdf_mgm &lt;-<span class="st"> </span>bctdf_mgm <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">na.omit</span>(.)
<span class="co"># bctdf_mgm %&gt;% names()</span>
mgm_variable_types &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;g&quot;</span>, <span class="st">&quot;g&quot;</span>, <span class="kw">rep</span>(<span class="st">&quot;c&quot;</span>, <span class="dv">4</span>), <span class="st">&quot;g&quot;</span>, <span class="st">&quot;c&quot;</span>)
mgm_variable_levels &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;1&quot;</span>, <span class="st">&quot;1&quot;</span>, <span class="kw">rep</span>(<span class="st">&quot;2&quot;</span>, <span class="dv">4</span>), <span class="st">&quot;1&quot;</span>, <span class="st">&quot;2&quot;</span>)
<span class="co"># data.frame(mgm_variable_types, mgm_variable_levels, names(bctdf_mgm))</span>

mgm_obj &lt;-<span class="st"> </span>mgm<span class="op">::</span><span class="kw">mgm</span>(<span class="dt">data =</span> bctdf_mgm,
  <span class="dt">type =</span> mgm_variable_types,
  <span class="dt">level =</span> mgm_variable_levels,
  <span class="dt">lambdaSel =</span> <span class="st">&quot;CV&quot;</span>,
  <span class="dt">lambdaFolds =</span> <span class="dv">10</span>,
  <span class="dt">pbar =</span> <span class="ot">FALSE</span>, 
  <span class="dt">binarySign =</span> <span class="ot">TRUE</span>)
## Note that the sign of parameter estimates is stored separately; see ?mgm

pred_obj &lt;-<span class="st"> </span><span class="kw">predict</span>(<span class="dt">object =</span> mgm_obj,
                         <span class="dt">data =</span> bctdf_mgm)

pred_obj<span class="op">$</span>errors</code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Variable"],"name":[1],"type":["chr"],"align":["left"]},{"label":["RMSE"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["R2"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["CC"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["nCC"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["CCmarg"],"name":[6],"type":["dbl"],"align":["right"]}],"data":[{"1":"MVPA questionnaire","2":"0.865","3":"0.251","4":"NA","5":"NA","6":"NA","_rn_":"1"},{"1":"MVPA accelerometer","2":"0.962","3":"0.074","4":"NA","5":"NA","6":"NA","_rn_":"2"},{"1":"PA identity","2":"NA","3":"NA","4":"0.908","5":"0.481","6":"0.823","_rn_":"3"},{"1":"PA life values","2":"NA","3":"NA","4":"0.914","5":"0.548","6":"0.810","_rn_":"4"},{"1":"positive consequences","2":"NA","3":"NA","4":"0.899","5":"0.233","6":"0.868","_rn_":"5"},{"1":"relevance of PA","2":"NA","3":"NA","4":"0.873","5":"0.431","6":"0.777","_rn_":"6"},{"1":"autonomous motivation","2":"0.812","3":"0.339","4":"NA","5":"NA","6":"NA","_rn_":"7"},{"1":"controlled motivation","2":"NA","3":"NA","4":"0.883","5":"0.000","6":"0.883","_rn_":"8"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[15],"max":[15]},"pages":{}}}
  </script>
</div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># Take R2 from gaussian, CC from categorical variables </span>
pie_errors &lt;-<span class="st"> </span><span class="kw">c</span>(pred_obj<span class="op">$</span>errors[<span class="dv">1</span>, <span class="dv">3</span>],
                pred_obj<span class="op">$</span>errors[<span class="dv">2</span>, <span class="dv">3</span>],
                pred_obj<span class="op">$</span>errors[<span class="dv">3</span><span class="op">:</span><span class="dv">6</span>, <span class="dv">4</span>],
                pred_obj<span class="op">$</span>errors[<span class="dv">7</span>, <span class="dv">3</span>],
                pred_obj<span class="op">$</span>errors[<span class="dv">8</span>, <span class="dv">4</span>])

<span class="co"># Coloring nodes: make a sequence of colors from the viridis palette. We need three colors (MVPA, BCTs, motivation), and &quot;begin&quot; from ones that are not too dark, so that black text shows up ok.</span>

node_colors &lt;-<span class="st"> </span><span class="kw">c</span>(viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">3</span>, <span class="dt">begin =</span> <span class="fl">0.4</span>, <span class="dt">end =</span> <span class="fl">0.99</span>)[<span class="dv">1</span>], <span class="co"># Color 1 for MVPA (questionnaire)</span>
                 viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">3</span>, <span class="dt">begin =</span> <span class="fl">0.4</span>, <span class="dt">end =</span> <span class="fl">0.99</span>)[<span class="dv">1</span>], <span class="co"># Color 1 for MVPA (accelerometer)</span>
                 <span class="kw">rep</span>(viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">3</span>, <span class="dt">begin =</span> <span class="fl">0.4</span>, <span class="dt">end =</span> <span class="fl">0.99</span>)[<span class="dv">2</span>], <span class="dv">4</span>), <span class="co"># 4x Color 2 for BCTs</span>
                 <span class="kw">rep</span>(viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">3</span>, <span class="dt">begin =</span> <span class="fl">0.4</span>, <span class="dt">end =</span> <span class="fl">0.99</span>)[<span class="dv">3</span>], <span class="dv">1</span>), <span class="co"># Color 3 for motivation (controlled)</span>
                 viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">3</span>, <span class="dt">begin =</span> <span class="fl">0.4</span>, <span class="dt">end =</span> <span class="fl">0.99</span>)[<span class="dv">3</span>]) <span class="co"># Color 3 for motivation (autonomous) </span>

BCT_mgm &lt;-<span class="st"> </span>qgraph<span class="op">::</span><span class="kw">qgraph</span>(mgm_obj<span class="op">$</span>pairwise<span class="op">$</span>wadj, 
            <span class="dt">layout =</span> <span class="st">&quot;spring&quot;</span>,
            <span class="dt">repulsion =</span> <span class="fl">0.99</span>, <span class="co"># To nudge the network from originally bad visual state</span>
            <span class="dt">title =</span> <span class="st">&quot;cognitive/motivational BCTs, PA &amp; motivation&quot;</span>,
            <span class="dt">edge.color =</span> <span class="kw">ifelse</span>(mgm_obj<span class="op">$</span>pairwise<span class="op">$</span>edgecolor <span class="op">==</span><span class="st"> &quot;darkgreen&quot;</span>, <span class="st">&quot;blue&quot;</span>, mgm_obj<span class="op">$</span>pairwise<span class="op">$</span>edgecolor),
            <span class="dt">pie =</span> pie_errors,
            <span class="dt">pieColor =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">5</span>, <span class="dt">begin =</span> <span class="fl">0.3</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">5</span>],
            <span class="dt">color =</span> node_colors,
            <span class="dt">labels =</span> <span class="kw">names</span>(bctdf_mgm),
            <span class="dt">label.cex =</span> <span class="fl">0.75</span>,
            <span class="dt">label.scale =</span> <span class="ot">FALSE</span>)</code></pre></div>
<p><img src="baseline-networks_files/figure-html/cognitiveBCTs4-1.png" width="2100" /></p>
<p>Next: Removing motivation items makes the negative connection between positive consequences and MVPA questionnaire disappear (see following plot). One explanation would be <a href="https://web.archive.org/web/20180807095037/http://www.the100.ci/2017/03/14/that-one-weird-third-variable-problem-nobody-ever-mentions-conditioning-on-a-collider/">conditioning on a collider</a>: if both physical activity and thinking about its positive consequences lead to autonomous motivation, this creates a spurious negative link between the two antecedents.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">bctdf_mgm &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(
<span class="co">#  id,</span>
<span class="co">#  intervention,</span>
<span class="co">#  group,</span>
<span class="co">#  school,</span>
<span class="co">#  girl,</span>
  <span class="st">&#39;goal setting&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_01_T1,
  <span class="st">&#39;implementation plan&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_02_T1,
  <span class="st">&#39;plan by other&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_03_T1,
  <span class="st">&#39;reminder of plan&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_04_T1,
  <span class="st">&#39;subgoals&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_05_T1,
  <span class="st">&#39;new PA options&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_06_T1,
  <span class="st">&#39;barrier identification&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_07_T1,
  <span class="st">&#39;coping planning&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_08_T1,
  <span class="st">&#39;PA identity&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_09_T1,
  <span class="st">&#39;PA life values&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_10_T1,
  <span class="st">&#39;positive consequences&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_01_T1,
  <span class="st">&#39;log on paper&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_02_T1,
  <span class="st">&#39;smartphone&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_03_T1,
<span class="co">#  &#39;mnemonic cues&#39; = PA_frequencyDependentBCT_04_T1, # Issues with clarity of item wording </span>
  <span class="st">&#39;goal contrast&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_05_T1,
  <span class="st">&#39;relevance of PA&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_06_T1,
  <span class="st">&#39;changes at home&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_07_T1,
  <span class="st">&#39;social support&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_08_T1,
  <span class="st">&#39;failure contemplation&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_09_T1,
  <span class="st">&#39;MVPA questionnaire&#39;</span> =<span class="st"> </span>padaysLastweek_T1,
  <span class="st">&#39;MVPA accelerometer&#39;</span> =<span class="st"> </span>mvpaAccelerometer_T1,
  <span class="st">&#39;intrinsic&#39;</span> =<span class="st"> </span>PA_intrinsic_T1,
  <span class="st">&#39;identified&#39;</span> =<span class="st"> </span>PA_identified_T1,
  <span class="st">&#39;controlled motivation&#39;</span> =<span class="st"> </span>PA_controlled_T1) <span class="op">%&gt;%</span>
<span class="st"> </span><span class="kw">rowwise</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st"> </span>dplyr<span class="op">::</span><span class="kw">transmute</span>(
  <span class="co"># &#39;goal setting&#39; = ifelse(`goal setting` == 1, 0, 1),</span>
  <span class="co"># &#39;has plan&#39; = ifelse(`implementation plan` == 1 &amp; `plan by other` == 1, 0, 1),</span>
  <span class="co"># &#39;implementation plan&#39; = ifelse(`implementation plan` == 1, 0, 1),</span>
  <span class="co"># &#39;plan by other&#39; = ifelse(`plan by other` == 1, 0, 1),</span>
  <span class="co"># &#39;reminder of plan&#39; = ifelse(`reminder of plan` == 1, 0, 1),</span>
  <span class="co"># &#39;subgoals&#39; = ifelse(`subgoals` == 1, 0, 1),</span>
  <span class="co"># &#39;new PA options&#39; = ifelse(`new PA options` == 1, 0, 1),</span>
  <span class="co"># &#39;barrier identification&#39; = ifelse(`barrier identification` == 1, 0, 1),</span>
  <span class="co"># &#39;coping planning&#39; = ifelse(`coping planning` == 1, 0, 1),</span>
  <span class="co"># &#39;barriers identified or planned for&#39; = ifelse(`coping planning` == 1 &amp; `barrier identification` == 1, 0, 1),</span>
 <span class="st">&#39;PA identity&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">PA identity</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
 <span class="st">&#39;PA life values&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">PA life values</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
  <span class="co"># &#39;identity, life values&#39; = ifelse(`PA identity` == 1 &amp; `PA life values` == 1, 0, 1),</span>
  <span class="st">&#39;positive consequences&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">positive consequences</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
  <span class="co"># &#39;monitoring PA&#39; = ifelse(`log on paper` == 1 &amp; `smartphone` == 1, 0, 1),</span>
  <span class="co"># &#39;mnemonic cues&#39; = ifelse(`mnemonic cues` == 1, 0, 1),</span>
  <span class="co"># &#39;goal contrast&#39; = ifelse(`goal contrast` == 1, 0, 1),</span>
  <span class="st">&#39;relevance of PA&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">relevance of PA</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
  <span class="co"># &#39;changes at home&#39; = ifelse(`changes at home` == 1, 0, 1),</span>
  <span class="co"># &#39;social support&#39; = ifelse(`social support` == 1, 0, 1),</span>
  <span class="co"># &#39;failure contemplation&#39; = ifelse(`failure contemplation` == 1, 0, 1),</span>
  <span class="st">&#39;autonomous motivation&#39;</span> =<span class="st"> </span><span class="kw">mean</span>(<span class="kw">c</span>(identified, intrinsic), <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),
<span class="co">#  &#39;girl&#39; = ifelse(girl == &quot;girl&quot;, 1, 0),</span>
  <span class="st">&#39;controlled motivation&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">controlled motivation</span><span class="st">`</span> <span class="op">&lt;</span><span class="st"> </span><span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">1</span>), <span class="co"># If &quot;at least partly&quot; or more true, input 1. Normality otherwise a problem.</span>
  <span class="st">&#39;MVPA questionnaire&#39;</span> =<span class="st"> `</span><span class="dt">MVPA questionnaire</span><span class="st">`</span> <span class="op">*</span><span class="st"> </span><span class="dv">1</span>, 
  <span class="st">&#39;MVPA accelerometer&#39;</span> =<span class="st"> `</span><span class="dt">MVPA accelerometer</span><span class="st">`</span> <span class="op">*</span><span class="st"> </span><span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st">  </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="st">&#39;MVPA questionnaire&#39;</span>, <span class="st">&#39;MVPA accelerometer&#39;</span>, <span class="kw">everything</span>()) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span><span class="st">&#39;autonomous motivation&#39;</span>, <span class="op">-</span><span class="st">&#39;controlled motivation&#39;</span>)

<span class="co"># bctdf_mgm$`autonomous motivation`[is.nan(bctdf_mgm$`autonomous motivation`)] &lt;- NA</span>

labs &lt;-<span class="st"> </span><span class="kw">names</span>(bctdf_mgm)

bctdf_mgm &lt;-<span class="st"> </span>bctdf_mgm <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">na.omit</span>(.)
<span class="co"># bctdf_mgm %&gt;% names()</span>
mgm_variable_types &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;g&quot;</span>, <span class="st">&quot;g&quot;</span>, <span class="kw">rep</span>(<span class="st">&quot;c&quot;</span>, <span class="dv">4</span>))
mgm_variable_levels &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;1&quot;</span>, <span class="st">&quot;1&quot;</span>, <span class="kw">rep</span>(<span class="st">&quot;2&quot;</span>, <span class="dv">4</span>))
<span class="co"># data.frame(mgm_variable_types, mgm_variable_levels, names(bctdf_mgm))</span>

mgm_obj &lt;-<span class="st"> </span>mgm<span class="op">::</span><span class="kw">mgm</span>(<span class="dt">data =</span> bctdf_mgm,
  <span class="dt">type =</span> mgm_variable_types,
  <span class="dt">level =</span> mgm_variable_levels,
  <span class="dt">lambdaSel =</span> <span class="st">&quot;CV&quot;</span>,
  <span class="dt">lambdaFolds =</span> <span class="dv">10</span>,
  <span class="dt">pbar =</span> <span class="ot">FALSE</span>, 
  <span class="dt">binarySign =</span> <span class="ot">TRUE</span>)
## Note that the sign of parameter estimates is stored separately; see ?mgm

pred_obj &lt;-<span class="st"> </span><span class="kw">predict</span>(<span class="dt">object =</span> mgm_obj,
                         <span class="dt">data =</span> bctdf_mgm)

pred_obj<span class="op">$</span>errors</code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Variable"],"name":[1],"type":["chr"],"align":["left"]},{"label":["RMSE"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["R2"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["CC"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["nCC"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["CCmarg"],"name":[6],"type":["dbl"],"align":["right"]}],"data":[{"1":"MVPA questionnaire","2":"0.927","3":"0.139","4":"NA","5":"NA","6":"NA","_rn_":"1"},{"1":"MVPA accelerometer","2":"0.963","3":"0.071","4":"NA","5":"NA","6":"NA","_rn_":"2"},{"1":"PA identity","2":"NA","3":"NA","4":"0.909","5":"0.484","6":"0.824","_rn_":"3"},{"1":"PA life values","2":"NA","3":"NA","4":"0.905","5":"0.503","6":"0.809","_rn_":"4"},{"1":"positive consequences","2":"NA","3":"NA","4":"0.893","5":"0.188","6":"0.868","_rn_":"5"},{"1":"relevance of PA","2":"NA","3":"NA","4":"0.865","5":"0.394","6":"0.777","_rn_":"6"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[15],"max":[15]},"pages":{}}}
  </script>
</div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># Take R2 from gaussian, CC from categorical variables </span>
pie_errors &lt;-<span class="st"> </span><span class="kw">c</span>(pred_obj<span class="op">$</span>errors[<span class="dv">1</span>, <span class="dv">3</span>],
                pred_obj<span class="op">$</span>errors[<span class="dv">2</span>, <span class="dv">3</span>],
                pred_obj<span class="op">$</span>errors[<span class="dv">3</span><span class="op">:</span><span class="dv">6</span>, <span class="dv">4</span>])

<span class="co"># Coloring nodes: make a sequence of colors from the viridis palette. We need three colors (MVPA, BCTs, motivation), and &quot;begin&quot; from ones that are not too dark, so that black text shows up ok.</span>

node_colors &lt;-<span class="st"> </span><span class="kw">c</span>(viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">3</span>, <span class="dt">begin =</span> <span class="fl">0.4</span>, <span class="dt">end =</span> <span class="fl">0.99</span>)[<span class="dv">1</span>], <span class="co"># Color 1 for MVPA (questionnaire)</span>
                 viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">3</span>, <span class="dt">begin =</span> <span class="fl">0.4</span>, <span class="dt">end =</span> <span class="fl">0.99</span>)[<span class="dv">1</span>], <span class="co"># Color 1 for MVPA (accelerometer)</span>
                 <span class="kw">rep</span>(viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">3</span>, <span class="dt">begin =</span> <span class="fl">0.4</span>, <span class="dt">end =</span> <span class="fl">0.99</span>)[<span class="dv">2</span>], <span class="dv">4</span>)) <span class="co"># 4x Color 2 for BCTs</span>

BCT_mgm &lt;-<span class="st"> </span>qgraph<span class="op">::</span><span class="kw">qgraph</span>(mgm_obj<span class="op">$</span>pairwise<span class="op">$</span>wadj, 
            <span class="dt">layout =</span> <span class="st">&quot;spring&quot;</span>,
            <span class="dt">repulsion =</span> <span class="fl">0.99</span>, <span class="co"># To nudge the network from originally bad visual state</span>
            <span class="dt">title =</span> <span class="st">&quot;cognitive/motivational BCTs, PA &amp; motivation&quot;</span>,
            <span class="dt">edge.color =</span> <span class="kw">ifelse</span>(mgm_obj<span class="op">$</span>pairwise<span class="op">$</span>edgecolor <span class="op">==</span><span class="st"> &quot;darkgreen&quot;</span>, <span class="st">&quot;blue&quot;</span>, mgm_obj<span class="op">$</span>pairwise<span class="op">$</span>edgecolor),
            <span class="dt">pie =</span> pie_errors,
            <span class="dt">pieColor =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">5</span>, <span class="dt">begin =</span> <span class="fl">0.3</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">5</span>],
            <span class="dt">color =</span> node_colors,
            <span class="dt">labels =</span> <span class="kw">names</span>(bctdf_mgm),
            <span class="dt">label.cex =</span> <span class="fl">0.75</span>,
            <span class="dt">label.scale =</span> <span class="ot">FALSE</span>)</code></pre></div>
<p><img src="baseline-networks_files/figure-html/cognitiveBCTs_collider1-1.png" width="2100" /></p>
<p>Keeping only the three items showing a presumable conditioning on a collider effect, does not lend support for the simple collider hypothesis with these variables.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">bctdf_mgm &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(
<span class="co">#  id,</span>
<span class="co">#  intervention,</span>
<span class="co">#  group,</span>
<span class="co">#  school,</span>
<span class="co">#  girl,</span>
  <span class="st">&#39;goal setting&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_01_T1,
  <span class="st">&#39;implementation plan&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_02_T1,
  <span class="st">&#39;plan by other&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_03_T1,
  <span class="st">&#39;reminder of plan&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_04_T1,
  <span class="st">&#39;subgoals&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_05_T1,
  <span class="st">&#39;new PA options&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_06_T1,
  <span class="st">&#39;barrier identification&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_07_T1,
  <span class="st">&#39;coping planning&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_08_T1,
  <span class="st">&#39;PA identity&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_09_T1,
  <span class="st">&#39;PA life values&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_10_T1,
  <span class="st">&#39;positive consequences&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_01_T1,
  <span class="st">&#39;log on paper&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_02_T1,
  <span class="st">&#39;smartphone&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_03_T1,
<span class="co">#  &#39;mnemonic cues&#39; = PA_frequencyDependentBCT_04_T1, # Issues with clarity of item wording </span>
  <span class="st">&#39;goal contrast&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_05_T1,
  <span class="st">&#39;relevance of PA&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_06_T1,
  <span class="st">&#39;changes at home&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_07_T1,
  <span class="st">&#39;social support&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_08_T1,
  <span class="st">&#39;failure contemplation&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_09_T1,
  <span class="st">&#39;MVPA questionnaire&#39;</span> =<span class="st"> </span>padaysLastweek_T1,
  <span class="st">&#39;MVPA accelerometer&#39;</span> =<span class="st"> </span>mvpaAccelerometer_T1,
  <span class="st">&#39;intrinsic&#39;</span> =<span class="st"> </span>PA_intrinsic_T1,
  <span class="st">&#39;identified&#39;</span> =<span class="st"> </span>PA_identified_T1,
  <span class="st">&#39;controlled motivation&#39;</span> =<span class="st"> </span>PA_controlled_T1) <span class="op">%&gt;%</span>
<span class="st"> </span><span class="kw">rowwise</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st"> </span>dplyr<span class="op">::</span><span class="kw">transmute</span>(
  <span class="co"># &#39;goal setting&#39; = ifelse(`goal setting` == 1, 0, 1),</span>
  <span class="co"># &#39;has plan&#39; = ifelse(`implementation plan` == 1 &amp; `plan by other` == 1, 0, 1),</span>
  <span class="co"># &#39;implementation plan&#39; = ifelse(`implementation plan` == 1, 0, 1),</span>
  <span class="co"># &#39;plan by other&#39; = ifelse(`plan by other` == 1, 0, 1),</span>
  <span class="co"># &#39;reminder of plan&#39; = ifelse(`reminder of plan` == 1, 0, 1),</span>
  <span class="co"># &#39;subgoals&#39; = ifelse(`subgoals` == 1, 0, 1),</span>
  <span class="co"># &#39;new PA options&#39; = ifelse(`new PA options` == 1, 0, 1),</span>
  <span class="co"># &#39;barrier identification&#39; = ifelse(`barrier identification` == 1, 0, 1),</span>
  <span class="co"># &#39;coping planning&#39; = ifelse(`coping planning` == 1, 0, 1),</span>
  <span class="co"># &#39;barriers identified or planned for&#39; = ifelse(`coping planning` == 1 &amp; `barrier identification` == 1, 0, 1),</span>
 <span class="co"># &#39;PA identity&#39; = ifelse(`PA identity` == 1, 0, 1),</span>
 <span class="st">&#39;PA life values&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">PA life values</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
  <span class="co"># &#39;identity, life values&#39; = ifelse(`PA identity` == 1 &amp; `PA life values` == 1, 0, 1),</span>
  <span class="st">&#39;positive consequences&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">positive consequences</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
  <span class="co"># &#39;monitoring PA&#39; = ifelse(`log on paper` == 1 &amp; `smartphone` == 1, 0, 1),</span>
  <span class="co"># &#39;mnemonic cues&#39; = ifelse(`mnemonic cues` == 1, 0, 1),</span>
  <span class="co"># &#39;goal contrast&#39; = ifelse(`goal contrast` == 1, 0, 1),</span>
  <span class="st">&#39;relevance of PA&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">relevance of PA</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
  <span class="co"># &#39;changes at home&#39; = ifelse(`changes at home` == 1, 0, 1),</span>
  <span class="co"># &#39;social support&#39; = ifelse(`social support` == 1, 0, 1),</span>
  <span class="co"># &#39;failure contemplation&#39; = ifelse(`failure contemplation` == 1, 0, 1),</span>
  <span class="st">&#39;autonomous motivation&#39;</span> =<span class="st"> </span><span class="kw">mean</span>(<span class="kw">c</span>(identified, intrinsic), <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),
<span class="co">#  &#39;girl&#39; = ifelse(girl == &quot;girl&quot;, 1, 0),</span>
  <span class="st">&#39;controlled motivation&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">controlled motivation</span><span class="st">`</span> <span class="op">&lt;</span><span class="st"> </span><span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">1</span>), <span class="co"># If &quot;at least partly&quot; or more true, input 1. Normality otherwise a problem.</span>
  <span class="st">&#39;MVPA questionnaire&#39;</span> =<span class="st"> `</span><span class="dt">MVPA questionnaire</span><span class="st">`</span> <span class="op">*</span><span class="st"> </span><span class="dv">1</span>, 
  <span class="st">&#39;MVPA accelerometer&#39;</span> =<span class="st"> `</span><span class="dt">MVPA accelerometer</span><span class="st">`</span> <span class="op">*</span><span class="st"> </span><span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st">  </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="st">&#39;MVPA questionnaire&#39;</span>, <span class="st">&#39;autonomous motivation&#39;</span>, <span class="st">&#39;positive consequences&#39;</span>)

bctdf_mgm<span class="op">$</span><span class="st">`</span><span class="dt">autonomous motivation</span><span class="st">`</span>[<span class="kw">is.nan</span>(bctdf_mgm<span class="op">$</span><span class="st">`</span><span class="dt">autonomous motivation</span><span class="st">`</span>)] &lt;-<span class="st"> </span><span class="ot">NA</span>

labs &lt;-<span class="st"> </span><span class="kw">names</span>(bctdf_mgm)

bctdf_mgm &lt;-<span class="st"> </span>bctdf_mgm <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">na.omit</span>(.)
<span class="co"># bctdf_mgm %&gt;% names()</span>
mgm_variable_types &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;g&quot;</span>, <span class="st">&quot;g&quot;</span>, <span class="st">&quot;c&quot;</span>)
mgm_variable_levels &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;1&quot;</span>, <span class="st">&quot;1&quot;</span>, <span class="st">&quot;2&quot;</span>)
<span class="co"># data.frame(mgm_variable_types, mgm_variable_levels, names(bctdf_mgm))</span>

mgm_obj &lt;-<span class="st"> </span>mgm<span class="op">::</span><span class="kw">mgm</span>(<span class="dt">data =</span> bctdf_mgm,
  <span class="dt">type =</span> mgm_variable_types,
  <span class="dt">level =</span> mgm_variable_levels,
  <span class="dt">lambdaSel =</span> <span class="st">&quot;CV&quot;</span>,
  <span class="dt">lambdaFolds =</span> <span class="dv">10</span>,
  <span class="dt">pbar =</span> <span class="ot">FALSE</span>, 
  <span class="dt">binarySign =</span> <span class="ot">TRUE</span>)
## Note that the sign of parameter estimates is stored separately; see ?mgm

pred_obj &lt;-<span class="st"> </span><span class="kw">predict</span>(<span class="dt">object =</span> mgm_obj,
                         <span class="dt">data =</span> bctdf_mgm)

pred_obj<span class="op">$</span>errors</code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Variable"],"name":[1],"type":["chr"],"align":["left"]},{"label":["RMSE"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["R2"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["CC"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["nCC"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["CCmarg"],"name":[6],"type":["dbl"],"align":["right"]}],"data":[{"1":"MVPA questionnaire","2":"0.904","3":"0.182","4":"NA","5":"NA","6":"NA","_rn_":"1"},{"1":"autonomous motivation","2":"0.864","3":"0.254","4":"NA","5":"NA","6":"NA","_rn_":"2"},{"1":"positive consequences","2":"NA","3":"NA","4":"0.871","5":"0.035","6":"0.866","_rn_":"3"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[15],"max":[15]},"pages":{}}}
  </script>
</div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># Take R2 from gaussian, CC from categorical variables </span>
pie_errors &lt;-<span class="st"> </span><span class="kw">c</span>(pred_obj<span class="op">$</span>errors[<span class="dv">1</span>, <span class="dv">3</span>],
                pred_obj<span class="op">$</span>errors[<span class="dv">2</span>, <span class="dv">3</span>],
                pred_obj<span class="op">$</span>errors[<span class="dv">3</span>, <span class="dv">4</span>])

<span class="co"># Coloring nodes: make a sequence of colors from the viridis palette. We need three colors (MVPA, BCTs, motivation), and &quot;begin&quot; from ones that are not too dark, so that black text shows up ok.</span>

node_colors &lt;-<span class="st"> </span><span class="kw">c</span>(viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">3</span>, <span class="dt">begin =</span> <span class="fl">0.4</span>, <span class="dt">end =</span> <span class="fl">0.99</span>)[<span class="dv">1</span>], <span class="co"># Color 1 for MVPA (questionnaire)</span>
                 viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">3</span>, <span class="dt">begin =</span> <span class="fl">0.4</span>, <span class="dt">end =</span> <span class="fl">0.99</span>)[<span class="dv">3</span>], <span class="co"># Color 3 for motivation (autonomous) </span>
                 viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">3</span>, <span class="dt">begin =</span> <span class="fl">0.4</span>, <span class="dt">end =</span> <span class="fl">0.99</span>)[<span class="dv">2</span>]) <span class="co"># Color 2 for BCTs</span>

BCT_mgm &lt;-<span class="st"> </span>qgraph<span class="op">::</span><span class="kw">qgraph</span>(mgm_obj<span class="op">$</span>pairwise<span class="op">$</span>wadj, 
            <span class="dt">layout =</span> <span class="st">&quot;spring&quot;</span>,
            <span class="dt">repulsion =</span> <span class="fl">0.99</span>, <span class="co"># To nudge the network from originally bad visual state</span>
            <span class="dt">title =</span> <span class="st">&quot;cognitive/motivational BCTs, PA &amp; motivation&quot;</span>,
            <span class="dt">edge.color =</span> <span class="kw">ifelse</span>(mgm_obj<span class="op">$</span>pairwise<span class="op">$</span>edgecolor <span class="op">==</span><span class="st"> &quot;darkgreen&quot;</span>, <span class="st">&quot;blue&quot;</span>, mgm_obj<span class="op">$</span>pairwise<span class="op">$</span>edgecolor),
            <span class="dt">pie =</span> pie_errors,
            <span class="dt">pieColor =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">5</span>, <span class="dt">begin =</span> <span class="fl">0.3</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">5</span>],
            <span class="dt">color =</span> node_colors,
            <span class="dt">labels =</span> <span class="kw">names</span>(bctdf_mgm),
            <span class="dt">label.cex =</span> <span class="fl">0.75</span>,
            <span class="dt">label.scale =</span> <span class="ot">FALSE</span>)</code></pre></div>
<p><img src="baseline-networks_files/figure-html/cognitiveBCTs_collider2-1.png" width="2100" /></p>
</div>
</div>
<div id="exercise-types" class="section level1">
<h1>Exercise types</h1>
<p>The first network is an Ising model with all participants.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
exerciseTypes_df &lt;-<span class="st"> </span>lmi <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(Kys0051.<span class="dv">1</span><span class="op">:</span>Kys0064.<span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="kw">contains</span>(<span class="st">&quot;.1&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate_all</span>(<span class="kw">funs</span>(<span class="kw">replace_na</span>(., <span class="dv">0</span>)))
<span class="co"># exerciseTypes_df$track &lt;- df$track</span>
<span class="co"># exerciseTypes_df$girl &lt;- df$girl</span>

<span class="kw">names</span>(exerciseTypes_df) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Team ball games&quot;</span>, 
                             <span class="st">&quot;Other ball games&quot;</span>,
                             <span class="st">&quot;Gym training&quot;</span>,
                             <span class="st">&quot;Combat sports&quot;</span>,
                             <span class="st">&quot;Fitness classes&quot;</span>,
                             <span class="st">&quot;Home workout&quot;</span>,
                             <span class="st">&quot;Cycling&quot;</span>,
                             <span class="st">&quot;Swimming&quot;</span>,
                             <span class="st">&quot;Walking&quot;</span>,
                             <span class="st">&quot;Running&quot;</span>,
                             <span class="st">&quot;Skiing&quot;</span>,
                             <span class="st">&quot;Roller skating&quot;</span>, 
                             <span class="st">&quot;Horseback riding&quot;</span>,
                             <span class="st">&quot;Other&quot;</span>
                             )

exerciseTypes_df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">summarise_all</span>(<span class="kw">funs</span>(sum))</code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["Team ball games"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["Other ball games"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["Gym training"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Combat sports"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["Fitness classes"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["Home workout"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["Cycling"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["Swimming"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["Walking"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["Running"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["Skiing"],"name":[11],"type":["dbl"],"align":["right"]},{"label":["Roller skating"],"name":[12],"type":["dbl"],"align":["right"]},{"label":["Horseback riding"],"name":[13],"type":["dbl"],"align":["right"]},{"label":["Other"],"name":[14],"type":["dbl"],"align":["right"]}],"data":[{"1":"228","2":"65","3":"411","4":"77","5":"59","6":"220","7":"163","8":"100","9":"590","10":"284","11":"42","12":"8","13":"39","14":"119"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[15],"max":[15]},"pages":{}}}
  </script>
</div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># Roller skating has only 8 observations; leave out</span>
exerciseTypes_df &lt;-<span class="st"> </span>exerciseTypes_df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span><span class="st">`</span><span class="dt">Roller skating</span><span class="st">`</span>)

<span class="co"># Variable types are muddled, change all to numeric</span>
exerciseTypes_df &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(purrr<span class="op">::</span><span class="kw">map</span>(exerciseTypes_df, <span class="st">`</span><span class="dt">class&lt;-</span><span class="st">`</span>, <span class="kw">c</span>(<span class="st">&quot;numeric&quot;</span>))) 

<span class="co"># Change data frame to type tbl to allow for spaces</span>
exerciseTypes_df &lt;-<span class="st"> </span><span class="kw">as.tbl</span>(exerciseTypes_df)

<span class="co"># Take all names, replace the dots with space</span>
<span class="kw">names</span>(exerciseTypes_df) &lt;-<span class="st"> </span>stringr<span class="op">::</span><span class="kw">str_replace_all</span>(<span class="kw">names</span>(exerciseTypes_df), <span class="dt">pattern =</span> <span class="st">&quot;</span><span class="ch">\\</span><span class="st">.&quot;</span>, <span class="dt">replacement =</span> <span class="st">&quot; &quot;</span>)

exerciseTypes_network &lt;-<span class="st"> </span>bootnet<span class="op">::</span><span class="kw">estimateNetwork</span>(exerciseTypes_df, <span class="dt">default=</span><span class="st">&quot;IsingFit&quot;</span>)
## 
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|</span><span class="st">                                                                 </span><span class="er">|</span><span class="st">   </span><span class="dv">0</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|=====</span><span class="st">                                                            </span><span class="er">|</span><span class="st">   </span><span class="dv">8</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|==========</span><span class="st">                                                       </span><span class="er">|</span><span class="st">  </span><span class="dv">15</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|===============</span><span class="st">                                                  </span><span class="er">|</span><span class="st">  </span><span class="dv">23</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|====================</span><span class="st">                                             </span><span class="er">|</span><span class="st">  </span><span class="dv">31</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|=========================</span><span class="st">                                        </span><span class="er">|</span><span class="st">  </span><span class="dv">38</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|==============================</span><span class="st">                                   </span><span class="er">|</span><span class="st">  </span><span class="dv">46</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|===================================</span><span class="st">                              </span><span class="er">|</span><span class="st">  </span><span class="dv">54</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|========================================</span><span class="st">                         </span><span class="er">|</span><span class="st">  </span><span class="dv">62</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|=============================================</span><span class="st">                    </span><span class="er">|</span><span class="st">  </span><span class="dv">69</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|==================================================</span><span class="st">               </span><span class="er">|</span><span class="st">  </span><span class="dv">77</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|=======================================================</span><span class="st">          </span><span class="er">|</span><span class="st">  </span><span class="dv">85</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|============================================================</span><span class="st">     </span><span class="er">|</span><span class="st">  </span><span class="dv">92</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|=================================================================|</span><span class="st"> </span><span class="dv">100</span>%

<span class="co"># Create means for filling nodes</span>
piefill &lt;-<span class="st"> </span>exerciseTypes_df <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">summarise_all</span>(<span class="kw">funs</span>(<span class="kw">mean</span>(., <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))) 

<span class="co"># Plot network</span>
exerciseTypes_ising &lt;-<span class="st"> </span><span class="kw">plot</span>(
  exerciseTypes_network, 
  <span class="dt">layout =</span> <span class="st">&quot;spring&quot;</span>, 
  <span class="dt">label.scale =</span> <span class="ot">FALSE</span>, 
  <span class="dt">title =</span> <span class="st">&quot;Ising fit: self-reported exercise types&quot;</span>, 
  <span class="co"># label.cex = 0.75,</span>
  <span class="dt">pie =</span> piefill, 
  <span class="dt">color =</span> <span class="st">&quot;skyblue&quot;</span>,
  <span class="dt">pieBorder =</span> <span class="dv">1</span>)</code></pre></div>
<p><img src="baseline-networks_files/figure-html/exercisetypes-ising-1.png" width="2100" /></p>
<p>Same network, but estimated with mgm:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
exerciseTypes_df &lt;-<span class="st"> </span>lmi <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(Kys0051.<span class="dv">1</span><span class="op">:</span>Kys0064.<span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="kw">contains</span>(<span class="st">&quot;.1&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate_all</span>(<span class="kw">funs</span>(<span class="kw">replace_na</span>(., <span class="dv">0</span>)))
<span class="co"># exerciseTypes_df$track &lt;- df$track</span>
<span class="co"># exerciseTypes_df$girl &lt;- df$girl</span>
<span class="co"># exerciseTypes_df$`PA accelerometer` &lt;- df$mvpaAccelerometer_T1</span>
<span class="co"># exerciseTypes_df$`PA self-report` &lt;- df$padaysLastweek_T1</span>

<span class="kw">names</span>(exerciseTypes_df) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Team ball games&quot;</span>, 
                             <span class="st">&quot;Other ball games&quot;</span>,
                             <span class="st">&quot;Gym training&quot;</span>,
                             <span class="st">&quot;Combat sports&quot;</span>,
                             <span class="st">&quot;Fitness classes&quot;</span>,
                             <span class="st">&quot;Home workout&quot;</span>,
                             <span class="st">&quot;Cycling&quot;</span>,
                             <span class="st">&quot;Swimming&quot;</span>,
                             <span class="st">&quot;Walking&quot;</span>,
                             <span class="st">&quot;Running&quot;</span>,
                             <span class="st">&quot;Skiing&quot;</span>,
                             <span class="st">&quot;Roller skating&quot;</span>,
                             <span class="st">&quot;Horseback riding&quot;</span>,
                             <span class="st">&quot;Other&quot;</span>
                             <span class="co"># &quot;PA accelerometer&quot;,</span>
                             <span class="co"># &quot;PA self-report&quot;</span>
                             )

<span class="co"># Roller skating has only 8 observations; leave out</span>
exerciseTypes_df &lt;-<span class="st"> </span>exerciseTypes_df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span><span class="st">`</span><span class="dt">Roller skating</span><span class="st">`</span>)

<span class="co"># Variable types are muddled, change all to numeric</span>
exerciseTypes_df &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(purrr<span class="op">::</span><span class="kw">map</span>(exerciseTypes_df, <span class="st">`</span><span class="dt">class&lt;-</span><span class="st">`</span>, <span class="kw">c</span>(<span class="st">&quot;numeric&quot;</span>))) 

<span class="co"># Change data frame to type tbl to allow for spaces</span>
exerciseTypes_df &lt;-<span class="st"> </span><span class="kw">as.tbl</span>(exerciseTypes_df)

<span class="co"># Take all names, replace the dots with space</span>
<span class="kw">names</span>(exerciseTypes_df) &lt;-<span class="st"> </span>stringr<span class="op">::</span><span class="kw">str_replace_all</span>(<span class="kw">names</span>(exerciseTypes_df), <span class="dt">pattern =</span> <span class="st">&quot;</span><span class="ch">\\</span><span class="st">.&quot;</span>, <span class="dt">replacement =</span> <span class="st">&quot; &quot;</span>)

<span class="co"># Remove incomplete cases</span>
exerciseTypes_df_fullobs &lt;-<span class="st"> </span>exerciseTypes_df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">na.omit</span>()

<span class="co"># Tell mgm, that the first 14 variables are categorical and the last two are gaussian</span>
exerciseTypes_df_variable_types &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">&quot;c&quot;</span>, <span class="dv">13</span>))
exerciseTypes_df_variable_levels &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">&quot;2&quot;</span>, <span class="dv">13</span>))
<span class="co"># data.frame(exerciseTypes_df_variable_types, exerciseTypes_df_variable_levels, names(exerciseTypes_df))</span>

mgm_obj &lt;-<span class="st"> </span>mgm<span class="op">::</span><span class="kw">mgm</span>(<span class="dt">data =</span> exerciseTypes_df_fullobs,
  <span class="dt">type =</span> exerciseTypes_df_variable_types,
  <span class="dt">level =</span> exerciseTypes_df_variable_levels,
  <span class="dt">lambdaSel =</span> <span class="st">&quot;CV&quot;</span>,
  <span class="dt">lambdaFolds =</span> <span class="dv">10</span>,
  <span class="dt">pbar =</span> <span class="ot">FALSE</span>, 
  <span class="dt">binarySign =</span> <span class="ot">TRUE</span>)
## Note that the sign of parameter estimates is stored separately; see ?mgm

pred_obj &lt;-<span class="st"> </span><span class="kw">predict</span>(<span class="dt">object =</span> mgm_obj,
                         <span class="dt">data =</span> exerciseTypes_df_fullobs)

<span class="co"># pred_obj$errors</span>

<span class="co"># Take R2 from gaussian, CC from categorical variables </span>
pie_errors &lt;-<span class="st"> </span><span class="kw">c</span>(pred_obj<span class="op">$</span>errors[<span class="dv">1</span><span class="op">:</span><span class="dv">13</span>, <span class="dv">4</span>])

<span class="co"># Define node colors</span>
node_colors &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">rep</span>(viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">3</span>, <span class="dt">begin =</span> <span class="fl">0.4</span>, <span class="dt">end =</span> <span class="fl">0.95</span>)[<span class="dv">1</span>], <span class="dv">13</span>))

exerciseTypes_mgm &lt;-<span class="st"> </span>qgraph<span class="op">::</span><span class="kw">qgraph</span>(mgm_obj<span class="op">$</span>pairwise<span class="op">$</span>wadj, 
            <span class="dt">layout =</span> <span class="st">&quot;spring&quot;</span>,
            <span class="dt">repulsion =</span> <span class="fl">0.999</span>, <span class="co"># To nudge the network from originally bad visual state</span>
            <span class="dt">title =</span> <span class="st">&quot;Mixed graphical model: Types of reported physical activity&quot;</span>,
            <span class="dt">edge.color =</span> <span class="kw">ifelse</span>(mgm_obj<span class="op">$</span>pairwise<span class="op">$</span>edgecolor <span class="op">==</span><span class="st"> &quot;darkgreen&quot;</span>, <span class="st">&quot;blue&quot;</span>, mgm_obj<span class="op">$</span>pairwise<span class="op">$</span>edgecolor),
            <span class="dt">pie =</span> pie_errors,
            <span class="dt">pieColor =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">3</span>, <span class="dt">begin =</span> <span class="fl">0.4</span>, <span class="dt">end =</span> <span class="fl">0.95</span>)[<span class="dv">2</span>],
            <span class="dt">color =</span> node_colors,
            <span class="dt">labels =</span> <span class="kw">names</span>(exerciseTypes_df_fullobs),
            <span class="dt">label.cex =</span> <span class="fl">0.75</span>,
            <span class="dt">label.scale =</span> <span class="ot">FALSE</span>,
            <span class="dt">label.color =</span> <span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">&quot;black&quot;</span>, <span class="dv">13</span>)))</code></pre></div>
<p><img src="baseline-networks_files/figure-html/exercisetypes-mgm-1.png" width="2100" /></p>
<p>Below, we average the layout and plot these networks side-by-side for comparison.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">avglayout &lt;-<span class="st"> </span><span class="kw">averageLayout</span>(exerciseTypes_mgm, exerciseTypes_ising)
## Error in averageLayout(exerciseTypes_mgm, exerciseTypes_ising): could not find function &quot;averageLayout&quot;

<span class="kw">layout</span>(<span class="kw">t</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>))

exerciseTypes_ising &lt;-<span class="st"> </span><span class="kw">plot</span>(
  exerciseTypes_network, 
  <span class="dt">layout =</span> avglayout, 
  <span class="dt">label.scale =</span> <span class="ot">FALSE</span>, 
  <span class="dt">title =</span> <span class="st">&quot;Ising fit (EBIC model selection)&quot;</span>, 
  <span class="dt">label.cex =</span> <span class="fl">0.75</span>,
  <span class="dt">pie =</span> piefill, 
  <span class="dt">color =</span> <span class="st">&quot;skyblue&quot;</span>,
  <span class="dt">pieBorder =</span> <span class="dv">1</span>)
## Error in qgraph::qgraph(wMat, labels = labels, directed = directed, parallelEdge = parallelEdge, : object &#39;avglayout&#39; not found

exerciseTypes_mgm &lt;-<span class="st"> </span>qgraph<span class="op">::</span><span class="kw">qgraph</span>(mgm_obj<span class="op">$</span>pairwise<span class="op">$</span>wadj, 
            <span class="dt">layout =</span> avglayout,
            <span class="dt">repulsion =</span> <span class="fl">0.999</span>, <span class="co"># To nudge the network from originally bad visual state</span>
            <span class="dt">title =</span> <span class="st">&quot;Mixed graphical model (Cross-validation)&quot;</span>,
            <span class="dt">edge.color =</span> <span class="kw">ifelse</span>(mgm_obj<span class="op">$</span>pairwise<span class="op">$</span>edgecolor <span class="op">==</span><span class="st"> &quot;darkgreen&quot;</span>, <span class="st">&quot;blue&quot;</span>, mgm_obj<span class="op">$</span>pairwise<span class="op">$</span>edgecolor),
            <span class="dt">pie =</span> pie_errors,
            <span class="dt">pieColor =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">3</span>, <span class="dt">begin =</span> <span class="fl">0.4</span>, <span class="dt">end =</span> <span class="fl">0.95</span>)[<span class="dv">2</span>],
            <span class="dt">color =</span> node_colors,
            <span class="dt">labels =</span> <span class="kw">names</span>(exerciseTypes_df_fullobs),
            <span class="dt">label.cex =</span> <span class="fl">0.75</span>,
            <span class="dt">label.scale =</span> <span class="ot">FALSE</span>,
            <span class="dt">label.color =</span> <span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">&quot;black&quot;</span>, <span class="dv">13</span>))
            )
## Error in qgraph::qgraph(mgm_obj$pairwise$wadj, layout = avglayout, repulsion = 0.999, : object &#39;avglayout&#39; not found</code></pre></div>
<p>Graph below includes the moderate-to-vigorous physical activity measures, and shows a mixed graphical model with model selection done by cross-validation.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
exerciseTypes_df &lt;-<span class="st"> </span>lmi <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(Kys0051.<span class="dv">1</span><span class="op">:</span>Kys0064.<span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="kw">contains</span>(<span class="st">&quot;.1&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate_all</span>(<span class="kw">funs</span>(<span class="kw">replace_na</span>(., <span class="dv">0</span>)))
<span class="co"># exerciseTypes_df$track &lt;- df$track</span>
<span class="co"># exerciseTypes_df$girl &lt;- df$girl</span>
exerciseTypes_df<span class="op">$</span><span class="st">`</span><span class="dt">PA accelerometer</span><span class="st">`</span> &lt;-<span class="st"> </span>df<span class="op">$</span>mvpaAccelerometer_T1
exerciseTypes_df<span class="op">$</span><span class="st">`</span><span class="dt">PA self-report</span><span class="st">`</span> &lt;-<span class="st"> </span>df<span class="op">$</span>padaysLastweek_T1

<span class="kw">names</span>(exerciseTypes_df) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Team ball games&quot;</span>, 
                             <span class="st">&quot;Other ball games&quot;</span>,
                             <span class="st">&quot;Gym training&quot;</span>,
                             <span class="st">&quot;Combat sports&quot;</span>,
                             <span class="st">&quot;Fitness classes&quot;</span>,
                             <span class="st">&quot;Home workout&quot;</span>,
                             <span class="st">&quot;Cycling&quot;</span>,
                             <span class="st">&quot;Swimming&quot;</span>,
                             <span class="st">&quot;Walking&quot;</span>,
                             <span class="st">&quot;Running&quot;</span>,
                             <span class="st">&quot;Skiing&quot;</span>,
                             <span class="st">&quot;Roller skating&quot;</span>,
                             <span class="st">&quot;Horseback riding&quot;</span>,
                             <span class="st">&quot;Other&quot;</span>,
                             <span class="st">&quot;PA accelerometer&quot;</span>,
                             <span class="st">&quot;PA self-report&quot;</span>
                             )

<span class="co"># Roller skating has only 8 observations; leave out</span>
exerciseTypes_df &lt;-<span class="st"> </span>exerciseTypes_df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span><span class="st">`</span><span class="dt">Roller skating</span><span class="st">`</span>)

<span class="co"># Variable types are muddled, change all to numeric</span>
exerciseTypes_df &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(purrr<span class="op">::</span><span class="kw">map</span>(exerciseTypes_df, <span class="st">`</span><span class="dt">class&lt;-</span><span class="st">`</span>, <span class="kw">c</span>(<span class="st">&quot;numeric&quot;</span>))) 

<span class="co"># Change data frame to type tbl to allow for spaces</span>
exerciseTypes_df &lt;-<span class="st"> </span><span class="kw">as.tbl</span>(exerciseTypes_df)

<span class="co"># Take all names, replace the dots with space</span>
<span class="kw">names</span>(exerciseTypes_df) &lt;-<span class="st"> </span>stringr<span class="op">::</span><span class="kw">str_replace_all</span>(<span class="kw">names</span>(exerciseTypes_df), <span class="dt">pattern =</span> <span class="st">&quot;</span><span class="ch">\\</span><span class="st">.&quot;</span>, <span class="dt">replacement =</span> <span class="st">&quot; &quot;</span>)

<span class="co"># Remove incomplete cases</span>
exerciseTypes_df_fullobs &lt;-<span class="st"> </span>exerciseTypes_df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">na.omit</span>()

<span class="co"># Tell mgm, that the first 14 variables are categorical and the last two are gaussian</span>
exerciseTypes_df_variable_types &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">&quot;c&quot;</span>, <span class="dv">13</span>), <span class="kw">rep</span>(<span class="st">&quot;g&quot;</span>, <span class="dv">2</span>))
exerciseTypes_df_variable_levels &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">&quot;2&quot;</span>, <span class="dv">13</span>), <span class="kw">rep</span>(<span class="st">&quot;1&quot;</span>, <span class="dv">2</span>))
<span class="co"># data.frame(exerciseTypes_df_variable_types, exerciseTypes_df_variable_levels, names(exerciseTypes_df))</span>

mgm_obj_CV &lt;-<span class="st"> </span>mgm<span class="op">::</span><span class="kw">mgm</span>(<span class="dt">data =</span> exerciseTypes_df_fullobs,
  <span class="dt">type =</span> exerciseTypes_df_variable_types,
  <span class="dt">level =</span> exerciseTypes_df_variable_levels,
  <span class="dt">lambdaSel =</span> <span class="st">&quot;CV&quot;</span>,
  <span class="dt">lambdaFolds =</span> <span class="dv">10</span>,
  <span class="dt">pbar =</span> <span class="ot">FALSE</span>, 
  <span class="dt">binarySign =</span> <span class="ot">TRUE</span>)
## Note that the sign of parameter estimates is stored separately; see ?mgm

pred_obj &lt;-<span class="st"> </span><span class="kw">predict</span>(<span class="dt">object =</span> mgm_obj_CV,
                         <span class="dt">data =</span> exerciseTypes_df_fullobs)

<span class="co"># pred_obj$errors</span>

<span class="co"># Take R2 from gaussian, CC from categorical variables </span>
pie_errors &lt;-<span class="st"> </span><span class="kw">c</span>(pred_obj<span class="op">$</span>errors[<span class="dv">1</span><span class="op">:</span><span class="dv">13</span>, <span class="dv">4</span>],
                pred_obj<span class="op">$</span>errors[<span class="dv">14</span><span class="op">:</span><span class="dv">15</span>, <span class="dv">3</span>])

<span class="co"># Define node colors</span>
node_colors &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">rep</span>(viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">3</span>, <span class="dt">begin =</span> <span class="fl">0.4</span>, <span class="dt">end =</span> <span class="fl">0.95</span>)[<span class="dv">1</span>], <span class="dv">13</span>),
                 <span class="kw">rep</span>(viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">3</span>, <span class="dt">begin =</span> <span class="fl">0.4</span>, <span class="dt">end =</span> <span class="fl">0.95</span>)[<span class="dv">3</span>], <span class="dv">2</span>))

exerciseTypes_mgm_withMeasures &lt;-<span class="st"> </span>qgraph<span class="op">::</span><span class="kw">qgraph</span>(mgm_obj_CV<span class="op">$</span>pairwise<span class="op">$</span>wadj, 
            <span class="dt">layout =</span> <span class="st">&quot;spring&quot;</span>,
            <span class="dt">repulsion =</span> <span class="fl">0.99</span>, <span class="co"># To nudge the network from originally bad visual state</span>
            <span class="dt">title =</span> <span class="st">&quot;Mixed graphical model: Types of reported physical activity and their relations to measured MVPA&quot;</span>,
            <span class="dt">edge.color =</span> <span class="kw">ifelse</span>(mgm_obj_CV<span class="op">$</span>pairwise<span class="op">$</span>edgecolor <span class="op">==</span><span class="st"> &quot;darkgreen&quot;</span>, <span class="st">&quot;blue&quot;</span>, mgm_obj_CV<span class="op">$</span>pairwise<span class="op">$</span>edgecolor),
            <span class="dt">pie =</span> pie_errors,
            <span class="dt">pieColor =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">3</span>, <span class="dt">begin =</span> <span class="fl">0.4</span>, <span class="dt">end =</span> <span class="fl">0.95</span>)[<span class="dv">2</span>],
            <span class="dt">color =</span> node_colors,
            <span class="dt">labels =</span> <span class="kw">names</span>(exerciseTypes_df_fullobs),
            <span class="dt">label.cex =</span> <span class="fl">0.75</span>,
            <span class="dt">label.scale =</span> <span class="ot">FALSE</span>,
            <span class="dt">label.color =</span> <span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">&quot;black&quot;</span>, <span class="dv">15</span>)))</code></pre></div>
<p><img src="baseline-networks_files/figure-html/exercisetypes-mgm-CV-1.png" width="2100" /></p>
<p>The next graph is identical, except that model selection is done by the Extended Bayesian Information Criterion (EBIC).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
exerciseTypes_df &lt;-<span class="st"> </span>lmi <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(Kys0051.<span class="dv">1</span><span class="op">:</span>Kys0064.<span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="kw">contains</span>(<span class="st">&quot;.1&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate_all</span>(<span class="kw">funs</span>(<span class="kw">replace_na</span>(., <span class="dv">0</span>)))
<span class="co"># exerciseTypes_df$track &lt;- df$track</span>
<span class="co"># exerciseTypes_df$girl &lt;- df$girl</span>
exerciseTypes_df<span class="op">$</span><span class="st">`</span><span class="dt">PA accelerometer</span><span class="st">`</span> &lt;-<span class="st"> </span>df<span class="op">$</span>mvpaAccelerometer_T1
exerciseTypes_df<span class="op">$</span><span class="st">`</span><span class="dt">PA self-report</span><span class="st">`</span> &lt;-<span class="st"> </span>df<span class="op">$</span>padaysLastweek_T1

<span class="kw">names</span>(exerciseTypes_df) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Team ball games&quot;</span>, 
                             <span class="st">&quot;Other ball games&quot;</span>,
                             <span class="st">&quot;Gym training&quot;</span>,
                             <span class="st">&quot;Combat sports&quot;</span>,
                             <span class="st">&quot;Fitness classes&quot;</span>,
                             <span class="st">&quot;Home workout&quot;</span>,
                             <span class="st">&quot;Cycling&quot;</span>,
                             <span class="st">&quot;Swimming&quot;</span>,
                             <span class="st">&quot;Walking&quot;</span>,
                             <span class="st">&quot;Running&quot;</span>,
                             <span class="st">&quot;Skiing&quot;</span>,
                             <span class="st">&quot;Roller skating&quot;</span>,
                             <span class="st">&quot;Horseback riding&quot;</span>,
                             <span class="st">&quot;Other&quot;</span>,
                             <span class="st">&quot;PA accelerometer&quot;</span>,
                             <span class="st">&quot;PA self-report&quot;</span>
                             )

<span class="co"># Roller skating has only 8 observations; leave out</span>
exerciseTypes_df &lt;-<span class="st"> </span>exerciseTypes_df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span><span class="st">`</span><span class="dt">Roller skating</span><span class="st">`</span>)

<span class="co"># Variable types are muddled, change all to numeric</span>
exerciseTypes_df &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(purrr<span class="op">::</span><span class="kw">map</span>(exerciseTypes_df, <span class="st">`</span><span class="dt">class&lt;-</span><span class="st">`</span>, <span class="kw">c</span>(<span class="st">&quot;numeric&quot;</span>))) 

<span class="co"># Change data frame to type tbl to allow for spaces</span>
exerciseTypes_df &lt;-<span class="st"> </span><span class="kw">as.tbl</span>(exerciseTypes_df)

<span class="co"># Take all names, replace the dots with space</span>
<span class="kw">names</span>(exerciseTypes_df) &lt;-<span class="st"> </span>stringr<span class="op">::</span><span class="kw">str_replace_all</span>(<span class="kw">names</span>(exerciseTypes_df), <span class="dt">pattern =</span> <span class="st">&quot;</span><span class="ch">\\</span><span class="st">.&quot;</span>, <span class="dt">replacement =</span> <span class="st">&quot; &quot;</span>)

<span class="co"># Remove incomplete cases</span>
exerciseTypes_df_fullobs &lt;-<span class="st"> </span>exerciseTypes_df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">na.omit</span>()

<span class="co"># Tell mgm, that the first 14 variables are categorical and the last two are gaussian</span>
exerciseTypes_df_variable_types &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">&quot;c&quot;</span>, <span class="dv">13</span>), <span class="kw">rep</span>(<span class="st">&quot;g&quot;</span>, <span class="dv">2</span>))
exerciseTypes_df_variable_levels &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">&quot;2&quot;</span>, <span class="dv">13</span>), <span class="kw">rep</span>(<span class="st">&quot;1&quot;</span>, <span class="dv">2</span>))
<span class="co"># data.frame(exerciseTypes_df_variable_types, exerciseTypes_df_variable_levels, names(exerciseTypes_df))</span>

mgm_obj_EBIC &lt;-<span class="st"> </span>mgm<span class="op">::</span><span class="kw">mgm</span>(<span class="dt">data =</span> exerciseTypes_df_fullobs,
  <span class="dt">type =</span> exerciseTypes_df_variable_types,
  <span class="dt">level =</span> exerciseTypes_df_variable_levels,
  <span class="dt">lambdaSel =</span> <span class="st">&quot;EBIC&quot;</span>,
  <span class="co"># lambdaFolds = 10,</span>
  <span class="dt">pbar =</span> <span class="ot">FALSE</span>, 
  <span class="dt">binarySign =</span> <span class="ot">TRUE</span>)
## Note that the sign of parameter estimates is stored separately; see ?mgm

pred_obj2 &lt;-<span class="st"> </span><span class="kw">predict</span>(<span class="dt">object =</span> mgm_obj_EBIC,
                         <span class="dt">data =</span> exerciseTypes_df_fullobs)

<span class="co"># pred_obj$errors</span>

<span class="co"># Take R2 from gaussian, CC from categorical variables </span>
pie_errors2 &lt;-<span class="st"> </span><span class="kw">c</span>(pred_obj2<span class="op">$</span>errors[<span class="dv">1</span><span class="op">:</span><span class="dv">13</span>, <span class="dv">4</span>],
                pred_obj2<span class="op">$</span>errors[<span class="dv">14</span><span class="op">:</span><span class="dv">15</span>, <span class="dv">3</span>])

<span class="co"># Define node colors</span>
node_colors &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">rep</span>(viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">3</span>, <span class="dt">begin =</span> <span class="fl">0.4</span>, <span class="dt">end =</span> <span class="fl">0.95</span>)[<span class="dv">1</span>], <span class="dv">13</span>),
                 <span class="kw">rep</span>(viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">3</span>, <span class="dt">begin =</span> <span class="fl">0.4</span>, <span class="dt">end =</span> <span class="fl">0.95</span>)[<span class="dv">3</span>], <span class="dv">2</span>))

exerciseTypes_mgm_withMeasures2 &lt;-<span class="st"> </span>qgraph<span class="op">::</span><span class="kw">qgraph</span>(mgm_obj_EBIC<span class="op">$</span>pairwise<span class="op">$</span>wadj, 
            <span class="dt">layout =</span> <span class="st">&quot;spring&quot;</span>,
            <span class="dt">repulsion =</span> <span class="fl">0.99</span>, <span class="co"># To nudge the network from originally bad visual state</span>
            <span class="dt">title =</span> <span class="st">&quot;Mixed graphical model: Types of reported physical activity and their relations to measured MVPA&quot;</span>,
            <span class="dt">edge.color =</span> <span class="kw">ifelse</span>(mgm_obj_EBIC<span class="op">$</span>pairwise<span class="op">$</span>edgecolor <span class="op">==</span><span class="st"> &quot;darkgreen&quot;</span>, <span class="st">&quot;blue&quot;</span>,
                                mgm_obj_EBIC<span class="op">$</span>pairwise<span class="op">$</span>edgecolor),
            <span class="dt">pie =</span> pie_errors2,
            <span class="dt">pieColor =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">3</span>, <span class="dt">begin =</span> <span class="fl">0.4</span>, <span class="dt">end =</span> <span class="fl">0.95</span>)[<span class="dv">2</span>],
            <span class="dt">color =</span> node_colors,
            <span class="dt">labels =</span> <span class="kw">names</span>(exerciseTypes_df_fullobs),
            <span class="dt">label.cex =</span> <span class="fl">0.75</span>,
            <span class="dt">label.scale =</span> <span class="ot">FALSE</span>,
            <span class="dt">label.color =</span> <span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">&quot;black&quot;</span>, <span class="dv">15</span>)))</code></pre></div>
<p><img src="baseline-networks_files/figure-html/exercisetypes-mgm-EBIC-1.png" width="2100" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># exerciseTypes_mgm_withMeasures_cor &lt;- qgraph::qgraph(cor_auto(exerciseTypes_df), </span>
<span class="co">#             layout = &quot;spring&quot;,</span>
<span class="co">#             repulsion = 0.99, # To nudge the network from originally bad visual state</span>
<span class="co">#             title = &quot;Bivariate correlations&quot;,</span>
<span class="co">#             pie = pie_errors2,</span>
<span class="co">#             pieColor = viridis::viridis(3, begin = 0.4, end = 0.95)[2],</span>
<span class="co">#             color = node_colors,</span>
<span class="co">#             edge.labels = TRUE,</span>
<span class="co">#             labels = names(exerciseTypes_df),</span>
<span class="co">#             label.cex = 0.75,</span>
<span class="co">#             label.scale = FALSE)</span></code></pre></div>
<p>To compare the two previous graphs, we again average the layout and plot them next to each other.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">avglayout &lt;-<span class="st"> </span><span class="kw">averageLayout</span>(exerciseTypes_mgm_withMeasures, exerciseTypes_mgm_withMeasures2)
## Error in averageLayout(exerciseTypes_mgm_withMeasures, exerciseTypes_mgm_withMeasures2): could not find function &quot;averageLayout&quot;

<span class="kw">layout</span>(<span class="kw">t</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>))

qgraph<span class="op">::</span><span class="kw">qgraph</span>(mgm_obj_CV<span class="op">$</span>pairwise<span class="op">$</span>wadj, 
            <span class="dt">layout =</span> avglayout,
            <span class="dt">title =</span> <span class="st">&quot;Mixed graphical model (Cross-validation)&quot;</span>,
            <span class="dt">edge.color =</span> <span class="kw">ifelse</span>(mgm_obj_CV<span class="op">$</span>pairwise<span class="op">$</span>edgecolor <span class="op">==</span><span class="st"> &quot;darkgreen&quot;</span>, <span class="st">&quot;blue&quot;</span>, mgm_obj_CV<span class="op">$</span>pairwise<span class="op">$</span>edgecolor),
            <span class="dt">pie =</span> pie_errors2,
            <span class="dt">pieColor =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">3</span>, <span class="dt">begin =</span> <span class="fl">0.4</span>, <span class="dt">end =</span> <span class="fl">0.95</span>)[<span class="dv">2</span>],
            <span class="dt">color =</span> node_colors,
            <span class="dt">labels =</span> <span class="kw">names</span>(exerciseTypes_df_fullobs),
            <span class="dt">label.cex =</span> <span class="fl">0.75</span>,
            <span class="dt">label.scale =</span> <span class="ot">FALSE</span>,
            <span class="dt">label.color =</span> <span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">&quot;black&quot;</span>, <span class="dv">13</span>)))
## Error in qgraph::qgraph(mgm_obj_CV$pairwise$wadj, layout = avglayout, : object &#39;avglayout&#39; not found

qgraph<span class="op">::</span><span class="kw">qgraph</span>(mgm_obj_EBIC<span class="op">$</span>pairwise<span class="op">$</span>wadj, 
            <span class="dt">layout =</span> avglayout,
            <span class="dt">title =</span> <span class="st">&quot;Mixed graphical model (EBIC model selection)&quot;</span>,
            <span class="dt">edge.color =</span> <span class="kw">ifelse</span>(mgm_obj_EBIC<span class="op">$</span>pairwise<span class="op">$</span>edgecolor <span class="op">==</span><span class="st"> &quot;darkgreen&quot;</span>, <span class="st">&quot;blue&quot;</span>, mgm_obj_EBIC<span class="op">$</span>pairwise<span class="op">$</span>edgecolor),
            <span class="dt">pie =</span> pie_errors2,
            <span class="dt">pieColor =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">3</span>, <span class="dt">begin =</span> <span class="fl">0.4</span>, <span class="dt">end =</span> <span class="fl">0.95</span>)[<span class="dv">2</span>],
            <span class="dt">color =</span> node_colors,
            <span class="dt">labels =</span> <span class="kw">names</span>(exerciseTypes_df_fullobs),
            <span class="dt">label.cex =</span> <span class="fl">0.75</span>,
            <span class="dt">label.scale =</span> <span class="ot">FALSE</span>,
            <span class="dt">label.color =</span> <span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">&quot;black&quot;</span>, <span class="dv">15</span>)))
## Error in qgraph::qgraph(mgm_obj_EBIC$pairwise$wadj, layout = avglayout, : object &#39;avglayout&#39; not found</code></pre></div>
<div id="bivariate-correlations" class="section level2">
<h2>Bivariate correlations</h2>
<p>Table below shows, how correlations between exercise types differ between the accelerometer and self-reported MVPA measure.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
exerciseTypes_df &lt;-<span class="st"> </span>lmi <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(Kys0051.<span class="dv">1</span><span class="op">:</span>Kys0064.<span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="kw">contains</span>(<span class="st">&quot;.1&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate_all</span>(<span class="kw">funs</span>(<span class="kw">replace_na</span>(., <span class="dv">0</span>)))
<span class="co"># exerciseTypes_df$track &lt;- df$track</span>
<span class="co"># exerciseTypes_df$girl &lt;- df$girl</span>
exerciseTypes_df<span class="op">$</span><span class="st">`</span><span class="dt">PA accelerometer</span><span class="st">`</span> &lt;-<span class="st"> </span>df<span class="op">$</span>mvpaAccelerometer_T1
exerciseTypes_df<span class="op">$</span><span class="st">`</span><span class="dt">PA self-report</span><span class="st">`</span> &lt;-<span class="st"> </span>df<span class="op">$</span>padaysLastweek_T1

<span class="kw">names</span>(exerciseTypes_df) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Team ball games&quot;</span>, 
                             <span class="st">&quot;Other ball games&quot;</span>,
                             <span class="st">&quot;Gym training&quot;</span>,
                             <span class="st">&quot;Combat sports&quot;</span>,
                             <span class="st">&quot;Fitness classes&quot;</span>,
                             <span class="st">&quot;Home workout&quot;</span>,
                             <span class="st">&quot;Cycling&quot;</span>,
                             <span class="st">&quot;Swimming&quot;</span>,
                             <span class="st">&quot;Walking&quot;</span>,
                             <span class="st">&quot;Running&quot;</span>,
                             <span class="st">&quot;Skiing&quot;</span>,
                             <span class="st">&quot;Roller skating&quot;</span>,
                             <span class="st">&quot;Horseback riding&quot;</span>,
                             <span class="st">&quot;Other&quot;</span>,
                             <span class="st">&quot;PA accelerometer&quot;</span>,
                             <span class="st">&quot;PA self-report&quot;</span>
                             )

<span class="co"># Roller skating has only 8 observations; leave out</span>
exerciseTypes_df &lt;-<span class="st"> </span>exerciseTypes_df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span><span class="st">`</span><span class="dt">Roller skating</span><span class="st">`</span>)

<span class="co"># Variable types are muddled, change all to numeric</span>
exerciseTypes_df &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(purrr<span class="op">::</span><span class="kw">map</span>(exerciseTypes_df, <span class="st">`</span><span class="dt">class&lt;-</span><span class="st">`</span>, <span class="kw">c</span>(<span class="st">&quot;numeric&quot;</span>))) 

<span class="co"># Change data frame to type tbl to allow for spaces</span>
exerciseTypes_df &lt;-<span class="st"> </span><span class="kw">as.tbl</span>(exerciseTypes_df)

<span class="co"># Take all names, replace the dots with space</span>
<span class="kw">names</span>(exerciseTypes_df) &lt;-<span class="st"> </span>stringr<span class="op">::</span><span class="kw">str_replace_all</span>(<span class="kw">names</span>(exerciseTypes_df), <span class="dt">pattern =</span> <span class="st">&quot;</span><span class="ch">\\</span><span class="st">.&quot;</span>, <span class="dt">replacement =</span> <span class="st">&quot; &quot;</span>)

<span class="kw">cor_auto</span>(exerciseTypes_df) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">data.frame</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">variable =</span> <span class="kw">names</span>(exerciseTypes_df)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate_at</span>(<span class="kw">vars</span>(PA.accelerometer, PA.self.report), <span class="kw">funs</span>(<span class="kw">round</span>(., <span class="dv">3</span>))) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(variable, PA.accelerometer, PA.self.report) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">diff =</span> PA.accelerometer <span class="op">-</span><span class="st"> </span>PA.self.report) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">arrange</span>(<span class="kw">desc</span>(<span class="kw">abs</span>(diff))) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(variable <span class="op">!=</span><span class="st"> &quot;PA accelerometer&quot;</span>, variable <span class="op">!=</span><span class="st"> &quot;PA self report&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>DT<span class="op">::</span><span class="kw">datatable</span>(<span class="dt">caption =</span> <span class="st">&quot;Bivariate correlations between PA measures and self-reported activity types&quot;</span>)
## Error in cor_auto(exerciseTypes_df): could not find function &quot;cor_auto&quot;</code></pre></div>
</div>
</div>
<div id="chunked-bcts-pa-motivation" class="section level1">
<h1>Chunked BCTs, PA, motivation</h1>
<p>This section shows the correlations structure between BCTs (lumped into chunks based on whether they relate to frequency or agreement), motivational regulations and MVPA (self-reported MVPA the previous week and accelerometer-measured MVPA the following week).</p>
<p>Note: This is only to demonstrate data exploration, as many assumptions (such as multivariate normality, homogeneity, multilevel structure) are not accounted for.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
bivariate_BCTs &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(
  <span class="st">&#39;goal setting&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_01_T1,
  <span class="st">&#39;implementation plan&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_02_T1,
  <span class="st">&#39;plan by other&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_03_T1,
  <span class="st">&#39;reminder of plan&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_04_T1,
  <span class="st">&#39;subgoals&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_05_T1,
  <span class="st">&#39;new PA options&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_06_T1,
  <span class="st">&#39;barrier identification&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_07_T1,
  <span class="st">&#39;coping planning&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_08_T1,
  <span class="st">&#39;PA identity&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_09_T1,
  <span class="st">&#39;PA life values&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_10_T1,
  <span class="st">&#39;positive consequences&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_01_T1,
  <span class="st">&#39;log on paper&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_02_T1,
  <span class="st">&#39;smartphone&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_03_T1,
  <span class="st">&#39;mnemonic cues&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_04_T1,
  <span class="st">&#39;goal contrast&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_05_T1,
  <span class="st">&#39;relevance of PA&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_06_T1,
  <span class="st">&#39;changes at home&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_07_T1,
  <span class="st">&#39;social support&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_08_T1,
  <span class="st">&#39;failure contemplated&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_09_T1,
  <span class="st">&#39;PA accelerometer&#39;</span> =<span class="st"> </span>mvpaAccelerometer_T1,
  <span class="st">&#39;PA self-report&#39;</span> =<span class="st"> </span>padaysLastweek_T1,
  <span class="st">&#39;autonomous&#39;</span> =<span class="st"> </span>PA_autonomous_T1,
  <span class="st">&#39;controlled&#39;</span> =<span class="st"> </span>PA_controlled_T1) <span class="op">%&gt;%</span>
<span class="st"> </span><span class="kw">rowwise</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="st">`</span><span class="dt">PA accelerometer</span><span class="st">`</span>, <span class="st">`</span><span class="dt">PA self-report</span><span class="st">`</span>, autonomous, controlled, <span class="kw">everything</span>()) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate_all</span>(as.numeric)

<span class="co"># Create a covariance matrix of the data</span>
covMatrix &lt;-<span class="st"> </span>bivariate_BCTs <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">cov</span>(<span class="dt">use =</span> <span class="st">&quot;pairwise.complete.obs&quot;</span>)

<span class="co"># Transform the matrix so, that lower diagonal of the matrix shows partial correlations,</span>
<span class="co"># while the upper one shows bivariate correlations.</span>
matrix_corLower_parcorUpper &lt;-<span class="st"> </span>covMatrix <span class="op">%&gt;%</span><span class="st"> </span>ggm<span class="op">::</span><span class="kw">correlations</span>()

<span class="co"># Show the matrix</span>
matrix_corLower_parcorUpper <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>papaja<span class="op">::</span><span class="kw">apa_table</span>(<span class="dt">caption =</span> <span class="st">&quot;Correlation matrix of key variables of interest. Lower diagonal shows bivariate correlations, upper diagonal shows partial correlations&quot;</span>)</code></pre></div>
<caption>
(#tab:bivariate-correlations)
</caption>
<caption>
<em>Correlation matrix of key variables of interest. Lower diagonal shows bivariate correlations, upper diagonal shows partial correlations</em>
</caption>
<table>
<thead>
<tr class="header">
<th></th>
<th align="left">PA accelerometer</th>
<th align="left">PA self-report</th>
<th align="left">autonomous</th>
<th align="left">controlled</th>
<th align="left">goal setting</th>
<th align="left">implementation plan</th>
<th align="left">plan by other</th>
<th align="left">reminder of plan</th>
<th align="left">subgoals</th>
<th align="left">new PA options</th>
<th align="left">barrier identification</th>
<th align="left">coping planning</th>
<th align="left">PA identity</th>
<th align="left">PA life values</th>
<th align="left">positive consequences</th>
<th align="left">log on paper</th>
<th align="left">smartphone</th>
<th align="left">mnemonic cues</th>
<th align="left">goal contrast</th>
<th align="left">relevance of PA</th>
<th align="left">changes at home</th>
<th align="left">social support</th>
<th align="left">failure contemplated</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>PA accelerometer</td>
<td align="left">1.00</td>
<td align="left">0.15</td>
<td align="left">0.10</td>
<td align="left">-0.01</td>
<td align="left">0.03</td>
<td align="left">-0.07</td>
<td align="left">0.07</td>
<td align="left">-0.04</td>
<td align="left">0.04</td>
<td align="left">0.03</td>
<td align="left">-0.02</td>
<td align="left">-0.06</td>
<td align="left">0.01</td>
<td align="left">0.00</td>
<td align="left">0.01</td>
<td align="left">0.01</td>
<td align="left">-0.03</td>
<td align="left">-0.01</td>
<td align="left">0.03</td>
<td align="left">0.00</td>
<td align="left">0.02</td>
<td align="left">0.03</td>
<td align="left">0.01</td>
</tr>
<tr class="even">
<td>PA self-report</td>
<td align="left">0.26</td>
<td align="left">1.00</td>
<td align="left">0.20</td>
<td align="left">-0.03</td>
<td align="left">0.03</td>
<td align="left">0.02</td>
<td align="left">0.14</td>
<td align="left">-0.05</td>
<td align="left">0.06</td>
<td align="left">0.11</td>
<td align="left">-0.03</td>
<td align="left">-0.03</td>
<td align="left">-0.04</td>
<td align="left">0.01</td>
<td align="left">0.01</td>
<td align="left">0.08</td>
<td align="left">0.00</td>
<td align="left">0.01</td>
<td align="left">0.05</td>
<td align="left">0.01</td>
<td align="left">-0.02</td>
<td align="left">0.01</td>
<td align="left">-0.01</td>
</tr>
<tr class="odd">
<td>autonomous</td>
<td align="left">0.22</td>
<td align="left">0.45</td>
<td align="left">1.00</td>
<td align="left">0.03</td>
<td align="left">0.14</td>
<td align="left">0.07</td>
<td align="left">0.11</td>
<td align="left">-0.03</td>
<td align="left">-0.01</td>
<td align="left">0.10</td>
<td align="left">-0.01</td>
<td align="left">0.00</td>
<td align="left">0.01</td>
<td align="left">0.13</td>
<td align="left">0.12</td>
<td align="left">0.01</td>
<td align="left">0.00</td>
<td align="left">-0.03</td>
<td align="left">0.01</td>
<td align="left">0.14</td>
<td align="left">-0.04</td>
<td align="left">-0.05</td>
<td align="left">0.02</td>
</tr>
<tr class="even">
<td>controlled</td>
<td align="left">0.01</td>
<td align="left">0.05</td>
<td align="left">0.13</td>
<td align="left">1.00</td>
<td align="left">-0.02</td>
<td align="left">0.04</td>
<td align="left">-0.01</td>
<td align="left">0.05</td>
<td align="left">0.00</td>
<td align="left">-0.02</td>
<td align="left">0.07</td>
<td align="left">-0.01</td>
<td align="left">0.08</td>
<td align="left">-0.10</td>
<td align="left">0.04</td>
<td align="left">-0.01</td>
<td align="left">-0.01</td>
<td align="left">0.01</td>
<td align="left">-0.05</td>
<td align="left">-0.01</td>
<td align="left">0.01</td>
<td align="left">0.10</td>
<td align="left">0.12</td>
</tr>
<tr class="odd">
<td>goal setting</td>
<td align="left">0.13</td>
<td align="left">0.35</td>
<td align="left">0.56</td>
<td align="left">0.14</td>
<td align="left">1.00</td>
<td align="left">0.49</td>
<td align="left">-0.01</td>
<td align="left">0.00</td>
<td align="left">0.05</td>
<td align="left">0.00</td>
<td align="left">-0.02</td>
<td align="left">0.09</td>
<td align="left">0.03</td>
<td align="left">0.05</td>
<td align="left">0.14</td>
<td align="left">-0.05</td>
<td align="left">-0.01</td>
<td align="left">-0.02</td>
<td align="left">0.05</td>
<td align="left">-0.02</td>
<td align="left">-0.03</td>
<td align="left">0.07</td>
<td align="left">0.03</td>
</tr>
<tr class="even">
<td>implementation plan</td>
<td align="left">0.10</td>
<td align="left">0.36</td>
<td align="left">0.53</td>
<td align="left">0.16</td>
<td align="left">0.74</td>
<td align="left">1.00</td>
<td align="left">0.12</td>
<td align="left">0.15</td>
<td align="left">0.11</td>
<td align="left">0.05</td>
<td align="left">0.01</td>
<td align="left">0.02</td>
<td align="left">-0.02</td>
<td align="left">0.07</td>
<td align="left">-0.03</td>
<td align="left">0.03</td>
<td align="left">-0.04</td>
<td align="left">-0.02</td>
<td align="left">0.07</td>
<td align="left">0.00</td>
<td align="left">0.01</td>
<td align="left">0.00</td>
<td align="left">-0.03</td>
</tr>
<tr class="odd">
<td>plan by other</td>
<td align="left">0.17</td>
<td align="left">0.37</td>
<td align="left">0.41</td>
<td align="left">0.11</td>
<td align="left">0.40</td>
<td align="left">0.48</td>
<td align="left">1.00</td>
<td align="left">0.18</td>
<td align="left">0.11</td>
<td align="left">-0.03</td>
<td align="left">-0.04</td>
<td align="left">0.00</td>
<td align="left">0.02</td>
<td align="left">0.02</td>
<td align="left">-0.07</td>
<td align="left">0.05</td>
<td align="left">-0.01</td>
<td align="left">0.01</td>
<td align="left">-0.01</td>
<td align="left">0.01</td>
<td align="left">0.03</td>
<td align="left">0.01</td>
<td align="left">0.04</td>
</tr>
<tr class="even">
<td>reminder of plan</td>
<td align="left">0.08</td>
<td align="left">0.29</td>
<td align="left">0.38</td>
<td align="left">0.17</td>
<td align="left">0.47</td>
<td align="left">0.57</td>
<td align="left">0.50</td>
<td align="left">1.00</td>
<td align="left">0.25</td>
<td align="left">0.05</td>
<td align="left">0.08</td>
<td align="left">0.01</td>
<td align="left">0.06</td>
<td align="left">0.02</td>
<td align="left">-0.02</td>
<td align="left">0.21</td>
<td align="left">0.08</td>
<td align="left">0.08</td>
<td align="left">0.09</td>
<td align="left">-0.04</td>
<td align="left">-0.03</td>
<td align="left">-0.03</td>
<td align="left">-0.05</td>
</tr>
<tr class="odd">
<td>subgoals</td>
<td align="left">0.13</td>
<td align="left">0.36</td>
<td align="left">0.45</td>
<td align="left">0.15</td>
<td align="left">0.54</td>
<td align="left">0.60</td>
<td align="left">0.48</td>
<td align="left">0.64</td>
<td align="left">1.00</td>
<td align="left">0.13</td>
<td align="left">0.02</td>
<td align="left">0.13</td>
<td align="left">0.03</td>
<td align="left">0.05</td>
<td align="left">-0.03</td>
<td align="left">0.05</td>
<td align="left">-0.02</td>
<td align="left">0.06</td>
<td align="left">0.01</td>
<td align="left">-0.03</td>
<td align="left">-0.01</td>
<td align="left">-0.01</td>
<td align="left">0.09</td>
</tr>
<tr class="even">
<td>new PA options</td>
<td align="left">0.14</td>
<td align="left">0.37</td>
<td align="left">0.47</td>
<td align="left">0.11</td>
<td align="left">0.47</td>
<td align="left">0.51</td>
<td align="left">0.35</td>
<td align="left">0.47</td>
<td align="left">0.54</td>
<td align="left">1.00</td>
<td align="left">0.11</td>
<td align="left">0.05</td>
<td align="left">0.05</td>
<td align="left">0.12</td>
<td align="left">-0.07</td>
<td align="left">-0.05</td>
<td align="left">0.07</td>
<td align="left">-0.04</td>
<td align="left">0.11</td>
<td align="left">0.04</td>
<td align="left">0.09</td>
<td align="left">0.02</td>
<td align="left">-0.10</td>
</tr>
<tr class="odd">
<td>barrier identification</td>
<td align="left">0.05</td>
<td align="left">0.23</td>
<td align="left">0.40</td>
<td align="left">0.21</td>
<td align="left">0.46</td>
<td align="left">0.48</td>
<td align="left">0.32</td>
<td align="left">0.49</td>
<td align="left">0.52</td>
<td align="left">0.50</td>
<td align="left">1.00</td>
<td align="left">0.46</td>
<td align="left">0.08</td>
<td align="left">0.05</td>
<td align="left">0.07</td>
<td align="left">-0.02</td>
<td align="left">-0.03</td>
<td align="left">0.11</td>
<td align="left">-0.06</td>
<td align="left">0.01</td>
<td align="left">0.02</td>
<td align="left">0.01</td>
<td align="left">0.06</td>
</tr>
<tr class="even">
<td>coping planning</td>
<td align="left">0.06</td>
<td align="left">0.27</td>
<td align="left">0.45</td>
<td align="left">0.17</td>
<td align="left">0.55</td>
<td align="left">0.55</td>
<td align="left">0.37</td>
<td align="left">0.51</td>
<td align="left">0.59</td>
<td align="left">0.53</td>
<td align="left">0.73</td>
<td align="left">1.00</td>
<td align="left">0.12</td>
<td align="left">0.15</td>
<td align="left">-0.06</td>
<td align="left">0.01</td>
<td align="left">0.07</td>
<td align="left">-0.04</td>
<td align="left">0.07</td>
<td align="left">0.02</td>
<td align="left">-0.06</td>
<td align="left">0.01</td>
<td align="left">0.09</td>
</tr>
<tr class="odd">
<td>PA identity</td>
<td align="left">0.11</td>
<td align="left">0.28</td>
<td align="left">0.49</td>
<td align="left">0.20</td>
<td align="left">0.52</td>
<td align="left">0.51</td>
<td align="left">0.36</td>
<td align="left">0.47</td>
<td align="left">0.51</td>
<td align="left">0.51</td>
<td align="left">0.57</td>
<td align="left">0.62</td>
<td align="left">1.00</td>
<td align="left">0.36</td>
<td align="left">0.10</td>
<td align="left">0.00</td>
<td align="left">-0.05</td>
<td align="left">-0.02</td>
<td align="left">0.03</td>
<td align="left">0.12</td>
<td align="left">-0.03</td>
<td align="left">0.02</td>
<td align="left">0.03</td>
</tr>
<tr class="even">
<td>PA life values</td>
<td align="left">0.12</td>
<td align="left">0.32</td>
<td align="left">0.55</td>
<td align="left">0.11</td>
<td align="left">0.56</td>
<td align="left">0.56</td>
<td align="left">0.38</td>
<td align="left">0.46</td>
<td align="left">0.54</td>
<td align="left">0.55</td>
<td align="left">0.57</td>
<td align="left">0.64</td>
<td align="left">0.71</td>
<td align="left">1.00</td>
<td align="left">0.03</td>
<td align="left">-0.09</td>
<td align="left">-0.01</td>
<td align="left">0.02</td>
<td align="left">-0.03</td>
<td align="left">0.13</td>
<td align="left">0.04</td>
<td align="left">-0.02</td>
<td align="left">0.01</td>
</tr>
<tr class="odd">
<td>positive consequences</td>
<td align="left">0.12</td>
<td align="left">0.27</td>
<td align="left">0.47</td>
<td align="left">0.18</td>
<td align="left">0.47</td>
<td align="left">0.40</td>
<td align="left">0.23</td>
<td align="left">0.31</td>
<td align="left">0.35</td>
<td align="left">0.34</td>
<td align="left">0.41</td>
<td align="left">0.41</td>
<td align="left">0.50</td>
<td align="left">0.48</td>
<td align="left">1.00</td>
<td align="left">0.00</td>
<td align="left">0.07</td>
<td align="left">-0.03</td>
<td align="left">0.05</td>
<td align="left">0.31</td>
<td align="left">0.00</td>
<td align="left">0.09</td>
<td align="left">0.07</td>
</tr>
<tr class="even">
<td>log on paper</td>
<td align="left">0.11</td>
<td align="left">0.31</td>
<td align="left">0.30</td>
<td align="left">0.14</td>
<td align="left">0.31</td>
<td align="left">0.39</td>
<td align="left">0.38</td>
<td align="left">0.56</td>
<td align="left">0.46</td>
<td align="left">0.34</td>
<td align="left">0.35</td>
<td align="left">0.36</td>
<td align="left">0.31</td>
<td align="left">0.28</td>
<td align="left">0.29</td>
<td align="left">1.00</td>
<td align="left">0.19</td>
<td align="left">0.27</td>
<td align="left">0.12</td>
<td align="left">0.00</td>
<td align="left">0.12</td>
<td align="left">0.08</td>
<td align="left">-0.01</td>
</tr>
<tr class="odd">
<td>smartphone</td>
<td align="left">0.05</td>
<td align="left">0.20</td>
<td align="left">0.22</td>
<td align="left">0.09</td>
<td align="left">0.23</td>
<td align="left">0.26</td>
<td align="left">0.24</td>
<td align="left">0.41</td>
<td align="left">0.32</td>
<td align="left">0.30</td>
<td align="left">0.28</td>
<td align="left">0.31</td>
<td align="left">0.23</td>
<td align="left">0.23</td>
<td align="left">0.25</td>
<td align="left">0.51</td>
<td align="left">1.00</td>
<td align="left">0.19</td>
<td align="left">0.07</td>
<td align="left">-0.03</td>
<td align="left">0.08</td>
<td align="left">-0.02</td>
<td align="left">0.01</td>
</tr>
<tr class="even">
<td>mnemonic cues</td>
<td align="left">0.09</td>
<td align="left">0.26</td>
<td align="left">0.28</td>
<td align="left">0.14</td>
<td align="left">0.31</td>
<td align="left">0.37</td>
<td align="left">0.34</td>
<td align="left">0.52</td>
<td align="left">0.46</td>
<td align="left">0.36</td>
<td align="left">0.41</td>
<td align="left">0.38</td>
<td align="left">0.34</td>
<td align="left">0.33</td>
<td align="left">0.30</td>
<td align="left">0.63</td>
<td align="left">0.52</td>
<td align="left">1.00</td>
<td align="left">0.20</td>
<td align="left">-0.02</td>
<td align="left">0.23</td>
<td align="left">0.03</td>
<td align="left">0.01</td>
</tr>
<tr class="odd">
<td>goal contrast</td>
<td align="left">0.15</td>
<td align="left">0.36</td>
<td align="left">0.45</td>
<td align="left">0.14</td>
<td align="left">0.50</td>
<td align="left">0.53</td>
<td align="left">0.39</td>
<td align="left">0.55</td>
<td align="left">0.53</td>
<td align="left">0.50</td>
<td align="left">0.45</td>
<td align="left">0.51</td>
<td align="left">0.49</td>
<td align="left">0.48</td>
<td align="left">0.46</td>
<td align="left">0.55</td>
<td align="left">0.43</td>
<td align="left">0.58</td>
<td align="left">1.00</td>
<td align="left">0.19</td>
<td align="left">0.03</td>
<td align="left">0.07</td>
<td align="left">0.08</td>
</tr>
<tr class="even">
<td>relevance of PA</td>
<td align="left">0.14</td>
<td align="left">0.33</td>
<td align="left">0.54</td>
<td align="left">0.17</td>
<td align="left">0.49</td>
<td align="left">0.47</td>
<td align="left">0.33</td>
<td align="left">0.40</td>
<td align="left">0.44</td>
<td align="left">0.47</td>
<td align="left">0.48</td>
<td align="left">0.51</td>
<td align="left">0.58</td>
<td align="left">0.59</td>
<td align="left">0.62</td>
<td align="left">0.36</td>
<td align="left">0.28</td>
<td align="left">0.38</td>
<td align="left">0.58</td>
<td align="left">1.00</td>
<td align="left">0.11</td>
<td align="left">0.09</td>
<td align="left">0.09</td>
</tr>
<tr class="odd">
<td>changes at home</td>
<td align="left">0.11</td>
<td align="left">0.24</td>
<td align="left">0.28</td>
<td align="left">0.16</td>
<td align="left">0.31</td>
<td align="left">0.34</td>
<td align="left">0.30</td>
<td align="left">0.39</td>
<td align="left">0.38</td>
<td align="left">0.38</td>
<td align="left">0.36</td>
<td align="left">0.34</td>
<td align="left">0.34</td>
<td align="left">0.35</td>
<td align="left">0.34</td>
<td align="left">0.51</td>
<td align="left">0.41</td>
<td align="left">0.57</td>
<td align="left">0.50</td>
<td align="left">0.45</td>
<td align="left">1.00</td>
<td align="left">0.30</td>
<td align="left">0.07</td>
</tr>
<tr class="even">
<td>social support</td>
<td align="left">0.12</td>
<td align="left">0.24</td>
<td align="left">0.31</td>
<td align="left">0.22</td>
<td align="left">0.38</td>
<td align="left">0.37</td>
<td align="left">0.29</td>
<td align="left">0.35</td>
<td align="left">0.37</td>
<td align="left">0.35</td>
<td align="left">0.37</td>
<td align="left">0.37</td>
<td align="left">0.38</td>
<td align="left">0.36</td>
<td align="left">0.41</td>
<td align="left">0.42</td>
<td align="left">0.30</td>
<td align="left">0.43</td>
<td align="left">0.48</td>
<td align="left">0.48</td>
<td align="left">0.56</td>
<td align="left">1.00</td>
<td align="left">0.09</td>
</tr>
<tr class="odd">
<td>failure contemplated</td>
<td align="left">0.09</td>
<td align="left">0.20</td>
<td align="left">0.32</td>
<td align="left">0.23</td>
<td align="left">0.36</td>
<td align="left">0.34</td>
<td align="left">0.27</td>
<td align="left">0.31</td>
<td align="left">0.38</td>
<td align="left">0.27</td>
<td align="left">0.40</td>
<td align="left">0.43</td>
<td align="left">0.40</td>
<td align="left">0.38</td>
<td align="left">0.39</td>
<td align="left">0.29</td>
<td align="left">0.23</td>
<td align="left">0.32</td>
<td align="left">0.41</td>
<td align="left">0.44</td>
<td align="left">0.35</td>
<td align="left">0.38</td>
<td align="left">1.00</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># Plot the matrix as a correlogram</span>
matrix_corLower_parcorUpper <span class="op">%&gt;%</span><span class="st"> </span>corrgram<span class="op">::</span><span class="kw">corrgram</span>(
  <span class="dt">type =</span> <span class="st">&quot;cor&quot;</span>,
  <span class="dt">lower.panel =</span> corrgram<span class="op">::</span>panel.pie,
  <span class="dt">upper.panel =</span> corrgram<span class="op">::</span>panel.pie,
  <span class="dt">main =</span> <span class="st">&quot;Bivariate (upper diagonal) and partial (lower diagonal)</span><span class="ch">\n</span><span class="st">correlations of key PA variables&quot;</span>)</code></pre></div>
<p><img src="baseline-networks_files/figure-html/bivariate-correlations-1.png" width="2100" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
corMatrix_BCTs &lt;-<span class="st"> </span>bivariate_BCTs <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">cor</span>(<span class="dt">use =</span> <span class="st">&quot;pairwise.complete.obs&quot;</span>, <span class="dt">method =</span> <span class="st">&quot;spearman&quot;</span>)

<span class="kw">as.data.frame</span>(<span class="kw">as.table</span>(corMatrix_BCTs)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(Var1 <span class="op">==</span><span class="st"> &quot;PA accelerometer&quot;</span> <span class="op">|</span><span class="st"> </span>Var1 <span class="op">==</span><span class="st"> &quot;PA self report&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="st">&quot;Spearman correlation&quot;</span> =<span class="st"> </span>Freq <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">round</span>(., <span class="dv">3</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">format</span>(., <span class="dt">nsmall =</span> <span class="dv">3</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>Freq) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="st">`</span><span class="dt">Spearman correlation</span><span class="st">`</span> <span class="op">!=</span><span class="st"> </span><span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">arrange</span>(<span class="kw">desc</span>(<span class="st">`</span><span class="dt">Spearman correlation</span><span class="st">`</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>DT<span class="op">::</span><span class="kw">datatable</span>(<span class="dt">caption =</span> <span class="st">&quot;Bivariate correlations between BCTs, motivation and PA. Sorted by strength.&quot;</span>)</code></pre></div>
<div id="htmlwidget-22122979b8a9c74ce1d3" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-22122979b8a9c74ce1d3">{"x":{"filter":"none","caption":"<caption>Bivariate correlations between BCTs, motivation and PA. Sorted by strength.<\/caption>","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23"],["PA accelerometer","PA accelerometer","PA accelerometer","PA accelerometer","PA accelerometer","PA accelerometer","PA accelerometer","PA accelerometer","PA accelerometer","PA accelerometer","PA accelerometer","PA accelerometer","PA accelerometer","PA accelerometer","PA accelerometer","PA accelerometer","PA accelerometer","PA accelerometer","PA accelerometer","PA accelerometer","PA accelerometer","PA accelerometer","PA accelerometer"],["PA accelerometer","PA self-report","autonomous","plan by other","new PA options","goal setting","goal contrast","relevance of PA","social support","subgoals","PA life values","positive consequences","PA identity","failure contemplated","implementation plan","log on paper","changes at home","mnemonic cues","reminder of plan","smartphone","barrier identification","coping planning","controlled"],[" 1.000"," 0.254"," 0.232"," 0.156"," 0.148"," 0.143"," 0.141"," 0.137"," 0.132"," 0.124"," 0.120"," 0.116"," 0.108"," 0.099"," 0.097"," 0.096"," 0.096"," 0.082"," 0.078"," 0.053"," 0.052"," 0.045","-0.003"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Var1<\/th>\n      <th>Var2<\/th>\n      <th>Spearman correlation<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-center","targets":"_all"},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<p>Highest bivariate (Spearman) correlations with self-reported PA:</p>
<ol style="list-style-type: decimal">
<li>I have tried out new ways for me to be physically active.</li>
<li>I have personally made a specific plan (“what, where, how”) to implement my PA.</li>
<li>I have a PA plan, which has been made by someone else, e.g. my sports club (e.g. a workout schedule).</li>
<li>I have set PA goals for myself.</li>
<li>I have broken down larger PA goals to smaller subgoals.</li>
<li>I have compared my actualized PA with the PA goal I have set.</li>
<li>I have attempted to find ways to exercise so, that it won’t obstruct but instead helps actualise my other life values.</li>
<li>I have thought about which reasons to do PA are important to me personally.</li>
<li>I have monitored my PA by marking the PA occasions on an exercise log on paper.</li>
<li>I have a way by which I remind myself of my PA plan, e.g. I write it down in the calendar.</li>
</ol>
<div id="prepare-data-and-show-correlation-structure" class="section level2">
<h2>Prepare data and show correlation structure</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">bctdf_chunks &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(
  <span class="st">&#39;agr-BCTs&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_T1,
  <span class="st">&#39;frq-BCTs&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_T1,
  <span class="st">&#39;Accelerometer&#39;</span> =<span class="st"> </span>mvpaAccelerometer_T1,
  <span class="st">&#39;Self-report&#39;</span> =<span class="st"> </span>padaysLastweek_T1,
  <span class="st">&#39;intrinsic&#39;</span> =<span class="st"> </span>PA_intrinsic_T1,
  <span class="st">&#39;identified&#39;</span> =<span class="st"> </span>PA_identified_T1,
  <span class="st">&#39;introjected&#39;</span> =<span class="st"> </span>PA_introjected_T1,
  <span class="st">&#39;extrinsic&#39;</span> =<span class="st"> </span>PA_extrinsic_T1) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">rowwise</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate_all</span>(as.numeric)

labs &lt;-<span class="st"> </span><span class="kw">names</span>(bctdf_chunks)

bctdf_chunks <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>corrgram<span class="op">::</span><span class="kw">corrgram</span>( 
         <span class="dt">cor.method =</span> <span class="st">&quot;pearson&quot;</span>, 
         <span class="co"># diag.panel=panel.minmax, </span>
         <span class="co"># lower.panel=panel.shade, </span>
         <span class="co"># lower.panel=panel.ellipse,</span>
         <span class="co"># lower.panel=panel.cor,</span>
         <span class="dt">upper.panel=</span>corrgram<span class="op">::</span>panel.conf,
         <span class="dt">lower.panel=</span>corrgram<span class="op">::</span>panel.pie,
         <span class="dt">outer.labels=</span><span class="kw">list</span>(
           <span class="dt">bottom=</span><span class="kw">list</span>(<span class="dt">labels=</span>labs,<span class="dt">cex=</span>.<span class="dv">75</span>, <span class="dt">srt=</span><span class="dv">60</span>),
           <span class="dt">left=</span><span class="kw">list</span>(<span class="dt">labels=</span>labs,<span class="dt">cex=</span>.<span class="dv">75</span>, <span class="dt">srt=</span><span class="dv">30</span>))
         )</code></pre></div>
<p><img src="baseline-networks_files/figure-html/chunked-dataprep-corr-1.png" width="2100" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># Create a covariance matrix of the data</span>
covMatrix &lt;-<span class="st"> </span>bctdf_chunks <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">cov</span>(<span class="dt">use =</span> <span class="st">&quot;pairwise.complete.obs&quot;</span>)

<span class="co"># Transform the matrix so, that lower diagonal of the matrix shows partial correlations,</span>
<span class="co"># while the upper one shows bivariate correlations.</span>
matrix_corLower_parcorUpper &lt;-<span class="st"> </span>covMatrix <span class="op">%&gt;%</span><span class="st"> </span>ggm<span class="op">::</span><span class="kw">correlations</span>()

<span class="co"># Show the matrix</span>
matrix_corLower_parcorUpper <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>papaja<span class="op">::</span><span class="kw">apa_table</span>(<span class="dt">caption =</span> <span class="st">&quot;Correlation matrix of key variables of interest. Lower diagonal shows bivariate correlations, upper diagonal shows partial correlations&quot;</span>)</code></pre></div>
<caption>
(#tab:chunked-dataprep-corr)
</caption>
<caption>
<em>Correlation matrix of key variables of interest. Lower diagonal shows bivariate correlations, upper diagonal shows partial correlations</em>
</caption>
<table>
<thead>
<tr class="header">
<th></th>
<th align="left">agr-BCTs</th>
<th align="left">frq-BCTs</th>
<th align="left">Accelerometer</th>
<th align="left">Self-report</th>
<th align="left">intrinsic</th>
<th align="left">identified</th>
<th align="left">introjected</th>
<th align="left">extrinsic</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>agr-BCTs</td>
<td align="left">1.00</td>
<td align="left">0.59</td>
<td align="left">-0.03</td>
<td align="left">0.13</td>
<td align="left">0.19</td>
<td align="left">0.12</td>
<td align="left">0.07</td>
<td align="left">0.01</td>
</tr>
<tr class="even">
<td>frq-BCTs</td>
<td align="left">0.73</td>
<td align="left">1.00</td>
<td align="left">0.05</td>
<td align="left">0.10</td>
<td align="left">-0.02</td>
<td align="left">0.07</td>
<td align="left">0.05</td>
<td align="left">0.08</td>
</tr>
<tr class="odd">
<td>Accelerometer</td>
<td align="left">0.15</td>
<td align="left">0.16</td>
<td align="left">1.00</td>
<td align="left">0.18</td>
<td align="left">0.09</td>
<td align="left">-0.02</td>
<td align="left">0.01</td>
<td align="left">-0.03</td>
</tr>
<tr class="even">
<td>Self-report</td>
<td align="left">0.43</td>
<td align="left">0.38</td>
<td align="left">0.26</td>
<td align="left">1.00</td>
<td align="left">0.14</td>
<td align="left">0.05</td>
<td align="left">-0.04</td>
<td align="left">-0.01</td>
</tr>
<tr class="odd">
<td>intrinsic</td>
<td align="left">0.56</td>
<td align="left">0.44</td>
<td align="left">0.21</td>
<td align="left">0.42</td>
<td align="left">1.00</td>
<td align="left">0.58</td>
<td align="left">0.02</td>
<td align="left">-0.13</td>
</tr>
<tr class="even">
<td>identified</td>
<td align="left">0.55</td>
<td align="left">0.46</td>
<td align="left">0.16</td>
<td align="left">0.38</td>
<td align="left">0.74</td>
<td align="left">1.00</td>
<td align="left">0.18</td>
<td align="left">-0.07</td>
</tr>
<tr class="odd">
<td>introjected</td>
<td align="left">0.30</td>
<td align="left">0.28</td>
<td align="left">0.06</td>
<td align="left">0.12</td>
<td align="left">0.24</td>
<td align="left">0.32</td>
<td align="left">1.00</td>
<td align="left">0.36</td>
</tr>
<tr class="even">
<td>extrinsic</td>
<td align="left">0.03</td>
<td align="left">0.09</td>
<td align="left">-0.04</td>
<td align="left">-0.05</td>
<td align="left">-0.13</td>
<td align="left">-0.08</td>
<td align="left">0.33</td>
<td align="left">1.00</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># Plot the matrix as a correlogram</span>
matrix_corLower_parcorUpper <span class="op">%&gt;%</span><span class="st"> </span>corrgram<span class="op">::</span><span class="kw">corrgram</span>(
  <span class="dt">type =</span> <span class="st">&quot;cor&quot;</span>,
  <span class="dt">lower.panel =</span> corrgram<span class="op">::</span>panel.pie,
  <span class="dt">upper.panel =</span> corrgram<span class="op">::</span>panel.pie,
  <span class="dt">main =</span> <span class="st">&quot;Bivariate (upper diagonal) and partial (lower diagonal)</span><span class="ch">\n</span><span class="st">correlations of key PA variables&quot;</span>)</code></pre></div>
<p><img src="baseline-networks_files/figure-html/chunked-dataprep-corr-2.png" width="2100" /></p>
</div>
<div id="estimate-and-plot-networks" class="section level2">
<h2>Estimate and plot networks</h2>
<p><img src="baseline-networks_files/figure-html/chunked-networks-1.png" width="2100" /><img src="baseline-networks_files/figure-html/chunked-networks-2.png" width="2100" /><img src="baseline-networks_files/figure-html/chunked-networks-3.png" width="2100" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># Average the layout according to three previous plots, and plot each according to the layout</span>
avlayout &lt;-<span class="st"> </span>qgraph<span class="op">::</span><span class="kw">averageLayout</span>(bootnetgraph, corgraph, pcorgraph)

corgraph &lt;-<span class="st"> </span>qgraph<span class="op">::</span><span class="kw">qgraph</span>(qgraph<span class="op">::</span><span class="kw">cor_auto</span>(bctdf_chunks), <span class="dt">graph =</span> <span class="st">&quot;cor&quot;</span>,
       <span class="dt">labels =</span> <span class="kw">names</span>(bctdf_chunks),
       <span class="dt">edge.labels =</span> <span class="ot">TRUE</span>, 
       <span class="dt">layout =</span> avlayout, 
       <span class="dt">title =</span> <span class="st">&quot;bivariate correlation network&quot;</span>,
       <span class="dt">theme =</span> <span class="st">&quot;colorblind&quot;</span>,
       <span class="dt">maximum =</span> <span class="kw">max</span>(<span class="kw">c</span>(bootnetgraph<span class="op">$</span>graph<span class="op">$</span>Graph<span class="op">$</span>maximum,
                     pcorgraph<span class="op">$</span>graph<span class="op">$</span>Graph<span class="op">$</span>maximum, 
                     corgraph<span class="op">$</span>graph<span class="op">$</span>Graph<span class="op">$</span>maximum)))</code></pre></div>
<p><img src="baseline-networks_files/figure-html/chunked-networks2-1.png" width="2100" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># To help with visual comparison, that last argument takes the maximum edge of the three </span>
<span class="co"># graphs and places that as the benchmark for the thickest line in all plots.</span>

pcorgraph &lt;-<span class="st"> </span>qgraph<span class="op">::</span><span class="kw">qgraph</span>(qgraph<span class="op">::</span><span class="kw">cor_auto</span>(bctdf_chunks), <span class="dt">graph =</span> <span class="st">&quot;pcor&quot;</span>,
       <span class="dt">labels =</span> <span class="kw">names</span>(bctdf_chunks),
       <span class="dt">edge.labels =</span> <span class="ot">TRUE</span>, 
       <span class="dt">layout =</span> avlayout,
       <span class="dt">title =</span> <span class="st">&quot;partial correlation network&quot;</span>,
       <span class="dt">theme =</span> <span class="st">&quot;colorblind&quot;</span>,
       <span class="dt">maximum =</span> <span class="kw">max</span>(<span class="kw">c</span>(bootnetgraph<span class="op">$</span>graph<span class="op">$</span>Graph<span class="op">$</span>maximum,
                     pcorgraph<span class="op">$</span>graph<span class="op">$</span>Graph<span class="op">$</span>maximum, 
                     corgraph<span class="op">$</span>graph<span class="op">$</span>Graph<span class="op">$</span>maximum)))</code></pre></div>
<p><img src="baseline-networks_files/figure-html/chunked-networks2-2.png" width="2100" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
bootnetgraph &lt;-<span class="st"> </span><span class="kw">plot</span>(nwBCT_chunks, 
                     <span class="dt">edge.labels =</span> <span class="ot">TRUE</span>, 
                     <span class="dt">layout =</span> avlayout, 
                     <span class="dt">title =</span> <span class="st">&quot;partial correlation network, with LASSO regularisation and EBIC model selection&quot;</span>,
       <span class="dt">maximum =</span> <span class="kw">max</span>(<span class="kw">c</span>(bootnetgraph<span class="op">$</span>graph<span class="op">$</span>Graph<span class="op">$</span>maximum,
                     pcorgraph<span class="op">$</span>graph<span class="op">$</span>Graph<span class="op">$</span>maximum, 
                     corgraph<span class="op">$</span>graph<span class="op">$</span>Graph<span class="op">$</span>maximum)))</code></pre></div>
<p><img src="baseline-networks_files/figure-html/chunked-networks2-3.png" width="2100" /></p>
<div id="stability" class="section level3">
<h3>Stability</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># bootnet_stability_output &lt;- bootnet::bootnet(nwBCT_chunks, nBoots=1000)</span>
<span class="co"># save(bootnet_stability_output, file = &quot;./Rdata_files/bootnet_stability_output.Rdata&quot;)</span>
<span class="kw">load</span>(<span class="st">&quot;./Rdata_files/bootnet_stability_output.Rdata&quot;</span>)

<span class="kw">plot</span>(bootnet_stability_output, <span class="dt">labels =</span> <span class="ot">TRUE</span>, <span class="dt">order =</span> <span class="st">&quot;sample&quot;</span>) </code></pre></div>
<p><img src="baseline-networks_files/figure-html/chunked-stability-1.png" width="2100" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(bootnet_stability_output, <span class="st">&quot;edge&quot;</span>, <span class="dt">plot =</span> <span class="st">&quot;difference&quot;</span>, <span class="dt">onlyNonZero =</span> <span class="ot">TRUE</span>, <span class="dt">order =</span> <span class="st">&quot;sample&quot;</span>)</code></pre></div>
<p><img src="baseline-networks_files/figure-html/chunked-stability-2.png" width="2100" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># bootnet_centrality_stability_output &lt;- bootnet::bootnet(nwBCT_chunks, nBoots=1000,nCores=8, type=&quot;case&quot;)</span>
<span class="co"># save(bootnet_centrality_stability_output, file = &quot;./Rdata_files/bootnet_centrality_stability_output.Rdata&quot;)</span>
<span class="kw">load</span>(<span class="st">&quot;./Rdata_files/bootnet_centrality_stability_output.Rdata&quot;</span>)

<span class="kw">plot</span>(bootnet_centrality_stability_output)</code></pre></div>
<p><img src="baseline-networks_files/figure-html/chunked-stability-3.png" width="2100" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(bootnet_centrality_stability_output, <span class="dt">perNode=</span>T, <span class="st">&quot;strength&quot;</span>)</code></pre></div>
<p><img src="baseline-networks_files/figure-html/chunked-stability-4.png" width="2100" /></p>
</div>
</div>
</div>
<div id="individual-agreement-related-bcts-and-pa" class="section level1">
<h1>Individual agreement-related BCTs and PA</h1>
<p>Network without combining nodes</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
bctdf_pa_mgm &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(
<span class="co">#  id,</span>
<span class="co">#  intervention,</span>
<span class="co">#  group,</span>
<span class="co">#  school,</span>
  <span class="st">&#39;PA selfrep&#39;</span> =<span class="st"> </span>padaysLastweek_T1,
  <span class="st">&#39;PA accelerometer&#39;</span> =<span class="st"> </span>mvpaAccelerometer_T1,
  <span class="st">&#39;goal setting&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_01_T1,
  <span class="st">&#39;implementation plan&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_02_T1,
  <span class="st">&#39;plan by other&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_03_T1,
  <span class="st">&#39;reminder of plan&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_04_T1,
  <span class="st">&#39;subgoals&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_05_T1,
  <span class="st">&#39;new PA options&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_06_T1,
  <span class="st">&#39;barrier identification&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_07_T1,
  <span class="st">&#39;coping planning&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_08_T1,
  <span class="st">&#39;PA identity&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_09_T1,
  <span class="st">&#39;PA life values&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_10_T1) <span class="op">%&gt;%</span>
<span class="st"> </span><span class="kw">rowwise</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st"> </span><span class="kw">mutate</span>(
  <span class="st">&#39;goal setting&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">goal setting</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
  <span class="co"># &#39;has plan&#39; = ifelse(`implementation plan` == 1 &amp; `plan by other` == 1, 0, 1),</span>
  <span class="st">&#39;implementation plan&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">implementation plan</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
  <span class="st">&#39;reminder of plan&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">reminder of plan</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
  <span class="st">&#39;subgoals&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">subgoals</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
  <span class="st">&#39;new PA options&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">new PA options</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
  <span class="st">&#39;plan by other&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">plan by other</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
 <span class="st">&#39;barrier identification&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">barrier identification</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
 <span class="st">&#39;coping planning&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">coping planning</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
  <span class="co"># &#39;barriers identified or planned for&#39; = ifelse(`coping planning` == 1 &amp; `barrier identification` == 1, 0, 1),</span>
 <span class="st">&#39;PA identity&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">PA identity</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
 <span class="st">&#39;PA life values&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">PA life values</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="co"># &#39;identity, life values&#39; = ifelse(`PA identity` == 1 &amp; `PA life values` == 1, 0, 1),</span>
<span class="st">  </span><span class="co"># dplyr::select(-`log on paper`, -`smartphone`, -`plan by other`, -`implementation plan`, -identified, -intrinsic,</span>
<span class="st">  </span><span class="co">#        -`failure contemplated`, # only concerns those who haven&#39;t reached goals</span>
<span class="st">  </span><span class="co">#        -`barrier identification`, -`coping planning`, # closely related</span>
<span class="st">  </span><span class="co">#        -`PA identity`, -`PA life values`) %&gt;% # closely related</span>
<span class="co">#  dplyr::select(-controlled) %&gt;% # Not really gaussian at all </span>
<span class="st">  </span><span class="co"># data.frame %&gt;% </span>
<span class="st">  </span><span class="kw">mutate_all</span>(as.numeric)

<span class="co"># bctdf_mgm$autonomous[is.nan(bctdf_mgm$autonomous)] &lt;- NA</span>

<span class="co"># Create a covariance matrix of the data</span>
covMatrix &lt;-<span class="st"> </span>bctdf_pa_mgm <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">cov</span>(<span class="dt">use =</span> <span class="st">&quot;pairwise.complete.obs&quot;</span>)

<span class="co"># Transform the matrix so, that lower diagonal of the matrix shows partial correlations,</span>
<span class="co"># while the upper one shows bivariate correlations.</span>
matrix_corLower_parcorUpper &lt;-<span class="st"> </span>covMatrix <span class="op">%&gt;%</span><span class="st"> </span>ggm<span class="op">::</span><span class="kw">correlations</span>()

<span class="co"># Show the matrix</span>
matrix_corLower_parcorUpper <span class="op">%&gt;%</span><span class="st"> </span>papaja<span class="op">::</span><span class="kw">apa_table</span>(<span class="dt">caption =</span> <span class="st">&quot;Correlation matrix of key variables of interest. Lower diagonal shows bivariate correlations, upper diagonal shows partial correlations&quot;</span>)</code></pre></div>
<caption>
(#tab:individualAgreementBCTs-dataprep-corr)
</caption>
<caption>
<em>Correlation matrix of key variables of interest. Lower diagonal shows bivariate correlations, upper diagonal shows partial correlations</em>
</caption>
<table>
<thead>
<tr class="header">
<th></th>
<th align="left">PA selfrep</th>
<th align="left">PA accelerometer</th>
<th align="left">goal setting</th>
<th align="left">implementation plan</th>
<th align="left">plan by other</th>
<th align="left">reminder of plan</th>
<th align="left">subgoals</th>
<th align="left">new PA options</th>
<th align="left">barrier identification</th>
<th align="left">coping planning</th>
<th align="left">PA identity</th>
<th align="left">PA life values</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>PA selfrep</td>
<td align="left">1.00</td>
<td align="left">0.21</td>
<td align="left">0.02</td>
<td align="left">0.05</td>
<td align="left">0.15</td>
<td align="left">0.00</td>
<td align="left">0.03</td>
<td align="left">0.14</td>
<td align="left">-0.03</td>
<td align="left">-0.03</td>
<td align="left">0.02</td>
<td align="left">0.04</td>
</tr>
<tr class="even">
<td>PA accelerometer</td>
<td align="left">0.26</td>
<td align="left">1.00</td>
<td align="left">0.04</td>
<td align="left">0.02</td>
<td align="left">0.05</td>
<td align="left">-0.07</td>
<td align="left">0.03</td>
<td align="left">0.04</td>
<td align="left">-0.02</td>
<td align="left">-0.06</td>
<td align="left">0.04</td>
<td align="left">0.00</td>
</tr>
<tr class="odd">
<td>goal setting</td>
<td align="left">0.26</td>
<td align="left">0.12</td>
<td align="left">1.00</td>
<td align="left">0.51</td>
<td align="left">-0.02</td>
<td align="left">0.02</td>
<td align="left">0.00</td>
<td align="left">0.07</td>
<td align="left">0.07</td>
<td align="left">0.10</td>
<td align="left">0.06</td>
<td align="left">0.03</td>
</tr>
<tr class="even">
<td>implementation plan</td>
<td align="left">0.30</td>
<td align="left">0.13</td>
<td align="left">0.71</td>
<td align="left">1.00</td>
<td align="left">0.13</td>
<td align="left">0.09</td>
<td align="left">0.15</td>
<td align="left">0.05</td>
<td align="left">-0.03</td>
<td align="left">0.06</td>
<td align="left">-0.04</td>
<td align="left">0.09</td>
</tr>
<tr class="odd">
<td>plan by other</td>
<td align="left">0.32</td>
<td align="left">0.12</td>
<td align="left">0.38</td>
<td align="left">0.47</td>
<td align="left">1.00</td>
<td align="left">0.28</td>
<td align="left">0.15</td>
<td align="left">0.00</td>
<td align="left">0.05</td>
<td align="left">-0.02</td>
<td align="left">-0.01</td>
<td align="left">0.03</td>
</tr>
<tr class="even">
<td>reminder of plan</td>
<td align="left">0.25</td>
<td align="left">0.05</td>
<td align="left">0.45</td>
<td align="left">0.52</td>
<td align="left">0.56</td>
<td align="left">1.00</td>
<td align="left">0.32</td>
<td align="left">0.10</td>
<td align="left">0.11</td>
<td align="left">0.03</td>
<td align="left">0.02</td>
<td align="left">-0.04</td>
</tr>
<tr class="odd">
<td>subgoals</td>
<td align="left">0.29</td>
<td align="left">0.10</td>
<td align="left">0.50</td>
<td align="left">0.58</td>
<td align="left">0.52</td>
<td align="left">0.64</td>
<td align="left">1.00</td>
<td align="left">0.13</td>
<td align="left">0.01</td>
<td align="left">0.14</td>
<td align="left">0.04</td>
<td align="left">0.05</td>
</tr>
<tr class="even">
<td>new PA options</td>
<td align="left">0.32</td>
<td align="left">0.12</td>
<td align="left">0.47</td>
<td align="left">0.48</td>
<td align="left">0.38</td>
<td align="left">0.48</td>
<td align="left">0.52</td>
<td align="left">1.00</td>
<td align="left">0.10</td>
<td align="left">0.03</td>
<td align="left">0.07</td>
<td align="left">0.14</td>
</tr>
<tr class="odd">
<td>barrier identification</td>
<td align="left">0.20</td>
<td align="left">0.04</td>
<td align="left">0.50</td>
<td align="left">0.48</td>
<td align="left">0.40</td>
<td align="left">0.50</td>
<td align="left">0.52</td>
<td align="left">0.51</td>
<td align="left">1.00</td>
<td align="left">0.46</td>
<td align="left">0.14</td>
<td align="left">0.07</td>
</tr>
<tr class="even">
<td>coping planning</td>
<td align="left">0.21</td>
<td align="left">0.03</td>
<td align="left">0.54</td>
<td align="left">0.53</td>
<td align="left">0.39</td>
<td align="left">0.50</td>
<td align="left">0.57</td>
<td align="left">0.51</td>
<td align="left">0.74</td>
<td align="left">1.00</td>
<td align="left">0.15</td>
<td align="left">0.15</td>
</tr>
<tr class="odd">
<td>PA identity</td>
<td align="left">0.24</td>
<td align="left">0.10</td>
<td align="left">0.47</td>
<td align="left">0.45</td>
<td align="left">0.35</td>
<td align="left">0.42</td>
<td align="left">0.49</td>
<td align="left">0.49</td>
<td align="left">0.59</td>
<td align="left">0.62</td>
<td align="left">1.00</td>
<td align="left">0.42</td>
</tr>
<tr class="even">
<td>PA life values</td>
<td align="left">0.26</td>
<td align="left">0.09</td>
<td align="left">0.49</td>
<td align="left">0.50</td>
<td align="left">0.37</td>
<td align="left">0.42</td>
<td align="left">0.51</td>
<td align="left">0.53</td>
<td align="left">0.58</td>
<td align="left">0.62</td>
<td align="left">0.69</td>
<td align="left">1.00</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># Plot the matrix as a correlogram</span>
matrix_corLower_parcorUpper <span class="op">%&gt;%</span><span class="st"> </span>corrgram<span class="op">::</span><span class="kw">corrgram</span>(
  <span class="dt">type =</span> <span class="st">&quot;cor&quot;</span>,
  <span class="dt">lower.panel =</span> corrgram<span class="op">::</span>panel.pie,
  <span class="dt">upper.panel =</span> corrgram<span class="op">::</span>panel.pie,
  <span class="dt">main =</span> <span class="st">&quot;Bivariate (upper diagonal) and partial (lower diagonal)</span><span class="ch">\n</span><span class="st">correlations of agreement-BCTs and PA&quot;</span>)</code></pre></div>
<p><img src="baseline-networks_files/figure-html/individualAgreementBCTs-dataprep-corr-1.png" width="2100" /></p>
<div id="mgm-estimation-1" class="section level2">
<h2>mgm estimation</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># devtools::install_github(&quot;jmbh/mgm&quot;)</span>
<span class="co"># Restart R for the latest package</span>
<span class="co"># .r.restartR()</span>

<span class="co"># mgm wants full data, see package missForest for imputation</span>
bctdf_pa_mgm_fullobs &lt;-<span class="st"> </span>bctdf_pa_mgm <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">na.omit</span>()

mgm_pa_variable_types &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;c&quot;</span>, <span class="st">&quot;g&quot;</span>, <span class="kw">rep</span>(<span class="st">&quot;c&quot;</span>, <span class="dv">10</span>))
mgm_pa_variable_levels &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;8&quot;</span>, <span class="st">&quot;1&quot;</span>, <span class="kw">rep</span>(<span class="st">&quot;2&quot;</span>, <span class="dv">10</span>))
<span class="co"># data.frame(mgm_pa_variable_types, mgm_pa_variable_levels, names(bctdf_pa_mgm_fullobs))</span>

mgm_obj &lt;-<span class="st"> </span>mgm<span class="op">::</span><span class="kw">mgm</span>(<span class="dt">data =</span> bctdf_pa_mgm_fullobs,
  <span class="dt">type =</span> mgm_pa_variable_types,
  <span class="dt">level =</span> mgm_pa_variable_levels,
  <span class="dt">lambdaSel =</span> <span class="st">&quot;CV&quot;</span>,
  <span class="dt">lambdaFolds =</span> <span class="dv">10</span>,
  <span class="dt">pbar =</span> <span class="ot">FALSE</span>, 
  <span class="dt">binarySign =</span> <span class="ot">TRUE</span>)
## Note that the sign of parameter estimates is stored separately; see ?mgm

pred_obj &lt;-<span class="st"> </span><span class="kw">predict</span>(<span class="dt">object =</span> mgm_obj,
                         <span class="dt">data =</span> bctdf_pa_mgm_fullobs)

pred_obj<span class="op">$</span>errors</code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Variable"],"name":[1],"type":["chr"],"align":["left"]},{"label":["RMSE"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["R2"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["CC"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["nCC"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["CCmarg"],"name":[6],"type":["dbl"],"align":["right"]}],"data":[{"1":"PA selfrep","2":"NA","3":"NA","4":"0.265","5":"0.071","6":"0.209","_rn_":"1"},{"1":"PA accelerometer","2":"0.956","3":"0.084","4":"NA","5":"NA","6":"NA","_rn_":"2"},{"1":"goal setting","2":"NA","3":"NA","4":"0.907","5":"0.575","6":"0.781","_rn_":"3"},{"1":"implementation plan","2":"NA","3":"NA","4":"0.887","5":"0.614","6":"0.707","_rn_":"4"},{"1":"plan by other","2":"NA","3":"NA","4":"0.787","5":"0.552","6":"0.525","_rn_":"5"},{"1":"reminder of plan","2":"NA","3":"NA","4":"0.845","5":"0.659","6":"0.545","_rn_":"6"},{"1":"subgoals","2":"NA","3":"NA","4":"0.856","5":"0.627","6":"0.614","_rn_":"7"},{"1":"new PA options","2":"NA","3":"NA","4":"0.834","5":"0.390","6":"0.728","_rn_":"8"},{"1":"barrier identification","2":"NA","3":"NA","4":"0.902","5":"0.630","6":"0.735","_rn_":"9"},{"1":"coping planning","2":"NA","3":"NA","4":"0.919","5":"0.680","6":"0.747","_rn_":"10"},{"1":"PA identity","2":"NA","3":"NA","4":"0.914","5":"0.516","6":"0.822","_rn_":"11"},{"1":"PA life values","2":"NA","3":"NA","4":"0.910","5":"0.527","6":"0.810","_rn_":"12"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[15],"max":[15]},"pages":{}}}
  </script>
</div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># Take R2 from gaussian, CC from categorical variables </span>
pie_errors &lt;-<span class="st"> </span><span class="kw">c</span>(pred_obj<span class="op">$</span>errors[<span class="dv">1</span>, <span class="dv">4</span>],
                pred_obj<span class="op">$</span>errors[<span class="dv">2</span>, <span class="dv">3</span>],
                pred_obj<span class="op">$</span>errors[<span class="dv">3</span><span class="op">:</span><span class="kw">nrow</span>(pred_obj<span class="op">$</span>errors), <span class="dv">4</span>])

<span class="co"># PLOT NETWORK </span>

node_colors &lt;-<span class="st"> </span><span class="kw">c</span>(viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">begin =</span> <span class="fl">0.3</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">1</span>], 
                 viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">begin =</span> <span class="fl">0.3</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">2</span>],
                 <span class="kw">rep</span>(viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">begin =</span> <span class="fl">0.3</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">3</span>], <span class="dv">10</span>))

BCT_mgm &lt;-<span class="st"> </span>qgraph<span class="op">::</span><span class="kw">qgraph</span>(mgm_obj<span class="op">$</span>pairwise<span class="op">$</span>wadj, 
            <span class="dt">layout =</span> <span class="st">&quot;spring&quot;</span>,
            <span class="dt">repulsion =</span> <span class="fl">0.90</span>, <span class="co"># To nudge the network from originally bad visual state</span>
            <span class="dt">title =</span> <span class="st">&quot;agreement-measured BCTs and PA (accelerometer &amp; self-reported)&quot;</span>,
            <span class="dt">edge.color =</span> <span class="kw">ifelse</span>(mgm_obj<span class="op">$</span>pairwise<span class="op">$</span>edgecolor <span class="op">==</span><span class="st"> &quot;darkgreen&quot;</span>, <span class="st">&quot;blue&quot;</span>, mgm_obj<span class="op">$</span>pairwise<span class="op">$</span>edgecolor),
            <span class="dt">pie =</span> pie_errors,
            <span class="dt">pieColor =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">begin =</span> <span class="fl">0.3</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">4</span>],
            <span class="dt">color =</span> node_colors,
            <span class="dt">labels =</span> <span class="kw">names</span>(bctdf_pa_mgm_fullobs),
            <span class="dt">label.cex =</span> <span class="fl">0.75</span>,
            <span class="dt">label.scale =</span> <span class="ot">FALSE</span>,
            <span class="dt">label.color =</span> <span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">&quot;black&quot;</span>, <span class="dv">12</span>)))</code></pre></div>
<p><img src="baseline-networks_files/figure-html/individualAgreementBCTs-mgm-1.png" width="2100" /></p>
</div>
<div id="ggm-estimation" class="section level2">
<h2>ggm estimation</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># Estimate a network</span>

individualAgreementBCTs &lt;-<span class="st"> </span>bootnet<span class="op">::</span><span class="kw">estimateNetwork</span>(bctdf_pa_mgm, <span class="dt">default=</span><span class="st">&quot;EBICglasso&quot;</span>)

bootnetgraph &lt;-<span class="st"> </span><span class="kw">plot</span>(individualAgreementBCTs, <span class="dt">edge.labels =</span> <span class="ot">TRUE</span>, 
       <span class="dt">title =</span> <span class="st">&quot;partial correlation network, with LASSO regularisation and EBIC model selection&quot;</span>)</code></pre></div>
<p><img src="baseline-networks_files/figure-html/individualAgreementBCTs-ggm-1.png" width="2100" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
corgraph &lt;-<span class="st"> </span>qgraph<span class="op">::</span><span class="kw">qgraph</span>(qgraph<span class="op">::</span><span class="kw">cor_auto</span>(bctdf_pa_mgm), <span class="dt">graph =</span> <span class="st">&quot;cor&quot;</span>,
       <span class="dt">labels =</span> <span class="kw">names</span>(bctdf_pa_mgm),
       <span class="dt">edge.labels =</span> <span class="ot">TRUE</span>, 
       <span class="dt">title =</span> <span class="st">&quot;bivariate correlation network&quot;</span>)</code></pre></div>
<p><img src="baseline-networks_files/figure-html/individualAgreementBCTs-ggm-2.png" width="2100" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
pcorgraph &lt;-<span class="st"> </span>qgraph<span class="op">::</span><span class="kw">qgraph</span>(qgraph<span class="op">::</span><span class="kw">cor_auto</span>(bctdf_pa_mgm), <span class="dt">graph =</span> <span class="st">&quot;pcor&quot;</span>,
       <span class="dt">labels =</span> <span class="kw">names</span>(bctdf_pa_mgm),
       <span class="dt">edge.labels =</span> <span class="ot">TRUE</span>, 
       <span class="dt">title =</span> <span class="st">&quot;partial correlation network&quot;</span>)</code></pre></div>
<p><img src="baseline-networks_files/figure-html/individualAgreementBCTs-ggm-3.png" width="2100" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># Average the layout and plot all according to that</span>
avlayout &lt;-<span class="st"> </span>qgraph<span class="op">::</span><span class="kw">averageLayout</span>(bootnetgraph, corgraph, pcorgraph)

corgraph &lt;-<span class="st"> </span>qgraph<span class="op">::</span><span class="kw">qgraph</span>(qgraph<span class="op">::</span><span class="kw">cor_auto</span>(bctdf_pa_mgm), <span class="dt">graph =</span> <span class="st">&quot;cor&quot;</span>,
       <span class="dt">labels =</span> <span class="kw">names</span>(bctdf_pa_mgm),
       <span class="dt">edge.labels =</span> <span class="ot">TRUE</span>, 
       <span class="dt">layout =</span> avlayout, 
       <span class="dt">title =</span> <span class="st">&quot;bivariate correlation network&quot;</span>,
       <span class="dt">theme =</span> <span class="st">&quot;colorblind&quot;</span>,
       <span class="dt">maximum =</span> <span class="kw">max</span>(<span class="kw">c</span>(bootnetgraph<span class="op">$</span>graph<span class="op">$</span>Graph<span class="op">$</span>maximum,
                     pcorgraph<span class="op">$</span>graph<span class="op">$</span>Graph<span class="op">$</span>maximum, 
                     corgraph<span class="op">$</span>graph<span class="op">$</span>Graph<span class="op">$</span>maximum)),
       <span class="dt">label.scale =</span> <span class="ot">FALSE</span>)</code></pre></div>
<p><img src="baseline-networks_files/figure-html/individualAgreementBCTs-ggm-4.png" width="2100" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># To help with visual comparison, that last argument takes the maximum edge of the three </span>
<span class="co"># graphs and places that as the benchmark for the thickest line in all plots.</span>

pcorgraph &lt;-<span class="st"> </span>qgraph<span class="op">::</span><span class="kw">qgraph</span>(qgraph<span class="op">::</span><span class="kw">cor_auto</span>(bctdf_pa_mgm), <span class="dt">graph =</span> <span class="st">&quot;pcor&quot;</span>,
       <span class="dt">labels =</span> <span class="kw">names</span>(bctdf_pa_mgm),
       <span class="dt">edge.labels =</span> <span class="ot">TRUE</span>, 
       <span class="dt">layout =</span> avlayout,
       <span class="dt">title =</span> <span class="st">&quot;partial correlation network&quot;</span>,
       <span class="dt">theme =</span> <span class="st">&quot;colorblind&quot;</span>,
       <span class="dt">maximum =</span> <span class="kw">max</span>(<span class="kw">c</span>(bootnetgraph<span class="op">$</span>graph<span class="op">$</span>Graph<span class="op">$</span>maximum,
                     pcorgraph<span class="op">$</span>graph<span class="op">$</span>Graph<span class="op">$</span>maximum, 
                     corgraph<span class="op">$</span>graph<span class="op">$</span>Graph<span class="op">$</span>maximum)),
       <span class="dt">label.scale =</span> <span class="ot">FALSE</span>)</code></pre></div>
<p><img src="baseline-networks_files/figure-html/individualAgreementBCTs-ggm-5.png" width="2100" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
bootnetgraph &lt;-<span class="st"> </span><span class="kw">plot</span>(individualAgreementBCTs, 
                     <span class="dt">edge.labels =</span> <span class="ot">TRUE</span>, 
                     <span class="dt">layout =</span> avlayout, 
                     <span class="dt">title =</span> <span class="st">&quot;partial correlation network, with LASSO regularisation and EBIC model selection&quot;</span>,
       <span class="dt">maximum =</span> <span class="kw">max</span>(<span class="kw">c</span>(bootnetgraph<span class="op">$</span>graph<span class="op">$</span>Graph<span class="op">$</span>maximum,
                     pcorgraph<span class="op">$</span>graph<span class="op">$</span>Graph<span class="op">$</span>maximum, 
                     corgraph<span class="op">$</span>graph<span class="op">$</span>Graph<span class="op">$</span>maximum)),
       <span class="dt">label.scale =</span> <span class="ot">FALSE</span>)</code></pre></div>
<p><img src="baseline-networks_files/figure-html/individualAgreementBCTs-ggm-6.png" width="2100" /></p>
<div id="centrality-and-stability-1" class="section level3">
<h3>Centrality and stability</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
combinedAgreementBcts_centralityPlot &lt;-<span class="st"> </span>qgraph<span class="op">::</span><span class="kw">centralityPlot</span>(bootnetgraph)</code></pre></div>
<p><img src="baseline-networks_files/figure-html/individualAgreementBCTs-stability-1.png" width="2100" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
qgraph<span class="op">::</span><span class="kw">centralityPlot</span>(bootnetgraph, 
               <span class="dt">include =</span> <span class="kw">c</span>(<span class="st">&quot;Strength&quot;</span>, <span class="st">&quot;ExpectedInfluence&quot;</span>),
               <span class="dt">orderBy =</span> <span class="st">&quot;ExpectedInfluence&quot;</span>)</code></pre></div>
<p><img src="baseline-networks_files/figure-html/individualAgreementBCTs-stability-2.png" width="2100" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
qgraph<span class="op">::</span><span class="kw">centrality</span>(bootnetgraph)<span class="op">$</span>InDegree
##             PA selfrep       PA accelerometer           goal setting 
##              0.7564927              0.7655366              1.1207873 
##    implementation plan          plan by other       reminder of plan 
##              1.4343326              1.0385955              1.2895146 
##               subgoals         new PA options barrier identification 
##              1.1537468              0.9188644              1.1914191 
##        coping planning            PA identity         PA life values 
##              1.4569193              1.1931174              1.2073393
<span class="kw">scale</span>(qgraph<span class="op">::</span><span class="kw">centrality</span>(bootnetgraph)<span class="op">$</span>InDegree)
##                               [,1]
## PA selfrep             -1.63650970
## PA accelerometer       -1.59658706
## goal setting           -0.02840525
## implementation plan     1.35567689
## plan by other          -0.39122428
## reminder of plan        0.71640699
## subgoals                0.11708754
## new PA options         -0.91975300
## barrier identification  0.28338451
## coping planning         1.45538095
## PA identity             0.29088134
## PA life values          0.35366107
## attr(,&quot;scaled:center&quot;)
## [1] 1.127222
## attr(,&quot;scaled:scale&quot;)
## [1] 0.2265367
qgraph<span class="op">::</span><span class="kw">centrality</span>(bootnetgraph)<span class="op">$</span>Closeness
##             PA selfrep       PA accelerometer           goal setting 
##            0.008254997            0.009186215            0.009356217 
##    implementation plan          plan by other       reminder of plan 
##            0.009699602            0.010007230            0.010728322 
##               subgoals         new PA options barrier identification 
##            0.010554864            0.009496656            0.010531364 
##        coping planning            PA identity         PA life values 
##            0.011003924            0.009211254            0.009625116
qgraph<span class="op">::</span><span class="kw">centrality</span>(bootnetgraph)<span class="op">$</span>Betweenness
##             PA selfrep       PA accelerometer           goal setting 
##                      2                      2                      6 
##    implementation plan          plan by other       reminder of plan 
##                     10                     10                     12 
##               subgoals         new PA options barrier identification 
##                      4                     10                      6 
##        coping planning            PA identity         PA life values 
##                     16                      2                     10

<span class="kw">cor</span>(qgraph<span class="op">::</span><span class="kw">centrality</span>(bootnetgraph)<span class="op">$</span>InDegree, qgraph<span class="op">::</span><span class="kw">centrality</span>(bootnetgraph)<span class="op">$</span>Betweenness, 
    <span class="dt">method =</span> <span class="st">&quot;spearman&quot;</span>) 
## [1] 0.6357782

<span class="co"># bootnet_stability_individualAgreementBcts &lt;- bootnet::bootnet(individualAgreementBCTs, nBoots=1000)</span>
<span class="co"># save(bootnet_stability_individualAgreementBcts, file = &quot;./Rdata_files/bootnet_stability_individualAgreementBcts.Rdata&quot;)</span>
<span class="kw">load</span>(<span class="st">&quot;./Rdata_files/bootnet_stability_individualAgreementBcts.Rdata&quot;</span>)

<span class="kw">plot</span>(bootnet_stability_individualAgreementBcts, <span class="dt">labels =</span> <span class="ot">TRUE</span>, <span class="dt">order =</span> <span class="st">&quot;sample&quot;</span>) </code></pre></div>
<p><img src="baseline-networks_files/figure-html/individualAgreementBCTs-stability-3.png" width="2100" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(bootnet_stability_individualAgreementBcts, <span class="st">&quot;edge&quot;</span>, <span class="dt">plot =</span> <span class="st">&quot;difference&quot;</span>, <span class="dt">onlyNonZero =</span> <span class="ot">TRUE</span>, <span class="dt">order =</span> <span class="st">&quot;sample&quot;</span>)</code></pre></div>
<p><img src="baseline-networks_files/figure-html/individualAgreementBCTs-stability-4.png" width="2100" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># bootnet_centrality_stability_individualAgreementBcts &lt;- bootnet::bootnet(individualAgreementBCTs, nBoots=1000,nCores=8, type=&quot;case&quot;)</span>
<span class="co"># save(bootnet_centrality_stability_individualAgreementBcts, file = &quot;./Rdata_files/bootnet_centrality_stability_individualAgreementBcts.Rdata&quot;)</span>
<span class="kw">load</span>(<span class="st">&quot;./Rdata_files/bootnet_centrality_stability_individualAgreementBcts.Rdata&quot;</span>)

<span class="kw">plot</span>(bootnet_centrality_stability_individualAgreementBcts)</code></pre></div>
<p><img src="baseline-networks_files/figure-html/individualAgreementBCTs-stability-5.png" width="2100" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(bootnet_centrality_stability_individualAgreementBcts, <span class="dt">perNode=</span>T, <span class="st">&quot;strength&quot;</span>)</code></pre></div>
<p><img src="baseline-networks_files/figure-html/individualAgreementBCTs-stability-6.png" width="2100" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
bootnet<span class="op">::</span><span class="kw">corStability</span>(bootnet_centrality_stability_individualAgreementBcts)
## === Correlation Stability Analysis === 
## 
## Sampling levels tested:
##    nPerson Drop%   n
## 1      291  75.0  96
## 2      382  67.2 101
## 3      472  59.5  95
## 4      563  51.7 104
## 5      654  43.9  94
## 6      744  36.1 112
## 7      835  28.3 107
## 8      926  20.5 109
## 9     1016  12.8  90
## 10    1107   5.0  92
## 
## Maximum drop proportions to retain correlation of 0.7 in at least 95% of the samples:
## 
## betweenness: 0
##   - For more accuracy, run bootnet(..., caseMin = 0, caseMax = 0.05) 
## 
## closeness: 0.05
##   - For more accuracy, run bootnet(..., caseMin = 0, caseMax = 0.128) 
## 
## strength: 0.283
##   - For more accuracy, run bootnet(..., caseMin = 0.205, caseMax = 0.361) 
## 
## Accuracy can also be increased by increasing both &#39;nBoots&#39; and &#39;caseN&#39;.</code></pre></div>
</div>
</div>
</div>
<div id="combined-agreement-related-bcts-and-pa" class="section level1">
<h1>Combined agreement-related BCTs and PA</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
bctdf_pa_combinedAgreementBcts &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(
  <span class="st">&#39;PA selfrep&#39;</span> =<span class="st"> </span>padaysLastweek_T1,
  <span class="st">&#39;PA accelerometer&#39;</span> =<span class="st"> </span>mvpaAccelerometer_T1,
  <span class="st">&#39;goal setting&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_01_T1,
  <span class="st">&#39;implementation plan&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_02_T1,
  <span class="st">&#39;plan by other&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_03_T1,
  <span class="st">&#39;reminder of plan&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_04_T1,
  <span class="st">&#39;subgoals&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_05_T1,
  <span class="st">&#39;new PA options&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_06_T1,
  <span class="st">&#39;barrier identification&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_07_T1,
  <span class="st">&#39;coping planning&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_08_T1,
  <span class="st">&#39;PA identity&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_09_T1,
  <span class="st">&#39;PA life values&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_10_T1) <span class="op">%&gt;%</span>
<span class="st"> </span><span class="kw">rowwise</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st"> </span><span class="kw">mutate</span>(
  <span class="st">&#39;goal setting&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">goal setting</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
  <span class="st">&#39;has plan&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">implementation plan</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span> <span class="op">&amp;</span><span class="st"> `</span><span class="dt">plan by other</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
  <span class="co"># &#39;implementation plan&#39; = ifelse(`implementation plan` == 1, 0, 1),</span>
  <span class="st">&#39;reminder of plan&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">reminder of plan</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
  <span class="st">&#39;subgoals&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">subgoals</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
  <span class="st">&#39;new PA options&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">new PA options</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
  <span class="co"># &#39;plan by other&#39; = ifelse(`plan by other` == 1, 0, 1), </span>
  <span class="co"># &#39;barrier identification&#39; = ifelse(`barrier identification` == 1, 0, 1),</span>
  <span class="co"># &#39;coping planning&#39; = ifelse(`coping planning` == 1, 0, 1),</span>
  <span class="st">&#39;barriers identified or planned for&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">coping planning</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span> <span class="op">&amp;</span><span class="st"> `</span><span class="dt">barrier identification</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
  <span class="co"># &#39;PA identity&#39; = ifelse(`PA identity` == 1, 0, 1),</span>
  <span class="co"># &#39;PA life values&#39; = ifelse(`PA life values` == 1, 0, 1)) %&gt;% </span>
  <span class="st">&#39;identity, life values&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">PA identity</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span> <span class="op">&amp;</span><span class="st"> `</span><span class="dt">PA life values</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span><span class="st">`</span><span class="dt">plan by other</span><span class="st">`</span>, <span class="op">-</span><span class="st">`</span><span class="dt">implementation plan</span><span class="st">`</span>,
         <span class="op">-</span><span class="st">`</span><span class="dt">barrier identification</span><span class="st">`</span>, <span class="op">-</span><span class="st">`</span><span class="dt">coping planning</span><span class="st">`</span>, <span class="co"># closely related</span>
         <span class="op">-</span><span class="st">`</span><span class="dt">PA identity</span><span class="st">`</span>, <span class="op">-</span><span class="st">`</span><span class="dt">PA life values</span><span class="st">`</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># closely related</span>
<span class="st">  </span><span class="kw">mutate_all</span>(as.numeric)</code></pre></div>
<div id="mgm-estimation-2" class="section level4">
<h4>mgm estimation</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># devtools::install_github(&quot;jmbh/mgm&quot;)</span>
<span class="co"># Restart R for the latest package</span>
<span class="co"># .r.restartR()</span>

<span class="co"># mgm wants full data, see package missForest for imputation</span>
bctdf_pa_combinedAgreementBcts &lt;-<span class="st"> </span>bctdf_pa_combinedAgreementBcts <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">na.omit</span>()
<span class="co"># bctdf_pa_combinedAgreementBcts %&gt;% names()</span>
mgm_pa_variable_types &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;g&quot;</span>, <span class="st">&quot;g&quot;</span>, <span class="kw">rep</span>(<span class="st">&quot;c&quot;</span>, <span class="dv">7</span>))
mgm_pa_variable_levels &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;1&quot;</span>, <span class="st">&quot;1&quot;</span>, <span class="kw">rep</span>(<span class="st">&quot;2&quot;</span>, <span class="dv">7</span>))
<span class="co"># data.frame(mgm_pa_variable_types, mgm_pa_variable_levels, names(bctdf_pa_combinedAgreementBcts))</span>

mgm_obj &lt;-<span class="st"> </span>mgm<span class="op">::</span><span class="kw">mgm</span>(<span class="dt">data =</span> bctdf_pa_combinedAgreementBcts,
  <span class="dt">type =</span> mgm_pa_variable_types,
  <span class="dt">level =</span> mgm_pa_variable_levels,
  <span class="dt">lambdaSel =</span> <span class="st">&quot;CV&quot;</span>,
  <span class="dt">lambdaFolds =</span> <span class="dv">10</span>,
  <span class="dt">pbar =</span> <span class="ot">FALSE</span>, 
  <span class="dt">binarySign =</span> <span class="ot">TRUE</span>)
## Note that the sign of parameter estimates is stored separately; see ?mgm

pred_obj &lt;-<span class="st"> </span><span class="kw">predict</span>(<span class="dt">object =</span> mgm_obj,
                         <span class="dt">data =</span> bctdf_pa_combinedAgreementBcts)

pred_obj<span class="op">$</span>errors</code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Variable"],"name":[1],"type":["chr"],"align":["left"]},{"label":["RMSE"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["R2"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["CC"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["nCC"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["CCmarg"],"name":[6],"type":["dbl"],"align":["right"]}],"data":[{"1":"PA selfrep","2":"0.905","3":"0.179","4":"NA","5":"NA","6":"NA","_rn_":"1"},{"1":"PA accelerometer","2":"0.964","3":"0.070","4":"NA","5":"NA","6":"NA","_rn_":"2"},{"1":"goal setting","2":"NA","3":"NA","4":"0.896","5":"0.523","6":"0.782","_rn_":"3"},{"1":"reminder of plan","2":"NA","3":"NA","4":"0.841","5":"0.649","6":"0.547","_rn_":"4"},{"1":"subgoals","2":"NA","3":"NA","4":"0.860","5":"0.638","6":"0.613","_rn_":"5"},{"1":"new PA options","2":"NA","3":"NA","4":"0.828","5":"0.369","6":"0.727","_rn_":"6"},{"1":"has plan","2":"NA","3":"NA","4":"0.883","5":"0.554","6":"0.738","_rn_":"7"},{"1":"barriers identified or planned for","2":"NA","3":"NA","4":"0.888","5":"0.459","6":"0.793","_rn_":"8"},{"1":"identity, life values","2":"NA","3":"NA","4":"0.919","5":"0.405","6":"0.864","_rn_":"9"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[15],"max":[15]},"pages":{}}}
  </script>
</div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># Take R2 from gaussian, CC from categorical variables </span>
pie_errors &lt;-<span class="st"> </span><span class="kw">c</span>(pred_obj<span class="op">$</span>errors[<span class="dv">1</span>, <span class="dv">3</span>],
                pred_obj<span class="op">$</span>errors[<span class="dv">2</span>, <span class="dv">3</span>],
                pred_obj<span class="op">$</span>errors[<span class="dv">3</span><span class="op">:</span><span class="kw">nrow</span>(pred_obj<span class="op">$</span>errors), <span class="dv">4</span>])

<span class="co"># PLOT NETWORK </span>

node_colors &lt;-<span class="st"> </span><span class="kw">c</span>(viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">begin =</span> <span class="fl">0.3</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">1</span>], 
                 viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">begin =</span> <span class="fl">0.3</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">2</span>],
                 <span class="kw">rep</span>(viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">begin =</span> <span class="fl">0.3</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">3</span>], <span class="dv">7</span>))

BCT_mgm &lt;-<span class="st"> </span>qgraph<span class="op">::</span><span class="kw">qgraph</span>(mgm_obj<span class="op">$</span>pairwise<span class="op">$</span>wadj, 
            <span class="dt">layout =</span> <span class="st">&quot;spring&quot;</span>,
            <span class="dt">repulsion =</span> <span class="dv">1</span>, <span class="co"># To nudge the network from originally bad visual state</span>
            <span class="dt">title =</span> <span class="st">&quot;agreement-measured BCTs and PA&quot;</span>,
            <span class="dt">edge.color =</span> <span class="kw">ifelse</span>(mgm_obj<span class="op">$</span>pairwise<span class="op">$</span>edgecolor <span class="op">==</span><span class="st"> &quot;darkgreen&quot;</span>, <span class="st">&quot;blue&quot;</span>, mgm_obj<span class="op">$</span>pairwise<span class="op">$</span>edgecolor),
            <span class="dt">pie =</span> pie_errors,
            <span class="dt">pieColor =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">begin =</span> <span class="fl">0.3</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">4</span>],
            <span class="dt">color =</span> node_colors,
            <span class="dt">labels =</span> <span class="kw">names</span>(bctdf_pa_combinedAgreementBcts),
            <span class="dt">label.cex =</span> <span class="fl">0.75</span>,
            <span class="dt">label.scale =</span> <span class="ot">FALSE</span>,
            <span class="dt">label.color =</span> <span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">&quot;black&quot;</span>, <span class="dv">9</span>)))</code></pre></div>
<p><img src="baseline-networks_files/figure-html/combinedAgreementBcts-mgm-1.png" width="2100" /></p>
</div>
<div id="ggm-plot" class="section level2">
<h2>GGM plot</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
combinedAgreementBcts_ggm_df &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(
  <span class="st">&#39;PA selfrep&#39;</span> =<span class="st"> </span>padaysLastweek_T1,
  <span class="st">&#39;PA accelerometer&#39;</span> =<span class="st"> </span>mvpaAccelerometer_T1,
  <span class="st">&#39;goal setting&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_01_T1,
  <span class="st">&#39;implementation plan&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_02_T1,
  <span class="st">&#39;plan by other&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_03_T1,
  <span class="st">&#39;reminder of plan&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_04_T1,
  <span class="st">&#39;subgoals&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_05_T1,
  <span class="st">&#39;new PA options&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_06_T1,
  <span class="st">&#39;barrier identification&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_07_T1,
  <span class="st">&#39;coping planning&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_08_T1,
  <span class="st">&#39;PA identity&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_09_T1,
  <span class="st">&#39;PA life values&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_10_T1) <span class="op">%&gt;%</span>
<span class="st"> </span><span class="kw">rowwise</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st"> </span><span class="kw">mutate</span>(
  <span class="st">&#39;has plan&#39;</span> =<span class="st"> </span><span class="kw">mean</span>(<span class="kw">c</span>(<span class="st">`</span><span class="dt">implementation plan</span><span class="st">`</span>, <span class="st">`</span><span class="dt">plan by other</span><span class="st">`</span>), <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),
  <span class="st">&#39;barriers identified or planned for&#39;</span> =<span class="st"> </span><span class="kw">mean</span>(<span class="kw">c</span>(<span class="st">`</span><span class="dt">coping planning</span><span class="st">`</span>, <span class="st">`</span><span class="dt">barrier identification</span><span class="st">`</span>), <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),
  <span class="st">&#39;identity, life values&#39;</span> =<span class="st"> </span><span class="kw">mean</span>(<span class="kw">c</span>(<span class="st">`</span><span class="dt">PA identity</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="st">`</span><span class="dt">PA life values</span><span class="st">`</span>), <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span><span class="st">`</span><span class="dt">plan by other</span><span class="st">`</span>, <span class="op">-</span><span class="st">`</span><span class="dt">implementation plan</span><span class="st">`</span>, 
         <span class="op">-</span><span class="st">`</span><span class="dt">barrier identification</span><span class="st">`</span>, <span class="op">-</span><span class="st">`</span><span class="dt">coping planning</span><span class="st">`</span>, <span class="co"># closely related</span>
         <span class="op">-</span><span class="st">`</span><span class="dt">PA identity</span><span class="st">`</span>, <span class="op">-</span><span class="st">`</span><span class="dt">PA life values</span><span class="st">`</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># closely related</span>
<span class="st">  </span><span class="kw">mutate_all</span>(as.numeric)

<span class="co"># Create means for filling nodes</span>
<span class="co"># piefill_ggm &lt;- S.total_ggm %&gt;% </span>
<span class="co">#   dplyr::select(-contains(&quot;MVPA&quot;), -girl, -intervention) %&gt;%</span>
<span class="co">#   summarise_all(funs(median(., na.rm = TRUE) / 6)) </span>
<span class="co"># </span>
<span class="co"># piefill_ggm$MVPA &lt;- median(S.total_ggm$MVPA, na.rm = TRUE) / (60*24) </span>
<span class="co"># piefill_ggm$girl &lt;- mean(S.total_ggm$girl, na.rm = TRUE)</span>
<span class="co"># piefill_ggm$intervention &lt;- mean(S.total_ggm$intervention, na.rm = TRUE)</span>
<span class="co"># </span>
<span class="co"># piefill_ggm &lt;- piefill_ggm %&gt;% dplyr::select(MVPA, girl, intervention, everything())</span></code></pre></div>
<p><img src="baseline-networks_files/figure-html/combinedAgreementBcts-ggm-1.png" width="2100" /><img src="baseline-networks_files/figure-html/combinedAgreementBcts-ggm-2.png" width="2100" /><img src="baseline-networks_files/figure-html/combinedAgreementBcts-ggm-3.png" width="2100" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">

<span class="co"># Average the layout of three previous plots, and plot each according to that</span>
avlayout &lt;-<span class="st"> </span>qgraph<span class="op">::</span><span class="kw">averageLayout</span>(bootnetgraph, corgraph, pcorgraph)

corgraph &lt;-<span class="st"> </span>qgraph<span class="op">::</span><span class="kw">qgraph</span>(qgraph<span class="op">::</span><span class="kw">cor_auto</span>(combinedAgreementBcts_ggm_df), <span class="dt">graph =</span> <span class="st">&quot;cor&quot;</span>,
       <span class="dt">labels =</span> <span class="kw">names</span>(combinedAgreementBcts_ggm_df),
       <span class="dt">edge.labels =</span> <span class="ot">TRUE</span>, 
       <span class="dt">layout =</span> avlayout, 
       <span class="dt">title =</span> <span class="st">&quot;bivariate correlation network&quot;</span>,
       <span class="dt">theme =</span> <span class="st">&quot;colorblind&quot;</span>,
       <span class="dt">maximum =</span> <span class="kw">max</span>(<span class="kw">c</span>(bootnetgraph<span class="op">$</span>graph<span class="op">$</span>Graph<span class="op">$</span>maximum,
                     pcorgraph<span class="op">$</span>graph<span class="op">$</span>Graph<span class="op">$</span>maximum, 
                     corgraph<span class="op">$</span>graph<span class="op">$</span>Graph<span class="op">$</span>maximum)),
       <span class="dt">label.scale =</span> <span class="ot">FALSE</span>)</code></pre></div>
<p><img src="baseline-networks_files/figure-html/combinedAgreementBcts-ggm2-1.png" width="2100" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># To help with visual comparison, that last argument takes the maximum edge of the three </span>
<span class="co"># graphs and places that as the benchmark for the thickest line in all plots.</span>

pcorgraph &lt;-<span class="st"> </span>qgraph<span class="op">::</span><span class="kw">qgraph</span>(qgraph<span class="op">::</span><span class="kw">cor_auto</span>(combinedAgreementBcts_ggm_df), <span class="dt">graph =</span> <span class="st">&quot;pcor&quot;</span>,
       <span class="dt">labels =</span> <span class="kw">names</span>(combinedAgreementBcts_ggm_df),
       <span class="dt">edge.labels =</span> <span class="ot">TRUE</span>, 
       <span class="dt">layout =</span> avlayout,
       <span class="dt">title =</span> <span class="st">&quot;partial correlation network&quot;</span>,
       <span class="dt">theme =</span> <span class="st">&quot;colorblind&quot;</span>,
       <span class="dt">maximum =</span> <span class="kw">max</span>(<span class="kw">c</span>(bootnetgraph<span class="op">$</span>graph<span class="op">$</span>Graph<span class="op">$</span>maximum,
                     pcorgraph<span class="op">$</span>graph<span class="op">$</span>Graph<span class="op">$</span>maximum, 
                     corgraph<span class="op">$</span>graph<span class="op">$</span>Graph<span class="op">$</span>maximum)),
       <span class="dt">label.scale =</span> <span class="ot">FALSE</span>)</code></pre></div>
<p><img src="baseline-networks_files/figure-html/combinedAgreementBcts-ggm2-2.png" width="2100" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
bootnetgraph &lt;-<span class="st"> </span><span class="kw">plot</span>(combinedAgreementBcts_network, 
                     <span class="dt">edge.labels =</span> <span class="ot">TRUE</span>, 
                     <span class="dt">layout =</span> avlayout, 
                     <span class="dt">title =</span> <span class="st">&quot;partial correlation network, with LASSO regularisation and EBIC model selection&quot;</span>,
       <span class="dt">maximum =</span> <span class="kw">max</span>(<span class="kw">c</span>(bootnetgraph<span class="op">$</span>graph<span class="op">$</span>Graph<span class="op">$</span>maximum,
                     pcorgraph<span class="op">$</span>graph<span class="op">$</span>Graph<span class="op">$</span>maximum, 
                     corgraph<span class="op">$</span>graph<span class="op">$</span>Graph<span class="op">$</span>maximum)),
       <span class="dt">label.scale =</span> <span class="ot">FALSE</span>)</code></pre></div>
<p><img src="baseline-networks_files/figure-html/combinedAgreementBcts-ggm2-3.png" width="2100" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
qgraph<span class="op">::</span><span class="kw">flow</span>(bootnetgraph, <span class="st">&quot;PA selfrep&quot;</span>, <span class="dt">theme =</span> <span class="st">&quot;colorblind&quot;</span>, <span class="dt">vsize =</span> <span class="dv">8</span>)</code></pre></div>
<p><img src="baseline-networks_files/figure-html/combinedAgreementBcts-ggm2-4.png" width="2100" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">qgraph<span class="op">::</span><span class="kw">flow</span>(bootnetgraph, <span class="st">&quot;PA accelerometer&quot;</span>, <span class="dt">theme =</span> <span class="st">&quot;colorblind&quot;</span>, <span class="dt">vsize =</span> <span class="dv">8</span>)</code></pre></div>
<p><img src="baseline-networks_files/figure-html/combinedAgreementBcts-ggm2-5.png" width="2100" /></p>
<div id="centrality-and-stability-2" class="section level3">
<h3>Centrality and stability</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">combinedAgreementBcts_centralityPlot &lt;-<span class="st"> </span>qgraph<span class="op">::</span><span class="kw">centralityPlot</span>(bootnetgraph)</code></pre></div>
<p><img src="baseline-networks_files/figure-html/combinedAgreementBcts-stability-1.png" width="2100" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
qgraph<span class="op">::</span><span class="kw">centralityPlot</span>(bootnetgraph, 
               <span class="dt">include =</span> <span class="kw">c</span>(<span class="st">&quot;Strength&quot;</span>, <span class="st">&quot;ExpectedInfluence&quot;</span>),
               <span class="dt">orderBy =</span> <span class="st">&quot;ExpectedInfluence&quot;</span>)</code></pre></div>
<p><img src="baseline-networks_files/figure-html/combinedAgreementBcts-stability-2.png" width="2100" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
qgraph<span class="op">::</span><span class="kw">centrality</span>(bootnetgraph)<span class="op">$</span>InDegree
##                         PA selfrep                   PA accelerometer 
##                          0.6547028                          0.4296570 
##                       goal setting                   reminder of plan 
##                          0.9687732                          0.9562115 
##                           subgoals                     new PA options 
##                          1.1482682                          0.9104724 
##                           has plan barriers identified or planned for 
##                          1.0412735                          0.9858917 
##              identity, life values 
##                          0.7574188
<span class="kw">scale</span>(qgraph<span class="op">::</span><span class="kw">centrality</span>(bootnetgraph)<span class="op">$</span>InDegree)
##                                          [,1]
## PA selfrep                         -0.9841208
## PA accelerometer                   -2.0009071
## goal setting                        0.4348898
## reminder of plan                    0.3781346
## subgoals                            1.2458718
## new PA options                      0.1714792
## has plan                            0.7624558
## barriers identified or planned for  0.5122337
## identity, life values              -0.5200370
## attr(,&quot;scaled:center&quot;)
## [1] 0.8725188
## attr(,&quot;scaled:scale&quot;)
## [1] 0.2213305
qgraph<span class="op">::</span><span class="kw">centrality</span>(bootnetgraph)<span class="op">$</span>Closeness
##                         PA selfrep                   PA accelerometer 
##                        0.013236252                        0.008951805 
##                       goal setting                   reminder of plan 
##                        0.015304288                        0.015354375 
##                           subgoals                     new PA options 
##                        0.014907817                        0.014529914 
##                           has plan barriers identified or planned for 
##                        0.015931466                        0.013831928 
##              identity, life values 
##                        0.013240166
qgraph<span class="op">::</span><span class="kw">centrality</span>(bootnetgraph)<span class="op">$</span>Betweenness
##                         PA selfrep                   PA accelerometer 
##                                 14                                  0 
##                       goal setting                   reminder of plan 
##                                  4                                  8 
##                           subgoals                     new PA options 
##                                  0                                  8 
##                           has plan barriers identified or planned for 
##                                 14                                  4 
##              identity, life values 
##                                  0

<span class="kw">cor</span>(qgraph<span class="op">::</span><span class="kw">centrality</span>(bootnetgraph)<span class="op">$</span>InDegree, qgraph<span class="op">::</span><span class="kw">centrality</span>(bootnetgraph)<span class="op">$</span>Betweenness, 
    <span class="dt">method =</span> <span class="st">&quot;spearman&quot;</span>) 
## [1] 0.0515254

<span class="co"># bootnet_stability_combinedAgreementBcts &lt;- bootnet::bootnet(combinedAgreementBcts_network, nBoots=1000)</span>
<span class="co"># save(bootnet_stability_combinedAgreementBcts, file = &quot;./Rdata_files/bootnet_stability_combinedAgreementBcts.Rdata&quot;)</span>
<span class="kw">load</span>(<span class="st">&quot;./Rdata_files/bootnet_stability_combinedAgreementBcts.Rdata&quot;</span>)

<span class="kw">plot</span>(bootnet_stability_combinedAgreementBcts, <span class="dt">labels =</span> <span class="ot">TRUE</span>, <span class="dt">order =</span> <span class="st">&quot;sample&quot;</span>) </code></pre></div>
<p><img src="baseline-networks_files/figure-html/combinedAgreementBcts-stability-3.png" width="2100" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(bootnet_stability_combinedAgreementBcts, <span class="st">&quot;edge&quot;</span>, <span class="dt">plot =</span> <span class="st">&quot;difference&quot;</span>, <span class="dt">onlyNonZero =</span> <span class="ot">TRUE</span>, <span class="dt">order =</span> <span class="st">&quot;sample&quot;</span>)</code></pre></div>
<p><img src="baseline-networks_files/figure-html/combinedAgreementBcts-stability-4.png" width="2100" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># bootnet_centrality_stability_combinedAgreementBcts &lt;- bootnet::bootnet(combinedAgreementBcts_network, nBoots=1000,nCores=8, type=&quot;case&quot;)</span>
<span class="co"># save(bootnet_centrality_stability_combinedAgreementBcts, file = &quot;./Rdata_files/bootnet_centrality_stability_combinedAgreementBcts.Rdata&quot;)</span>
<span class="kw">load</span>(<span class="st">&quot;./Rdata_files/bootnet_centrality_stability_combinedAgreementBcts.Rdata&quot;</span>)

<span class="kw">plot</span>(bootnet_centrality_stability_combinedAgreementBcts)</code></pre></div>
<p><img src="baseline-networks_files/figure-html/combinedAgreementBcts-stability-5.png" width="2100" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(bootnet_centrality_stability_combinedAgreementBcts, <span class="dt">perNode=</span>T, <span class="st">&quot;strength&quot;</span>)</code></pre></div>
<p><img src="baseline-networks_files/figure-html/combinedAgreementBcts-stability-6.png" width="2100" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
bootnet<span class="op">::</span><span class="kw">corStability</span>(bootnet_centrality_stability_combinedAgreementBcts)
## === Correlation Stability Analysis === 
## 
## Sampling levels tested:
##    nPerson Drop%   n
## 1      291  75.0 112
## 2      382  67.2 108
## 3      472  59.5  94
## 4      563  51.7  92
## 5      654  43.9  96
## 6      744  36.1 105
## 7      835  28.3 117
## 8      926  20.5  96
## 9     1016  12.8  86
## 10    1107   5.0  94
## 
## Maximum drop proportions to retain correlation of 0.7 in at least 95% of the samples:
## 
## betweenness: 0.128
##   - For more accuracy, run bootnet(..., caseMin = 0.05, caseMax = 0.205) 
## 
## closeness: 0.672
##   - For more accuracy, run bootnet(..., caseMin = 0.595, caseMax = 0.75) 
## 
## strength: 0.75
##   - For more accuracy, run bootnet(..., caseMin = 0.672, caseMax = 1) 
## 
## Accuracy can also be increased by increasing both &#39;nBoots&#39; and &#39;caseN&#39;.</code></pre></div>
</div>
<div id="heterogeneity" class="section level3">
<h3>Heterogeneity</h3>
<p>The smallest track (IT) has 163 observations. According to the heuristic sample size for p variables for Gaussian data, (p*(p-1)/2 + p), we could estimate about 7 variables. (based on <a href="https://cvborkulo.files.wordpress.com/2014/09/winterschool2017.pdf">these slides</a> referring to this source: Bühlmann, P. &amp; van de Geer, S. (2011). Statistics for High-Dimensional Data: Methods, Theory and Applications. Springer.)</p>
<p>All tracks seem sufficiently similar on these BCTs.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
combinedAgreementBcts_tracks_df &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(
  <span class="st">&#39;PA selfrep&#39;</span> =<span class="st"> </span>padaysLastweek_T1,
  <span class="co"># &#39;PA accelerometer&#39; = mvpaAccelerometer_T1,</span>
  <span class="st">&#39;Autonomous&#39;</span> =<span class="st"> </span>PA_autonomous_T1,
  <span class="st">&#39;goal setting&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_01_T1,
  <span class="st">&#39;implementation plan&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_02_T1,
  <span class="co"># &#39;plan by other&#39; = PA_agreementDependentBCT_03_T1,</span>
  <span class="st">&#39;reminder of plan&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_04_T1,
  <span class="st">&#39;subgoals&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_05_T1,
  <span class="co"># &#39;new PA options&#39; = PA_agreementDependentBCT_06_T1,</span>
  <span class="st">&#39;barrier identification&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_07_T1,
  <span class="st">&#39;coping planning&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_08_T1,
  <span class="st">&#39;PA identity&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_09_T1,
  <span class="st">&#39;PA life values&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_10_T1) <span class="op">%&gt;%</span>
<span class="st"> </span><span class="kw">rowwise</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st"> </span><span class="kw">mutate</span>(
  <span class="st">&#39;barriers identified or planned for&#39;</span> =<span class="st"> </span><span class="kw">mean</span>(<span class="kw">c</span>(<span class="st">`</span><span class="dt">coping planning</span><span class="st">`</span>, <span class="st">`</span><span class="dt">barrier identification</span><span class="st">`</span>), <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), 
  <span class="st">&#39;identity, life values&#39;</span> =<span class="st"> </span><span class="kw">mean</span>(<span class="kw">c</span>(<span class="st">`</span><span class="dt">PA identity</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="st">`</span><span class="dt">PA life values</span><span class="st">`</span>), <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>( 
         <span class="op">-</span><span class="st">`</span><span class="dt">barrier identification</span><span class="st">`</span>, <span class="op">-</span><span class="st">`</span><span class="dt">coping planning</span><span class="st">`</span>, <span class="co"># closely related</span>
         <span class="op">-</span><span class="st">`</span><span class="dt">PA identity</span><span class="st">`</span>, <span class="op">-</span><span class="st">`</span><span class="dt">PA life values</span><span class="st">`</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># closely related</span>
<span class="st">  </span><span class="kw">mutate_all</span>(as.numeric) 

combinedAgreementBcts_tracks_df &lt;-<span class="st"> </span><span class="kw">cbind</span>(<span class="dt">track =</span> df<span class="op">$</span>track, combinedAgreementBcts_tracks_df) 

combinedAgreementBcts_tracks_df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">group_by</span>(track) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarise</span>(<span class="dt">n =</span> <span class="kw">n</span>())</code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["track"],"name":[1],"type":["fctr"],"align":["left"]},{"label":["n"],"name":[2],"type":["int"],"align":["right"]}],"data":[{"1":"Other","2":"24"},{"1":"IT","2":"163"},{"1":"BA","2":"282"},{"1":"HRC","2":"213"},{"1":"Nur","2":"402"},{"1":"NA","2":"82"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[15],"max":[15]},"pages":{}}}
  </script>
</div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
heterogeneity_Nur &lt;-<span class="st"> </span>combinedAgreementBcts_tracks_df <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;Nur&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">na.omit</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>track)

heterogeneity_HRC &lt;-<span class="st"> </span>combinedAgreementBcts_tracks_df <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;HRC&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">na.omit</span>() <span class="op">%&gt;%</span><span class="st">  </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>track)

heterogeneity_BA &lt;-<span class="st"> </span>combinedAgreementBcts_tracks_df <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;BA&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">na.omit</span>() <span class="op">%&gt;%</span><span class="st">  </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>track)

heterogeneity_IT &lt;-<span class="st"> </span>combinedAgreementBcts_tracks_df <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;IT&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">na.omit</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>track)

network_Nur &lt;-<span class="st"> </span>bootnet<span class="op">::</span><span class="kw">estimateNetwork</span>(heterogeneity_Nur, <span class="dt">default=</span><span class="st">&quot;EBICglasso&quot;</span>)
network_HRC &lt;-<span class="st"> </span>bootnet<span class="op">::</span><span class="kw">estimateNetwork</span>(heterogeneity_HRC, <span class="dt">default=</span><span class="st">&quot;EBICglasso&quot;</span>)
network_BA &lt;-<span class="st"> </span>bootnet<span class="op">::</span><span class="kw">estimateNetwork</span>(heterogeneity_BA, <span class="dt">default=</span><span class="st">&quot;EBICglasso&quot;</span>)
network_IT &lt;-<span class="st"> </span>bootnet<span class="op">::</span><span class="kw">estimateNetwork</span>(heterogeneity_IT, <span class="dt">default=</span><span class="st">&quot;EBICglasso&quot;</span>)

graph_Nur &lt;-<span class="st"> </span><span class="kw">plot</span>(network_Nur, <span class="dt">layout=</span><span class="st">&quot;spring&quot;</span>, <span class="dt">cut=</span><span class="dv">0</span>, <span class="dt">label.scale =</span> <span class="ot">FALSE</span>, <span class="dt">title =</span> <span class="st">&quot;Practical nurse&quot;</span>)</code></pre></div>
<p><img src="baseline-networks_files/figure-html/combinedAgreementBcts-heterogeneity-1.png" width="2100" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">graph_HRC &lt;-<span class="st"> </span><span class="kw">plot</span>(network_HRC, <span class="dt">layout=</span><span class="st">&quot;spring&quot;</span>, <span class="dt">cut=</span><span class="dv">0</span>, <span class="dt">label.scale =</span> <span class="ot">FALSE</span>, <span class="dt">title =</span> <span class="st">&quot;HRC&quot;</span>)</code></pre></div>
<p><img src="baseline-networks_files/figure-html/combinedAgreementBcts-heterogeneity-2.png" width="2100" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">graph_BA &lt;-<span class="st"> </span><span class="kw">plot</span>(network_BA, <span class="dt">layout=</span><span class="st">&quot;spring&quot;</span>, <span class="dt">cut=</span><span class="dv">0</span>, <span class="dt">label.scale =</span> <span class="ot">FALSE</span>, <span class="dt">title =</span> <span class="st">&quot;BA&quot;</span>)</code></pre></div>
<p><img src="baseline-networks_files/figure-html/combinedAgreementBcts-heterogeneity-3.png" width="2100" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">graph_IT &lt;-<span class="st"> </span><span class="kw">plot</span>(network_IT, <span class="dt">layout=</span><span class="st">&quot;spring&quot;</span>, <span class="dt">cut=</span><span class="dv">0</span>, <span class="dt">label.scale =</span> <span class="ot">FALSE</span>, <span class="dt">title =</span> <span class="st">&quot;IT&quot;</span>)</code></pre></div>
<p><img src="baseline-networks_files/figure-html/combinedAgreementBcts-heterogeneity-4.png" width="2100" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
maxedge &lt;-<span class="st"> </span><span class="kw">max</span>(<span class="kw">c</span>(graph_Nur<span class="op">$</span>graphAttributes<span class="op">$</span>Graph<span class="op">$</span>maximum, 
                 graph_HRC<span class="op">$</span>graphAttributes<span class="op">$</span>Graph<span class="op">$</span>maximum, 
                 graph_BA<span class="op">$</span>graphAttributes<span class="op">$</span>Graph<span class="op">$</span>maximum, 
                 graph_IT<span class="op">$</span>graphAttributes<span class="op">$</span>Graph<span class="op">$</span>maximum))

L &lt;-<span class="st"> </span>qgraph<span class="op">::</span><span class="kw">averageLayout</span>(graph_Nur, graph_HRC, graph_BA, graph_IT)

<span class="kw">layout</span>(<span class="kw">matrix</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>, <span class="dt">nrow =</span> <span class="dv">2</span>, <span class="dt">byrow =</span> <span class="ot">TRUE</span>))
graph_Nur &lt;-<span class="st"> </span><span class="kw">plot</span>(network_Nur, <span class="dt">layout=</span>L, <span class="dt">cut=</span><span class="dv">0</span>, <span class="dt">label.scale =</span> <span class="ot">FALSE</span>, <span class="dt">title =</span> <span class="st">&quot;Practical nurse&quot;</span>, 
                  <span class="dt">maximum =</span> maxedge)
graph_HRC &lt;-<span class="st"> </span><span class="kw">plot</span>(network_HRC, <span class="dt">layout=</span>L, <span class="dt">cut=</span><span class="dv">0</span>, <span class="dt">label.scale =</span> <span class="ot">FALSE</span>, <span class="dt">title =</span> <span class="st">&quot;HRC&quot;</span>,
                  <span class="dt">maximum =</span> maxedge)
graph_BA &lt;-<span class="st"> </span><span class="kw">plot</span>(network_BA, <span class="dt">layout=</span>L, <span class="dt">cut=</span><span class="dv">0</span>, <span class="dt">label.scale =</span> <span class="ot">FALSE</span>, <span class="dt">title =</span> <span class="st">&quot;BA&quot;</span>, 
                 <span class="dt">maximum =</span> maxedge)
graph_IT &lt;-<span class="st"> </span><span class="kw">plot</span>(network_IT, <span class="dt">layout=</span>L, <span class="dt">cut=</span><span class="dv">0</span>, <span class="dt">label.scale =</span> <span class="ot">FALSE</span>, <span class="dt">title =</span> <span class="st">&quot;IT&quot;</span>,
                 <span class="dt">maximum =</span> maxedge)</code></pre></div>
<p><img src="baseline-networks_files/figure-html/combinedAgreementBcts-heterogeneity-5.png" width="2100" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># nct_results &lt;- NetworkComparisonTest::NCT(heterogeneity_Nur, heterogeneity_IT, it=1000, binary.data=FALSE, paired=FALSE, test.edges=TRUE,</span>
<span class="co"># edges=&#39;all&#39;, progressbar=TRUE)</span>
<span class="co"># </span>
<span class="co"># save(nct_results, file = &quot;./Rdata_files/nct_results.Rdata&quot;)</span>
<span class="kw">load</span>(<span class="st">&quot;./Rdata_files/nct_results.Rdata&quot;</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="kw">print</span>(<span class="st">&quot;These are the sizes of educational tracks:&quot;</span>)
## [1] &quot;These are the sizes of educational tracks:&quot;
combinedAgreementBcts_tracks_df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">group_by</span>(track) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarise</span>(<span class="dt">n =</span> <span class="kw">n</span>()) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>papaja<span class="op">::</span><span class="kw">apa_table</span>()
## &lt;caption&gt;(\#tab:combinedAgreementBcts-heterogeneity-nct)&lt;/caption&gt;
## 
## &lt;caption&gt;**&lt;/caption&gt;
## 
## 
## 
## track   n   
## ------  ----
## Other   24  
## IT      163 
## BA      282 
## HRC     213 
## Nur     402 
## NA      82

<span class="kw">print</span>(<span class="st">&quot;Similarity&quot;</span>)
## [1] &quot;Similarity&quot;
<span class="kw">cat</span>(<span class="st">&quot;Correlation between Nur and IT edge strengths:&quot;</span>, <span class="kw">cor</span>(qgraph<span class="op">::</span><span class="kw">centrality</span>(network_Nur)<span class="op">$</span>InDegree, qgraph<span class="op">::</span><span class="kw">centrality</span>(network_IT)<span class="op">$</span>InDegree))
## Correlation between Nur and IT edge strengths: 0.9199116

<span class="kw">cat</span>(<span class="st">&quot;Correlation between Nur and IT networks:&quot;</span>, <span class="kw">cor</span>(network_Nur<span class="op">$</span>graph[<span class="kw">lower.tri</span>(network_Nur<span class="op">$</span>graph)], network_IT<span class="op">$</span>graph[<span class="kw">lower.tri</span>(network_Nur<span class="op">$</span>graph)], <span class="dt">method=</span><span class="st">&quot;spearman&quot;</span>))
## Correlation between Nur and IT networks: 0.7352177

<span class="kw">print</span>(<span class="st">&quot;Difference&quot;</span>)
## [1] &quot;Difference&quot;
<span class="kw">cat</span>(<span class="st">&quot;P-value for the test of identical network structure:&quot;</span>, nct_results<span class="op">$</span>nwinv.pval)
## P-value for the test of identical network structure: 0.582
<span class="kw">cat</span>(<span class="st">&quot;P-value for the test of identical connectivity in networks:&quot;</span>, nct_results<span class="op">$</span>glstrinv.pval)
## P-value for the test of identical connectivity in networks: 0.976
nct_results<span class="op">$</span>einv.pvals <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>papaja<span class="op">::</span><span class="kw">apa_table</span>(<span class="dt">caption =</span> <span class="st">&quot;p-values on difference test in edges between Nur and IT&quot;</span>)
## &lt;caption&gt;(\#tab:combinedAgreementBcts-heterogeneity-nct)&lt;/caption&gt;
## 
## &lt;caption&gt;*p-values on difference test in edges between Nur and IT*&lt;/caption&gt;
## 
## 
## 
##      Var1                                 Var2                                 p-value 
## ---  -----------------------------------  -----------------------------------  --------
## 9    PA selfrep                           Autonomous                           1.00    
## 17   PA selfrep                           goal setting                         1.00    
## 18   Autonomous                           goal setting                         1.00    
## 25   PA selfrep                           implementation plan                  1.00    
## 26   Autonomous                           implementation plan                  0.97    
## 27   goal setting                         implementation plan                  1.00    
## 33   PA selfrep                           reminder of plan                     1.00    
## 34   Autonomous                           reminder of plan                     1.00    
## 35   goal setting                         reminder of plan                     1.00    
## 36   implementation plan                  reminder of plan                     1.00    
## 41   PA selfrep                           subgoals                             1.00    
## 42   Autonomous                           subgoals                             1.00    
## 43   goal setting                         subgoals                             1.00    
## 44   implementation plan                  subgoals                             1.00    
## 45   reminder of plan                     subgoals                             1.00    
## 49   PA selfrep                           barriers identified or planned for   1.00    
## 50   Autonomous                           barriers identified or planned for   1.00    
## 51   goal setting                         barriers identified or planned for   1.00    
## 52   implementation plan                  barriers identified or planned for   1.00    
## 53   reminder of plan                     barriers identified or planned for   1.00    
## 54   subgoals                             barriers identified or planned for   1.00    
## 57   PA selfrep                           identity, life values                1.00    
## 58   Autonomous                           identity, life values                1.00    
## 59   goal setting                         identity, life values                1.00    
## 60   implementation plan                  identity, life values                1.00    
## 61   reminder of plan                     identity, life values                1.00    
## 62   subgoals                             identity, life values                0.62    
## 63   barriers identified or planned for   identity, life values                1.00

<span class="kw">cat</span>(<span class="st">&quot;Number of edges, which appear different (p&lt;0.05):&quot;</span>, <span class="kw">sum</span>(nct_results<span class="op">$</span>einv.pvals<span class="op">$</span><span class="st">&quot;p-value&quot;</span> <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.05</span>))
## Number of edges, which appear different (p&lt;0.05): 0</code></pre></div>
</div>
</div>
</div>
<div id="ising-networks" class="section level1">
<h1>Ising networks</h1>
<div id="plot-with-only-the-bcts" class="section level2">
<h2>Plot with only the BCTs</h2>
<p>Prepare and dichotomise data (lots of skew in distributions).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">nItems &lt;-<span class="st"> </span><span class="dv">19</span>

bctdf &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(id,
  intervention,
  group,
  school,
  girl,
  <span class="st">&#39;goal setting&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_01_T1,
  <span class="st">&#39;implementation plan&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_02_T1,
  <span class="st">&#39;plan by other&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_03_T1,
  <span class="st">&#39;reminder of plan&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_04_T1,
  <span class="st">&#39;subgoals&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_05_T1,
  <span class="st">&#39;new PA options&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_06_T1,
  <span class="st">&#39;barrier identification&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_07_T1,
  <span class="st">&#39;coping planning&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_08_T1,
  <span class="st">&#39;PA identity&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_09_T1,
  <span class="st">&#39;PA life values&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_10_T1,
  <span class="st">&#39;positive consequences&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_01_T1,
  <span class="st">&#39;log on paper&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_02_T1,
  <span class="st">&#39;smartphone&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_03_T1,
  <span class="st">&#39;mnemonic cues&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_04_T1,
  <span class="st">&#39;goal contrast&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_05_T1,
  <span class="st">&#39;relevance of PA&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_06_T1,
  <span class="st">&#39;changes at home&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_07_T1,
  <span class="st">&#39;social support&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_08_T1,
  <span class="st">&#39;failure contemplated&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_09_T1) <span class="op">%&gt;%</span>
<span class="st"> </span><span class="kw">mutate</span>(
  <span class="st">&#39;goal setting&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">goal setting</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
  <span class="st">&#39;implementation plan&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">implementation plan</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
  <span class="st">&#39;plan by other&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">plan by other</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
  <span class="st">&#39;reminder of plan&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">reminder of plan</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
  <span class="st">&#39;subgoals&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">subgoals</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
  <span class="st">&#39;new PA options&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">new PA options</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
  <span class="st">&#39;barrier identification&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">barrier identification</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
  <span class="st">&#39;coping planning&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">coping planning</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
  <span class="st">&#39;PA identity&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">PA identity</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
  <span class="st">&#39;PA life values&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">PA life values</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
  <span class="st">&#39;positive consequences&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">positive consequences</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
  <span class="st">&#39;log on paper&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">log on paper</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
  <span class="st">&#39;smartphone&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">smartphone</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
  <span class="st">&#39;mnemonic cues&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">mnemonic cues</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
  <span class="st">&#39;goal contrast&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">goal contrast</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
  <span class="st">&#39;relevance of PA&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">relevance of PA</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
  <span class="st">&#39;changes at home&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">changes at home</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
  <span class="st">&#39;social support&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">social support</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
  <span class="st">&#39;failure contemplated&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">failure contemplated</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>)) 

S.boys &lt;-<span class="st"> </span>bctdf <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(girl <span class="op">==</span><span class="st"> &quot;boy&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="st">`</span><span class="dt">goal setting</span><span class="st">`</span><span class="op">:</span><span class="kw">ncol</span>(bctdf)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">na.omit</span>(.) 
S.girls &lt;-<span class="st"> </span>bctdf <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(girl <span class="op">==</span><span class="st"> &quot;girl&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="st">`</span><span class="dt">goal setting</span><span class="st">`</span><span class="op">:</span><span class="kw">ncol</span>(bctdf)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">na.omit</span>(.)
nwBoys &lt;-<span class="st"> </span>bootnet<span class="op">::</span><span class="kw">estimateNetwork</span>(S.boys, <span class="dt">default=</span><span class="st">&quot;IsingFit&quot;</span>)
## 
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|</span><span class="st">                                                                 </span><span class="er">|</span><span class="st">   </span><span class="dv">0</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|===</span><span class="st">                                                              </span><span class="er">|</span><span class="st">   </span><span class="dv">5</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|=======</span><span class="st">                                                          </span><span class="er">|</span><span class="st">  </span><span class="dv">11</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|==========</span><span class="st">                                                       </span><span class="er">|</span><span class="st">  </span><span class="dv">16</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|==============</span><span class="st">                                                   </span><span class="er">|</span><span class="st">  </span><span class="dv">21</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|=================</span><span class="st">                                                </span><span class="er">|</span><span class="st">  </span><span class="dv">26</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|=====================</span><span class="st">                                            </span><span class="er">|</span><span class="st">  </span><span class="dv">32</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|========================</span><span class="st">                                         </span><span class="er">|</span><span class="st">  </span><span class="dv">37</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|===========================</span><span class="st">                                      </span><span class="er">|</span><span class="st">  </span><span class="dv">42</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|===============================</span><span class="st">                                  </span><span class="er">|</span><span class="st">  </span><span class="dv">47</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|==================================</span><span class="st">                               </span><span class="er">|</span><span class="st">  </span><span class="dv">53</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|======================================</span><span class="st">                           </span><span class="er">|</span><span class="st">  </span><span class="dv">58</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|=========================================</span><span class="st">                        </span><span class="er">|</span><span class="st">  </span><span class="dv">63</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|============================================</span><span class="st">                     </span><span class="er">|</span><span class="st">  </span><span class="dv">68</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|================================================</span><span class="st">                 </span><span class="er">|</span><span class="st">  </span><span class="dv">74</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|===================================================</span><span class="st">              </span><span class="er">|</span><span class="st">  </span><span class="dv">79</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|=======================================================</span><span class="st">          </span><span class="er">|</span><span class="st">  </span><span class="dv">84</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|==========================================================</span><span class="st">       </span><span class="er">|</span><span class="st">  </span><span class="dv">89</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|==============================================================</span><span class="st">   </span><span class="er">|</span><span class="st">  </span><span class="dv">95</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|=================================================================|</span><span class="st"> </span><span class="dv">100</span>%
nwGirls &lt;-<span class="st"> </span>bootnet<span class="op">::</span><span class="kw">estimateNetwork</span>(S.girls, <span class="dt">default=</span><span class="st">&quot;IsingFit&quot;</span>)
## 
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|</span><span class="st">                                                                 </span><span class="er">|</span><span class="st">   </span><span class="dv">0</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|===</span><span class="st">                                                              </span><span class="er">|</span><span class="st">   </span><span class="dv">5</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|=======</span><span class="st">                                                          </span><span class="er">|</span><span class="st">  </span><span class="dv">11</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|==========</span><span class="st">                                                       </span><span class="er">|</span><span class="st">  </span><span class="dv">16</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|==============</span><span class="st">                                                   </span><span class="er">|</span><span class="st">  </span><span class="dv">21</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|=================</span><span class="st">                                                </span><span class="er">|</span><span class="st">  </span><span class="dv">26</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|=====================</span><span class="st">                                            </span><span class="er">|</span><span class="st">  </span><span class="dv">32</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|========================</span><span class="st">                                         </span><span class="er">|</span><span class="st">  </span><span class="dv">37</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|===========================</span><span class="st">                                      </span><span class="er">|</span><span class="st">  </span><span class="dv">42</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|===============================</span><span class="st">                                  </span><span class="er">|</span><span class="st">  </span><span class="dv">47</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|==================================</span><span class="st">                               </span><span class="er">|</span><span class="st">  </span><span class="dv">53</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|======================================</span><span class="st">                           </span><span class="er">|</span><span class="st">  </span><span class="dv">58</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|=========================================</span><span class="st">                        </span><span class="er">|</span><span class="st">  </span><span class="dv">63</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|============================================</span><span class="st">                     </span><span class="er">|</span><span class="st">  </span><span class="dv">68</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|================================================</span><span class="st">                 </span><span class="er">|</span><span class="st">  </span><span class="dv">74</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|===================================================</span><span class="st">              </span><span class="er">|</span><span class="st">  </span><span class="dv">79</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|=======================================================</span><span class="st">          </span><span class="er">|</span><span class="st">  </span><span class="dv">84</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|==========================================================</span><span class="st">       </span><span class="er">|</span><span class="st">  </span><span class="dv">89</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|==============================================================</span><span class="st">   </span><span class="er">|</span><span class="st">  </span><span class="dv">95</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|=================================================================|</span><span class="st"> </span><span class="dv">100</span>%

<span class="co"># Create means for filling nodes</span>

girlmeans &lt;-<span class="st"> </span>bctdf <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">group_by</span>(girl) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarise_at</span>(<span class="kw">vars</span>(<span class="op">-</span>(id<span class="op">:</span>girl)),
  <span class="kw">funs</span>(<span class="kw">mean</span>(., <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(girl <span class="op">==</span><span class="st"> &quot;girl&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>girl)

boymeans &lt;-<span class="st"> </span>bctdf <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(girl) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarise_at</span>(<span class="kw">vars</span>(<span class="op">-</span>(id<span class="op">:</span>girl)),
  <span class="kw">funs</span>(<span class="kw">mean</span>(., <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(girl <span class="op">==</span><span class="st"> &quot;boy&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>girl)</code></pre></div>
</div>
<div id="plot-bct-ising-networks" class="section level2">
<h2>Plot BCT Ising-networks</h2>
<p>For girls and boys.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># Find average layout for comparability and plot graphs next to each other</span>

Layout &lt;-<span class="st"> </span>qgraph<span class="op">::</span><span class="kw">averageLayout</span>(nwGirls, nwBoys)

<span class="kw">layout</span>(<span class="kw">t</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>))

<span class="kw">plot</span>(nwGirls, <span class="dt">layout =</span> Layout, <span class="dt">label.scale =</span> <span class="ot">FALSE</span>, <span class="dt">title =</span> <span class="st">&quot;Girls&quot;</span>, <span class="dt">label.cex =</span> <span class="fl">0.75</span>,
     <span class="dt">pie =</span> girlmeans, 
     <span class="dt">color =</span> <span class="st">&quot;skyblue&quot;</span>,
     <span class="dt">pieBorder =</span> <span class="dv">1</span>)

<span class="kw">plot</span>(nwBoys, <span class="dt">layout =</span> Layout, <span class="dt">label.scale =</span> <span class="ot">FALSE</span>, <span class="dt">title =</span> <span class="st">&quot;Boys&quot;</span>, <span class="dt">label.cex =</span> <span class="fl">0.75</span>, 
     <span class="dt">pie =</span> boymeans, 
     <span class="dt">color =</span> <span class="st">&quot;skyblue&quot;</span>,
     <span class="dt">pieBorder =</span> <span class="dv">1</span>)</code></pre></div>
<p><img src="baseline-networks_files/figure-html/onlyAllBctsIsing-girlsboys-1.png" width="2100" /></p>
<p>For all participants.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
S.total &lt;-<span class="st"> </span>bctdf <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="dv">6</span><span class="op">:</span><span class="kw">ncol</span>(bctdf))
nwBCT &lt;-<span class="st"> </span>bootnet<span class="op">::</span><span class="kw">estimateNetwork</span>(S.total, <span class="dt">default=</span><span class="st">&quot;IsingFit&quot;</span>)
## 
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|</span><span class="st">                                                                 </span><span class="er">|</span><span class="st">   </span><span class="dv">0</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|===</span><span class="st">                                                              </span><span class="er">|</span><span class="st">   </span><span class="dv">5</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|=======</span><span class="st">                                                          </span><span class="er">|</span><span class="st">  </span><span class="dv">11</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|==========</span><span class="st">                                                       </span><span class="er">|</span><span class="st">  </span><span class="dv">16</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|==============</span><span class="st">                                                   </span><span class="er">|</span><span class="st">  </span><span class="dv">21</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|=================</span><span class="st">                                                </span><span class="er">|</span><span class="st">  </span><span class="dv">26</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|=====================</span><span class="st">                                            </span><span class="er">|</span><span class="st">  </span><span class="dv">32</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|========================</span><span class="st">                                         </span><span class="er">|</span><span class="st">  </span><span class="dv">37</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|===========================</span><span class="st">                                      </span><span class="er">|</span><span class="st">  </span><span class="dv">42</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|===============================</span><span class="st">                                  </span><span class="er">|</span><span class="st">  </span><span class="dv">47</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|==================================</span><span class="st">                               </span><span class="er">|</span><span class="st">  </span><span class="dv">53</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|======================================</span><span class="st">                           </span><span class="er">|</span><span class="st">  </span><span class="dv">58</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|=========================================</span><span class="st">                        </span><span class="er">|</span><span class="st">  </span><span class="dv">63</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|============================================</span><span class="st">                     </span><span class="er">|</span><span class="st">  </span><span class="dv">68</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|================================================</span><span class="st">                 </span><span class="er">|</span><span class="st">  </span><span class="dv">74</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|===================================================</span><span class="st">              </span><span class="er">|</span><span class="st">  </span><span class="dv">79</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|=======================================================</span><span class="st">          </span><span class="er">|</span><span class="st">  </span><span class="dv">84</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|==========================================================</span><span class="st">       </span><span class="er">|</span><span class="st">  </span><span class="dv">89</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|==============================================================</span><span class="st">   </span><span class="er">|</span><span class="st">  </span><span class="dv">95</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|=================================================================|</span><span class="st"> </span><span class="dv">100</span>%

<span class="co"># smallworldIndex(plot(nwBCT))</span>

<span class="co"># Create means for filling nodes</span>
piefill &lt;-<span class="st"> </span>S.total <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">summarise_all</span>(<span class="kw">funs</span>(<span class="kw">mean</span>(., <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))) 

<span class="co"># Plot network</span>
<span class="kw">plot</span>(nwBCT, <span class="dt">layout =</span> <span class="st">&quot;spring&quot;</span>, <span class="dt">label.scale =</span> <span class="ot">FALSE</span>, <span class="dt">title =</span> <span class="st">&quot;Ising fit&quot;</span>, <span class="dt">label.cex =</span> <span class="fl">0.75</span>,
     <span class="dt">pie =</span> piefill, 
     <span class="dt">color =</span> <span class="st">&quot;skyblue&quot;</span>,
     <span class="dt">pieBorder =</span> <span class="dv">1</span>)</code></pre></div>
<p><img src="baseline-networks_files/figure-html/onlyAllBctsIsing-allparticipants-1.png" width="2100" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># Estimate ising network without regularisation</span>
nwBCT_nonreg &lt;-<span class="st"> </span>bootnet<span class="op">::</span><span class="kw">estimateNetwork</span>(S.total, <span class="dt">default=</span><span class="st">&quot;IsingSampler&quot;</span>)
## 20 iterations: deviation 0.4458221

<span class="kw">plot</span>(nwBCT_nonreg, <span class="dt">layout =</span> <span class="st">&quot;spring&quot;</span>, <span class="dt">label.scale =</span> <span class="ot">FALSE</span>, <span class="dt">title =</span> <span class="st">&quot;Non-regularised Ising model&quot;</span>, <span class="dt">label.cex =</span> <span class="fl">0.75</span>,
     <span class="dt">pie =</span> piefill, 
     <span class="dt">color =</span> <span class="st">&quot;skyblue&quot;</span>,
     <span class="dt">pieBorder =</span> <span class="dv">1</span>)</code></pre></div>
<p><img src="baseline-networks_files/figure-html/onlyAllBctsIsing-allparticipants-2.png" width="2100" /></p>
</div>
<div id="ising-network-combined-items" class="section level2">
<h2>Ising network Combined items</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">nItems &lt;-<span class="st"> </span><span class="dv">17</span>

bctdf &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(id,
  intervention,
  group,
  school,
  girl,
  <span class="st">&#39;goal setting&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_01_T1,
  <span class="st">&#39;implementation plan&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_02_T1,
  <span class="st">&#39;plan by other&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_03_T1,
  <span class="st">&#39;reminder of plan&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_04_T1,
  <span class="st">&#39;subgoals&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_05_T1,
  <span class="st">&#39;new PA options&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_06_T1,
  <span class="st">&#39;barrier identification&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_07_T1,
  <span class="st">&#39;coping planning&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_08_T1,
  <span class="st">&#39;PA identity&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_09_T1,
  <span class="st">&#39;PA life values&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_10_T1,
  <span class="st">&#39;positive consequences&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_01_T1,
  <span class="st">&#39;log on paper&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_02_T1,
  <span class="st">&#39;smartphone&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_03_T1,
<span class="co">#  &#39;mnemonic cues&#39; = PA_frequencyDependentBCT_04_T1,</span>
  <span class="st">&#39;goal contrast&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_05_T1,
  <span class="st">&#39;relevance of PA&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_06_T1,
  <span class="st">&#39;changes at home&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_07_T1,
  <span class="st">&#39;social support&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_08_T1,
  <span class="st">&#39;failure contemplated&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_09_T1) <span class="op">%&gt;%</span>
<span class="st"> </span><span class="kw">mutate</span>(
  <span class="st">&#39;goal setting&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">goal setting</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
  <span class="st">&#39;implementation plan&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">implementation plan</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span> <span class="op">&amp;</span><span class="st"> `</span><span class="dt">plan by other</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
  <span class="st">&#39;reminder of plan&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">reminder of plan</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
  <span class="st">&#39;subgoals&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">subgoals</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
  <span class="st">&#39;new PA options&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">new PA options</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
  <span class="st">&#39;barrier identification&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">barrier identification</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
  <span class="st">&#39;coping planning&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">coping planning</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
  <span class="st">&#39;PA identity&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">PA identity</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
  <span class="st">&#39;PA life values&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">PA life values</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
  <span class="st">&#39;positive consequences&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">positive consequences</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
  <span class="st">&#39;monitored PA&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">log on paper</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span> <span class="op">&amp;</span><span class="st"> `</span><span class="dt">smartphone</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
<span class="co">#  &#39;mnemonic cues&#39; = ifelse(`mnemonic cues` == 1, 0, 1),</span>
  <span class="st">&#39;goal contrast&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">goal contrast</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
  <span class="st">&#39;relevance of PA&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">relevance of PA</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
  <span class="st">&#39;changes at home&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">changes at home</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
  <span class="st">&#39;social support&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">social support</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
  <span class="st">&#39;failure contemplated&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">failure contemplated</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>)) <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span><span class="st">`</span><span class="dt">log on paper</span><span class="st">`</span>, <span class="op">-</span><span class="st">`</span><span class="dt">smartphone</span><span class="st">`</span>, <span class="op">-</span><span class="st">`</span><span class="dt">plan by other</span><span class="st">`</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate_all</span>(as.numeric)

<span class="co"># Network for all participants</span>

S.total &lt;-<span class="st"> </span>bctdf <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="dv">6</span><span class="op">:</span><span class="kw">ncol</span>(bctdf))
nwBCT &lt;-<span class="st"> </span>bootnet<span class="op">::</span><span class="kw">estimateNetwork</span>(S.total, <span class="dt">default=</span><span class="st">&quot;IsingFit&quot;</span>)
## 
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|</span><span class="st">                                                                 </span><span class="er">|</span><span class="st">   </span><span class="dv">0</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|====</span><span class="st">                                                             </span><span class="er">|</span><span class="st">   </span><span class="dv">6</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|========</span><span class="st">                                                         </span><span class="er">|</span><span class="st">  </span><span class="dv">12</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|============</span><span class="st">                                                     </span><span class="er">|</span><span class="st">  </span><span class="dv">19</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|================</span><span class="st">                                                 </span><span class="er">|</span><span class="st">  </span><span class="dv">25</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|====================</span><span class="st">                                             </span><span class="er">|</span><span class="st">  </span><span class="dv">31</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|========================</span><span class="st">                                         </span><span class="er">|</span><span class="st">  </span><span class="dv">38</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|============================</span><span class="st">                                     </span><span class="er">|</span><span class="st">  </span><span class="dv">44</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|================================</span><span class="st">                                 </span><span class="er">|</span><span class="st">  </span><span class="dv">50</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|=====================================</span><span class="st">                            </span><span class="er">|</span><span class="st">  </span><span class="dv">56</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|=========================================</span><span class="st">                        </span><span class="er">|</span><span class="st">  </span><span class="dv">62</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|=============================================</span><span class="st">                    </span><span class="er">|</span><span class="st">  </span><span class="dv">69</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|=================================================</span><span class="st">                </span><span class="er">|</span><span class="st">  </span><span class="dv">75</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|=====================================================</span><span class="st">            </span><span class="er">|</span><span class="st">  </span><span class="dv">81</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|=========================================================</span><span class="st">        </span><span class="er">|</span><span class="st">  </span><span class="dv">88</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|=============================================================</span><span class="st">    </span><span class="er">|</span><span class="st">  </span><span class="dv">94</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|=================================================================|</span><span class="st"> </span><span class="dv">100</span>%

<span class="co"># Create means for filling nodes</span>
piefill &lt;-<span class="st"> </span>S.total <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">summarise_all</span>(<span class="kw">funs</span>(<span class="kw">mean</span>(., <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))) 

<span class="co"># Plot network</span>
<span class="kw">plot</span>(nwBCT, <span class="dt">layout =</span> <span class="st">&quot;spring&quot;</span>, <span class="dt">label.scale =</span> <span class="ot">FALSE</span>, <span class="dt">title =</span> <span class="st">&quot;Ising fit&quot;</span>, <span class="dt">label.cex =</span> <span class="fl">0.75</span>,
     <span class="dt">pie =</span> piefill, 
     <span class="dt">color =</span> <span class="st">&quot;skyblue&quot;</span>,
     <span class="dt">pieBorder =</span> <span class="dv">1</span>)</code></pre></div>
<p><img src="baseline-networks_files/figure-html/onlyCombinedBctsIsing-dataprep-1.png" width="2100" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># # Estimate ising network without regularisation</span>
<span class="co"># nwBCT_nonreg &lt;- bootnet::estimateNetwork(S.total, default=&quot;IsingSampler&quot;)</span>
<span class="co"># </span>
<span class="co"># plot(nwBCT_nonreg, layout = &quot;spring&quot;, label.scale = FALSE, title = &quot;Non-regularised Ising model&quot;, label.cex = 0.75,</span>
<span class="co">#      pie = piefill, </span>
<span class="co">#      color = &quot;skyblue&quot;,</span>
<span class="co">#      pieBorder = 1)</span></code></pre></div>
<div id="centrality-and-stability-3" class="section level4">
<h4>Centrality and stability</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
onlyCombinedBctsIsing &lt;-<span class="st"> </span>nwBCT_ggm

onlyCombinedBctsIsing_centralityPlot &lt;-<span class="st"> </span>qgraph<span class="op">::</span><span class="kw">centralityPlot</span>(onlyCombinedBctsIsing)</code></pre></div>
<p><img src="baseline-networks_files/figure-html/onlyCombinedBctsIsing-stability-1.png" width="2100" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
qgraph<span class="op">::</span><span class="kw">centrality</span>(onlyCombinedBctsIsing)<span class="op">$</span>InDegree
##                 MVPA questionnaire                 MVPA accelerometer 
##                          0.6769779                          0.3541074 
##              autonomous motivation              controlled motivation 
##                          0.9793448                          0.2717677 
##                       goal setting                implementation plan 
##                          1.1445721                          1.1484466 
##                      plan by other                   reminder of plan 
##                          0.8488461                          1.2128394 
##                           subgoals                     new PA options 
##                          1.0623181                          0.8947819 
##              positive consequences                      goal contrast 
##                          0.8190386                          1.1789647 
##                    relevance of PA                    changes at home 
##                          1.2348846                          1.0649650 
##                     social support barriers identified or planned for 
##                          0.9056452                          0.9601613 
##              identity, life values                      monitoring PA 
##                          0.8727105                          0.7297635
<span class="kw">scale</span>(qgraph<span class="op">::</span><span class="kw">centrality</span>(onlyCombinedBctsIsing)<span class="op">$</span>InDegree)
##                                           [,1]
## MVPA questionnaire                 -0.85431734
## MVPA accelerometer                 -2.04367393
## autonomous motivation               0.25951029
## controlled motivation              -2.34698852
## goal setting                        0.86815765
## implementation plan                 0.88243002
## plan by other                      -0.22120719
## reminder of plan                    1.11963350
## subgoals                            0.56515890
## new PA options                     -0.05199363
## positive consequences              -0.33100903
## goal contrast                       0.99484959
## relevance of PA                     1.20084152
## changes at home                     0.57490938
## social support                     -0.01197632
## barriers identified or planned for  0.18884443
## identity, life values              -0.13329807
## monitoring PA                      -0.65987124
## attr(,&quot;scaled:center&quot;)
## [1] 0.9088964
## attr(,&quot;scaled:scale&quot;)
## [1] 0.2714665
qgraph<span class="op">::</span><span class="kw">centrality</span>(onlyCombinedBctsIsing)<span class="op">$</span>Closeness
##                 MVPA questionnaire                 MVPA accelerometer 
##                        0.004091400                        0.002899362 
##              autonomous motivation              controlled motivation 
##                        0.004777696                        0.002757269 
##                       goal setting                implementation plan 
##                        0.004350918                        0.004427995 
##                      plan by other                   reminder of plan 
##                        0.004706423                        0.005427860 
##                           subgoals                     new PA options 
##                        0.004798501                        0.004395482 
##              positive consequences                      goal contrast 
##                        0.004587904                        0.004940930 
##                    relevance of PA                    changes at home 
##                        0.005243076                        0.004372698 
##                     social support barriers identified or planned for 
##                        0.004000066                        0.004345481 
##              identity, life values                      monitoring PA 
##                        0.004611093                        0.005049552
qgraph<span class="op">::</span><span class="kw">centrality</span>(onlyCombinedBctsIsing)<span class="op">$</span>Betweenness
##                 MVPA questionnaire                 MVPA accelerometer 
##                                 34                                  0 
##              autonomous motivation              controlled motivation 
##                                 36                                  0 
##                       goal setting                implementation plan 
##                                 14                                 18 
##                      plan by other                   reminder of plan 
##                                 20                                 50 
##                           subgoals                     new PA options 
##                                 24                                  0 
##              positive consequences                      goal contrast 
##                                  6                                 20 
##                    relevance of PA                    changes at home 
##                                 56                                 24 
##                     social support barriers identified or planned for 
##                                 24                                 14 
##              identity, life values                      monitoring PA 
##                                 16                                 30

<span class="kw">cor</span>(qgraph<span class="op">::</span><span class="kw">centrality</span>(onlyCombinedBctsIsing)<span class="op">$</span>InDegree, qgraph<span class="op">::</span><span class="kw">centrality</span>(onlyCombinedBctsIsing)<span class="op">$</span>Betweenness, 
    <span class="dt">method =</span> <span class="st">&quot;spearman&quot;</span>) 
## [1] 0.4678486

<span class="co"># bootnet_stability_onlyCombinedBctsIsing &lt;- bootnet::bootnet(onlyCombinedBctsIsing, nBoots=1000)</span>
<span class="co"># save(bootnet_stability_onlyCombinedBctsIsing, file = &quot;./Rdata_files/bootnet_stability_onlyCombinedBctsIsing.Rdata&quot;)</span>
<span class="kw">load</span>(<span class="st">&quot;./Rdata_files/bootnet_stability_onlyCombinedBctsIsing.Rdata&quot;</span>)

<span class="kw">plot</span>(bootnet_stability_onlyCombinedBctsIsing, <span class="dt">labels =</span> <span class="ot">FALSE</span>, <span class="dt">order =</span> <span class="st">&quot;sample&quot;</span>) </code></pre></div>
<p><img src="baseline-networks_files/figure-html/onlyCombinedBctsIsing-stability-2.png" width="2100" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(bootnet_stability_onlyCombinedBctsIsing, <span class="dt">labels =</span> <span class="ot">FALSE</span>, <span class="st">&quot;edge&quot;</span>, <span class="dt">plot =</span> <span class="st">&quot;difference&quot;</span>, <span class="dt">onlyNonZero =</span> <span class="ot">TRUE</span>, <span class="dt">order =</span> <span class="st">&quot;sample&quot;</span>)</code></pre></div>
<p><img src="baseline-networks_files/figure-html/onlyCombinedBctsIsing-stability-3.png" width="2100" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># bootnet_centrality_stability_onlyCombinedBctsIsing &lt;- bootnet::bootnet(onlyCombinedBctsIsing, nBoots=1000,nCores=8, type=&quot;case&quot;)</span>
<span class="co"># save(bootnet_centrality_stability_onlyCombinedBctsIsing, file = &quot;./Rdata_files/bootnet_centrality_stability_onlyCombinedBctsIsing.Rdata&quot;)</span>
<span class="kw">load</span>(<span class="st">&quot;./Rdata_files/bootnet_centrality_stability_onlyCombinedBctsIsing.Rdata&quot;</span>)

<span class="kw">plot</span>(bootnet_centrality_stability_onlyCombinedBctsIsing)</code></pre></div>
<p><img src="baseline-networks_files/figure-html/onlyCombinedBctsIsing-stability-4.png" width="2100" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(bootnet_centrality_stability_onlyCombinedBctsIsing, <span class="dt">perNode=</span>T, <span class="st">&quot;strength&quot;</span>)</code></pre></div>
<p><img src="baseline-networks_files/figure-html/onlyCombinedBctsIsing-stability-5.png" width="2100" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
bootnet<span class="op">::</span><span class="kw">corStability</span>(bootnet_centrality_stability_onlyCombinedBctsIsing)
## === Correlation Stability Analysis === 
## 
## Sampling levels tested:
##    nPerson Drop%   n
## 1      291  75.0 130
## 2      382  67.2  83
## 3      472  59.5  98
## 4      563  51.7  94
## 5      654  43.9  98
## 6      744  36.1 111
## 7      835  28.3 102
## 8      926  20.5  94
## 9     1016  12.8  86
## 10    1107   5.0 104
## 
## Maximum drop proportions to retain correlation of 0.7 in at least 95% of the samples:
## 
## betweenness: 0.361
##   - For more accuracy, run bootnet(..., caseMin = 0.283, caseMax = 0.439) 
## 
## closeness: 0.75
##   - For more accuracy, run bootnet(..., caseMin = 0.672, caseMax = 1) 
## 
## strength: 0.75
##   - For more accuracy, run bootnet(..., caseMin = 0.672, caseMax = 1) 
## 
## Accuracy can also be increased by increasing both &#39;nBoots&#39; and &#39;caseN&#39;.</code></pre></div>
</div>
<div id="network-comparison-test-boys-vs.girls" class="section level4">
<h4>Network comparison test: boys vs. girls</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
nct_results &lt;-<span class="st"> </span>NetworkComparisonTest<span class="op">::</span><span class="kw">NCT</span>(nwGirls, nwBoys, <span class="dt">it=</span><span class="dv">1000</span>, <span class="dt">binary.data=</span><span class="ot">TRUE</span>, <span class="dt">paired=</span><span class="ot">FALSE</span>, <span class="dt">test.edges=</span><span class="ot">TRUE</span>, <span class="dt">edges=</span><span class="st">&#39;all&#39;</span>, <span class="dt">progressbar=</span><span class="ot">TRUE</span>)

nct_results<span class="op">$</span>nwinv.pval  <span class="co"># p value of network structure diff test: 0.424</span>
nct_results<span class="op">$</span>glstrinv.pval  <span class="co"># p value of global connectivity diff test: 0.071</span>
nct_results<span class="op">$</span>einv.pvals     <span class="co">#p values testing diffs for all individual edges: lowest p-value 0.017, most = 1</span>
<span class="kw">sum</span>(nct_results<span class="op">$</span>einv.pvals<span class="op">$</span><span class="st">&quot;p-value&quot;</span> <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.05</span>)  <span class="co"># how many edges are different0</span></code></pre></div>
</div>
<div id="ggm-bcts-motivation" class="section level3">
<h3>GGM BCTs &amp; motivation</h3>
<p>The pie on nodes represents the median, as proportion of the theoretical maximum value (i.e. highest value on the questionnaire scale).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(corrgram)

nItems &lt;-<span class="st"> </span><span class="dv">19</span>

bctdf &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(id,
  intervention,
  group,
  school,
  girl,
  <span class="st">&#39;Autonomous&#39;</span> =<span class="st"> </span>PA_autonomous_T1,
  <span class="st">&#39;Controlled&#39;</span> =<span class="st"> </span>PA_controlled_T1,
  <span class="st">&#39;goal setting&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_01_T1,
  <span class="st">&#39;implementation plan&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_02_T1,
  <span class="st">&#39;plan by other&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_03_T1,
  <span class="st">&#39;reminder of plan&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_04_T1,
  <span class="st">&#39;subgoals&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_05_T1,
  <span class="st">&#39;new PA options&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_06_T1,
  <span class="st">&#39;barrier identification&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_07_T1,
  <span class="st">&#39;coping planning&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_08_T1,
  <span class="st">&#39;PA identity&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_09_T1,
  <span class="st">&#39;PA life values&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_10_T1,
  <span class="st">&#39;positive consequences&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_01_T1,
  <span class="st">&#39;log on paper&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_02_T1,
  <span class="st">&#39;smartphone&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_03_T1,
<span class="co">#  &#39;mnemonic cues&#39; = PA_frequencyDependentBCT_04_T1,</span>
  <span class="st">&#39;goal contrast&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_05_T1,
  <span class="st">&#39;relevance of PA&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_06_T1,
  <span class="st">&#39;changes at home&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_07_T1,
  <span class="st">&#39;social support&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_08_T1,
  <span class="st">&#39;failure contemplated&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_09_T1) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">rowwise</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>( 
  <span class="co">#&#39;has plan&#39; = mean(c(`implementation plan`, `plan by other`), na.rm = TRUE),</span>
  <span class="st">&#39;monitored PA&#39;</span> =<span class="st"> </span><span class="kw">mean</span>(<span class="kw">c</span>(<span class="st">`</span><span class="dt">log on paper</span><span class="st">`</span>, <span class="st">`</span><span class="dt">smartphone</span><span class="st">`</span>), <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)) <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span><span class="st">`</span><span class="dt">log on paper</span><span class="st">`</span>, <span class="op">-</span><span class="st">`</span><span class="dt">smartphone</span><span class="st">`</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate_all</span>(as.numeric)

<span class="co"># Network for all participants</span>

S.total &lt;-<span class="st"> </span>bctdf <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="st">`</span><span class="dt">Autonomous</span><span class="st">`</span><span class="op">:</span><span class="kw">ncol</span>(bctdf))
nwBCT &lt;-<span class="st"> </span>bootnet<span class="op">::</span><span class="kw">estimateNetwork</span>(S.total, <span class="dt">default=</span><span class="st">&quot;EBICglasso&quot;</span>)

<span class="co"># Plot correlations (minmax crowds the diagonal as it plots the minimum and maximum values for each variable).</span>
labs &lt;-<span class="st"> </span><span class="kw">colnames</span>(S.total)
corrgram<span class="op">::</span><span class="kw">corrgram</span>(S.total, 
         <span class="dt">cor.method =</span> <span class="st">&quot;spearman&quot;</span>, 
         <span class="co"># diag.panel=panel.minmax, </span>
         <span class="co"># lower.panel=panel.shade, </span>
         <span class="co"># lower.panel=panel.ellipse,</span>
         <span class="co"># lower.panel=panel.cor,</span>
         <span class="dt">upper.panel=</span>corrgram<span class="op">::</span>panel.conf,
         <span class="dt">lower.panel=</span>corrgram<span class="op">::</span>panel.conf,
         <span class="dt">outer.labels=</span><span class="kw">list</span>(
           <span class="dt">bottom=</span><span class="kw">list</span>(<span class="dt">labels=</span>labs,<span class="dt">cex=</span>.<span class="dv">75</span>, <span class="dt">srt=</span><span class="dv">60</span>),
           <span class="dt">left=</span><span class="kw">list</span>(<span class="dt">labels=</span>labs,<span class="dt">cex=</span>.<span class="dv">75</span>, <span class="dt">srt=</span><span class="dv">30</span>))
         )</code></pre></div>
<p><img src="baseline-networks_files/figure-html/bct-moti-ggm-noncombined-1.png" width="2100" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># Create means for filling nodes</span>
piefill &lt;-<span class="st"> </span>S.total <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>Autonomous, <span class="op">-</span>Controlled) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">data.frame</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarise_all</span>(<span class="kw">funs</span>(<span class="kw">mean</span>(., <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">/</span><span class="st"> </span><span class="dv">6</span>)) 

piefill<span class="op">$</span>Autonomous &lt;-<span class="st"> </span><span class="kw">median</span>(S.total<span class="op">$</span>Autonomous, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">/</span><span class="st"> </span><span class="dv">5</span>
piefill<span class="op">$</span>Controlled &lt;-<span class="st"> </span><span class="kw">median</span>(S.total<span class="op">$</span>Controlled, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">/</span><span class="st"> </span><span class="dv">5</span>

piefill &lt;-<span class="st"> </span>piefill <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(Autonomous, Controlled, <span class="kw">everything</span>())

<span class="co"># Plot network</span>
<span class="kw">plot</span>(nwBCT, <span class="dt">layout =</span> <span class="st">&quot;spring&quot;</span>, <span class="dt">label.scale =</span> <span class="ot">FALSE</span>, <span class="dt">title =</span> <span class="st">&quot;GGM: BCTs &amp; motivation&quot;</span>, <span class="dt">label.cex =</span> <span class="fl">0.75</span>,
     <span class="dt">pie =</span> piefill, 
     <span class="dt">color =</span> <span class="st">&quot;skyblue&quot;</span>,
     <span class="dt">pieBorder =</span> <span class="dv">1</span>)</code></pre></div>
<p><img src="baseline-networks_files/figure-html/bct-moti-ggm-noncombined-2.png" width="2100" /></p>
<p>Network after combining goal setting and implementation planning, as well as barrier identification and coping planning:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Combine items further:</span>
bctdf2 &lt;-<span class="st"> </span>bctdf <span class="op">%&gt;%</span><span class="st"> </span>rowwise <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="st">&#39;goals and plans&#39;</span> =<span class="st"> </span><span class="kw">mean</span>(<span class="kw">c</span>(<span class="st">`</span><span class="dt">goal setting</span><span class="st">`</span>, <span class="st">`</span><span class="dt">implementation plan</span><span class="st">`</span>), <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="st">&#39;barriers identified</span><span class="ch">\n</span><span class="st">and planned for&#39;</span> =<span class="st"> </span><span class="kw">mean</span>(<span class="kw">c</span>(<span class="st">`</span><span class="dt">barrier identification</span><span class="st">`</span>, <span class="st">`</span><span class="dt">coping planning</span><span class="st">`</span>), <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span><span class="st">`</span><span class="dt">goal setting</span><span class="st">`</span>, <span class="op">-</span><span class="st">`</span><span class="dt">implementation plan</span><span class="st">`</span>, <span class="op">-</span><span class="st">`</span><span class="dt">barrier identification</span><span class="st">`</span>, <span class="op">-</span><span class="st">`</span><span class="dt">coping planning</span><span class="st">`</span>)

S.total2 &lt;-<span class="st"> </span>bctdf2 <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="st">`</span><span class="dt">Autonomous</span><span class="st">`</span><span class="op">:</span><span class="kw">ncol</span>(bctdf2))
nwBCT2 &lt;-<span class="st"> </span>bootnet<span class="op">::</span><span class="kw">estimateNetwork</span>(S.total2, <span class="dt">default=</span><span class="st">&quot;EBICglasso&quot;</span>)

<span class="co"># Create means for filling nodes</span>
piefill2 &lt;-<span class="st"> </span>S.total2 <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>Autonomous, <span class="op">-</span>Controlled) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">data.frame</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarise_all</span>(<span class="kw">funs</span>(<span class="kw">median</span>(., <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">/</span><span class="st"> </span><span class="dv">6</span>)) 

piefill2<span class="op">$</span>Autonomous &lt;-<span class="st"> </span><span class="kw">median</span>(S.total<span class="op">$</span>Autonomous, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">/</span><span class="st"> </span><span class="dv">5</span>
piefill2<span class="op">$</span>Controlled &lt;-<span class="st"> </span><span class="kw">median</span>(S.total<span class="op">$</span>Controlled, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">/</span><span class="st"> </span><span class="dv">5</span>

piefill2 &lt;-<span class="st"> </span>piefill2 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(Autonomous, Controlled, <span class="kw">everything</span>())

<span class="co"># Plot network</span>
<span class="kw">plot</span>(nwBCT2, <span class="dt">layout =</span> <span class="st">&quot;spring&quot;</span>, <span class="dt">label.scale =</span> <span class="ot">FALSE</span>, <span class="dt">title =</span> <span class="st">&quot;GGM, BCTs &amp; motivation, items combined&quot;</span>, <span class="dt">label.cex =</span> <span class="fl">0.75</span>,
     <span class="dt">pie =</span> piefill2, 
     <span class="dt">color =</span> <span class="st">&quot;skyblue&quot;</span>,
     <span class="dt">pieBorder =</span> <span class="dv">1</span>)</code></pre></div>
<p><img src="baseline-networks_files/figure-html/bct-moti-ggm-combined-1.png" width="2100" /></p>
<div id="stability-and-robustness" class="section level4">
<h4>Stability and robustness</h4>
<p>Robustness test</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>(<span class="st">&quot;Original items:&quot;</span>)
## [1] &quot;Original items:&quot;
qgraph<span class="op">::</span><span class="kw">centralityPlot</span>(nwBCT)</code></pre></div>
<p><img src="baseline-networks_files/figure-html/bct-robustness-1.png" width="2100" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="kw">print</span>(<span class="st">&quot;Combined items:&quot;</span>)
## [1] &quot;Combined items:&quot;
qgraph<span class="op">::</span><span class="kw">centralityPlot</span>(nwBCT2)</code></pre></div>
<p><img src="baseline-networks_files/figure-html/bct-robustness-2.png" width="2100" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># BCTboot1 &lt;- bootnet::bootnet(nwBCT, nBoots = 2500)</span>
<span class="co"># BCTboot2 &lt;- bootnet::bootnet(nwBCT2, nBoots = 2500)</span>
<span class="co"># save(BCTboot1, file = &quot;./Rdata_files/BCTboot1.Rdata&quot;)</span>
<span class="co"># save(BCTboot2, file = &quot;./Rdata_files/BCTboot2.Rdata&quot;)</span>

<span class="kw">load</span>(<span class="st">&quot;./Rdata_files/BCTboot1.Rdata&quot;</span>)
<span class="kw">load</span>(<span class="st">&quot;./Rdata_files/BCTboot2.Rdata&quot;</span>)

<span class="kw">print</span>(<span class="st">&quot;Original items:&quot;</span>)
## [1] &quot;Original items:&quot;
<span class="kw">plot</span>(BCTboot1, <span class="dt">labels =</span> <span class="ot">FALSE</span>, <span class="dt">order =</span> <span class="st">&quot;sample&quot;</span>)</code></pre></div>
<p><img src="baseline-networks_files/figure-html/bct-robustness-3.png" width="2100" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="kw">print</span>(<span class="st">&quot;Combined items:&quot;</span>)
## [1] &quot;Combined items:&quot;
<span class="kw">plot</span>(BCTboot2, <span class="dt">labels =</span> <span class="ot">FALSE</span>, <span class="dt">order =</span> <span class="st">&quot;sample&quot;</span>)</code></pre></div>
<p><img src="baseline-networks_files/figure-html/bct-robustness-4.png" width="2100" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
autEdges &lt;-<span class="st"> </span><span class="kw">summary</span>(BCTboot1, <span class="dt">statistics =</span> <span class="st">&quot;edge&quot;</span>, <span class="dt">rank =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">arrange</span>(mean) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(stringr<span class="op">::</span><span class="kw">str_detect</span>(node1, <span class="st">&#39;Autonomous&#39;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># str_detect(id, &#39;Autonomous|Controlled&#39;) for both</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="op">!</span>(node2 <span class="op">==</span><span class="st"> &#39;Controlled&#39;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">data.frame</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(CIlower, mean, CIupper, node2)

contEdges &lt;-<span class="st"> </span><span class="kw">summary</span>(BCTboot1, <span class="dt">statistics =</span> <span class="st">&quot;edge&quot;</span>, <span class="dt">rank =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">arrange</span>(mean) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(stringr<span class="op">::</span><span class="kw">str_detect</span>(node1, <span class="st">&#39;Controlled&#39;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># str_detect(id, &#39;Autonomous|Controlled&#39;) for both</span>
<span class="st">  </span><span class="kw">data.frame</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(CIlower, mean, CIupper, node2)

userfriendlyscience<span class="op">::</span><span class="kw">diamondPlot</span>(autEdges, 
            <span class="dt">ciCols =</span> <span class="kw">c</span>(<span class="st">&quot;CIlower&quot;</span>, <span class="st">&quot;mean&quot;</span>, <span class="st">&quot;CIupper&quot;</span>), 
            <span class="dt">color =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">2</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">1</span>], 
            <span class="dt">alpha =</span> <span class="fl">0.3</span>, 
            <span class="dt">yLabels =</span> autEdges<span class="op">$</span>node2, 
            <span class="dt">fixedSize =</span> <span class="fl">0.3</span>, 
            <span class="dt">xlab =</span> <span class="ot">NULL</span>) <span class="op">+</span>
<span class="st">  </span>userfriendlyscience<span class="op">::</span><span class="kw">diamondPlot</span>(contEdges, 
              <span class="dt">ciCols =</span> <span class="kw">c</span>(<span class="st">&quot;CIlower&quot;</span>, <span class="st">&quot;mean&quot;</span>, <span class="st">&quot;CIupper&quot;</span>), 
              <span class="dt">color =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">2</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">2</span>], 
              <span class="dt">alpha =</span> <span class="fl">0.3</span>, 
              <span class="dt">yLabels =</span> autEdges<span class="op">$</span>node2, 
              <span class="dt">fixedSize =</span> <span class="fl">0.3</span>, 
              <span class="dt">xlab =</span> <span class="ot">NULL</span>, 
              <span class="dt">returnLayerOnly =</span> <span class="ot">TRUE</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_rect</span>(<span class="kw">aes</span>(<span class="dt">xmin=</span><span class="ot">Inf</span>, <span class="dt">xmax=</span><span class="ot">Inf</span>, <span class="dt">ymin=</span><span class="ot">Inf</span>, <span class="dt">ymax=</span><span class="ot">Inf</span>, <span class="dt">fill =</span> <span class="st">&quot;Controlled&quot;</span>), 
            <span class="dt">colour=</span><span class="ot">NA</span>, <span class="dt">alpha=</span><span class="fl">0.05</span>) <span class="op">+</span><span class="st"> </span><span class="co"># Create invisible rectangle for legend</span>
<span class="st">  </span><span class="kw">geom_rect</span>(<span class="kw">aes</span>(<span class="dt">xmin=</span><span class="ot">Inf</span>, <span class="dt">xmax=</span><span class="ot">Inf</span>, <span class="dt">ymin=</span><span class="ot">Inf</span>, <span class="dt">ymax=</span><span class="ot">Inf</span>, <span class="dt">fill =</span> <span class="st">&quot;Autonomous&quot;</span>), 
            <span class="dt">colour=</span><span class="ot">NA</span>, <span class="dt">alpha=</span><span class="fl">0.05</span>) <span class="op">+</span><span class="st"> </span><span class="co"># Create invisible rectangle for legend</span>
<span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="st">&#39;Connected node&#39;</span>,
                      <span class="dt">values =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">2</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>],  
                      <span class="dt">guide =</span> <span class="kw">guide_legend</span>(<span class="dt">override.aes =</span> <span class="kw">list</span>(<span class="dt">alpha =</span> <span class="dv">1</span>))) <span class="op">+</span>
<span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Relative strengths of edges containing autonomous </span><span class="ch">\n</span><span class="st">or controlled motivation (model with all items)&quot;</span>)</code></pre></div>
<p><img src="baseline-networks_files/figure-html/bct-robustness-5.png" width="2100" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">  
<span class="co"># Combined items</span>

autEdges &lt;-<span class="st"> </span><span class="kw">summary</span>(BCTboot2, <span class="dt">statistics =</span> <span class="st">&quot;edge&quot;</span>, <span class="dt">rank =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">arrange</span>(mean) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(stringr<span class="op">::</span><span class="kw">str_detect</span>(node1, <span class="st">&#39;Autonomous&#39;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># str_detect(id, &#39;Autonomous|Controlled&#39;) for both</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="op">!</span>(node2 <span class="op">==</span><span class="st"> &#39;Controlled&#39;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">data.frame</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(CIlower, mean, CIupper, node2)

contEdges &lt;-<span class="st"> </span><span class="kw">summary</span>(BCTboot2, <span class="dt">statistics =</span> <span class="st">&quot;edge&quot;</span>, <span class="dt">rank =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">arrange</span>(mean) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(stringr<span class="op">::</span><span class="kw">str_detect</span>(node1, <span class="st">&#39;Controlled&#39;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># str_detect(id, &#39;Autonomous|Controlled&#39;) for both</span>
<span class="st">  </span><span class="kw">data.frame</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(CIlower, mean, CIupper, node2)

userfriendlyscience<span class="op">::</span><span class="kw">diamondPlot</span>(autEdges, 
            <span class="dt">ciCols =</span> <span class="kw">c</span>(<span class="st">&quot;CIlower&quot;</span>, <span class="st">&quot;mean&quot;</span>, <span class="st">&quot;CIupper&quot;</span>), 
            <span class="dt">color =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">2</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">1</span>], 
            <span class="dt">alpha =</span> <span class="fl">0.3</span>, 
            <span class="dt">yLabels =</span> autEdges<span class="op">$</span>node2, 
            <span class="dt">fixedSize =</span> <span class="fl">0.3</span>, 
            <span class="dt">xlab =</span> <span class="ot">NULL</span>) <span class="op">+</span>
<span class="st">  </span>userfriendlyscience<span class="op">::</span><span class="kw">diamondPlot</span>(contEdges, 
              <span class="dt">ciCols =</span> <span class="kw">c</span>(<span class="st">&quot;CIlower&quot;</span>, <span class="st">&quot;mean&quot;</span>, <span class="st">&quot;CIupper&quot;</span>), 
              <span class="dt">color =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">2</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">2</span>], 
              <span class="dt">alpha =</span> <span class="fl">0.3</span>, 
              <span class="dt">yLabels =</span> autEdges<span class="op">$</span>node2, 
              <span class="dt">fixedSize =</span> <span class="fl">0.3</span>, 
              <span class="dt">xlab =</span> <span class="ot">NULL</span>, 
              <span class="dt">returnLayerOnly =</span> <span class="ot">TRUE</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_rect</span>(<span class="kw">aes</span>(<span class="dt">xmin=</span><span class="ot">Inf</span>, <span class="dt">xmax=</span><span class="ot">Inf</span>, <span class="dt">ymin=</span><span class="ot">Inf</span>, <span class="dt">ymax=</span><span class="ot">Inf</span>, <span class="dt">fill =</span> <span class="st">&quot;Controlled&quot;</span>), 
            <span class="dt">colour=</span><span class="ot">NA</span>, <span class="dt">alpha=</span><span class="fl">0.05</span>) <span class="op">+</span><span class="st"> </span><span class="co"># Create invisible rectangle for legend</span>
<span class="st">  </span><span class="kw">geom_rect</span>(<span class="kw">aes</span>(<span class="dt">xmin=</span><span class="ot">Inf</span>, <span class="dt">xmax=</span><span class="ot">Inf</span>, <span class="dt">ymin=</span><span class="ot">Inf</span>, <span class="dt">ymax=</span><span class="ot">Inf</span>, <span class="dt">fill =</span> <span class="st">&quot;Autonomous&quot;</span>), 
            <span class="dt">colour=</span><span class="ot">NA</span>, <span class="dt">alpha=</span><span class="fl">0.05</span>) <span class="op">+</span><span class="st"> </span><span class="co"># Create invisible rectangle for legend</span>
<span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="st">&#39;Connected node&#39;</span>,
                      <span class="dt">values =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">2</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>],  
                      <span class="dt">guide =</span> <span class="kw">guide_legend</span>(<span class="dt">override.aes =</span> <span class="kw">list</span>(<span class="dt">alpha =</span> <span class="dv">1</span>))) <span class="op">+</span>
<span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Relative strengths of edges containing autonomous </span><span class="ch">\n</span><span class="st">or controlled motivation (model with combined items)&quot;</span>)</code></pre></div>
<p><img src="baseline-networks_files/figure-html/bct-robustness-6.png" width="2100" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># summary(BCTboot1, statistics = &quot;edge&quot;, rank = TRUE) %&gt;% </span>
<span class="co">#   dplyr::arrange(mean) %&gt;% </span>
<span class="co">#   dplyr::filter(stringr::str_detect(id, &#39;Controlled&#39;)) %&gt;%</span>
<span class="co">#   data.frame() %&gt;% </span>
<span class="co">#   dplyr::select(CIlower, mean, CIupper, id) %&gt;% </span>
<span class="co">#   userfriendlyscience::diamondPlot(ciCols = c(&quot;CIlower&quot;, &quot;mean&quot;, &quot;CIupper&quot;), ylabels = id)</span></code></pre></div>
</div>
<div id="add-accelerometer-measured-mvpa" class="section level4">
<h4>Add accelerometer-measured MVPA</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
nItems_PA &lt;-<span class="st"> </span><span class="dv">20</span>

bctdf_PA &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(id,
  intervention,
  group,
  school,
  girl,
  <span class="st">&#39;MVPA&#39;</span> =<span class="st"> </span>mvpaAccelerometer_T1,
  <span class="st">&#39;Autonomous&#39;</span> =<span class="st"> </span>PA_autonomous_T1,
  <span class="st">&#39;Controlled&#39;</span> =<span class="st"> </span>PA_controlled_T1,
  <span class="st">&#39;goal setting&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_01_T1,
  <span class="st">&#39;implementation plan&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_02_T1,
  <span class="st">&#39;plan by other&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_03_T1,
  <span class="st">&#39;reminder of plan&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_04_T1,
  <span class="st">&#39;subgoals&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_05_T1,
  <span class="st">&#39;new PA options&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_06_T1,
  <span class="st">&#39;barrier identification&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_07_T1,
  <span class="st">&#39;coping planning&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_08_T1,
  <span class="st">&#39;PA identity&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_09_T1,
  <span class="st">&#39;PA life values&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_10_T1,
  <span class="st">&#39;positive consequences&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_01_T1,
  <span class="st">&#39;log on paper&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_02_T1,
  <span class="st">&#39;smartphone&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_03_T1,
<span class="co">#  &#39;mnemonic cues&#39; = PA_frequencyDependentBCT_04_T1,</span>
  <span class="st">&#39;goal contrast&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_05_T1,
  <span class="st">&#39;relevance of PA&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_06_T1,
  <span class="st">&#39;changes at home&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_07_T1,
  <span class="st">&#39;social support&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_08_T1,
  <span class="st">&#39;failure contemplated&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_09_T1) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">rowwise</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>( 
  <span class="co">#&#39;has plan&#39; = mean(c(`implementation plan`, `plan by other`), na.rm = TRUE),</span>
  <span class="st">&#39;monitored PA&#39;</span> =<span class="st"> </span><span class="kw">mean</span>(<span class="kw">c</span>(<span class="st">`</span><span class="dt">log on paper</span><span class="st">`</span>, <span class="st">`</span><span class="dt">smartphone</span><span class="st">`</span>), <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)) <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span><span class="st">`</span><span class="dt">log on paper</span><span class="st">`</span>, <span class="op">-</span><span class="st">`</span><span class="dt">smartphone</span><span class="st">`</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate_all</span>(as.numeric)

<span class="co"># Network for all participants</span>

S.total_PA &lt;-<span class="st"> </span>bctdf_PA <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="st">`</span><span class="dt">MVPA</span><span class="st">`</span><span class="op">:</span><span class="kw">ncol</span>(bctdf_PA))
nwBCT_PA &lt;-<span class="st"> </span>bootnet<span class="op">::</span><span class="kw">estimateNetwork</span>(S.total_PA, <span class="dt">default=</span><span class="st">&quot;EBICglasso&quot;</span>)

labs &lt;-<span class="st"> </span><span class="kw">colnames</span>(S.total_PA)

<span class="co"># Create means for filling nodes</span>
piefill &lt;-<span class="st"> </span>S.total_PA <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>MVPA, <span class="op">-</span>Autonomous, <span class="op">-</span>Controlled) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">data.frame</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarise_all</span>(<span class="kw">funs</span>(<span class="kw">median</span>(., <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">/</span><span class="st"> </span><span class="dv">6</span>))   

piefill<span class="op">$</span>MVPA &lt;-<span class="st"> </span><span class="kw">median</span>(S.total_PA<span class="op">$</span>MVPA, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">/</span><span class="st"> </span>(<span class="dv">60</span><span class="op">*</span><span class="dv">24</span>) 
piefill<span class="op">$</span>Autonomous &lt;-<span class="st"> </span><span class="kw">median</span>(S.total_PA<span class="op">$</span>Autonomous, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">/</span><span class="st"> </span><span class="dv">5</span>
piefill<span class="op">$</span>Controlled &lt;-<span class="st"> </span><span class="kw">median</span>(S.total_PA<span class="op">$</span>Controlled, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">/</span><span class="st"> </span><span class="dv">5</span>

piefill &lt;-<span class="st"> </span>piefill <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(MVPA, Autonomous, Controlled, <span class="kw">everything</span>())

<span class="co"># Plot network</span>
<span class="kw">plot</span>(nwBCT_PA, <span class="dt">layout =</span> <span class="st">&quot;spring&quot;</span>, <span class="dt">label.scale =</span> <span class="ot">FALSE</span>, <span class="dt">title =</span> <span class="st">&quot;GGM: Accelerometer-MVPA, BCTs &amp; motivation (all items)&quot;</span>, <span class="dt">label.cex =</span> <span class="fl">0.75</span>,
     <span class="dt">pie =</span> piefill, 
     <span class="dt">color =</span> <span class="st">&quot;skyblue&quot;</span>,
     <span class="dt">pieBorder =</span> <span class="dv">1</span>)</code></pre></div>
<p><img src="baseline-networks_files/figure-html/bct-pa-motivation-ggm-1.png" width="2100" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># Combine items further:</span>
bctdf_PA2 &lt;-<span class="st"> </span>bctdf_PA <span class="op">%&gt;%</span><span class="st"> </span>rowwise <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="st">&#39;goals and plans&#39;</span> =<span class="st"> </span><span class="kw">mean</span>(<span class="kw">c</span>(<span class="st">`</span><span class="dt">goal setting</span><span class="st">`</span>, <span class="st">`</span><span class="dt">implementation plan</span><span class="st">`</span>), <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="st">&#39;barriers identified</span><span class="ch">\n</span><span class="st">and planned for&#39;</span> =<span class="st"> </span><span class="kw">mean</span>(<span class="kw">c</span>(<span class="st">`</span><span class="dt">barrier identification</span><span class="st">`</span>, <span class="st">`</span><span class="dt">coping planning</span><span class="st">`</span>), <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span><span class="st">`</span><span class="dt">goal setting</span><span class="st">`</span>, <span class="op">-</span><span class="st">`</span><span class="dt">implementation plan</span><span class="st">`</span>, <span class="op">-</span><span class="st">`</span><span class="dt">barrier identification</span><span class="st">`</span>, <span class="op">-</span><span class="st">`</span><span class="dt">coping planning</span><span class="st">`</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>data.frame

S.total_PA2 &lt;-<span class="st"> </span>bctdf_PA2 <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(MVPA<span class="op">:</span><span class="kw">ncol</span>(bctdf_PA2))
nwBCT_PA2 &lt;-<span class="st"> </span>bootnet<span class="op">::</span><span class="kw">estimateNetwork</span>(S.total_PA2, <span class="dt">default=</span><span class="st">&quot;EBICglasso&quot;</span>)

<span class="co"># Create means for filling nodes</span>
piefill_PA2 &lt;-<span class="st"> </span>S.total_PA2 <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>MVPA, <span class="op">-</span>Autonomous, <span class="op">-</span>Controlled) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">data.frame</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarise_all</span>(<span class="kw">funs</span>(<span class="kw">median</span>(., <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">/</span><span class="st"> </span><span class="dv">6</span>)) 

piefill_PA2<span class="op">$</span>MVPA &lt;-<span class="st"> </span><span class="kw">median</span>(S.total_PA2<span class="op">$</span>MVPA, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">/</span><span class="st"> </span>(<span class="dv">60</span><span class="op">*</span><span class="dv">24</span>) 
piefill_PA2<span class="op">$</span>Autonomous &lt;-<span class="st"> </span><span class="kw">median</span>(S.total_PA2<span class="op">$</span>Autonomous, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">/</span><span class="st"> </span><span class="dv">5</span>
piefill_PA2<span class="op">$</span>Controlled &lt;-<span class="st"> </span><span class="kw">median</span>(S.total_PA2<span class="op">$</span>Controlled, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">/</span><span class="st"> </span><span class="dv">5</span>

piefill_PA2 &lt;-<span class="st"> </span>piefill_PA2 <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(MVPA, <span class="kw">everything</span>())


<span class="co"># Plot network</span>
<span class="kw">plot</span>(nwBCT_PA2, <span class="dt">layout =</span> <span class="st">&quot;spring&quot;</span>, <span class="dt">label.scale =</span> <span class="ot">FALSE</span>, <span class="dt">title =</span> <span class="st">&quot;GGM: Accelerometer-MVPA, BCTs &amp; motivation (combined items)&quot;</span>, <span class="dt">label.cex =</span> <span class="fl">0.75</span>,
     <span class="dt">pie =</span> piefill_PA2, 
     <span class="dt">color =</span> <span class="st">&quot;skyblue&quot;</span>,
     <span class="dt">pieBorder =</span> <span class="dv">1</span>)</code></pre></div>
<p><img src="baseline-networks_files/figure-html/bct-pa-motivation-ggm-2.png" width="2100" /></p>
</div>
<div id="centrality-and-stability-4" class="section level4">
<h4>Centrality and stability</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># BCTbootPA &lt;- bootnet::bootnet(nwBCT_PA2, nBoots = 2500)</span>
<span class="co"># save(BCTbootPA, file = &quot;./Rdata_files/BCTbootPA.Rdata&quot;)</span>

<span class="kw">load</span>(<span class="st">&quot;./Rdata_files/BCTbootPA.Rdata&quot;</span>)

qgraph<span class="op">::</span><span class="kw">centralityPlot</span>(nwBCT_PA2)</code></pre></div>
<p><img src="baseline-networks_files/figure-html/unnamed-chunk-8-1.png" width="2100" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="kw">plot</span>(BCTbootPA, <span class="dt">labels =</span> <span class="ot">FALSE</span>, <span class="dt">order =</span> <span class="st">&quot;sample&quot;</span>)</code></pre></div>
<p><img src="baseline-networks_files/figure-html/unnamed-chunk-8-2.png" width="2100" /></p>
</div>
</div>
</div>
<div id="demonstrating-the-ising-network" class="section level2">
<h2>Demonstrating the Ising network</h2>
<p>… in PA, autonomous motivation, and top-5 BCTs</p>
<p>Variables are binarised: * If one reports not using the BCT, they get a zero, otherwise a 1 * If one reports not having done no MVPA during the last week, they get a zero, otherwise a 1 * On the autonomous motivation sum score, if one reports lower agreement than 3 (indicating “sometimes true for me”) on average, they get a zero, otherwise a 1</p>
<p>We include the top 5 BCTs according to their bivariate Spearman correlations with self-reported PA. Self-report instead of accelerometer due to higher sample size and accounting for e.g. gym.</p>
<ol style="list-style-type: decimal">
<li>I have tried out new ways for me to be physically active.</li>
<li>I have personally made a specific plan (“what, where, how”) to implement my PA.</li>
<li>I have a PA plan, which has been made by someone else, e.g. my sports club (e.g. a workout schedule).</li>
<li>I have set PA goals for myself.</li>
<li>I have broken down larger PA goals to smaller subgoals.</li>
</ol>
<p>When a person has tried out a new PA way to be physically active, they have almost (because question time scales don’t overlap completely) by definition done MVPA lately. Therefore, we substitute this with:</p>
<ol start="6" style="list-style-type: decimal">
<li>I have compared my actualized PA with the PA goal I have set.</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">

top5Bcts_df &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(
  <span class="dt">MVPA =</span> padaysLastweek_T1,
  <span class="dt">Autonomous =</span> PA_autonomous_T1, 
  <span class="st">&#39;goal contrast&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_05_T1,
  <span class="st">&#39;implementation plan&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_02_T1,
  <span class="st">&#39;plan by other&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_03_T1,
  <span class="st">&#39;goal setting&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_01_T1,
  <span class="st">&#39;subgoals&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_05_T1) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st"> </span><span class="kw">mutate</span>(
  <span class="st">&#39;MVPA&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">MVPA</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>),
  <span class="st">&#39;Autonomous&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">Autonomous</span><span class="st">`</span> <span class="op">&lt;</span><span class="st"> </span><span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">1</span>),
  <span class="st">&#39;goal contrast&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">goal contrast</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
  <span class="st">&#39;implementation plan&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">implementation plan</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
  <span class="st">&#39;plan by other&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">plan by other</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
  <span class="st">&#39;goal setting&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">goal setting</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
  <span class="st">&#39;subgoals&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">subgoals</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>))  

allMeans &lt;-<span class="st"> </span>top5Bcts_df <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">summarise_all</span>(<span class="kw">funs</span>(<span class="kw">mean</span>(., <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))) 

network_all &lt;-<span class="st"> </span>bootnet<span class="op">::</span><span class="kw">estimateNetwork</span>(top5Bcts_df, <span class="dt">default=</span><span class="st">&quot;IsingFit&quot;</span>)
## 
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|</span><span class="st">                                                                 </span><span class="er">|</span><span class="st">   </span><span class="dv">0</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|=========</span><span class="st">                                                        </span><span class="er">|</span><span class="st">  </span><span class="dv">14</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|===================</span><span class="st">                                              </span><span class="er">|</span><span class="st">  </span><span class="dv">29</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|============================</span><span class="st">                                     </span><span class="er">|</span><span class="st">  </span><span class="dv">43</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|=====================================</span><span class="st">                            </span><span class="er">|</span><span class="st">  </span><span class="dv">57</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|==============================================</span><span class="st">                   </span><span class="er">|</span><span class="st">  </span><span class="dv">71</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|========================================================</span><span class="st">         </span><span class="er">|</span><span class="st">  </span><span class="dv">86</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|=================================================================|</span><span class="st"> </span><span class="dv">100</span>%

graph_cor &lt;-<span class="st"> </span>qgraph<span class="op">::</span><span class="kw">qgraph</span>(qgraph<span class="op">::</span><span class="kw">cor_auto</span>(top5Bcts_df), <span class="dt">graph =</span> <span class="st">&quot;cor&quot;</span>, <span class="dt">layout=</span><span class="st">&quot;spring&quot;</span>, <span class="dt">cut=</span><span class="dv">0</span>, 
                  <span class="dt">label.scale =</span> <span class="ot">FALSE</span>, <span class="dt">edge.labels =</span> <span class="ot">TRUE</span>, <span class="dt">labels =</span> <span class="kw">names</span>(top5Bcts_df),
                  <span class="dt">pie =</span> allMeans, <span class="dt">pieBorder =</span> <span class="dv">1</span>, <span class="dt">title =</span> <span class="st">&quot;Bivariate correlations&quot;</span>)</code></pre></div>
<p><img src="baseline-networks_files/figure-html/ising-demo-pa-autmot-top5bcts-1.png" width="2100" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">graph_Ising &lt;-<span class="st"> </span><span class="kw">plot</span>(network_all, <span class="dt">layout=</span><span class="st">&quot;spring&quot;</span>, <span class="dt">cut=</span><span class="dv">0</span>, <span class="dt">label.scale =</span> <span class="ot">FALSE</span>,
                  <span class="dt">pie =</span> allMeans, <span class="dt">pieBorder =</span> <span class="dv">1</span>, <span class="dt">title =</span> <span class="st">&quot;Ising model&quot;</span>)</code></pre></div>
<p><img src="baseline-networks_files/figure-html/ising-demo-pa-autmot-top5bcts-2.png" width="2100" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># maxedge &lt;- max(c(graph_Ising$graphAttributes$Graph$maximum, </span>
<span class="co">#                  graph_cor$graphAttributes$Graph$maximum))</span>

L &lt;-<span class="st"> </span>qgraph<span class="op">::</span><span class="kw">averageLayout</span>(graph_cor, graph_Ising)

<span class="kw">layout</span>(<span class="kw">matrix</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>, <span class="dt">nrow =</span> <span class="dv">1</span>, <span class="dt">byrow =</span> <span class="ot">TRUE</span>))
graph_cor &lt;-<span class="st"> </span>qgraph<span class="op">::</span><span class="kw">qgraph</span>(qgraph<span class="op">::</span><span class="kw">cor_auto</span>(top5Bcts_df), <span class="dt">graph =</span> <span class="st">&quot;cor&quot;</span>, <span class="dt">layout=</span>L, <span class="dt">cut=</span><span class="dv">0</span>, 
                  <span class="dt">label.scale =</span> <span class="ot">FALSE</span>, <span class="dt">edge.labels =</span> <span class="ot">TRUE</span>, <span class="dt">labels =</span> <span class="kw">names</span>(top5Bcts_df), <span class="dt">label.cex =</span> <span class="fl">0.8</span>,
                  <span class="dt">pie =</span> allMeans, <span class="dt">pieBorder =</span> <span class="dv">1</span>, <span class="dt">title =</span> <span class="st">&quot;Bivariate correlations&quot;</span>)
graph_Ising &lt;-<span class="st"> </span><span class="kw">plot</span>(network_all, <span class="dt">layout=</span>L, <span class="dt">cut=</span><span class="dv">0</span>, <span class="dt">label.scale =</span> <span class="ot">FALSE</span>,
                  <span class="dt">pie =</span> allMeans, <span class="dt">pieBorder =</span> <span class="dv">1</span>, <span class="dt">title =</span> <span class="st">&quot;Ising model&quot;</span>, <span class="dt">label.cex =</span> <span class="fl">0.8</span>)</code></pre></div>
<p><img src="baseline-networks_files/figure-html/ising-demo-pa-autmot-top5bcts-3.png" width="2100" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
qgraph<span class="op">::</span><span class="kw">flow</span>(graph_Ising, 
             <span class="st">&quot;MVPA&quot;</span>, 
             <span class="dt">groups =</span> <span class="kw">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="kw">rep</span>(<span class="st">&quot;C&quot;</span>, <span class="dv">5</span>)),
             <span class="dt">legend =</span> <span class="ot">FALSE</span>,
             <span class="dt">title =</span> <span class="st">&quot;&quot;</span>,
             <span class="dt">vsize =</span> <span class="dv">15</span>,
             <span class="dt">label.cex =</span> <span class="fl">1.5</span>,
             <span class="dt">colors =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">3</span>),
             <span class="dt">label.color =</span> <span class="kw">c</span>(<span class="st">&quot;white&quot;</span>, <span class="kw">rep</span>(<span class="st">&quot;black&quot;</span>, <span class="dv">6</span>)))</code></pre></div>
<p><img src="baseline-networks_files/figure-html/ising-demo-pa-autmot-top5bcts-4.png" width="2100" /></p>
<p>Centrality and stability:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Ising_centralityPlot &lt;-<span class="st"> </span>qgraph<span class="op">::</span><span class="kw">centralityPlot</span>(graph_Ising)</code></pre></div>
<p><img src="baseline-networks_files/figure-html/top5Bcts-stability-1.png" width="2100" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
qgraph<span class="op">::</span><span class="kw">centrality</span>(graph_Ising)<span class="op">$</span>InDegree
##                MVPA          Autonomous       goal contrast 
##            2.738643            3.198366            3.771397 
## implementation plan       plan by other        goal setting 
##            7.473934            4.181088            4.805290 
##            subgoals 
##            5.656572
<span class="kw">scale</span>(qgraph<span class="op">::</span><span class="kw">centrality</span>(graph_Ising)<span class="op">$</span>InDegree)
##                           [,1]
## MVPA                -1.1179740
## Autonomous          -0.8336781
## goal contrast       -0.4793110
## implementation plan  1.8103664
## plan by other       -0.2259548
## goal setting         0.1600562
## subgoals             0.6864954
## attr(,&quot;scaled:center&quot;)
## [1] 4.54647
## attr(,&quot;scaled:scale&quot;)
## [1] 1.617056
qgraph<span class="op">::</span><span class="kw">centrality</span>(graph_Ising)<span class="op">$</span>Closeness
##                MVPA          Autonomous       goal contrast 
##          0.08689381          0.08758533          0.09784630 
## implementation plan       plan by other        goal setting 
##          0.15833382          0.12275906          0.10532717 
##            subgoals 
##          0.13454803
qgraph<span class="op">::</span><span class="kw">centrality</span>(graph_Ising)<span class="op">$</span>Betweenness
##                MVPA          Autonomous       goal contrast 
##                   0                   0                   0 
## implementation plan       plan by other        goal setting 
##                  16                   4                   0 
##            subgoals 
##                   2

<span class="kw">cor</span>(qgraph<span class="op">::</span><span class="kw">centrality</span>(graph_Ising)<span class="op">$</span>InDegree, qgraph<span class="op">::</span><span class="kw">centrality</span>(graph_Ising)<span class="op">$</span>Betweenness, 
    <span class="dt">method =</span> <span class="st">&quot;spearman&quot;</span>) 
## [1] 0.7290021

<span class="co"># bootnet_stability_top5Bcts &lt;- bootnet::bootnet(network_all, nBoots=1000)</span>
<span class="co"># save(bootnet_stability_top5Bcts, file = &quot;./Rdata_files/bootnet_stability_top5Bcts.Rdata&quot;)</span>
<span class="kw">load</span>(<span class="st">&quot;./Rdata_files/bootnet_stability_top5Bcts.Rdata&quot;</span>)

<span class="kw">plot</span>(bootnet_stability_top5Bcts, <span class="dt">labels =</span> <span class="ot">TRUE</span>, <span class="dt">order =</span> <span class="st">&quot;sample&quot;</span>) </code></pre></div>
<p><img src="baseline-networks_files/figure-html/top5Bcts-stability-2.png" width="2100" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(bootnet_stability_top5Bcts, <span class="st">&quot;edge&quot;</span>, <span class="dt">plot =</span> <span class="st">&quot;difference&quot;</span>, <span class="dt">onlyNonZero =</span> <span class="ot">TRUE</span>, <span class="dt">order =</span> <span class="st">&quot;sample&quot;</span>)</code></pre></div>
<p><img src="baseline-networks_files/figure-html/top5Bcts-stability-3.png" width="2100" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># bootnet_centrality_stability_top5Bcts &lt;- bootnet::bootnet(network_all, nBoots=1000,nCores=8, type=&quot;case&quot;)</span>
<span class="co"># save(bootnet_centrality_stability_top5Bcts, file = &quot;./Rdata_files/bootnet_centrality_stability_top5Bcts.Rdata&quot;)</span>
<span class="kw">load</span>(<span class="st">&quot;./Rdata_files/bootnet_centrality_stability_top5Bcts.Rdata&quot;</span>)

<span class="kw">plot</span>(bootnet_centrality_stability_top5Bcts)</code></pre></div>
<p><img src="baseline-networks_files/figure-html/top5Bcts-stability-4.png" width="2100" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(bootnet_centrality_stability_top5Bcts, <span class="dt">perNode=</span>T, <span class="st">&quot;strength&quot;</span>)</code></pre></div>
<p><img src="baseline-networks_files/figure-html/top5Bcts-stability-5.png" width="2100" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
bootnet<span class="op">::</span><span class="kw">corStability</span>(bootnet_centrality_stability_top5Bcts) 
## === Correlation Stability Analysis === 
## 
## Sampling levels tested:
##    nPerson Drop%   n
## 1      291  75.0  92
## 2      382  67.2  94
## 3      472  59.5 125
## 4      563  51.7  97
## 5      654  43.9  94
## 6      744  36.1 103
## 7      835  28.3 102
## 8      926  20.5  92
## 9     1016  12.8 105
## 10    1107   5.0  96
## 
## Maximum drop proportions to retain correlation of 0.7 in at least 95% of the samples:
## 
## betweenness: 0.283
##   - For more accuracy, run bootnet(..., caseMin = 0.205, caseMax = 0.361) 
## 
## closeness: 0.439
##   - For more accuracy, run bootnet(..., caseMin = 0.361, caseMax = 0.517) 
## 
## strength: 0.75
##   - For more accuracy, run bootnet(..., caseMin = 0.672, caseMax = 1) 
## 
## Accuracy can also be increased by increasing both &#39;nBoots&#39; and &#39;caseN&#39;.</code></pre></div>
<div id="heterogeneity-check" class="section level3">
<h3>Heterogeneity check</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
top5Bcts_tracks_df &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(
  track,
  <span class="dt">PA =</span> padaysLastweek_T1,
  <span class="dt">Autonomous =</span> PA_autonomous_T1, 
  <span class="st">&#39;new PA options&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_06_T1,
  <span class="st">&#39;implementation plan&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_02_T1,
  <span class="st">&#39;plan by other&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_03_T1,
  <span class="st">&#39;goal setting&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_01_T1,
  <span class="st">&#39;subgoals&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_05_T1) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st"> </span><span class="kw">mutate</span>(
  <span class="st">&#39;PA&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">PA</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>),
  <span class="st">&#39;Autonomous&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">Autonomous</span><span class="st">`</span> <span class="op">&lt;</span><span class="st"> </span><span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">1</span>),
  <span class="st">&#39;new PA options&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">new PA options</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
  <span class="st">&#39;implementation plan&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">implementation plan</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
  <span class="st">&#39;plan by other&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">plan by other</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
  <span class="st">&#39;goal setting&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">goal setting</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
  <span class="st">&#39;subgoals&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">subgoals</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>))

heterogeneity_Nur &lt;-<span class="st"> </span>top5Bcts_tracks_df <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;Nur&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>track) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">na.omit</span>() 
NurMeans &lt;-<span class="st"> </span>heterogeneity_Nur <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">summarise_all</span>(<span class="kw">funs</span>(<span class="kw">mean</span>(., <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))) 

heterogeneity_HRC &lt;-<span class="st"> </span>top5Bcts_tracks_df <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;HRC&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>track) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">na.omit</span>()
HRCMeans &lt;-<span class="st"> </span>heterogeneity_HRC <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">summarise_all</span>(<span class="kw">funs</span>(<span class="kw">mean</span>(., <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))) 

heterogeneity_BA &lt;-<span class="st"> </span>top5Bcts_tracks_df <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;BA&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>track) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">na.omit</span>()
BAMeans &lt;-<span class="st"> </span>heterogeneity_BA <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">summarise_all</span>(<span class="kw">funs</span>(<span class="kw">mean</span>(., <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))) 

heterogeneity_IT &lt;-<span class="st"> </span>top5Bcts_tracks_df <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;IT&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>track) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">na.omit</span>() 
ITMeans &lt;-<span class="st"> </span>heterogeneity_IT <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">summarise_all</span>(<span class="kw">funs</span>(<span class="kw">mean</span>(., <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))) 

network_Nur &lt;-<span class="st"> </span>bootnet<span class="op">::</span><span class="kw">estimateNetwork</span>(heterogeneity_Nur, <span class="dt">default=</span><span class="st">&quot;IsingFit&quot;</span>)
## 
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|</span><span class="st">                                                                 </span><span class="er">|</span><span class="st">   </span><span class="dv">0</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|=========</span><span class="st">                                                        </span><span class="er">|</span><span class="st">  </span><span class="dv">14</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|===================</span><span class="st">                                              </span><span class="er">|</span><span class="st">  </span><span class="dv">29</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|============================</span><span class="st">                                     </span><span class="er">|</span><span class="st">  </span><span class="dv">43</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|=====================================</span><span class="st">                            </span><span class="er">|</span><span class="st">  </span><span class="dv">57</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|==============================================</span><span class="st">                   </span><span class="er">|</span><span class="st">  </span><span class="dv">71</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|========================================================</span><span class="st">         </span><span class="er">|</span><span class="st">  </span><span class="dv">86</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|=================================================================|</span><span class="st"> </span><span class="dv">100</span>%
network_HRC &lt;-<span class="st"> </span>bootnet<span class="op">::</span><span class="kw">estimateNetwork</span>(heterogeneity_HRC, <span class="dt">default=</span><span class="st">&quot;IsingFit&quot;</span>)
## 
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|</span><span class="st">                                                                 </span><span class="er">|</span><span class="st">   </span><span class="dv">0</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|=========</span><span class="st">                                                        </span><span class="er">|</span><span class="st">  </span><span class="dv">14</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|===================</span><span class="st">                                              </span><span class="er">|</span><span class="st">  </span><span class="dv">29</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|============================</span><span class="st">                                     </span><span class="er">|</span><span class="st">  </span><span class="dv">43</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|=====================================</span><span class="st">                            </span><span class="er">|</span><span class="st">  </span><span class="dv">57</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|==============================================</span><span class="st">                   </span><span class="er">|</span><span class="st">  </span><span class="dv">71</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|========================================================</span><span class="st">         </span><span class="er">|</span><span class="st">  </span><span class="dv">86</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|=================================================================|</span><span class="st"> </span><span class="dv">100</span>%
network_BA &lt;-<span class="st"> </span>bootnet<span class="op">::</span><span class="kw">estimateNetwork</span>(heterogeneity_BA, <span class="dt">default=</span><span class="st">&quot;IsingFit&quot;</span>)
## 
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|</span><span class="st">                                                                 </span><span class="er">|</span><span class="st">   </span><span class="dv">0</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|=========</span><span class="st">                                                        </span><span class="er">|</span><span class="st">  </span><span class="dv">14</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|===================</span><span class="st">                                              </span><span class="er">|</span><span class="st">  </span><span class="dv">29</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|============================</span><span class="st">                                     </span><span class="er">|</span><span class="st">  </span><span class="dv">43</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|=====================================</span><span class="st">                            </span><span class="er">|</span><span class="st">  </span><span class="dv">57</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|==============================================</span><span class="st">                   </span><span class="er">|</span><span class="st">  </span><span class="dv">71</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|========================================================</span><span class="st">         </span><span class="er">|</span><span class="st">  </span><span class="dv">86</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|=================================================================|</span><span class="st"> </span><span class="dv">100</span>%
network_IT &lt;-<span class="st"> </span>bootnet<span class="op">::</span><span class="kw">estimateNetwork</span>(heterogeneity_IT, <span class="dt">default=</span><span class="st">&quot;IsingFit&quot;</span>)
## 
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|</span><span class="st">                                                                 </span><span class="er">|</span><span class="st">   </span><span class="dv">0</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|=========</span><span class="st">                                                        </span><span class="er">|</span><span class="st">  </span><span class="dv">14</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|===================</span><span class="st">                                              </span><span class="er">|</span><span class="st">  </span><span class="dv">29</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|============================</span><span class="st">                                     </span><span class="er">|</span><span class="st">  </span><span class="dv">43</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|=====================================</span><span class="st">                            </span><span class="er">|</span><span class="st">  </span><span class="dv">57</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|==============================================</span><span class="st">                   </span><span class="er">|</span><span class="st">  </span><span class="dv">71</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|========================================================</span><span class="st">         </span><span class="er">|</span><span class="st">  </span><span class="dv">86</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|=================================================================|</span><span class="st"> </span><span class="dv">100</span>%

graph_Nur &lt;-<span class="st"> </span><span class="kw">plot</span>(network_Nur, <span class="dt">layout=</span><span class="st">&quot;spring&quot;</span>, <span class="dt">cut=</span><span class="dv">0</span>, <span class="dt">label.scale =</span> <span class="ot">FALSE</span>,
                  <span class="dt">pie =</span> NurMeans, <span class="dt">pieBorder =</span> <span class="dv">1</span>, <span class="dt">title =</span> <span class="st">&quot;Practical nurse&quot;</span>)</code></pre></div>
<p><img src="baseline-networks_files/figure-html/top5Bcts-heterogeneity-1.png" width="2100" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">graph_HRC &lt;-<span class="st"> </span><span class="kw">plot</span>(network_HRC, <span class="dt">layout=</span><span class="st">&quot;spring&quot;</span>, <span class="dt">cut=</span><span class="dv">0</span>, <span class="dt">label.scale =</span> <span class="ot">FALSE</span>,
                  <span class="dt">pie =</span> HRCMeans, <span class="dt">pieBorder =</span> <span class="dv">1</span>, <span class="dt">title =</span> <span class="st">&quot;HRC&quot;</span>)</code></pre></div>
<p><img src="baseline-networks_files/figure-html/top5Bcts-heterogeneity-2.png" width="2100" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">graph_BA &lt;-<span class="st"> </span><span class="kw">plot</span>(network_BA, <span class="dt">layout=</span><span class="st">&quot;spring&quot;</span>, <span class="dt">cut=</span><span class="dv">0</span>, <span class="dt">label.scale =</span> <span class="ot">FALSE</span>,
                  <span class="dt">pie =</span> BAMeans, <span class="dt">pieBorder =</span> <span class="dv">1</span>, <span class="dt">title =</span> <span class="st">&quot;BA&quot;</span>)</code></pre></div>
<p><img src="baseline-networks_files/figure-html/top5Bcts-heterogeneity-3.png" width="2100" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">graph_IT &lt;-<span class="st"> </span><span class="kw">plot</span>(network_IT, <span class="dt">layout=</span><span class="st">&quot;spring&quot;</span>, <span class="dt">cut=</span><span class="dv">0</span>, <span class="dt">label.scale =</span> <span class="ot">FALSE</span>,
                  <span class="dt">pie =</span> ITMeans, <span class="dt">pieBorder =</span> <span class="dv">1</span>, <span class="dt">title =</span> <span class="st">&quot;IT&quot;</span>)</code></pre></div>
<p><img src="baseline-networks_files/figure-html/top5Bcts-heterogeneity-4.png" width="2100" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
maxedge &lt;-<span class="st"> </span><span class="kw">max</span>(<span class="kw">c</span>(graph_Nur<span class="op">$</span>graphAttributes<span class="op">$</span>Graph<span class="op">$</span>maximum, 
                 graph_HRC<span class="op">$</span>graphAttributes<span class="op">$</span>Graph<span class="op">$</span>maximum, 
                 graph_BA<span class="op">$</span>graphAttributes<span class="op">$</span>Graph<span class="op">$</span>maximum, 
                 graph_IT<span class="op">$</span>graphAttributes<span class="op">$</span>Graph<span class="op">$</span>maximum))

L &lt;-<span class="st"> </span>qgraph<span class="op">::</span><span class="kw">averageLayout</span>(graph_Nur, graph_HRC, graph_BA, graph_IT)

<span class="kw">layout</span>(<span class="kw">matrix</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>, <span class="dt">nrow =</span> <span class="dv">2</span>, <span class="dt">byrow =</span> <span class="ot">TRUE</span>))
graph_Nur &lt;-<span class="st"> </span><span class="kw">plot</span>(network_Nur, <span class="dt">layout=</span>L, <span class="dt">cut=</span><span class="dv">0</span>, <span class="dt">label.scale =</span> <span class="ot">FALSE</span>, <span class="dt">title =</span> <span class="st">&quot;Practical nurse&quot;</span>, 
                  <span class="dt">maximum =</span> maxedge, <span class="dt">pie =</span> NurMeans, <span class="dt">pieBorder =</span> <span class="dv">1</span>)
graph_HRC &lt;-<span class="st"> </span><span class="kw">plot</span>(network_HRC, <span class="dt">layout=</span>L, <span class="dt">cut=</span><span class="dv">0</span>, <span class="dt">label.scale =</span> <span class="ot">FALSE</span>, <span class="dt">title =</span> <span class="st">&quot;HRC&quot;</span>,
                  <span class="dt">maximum =</span> maxedge, <span class="dt">pie =</span> HRCMeans, <span class="dt">pieBorder =</span> <span class="dv">1</span>)
graph_BA &lt;-<span class="st"> </span><span class="kw">plot</span>(network_BA, <span class="dt">layout=</span>L, <span class="dt">cut=</span><span class="dv">0</span>, <span class="dt">label.scale =</span> <span class="ot">FALSE</span>, <span class="dt">title =</span> <span class="st">&quot;BA&quot;</span>, 
                 <span class="dt">maximum =</span> maxedge, <span class="dt">pie =</span> BAMeans, <span class="dt">pieBorder =</span> <span class="dv">1</span>)
graph_IT &lt;-<span class="st"> </span><span class="kw">plot</span>(network_IT, <span class="dt">layout=</span>L, <span class="dt">cut=</span><span class="dv">0</span>, <span class="dt">label.scale =</span> <span class="ot">FALSE</span>, <span class="dt">title =</span> <span class="st">&quot;IT&quot;</span>,
                 <span class="dt">maximum =</span> maxedge, <span class="dt">pie =</span> ITMeans, <span class="dt">pieBorder =</span> <span class="dv">1</span>)</code></pre></div>
<p><img src="baseline-networks_files/figure-html/top5Bcts-heterogeneity-5.png" width="2100" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">

<span class="co"># nct_results_top5Bcts &lt;- NetworkComparisonTest::NCT(heterogeneity_Nur, heterogeneity_IT, it=1000, binary.data=FALSE, paired=FALSE, test.edges=TRUE,</span>
<span class="co"># edges=&#39;all&#39;, progressbar=TRUE)</span>
<span class="co"># </span>
<span class="co"># save(nct_results_top5Bcts, file = &quot;./Rdata_files/nct_results_top5Bcts.Rdata&quot;)</span>
<span class="co"># alternatively, load </span>
<span class="kw">load</span>(<span class="st">&quot;./Rdata_files/nct_results_top5Bcts.Rdata&quot;</span>)</code></pre></div>
<p>Results from the network comparison test between Nur and IT on “top-5” BCTs:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="kw">print</span>(<span class="st">&quot;Similarity&quot;</span>)</code></pre></div>
<p>[1] “Similarity”</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cat</span>(<span class="st">&quot;Correlation between Nur and IT edge strengths:&quot;</span>, <span class="kw">cor</span>(qgraph<span class="op">::</span><span class="kw">centrality</span>(network_Nur)<span class="op">$</span>InDegree, qgraph<span class="op">::</span><span class="kw">centrality</span>(network_IT)<span class="op">$</span>InDegree))</code></pre></div>
<p>Correlation between Nur and IT edge strengths: 0.7378432</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="kw">cat</span>(<span class="st">&quot;Correlation between Nur and IT networks:&quot;</span>, <span class="kw">cor</span>(network_Nur<span class="op">$</span>graph[<span class="kw">lower.tri</span>(network_Nur<span class="op">$</span>graph)], network_IT<span class="op">$</span>graph[<span class="kw">lower.tri</span>(network_Nur<span class="op">$</span>graph)], <span class="dt">method=</span><span class="st">&quot;spearman&quot;</span>))</code></pre></div>
<p>Correlation between Nur and IT networks: 0.4107089</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="kw">print</span>(<span class="st">&quot;Difference&quot;</span>)</code></pre></div>
<p>[1] “Difference”</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cat</span>(<span class="st">&quot;P-value for the test of identical network structure:&quot;</span>, nct_results_top5Bcts<span class="op">$</span>nwinv.pval)</code></pre></div>
<p>P-value for the test of identical network structure: 0.804</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cat</span>(<span class="st">&quot;P-value for the test of identical connectivity in networks:&quot;</span>, nct_results_top5Bcts<span class="op">$</span>glstrinv.pval)</code></pre></div>
<p>P-value for the test of identical connectivity in networks: 0.443</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">nct_results_top5Bcts<span class="op">$</span>einv.pvals <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>papaja<span class="op">::</span><span class="kw">apa_table</span>(<span class="dt">caption =</span> <span class="st">&quot;p-values on difference test in edges between Nur and IT&quot;</span>)</code></pre></div>
<caption>
(#tab:top5bcts-nct-results)
</caption>
<caption>
<em>p-values on difference test in edges between Nur and IT</em>
</caption>
<table>
<thead>
<tr class="header">
<th></th>
<th align="left">Var1</th>
<th align="left">Var2</th>
<th align="left">p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>8</td>
<td align="left">PA</td>
<td align="left">Autonomous</td>
<td align="left">1.00</td>
</tr>
<tr class="even">
<td>15</td>
<td align="left">PA</td>
<td align="left">new PA options</td>
<td align="left">1.00</td>
</tr>
<tr class="odd">
<td>16</td>
<td align="left">Autonomous</td>
<td align="left">new PA options</td>
<td align="left">1.00</td>
</tr>
<tr class="even">
<td>22</td>
<td align="left">PA</td>
<td align="left">implementation plan</td>
<td align="left">1.00</td>
</tr>
<tr class="odd">
<td>23</td>
<td align="left">Autonomous</td>
<td align="left">implementation plan</td>
<td align="left">1.00</td>
</tr>
<tr class="even">
<td>24</td>
<td align="left">new PA options</td>
<td align="left">implementation plan</td>
<td align="left">1.00</td>
</tr>
<tr class="odd">
<td>29</td>
<td align="left">PA</td>
<td align="left">plan by other</td>
<td align="left">1.00</td>
</tr>
<tr class="even">
<td>30</td>
<td align="left">Autonomous</td>
<td align="left">plan by other</td>
<td align="left">1.00</td>
</tr>
<tr class="odd">
<td>31</td>
<td align="left">new PA options</td>
<td align="left">plan by other</td>
<td align="left">1.00</td>
</tr>
<tr class="even">
<td>32</td>
<td align="left">implementation plan</td>
<td align="left">plan by other</td>
<td align="left">1.00</td>
</tr>
<tr class="odd">
<td>36</td>
<td align="left">PA</td>
<td align="left">goal setting</td>
<td align="left">1.00</td>
</tr>
<tr class="even">
<td>37</td>
<td align="left">Autonomous</td>
<td align="left">goal setting</td>
<td align="left">1.00</td>
</tr>
<tr class="odd">
<td>38</td>
<td align="left">new PA options</td>
<td align="left">goal setting</td>
<td align="left">1.00</td>
</tr>
<tr class="even">
<td>39</td>
<td align="left">implementation plan</td>
<td align="left">goal setting</td>
<td align="left">1.00</td>
</tr>
<tr class="odd">
<td>40</td>
<td align="left">plan by other</td>
<td align="left">goal setting</td>
<td align="left">1.00</td>
</tr>
<tr class="even">
<td>43</td>
<td align="left">PA</td>
<td align="left">subgoals</td>
<td align="left">1.00</td>
</tr>
<tr class="odd">
<td>44</td>
<td align="left">Autonomous</td>
<td align="left">subgoals</td>
<td align="left">1.00</td>
</tr>
<tr class="even">
<td>45</td>
<td align="left">new PA options</td>
<td align="left">subgoals</td>
<td align="left">1.00</td>
</tr>
<tr class="odd">
<td>46</td>
<td align="left">implementation plan</td>
<td align="left">subgoals</td>
<td align="left">1.00</td>
</tr>
<tr class="even">
<td>47</td>
<td align="left">plan by other</td>
<td align="left">subgoals</td>
<td align="left">1.00</td>
</tr>
<tr class="odd">
<td>48</td>
<td align="left">goal setting</td>
<td align="left">subgoals</td>
<td align="left">1.00</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="kw">cat</span>(<span class="st">&quot;Number of edges, which appear different (p&lt;0.05):&quot;</span>, <span class="kw">sum</span>(nct_results_top5Bcts<span class="op">$</span>einv.pvals<span class="op">$</span><span class="st">&quot;p-value&quot;</span> <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.05</span>))</code></pre></div>
<p>Number of edges, which appear different (p&lt;0.05): 0</p>
</div>
</div>
</div>
<div id="bct-sdt-regression-analyses" class="section level1">
<h1>BCT-SDT Regression analyses</h1>
<p>Here’s the classical linear model.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
bctdf &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(id,
  intervention,
  group,
  school,
  girl,
  <span class="st">&#39;Autonomous&#39;</span> =<span class="st"> </span>PA_autonomous_T1,
  <span class="st">&#39;Controlled&#39;</span> =<span class="st"> </span>PA_controlled_T1,
  <span class="st">&#39;Intrinsic&#39;</span> =<span class="st"> </span>PA_intrinsic_T1,
  <span class="st">&#39;Identified&#39;</span> =<span class="st"> </span>PA_identified_T1,
  <span class="st">&#39;Integrated&#39;</span> =<span class="st"> </span>PA_integrated_T1,
  <span class="st">&#39;Introjected&#39;</span> =<span class="st"> </span>PA_introjected_T1,
  <span class="st">&#39;Extrinsic&#39;</span> =<span class="st"> </span>PA_extrinsic_T1,
  <span class="st">&#39;goal setting&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_01_T1,
  <span class="st">&#39;implementation plan&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_02_T1,
  <span class="st">&#39;plan by other&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_03_T1,
  <span class="st">&#39;reminder of plan&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_04_T1,
  <span class="st">&#39;subgoals&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_05_T1,
  <span class="st">&#39;new PA options&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_06_T1,
  <span class="st">&#39;barrier identification&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_07_T1,
  <span class="st">&#39;coping planning&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_08_T1,
  <span class="st">&#39;PA identity&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_09_T1,
  <span class="st">&#39;PA life values&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_10_T1,
  <span class="st">&#39;positive consequences&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_01_T1,
  <span class="st">&#39;log on paper&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_02_T1,
  <span class="st">&#39;smartphone&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_03_T1,
<span class="co">#  &#39;mnemonic cues&#39; = PA_frequencyDependentBCT_04_T1,</span>
  <span class="st">&#39;goal contrast&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_05_T1,
  <span class="st">&#39;relevance of PA&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_06_T1,
  <span class="st">&#39;changes at home&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_07_T1,
  <span class="st">&#39;social support&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_08_T1,
  <span class="st">&#39;failure contemplated&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_09_T1) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">rowwise</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>( 
  <span class="co">#&#39;has plan&#39; = mean(c(`implementation plan`, `plan by other`), na.rm = TRUE),</span>
  <span class="st">&#39;monitored PA&#39;</span> =<span class="st"> </span><span class="kw">mean</span>(<span class="kw">c</span>(<span class="st">`</span><span class="dt">log on paper</span><span class="st">`</span>, <span class="st">`</span><span class="dt">smartphone</span><span class="st">`</span>), <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)) <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span><span class="st">`</span><span class="dt">log on paper</span><span class="st">`</span>, <span class="op">-</span><span class="st">`</span><span class="dt">smartphone</span><span class="st">`</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>data.frame <span class="co"># %&gt;% </span>
  <span class="co"># mutate_all(as.numeric)</span>

outcomevars &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;Autonomous&#39;</span>, 
  <span class="st">&#39;Controlled&#39;</span>, 
  <span class="st">&#39;Intrinsic&#39;</span>,
  <span class="st">&#39;Identified&#39;</span>, 
  <span class="st">&#39;Integrated&#39;</span>, 
  <span class="st">&#39;Introjected&#39;</span>,
  <span class="st">&#39;Extrinsic&#39;</span>)

<span class="cf">for</span> (i <span class="cf">in</span> outcomevars) {
m &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">paste0</span>(i, <span class="st">&quot; ~ </span>
<span class="st">  goal.setting +</span>
<span class="st">  implementation.plan +</span>
<span class="st">  plan.by.other +</span>
<span class="st">  reminder.of.plan +</span>
<span class="st">  subgoals +</span>
<span class="st">  new.PA.options +</span>
<span class="st">  barrier.identification +</span>
<span class="st">  coping.planning +</span>
<span class="st">  PA.identity +</span>
<span class="st">  PA.life.values +</span>
<span class="st">  positive.consequences&quot;</span>), 
  <span class="dt">data =</span> bctdf)

<span class="kw">cat</span>(<span class="st">&quot;</span><span class="ch">\n\n</span><span class="st">Estimates for&quot;</span>, i, <span class="st">&quot;regulation&quot;</span>, <span class="dt">sep =</span> <span class="st">&quot; &quot;</span>)
<span class="kw">summary</span>(m) <span class="op">%&gt;%</span><span class="st"> </span>broom<span class="op">::</span><span class="kw">tidy</span>() <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">arrange</span>(<span class="kw">desc</span>(estimate)) <span class="op">%&gt;%</span><span class="st"> </span>papaja<span class="op">::</span><span class="kw">apa_table</span>() 
}</code></pre></div>
Estimates for Autonomous regulation
<caption>
(#tab:bct-sdt-regression)
</caption>
<caption>
**
</caption>
<table>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="left">estimate</th>
<th align="left">std.error</th>
<th align="left">statistic</th>
<th align="left">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="left">1.59</td>
<td align="left">0.07</td>
<td align="left">22.97</td>
<td align="left">0.00</td>
</tr>
<tr class="even">
<td align="left">positive.consequences</td>
<td align="left">0.12</td>
<td align="left">0.02</td>
<td align="left">6.52</td>
<td align="left">0.00</td>
</tr>
<tr class="odd">
<td align="left">PA.life.values</td>
<td align="left">0.11</td>
<td align="left">0.02</td>
<td align="left">5.05</td>
<td align="left">0.00</td>
</tr>
<tr class="even">
<td align="left">goal.setting</td>
<td align="left">0.10</td>
<td align="left">0.02</td>
<td align="left">5.23</td>
<td align="left">0.00</td>
</tr>
<tr class="odd">
<td align="left">plan.by.other</td>
<td align="left">0.09</td>
<td align="left">0.02</td>
<td align="left">5.45</td>
<td align="left">0.00</td>
</tr>
<tr class="even">
<td align="left">new.PA.options</td>
<td align="left">0.08</td>
<td align="left">0.02</td>
<td align="left">4.57</td>
<td align="left">0.00</td>
</tr>
<tr class="odd">
<td align="left">implementation.plan</td>
<td align="left">0.05</td>
<td align="left">0.02</td>
<td align="left">2.48</td>
<td align="left">0.01</td>
</tr>
<tr class="even">
<td align="left">PA.identity</td>
<td align="left">0.02</td>
<td align="left">0.02</td>
<td align="left">1.03</td>
<td align="left">0.30</td>
</tr>
<tr class="odd">
<td align="left">subgoals</td>
<td align="left">0.01</td>
<td align="left">0.02</td>
<td align="left">0.27</td>
<td align="left">0.78</td>
</tr>
<tr class="even">
<td align="left">coping.planning</td>
<td align="left">-0.01</td>
<td align="left">0.02</td>
<td align="left">-0.24</td>
<td align="left">0.81</td>
</tr>
<tr class="odd">
<td align="left">barrier.identification</td>
<td align="left">-0.01</td>
<td align="left">0.02</td>
<td align="left">-0.65</td>
<td align="left">0.51</td>
</tr>
<tr class="even">
<td align="left">reminder.of.plan</td>
<td align="left">-0.03</td>
<td align="left">0.02</td>
<td align="left">-1.41</td>
<td align="left">0.16</td>
</tr>
</tbody>
</table>
Estimates for Controlled regulation
<caption>
(#tab:bct-sdt-regression)
</caption>
<caption>
**
</caption>
<table>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="left">estimate</th>
<th align="left">std.error</th>
<th align="left">statistic</th>
<th align="left">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="left">1.36</td>
<td align="left">0.07</td>
<td align="left">19.32</td>
<td align="left">0.00</td>
</tr>
<tr class="even">
<td align="left">PA.identity</td>
<td align="left">0.07</td>
<td align="left">0.02</td>
<td align="left">3.08</td>
<td align="left">0.00</td>
</tr>
<tr class="odd">
<td align="left">barrier.identification</td>
<td align="left">0.06</td>
<td align="left">0.02</td>
<td align="left">2.75</td>
<td align="left">0.01</td>
</tr>
<tr class="even">
<td align="left">positive.consequences</td>
<td align="left">0.05</td>
<td align="left">0.02</td>
<td align="left">2.69</td>
<td align="left">0.01</td>
</tr>
<tr class="odd">
<td align="left">reminder.of.plan</td>
<td align="left">0.03</td>
<td align="left">0.02</td>
<td align="left">1.54</td>
<td align="left">0.12</td>
</tr>
<tr class="even">
<td align="left">implementation.plan</td>
<td align="left">0.03</td>
<td align="left">0.02</td>
<td align="left">1.15</td>
<td align="left">0.25</td>
</tr>
<tr class="odd">
<td align="left">subgoals</td>
<td align="left">0.01</td>
<td align="left">0.02</td>
<td align="left">0.26</td>
<td align="left">0.80</td>
</tr>
<tr class="even">
<td align="left">coping.planning</td>
<td align="left">0.00</td>
<td align="left">0.02</td>
<td align="left">0.20</td>
<td align="left">0.84</td>
</tr>
<tr class="odd">
<td align="left">plan.by.other</td>
<td align="left">0.00</td>
<td align="left">0.02</td>
<td align="left">0.12</td>
<td align="left">0.91</td>
</tr>
<tr class="even">
<td align="left">goal.setting</td>
<td align="left">-0.01</td>
<td align="left">0.02</td>
<td align="left">-0.43</td>
<td align="left">0.67</td>
</tr>
<tr class="odd">
<td align="left">new.PA.options</td>
<td align="left">-0.02</td>
<td align="left">0.02</td>
<td align="left">-1.00</td>
<td align="left">0.32</td>
</tr>
<tr class="even">
<td align="left">PA.life.values</td>
<td align="left">-0.07</td>
<td align="left">0.02</td>
<td align="left">-3.14</td>
<td align="left">0.00</td>
</tr>
</tbody>
</table>
Estimates for Intrinsic regulation
<caption>
(#tab:bct-sdt-regression)
</caption>
<caption>
**
</caption>
<table>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="left">estimate</th>
<th align="left">std.error</th>
<th align="left">statistic</th>
<th align="left">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="left">1.81</td>
<td align="left">0.08</td>
<td align="left">22.81</td>
<td align="left">0.00</td>
</tr>
<tr class="even">
<td align="left">positive.consequences</td>
<td align="left">0.12</td>
<td align="left">0.02</td>
<td align="left">5.83</td>
<td align="left">0.00</td>
</tr>
<tr class="odd">
<td align="left">goal.setting</td>
<td align="left">0.12</td>
<td align="left">0.02</td>
<td align="left">5.15</td>
<td align="left">0.00</td>
</tr>
<tr class="even">
<td align="left">PA.life.values</td>
<td align="left">0.12</td>
<td align="left">0.02</td>
<td align="left">4.63</td>
<td align="left">0.00</td>
</tr>
<tr class="odd">
<td align="left">new.PA.options</td>
<td align="left">0.09</td>
<td align="left">0.02</td>
<td align="left">4.49</td>
<td align="left">0.00</td>
</tr>
<tr class="even">
<td align="left">plan.by.other</td>
<td align="left">0.08</td>
<td align="left">0.02</td>
<td align="left">4.62</td>
<td align="left">0.00</td>
</tr>
<tr class="odd">
<td align="left">implementation.plan</td>
<td align="left">0.06</td>
<td align="left">0.02</td>
<td align="left">2.43</td>
<td align="left">0.02</td>
</tr>
<tr class="even">
<td align="left">PA.identity</td>
<td align="left">0.02</td>
<td align="left">0.02</td>
<td align="left">0.62</td>
<td align="left">0.53</td>
</tr>
<tr class="odd">
<td align="left">subgoals</td>
<td align="left">-0.01</td>
<td align="left">0.02</td>
<td align="left">-0.32</td>
<td align="left">0.75</td>
</tr>
<tr class="even">
<td align="left">barrier.identification</td>
<td align="left">-0.01</td>
<td align="left">0.03</td>
<td align="left">-0.56</td>
<td align="left">0.57</td>
</tr>
<tr class="odd">
<td align="left">coping.planning</td>
<td align="left">-0.02</td>
<td align="left">0.03</td>
<td align="left">-0.71</td>
<td align="left">0.48</td>
</tr>
<tr class="even">
<td align="left">reminder.of.plan</td>
<td align="left">-0.05</td>
<td align="left">0.02</td>
<td align="left">-2.17</td>
<td align="left">0.03</td>
</tr>
</tbody>
</table>
Estimates for Identified regulation
<caption>
(#tab:bct-sdt-regression)
</caption>
<caption>
**
</caption>
<table>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="left">estimate</th>
<th align="left">std.error</th>
<th align="left">statistic</th>
<th align="left">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="left">1.68</td>
<td align="left">0.08</td>
<td align="left">21.48</td>
<td align="left">0.00</td>
</tr>
<tr class="even">
<td align="left">positive.consequences</td>
<td align="left">0.13</td>
<td align="left">0.02</td>
<td align="left">6.52</td>
<td align="left">0.00</td>
</tr>
<tr class="odd">
<td align="left">PA.life.values</td>
<td align="left">0.12</td>
<td align="left">0.02</td>
<td align="left">4.87</td>
<td align="left">0.00</td>
</tr>
<tr class="even">
<td align="left">goal.setting</td>
<td align="left">0.10</td>
<td align="left">0.02</td>
<td align="left">4.30</td>
<td align="left">0.00</td>
</tr>
<tr class="odd">
<td align="left">new.PA.options</td>
<td align="left">0.07</td>
<td align="left">0.02</td>
<td align="left">3.75</td>
<td align="left">0.00</td>
</tr>
<tr class="even">
<td align="left">plan.by.other</td>
<td align="left">0.05</td>
<td align="left">0.02</td>
<td align="left">2.68</td>
<td align="left">0.01</td>
</tr>
<tr class="odd">
<td align="left">implementation.plan</td>
<td align="left">0.04</td>
<td align="left">0.02</td>
<td align="left">1.84</td>
<td align="left">0.07</td>
</tr>
<tr class="even">
<td align="left">coping.planning</td>
<td align="left">0.02</td>
<td align="left">0.03</td>
<td align="left">0.61</td>
<td align="left">0.54</td>
</tr>
<tr class="odd">
<td align="left">PA.identity</td>
<td align="left">0.01</td>
<td align="left">0.02</td>
<td align="left">0.58</td>
<td align="left">0.56</td>
</tr>
<tr class="even">
<td align="left">subgoals</td>
<td align="left">0.01</td>
<td align="left">0.02</td>
<td align="left">0.34</td>
<td align="left">0.74</td>
</tr>
<tr class="odd">
<td align="left">reminder.of.plan</td>
<td align="left">-0.02</td>
<td align="left">0.02</td>
<td align="left">-0.79</td>
<td align="left">0.43</td>
</tr>
<tr class="even">
<td align="left">barrier.identification</td>
<td align="left">-0.04</td>
<td align="left">0.02</td>
<td align="left">-1.65</td>
<td align="left">0.10</td>
</tr>
</tbody>
</table>
Estimates for Integrated regulation
<caption>
(#tab:bct-sdt-regression)
</caption>
<caption>
**
</caption>
<table>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="left">estimate</th>
<th align="left">std.error</th>
<th align="left">statistic</th>
<th align="left">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="left">1.30</td>
<td align="left">0.08</td>
<td align="left">16.13</td>
<td align="left">0.00</td>
</tr>
<tr class="even">
<td align="left">plan.by.other</td>
<td align="left">0.13</td>
<td align="left">0.02</td>
<td align="left">6.97</td>
<td align="left">0.00</td>
</tr>
<tr class="odd">
<td align="left">positive.consequences</td>
<td align="left">0.10</td>
<td align="left">0.02</td>
<td align="left">4.60</td>
<td align="left">0.00</td>
</tr>
<tr class="even">
<td align="left">goal.setting</td>
<td align="left">0.10</td>
<td align="left">0.02</td>
<td align="left">4.22</td>
<td align="left">0.00</td>
</tr>
<tr class="odd">
<td align="left">PA.life.values</td>
<td align="left">0.08</td>
<td align="left">0.03</td>
<td align="left">3.28</td>
<td align="left">0.00</td>
</tr>
<tr class="even">
<td align="left">new.PA.options</td>
<td align="left">0.07</td>
<td align="left">0.02</td>
<td align="left">3.62</td>
<td align="left">0.00</td>
</tr>
<tr class="odd">
<td align="left">implementation.plan</td>
<td align="left">0.06</td>
<td align="left">0.03</td>
<td align="left">2.34</td>
<td align="left">0.02</td>
</tr>
<tr class="even">
<td align="left">PA.identity</td>
<td align="left">0.04</td>
<td align="left">0.02</td>
<td align="left">1.60</td>
<td align="left">0.11</td>
</tr>
<tr class="odd">
<td align="left">subgoals</td>
<td align="left">0.01</td>
<td align="left">0.03</td>
<td align="left">0.59</td>
<td align="left">0.56</td>
</tr>
<tr class="even">
<td align="left">barrier.identification</td>
<td align="left">0.01</td>
<td align="left">0.03</td>
<td align="left">0.31</td>
<td align="left">0.76</td>
</tr>
<tr class="odd">
<td align="left">reminder.of.plan</td>
<td align="left">-0.01</td>
<td align="left">0.02</td>
<td align="left">-0.49</td>
<td align="left">0.62</td>
</tr>
<tr class="even">
<td align="left">coping.planning</td>
<td align="left">-0.01</td>
<td align="left">0.03</td>
<td align="left">-0.43</td>
<td align="left">0.67</td>
</tr>
</tbody>
</table>
Estimates for Introjected regulation
<caption>
(#tab:bct-sdt-regression)
</caption>
<caption>
**
</caption>
<table>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="left">estimate</th>
<th align="left">std.error</th>
<th align="left">statistic</th>
<th align="left">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="left">1.12</td>
<td align="left">0.10</td>
<td align="left">10.73</td>
<td align="left">0.00</td>
</tr>
<tr class="even">
<td align="left">PA.identity</td>
<td align="left">0.12</td>
<td align="left">0.03</td>
<td align="left">3.66</td>
<td align="left">0.00</td>
</tr>
<tr class="odd">
<td align="left">positive.consequences</td>
<td align="left">0.10</td>
<td align="left">0.03</td>
<td align="left">3.56</td>
<td align="left">0.00</td>
</tr>
<tr class="even">
<td align="left">barrier.identification</td>
<td align="left">0.07</td>
<td align="left">0.03</td>
<td align="left">2.19</td>
<td align="left">0.03</td>
</tr>
<tr class="odd">
<td align="left">goal.setting</td>
<td align="left">0.06</td>
<td align="left">0.03</td>
<td align="left">1.87</td>
<td align="left">0.06</td>
</tr>
<tr class="even">
<td align="left">reminder.of.plan</td>
<td align="left">0.04</td>
<td align="left">0.03</td>
<td align="left">1.23</td>
<td align="left">0.22</td>
</tr>
<tr class="odd">
<td align="left">implementation.plan</td>
<td align="left">0.02</td>
<td align="left">0.03</td>
<td align="left">0.62</td>
<td align="left">0.54</td>
</tr>
<tr class="even">
<td align="left">coping.planning</td>
<td align="left">0.01</td>
<td align="left">0.04</td>
<td align="left">0.36</td>
<td align="left">0.72</td>
</tr>
<tr class="odd">
<td align="left">new.PA.options</td>
<td align="left">-0.01</td>
<td align="left">0.03</td>
<td align="left">-0.42</td>
<td align="left">0.68</td>
</tr>
<tr class="even">
<td align="left">subgoals</td>
<td align="left">-0.02</td>
<td align="left">0.03</td>
<td align="left">-0.47</td>
<td align="left">0.64</td>
</tr>
<tr class="odd">
<td align="left">plan.by.other</td>
<td align="left">-0.03</td>
<td align="left">0.02</td>
<td align="left">-1.29</td>
<td align="left">0.20</td>
</tr>
<tr class="even">
<td align="left">PA.life.values</td>
<td align="left">-0.04</td>
<td align="left">0.03</td>
<td align="left">-1.32</td>
<td align="left">0.19</td>
</tr>
</tbody>
</table>
Estimates for Extrinsic regulation
<caption>
(#tab:bct-sdt-regression)
</caption>
<caption>
**
</caption>
<table>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="left">estimate</th>
<th align="left">std.error</th>
<th align="left">statistic</th>
<th align="left">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="left">1.53</td>
<td align="left">0.07</td>
<td align="left">20.85</td>
<td align="left">0.00</td>
</tr>
<tr class="even">
<td align="left">barrier.identification</td>
<td align="left">0.05</td>
<td align="left">0.02</td>
<td align="left">2.29</td>
<td align="left">0.02</td>
</tr>
<tr class="odd">
<td align="left">implementation.plan</td>
<td align="left">0.03</td>
<td align="left">0.02</td>
<td align="left">1.35</td>
<td align="left">0.18</td>
</tr>
<tr class="even">
<td align="left">PA.identity</td>
<td align="left">0.03</td>
<td align="left">0.02</td>
<td align="left">1.30</td>
<td align="left">0.19</td>
</tr>
<tr class="odd">
<td align="left">reminder.of.plan</td>
<td align="left">0.03</td>
<td align="left">0.02</td>
<td align="left">1.33</td>
<td align="left">0.19</td>
</tr>
<tr class="even">
<td align="left">plan.by.other</td>
<td align="left">0.02</td>
<td align="left">0.02</td>
<td align="left">1.42</td>
<td align="left">0.16</td>
</tr>
<tr class="odd">
<td align="left">positive.consequences</td>
<td align="left">0.02</td>
<td align="left">0.02</td>
<td align="left">0.96</td>
<td align="left">0.34</td>
</tr>
<tr class="even">
<td align="left">subgoals</td>
<td align="left">0.02</td>
<td align="left">0.02</td>
<td align="left">0.77</td>
<td align="left">0.44</td>
</tr>
<tr class="odd">
<td align="left">coping.planning</td>
<td align="left">0.00</td>
<td align="left">0.03</td>
<td align="left">0.06</td>
<td align="left">0.95</td>
</tr>
<tr class="even">
<td align="left">new.PA.options</td>
<td align="left">-0.02</td>
<td align="left">0.02</td>
<td align="left">-1.20</td>
<td align="left">0.23</td>
</tr>
<tr class="odd">
<td align="left">goal.setting</td>
<td align="left">-0.05</td>
<td align="left">0.02</td>
<td align="left">-2.44</td>
<td align="left">0.01</td>
</tr>
<tr class="even">
<td align="left">PA.life.values</td>
<td align="left">-0.09</td>
<td align="left">0.02</td>
<td align="left">-3.88</td>
<td align="left">0.00</td>
</tr>
</tbody>
</table>
</div>
<div id="pa-determinants-unregularised-correlations-visualised" class="section level1">
<h1>PA determinants: unregularised correlations visualised</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Network without motivation variables</span>
data &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="st">&#39;PA&#39;</span> =<span class="st"> </span>mvpaAccelerometer_T1, <span class="st">&#39;SB&#39;</span> =<span class="st"> </span>sitLieAccelerometer_T1,
<span class="st">&#39;fat%&#39;</span> =<span class="st"> </span>fatpct_T1,<span class="st">&#39;action planning&#39;</span> =<span class="st"> </span>PA_actionplan_T1, <span class="st">&#39;coping planning&#39;</span> =<span class="st"> </span>PA_copingplan_T1, <span class="st">&#39;frequency-related BCTs&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_T1, <span class="st">&#39;agreement-related BCTs&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_T1, <span class="st">&#39;amotivation&#39;</span> =<span class="st"> </span>PA_amotivation_T1, <span class="st">&#39;autonomous motivation&#39;</span> =<span class="st"> </span>PA_autonomous_T1, <span class="st">&#39;controlled motivation&#39;</span> =<span class="st"> </span>PA_controlled_T1, <span class="st">&#39;descriptive norm&#39;</span> =<span class="st"> </span>PA_descriptiveNorm_T1, <span class="st">&#39;injunctive norm&#39;</span> =<span class="st"> </span>PA_injunctiveNorm_T1, <span class="st">&#39;intention&#39;</span> =<span class="st"> </span>PA_intention_T1, <span class="st">&#39;outcome expectations&#39;</span> =<span class="st"> </span>PA_outcomeExpectations_T1, <span class="st">&#39;self-efficacy / perceivedBehaviouralControl&#39;</span> =<span class="st"> </span>PA_selfEfficacyperceivedBehaviouralControl_T1, <span class="st">&#39;perceived opportunities&#39;</span> =<span class="st"> </span>PA_opportunities_T1) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate_all</span>(as.numeric)

names &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="st">&#39;PA&#39;</span> =<span class="st"> </span>mvpaAccelerometer_T1, <span class="st">&#39;SB&#39;</span> =<span class="st"> </span>sitLieAccelerometer_T1,
<span class="st">&#39;fat%&#39;</span> =<span class="st"> </span>fatpct_T1,<span class="st">&#39;action planning&#39;</span> =<span class="st"> </span>PA_actionplan_T1, <span class="st">&#39;coping planning&#39;</span> =<span class="st"> </span>PA_copingplan_T1, <span class="st">&#39;frequency-related BCTs&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_T1, <span class="st">&#39;agreement-related BCTs&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_T1, <span class="st">&#39;amotivation&#39;</span> =<span class="st"> </span>PA_amotivation_T1, <span class="st">&#39;autonomous motivation&#39;</span> =<span class="st"> </span>PA_autonomous_T1, <span class="st">&#39;controlled motivation&#39;</span> =<span class="st"> </span>PA_controlled_T1, <span class="st">&#39;descriptive norm&#39;</span> =<span class="st"> </span>PA_descriptiveNorm_T1, <span class="st">&#39;injunctive norm&#39;</span> =<span class="st"> </span>PA_injunctiveNorm_T1, <span class="st">&#39;intention&#39;</span> =<span class="st"> </span>PA_intention_T1, <span class="st">&#39;outcome expectations&#39;</span> =<span class="st"> </span>PA_outcomeExpectations_T1, <span class="st">&#39;self-efficacy / perceivedBehaviouralControl&#39;</span> =<span class="st"> </span>PA_selfEfficacyperceivedBehaviouralControl_T1, <span class="st">&#39;perceived opportunities&#39;</span> =<span class="st"> </span>PA_opportunities_T1) <span class="op">%&gt;%</span><span class="st"> </span>names

<span class="co"># Spinglass algorithm detects communities. Tutorial here: http://psych-networks.com/r-tutorial-identify-communities-items-networks/</span>

cormatrix &lt;-<span class="st"> </span><span class="kw">cor_auto</span>(data) 
## Error in cor_auto(data): could not find function &quot;cor_auto&quot;

piefill &lt;-<span class="st"> </span>data <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">summarise_all</span>(<span class="kw">funs</span>(<span class="kw">mean</span>(., <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate_at</span>(<span class="kw">vars</span>(PA, SB),
            <span class="kw">funs</span>(. <span class="op">/</span><span class="st"> </span>(<span class="dv">24</span><span class="op">*</span><span class="dv">60</span>))) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># proportion of day used doing the behaviour</span>
<span class="st">  </span><span class="kw">mutate_at</span>(<span class="kw">vars</span>(<span class="st">`</span><span class="dt">action planning</span><span class="st">`</span>, <span class="st">`</span><span class="dt">coping planning</span><span class="st">`</span>),
            <span class="kw">funs</span>(. <span class="op">/</span><span class="st"> </span><span class="dv">4</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate_at</span>(<span class="kw">vars</span>(<span class="dv">6</span><span class="op">:</span><span class="kw">ncol</span>(data)),
            <span class="kw">funs</span>(. <span class="op">/</span><span class="st"> </span><span class="dv">7</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate_at</span>(<span class="kw">vars</span>(<span class="st">`</span><span class="dt">fat%</span><span class="st">`</span>),
            <span class="kw">funs</span>(. <span class="op">/</span><span class="st"> </span><span class="dv">100</span>))  

nodeColors &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">rep</span>(viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">7</span>, <span class="dt">begin =</span> <span class="fl">0.3</span>, <span class="dt">end =</span> <span class="dv">1</span>)[<span class="dv">1</span>], <span class="dv">2</span>), <span class="co"># PA, SB</span>
                <span class="kw">rep</span>(viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">7</span>, <span class="dt">begin =</span> <span class="fl">0.3</span>, <span class="dt">end =</span> <span class="dv">1</span>)[<span class="dv">2</span>], <span class="dv">1</span>), <span class="co"># fat</span>
                <span class="kw">rep</span>(viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">7</span>, <span class="dt">begin =</span> <span class="fl">0.3</span>, <span class="dt">end =</span> <span class="dv">1</span>)[<span class="dv">3</span>], <span class="dv">2</span>), <span class="co"># Action, coping planning</span>
                <span class="kw">rep</span>(viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">7</span>, <span class="dt">begin =</span> <span class="fl">0.3</span>, <span class="dt">end =</span> <span class="dv">1</span>)[<span class="dv">4</span>], <span class="dv">2</span>), <span class="co"># 2x bcts</span>
                <span class="kw">rep</span>(viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">7</span>, <span class="dt">begin =</span> <span class="fl">0.3</span>, <span class="dt">end =</span> <span class="dv">1</span>)[<span class="dv">5</span>], <span class="dv">3</span>), <span class="co"># Motivations</span>
                <span class="kw">rep</span>(viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">7</span>, <span class="dt">begin =</span> <span class="fl">0.3</span>, <span class="dt">end =</span> <span class="dv">1</span>)[<span class="dv">6</span>], <span class="dv">2</span>), <span class="co"># norms</span>
                <span class="kw">rep</span>(viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">7</span>, <span class="dt">begin =</span> <span class="fl">0.3</span>, <span class="dt">end =</span> <span class="dv">1</span>)[<span class="dv">7</span>], <span class="dv">1</span>), <span class="co"># intention</span>
                <span class="kw">rep</span>(viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">7</span>, <span class="dt">begin =</span> <span class="fl">0.3</span>, <span class="dt">end =</span> <span class="dv">1</span>)[<span class="dv">6</span>], <span class="dv">3</span>)) <span class="co"># OE, SE/perceivedBehaviouralControl, Opportunities</span>


<span class="kw">qgraph</span>(<span class="kw">cor_auto</span>(data), <span class="dt">layout =</span> <span class="st">&quot;spring&quot;</span>, <span class="dt">labels =</span> <span class="ot">TRUE</span>, 
       <span class="co"># groups = group.spinglass, </span>
     <span class="dt">color=</span>nodeColors,
     <span class="dt">label.cex =</span> <span class="fl">0.75</span>,
     <span class="dt">label.scale =</span> <span class="ot">TRUE</span>,
     <span class="dt">pie =</span> piefill, 
     <span class="dt">color =</span> <span class="st">&quot;skyblue&quot;</span>,
     <span class="dt">nodeNames =</span> names,
     <span class="dt">pieBorder =</span> <span class="dv">1</span>,
     <span class="dt">legend.cex =</span> <span class="fl">0.4</span>,
     <span class="dt">theme =</span> <span class="st">&quot;colorblind&quot;</span>,
     <span class="dt">edge.labels =</span> <span class="ot">TRUE</span>,
     <span class="dt">edge.label.cex =</span> <span class="fl">0.75</span>,
     <span class="dt">minimum =</span> <span class="fl">0.1</span>,
     <span class="dt">title =</span> <span class="st">&quot;Bivariate correlations of PA determinants (&lt;0.1 not shown)&quot;</span>)
## Error in qgraph(cor_auto(data), layout = &quot;spring&quot;, labels = TRUE, color = nodeColors, : could not find function &quot;qgraph&quot;</code></pre></div>
<!-- Out of a hundred iterations, spinglass algorithm found `  table(matrix_spinglass)[[1]]` instances of ` table(matrix_spinglass)[1] %>% names` communities, `  table(matrix_spinglass)[[2]]` instances of `  table(matrix_spinglass)[2] %>% names` communities, and `  table(matrix_spinglass)[[3]]` instances of `  table(matrix_spinglass)[3] %>% names` communities. Thus, a random seed which found four communities was chosen.   -->
<div id="symptom-network-all" class="section level2">
<h2>Symptom network: all</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
sympdf &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(id,
  intervention,
  group,
  school,
  girl,
  <span class="st">&quot;Neck and shoulder pain&quot;</span> =<span class="st"> </span>symptom_neckShoulderPain_T1,
  <span class="st">&quot;Lower back pain&quot;</span> =<span class="st"> </span>symptom_lowerBackPain_T1,
  <span class="st">&quot;Stomach ache&quot;</span> =<span class="st"> </span>symptom_stomachAche_T1,
  <span class="st">&quot;Tension or nervousness&quot;</span> =<span class="st"> </span>symptom_tensionNervousness_T1,
  <span class="st">&quot;Irritability or anger bursts&quot;</span> =<span class="st"> </span>symptom_irritabilityAngerbursts_T1,
  <span class="st">&quot;Difficulty with sleep&quot;</span> =<span class="st"> </span>symptom_sleepDifficulty_T1,
  <span class="st">&quot;Headache&quot;</span> =<span class="st"> </span>symptom_headAche_T1,
  <span class="st">&quot;Tiredness or faintness&quot;</span> =<span class="st"> </span>symptom_tirednessFaintness_T1,
  <span class="st">&quot;Fat pct&quot;</span> =<span class="st"> </span>fatpct_T1,
  <span class="st">&quot;PA&quot;</span> =<span class="st"> </span>mvpaAccelerometer_T1,
  <span class="st">&quot;SB&quot;</span> =<span class="st"> </span>sitLieAccelerometer_T1
) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(
    <span class="st">&#39;Neck and shoulder pain&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">Neck and shoulder pain</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
    <span class="st">&#39;Lower back pain&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">Lower back pain</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
    <span class="st">&#39;Stomach ache&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">Stomach ache</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
    <span class="st">&#39;Tension or nervousness&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">Tension or nervousness</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
    <span class="st">&#39;Irritability or anger bursts&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">Irritability or anger bursts</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
    <span class="st">&#39;Difficulty with sleep&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">Difficulty with sleep</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
    <span class="st">&#39;Headache&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">Headache</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
    <span class="st">&#39;Tiredness or faintness&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">Tiredness or faintness</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
    <span class="st">&#39;Fat pct&#39;</span> =<span class="st"> `</span><span class="dt">Fat pct</span><span class="st">`</span> <span class="op">/</span><span class="st"> </span><span class="dv">100</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>data.frame

S.all &lt;-<span class="st"> </span>sympdf <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="dv">6</span><span class="op">:</span><span class="kw">ncol</span>(sympdf)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">na.omit</span>(.) 

nwAll &lt;-<span class="st"> </span>bootnet<span class="op">::</span><span class="kw">estimateNetwork</span>(S.all, <span class="dt">default=</span><span class="st">&quot;mgm&quot;</span>)

allmeans &lt;-<span class="st"> </span>sympdf <span class="op">%&gt;%</span><span class="st">  </span>
<span class="st">  </span><span class="kw">summarise_at</span>(<span class="kw">vars</span>(<span class="dv">6</span><span class="op">:</span><span class="dv">16</span>),
  <span class="kw">funs</span>(<span class="kw">mean</span>(., <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))) <span class="op">%&gt;%</span><span class="st">  </span>
<span class="st">  </span><span class="kw">mutate_at</span>(<span class="kw">vars</span>(PA, SB),
            <span class="kw">funs</span>(. <span class="op">/</span><span class="st"> </span>(<span class="dv">24</span><span class="op">*</span><span class="dv">60</span>)))  <span class="co"># proportion of day used doing the behaviour</span>


<span class="kw">plot</span>(nwAll, <span class="dt">label.scale =</span> <span class="ot">FALSE</span>, <span class="dt">title =</span> <span class="st">&quot;All&quot;</span>, <span class="dt">label.cex =</span> <span class="fl">0.75</span>, 
     <span class="dt">pie =</span> allmeans, 
     <span class="dt">color =</span> <span class="st">&quot;skyblue&quot;</span>,
     <span class="dt">pieBorder =</span> <span class="dv">1</span>)</code></pre></div>
<p><img src="baseline-networks_files/figure-html/symptoms-all-1.png" width="2100" /></p>
</div>
<div id="symptom-network-boys-and-girls" class="section level2">
<h2>Symptom network: boys and girls</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
sympdf &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(id,
  intervention,
  group,
  school,
  girl,
  <span class="st">&quot;Neck and shoulder pain&quot;</span> =<span class="st"> </span>symptom_neckShoulderPain_T1,
  <span class="st">&quot;Lower back pain&quot;</span> =<span class="st"> </span>symptom_lowerBackPain_T1,
  <span class="st">&quot;Stomach ache&quot;</span> =<span class="st"> </span>symptom_stomachAche_T1,
  <span class="st">&quot;Tension or nervousness&quot;</span> =<span class="st"> </span>symptom_tensionNervousness_T1,
  <span class="st">&quot;Irritability or anger bursts&quot;</span> =<span class="st"> </span>symptom_irritabilityAngerbursts_T1,
  <span class="st">&quot;Difficulty with sleep&quot;</span> =<span class="st"> </span>symptom_sleepDifficulty_T1,
  <span class="st">&quot;Headache&quot;</span> =<span class="st"> </span>symptom_headAche_T1,
  <span class="st">&quot;Tiredness or faintness&quot;</span> =<span class="st"> </span>symptom_tirednessFaintness_T1,
  <span class="st">&quot;Fat pct&quot;</span> =<span class="st"> </span>fatpct_T1,
  <span class="st">&quot;PA&quot;</span> =<span class="st"> </span>mvpaAccelerometer_T1,
  <span class="st">&quot;SB&quot;</span> =<span class="st"> </span>sitLieAccelerometer_T1
) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(
    <span class="st">&#39;Neck and shoulder pain&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">Neck and shoulder pain</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
    <span class="st">&#39;Lower back pain&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">Lower back pain</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
    <span class="st">&#39;Stomach ache&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">Stomach ache</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
    <span class="st">&#39;Tension or nervousness&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">Tension or nervousness</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
    <span class="st">&#39;Irritability or anger bursts&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">Irritability or anger bursts</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
    <span class="st">&#39;Difficulty with sleep&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">Difficulty with sleep</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
    <span class="st">&#39;Headache&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">Headache</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
    <span class="st">&#39;Tiredness or faintness&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">Tiredness or faintness</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
    <span class="st">&#39;Fat pct&#39;</span> =<span class="st"> `</span><span class="dt">Fat pct</span><span class="st">`</span> <span class="op">/</span><span class="st"> </span><span class="dv">100</span>)

S.boys &lt;-<span class="st"> </span>sympdf <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(girl <span class="op">==</span><span class="st"> &quot;boy&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="st">&quot;Neck and shoulder pain&quot;</span><span class="op">:</span><span class="kw">ncol</span>(sympdf)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">na.omit</span>(.) 
S.girls &lt;-<span class="st"> </span>sympdf <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(girl <span class="op">==</span><span class="st"> &quot;girl&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="st">&quot;Neck and shoulder pain&quot;</span><span class="op">:</span><span class="kw">ncol</span>(sympdf)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">na.omit</span>(.)
nwBoys &lt;-<span class="st"> </span>bootnet<span class="op">::</span><span class="kw">estimateNetwork</span>(S.boys, <span class="dt">default=</span><span class="st">&quot;mgm&quot;</span>)
nwGirls &lt;-<span class="st"> </span>bootnet<span class="op">::</span><span class="kw">estimateNetwork</span>(S.girls, <span class="dt">default=</span><span class="st">&quot;mgm&quot;</span>)

girlmeans &lt;-<span class="st"> </span>sympdf <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(girl) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarise_at</span>(<span class="kw">vars</span>(<span class="st">&quot;Neck and shoulder pain&quot;</span><span class="op">:</span><span class="st">&quot;SB&quot;</span>),
  <span class="kw">funs</span>(<span class="kw">mean</span>(., <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(girl <span class="op">==</span><span class="st"> &quot;girl&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate_at</span>(<span class="kw">vars</span>(PA, SB),
            <span class="kw">funs</span>(. <span class="op">/</span><span class="st"> </span>(<span class="dv">24</span><span class="op">*</span><span class="dv">60</span>))) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># proportion of day used doing the behaviour</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>(girl))

boymeans &lt;-<span class="st"> </span>sympdf <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(girl) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarise_at</span>(<span class="kw">vars</span>(<span class="st">&quot;Neck and shoulder pain&quot;</span><span class="op">:</span><span class="st">&quot;SB&quot;</span>),
  <span class="kw">funs</span>(<span class="kw">mean</span>(., <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(girl <span class="op">==</span><span class="st"> &quot;boy&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate_at</span>(<span class="kw">vars</span>(PA, SB),
            <span class="kw">funs</span>(. <span class="op">/</span><span class="st"> </span>(<span class="dv">24</span><span class="op">*</span><span class="dv">60</span>))) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># proportion of day used doing the behaviour</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>(girl))


<span class="kw">layout</span>(<span class="kw">t</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>))
<span class="kw">plot</span>(nwGirls, <span class="dt">label.scale =</span> <span class="ot">FALSE</span>, <span class="dt">title =</span> <span class="st">&quot;Girls&quot;</span>, <span class="dt">label.cex =</span> <span class="fl">0.75</span>,
     <span class="dt">pie =</span> girlmeans, 
     <span class="dt">color =</span> <span class="st">&quot;skyblue&quot;</span>,
     <span class="dt">pieBorder =</span> <span class="dv">1</span>)

<span class="kw">plot</span>(nwBoys, <span class="dt">label.scale =</span> <span class="ot">FALSE</span>, <span class="dt">title =</span> <span class="st">&quot;Boys&quot;</span>, <span class="dt">label.cex =</span> <span class="fl">0.75</span>, 
     <span class="dt">pie =</span> boymeans, 
     <span class="dt">color =</span> <span class="st">&quot;skyblue&quot;</span>,
     <span class="dt">pieBorder =</span> <span class="dv">1</span>)</code></pre></div>
<p><img src="baseline-networks_files/figure-html/symptoms-boygirl-1.png" width="2100" /></p>
</div>
<div id="symptom-network-educational-tracks" class="section level2">
<h2>symptom network: educational tracks</h2>
</div>
</div>
<div id="pa-determinant-network" class="section level1">
<h1>PA determinant network</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
data &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(
    <span class="st">&quot;MVPA accelerometer&quot;</span> =<span class="st"> </span>mvpaAccelerometer_T1, 
    <span class="st">&quot;planning&quot;</span> =<span class="st"> </span>PA_actCop_T1, 
    <span class="st">&quot;BCT&quot;</span> =<span class="st"> </span>PA_frequencyDependentBCT_T1, 
    <span class="st">&quot;amotivation&quot;</span> =<span class="st"> </span>PA_amotivation_T1, 
    <span class="st">&quot;autonomous&quot;</span> =<span class="st"> </span>PA_autonomous_T1, 
    <span class="st">&quot;controlled&quot;</span> =<span class="st"> </span>PA_controlled_T1, 
    <span class="st">&quot;descriptive norm&quot;</span> =<span class="st"> </span>PA_descriptiveNorm_T1, 
    <span class="st">&quot;fat pct&quot;</span> =<span class="st"> </span>fatpct_T1, 
    <span class="st">&quot;injunctive norm&quot;</span> =<span class="st"> </span>PA_injunctiveNorm_T1, 
    <span class="st">&quot;intention&quot;</span> =<span class="st"> </span>PA_intention_T1, 
    <span class="st">&quot;outcome expectations&quot;</span> =<span class="st"> </span>PA_outcomeExpectations_T1, 
    <span class="st">&quot;opportunities&quot;</span> =<span class="st"> </span>PA_opportunities_T1, 
    <span class="st">&quot;self-efficacy perceivedBehaviouralControl&quot;</span> =<span class="st"> </span>PA_selfEfficacyperceivedBehaviouralControl_T1) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate_all</span>(<span class="kw">funs</span>(<span class="kw">as.numeric</span>(.))) 

covMatrix &lt;-<span class="st"> </span>data <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">cov</span>(<span class="dt">use =</span> <span class="st">&quot;pairwise.complete.obs&quot;</span>)

<span class="co"># Transform the matrix so, that lower diagonal of the matrix shows partial correlations,</span>
<span class="co"># while the upper one shows bivariate correlations.</span>
matrix_corLower_parcorUpper &lt;-<span class="st"> </span>covMatrix <span class="op">%&gt;%</span><span class="st"> </span>ggm<span class="op">::</span><span class="kw">correlations</span>()

<span class="co"># Show the matrix</span>
matrix_corLower_parcorUpper <span class="op">%&gt;%</span><span class="st"> </span>papaja<span class="op">::</span><span class="kw">apa_table</span>(<span class="dt">caption =</span> <span class="st">&quot;Correlation matrix of hypothesised determinants. Lower diagonal shows bivariate correlations, upper diagonal shows partial correlations&quot;</span>)
## &lt;caption&gt;(\#tab:determinants)&lt;/caption&gt;
## 
## &lt;caption&gt;*Correlation matrix of hypothesised determinants. Lower diagonal shows bivariate correlations, upper diagonal shows partial correlations*&lt;/caption&gt;
## 
## 
## 
##                                             MVPA accelerometer   planning   BCT     amotivation   autonomous   controlled   descriptive norm   fat pct   injunctive norm   intention   outcome expectations   opportunities   self-efficacy perceivedBehaviouralControl 
## ------------------------------------------  -------------------  ---------  ------  ------------  -----------  -----------  -----------------  --------  ----------------  ----------  ---------------------  --------------  ------------------------------------------
## MVPA accelerometer                          1.00                 0.02       0.06    -0.10         0.11         0.02         -0.03              -0.07     -0.01             0.00        -0.09                  -0.03           0.05                                      
## planning                                    0.17                 1.00       0.23    0.04          0.27         0.00         0.01               -0.03     0.04              0.25        -0.02                  0.12            0.05                                      
## BCT                                         0.16                 0.47       1.00    0.10          0.26         0.12         0.02               0.06      -0.01             0.06        0.01                   -0.01           -0.11                                     
## amotivation                                 -0.15                -0.25      -0.08   1.00          -0.15        0.29         0.03               -0.07     -0.02             -0.24       -0.14                  -0.12           0.05                                      
## autonomous                                  0.22                 0.62       0.51    -0.37         1.00         0.16         0.08               -0.18     -0.05             0.25        0.32                   0.04            0.08                                      
## controlled                                  0.01                 0.09       0.23    0.26          0.13         1.00         -0.02              0.14      0.16              0.00        0.02                   -0.08           -0.13                                     
## descriptive norm                            0.06                 0.33       0.21    -0.18         0.37         0.04         1.00               -0.05     0.38              0.15        0.00                   0.14            0.05                                      
## fat pct                                     -0.11                -0.12      -0.02   0.03          -0.17        0.12         -0.09              1.00      0.02              0.03        0.11                   0.02            -0.06                                     
## injunctive norm                             0.03                 0.23       0.15    -0.11         0.23         0.15         0.47               0.00      1.00              0.04        0.08                   0.04            0.06                                      
## intention                                   0.15                 0.57       0.37    -0.43         0.63         0.02         0.40               -0.08     0.26              1.00        0.04                   -0.03           0.11                                      
## outcome expectations                        0.05                 0.35       0.26    -0.35         0.54         0.04         0.28               0.01      0.24              0.42        1.00                   0.12            0.06                                      
## opportunities                               0.06                 0.33       0.14    -0.31         0.35         -0.11        0.33               -0.06     0.22              0.33        0.35                   1.00            0.27                                      
## self-efficacy perceivedBehaviouralControl   0.10                 0.28       0.06    -0.22         0.32         -0.15        0.27               -0.12     0.20              0.33        0.28                   0.42            1.00

<span class="co"># Plot the matrix as a correlogram</span>
matrix_corLower_parcorUpper <span class="op">%&gt;%</span><span class="st"> </span>corrgram<span class="op">::</span><span class="kw">corrgram</span>(
  <span class="dt">type =</span> <span class="st">&quot;cor&quot;</span>,
  <span class="dt">lower.panel =</span> corrgram<span class="op">::</span>panel.pie,
  <span class="dt">upper.panel =</span> corrgram<span class="op">::</span>panel.pie,
  <span class="dt">main =</span> <span class="st">&quot;Bivariate (upper diagonal) and partial (lower diagonal)</span><span class="ch">\n</span><span class="st">correlations of PA determinants&quot;</span>)</code></pre></div>
<p><img src="baseline-networks_files/figure-html/determinants-1.png" width="2100" /></p>
<div id="ggm-estimation-1" class="section level2">
<h2>ggm estimation</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># Estimate a network</span>

determinants_ggm_network &lt;-<span class="st"> </span>bootnet<span class="op">::</span><span class="kw">estimateNetwork</span>(data, <span class="dt">default=</span><span class="st">&quot;EBICglasso&quot;</span>)

bootnetgraph &lt;-<span class="st"> </span><span class="kw">plot</span>(determinants_ggm_network, <span class="dt">edge.labels =</span> <span class="ot">TRUE</span>, <span class="dt">labels =</span> <span class="kw">names</span>(data), <span class="dt">label.scale =</span> <span class="ot">FALSE</span>,
       <span class="dt">title =</span> <span class="st">&quot;partial correlation network, with LASSO regularisation and EBIC model selection&quot;</span>)</code></pre></div>
<p><img src="baseline-networks_files/figure-html/determinants-ggm-1.png" width="2100" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
corgraph &lt;-<span class="st"> </span>qgraph<span class="op">::</span><span class="kw">qgraph</span>(qgraph<span class="op">::</span><span class="kw">cor_auto</span>(data), <span class="dt">graph =</span> <span class="st">&quot;cor&quot;</span>,
       <span class="dt">labels =</span> <span class="kw">names</span>(data),
       <span class="dt">label.scale =</span> <span class="ot">FALSE</span>,
       <span class="dt">edge.labels =</span> <span class="ot">TRUE</span>, 
       <span class="dt">title =</span> <span class="st">&quot;bivariate correlation network&quot;</span>)</code></pre></div>
<p><img src="baseline-networks_files/figure-html/determinants-ggm-2.png" width="2100" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
pcorgraph &lt;-<span class="st"> </span>qgraph<span class="op">::</span><span class="kw">qgraph</span>(qgraph<span class="op">::</span><span class="kw">cor_auto</span>(data), <span class="dt">graph =</span> <span class="st">&quot;pcor&quot;</span>,
       <span class="dt">labels =</span> <span class="kw">names</span>(data),
       <span class="dt">label.scale =</span> <span class="ot">FALSE</span>,
       <span class="dt">edge.labels =</span> <span class="ot">TRUE</span>, 
       <span class="dt">title =</span> <span class="st">&quot;partial correlation network&quot;</span>)</code></pre></div>
<p><img src="baseline-networks_files/figure-html/determinants-ggm-3.png" width="2100" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># Average the layout and plot all according to that</span>
avlayout &lt;-<span class="st"> </span>qgraph<span class="op">::</span><span class="kw">averageLayout</span>(bootnetgraph, corgraph, pcorgraph)

corgraph &lt;-<span class="st"> </span>qgraph<span class="op">::</span><span class="kw">qgraph</span>(qgraph<span class="op">::</span><span class="kw">cor_auto</span>(data), <span class="dt">graph =</span> <span class="st">&quot;cor&quot;</span>,
       <span class="dt">labels =</span> <span class="kw">names</span>(data),
       <span class="dt">edge.labels =</span> <span class="ot">TRUE</span>, 
       <span class="dt">layout =</span> avlayout, 
       <span class="dt">title =</span> <span class="st">&quot;bivariate correlation network&quot;</span>,
       <span class="dt">theme =</span> <span class="st">&quot;colorblind&quot;</span>,
       <span class="dt">maximum =</span> <span class="kw">max</span>(<span class="kw">c</span>(bootnetgraph<span class="op">$</span>graph<span class="op">$</span>Graph<span class="op">$</span>maximum,
                     pcorgraph<span class="op">$</span>graph<span class="op">$</span>Graph<span class="op">$</span>maximum, 
                     corgraph<span class="op">$</span>graph<span class="op">$</span>Graph<span class="op">$</span>maximum)),
       <span class="dt">label.scale =</span> <span class="ot">FALSE</span>)</code></pre></div>
<p><img src="baseline-networks_files/figure-html/determinants-ggm-4.png" width="2100" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># To help with visual comparison, that last argument takes the maximum edge of the three </span>
<span class="co"># graphs and places that as the benchmark for the thickest line in all plots.</span>

pcorgraph &lt;-<span class="st"> </span>qgraph<span class="op">::</span><span class="kw">qgraph</span>(qgraph<span class="op">::</span><span class="kw">cor_auto</span>(data), <span class="dt">graph =</span> <span class="st">&quot;pcor&quot;</span>,
       <span class="dt">labels =</span> <span class="kw">names</span>(data),
       <span class="dt">edge.labels =</span> <span class="ot">TRUE</span>, 
       <span class="dt">layout =</span> avlayout,
       <span class="dt">title =</span> <span class="st">&quot;partial correlation network&quot;</span>,
       <span class="dt">theme =</span> <span class="st">&quot;colorblind&quot;</span>,
       <span class="dt">maximum =</span> <span class="kw">max</span>(<span class="kw">c</span>(bootnetgraph<span class="op">$</span>graph<span class="op">$</span>Graph<span class="op">$</span>maximum,
                     pcorgraph<span class="op">$</span>graph<span class="op">$</span>Graph<span class="op">$</span>maximum, 
                     corgraph<span class="op">$</span>graph<span class="op">$</span>Graph<span class="op">$</span>maximum)),
       <span class="dt">label.scale =</span> <span class="ot">FALSE</span>)</code></pre></div>
<p><img src="baseline-networks_files/figure-html/determinants-ggm-5.png" width="2100" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">


bootnetgraph &lt;-<span class="st"> </span><span class="kw">plot</span>(determinants_ggm_network, 
                     <span class="dt">edge.labels =</span> <span class="ot">TRUE</span>, 
                     <span class="dt">layout =</span> avlayout, 
                     <span class="dt">title =</span> <span class="st">&quot;partial correlation network, with LASSO regularisation and EBIC model selection&quot;</span>,
       <span class="dt">maximum =</span> <span class="kw">max</span>(<span class="kw">c</span>(bootnetgraph<span class="op">$</span>graph<span class="op">$</span>Graph<span class="op">$</span>maximum,
                     pcorgraph<span class="op">$</span>graph<span class="op">$</span>Graph<span class="op">$</span>maximum, 
                     corgraph<span class="op">$</span>graph<span class="op">$</span>Graph<span class="op">$</span>maximum)),
       <span class="dt">label.scale =</span> <span class="ot">FALSE</span>)</code></pre></div>
<p><img src="baseline-networks_files/figure-html/determinants-ggm-6.png" width="2100" /></p>
<p>A dressed-up version of the last graph. Pies indicate mean as a proportion of the maximum observed value in that variable in question.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
data &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(
    <span class="st">&quot;MVPA accelerometer&quot;</span> =<span class="st"> </span>mvpaAccelerometer_T1, 
    <span class="st">&quot;planning&quot;</span> =<span class="st"> </span>PA_actCop_T1, 
    <span class="st">&quot;BCT&quot;</span> =<span class="st"> </span>PA_frequencyDependentBCT_T1, 
    <span class="st">&quot;amotivation&quot;</span> =<span class="st"> </span>PA_amotivation_T1, 
    <span class="st">&quot;autonomous&quot;</span> =<span class="st"> </span>PA_autonomous_T1, 
    <span class="st">&quot;controlled&quot;</span> =<span class="st"> </span>PA_controlled_T1, 
    <span class="st">&quot;descriptive norm&quot;</span> =<span class="st"> </span>PA_descriptiveNorm_T1, 
    <span class="st">&quot;fat pct&quot;</span> =<span class="st"> </span>fatpct_T1, 
    <span class="st">&quot;injunctive norm&quot;</span> =<span class="st"> </span>PA_injunctiveNorm_T1, 
    <span class="st">&quot;intention&quot;</span> =<span class="st"> </span>PA_intention_T1, 
    <span class="st">&quot;outcome expectations&quot;</span> =<span class="st"> </span>PA_outcomeExpectations_T1, 
    <span class="st">&quot;opportunities&quot;</span> =<span class="st"> </span>PA_opportunities_T1, 
    <span class="st">&quot;self-efficacy perceivedBehaviouralControl&quot;</span> =<span class="st"> </span>PA_selfEfficacyperceivedBehaviouralControl_T1) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate_all</span>(<span class="kw">funs</span>(<span class="kw">as.numeric</span>(.))) 

piefill_determinantggm2 &lt;-<span class="st"> </span>data <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate_all</span>(<span class="kw">funs</span>(<span class="kw">mean</span>(., <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">/</span><span class="st"> </span><span class="kw">max</span>(., <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)))
piefill_determinantggm2 &lt;-<span class="st"> </span>piefill_determinantggm2[<span class="dv">1</span>, ]

itemGroups &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Objective&quot;</span>, <span class="st">&quot;Determinants&quot;</span>, <span class="st">&quot;BCTs&quot;</span>,
                <span class="kw">rep</span>(<span class="st">&quot;Motivation&quot;</span>, <span class="dv">3</span>),
                <span class="st">&quot;Determinants&quot;</span>, <span class="st">&quot;Objective&quot;</span>, 
                <span class="kw">rep</span>(<span class="st">&quot;Determinants&quot;</span>, <span class="dv">5</span>))

determinantgraph &lt;-<span class="st"> </span><span class="kw">plot</span>(
  determinants_ggm_network, 
  <span class="dt">edge.labels =</span> <span class="ot">FALSE</span>, 
  <span class="dt">layout =</span> <span class="st">&quot;spring&quot;</span>,
  <span class="dt">label.scale =</span> <span class="ot">FALSE</span>,
  <span class="dt">groups =</span> itemGroups,
  <span class="dt">pie =</span> piefill_determinantggm2,
  <span class="dt">cut =</span> <span class="fl">0.1</span>,
  <span class="dt">pieBorder =</span> <span class="dv">1</span>,
  <span class="dt">legend =</span> <span class="ot">FALSE</span>,
  <span class="dt">color =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">5</span>, <span class="dt">begin =</span> <span class="fl">0.5</span>, <span class="dt">option =</span> <span class="st">&quot;D&quot;</span>))</code></pre></div>
<p><img src="baseline-networks_files/figure-html/determinants-ggm-2-1.png" width="2100" /></p>
<div id="centrality-and-stability-5" class="section level3">
<h3>Centrality and stability</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
determinants_centralityPlot &lt;-<span class="st"> </span>qgraph<span class="op">::</span><span class="kw">centralityPlot</span>(bootnetgraph)</code></pre></div>
<p><img src="baseline-networks_files/figure-html/determinants-stability-1.png" width="2100" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
qgraph<span class="op">::</span><span class="kw">centralityPlot</span>(bootnetgraph, 
               <span class="dt">include =</span> <span class="kw">c</span>(<span class="st">&quot;Strength&quot;</span>, <span class="st">&quot;ExpectedInfluence&quot;</span>),
               <span class="dt">orderBy =</span> <span class="st">&quot;ExpectedInfluence&quot;</span>)</code></pre></div>
<p><img src="baseline-networks_files/figure-html/determinants-stability-2.png" width="2100" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
qgraph<span class="op">::</span><span class="kw">centrality</span>(bootnetgraph)<span class="op">$</span>InDegree
##                        MVPA accelerometer 
##                                 0.2905324 
##                                  planning 
##                                 0.9110305 
##                                       BCT 
##                                 0.7729136 
##                               amotivation 
##                                 0.8805057 
##                                autonomous 
##                                 1.6220700 
##                                controlled 
##                                 0.8539979 
##                          descriptive norm 
##                                 0.7951494 
##                                   fat pct 
##                                 0.3888870 
##                           injunctive norm 
##                                 0.6560123 
##                                 intention 
##                                 1.0500592 
##                      outcome expectations 
##                                 0.8061023 
##                             opportunities 
##                                 0.8265152 
## self-efficacy perceivedBehaviouralControl 
##                                 0.8052638
<span class="kw">scale</span>(qgraph<span class="op">::</span><span class="kw">centrality</span>(bootnetgraph)<span class="op">$</span>InDegree)
##                                                  [,1]
## MVPA accelerometer                        -1.67011385
## planning                                   0.28741329
## BCT                                       -0.14831351
## amotivation                                0.19111444
## autonomous                                 2.53057709
## controlled                                 0.10748854
## descriptive norm                          -0.07816478
## fat pct                                   -1.35982790
## injunctive norm                           -0.51710981
## intention                                  0.72601630
## outcome expectations                      -0.04361089
## opportunities                              0.02078722
## self-efficacy perceivedBehaviouralControl -0.04625615
## attr(,&quot;scaled:center&quot;)
## [1] 0.8199261
## attr(,&quot;scaled:scale&quot;)
## [1] 0.3169806
qgraph<span class="op">::</span><span class="kw">centrality</span>(bootnetgraph)<span class="op">$</span>Closeness
##                        MVPA accelerometer 
##                               0.004583714 
##                                  planning 
##                               0.008438259 
##                                       BCT 
##                               0.007590450 
##                               amotivation 
##                               0.007906269 
##                                autonomous 
##                               0.009583015 
##                                controlled 
##                               0.007846311 
##                          descriptive norm 
##                               0.006905966 
##                                   fat pct 
##                               0.005344166 
##                           injunctive norm 
##                               0.006253966 
##                                 intention 
##                               0.009407655 
##                      outcome expectations 
##                               0.008277120 
##                             opportunities 
##                               0.006704694 
## self-efficacy perceivedBehaviouralControl 
##                               0.005985898
qgraph<span class="op">::</span><span class="kw">centrality</span>(bootnetgraph)<span class="op">$</span>Betweenness
##                        MVPA accelerometer 
##                                         0 
##                                  planning 
##                                         2 
##                                       BCT 
##                                         2 
##                               amotivation 
##                                         8 
##                                autonomous 
##                                        44 
##                                controlled 
##                                        14 
##                          descriptive norm 
##                                        12 
##                                   fat pct 
##                                         0 
##                           injunctive norm 
##                                         2 
##                                 intention 
##                                        28 
##                      outcome expectations 
##                                         6 
##                             opportunities 
##                                        10 
## self-efficacy perceivedBehaviouralControl 
##                                         0

<span class="kw">cor</span>(qgraph<span class="op">::</span><span class="kw">centrality</span>(bootnetgraph)<span class="op">$</span>InDegree, qgraph<span class="op">::</span><span class="kw">centrality</span>(bootnetgraph)<span class="op">$</span>Betweenness, 
    <span class="dt">method =</span> <span class="st">&quot;spearman&quot;</span>) 
## [1] 0.7444904

<span class="co"># bootnet_stability_determinants &lt;- bootnet::bootnet(determinants_bootnet, nBoots=1000)</span>
<span class="co"># save(bootnet_stability_determinants, file = &quot;./Rdata_files/bootnet_stability_determinants.Rdata&quot;)</span>
<span class="kw">load</span>(<span class="st">&quot;./Rdata_files/bootnet_stability_determinants.Rdata&quot;</span>)

<span class="kw">plot</span>(bootnet_stability_determinants, <span class="dt">labels =</span> <span class="ot">TRUE</span>, <span class="dt">order =</span> <span class="st">&quot;sample&quot;</span>) </code></pre></div>
<p><img src="baseline-networks_files/figure-html/determinants-stability-3.png" width="2100" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(bootnet_stability_determinants, <span class="st">&quot;edge&quot;</span>, <span class="dt">plot =</span> <span class="st">&quot;difference&quot;</span>, <span class="dt">onlyNonZero =</span> <span class="ot">TRUE</span>, <span class="dt">order =</span> <span class="st">&quot;sample&quot;</span>)</code></pre></div>
<p><img src="baseline-networks_files/figure-html/determinants-stability-4.png" width="2100" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># bootnet_centrality_stability_determinants &lt;- bootnet::bootnet(determinants_bootnet, nBoots=1000,nCores=8, type=&quot;case&quot;)</span>
<span class="co"># save(bootnet_centrality_stability_determinants, file = &quot;./Rdata_files/bootnet_centrality_stability_determinants.Rdata&quot;)</span>
<span class="kw">load</span>(<span class="st">&quot;./Rdata_files/bootnet_centrality_stability_determinants.Rdata&quot;</span>)

<span class="kw">plot</span>(bootnet_centrality_stability_determinants)</code></pre></div>
<p><img src="baseline-networks_files/figure-html/determinants-stability-5.png" width="2100" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(bootnet_centrality_stability_determinants, <span class="dt">perNode=</span>T, <span class="st">&quot;strength&quot;</span>)</code></pre></div>
<p><img src="baseline-networks_files/figure-html/determinants-stability-6.png" width="2100" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
bootnet<span class="op">::</span><span class="kw">corStability</span>(bootnet_centrality_stability_determinants)
## === Correlation Stability Analysis === 
## 
## Sampling levels tested:
##    nPerson Drop%   n
## 1      291  75.0  91
## 2      382  67.2 105
## 3      472  59.5  93
## 4      563  51.7  95
## 5      654  43.9 107
## 6      744  36.1 111
## 7      835  28.3 101
## 8      926  20.5 106
## 9     1016  12.8  96
## 10    1107   5.0  95
## 
## Maximum drop proportions to retain correlation of 0.7 in at least 95% of the samples:
## 
## betweenness: 0.672
##   - For more accuracy, run bootnet(..., caseMin = 0.595, caseMax = 0.75) 
## 
## closeness: 0.75
##   - For more accuracy, run bootnet(..., caseMin = 0.672, caseMax = 1) 
## 
## strength: 0.75
##   - For more accuracy, run bootnet(..., caseMin = 0.672, caseMax = 1) 
## 
## Accuracy can also be increased by increasing both &#39;nBoots&#39; and &#39;caseN&#39;.</code></pre></div>
</div>
<div id="pa-network-without-sdt-motivations" class="section level3">
<h3>PA network without SDT motivations</h3>
</div>
<div id="pa-network-without-bcts-and-sdt" class="section level3">
<h3>PA network without BCTs and SDT</h3>
</div>
<div id="pa-network-without-bcts-and-sdt-intention-mvpa-fat" class="section level3">
<h3>PA network without BCTs and SDT, intention, MVPA, fat%</h3>
</div>
</div>
<div id="robustness-test" class="section level2">
<h2>Robustness test</h2>
</div>
<div id="centrality-stability" class="section level2">
<h2>Centrality stability</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">boot2 &lt;-<span class="st"> </span>bootnet<span class="op">::</span><span class="kw">bootnet</span>(Network1, <span class="dt">nBoots =</span> <span class="dv">2500</span>, <span class="dt">type =</span> <span class="st">&quot;case&quot;</span>, <span class="dt">nCores =</span> <span class="dv">2</span>)
bootnet<span class="op">::</span><span class="kw">corStability</span>(boot2)

<span class="kw">plot</span>(boot2)

<span class="kw">differenceTest</span>(boot1, <span class="st">&quot;auton&quot;</span>, <span class="st">&quot;intent&quot;</span>,  <span class="dt">measure =</span> <span class="kw">c</span>(<span class="st">&quot;strength&quot;</span>, <span class="st">&quot;closeness&quot;</span>, <span class="st">&quot;betweenness&quot;</span>))

<span class="kw">plot</span>(boot1, <span class="st">&quot;edge&quot;</span>, <span class="dt">plot =</span> <span class="st">&quot;difference&quot;</span>, <span class="dt">onlyNonZero =</span> <span class="ot">TRUE</span>, <span class="dt">order =</span> <span class="st">&quot;sample&quot;</span>)

<span class="kw">plot</span>(boot1, <span class="st">&quot;strength&quot;</span>)
<span class="kw">plot</span>(boot1, <span class="st">&quot;betweenness&quot;</span>)
<span class="kw">plot</span>(boot1, <span class="st">&quot;closeness&quot;</span>)</code></pre></div>
</div>
<div id="network-comparison-test-girls-and-boys" class="section level2">
<h2>Network comparison test: girls and boys</h2>
</div>
<div id="robustness-test-1" class="section level2">
<h2>Robustness test</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">data &lt;-<span class="st"> </span>data <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="dt">BCT =</span> agreementDependentBCT_T1,
    <span class="dt">AUT =</span> autonomous_T1,
    <span class="dt">Intn =</span> intention_T1,
    <span class="dt">perceivedBehaviouralControl =</span> perceivedBehaviouralControl_T1,
    <span class="dt">outcomeExpectations =</span> outcomeExpectations_T1,
    <span class="dt">descriptiveNorm =</span> norm_T1)

Network &lt;-<span class="st"> </span>bootnet<span class="op">::</span><span class="kw">estimateNetwork</span>(data, <span class="dt">default =</span> <span class="st">&quot;EBICglasso&quot;</span>)

boot1 &lt;-<span class="st"> </span>bootnet<span class="op">::</span><span class="kw">bootnet</span>(Network, <span class="dt">nBoots =</span> <span class="dv">2500</span>, <span class="dt">nCores =</span> <span class="dv">2</span>)

<span class="kw">plot</span>(boot1, <span class="dt">labels =</span> <span class="ot">TRUE</span>, <span class="dt">order =</span> <span class="st">&quot;sample&quot;</span>)

<span class="kw">plot</span>(Network, <span class="dt">layout =</span> <span class="st">&quot;spring&quot;</span>, <span class="dt">labels =</span> <span class="ot">TRUE</span>)

Network2 &lt;-<span class="st"> </span>bootnet<span class="op">::</span><span class="kw">estimateNetwork</span>(data, <span class="dt">default =</span> <span class="st">&quot;pcor&quot;</span>)
<span class="kw">plot</span>(Network2, <span class="dt">layout =</span> <span class="st">&quot;spring&quot;</span>, <span class="dt">labels =</span> <span class="ot">TRUE</span>)

boot1 &lt;-<span class="st"> </span>bootnet<span class="op">::</span><span class="kw">bootnet</span>(Network2, <span class="dt">nBoots =</span> <span class="dv">2500</span>, <span class="dt">nCores =</span> <span class="dv">2</span>)

qgraph<span class="op">::</span><span class="kw">centralityPlot</span>(Network)
qgraph<span class="op">::</span><span class="kw">centralityPlot</span>(Network2)</code></pre></div>
</div>
</div>
<div id="centrality-stability-1" class="section level1">
<h1>Centrality stability</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">boot2 &lt;-<span class="st"> </span>bootnet<span class="op">::</span><span class="kw">bootnet</span>(Network, <span class="dt">nBoots =</span> <span class="dv">2500</span>, <span class="dt">type =</span> <span class="st">&quot;case&quot;</span>, <span class="dt">nCores =</span> <span class="dv">2</span>)
bootnet<span class="op">::</span><span class="kw">corStability</span>(boot2)

<span class="kw">plot</span>(boot2)

<span class="kw">differenceTest</span>(boot1, <span class="st">&quot;AUT&quot;</span>, <span class="st">&quot;Intn&quot;</span>,  <span class="dt">measure =</span> <span class="kw">c</span>(<span class="st">&quot;strength&quot;</span>, <span class="st">&quot;closeness&quot;</span>, <span class="st">&quot;betweenness&quot;</span>))

<span class="kw">plot</span>(boot1, <span class="st">&quot;edge&quot;</span>, <span class="dt">plot =</span> <span class="st">&quot;difference&quot;</span>, <span class="dt">onlyNonZero =</span> <span class="ot">TRUE</span>, <span class="dt">order =</span> <span class="st">&quot;sample&quot;</span>)

<span class="kw">plot</span>(boot1, <span class="st">&quot;strength&quot;</span>)
<span class="kw">plot</span>(boot1, <span class="st">&quot;betweenness&quot;</span>)
<span class="kw">plot</span>(boot1, <span class="st">&quot;closeness&quot;</span>)</code></pre></div>
</div>
<div id="pa-motivation-examined" class="section level1">
<h1>PA motivation examined</h1>
<div id="motivation-correlation-matrix" class="section level2">
<h2>Motivation correlation matrix</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">regulations.df &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(
  mvpaAccelerometer_T1,
  padaysLastweek_T1,
  PA_amotivation_02_T1,
  PA_amotivation_01_T1,
  PA_amotivation_03_T1,
  PA_amotivation_04_T1,
  PA_extrinsic_01_T1,
  PA_extrinsic_02_T1,
  PA_extrinsic_03_T1,
  PA_introjected_01_T1,
  PA_introjected_02_T1,
  PA_identified_01_T1,
  PA_identified_02_T1,
  PA_identified_03_T1,
  PA_integrated_01_T1, 
  PA_integrated_02_T1,
  PA_integrated_03_T1, 
  PA_intrinsic_01_T1,
  PA_intrinsic_02_T1,
  PA_intrinsic_03_T1,
  <span class="dt">Autonomous_sumscore =</span> PA_autonomous_T1,
  <span class="dt">Controlled_sumscore =</span> PA_controlled_T1,
  weartimeAccelerometer_T1) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">mvpaAccelerometer_percentageWeartime_T1 =</span> mvpaAccelerometer_T1 <span class="op">/</span><span class="st"> </span>weartimeAccelerometer_T1)

<span class="co"># Create a covariance matrix of the data</span>
covMatrix &lt;-<span class="st"> </span>regulations.df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">cov</span>(<span class="dt">use =</span> <span class="st">&quot;pairwise.complete.obs&quot;</span>)

<span class="co"># Transform the matrix so, that lower diagonal of the matrix shows partial correlations,</span>
<span class="co"># while the upper one shows bivariate correlations.</span>
matrix_corLower_parcorUpper &lt;-<span class="st"> </span>covMatrix <span class="op">%&gt;%</span><span class="st"> </span>ggm<span class="op">::</span><span class="kw">correlations</span>()

<span class="co"># Show the matrix</span>
matrix_corLower_parcorUpper <span class="op">%&gt;%</span><span class="st"> </span>papaja<span class="op">::</span><span class="kw">apa_table</span>(<span class="dt">caption =</span> <span class="st">&quot;Correlation matrix of key variables of interest. Lower diagonal shows bivariate correlations, upper diagonal shows partial correlations&quot;</span>)</code></pre></div>
<caption>
(#tab:motivation-corrmatrix)
</caption>
<caption>
<em>Correlation matrix of key variables of interest. Lower diagonal shows bivariate correlations, upper diagonal shows partial correlations</em>
</caption>
<table>
<thead>
<tr class="header">
<th></th>
<th align="left">mvpaAccelerometer_T1</th>
<th align="left">padaysLastweek_T1</th>
<th align="left">PA_amotivation_02_T1</th>
<th align="left">PA_amotivation_01_T1</th>
<th align="left">PA_amotivation_03_T1</th>
<th align="left">PA_amotivation_04_T1</th>
<th align="left">PA_extrinsic_01_T1</th>
<th align="left">PA_extrinsic_02_T1</th>
<th align="left">PA_extrinsic_03_T1</th>
<th align="left">PA_introjected_01_T1</th>
<th align="left">PA_introjected_02_T1</th>
<th align="left">PA_identified_01_T1</th>
<th align="left">PA_identified_02_T1</th>
<th align="left">PA_identified_03_T1</th>
<th align="left">PA_integrated_01_T1</th>
<th align="left">PA_integrated_02_T1</th>
<th align="left">PA_integrated_03_T1</th>
<th align="left">PA_intrinsic_01_T1</th>
<th align="left">PA_intrinsic_02_T1</th>
<th align="left">PA_intrinsic_03_T1</th>
<th align="left">Autonomous_sumscore</th>
<th align="left">Controlled_sumscore</th>
<th align="left">weartimeAccelerometer_T1</th>
<th align="left">mvpaAccelerometer_percentageWeartime_T1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>mvpaAccelerometer_T1</td>
<td align="left">1.00</td>
<td align="left">0.10</td>
<td align="left">0.01</td>
<td align="left">-0.04</td>
<td align="left">-0.02</td>
<td align="left">0.01</td>
<td align="left">-0.05</td>
<td align="left">-0.07</td>
<td align="left">-0.06</td>
<td align="left">-0.05</td>
<td align="left">-0.06</td>
<td align="left">0.02</td>
<td align="left">0.01</td>
<td align="left">0.03</td>
<td align="left">0.08</td>
<td align="left">0.01</td>
<td align="left">0.03</td>
<td align="left">0.05</td>
<td align="left">-0.01</td>
<td align="left">0.05</td>
<td align="left">-0.04</td>
<td align="left">0.05</td>
<td align="left">0.90</td>
<td align="left">0.99</td>
</tr>
<tr class="even">
<td>padaysLastweek_T1</td>
<td align="left">0.26</td>
<td align="left">1.00</td>
<td align="left">0.00</td>
<td align="left">0.02</td>
<td align="left">-0.01</td>
<td align="left">0.05</td>
<td align="left">-0.05</td>
<td align="left">-0.01</td>
<td align="left">-0.04</td>
<td align="left">-0.04</td>
<td align="left">-0.03</td>
<td align="left">-0.01</td>
<td align="left">-0.01</td>
<td align="left">0.04</td>
<td align="left">0.00</td>
<td align="left">-0.01</td>
<td align="left">0.03</td>
<td align="left">-0.03</td>
<td align="left">0.00</td>
<td align="left">0.04</td>
<td align="left">0.02</td>
<td align="left">0.03</td>
<td align="left">-0.11</td>
<td align="left">-0.09</td>
</tr>
<tr class="odd">
<td>PA_amotivation_02_T1</td>
<td align="left">-0.12</td>
<td align="left">-0.11</td>
<td align="left">1.00</td>
<td align="left">0.33</td>
<td align="left">0.22</td>
<td align="left">0.13</td>
<td align="left">-0.01</td>
<td align="left">0.03</td>
<td align="left">0.04</td>
<td align="left">0.00</td>
<td align="left">0.02</td>
<td align="left">-0.02</td>
<td align="left">-0.01</td>
<td align="left">-0.02</td>
<td align="left">-0.04</td>
<td align="left">-0.01</td>
<td align="left">-0.04</td>
<td align="left">-0.05</td>
<td align="left">-0.02</td>
<td align="left">0.00</td>
<td align="left">0.02</td>
<td align="left">-0.01</td>
<td align="left">-0.02</td>
<td align="left">-0.01</td>
</tr>
<tr class="even">
<td>PA_amotivation_01_T1</td>
<td align="left">-0.13</td>
<td align="left">-0.13</td>
<td align="left">0.59</td>
<td align="left">1.00</td>
<td align="left">0.13</td>
<td align="left">0.16</td>
<td align="left">0.04</td>
<td align="left">0.01</td>
<td align="left">0.06</td>
<td align="left">0.02</td>
<td align="left">0.01</td>
<td align="left">-0.03</td>
<td align="left">-0.03</td>
<td align="left">-0.04</td>
<td align="left">-0.01</td>
<td align="left">-0.06</td>
<td align="left">-0.03</td>
<td align="left">-0.04</td>
<td align="left">-0.03</td>
<td align="left">-0.04</td>
<td align="left">0.03</td>
<td align="left">-0.02</td>
<td align="left">0.04</td>
<td align="left">0.03</td>
</tr>
<tr class="odd">
<td>PA_amotivation_03_T1</td>
<td align="left">-0.10</td>
<td align="left">-0.11</td>
<td align="left">0.57</td>
<td align="left">0.54</td>
<td align="left">1.00</td>
<td align="left">0.47</td>
<td align="left">0.04</td>
<td align="left">0.02</td>
<td align="left">0.02</td>
<td align="left">0.02</td>
<td align="left">0.01</td>
<td align="left">-0.04</td>
<td align="left">-0.09</td>
<td align="left">-0.01</td>
<td align="left">0.01</td>
<td align="left">-0.03</td>
<td align="left">0.00</td>
<td align="left">-0.03</td>
<td align="left">-0.07</td>
<td align="left">-0.07</td>
<td align="left">0.04</td>
<td align="left">-0.02</td>
<td align="left">0.02</td>
<td align="left">0.02</td>
</tr>
<tr class="even">
<td>PA_amotivation_04_T1</td>
<td align="left">-0.12</td>
<td align="left">-0.06</td>
<td align="left">0.53</td>
<td align="left">0.52</td>
<td align="left">0.69</td>
<td align="left">1.00</td>
<td align="left">0.00</td>
<td align="left">0.02</td>
<td align="left">0.02</td>
<td align="left">-0.01</td>
<td align="left">0.01</td>
<td align="left">0.01</td>
<td align="left">-0.05</td>
<td align="left">-0.01</td>
<td align="left">-0.03</td>
<td align="left">0.04</td>
<td align="left">0.03</td>
<td align="left">-0.01</td>
<td align="left">-0.01</td>
<td align="left">0.06</td>
<td align="left">-0.01</td>
<td align="left">0.00</td>
<td align="left">-0.03</td>
<td align="left">-0.01</td>
</tr>
<tr class="odd">
<td>PA_extrinsic_01_T1</td>
<td align="left">-0.05</td>
<td align="left">-0.07</td>
<td align="left">0.28</td>
<td align="left">0.29</td>
<td align="left">0.27</td>
<td align="left">0.27</td>
<td align="left">1.00</td>
<td align="left">-0.80</td>
<td align="left">-0.82</td>
<td align="left">-0.89</td>
<td align="left">-0.89</td>
<td align="left">0.56</td>
<td align="left">0.53</td>
<td align="left">0.51</td>
<td align="left">0.53</td>
<td align="left">0.48</td>
<td align="left">0.51</td>
<td align="left">0.50</td>
<td align="left">0.51</td>
<td align="left">0.48</td>
<td align="left">-0.61</td>
<td align="left">0.93</td>
<td align="left">0.05</td>
<td align="left">0.04</td>
</tr>
<tr class="even">
<td>PA_extrinsic_02_T1</td>
<td align="left">-0.01</td>
<td align="left">0.00</td>
<td align="left">0.29</td>
<td align="left">0.26</td>
<td align="left">0.26</td>
<td align="left">0.28</td>
<td align="left">0.63</td>
<td align="left">1.00</td>
<td align="left">-0.80</td>
<td align="left">-0.87</td>
<td align="left">-0.88</td>
<td align="left">0.55</td>
<td align="left">0.53</td>
<td align="left">0.52</td>
<td align="left">0.53</td>
<td align="left">0.48</td>
<td align="left">0.53</td>
<td align="left">0.51</td>
<td align="left">0.51</td>
<td align="left">0.46</td>
<td align="left">-0.61</td>
<td align="left">0.92</td>
<td align="left">0.07</td>
<td align="left">0.06</td>
</tr>
<tr class="odd">
<td>PA_extrinsic_03_T1</td>
<td align="left">-0.05</td>
<td align="left">-0.04</td>
<td align="left">0.35</td>
<td align="left">0.33</td>
<td align="left">0.29</td>
<td align="left">0.32</td>
<td align="left">0.59</td>
<td align="left">0.61</td>
<td align="left">1.00</td>
<td align="left">-0.88</td>
<td align="left">-0.89</td>
<td align="left">0.55</td>
<td align="left">0.54</td>
<td align="left">0.50</td>
<td align="left">0.53</td>
<td align="left">0.48</td>
<td align="left">0.53</td>
<td align="left">0.51</td>
<td align="left">0.53</td>
<td align="left">0.46</td>
<td align="left">-0.61</td>
<td align="left">0.93</td>
<td align="left">0.05</td>
<td align="left">0.06</td>
</tr>
<tr class="even">
<td>PA_introjected_01_T1</td>
<td align="left">0.05</td>
<td align="left">0.09</td>
<td align="left">0.05</td>
<td align="left">0.00</td>
<td align="left">0.01</td>
<td align="left">0.02</td>
<td align="left">0.27</td>
<td align="left">0.32</td>
<td align="left">0.30</td>
<td align="left">1.00</td>
<td align="left">-0.87</td>
<td align="left">0.56</td>
<td align="left">0.53</td>
<td align="left">0.52</td>
<td align="left">0.53</td>
<td align="left">0.48</td>
<td align="left">0.51</td>
<td align="left">0.52</td>
<td align="left">0.51</td>
<td align="left">0.47</td>
<td align="left">-0.61</td>
<td align="left">0.96</td>
<td align="left">0.06</td>
<td align="left">0.04</td>
</tr>
<tr class="odd">
<td>PA_introjected_02_T1</td>
<td align="left">0.05</td>
<td align="left">0.13</td>
<td align="left">0.02</td>
<td align="left">-0.05</td>
<td align="left">-0.03</td>
<td align="left">0.00</td>
<td align="left">0.21</td>
<td align="left">0.25</td>
<td align="left">0.23</td>
<td align="left">0.69</td>
<td align="left">1.00</td>
<td align="left">0.58</td>
<td align="left">0.55</td>
<td align="left">0.53</td>
<td align="left">0.56</td>
<td align="left">0.49</td>
<td align="left">0.54</td>
<td align="left">0.54</td>
<td align="left">0.53</td>
<td align="left">0.48</td>
<td align="left">-0.64</td>
<td align="left">0.96</td>
<td align="left">0.05</td>
<td align="left">0.06</td>
</tr>
<tr class="even">
<td>PA_identified_01_T1</td>
<td align="left">0.09</td>
<td align="left">0.27</td>
<td align="left">-0.19</td>
<td align="left">-0.22</td>
<td align="left">-0.23</td>
<td align="left">-0.20</td>
<td align="left">-0.01</td>
<td align="left">0.01</td>
<td align="left">-0.01</td>
<td align="left">0.25</td>
<td align="left">0.31</td>
<td align="left">1.00</td>
<td align="left">-0.70</td>
<td align="left">-0.71</td>
<td align="left">-0.75</td>
<td align="left">-0.73</td>
<td align="left">-0.73</td>
<td align="left">-0.74</td>
<td align="left">-0.76</td>
<td align="left">-0.68</td>
<td align="left">0.90</td>
<td align="left">-0.59</td>
<td align="left">-0.03</td>
<td align="left">-0.02</td>
</tr>
<tr class="odd">
<td>PA_identified_02_T1</td>
<td align="left">0.09</td>
<td align="left">0.28</td>
<td align="left">-0.30</td>
<td align="left">-0.32</td>
<td align="left">-0.38</td>
<td align="left">-0.35</td>
<td align="left">-0.10</td>
<td align="left">-0.07</td>
<td align="left">-0.07</td>
<td align="left">0.20</td>
<td align="left">0.25</td>
<td align="left">0.61</td>
<td align="left">1.00</td>
<td align="left">-0.68</td>
<td align="left">-0.72</td>
<td align="left">-0.73</td>
<td align="left">-0.74</td>
<td align="left">-0.68</td>
<td align="left">-0.73</td>
<td align="left">-0.63</td>
<td align="left">0.87</td>
<td align="left">-0.57</td>
<td align="left">-0.03</td>
<td align="left">-0.01</td>
</tr>
<tr class="even">
<td>PA_identified_03_T1</td>
<td align="left">0.23</td>
<td align="left">0.42</td>
<td align="left">-0.27</td>
<td align="left">-0.31</td>
<td align="left">-0.25</td>
<td align="left">-0.23</td>
<td align="left">-0.11</td>
<td align="left">-0.05</td>
<td align="left">-0.08</td>
<td align="left">0.22</td>
<td align="left">0.27</td>
<td align="left">0.55</td>
<td align="left">0.61</td>
<td align="left">1.00</td>
<td align="left">-0.61</td>
<td align="left">-0.64</td>
<td align="left">-0.64</td>
<td align="left">-0.62</td>
<td align="left">-0.69</td>
<td align="left">-0.61</td>
<td align="left">0.82</td>
<td align="left">-0.55</td>
<td align="left">-0.03</td>
<td align="left">-0.02</td>
</tr>
<tr class="odd">
<td>PA_integrated_01_T1</td>
<td align="left">0.21</td>
<td align="left">0.37</td>
<td align="left">-0.23</td>
<td align="left">-0.25</td>
<td align="left">-0.18</td>
<td align="left">-0.18</td>
<td align="left">-0.05</td>
<td align="left">-0.01</td>
<td align="left">-0.01</td>
<td align="left">0.22</td>
<td align="left">0.29</td>
<td align="left">0.48</td>
<td align="left">0.53</td>
<td align="left">0.74</td>
<td align="left">1.00</td>
<td align="left">-0.59</td>
<td align="left">-0.67</td>
<td align="left">-0.65</td>
<td align="left">-0.72</td>
<td align="left">-0.64</td>
<td align="left">0.84</td>
<td align="left">-0.57</td>
<td align="left">-0.08</td>
<td align="left">-0.07</td>
</tr>
<tr class="even">
<td>PA_integrated_02_T1</td>
<td align="left">0.19</td>
<td align="left">0.37</td>
<td align="left">-0.23</td>
<td align="left">-0.28</td>
<td align="left">-0.20</td>
<td align="left">-0.16</td>
<td align="left">-0.07</td>
<td align="left">-0.01</td>
<td align="left">-0.02</td>
<td align="left">0.22</td>
<td align="left">0.27</td>
<td align="left">0.48</td>
<td align="left">0.52</td>
<td align="left">0.71</td>
<td align="left">0.74</td>
<td align="left">1.00</td>
<td align="left">-0.62</td>
<td align="left">-0.60</td>
<td align="left">-0.66</td>
<td align="left">-0.64</td>
<td align="left">0.82</td>
<td align="left">-0.51</td>
<td align="left">-0.02</td>
<td align="left">-0.01</td>
</tr>
<tr class="odd">
<td>PA_integrated_03_T1</td>
<td align="left">0.26</td>
<td align="left">0.44</td>
<td align="left">-0.23</td>
<td align="left">-0.27</td>
<td align="left">-0.19</td>
<td align="left">-0.14</td>
<td align="left">-0.11</td>
<td align="left">-0.04</td>
<td align="left">-0.03</td>
<td align="left">0.13</td>
<td align="left">0.20</td>
<td align="left">0.48</td>
<td align="left">0.51</td>
<td align="left">0.70</td>
<td align="left">0.67</td>
<td align="left">0.71</td>
<td align="left">1.00</td>
<td align="left">-0.73</td>
<td align="left">-0.66</td>
<td align="left">-0.50</td>
<td align="left">0.84</td>
<td align="left">-0.56</td>
<td align="left">-0.04</td>
<td align="left">-0.02</td>
</tr>
<tr class="even">
<td>PA_intrinsic_01_T1</td>
<td align="left">0.18</td>
<td align="left">0.35</td>
<td align="left">-0.32</td>
<td align="left">-0.35</td>
<td align="left">-0.31</td>
<td align="left">-0.27</td>
<td align="left">-0.13</td>
<td align="left">-0.08</td>
<td align="left">-0.09</td>
<td align="left">0.26</td>
<td align="left">0.31</td>
<td align="left">0.49</td>
<td align="left">0.61</td>
<td align="left">0.72</td>
<td align="left">0.68</td>
<td align="left">0.72</td>
<td align="left">0.64</td>
<td align="left">1.00</td>
<td align="left">-0.62</td>
<td align="left">-0.52</td>
<td align="left">0.82</td>
<td align="left">-0.55</td>
<td align="left">-0.05</td>
<td align="left">-0.04</td>
</tr>
<tr class="odd">
<td>PA_intrinsic_02_T1</td>
<td align="left">0.20</td>
<td align="left">0.38</td>
<td align="left">-0.30</td>
<td align="left">-0.32</td>
<td align="left">-0.32</td>
<td align="left">-0.25</td>
<td align="left">-0.15</td>
<td align="left">-0.10</td>
<td align="left">-0.07</td>
<td align="left">0.13</td>
<td align="left">0.17</td>
<td align="left">0.45</td>
<td align="left">0.55</td>
<td align="left">0.66</td>
<td align="left">0.60</td>
<td align="left">0.67</td>
<td align="left">0.72</td>
<td align="left">0.73</td>
<td align="left">1.00</td>
<td align="left">-0.52</td>
<td align="left">0.85</td>
<td align="left">-0.55</td>
<td align="left">0.01</td>
<td align="left">0.02</td>
</tr>
<tr class="even">
<td>PA_intrinsic_03_T1</td>
<td align="left">0.18</td>
<td align="left">0.41</td>
<td align="left">-0.27</td>
<td align="left">-0.31</td>
<td align="left">-0.29</td>
<td align="left">-0.20</td>
<td align="left">-0.14</td>
<td align="left">-0.10</td>
<td align="left">-0.09</td>
<td align="left">0.15</td>
<td align="left">0.19</td>
<td align="left">0.47</td>
<td align="left">0.58</td>
<td align="left">0.68</td>
<td align="left">0.62</td>
<td align="left">0.66</td>
<td align="left">0.77</td>
<td align="left">0.74</td>
<td align="left">0.79</td>
<td align="left">1.00</td>
<td align="left">0.76</td>
<td align="left">-0.50</td>
<td align="left">-0.06</td>
<td align="left">-0.05</td>
</tr>
<tr class="odd">
<td>Autonomous_sumscore</td>
<td align="left">0.22</td>
<td align="left">0.45</td>
<td align="left">-0.31</td>
<td align="left">-0.35</td>
<td align="left">-0.31</td>
<td align="left">-0.27</td>
<td align="left">-0.12</td>
<td align="left">-0.06</td>
<td align="left">-0.06</td>
<td align="left">0.24</td>
<td align="left">0.31</td>
<td align="left">0.68</td>
<td align="left">0.75</td>
<td align="left">0.86</td>
<td align="left">0.82</td>
<td align="left">0.84</td>
<td align="left">0.84</td>
<td align="left">0.86</td>
<td align="left">0.84</td>
<td align="left">0.85</td>
<td align="left">1.00</td>
<td align="left">0.66</td>
<td align="left">0.05</td>
<td align="left">0.03</td>
</tr>
<tr class="even">
<td>Controlled_sumscore</td>
<td align="left">0.01</td>
<td align="left">0.05</td>
<td align="left">0.24</td>
<td align="left">0.19</td>
<td align="left">0.19</td>
<td align="left">0.21</td>
<td align="left">0.69</td>
<td align="left">0.71</td>
<td align="left">0.69</td>
<td align="left">0.78</td>
<td align="left">0.72</td>
<td align="left">0.18</td>
<td align="left">0.09</td>
<td align="left">0.11</td>
<td align="left">0.15</td>
<td align="left">0.14</td>
<td align="left">0.06</td>
<td align="left">0.12</td>
<td align="left">0.03</td>
<td align="left">0.04</td>
<td align="left">0.13</td>
<td align="left">1.00</td>
<td align="left">-0.05</td>
<td align="left">-0.05</td>
</tr>
<tr class="odd">
<td>weartimeAccelerometer_T1</td>
<td align="left">0.14</td>
<td align="left">-0.05</td>
<td align="left">0.00</td>
<td align="left">0.03</td>
<td align="left">0.01</td>
<td align="left">-0.02</td>
<td align="left">0.04</td>
<td align="left">0.02</td>
<td align="left">-0.01</td>
<td align="left">0.01</td>
<td align="left">-0.07</td>
<td align="left">-0.03</td>
<td align="left">-0.02</td>
<td align="left">0.00</td>
<td align="left">0.00</td>
<td align="left">-0.01</td>
<td align="left">-0.03</td>
<td align="left">-0.01</td>
<td align="left">0.00</td>
<td align="left">-0.01</td>
<td align="left">-0.01</td>
<td align="left">-0.01</td>
<td align="left">1.00</td>
<td align="left">-0.90</td>
</tr>
<tr class="even">
<td>mvpaAccelerometer_percentageWeartime_T1</td>
<td align="left">0.97</td>
<td align="left">0.26</td>
<td align="left">-0.12</td>
<td align="left">-0.14</td>
<td align="left">-0.10</td>
<td align="left">-0.11</td>
<td align="left">-0.05</td>
<td align="left">-0.01</td>
<td align="left">-0.04</td>
<td align="left">0.05</td>
<td align="left">0.07</td>
<td align="left">0.10</td>
<td align="left">0.10</td>
<td align="left">0.23</td>
<td align="left">0.21</td>
<td align="left">0.19</td>
<td align="left">0.27</td>
<td align="left">0.19</td>
<td align="left">0.20</td>
<td align="left">0.18</td>
<td align="left">0.23</td>
<td align="left">0.02</td>
<td align="left">-0.07</td>
<td align="left">1.00</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
labs &lt;-<span class="st"> </span><span class="kw">names</span>(regulations.df)
<span class="co"># Plot the matrix as a correlogram</span>
matrix_corLower_parcorUpper <span class="op">%&gt;%</span><span class="st"> </span>corrgram<span class="op">::</span><span class="kw">corrgram</span>(
  <span class="dt">type =</span> <span class="st">&quot;cor&quot;</span>,
  <span class="dt">lower.panel =</span> corrgram<span class="op">::</span>panel.pie,
  <span class="dt">upper.panel =</span> corrgram<span class="op">::</span>panel.pie,
  <span class="dt">outer.labels =</span> <span class="kw">list</span>(<span class="dt">bottom =</span> <span class="kw">list</span>(<span class="dt">labels =</span> labs, <span class="dt">cex =</span> <span class="fl">0.75</span>, <span class="dt">srt =</span> <span class="dv">30</span>),
                      <span class="dt">left =</span> <span class="kw">list</span>(<span class="dt">labels =</span> labs, <span class="dt">cex =</span> <span class="fl">0.75</span>, <span class="dt">srt =</span> <span class="dv">30</span>)),
  <span class="dt">main =</span> <span class="st">&quot;Bivariate (upper diagonal) and partial (lower diagonal)</span><span class="ch">\n</span><span class="st">correlations of BCTs, motivation and self-reported MVPA&quot;</span>)</code></pre></div>
<p><img src="baseline-networks_files/figure-html/motivation-corrmatrix-1.png" width="2100" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
corMatrix_motivations &lt;-<span class="st"> </span>regulations.df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">cor</span>(<span class="dt">use =</span> <span class="st">&quot;pairwise.complete.obs&quot;</span>, <span class="dt">method =</span> <span class="st">&quot;spearman&quot;</span>)

variableNames &lt;-<span class="st"> </span><span class="kw">labels</span>(corMatrix_motivations)[[<span class="dv">1</span>]] <span class="co"># Extract list of variable names to use in the next call</span>

corMatrix_motivations <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">as.data.frame</span>(.) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">Variable =</span> variableNames) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(Variable, 
                <span class="st">`</span><span class="dt">MVPA accelerometer</span><span class="st">`</span> =<span class="st"> </span>mvpaAccelerometer_T1, <span class="st">`</span><span class="dt">MVPA self report</span><span class="st">`</span> =<span class="st"> </span>padaysLastweek_T1, 
                <span class="st">`</span><span class="dt">MVPA accelerometer (% weartime)</span><span class="st">`</span> =<span class="st"> </span>mvpaAccelerometer_percentageWeartime_T1, 
                <span class="st">`</span><span class="dt">Accelerometer wear time</span><span class="st">`</span> =<span class="st"> </span>weartimeAccelerometer_T1) <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">arrange</span>(<span class="kw">desc</span>(<span class="st">`</span><span class="dt">MVPA accelerometer</span><span class="st">`</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>DT<span class="op">::</span><span class="kw">datatable</span>(<span class="dt">caption =</span> <span class="st">&quot;Bivariate correlations between motivation and MVPA. Sorted by correlation strength with MVPA accelerometer.&quot;</span>)</code></pre></div>
<div id="htmlwidget-4884885ec0bc72e6dee3" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-4884885ec0bc72e6dee3">{"x":{"filter":"none","caption":"<caption>Bivariate correlations between motivation and MVPA. Sorted by correlation strength with MVPA accelerometer.<\/caption>","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24"],["mvpaAccelerometer_T1","mvpaAccelerometer_percentageWeartime_T1","PA_integrated_03_T1","padaysLastweek_T1","Autonomous_sumscore","PA_identified_03_T1","PA_integrated_01_T1","PA_intrinsic_02_T1","PA_integrated_02_T1","PA_intrinsic_01_T1","PA_intrinsic_03_T1","weartimeAccelerometer_T1","PA_identified_02_T1","PA_identified_01_T1","PA_introjected_02_T1","PA_introjected_01_T1","Controlled_sumscore","PA_extrinsic_02_T1","PA_extrinsic_03_T1","PA_extrinsic_01_T1","PA_amotivation_03_T1","PA_amotivation_04_T1","PA_amotivation_02_T1","PA_amotivation_01_T1"],[1,0.977655878732249,0.281125325681034,0.254357316320086,0.232257676847066,0.22863430219986,0.22121796111503,0.214946019922426,0.202293985765154,0.186106300843958,0.177276385380893,0.118785595141699,0.115021165973805,0.104307002280568,0.0424845629299181,0.0269978418162724,-0.00278394897553489,-0.0315507266130757,-0.0513100984228871,-0.0571051310995356,-0.132775296572096,-0.138611872461569,-0.158676986214032,-0.166072535976671],[0.254357316320086,0.269694248655921,0.448114072969901,1,0.458334534779223,0.426499466432745,0.382239938566911,0.387806239766034,0.372416922244264,0.359629178435929,0.421145362988844,-0.0510571633707165,0.304279649355291,0.277554365701712,0.13049133714851,0.0766178132943774,0.0457982336481229,-0.027209684664043,-0.0634487099740452,-0.0932687833564905,-0.139507307905678,-0.106474733245353,-0.144931914571863,-0.15572969803233],[0.977655878732249,1,0.288078033051655,0.269694248655921,0.237856217186021,0.232875031918566,0.224493798293355,0.216950185955192,0.205297781554986,0.189233008432542,0.184122596670666,-0.0698313642815344,0.119645601233207,0.112514542959727,0.0587884287111067,0.0260996548390927,-0.000299077103995518,-0.0351762880928586,-0.0502282141660393,-0.0622432767306901,-0.130425539797693,-0.133347502639615,-0.159380378800449,-0.173177750524205],[0.118785595141699,-0.0698313642815344,-0.0364228995217861,-0.0510571633707165,-0.020362499559667,-0.00159374631902018,-0.00172152538083874,-0.012025598301243,-0.00887992838529007,-0.0136635786741425,-0.0308998506682123,1,-0.0077172615223295,-0.043722474144526,-0.0569049963056335,0.0285093218691794,-0.00473666986923727,0.00580968686314084,-0.0163060012370695,0.0174313543930051,-0.00982924616585577,-0.0187731968553097,-0.00509869223412097,0.0359062523436515]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Variable<\/th>\n      <th>MVPA accelerometer<\/th>\n      <th>MVPA self report<\/th>\n      <th>MVPA accelerometer (% weartime)<\/th>\n      <th>Accelerometer wear time<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-center","targets":"_all"},{"className":"dt-right","targets":[2,3,4,5]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
corMatrix_motivations <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">as.data.frame</span>(.) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">transmute</span>(<span class="dt">Variable =</span> variableNames,
                   <span class="st">&quot;Accelerometer minus self-report&quot;</span> =<span class="st"> </span>mvpaAccelerometer_T1 <span class="op">-</span><span class="st"> </span>padaysLastweek_T1,
                   <span class="st">&quot;Accelerometer minus accelerometer-as-%-weartime&quot;</span> =<span class="st"> </span>mvpaAccelerometer_T1 <span class="op">-</span><span class="st"> </span>mvpaAccelerometer_percentageWeartime_T1) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">arrange</span>(<span class="kw">desc</span>(<span class="st">`</span><span class="dt">Accelerometer minus self-report</span><span class="st">`</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>DT<span class="op">::</span><span class="kw">datatable</span>(<span class="dt">caption =</span> <span class="st">&quot;Differences in correlations among the measures&quot;</span>)</code></pre></div>
<div id="htmlwidget-cdc139f503cb667ae814" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-cdc139f503cb667ae814">{"x":{"filter":"none","caption":"<caption>Differences in correlations among the measures<\/caption>","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24"],["mvpaAccelerometer_T1","mvpaAccelerometer_percentageWeartime_T1","weartimeAccelerometer_T1","PA_extrinsic_01_T1","PA_extrinsic_03_T1","PA_amotivation_03_T1","PA_extrinsic_02_T1","PA_amotivation_01_T1","PA_amotivation_02_T1","PA_amotivation_04_T1","Controlled_sumscore","PA_introjected_01_T1","PA_introjected_02_T1","PA_integrated_01_T1","PA_integrated_03_T1","PA_integrated_02_T1","PA_intrinsic_02_T1","PA_identified_01_T1","PA_intrinsic_01_T1","PA_identified_02_T1","PA_identified_03_T1","Autonomous_sumscore","PA_intrinsic_03_T1","padaysLastweek_T1"],[0.745642683679914,0.707961630076329,0.169842758512415,0.0361636522569549,0.0121386115511581,0.00673201133358181,-0.00434104194903271,-0.0103428379443407,-0.013745071642169,-0.0321371392162166,-0.0485821826236578,-0.049619971478105,-0.0880067742185921,-0.161021977451881,-0.166988747288867,-0.170122936479109,-0.172860219843608,-0.173247363421144,-0.173522877591971,-0.189258483381486,-0.197865164232885,-0.226076857932157,-0.243868977607951,-0.745642683679914],[0.0223441212677505,-0.0223441212677505,0.188616959423233,0.00513814563115448,-0.00108188425684783,-0.00234975677440336,0.00362556147978288,0.00710521454753404,0.000703392586417328,-0.00526436982195419,-0.00248487187153937,0.000898186977179725,-0.0163038657811886,-0.00327583717832461,-0.00695270737062115,-0.00300379578983123,-0.00200416603276649,-0.0082075406791596,-0.00312670758858405,-0.00462443525940169,-0.0042407297187059,-0.00559854033895482,-0.00684621128977289,-0.0153369323358345]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Variable<\/th>\n      <th>Accelerometer minus self-report<\/th>\n      <th>Accelerometer minus accelerometer-as-%-weartime<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-center","targets":"_all"},{"className":"dt-right","targets":[2,3]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="motivational-regulations-network" class="section level2">
<h2>Motivational regulations network</h2>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
