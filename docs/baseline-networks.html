<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title>Network analyses</title>

<script src="site_libs/jquery-1.12.4/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<script src="site_libs/htmlwidgets-1.3/htmlwidgets.js"></script>
<link href="site_libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="site_libs/datatables-binding-0.5/datatables.js"></script>
<link href="site_libs/dt-core-1.10.16/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="site_libs/dt-core-1.10.16/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="site_libs/dt-core-1.10.16/js/jquery.dataTables.min.js"></script>
<link href="site_libs/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
<script src="site_libs/crosstalk-1.0.0/js/crosstalk.min.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  { background-color: #f8f8f8; }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */

.sourceCode .row {
  width: 100%;
}
.sourceCode {
  overflow-x: auto;
}
.code-folding-btn {
  margin-right: -30px;
}
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' || rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>


</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 66px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 71px;
  margin-top: -71px;
}
.section h2 {
  padding-top: 71px;
  margin-top: -71px;
}
.section h3 {
  padding-top: 71px;
  margin-top: -71px;
}
.section h4 {
  padding-top: 71px;
  margin-top: -71px;
}
.section h5 {
  padding-top: 71px;
  margin-top: -71px;
}
.section h6 {
  padding-top: 71px;
  margin-top: -71px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<div class="container-fluid main-container">

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>



<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
  padding-left: 25px;
  text-indent: 0;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>

<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Visualising baseline characteristics</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">About</a>
</li>
<li>
  <a href="baseline-manuscript.html">Manuscript</a>
</li>
<li>
  <a href="baseline-tables.html">Descriptive tables</a>
</li>
<li>
  <a href="baseline-supplement.html">Descriptive plots</a>
</li>
<li>
  <a href="baseline-networks.html">Networks &amp; correlations</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">

<div class="btn-group pull-right">
<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Network analyses</h1>

</div>


<p>This section describes network analyses and displays correlation structures in the data. Here, physical activity (PA) is used interchangeably with moderate-to-vigorous physical activity (MVPA); all measures of activity relate to MVPA.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw">source</span>(<span class="st">&quot;baseline-datasetup.R&quot;</span>)</a></code></pre></div>
<p>Clicking the “Code”-buttons on the right shows code for each chunk. <span class="math inline">\(~\)</span> <span class="math inline">\(~\)</span> <a id="network"></a></p>
<p>As with all models, network analysis entails its own set of assumptions. Due to the similarity with regression models, it does not make sense to include variables which can be thought to be embedded in each other. For example, it is difficult to argue that there is no conceptual overlap between positive outcome expectations and autonomous motivation. In this regard, behaviour change technique use and the quality of one’s motivation (as posited by self-determination theory) seem less problematic. Hence, we start with those.</p>
<div id="network-featured-in-manuscript" class="section level1 tabset">
<h1>Network featured in manuscript</h1>
<div id="network" class="section level2">
<h2>Network</h2>
<p>All BCTs are shown here separately; exceptions: memory cues which seems quite unclear a question, as well as analysing goal failure, which only concerns those who have not reached their goals (for which an option on the scale was given, making it differ from the other BCTs).</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1">bctdf_mgm_T1 &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(</a>
<a class="sourceLine" id="cb2-2" title="2"><span class="co">#  id,</span></a>
<a class="sourceLine" id="cb2-3" title="3"><span class="co">#  intervention,</span></a>
<a class="sourceLine" id="cb2-4" title="4"><span class="co">#  group,</span></a>
<a class="sourceLine" id="cb2-5" title="5"><span class="co">#  school,</span></a>
<a class="sourceLine" id="cb2-6" title="6"><span class="co">#  girl,</span></a>
<a class="sourceLine" id="cb2-7" title="7">  <span class="st">&#39;goal setting&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">01</span>_T1,</a>
<a class="sourceLine" id="cb2-8" title="8">  <span class="st">&#39;own plan&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">02</span>_T1,</a>
<a class="sourceLine" id="cb2-9" title="9">  <span class="st">&#39;plan by other&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">03</span>_T1,</a>
<a class="sourceLine" id="cb2-10" title="10">  <span class="st">&#39;reminder of plan&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">04</span>_T1,</a>
<a class="sourceLine" id="cb2-11" title="11">  <span class="st">&#39;subgoals&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">05</span>_T1,</a>
<a class="sourceLine" id="cb2-12" title="12">  <span class="st">&#39;trying new PA&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">06</span>_T1,</a>
<a class="sourceLine" id="cb2-13" title="13">  <span class="st">&#39;barrier identification&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">07</span>_T1,</a>
<a class="sourceLine" id="cb2-14" title="14">  <span class="st">&#39;problem solving&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">08</span>_T1,</a>
<a class="sourceLine" id="cb2-15" title="15">  <span class="st">&#39;PA identity reflection&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">09</span>_T1,</a>
<a class="sourceLine" id="cb2-16" title="16">  <span class="st">&#39;aligning PA with life values&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">10</span>_T1,</a>
<a class="sourceLine" id="cb2-17" title="17">  <span class="st">&#39;remind of PA benefits&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">01</span>_T1,</a>
<a class="sourceLine" id="cb2-18" title="18">  <span class="st">&#39;self-monitor (paper)&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">02</span>_T1,</a>
<a class="sourceLine" id="cb2-19" title="19">  <span class="st">&#39;self-monitor (app)&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">03</span>_T1,</a>
<a class="sourceLine" id="cb2-20" title="20"><span class="co">#  &#39;memory cues&#39; = PA_frequencyDependentBCT_04_T1, # Issues with clarity of item wording </span></a>
<a class="sourceLine" id="cb2-21" title="21">  <span class="st">&#39;goal review&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">05</span>_T1,</a>
<a class="sourceLine" id="cb2-22" title="22">  <span class="st">&#39;personal relevance reflection&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">06</span>_T1,</a>
<a class="sourceLine" id="cb2-23" title="23">  <span class="st">&#39;environmental changes (home)&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">07</span>_T1,</a>
<a class="sourceLine" id="cb2-24" title="24">  <span class="st">&#39;social support&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">08</span>_T1,</a>
<a class="sourceLine" id="cb2-25" title="25">  <span class="st">&#39;analysing goal failure&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">09</span>_T1,</a>
<a class="sourceLine" id="cb2-26" title="26">  <span class="st">&#39;MVPA survey&#39;</span> =<span class="st"> </span>padaysLastweek_T1,</a>
<a class="sourceLine" id="cb2-27" title="27">  <span class="st">&#39;MVPA accelerometer&#39;</span> =<span class="st"> </span>mvpaAccelerometer_T1,</a>
<a class="sourceLine" id="cb2-28" title="28">  <span class="st">&#39;intrinsic&#39;</span> =<span class="st"> </span>PA_intrinsic_T1,</a>
<a class="sourceLine" id="cb2-29" title="29">  <span class="st">&#39;identified&#39;</span> =<span class="st"> </span>PA_identified_T1, <span class="st">&#39;integrated&#39;</span> =<span class="st"> </span>PA_integrated_T1,</a>
<a class="sourceLine" id="cb2-30" title="30">  <span class="st">&#39;controlled motivation&#39;</span> =<span class="st"> </span>PA_controlled_T1) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb2-31" title="31"><span class="st"> </span><span class="kw">rowwise</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2-32" title="32"><span class="st"> </span><span class="kw">mutate</span>(</a>
<a class="sourceLine" id="cb2-33" title="33">  <span class="st">&#39;goal setting&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">goal setting</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb2-34" title="34"><span class="co">#  &#39;has plan&#39; = ifelse(`own plan` == 1 &amp; `plan by other` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb2-35" title="35">  <span class="st">&#39;own plan&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">own plan</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb2-36" title="36">  <span class="st">&#39;plan by other&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">plan by other</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb2-37" title="37">  <span class="st">&#39;reminder of plan&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">reminder of plan</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb2-38" title="38">  <span class="st">&#39;subgoals&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">subgoals</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb2-39" title="39">  <span class="st">&#39;trying new PA&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">trying new PA</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb2-40" title="40">  <span class="st">&#39;barrier identification&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">barrier identification</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb2-41" title="41">  <span class="st">&#39;problem solving&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">problem solving</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb2-42" title="42">  <span class="co"># &#39;barriers identified or planned for&#39; = ifelse(`problem solving` == 1 &amp; `barrier identification` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb2-43" title="43">  <span class="st">&#39;PA identity reflection&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">PA identity reflection</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb2-44" title="44">  <span class="st">&#39;aligning PA with life values&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">aligning PA with life values</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb2-45" title="45">  <span class="co"># &#39;identity, life values&#39; = ifelse(`PA identity reflection` == 1 &amp; `aligning PA with life values` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb2-46" title="46">  <span class="st">&#39;remind of PA benefits&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">remind of PA benefits</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb2-47" title="47">  <span class="st">&#39;monitoring PA&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">self-monitor (paper)</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span> <span class="op">&amp;</span><span class="st"> `</span><span class="dt">self-monitor (app)</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb2-48" title="48"><span class="co">#  &#39;memory cues&#39; = ifelse(`memory cues` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb2-49" title="49">  <span class="st">&#39;goal review&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">goal review</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb2-50" title="50">  <span class="st">&#39;personal relevance reflection&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">personal relevance reflection</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb2-51" title="51">  <span class="st">&#39;environmental changes (home)&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">environmental changes (home)</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb2-52" title="52">  <span class="st">&#39;social support&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">social support</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb2-53" title="53">  <span class="st">&#39;analysing goal failure&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">analysing goal failure</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb2-54" title="54">  <span class="st">&#39;autonomous motivation&#39;</span> =<span class="st"> </span><span class="kw">mean</span>(<span class="kw">c</span>(identified, intrinsic, integrated), <span class="dt">na.rm =</span> T),</a>
<a class="sourceLine" id="cb2-55" title="55"><span class="co">#  &#39;girl&#39; = ifelse(girl == &quot;girl&quot;, 1, 0),</span></a>
<a class="sourceLine" id="cb2-56" title="56">  <span class="st">&#39;controlled motivation&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">controlled motivation</span><span class="st">`</span> <span class="op">&lt;</span><span class="st"> </span><span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">1</span>)) <span class="op">%&gt;%</span><span class="st">  </span><span class="co"># If &quot;at least partly&quot; or more true, input 1. Normality otherwise a problem. </span></a>
<a class="sourceLine" id="cb2-57" title="57"><span class="co">#  &#39;intervention&#39; = ifelse(intervention == &quot;1&quot;, 1, 0)) %&gt;% </span></a>
<a class="sourceLine" id="cb2-58" title="58"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span><span class="st">`</span><span class="dt">self-monitor (paper)</span><span class="st">`</span>, <span class="op">-</span><span class="st">`</span><span class="dt">self-monitor (app)</span><span class="st">`</span>, </a>
<a class="sourceLine" id="cb2-59" title="59">                <span class="co"># -`plan by other`, -`own plan`, </span></a>
<a class="sourceLine" id="cb2-60" title="60">                <span class="op">-</span>identified, <span class="op">-</span>intrinsic, <span class="op">-</span>integrated,</a>
<a class="sourceLine" id="cb2-61" title="61">         <span class="op">-</span><span class="st">`</span><span class="dt">analysing goal failure</span><span class="st">`</span> <span class="co"># only concerns those who haven&#39;t reached goals</span></a>
<a class="sourceLine" id="cb2-62" title="62">         <span class="co"># -`barrier identification`, -`problem solving`, # closely related</span></a>
<a class="sourceLine" id="cb2-63" title="63">           ) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2-64" title="64"><span class="co">#  dplyr::select(-controlled) %&gt;% # Not really gaussian at all </span></a>
<a class="sourceLine" id="cb2-65" title="65"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="st">&#39;MVPA survey&#39;</span>, <span class="st">&#39;MVPA accelerometer&#39;</span>, <span class="kw">everything</span>())</a>
<a class="sourceLine" id="cb2-66" title="66"></a>
<a class="sourceLine" id="cb2-67" title="67">bctdf_mgm_T1<span class="op">$</span><span class="st">`</span><span class="dt">autonomous motivation</span><span class="st">`</span>[<span class="kw">is.nan</span>(bctdf_mgm_T1<span class="op">$</span><span class="st">`</span><span class="dt">autonomous motivation</span><span class="st">`</span>)] &lt;-<span class="st"> </span><span class="ot">NA</span></a>
<a class="sourceLine" id="cb2-68" title="68"></a>
<a class="sourceLine" id="cb2-69" title="69">labs &lt;-<span class="st"> </span><span class="kw">names</span>(bctdf_mgm_T1)</a>
<a class="sourceLine" id="cb2-70" title="70"></a>
<a class="sourceLine" id="cb2-71" title="71"><span class="co"># mgm wants full data, see package missForest for imputation methods</span></a>
<a class="sourceLine" id="cb2-72" title="72">bctdf_mgm_T1 &lt;-<span class="st"> </span>bctdf_mgm_T1 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">na.omit</span>(.)</a>
<a class="sourceLine" id="cb2-73" title="73"><span class="co"># bctdf_mgm %&gt;% names()</span></a>
<a class="sourceLine" id="cb2-74" title="74">mgm_variable_types &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;g&quot;</span>, <span class="st">&quot;g&quot;</span>, <span class="kw">rep</span>(<span class="st">&quot;c&quot;</span>, <span class="dv">17</span>), <span class="st">&quot;g&quot;</span>)</a>
<a class="sourceLine" id="cb2-75" title="75">mgm_variable_levels &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;1&quot;</span>, <span class="st">&quot;1&quot;</span>, <span class="kw">rep</span>(<span class="st">&quot;2&quot;</span>, <span class="dv">17</span>), <span class="st">&quot;1&quot;</span>)</a>
<a class="sourceLine" id="cb2-76" title="76"><span class="co"># data.frame(mgm_variable_types, mgm_variable_levels, names(bctdf_mgm))</span></a>
<a class="sourceLine" id="cb2-77" title="77"></a>
<a class="sourceLine" id="cb2-78" title="78">mgm_obj_T1 &lt;-<span class="st"> </span>mgm<span class="op">::</span><span class="kw">mgm</span>(<span class="dt">data =</span> bctdf_mgm_T1,</a>
<a class="sourceLine" id="cb2-79" title="79">  <span class="dt">type =</span> mgm_variable_types,</a>
<a class="sourceLine" id="cb2-80" title="80">  <span class="dt">level =</span> mgm_variable_levels,</a>
<a class="sourceLine" id="cb2-81" title="81">  <span class="dt">lambdaSel =</span> <span class="st">&quot;EBIC&quot;</span>,</a>
<a class="sourceLine" id="cb2-82" title="82">  <span class="co"># lambdaFolds = 10,</span></a>
<a class="sourceLine" id="cb2-83" title="83">  <span class="dt">pbar =</span> <span class="ot">FALSE</span>, </a>
<a class="sourceLine" id="cb2-84" title="84">  <span class="dt">binarySign =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb2-85" title="85"><span class="co">## Note that the sign of parameter estimates is stored separately; see ?mgm</span></a>
<a class="sourceLine" id="cb2-86" title="86"></a>
<a class="sourceLine" id="cb2-87" title="87"><span class="co"># Node pies:</span></a>
<a class="sourceLine" id="cb2-88" title="88">pies_T1 &lt;-<span class="st"> </span>bctdf_mgm_T1 <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2-89" title="89"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">summarise_all</span>(<span class="op">~</span><span class="kw">mean</span>(., <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)) <span class="co"># results in a series of means, which is ok for dichotomous vars</span></a>
<a class="sourceLine" id="cb2-90" title="90">pies_T1[<span class="dv">1</span>] &lt;-<span class="st"> </span>pies_T1[<span class="dv">1</span>] <span class="op">/</span><span class="st"> </span><span class="dv">7</span></a>
<a class="sourceLine" id="cb2-91" title="91">pies_T1[<span class="dv">2</span>] &lt;-<span class="st"> </span>pies_T1[<span class="dv">2</span>] <span class="op">/</span><span class="st"> </span><span class="kw">max</span>(bctdf_mgm_T1<span class="op">$</span><span class="st">`</span><span class="dt">MVPA accelerometer</span><span class="st">`</span>, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb2-92" title="92">pies_T1[<span class="dv">20</span>] &lt;-<span class="st"> </span>pies_T1[<span class="dv">20</span>] <span class="op">/</span><span class="st"> </span><span class="dv">5</span></a>
<a class="sourceLine" id="cb2-93" title="93"></a>
<a class="sourceLine" id="cb2-94" title="94"></a>
<a class="sourceLine" id="cb2-95" title="95">node_colors &lt;-<span class="st"> </span><span class="kw">c</span>(viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">3</span>, <span class="dt">begin =</span> <span class="fl">0.4</span>, <span class="dt">end =</span> <span class="fl">0.99</span>)[<span class="dv">1</span>], <span class="co"># Color 1 for MVPA (questionnaire)</span></a>
<a class="sourceLine" id="cb2-96" title="96">                 viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">3</span>, <span class="dt">begin =</span> <span class="fl">0.4</span>, <span class="dt">end =</span> <span class="fl">0.99</span>)[<span class="dv">1</span>], <span class="co"># Color 1 for MVPA (accelerometer)</span></a>
<a class="sourceLine" id="cb2-97" title="97">                 <span class="kw">rep</span>(viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">3</span>, <span class="dt">begin =</span> <span class="fl">0.4</span>, <span class="dt">end =</span> <span class="fl">0.99</span>)[<span class="dv">2</span>], <span class="dv">15</span>), <span class="co"># 11x Color 2 for BCTs</span></a>
<a class="sourceLine" id="cb2-98" title="98">                 <span class="kw">rep</span>(viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">3</span>, <span class="dt">begin =</span> <span class="fl">0.4</span>, <span class="dt">end =</span> <span class="fl">0.99</span>)[<span class="dv">3</span>], <span class="dv">1</span>), <span class="co"># Color 3 for motivation (controlled)  </span></a>
<a class="sourceLine" id="cb2-99" title="99">                 <span class="kw">rep</span>(viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">3</span>, <span class="dt">begin =</span> <span class="fl">0.4</span>, <span class="dt">end =</span> <span class="fl">0.99</span>)[<span class="dv">2</span>], <span class="dv">1</span>), <span class="co"># 1x Color 2 for BCTs</span></a>
<a class="sourceLine" id="cb2-100" title="100">                 viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">3</span>, <span class="dt">begin =</span> <span class="fl">0.4</span>, <span class="dt">end =</span> <span class="fl">0.99</span>)[<span class="dv">3</span>]) <span class="co"># Color 3 for motivation (autonomous) </span></a>
<a class="sourceLine" id="cb2-101" title="101"></a>
<a class="sourceLine" id="cb2-102" title="102">BCT_mgm_T1 &lt;-<span class="st"> </span>qgraph<span class="op">::</span><span class="kw">qgraph</span>(mgm_obj_T1<span class="op">$</span>pairwise<span class="op">$</span>wadj, </a>
<a class="sourceLine" id="cb2-103" title="103">            <span class="dt">layout =</span> <span class="st">&quot;spring&quot;</span>,</a>
<a class="sourceLine" id="cb2-104" title="104">            <span class="dt">repulsion =</span> <span class="fl">0.99</span>, <span class="co"># To nudge the network from originally bad visual state</span></a>
<a class="sourceLine" id="cb2-105" title="105">            <span class="dt">edge.color =</span> <span class="kw">ifelse</span>(mgm_obj_T1<span class="op">$</span>pairwise<span class="op">$</span>edgecolor <span class="op">==</span><span class="st"> &quot;darkgreen&quot;</span>, <span class="st">&quot;blue&quot;</span>, mgm_obj_T1<span class="op">$</span>pairwise<span class="op">$</span>edgecolor),</a>
<a class="sourceLine" id="cb2-106" title="106">            <span class="dt">pie =</span> pies_T1,</a>
<a class="sourceLine" id="cb2-107" title="107">            <span class="co"># pieColor = pie_colors_T1,</span></a>
<a class="sourceLine" id="cb2-108" title="108">            <span class="dt">pieColor =</span> node_colors,</a>
<a class="sourceLine" id="cb2-109" title="109">            <span class="dt">labels =</span> <span class="kw">names</span>(bctdf_mgm_T1),</a>
<a class="sourceLine" id="cb2-110" title="110">            <span class="dt">pieBorder =</span> <span class="dv">1</span>,</a>
<a class="sourceLine" id="cb2-111" title="111">            <span class="dt">label.cex =</span> <span class="fl">0.75</span>,</a>
<a class="sourceLine" id="cb2-112" title="112">            <span class="dt">cut =</span> <span class="dv">0</span>,</a>
<a class="sourceLine" id="cb2-113" title="113">            <span class="dt">edge.labels =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb2-114" title="114">            <span class="dt">label.scale =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb2-115" title="115"><span class="co">## Error in drawNode(x, y, shape[i], vsize[i], vsize2[i], borders[i], vertex.colors[i], : Sum of &#39;pie&#39; argument may not be greater than 1 for any node.</span></a></code></pre></div>
<p><img src="baseline-networks_files/figure-html/unnamed-chunk-1-1.png" width="2100" /></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1"></a>
<a class="sourceLine" id="cb3-2" title="2">BCT_mgm_T1_circle &lt;-<span class="st"> </span>qgraph<span class="op">::</span><span class="kw">qgraph</span>(mgm_obj_T1<span class="op">$</span>pairwise<span class="op">$</span>wadj, </a>
<a class="sourceLine" id="cb3-3" title="3">            <span class="dt">layout =</span> <span class="st">&quot;circle&quot;</span>,</a>
<a class="sourceLine" id="cb3-4" title="4">            <span class="dt">title =</span> <span class="st">&quot;Mixed graphical model: PA, BCTs &amp; motivation&quot;</span>,</a>
<a class="sourceLine" id="cb3-5" title="5">            <span class="dt">edge.color =</span> <span class="kw">ifelse</span>(mgm_obj_T1<span class="op">$</span>pairwise<span class="op">$</span>edgecolor <span class="op">==</span><span class="st"> &quot;darkgreen&quot;</span>, <span class="st">&quot;blue&quot;</span>, mgm_obj_T1<span class="op">$</span>pairwise<span class="op">$</span>edgecolor),</a>
<a class="sourceLine" id="cb3-6" title="6">            <span class="dt">pie =</span> pies_T1,</a>
<a class="sourceLine" id="cb3-7" title="7">            <span class="dt">pieColor =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">5</span>, <span class="dt">begin =</span> <span class="fl">0.3</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">5</span>],</a>
<a class="sourceLine" id="cb3-8" title="8">            <span class="dt">color =</span> node_colors,</a>
<a class="sourceLine" id="cb3-9" title="9">            <span class="dt">labels =</span> <span class="kw">names</span>(bctdf_mgm_T1),</a>
<a class="sourceLine" id="cb3-10" title="10">            <span class="dt">label.cex =</span> <span class="fl">0.75</span>,</a>
<a class="sourceLine" id="cb3-11" title="11">            <span class="dt">cut =</span> <span class="dv">0</span>,</a>
<a class="sourceLine" id="cb3-12" title="12">            <span class="dt">label.scale =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb3-13" title="13"><span class="co">## Error in drawNode(x, y, shape[i], vsize[i], vsize2[i], borders[i], vertex.colors[i], : Sum of &#39;pie&#39; argument may not be greater than 1 for any node.</span></a></code></pre></div>
<p><img src="baseline-networks_files/figure-html/unnamed-chunk-1-2.png" width="2100" /></p>
</div>
<div id="bootstrap-stability" class="section level2">
<h2>Bootstrap stability</h2>
<p>Omitted for now, due to technical problems.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1"></a>
<a class="sourceLine" id="cb4-2" title="2"><span class="co"># all_BCTs_mgm_stability &lt;- mgm::resample(object = mgm_obj_T1 %&gt;% na.omit(.), data = bctdf_mgm, nB = 100)</span></a>
<a class="sourceLine" id="cb4-3" title="3"><span class="co"># # save(all_BCTs_mgm_stability, file = &quot;./Rdata_files/all_BCTs_mgm_stability.Rdata&quot;)</span></a>
<a class="sourceLine" id="cb4-4" title="4"><span class="co"># load(&quot;./Rdata_files/all_BCTs_mgm_stability.Rdata&quot;)</span></a>
<a class="sourceLine" id="cb4-5" title="5"><span class="co"># </span></a>
<a class="sourceLine" id="cb4-6" title="6"><span class="co"># mgm::plotRes(object = all_BCTs_mgm_stability, </span></a>
<a class="sourceLine" id="cb4-7" title="7"><span class="co">#         quantiles = c(.05, .95), </span></a>
<a class="sourceLine" id="cb4-8" title="8"><span class="co">#         cex.label = 0.5,</span></a>
<a class="sourceLine" id="cb4-9" title="9"><span class="co">#         lwd.qtl = 2.5, </span></a>
<a class="sourceLine" id="cb4-10" title="10"><span class="co">#         cex.mean = .5,</span></a>
<a class="sourceLine" id="cb4-11" title="11"><span class="co">#        labels = names(bctdf_mgm))</span></a>
<a class="sourceLine" id="cb4-12" title="12"></a>
<a class="sourceLine" id="cb4-13" title="13"><span class="co"># Error in data[, ind_cat[i]] : subscript out of bounds</span></a></code></pre></div>
</div>
<div id="edge-weights-matrix" class="section level2">
<h2>Edge weights matrix</h2>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1"></a>
<a class="sourceLine" id="cb5-2" title="2">edgeweights &lt;-<span class="st"> </span>mgm_obj_T1<span class="op">$</span>pairwise<span class="op">$</span>wadj <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">round</span>(., <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb5-3" title="3"><span class="kw">colnames</span>(edgeweights) &lt;-<span class="st"> </span>labs</a>
<a class="sourceLine" id="cb5-4" title="4"><span class="kw">rownames</span>(edgeweights) &lt;-<span class="st"> </span>labs</a>
<a class="sourceLine" id="cb5-5" title="5"></a>
<a class="sourceLine" id="cb5-6" title="6">edgeweights</a></code></pre></div>
<pre><code>                          MVPA survey MVPA accelerometer goal setting</code></pre>
<p>MVPA survey 0.000 0.152 0.000 MVPA accelerometer 0.152 0.000 0.000 goal setting 0.000 0.000 0.000 own plan 0.000 0.000 1.305 plan by other 0.147 0.000 0.000 reminder of plan 0.000 0.000 0.274 subgoals 0.000 0.000 0.000 trying new PA 0.122 0.000 0.182 barrier identification 0.000 0.000 0.165 problem solving 0.000 0.000 0.455 PA identity reflection 0.000 0.000 0.000 aligning PA with life values 0.000 0.000 0.000 remind of PA benefits 0.000 0.000 0.000 goal review 0.000 0.000 0.000 personal relevance reflection 0.000 0.000 0.000 environmental changes (home) 0.000 0.000 0.000 social support 0.000 0.000 0.230 controlled motivation 0.000 0.000 0.000 monitoring PA 0.000 0.000 0.000 autonomous motivation 0.299 0.064 0.250 own plan plan by other reminder of plan MVPA survey 0.000 0.147 0.000 MVPA accelerometer 0.000 0.000 0.000 goal setting 1.305 0.000 0.274 own plan 0.000 0.477 0.146 plan by other 0.477 0.000 0.514 reminder of plan 0.146 0.514 0.000 subgoals 0.449 0.440 0.659 trying new PA 0.000 0.000 0.250 barrier identification 0.000 0.000 0.245 problem solving 0.000 0.000 0.233 PA identity reflection 0.000 0.000 0.159 aligning PA with life values 0.000 0.000 0.000 remind of PA benefits 0.000 0.000 0.000 goal review 0.356 0.000 0.249 personal relevance reflection 0.000 0.000 0.000 environmental changes (home) 0.000 0.000 0.000 social support 0.147 0.000 0.000 controlled motivation 0.000 0.000 0.000 monitoring PA 0.000 0.100 0.474 autonomous motivation 0.217 0.000 0.000 subgoals trying new PA MVPA survey 0.000 0.122 MVPA accelerometer 0.000 0.000 goal setting 0.000 0.182 own plan 0.449 0.000 plan by other 0.440 0.000 reminder of plan 0.659 0.250 subgoals 0.000 0.375 trying new PA 0.375 0.000 barrier identification 0.000 0.000 problem solving 0.555 0.000 PA identity reflection 0.139 0.142 aligning PA with life values 0.265 0.402 remind of PA benefits 0.000 0.000 goal review 0.000 0.000 personal relevance reflection 0.000 0.000 environmental changes (home) 0.130 0.234 social support 0.000 0.000 controlled motivation 0.000 0.000 monitoring PA 0.079 0.093 autonomous motivation 0.000 0.138 barrier identification problem solving MVPA survey 0.000 0.000 MVPA accelerometer 0.000 0.000 goal setting 0.165 0.455 own plan 0.000 0.000 plan by other 0.000 0.000 reminder of plan 0.245 0.233 subgoals 0.000 0.555 trying new PA 0.000 0.000 barrier identification 0.000 1.077 problem solving 1.077 0.000 PA identity reflection 0.369 0.382 aligning PA with life values 0.270 0.475 remind of PA benefits 0.000 0.000 goal review 0.000 0.000 personal relevance reflection 0.000 0.000 environmental changes (home) 0.000 0.000 social support 0.000 0.000 controlled motivation 0.000 0.000 monitoring PA 0.111 0.000 autonomous motivation 0.000 0.000 PA identity reflection MVPA survey 0.000 MVPA accelerometer 0.000 goal setting 0.000 own plan 0.000 plan by other 0.000 reminder of plan 0.159 subgoals 0.139 trying new PA 0.142 barrier identification 0.369 problem solving 0.382 PA identity reflection 0.000 aligning PA with life values 0.796 remind of PA benefits 0.198 goal review 0.000 personal relevance reflection 0.259 environmental changes (home) 0.000 social support 0.000 controlled motivation 0.000 monitoring PA 0.000 autonomous motivation 0.000 aligning PA with life values MVPA survey 0.000 MVPA accelerometer 0.000 goal setting 0.000 own plan 0.000 plan by other 0.000 reminder of plan 0.000 subgoals 0.265 trying new PA 0.402 barrier identification 0.270 problem solving 0.475 PA identity reflection 0.796 aligning PA with life values 0.000 remind of PA benefits 0.254 goal review 0.261 personal relevance reflection 0.279 environmental changes (home) 0.000 social support 0.000 controlled motivation 0.000 monitoring PA 0.000 autonomous motivation 0.000 remind of PA benefits goal review MVPA survey 0.000 0.000 MVPA accelerometer 0.000 0.000 goal setting 0.000 0.000 own plan 0.000 0.356 plan by other 0.000 0.000 reminder of plan 0.000 0.249 subgoals 0.000 0.000 trying new PA 0.000 0.000 barrier identification 0.000 0.000 problem solving 0.000 0.000 PA identity reflection 0.198 0.000 aligning PA with life values 0.254 0.261 remind of PA benefits 0.000 0.000 goal review 0.000 0.000 personal relevance reflection 0.948 0.985 environmental changes (home) 0.000 0.317 social support 0.000 0.165 controlled motivation 0.000 0.000 monitoring PA 0.000 0.392 autonomous motivation 0.000 0.000 personal relevance reflection MVPA survey 0.000 MVPA accelerometer 0.000 goal setting 0.000 own plan 0.000 plan by other 0.000 reminder of plan 0.000 subgoals 0.000 trying new PA 0.000 barrier identification 0.000 problem solving 0.000 PA identity reflection 0.259 aligning PA with life values 0.279 remind of PA benefits 0.948 goal review 0.985 personal relevance reflection 0.000 environmental changes (home) 0.289 social support 0.405 controlled motivation 0.000 monitoring PA 0.000 autonomous motivation 0.325 environmental changes (home) social support MVPA survey 0.000 0.000 MVPA accelerometer 0.000 0.000 goal setting 0.000 0.230 own plan 0.000 0.147 plan by other 0.000 0.000 reminder of plan 0.000 0.000 subgoals 0.130 0.000 trying new PA 0.234 0.000 barrier identification 0.000 0.000 problem solving 0.000 0.000 PA identity reflection 0.000 0.000 aligning PA with life values 0.000 0.000 remind of PA benefits 0.000 0.000 goal review 0.317 0.165 personal relevance reflection 0.289 0.405 environmental changes (home) 0.000 0.532 social support 0.532 0.000 controlled motivation 0.000 0.000 monitoring PA 0.295 0.000 autonomous motivation 0.000 0.000 controlled motivation monitoring PA MVPA survey 0 0.000 MVPA accelerometer 0 0.000 goal setting 0 0.000 own plan 0 0.000 plan by other 0 0.100 reminder of plan 0 0.474 subgoals 0 0.079 trying new PA 0 0.093 barrier identification 0 0.111 problem solving 0 0.000 PA identity reflection 0 0.000 aligning PA with life values 0 0.000 remind of PA benefits 0 0.000 goal review 0 0.392 personal relevance reflection 0 0.000 environmental changes (home) 0 0.295 social support 0 0.000 controlled motivation 0 0.000 monitoring PA 0 0.000 autonomous motivation 0 0.000 autonomous motivation MVPA survey 0.299 MVPA accelerometer 0.064 goal setting 0.250 own plan 0.217 plan by other 0.000 reminder of plan 0.000 subgoals 0.000 trying new PA 0.138 barrier identification 0.000 problem solving 0.000 PA identity reflection 0.000 aligning PA with life values 0.000 remind of PA benefits 0.000 goal review 0.000 personal relevance reflection 0.325 environmental changes (home) 0.000 social support 0.000 controlled motivation 0.000 monitoring PA 0.000 autonomous motivation 0.000</p>
</div>
<div id="other-estimation-methods-mgm-cv-ggm" class="section level2">
<h2>Other estimation methods (mgm CV, GGM)</h2>
<p>This section estimates models with different methods: mgm with cross-validation, the standard Gaussian Graphical Model (GGM), and unregularised GGM. The distributions violate normality assumptions of the GGM.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1"><span class="co">#### CV model selection for mgm </span></a>
<a class="sourceLine" id="cb7-2" title="2"></a>
<a class="sourceLine" id="cb7-3" title="3">mgm_obj_T1_CV &lt;-<span class="st"> </span>mgm<span class="op">::</span><span class="kw">mgm</span>(<span class="dt">data =</span> bctdf_mgm_T1,</a>
<a class="sourceLine" id="cb7-4" title="4">  <span class="dt">type =</span> mgm_variable_types,</a>
<a class="sourceLine" id="cb7-5" title="5">  <span class="dt">level =</span> mgm_variable_levels,</a>
<a class="sourceLine" id="cb7-6" title="6">  <span class="dt">lambdaSel =</span> <span class="st">&quot;CV&quot;</span>,</a>
<a class="sourceLine" id="cb7-7" title="7">  <span class="dt">lambdaFolds =</span> <span class="dv">10</span>,</a>
<a class="sourceLine" id="cb7-8" title="8">  <span class="dt">pbar =</span> <span class="ot">FALSE</span>, </a>
<a class="sourceLine" id="cb7-9" title="9">  <span class="dt">binarySign =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb7-10" title="10"><span class="co">## Note that the sign of parameter estimates is stored separately; see ?mgm</span></a>
<a class="sourceLine" id="cb7-11" title="11"></a>
<a class="sourceLine" id="cb7-12" title="12"><span class="co"># Node pies:</span></a>
<a class="sourceLine" id="cb7-13" title="13">pies_T1 &lt;-<span class="st"> </span>bctdf_mgm_T1 <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb7-14" title="14"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">summarise_all</span>(<span class="op">~</span><span class="kw">mean</span>(., <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)) <span class="co"># results in a series of means, which is ok for dichotomous vars</span></a>
<a class="sourceLine" id="cb7-15" title="15">pies_T1[<span class="dv">1</span>] &lt;-<span class="st"> </span>pies_T1[<span class="dv">1</span>] <span class="op">/</span><span class="st"> </span><span class="dv">7</span></a>
<a class="sourceLine" id="cb7-16" title="16">pies_T1[<span class="dv">2</span>] &lt;-<span class="st"> </span>pies_T1[<span class="dv">2</span>] <span class="op">/</span><span class="st"> </span><span class="kw">max</span>(bctdf_mgm_T1<span class="op">$</span><span class="st">`</span><span class="dt">MVPA accelerometer</span><span class="st">`</span>, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb7-17" title="17">pies_T1[<span class="dv">20</span>] &lt;-<span class="st"> </span>pies_T1[<span class="dv">20</span>] <span class="op">/</span><span class="st"> </span><span class="dv">5</span></a>
<a class="sourceLine" id="cb7-18" title="18"></a>
<a class="sourceLine" id="cb7-19" title="19"></a>
<a class="sourceLine" id="cb7-20" title="20">node_colors &lt;-<span class="st"> </span><span class="kw">c</span>(viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">3</span>, <span class="dt">begin =</span> <span class="fl">0.4</span>, <span class="dt">end =</span> <span class="fl">0.99</span>)[<span class="dv">1</span>], <span class="co"># Color 1 for MVPA (questionnaire)</span></a>
<a class="sourceLine" id="cb7-21" title="21">                 viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">3</span>, <span class="dt">begin =</span> <span class="fl">0.4</span>, <span class="dt">end =</span> <span class="fl">0.99</span>)[<span class="dv">1</span>], <span class="co"># Color 1 for MVPA (accelerometer)</span></a>
<a class="sourceLine" id="cb7-22" title="22">                 <span class="kw">rep</span>(viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">3</span>, <span class="dt">begin =</span> <span class="fl">0.4</span>, <span class="dt">end =</span> <span class="fl">0.99</span>)[<span class="dv">2</span>], <span class="dv">15</span>), <span class="co"># 11x Color 2 for BCTs</span></a>
<a class="sourceLine" id="cb7-23" title="23">                 <span class="kw">rep</span>(viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">3</span>, <span class="dt">begin =</span> <span class="fl">0.4</span>, <span class="dt">end =</span> <span class="fl">0.99</span>)[<span class="dv">3</span>], <span class="dv">1</span>), <span class="co"># Color 3 for motivation (controlled)  </span></a>
<a class="sourceLine" id="cb7-24" title="24">                 <span class="kw">rep</span>(viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">3</span>, <span class="dt">begin =</span> <span class="fl">0.4</span>, <span class="dt">end =</span> <span class="fl">0.99</span>)[<span class="dv">2</span>], <span class="dv">1</span>), <span class="co"># 1x Color 2 for BCTs</span></a>
<a class="sourceLine" id="cb7-25" title="25">                 viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">3</span>, <span class="dt">begin =</span> <span class="fl">0.4</span>, <span class="dt">end =</span> <span class="fl">0.99</span>)[<span class="dv">3</span>]) <span class="co"># Color 3 for motivation (autonomous) </span></a>
<a class="sourceLine" id="cb7-26" title="26"></a>
<a class="sourceLine" id="cb7-27" title="27">BCT_mgm_T1_CV &lt;-<span class="st"> </span>qgraph<span class="op">::</span><span class="kw">qgraph</span>(mgm_obj_T1_CV<span class="op">$</span>pairwise<span class="op">$</span>wadj, </a>
<a class="sourceLine" id="cb7-28" title="28">            <span class="dt">layout =</span> BCT_mgm_T1<span class="op">$</span>layout,</a>
<a class="sourceLine" id="cb7-29" title="29">            <span class="dt">repulsion =</span> <span class="fl">0.99</span>, <span class="co"># To nudge the network from originally bad visual state</span></a>
<a class="sourceLine" id="cb7-30" title="30">            <span class="dt">edge.color =</span> <span class="kw">ifelse</span>(mgm_obj_T1<span class="op">$</span>pairwise<span class="op">$</span>edgecolor <span class="op">==</span><span class="st"> &quot;darkgreen&quot;</span>, <span class="st">&quot;blue&quot;</span>, mgm_obj_T1<span class="op">$</span>pairwise<span class="op">$</span>edgecolor),</a>
<a class="sourceLine" id="cb7-31" title="31">            <span class="dt">pie =</span> pies_T1,</a>
<a class="sourceLine" id="cb7-32" title="32">            <span class="co"># pieColor = pie_colors_T1,</span></a>
<a class="sourceLine" id="cb7-33" title="33">            <span class="dt">pieColor =</span> node_colors,</a>
<a class="sourceLine" id="cb7-34" title="34">            <span class="dt">labels =</span> <span class="kw">names</span>(bctdf_mgm_T1),</a>
<a class="sourceLine" id="cb7-35" title="35">            <span class="dt">pieBorder =</span> <span class="dv">1</span>,</a>
<a class="sourceLine" id="cb7-36" title="36">            <span class="dt">label.cex =</span> <span class="fl">0.75</span>,</a>
<a class="sourceLine" id="cb7-37" title="37">            <span class="dt">cut =</span> <span class="dv">0</span>,</a>
<a class="sourceLine" id="cb7-38" title="38">            <span class="dt">label.scale =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb7-39" title="39">            <span class="dt">title =</span> <span class="st">&quot;MGM with cross-validation&quot;</span>)</a>
<a class="sourceLine" id="cb7-40" title="40"><span class="co">## Error in qgraph::qgraph(mgm_obj_T1_CV$pairwise$wadj, layout = BCT_mgm_T1$layout, : object &#39;BCT_mgm_T1&#39; not found</span></a>
<a class="sourceLine" id="cb7-41" title="41"></a>
<a class="sourceLine" id="cb7-42" title="42"><span class="co">#### GGM</span></a>
<a class="sourceLine" id="cb7-43" title="43"></a>
<a class="sourceLine" id="cb7-44" title="44">bctdf_ggm_T1 &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(</a>
<a class="sourceLine" id="cb7-45" title="45">  <span class="st">&#39;goal setting&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">01</span>_T1,</a>
<a class="sourceLine" id="cb7-46" title="46">  <span class="st">&#39;own plan&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">02</span>_T1,</a>
<a class="sourceLine" id="cb7-47" title="47">  <span class="st">&#39;plan by other&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">03</span>_T1,</a>
<a class="sourceLine" id="cb7-48" title="48">  <span class="st">&#39;reminder of plan&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">04</span>_T1,</a>
<a class="sourceLine" id="cb7-49" title="49">  <span class="st">&#39;subgoals&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">05</span>_T1,</a>
<a class="sourceLine" id="cb7-50" title="50">  <span class="st">&#39;trying new PA&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">06</span>_T1,</a>
<a class="sourceLine" id="cb7-51" title="51">  <span class="st">&#39;barrier identification&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">07</span>_T1,</a>
<a class="sourceLine" id="cb7-52" title="52">  <span class="st">&#39;problem solving&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">08</span>_T1,</a>
<a class="sourceLine" id="cb7-53" title="53">  <span class="st">&#39;PA identity reflection&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">09</span>_T1,</a>
<a class="sourceLine" id="cb7-54" title="54">  <span class="st">&#39;aligning PA with life values&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">10</span>_T1,</a>
<a class="sourceLine" id="cb7-55" title="55">  <span class="st">&#39;remind of PA benefits&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">01</span>_T1,</a>
<a class="sourceLine" id="cb7-56" title="56">  <span class="st">&#39;self-monitor (paper)&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">02</span>_T1,</a>
<a class="sourceLine" id="cb7-57" title="57">  <span class="st">&#39;self-monitor (app)&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">03</span>_T1,</a>
<a class="sourceLine" id="cb7-58" title="58"><span class="co">#  &#39;memory cues&#39; = PA_frequencyDependentBCT_04_T1, # Issues with clarity of item wording </span></a>
<a class="sourceLine" id="cb7-59" title="59">  <span class="st">&#39;goal review&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">05</span>_T1,</a>
<a class="sourceLine" id="cb7-60" title="60">  <span class="st">&#39;personal relevance reflection&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">06</span>_T1,</a>
<a class="sourceLine" id="cb7-61" title="61">  <span class="st">&#39;environmental changes (home)&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">07</span>_T1,</a>
<a class="sourceLine" id="cb7-62" title="62">  <span class="st">&#39;social support&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">08</span>_T1,</a>
<a class="sourceLine" id="cb7-63" title="63">  <span class="st">&#39;analysing goal failure&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">09</span>_T1,</a>
<a class="sourceLine" id="cb7-64" title="64">  <span class="st">&#39;MVPA survey&#39;</span> =<span class="st"> </span>padaysLastweek_T1,</a>
<a class="sourceLine" id="cb7-65" title="65">  <span class="st">&#39;MVPA accelerometer&#39;</span> =<span class="st"> </span>mvpaAccelerometer_T1,</a>
<a class="sourceLine" id="cb7-66" title="66">  <span class="st">&#39;intrinsic&#39;</span> =<span class="st"> </span>PA_intrinsic_T1,</a>
<a class="sourceLine" id="cb7-67" title="67">  <span class="st">&#39;identified&#39;</span> =<span class="st"> </span>PA_identified_T1, <span class="st">&#39;integrated&#39;</span> =<span class="st"> </span>PA_integrated_T1,</a>
<a class="sourceLine" id="cb7-68" title="68">  <span class="st">&#39;controlled motivation&#39;</span> =<span class="st"> </span>PA_controlled_T1) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb7-69" title="69"><span class="st"> </span><span class="kw">rowwise</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb7-70" title="70"><span class="st"> </span><span class="kw">mutate</span>(</a>
<a class="sourceLine" id="cb7-71" title="71">  <span class="co"># &#39;goal setting&#39; = ifelse(`goal setting` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb7-72" title="72">  <span class="co"># &#39;own plan&#39; = ifelse(`own plan` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb7-73" title="73">  <span class="co"># &#39;plan by other&#39; = ifelse(`plan by other` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb7-74" title="74">  <span class="co"># &#39;reminder of plan&#39; = ifelse(`reminder of plan` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb7-75" title="75">  <span class="co"># &#39;subgoals&#39; = ifelse(`subgoals` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb7-76" title="76">  <span class="co"># &#39;trying new PA&#39; = ifelse(`trying new PA` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb7-77" title="77">  <span class="co"># &#39;barrier identification&#39; = ifelse(`barrier identification` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb7-78" title="78">  <span class="co"># &#39;problem solving&#39; = ifelse(`problem solving` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb7-79" title="79">  <span class="co"># &#39;PA identity reflection&#39; = ifelse(`PA identity reflection` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb7-80" title="80">  <span class="co"># &#39;aligning PA with life values&#39; = ifelse(`aligning PA with life values` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb7-81" title="81">  <span class="co"># &#39;remind of PA benefits&#39; = ifelse(`remind of PA benefits` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb7-82" title="82">  <span class="st">&#39;monitoring PA&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">self-monitor (paper)</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span> <span class="op">&amp;</span><span class="st"> `</span><span class="dt">self-monitor (app)</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb7-83" title="83">  <span class="co"># &#39;goal review&#39; = ifelse(`goal review` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb7-84" title="84">  <span class="co"># &#39;personal relevance reflection&#39; = ifelse(`personal relevance reflection` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb7-85" title="85">  <span class="co"># &#39;environmental changes (home)&#39; = ifelse(`environmental changes (home)` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb7-86" title="86">  <span class="co"># &#39;social support&#39; = ifelse(`social support` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb7-87" title="87">  <span class="co"># &#39;analysing goal failure&#39; = ifelse(`analysing goal failure` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb7-88" title="88">  <span class="st">&#39;autonomous motivation&#39;</span> =<span class="st"> </span><span class="kw">mean</span>(<span class="kw">c</span>(identified, intrinsic, integrated), <span class="dt">na.rm =</span> T),</a>
<a class="sourceLine" id="cb7-89" title="89">  <span class="st">&#39;controlled motivation&#39;</span> =<span class="st"> `</span><span class="dt">controlled motivation</span><span class="st">`</span> <span class="op">*</span><span class="st"> </span><span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb7-90" title="90"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span><span class="st">`</span><span class="dt">self-monitor (paper)</span><span class="st">`</span>, <span class="op">-</span><span class="st">`</span><span class="dt">self-monitor (app)</span><span class="st">`</span>, </a>
<a class="sourceLine" id="cb7-91" title="91">                <span class="op">-</span>identified, <span class="op">-</span>intrinsic, <span class="op">-</span>integrated,</a>
<a class="sourceLine" id="cb7-92" title="92">         <span class="op">-</span><span class="st">`</span><span class="dt">analysing goal failure</span><span class="st">`</span> <span class="co"># only concerns those who haven&#39;t reached goals</span></a>
<a class="sourceLine" id="cb7-93" title="93">           ) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb7-94" title="94"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="st">&#39;MVPA survey&#39;</span>, <span class="st">&#39;MVPA accelerometer&#39;</span>, <span class="kw">everything</span>()) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb7-95" title="95"><span class="st">  </span><span class="kw">mutate_all</span>(as.numeric)</a>
<a class="sourceLine" id="cb7-96" title="96"></a>
<a class="sourceLine" id="cb7-97" title="97">nwBCT_ggm &lt;-<span class="st"> </span>bootnet<span class="op">::</span><span class="kw">estimateNetwork</span>(bctdf_ggm_T1, <span class="dt">default=</span><span class="st">&quot;EBICglasso&quot;</span>)</a>
<a class="sourceLine" id="cb7-98" title="98"></a>
<a class="sourceLine" id="cb7-99" title="99">BCT_ggm &lt;-<span class="st"> </span><span class="kw">plot</span>(nwBCT_ggm, </a>
<a class="sourceLine" id="cb7-100" title="100">                <span class="dt">layout =</span> BCT_mgm_T1<span class="op">$</span>layout, </a>
<a class="sourceLine" id="cb7-101" title="101">                <span class="dt">label.scale =</span> <span class="ot">FALSE</span>, </a>
<a class="sourceLine" id="cb7-102" title="102">                <span class="dt">title =</span> <span class="st">&quot;GGM: MVPA, BCTs &amp; motivation&quot;</span>, </a>
<a class="sourceLine" id="cb7-103" title="103">                <span class="dt">label.cex =</span> <span class="fl">0.75</span>,</a>
<a class="sourceLine" id="cb7-104" title="104">                <span class="co"># pie = piefill_ggm,</span></a>
<a class="sourceLine" id="cb7-105" title="105">                <span class="dt">color =</span> node_colors,</a>
<a class="sourceLine" id="cb7-106" title="106">                <span class="dt">pieBorder =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb7-107" title="107"><span class="co">## Error in qgraph::qgraph(wMat, labels = labels, directed = directed, parallelEdge = parallelEdge, : object &#39;BCT_mgm_T1&#39; not found</span></a>
<a class="sourceLine" id="cb7-108" title="108"></a>
<a class="sourceLine" id="cb7-109" title="109">modSelect_<span class="dv">0</span> &lt;-<span class="st"> </span>qgraph<span class="op">::</span><span class="kw">ggmModSelect</span>(qgraph<span class="op">::</span><span class="kw">cor_auto</span>(bctdf_ggm_T1), <span class="dt">n =</span> <span class="kw">nrow</span>(bctdf_ggm_T1), <span class="dt">gamma =</span> <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb7-110" title="110"></a>
<a class="sourceLine" id="cb7-111" title="111">g3 &lt;-<span class="st"> </span>qgraph<span class="op">::</span><span class="kw">qgraph</span>(modSelect_<span class="dv">0</span><span class="op">$</span>graph, </a>
<a class="sourceLine" id="cb7-112" title="112">                     <span class="dt">layout =</span> BCT_mgm_T1<span class="op">$</span>layout, </a>
<a class="sourceLine" id="cb7-113" title="113">                     <span class="dt">label.scale =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb7-114" title="114">                     <span class="dt">label.cex =</span> <span class="fl">0.75</span>,</a>
<a class="sourceLine" id="cb7-115" title="115">                     <span class="dt">labels =</span> labs,</a>
<a class="sourceLine" id="cb7-116" title="116">                     <span class="dt">theme =</span> <span class="st">&quot;colorblind&quot;</span>,</a>
<a class="sourceLine" id="cb7-117" title="117">                     <span class="dt">title =</span> <span class="st">&quot;ggmModSelect (gamma = 0)&quot;</span>, </a>
<a class="sourceLine" id="cb7-118" title="118">                     <span class="dt">color =</span> node_colors, </a>
<a class="sourceLine" id="cb7-119" title="119">                     <span class="dt">cut =</span> <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb7-120" title="120"><span class="co">## Error in qgraph::qgraph(modSelect_0$graph, layout = BCT_mgm_T1$layout, : object &#39;BCT_mgm_T1&#39; not found</span></a>
<a class="sourceLine" id="cb7-121" title="121"></a>
<a class="sourceLine" id="cb7-122" title="122">modSelect_<span class="fl">0.5</span> &lt;-<span class="st"> </span>qgraph<span class="op">::</span><span class="kw">ggmModSelect</span>(qgraph<span class="op">::</span><span class="kw">cor_auto</span>(bctdf_ggm_T1), <span class="dt">n =</span> <span class="kw">nrow</span>(bctdf_ggm_T1), <span class="dt">gamma =</span> <span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb7-123" title="123"></a>
<a class="sourceLine" id="cb7-124" title="124">g4 &lt;-<span class="st"> </span>qgraph<span class="op">::</span><span class="kw">qgraph</span>(modSelect_<span class="fl">0.5</span><span class="op">$</span>graph, </a>
<a class="sourceLine" id="cb7-125" title="125">                     <span class="dt">layout =</span> BCT_mgm_T1<span class="op">$</span>layout, </a>
<a class="sourceLine" id="cb7-126" title="126">                     <span class="dt">label.scale =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb7-127" title="127">                     <span class="dt">label.cex =</span> <span class="fl">0.75</span>,</a>
<a class="sourceLine" id="cb7-128" title="128">                     <span class="dt">labels =</span> labs,</a>
<a class="sourceLine" id="cb7-129" title="129">                     <span class="dt">theme =</span> <span class="st">&quot;colorblind&quot;</span>, </a>
<a class="sourceLine" id="cb7-130" title="130">                     <span class="dt">title =</span> <span class="st">&quot;ggmModSelect (gamma = 0.5)&quot;</span>,</a>
<a class="sourceLine" id="cb7-131" title="131">                     <span class="dt">color =</span> node_colors, </a>
<a class="sourceLine" id="cb7-132" title="132">                     <span class="dt">cut =</span> <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb7-133" title="133"><span class="co">## Error in qgraph::qgraph(modSelect_0.5$graph, layout = BCT_mgm_T1$layout, : object &#39;BCT_mgm_T1&#39; not found</span></a></code></pre></div>
</div>
<div id="centrality" class="section level2">
<h2>Centrality</h2>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1">qgraph<span class="op">::</span><span class="kw">centralityPlot</span>(</a>
<a class="sourceLine" id="cb8-2" title="2">  <span class="kw">list</span>(</a>
<a class="sourceLine" id="cb8-3" title="3">    <span class="co"># mgm_EBIC = BCT_mgm_T1,</span></a>
<a class="sourceLine" id="cb8-4" title="4">    <span class="co"># mgm_CV = mgm_obj_T1_CV,</span></a>
<a class="sourceLine" id="cb8-5" title="5">       <span class="dt">ggm =</span> BCT_ggm,</a>
<a class="sourceLine" id="cb8-6" title="6">       <span class="dt">ggmModSelect_0 =</span> g3,</a>
<a class="sourceLine" id="cb8-7" title="7">       <span class="dt">ggmModSelect_0.5 =</span> g4</a>
<a class="sourceLine" id="cb8-8" title="8">       ),</a>
<a class="sourceLine" id="cb8-9" title="9">  <span class="dt">include =</span> <span class="kw">c</span>(<span class="st">&quot;Strength&quot;</span>,<span class="st">&quot;ExpectedInfluence&quot;</span>),</a>
<a class="sourceLine" id="cb8-10" title="10">               <span class="dt">orderBy =</span> <span class="st">&quot;ExpectedInfluence&quot;</span>)</a>
<a class="sourceLine" id="cb8-11" title="11"><span class="co">## Error in getWmat(list(...)): object &#39;BCT_ggm&#39; not found</span></a></code></pre></div>
</div>
</div>
<div id="combined-bct-chunks" class="section level1">
<h1>Combined BCT chunks</h1>
<p>The following network depicts a mixed graphical model, with the following variables:</p>
<ul>
<li><p>Two measures of physical activity. <code>MVPA accelerometer</code> is the mean accelerometer-measured Moderate-to-Vigorous Physical Activity (MVPA) during a day in the measurement period, <code>MVPA questionnaire</code> is a survey item which asked “on how many days the previous week were you active for at least 30 minutes so, that you were out of breath”.</p></li>
<li><p>One Behaviour Change Technique usage node (BCT usage is the mean of all techniques participants reported having used).</p></li>
<li><p>Four motivation types (Intrinsic and Identified, which are facets of “autonomous regulation” according to the self-determination theory, looked normal so used as continuous. Introjected and Extrinsic - facets of “controlled regulation” - were heavily skewed, so they were dichotomised: if “at least partly” or more true, a participant gets 1, otherwise 0.</p></li>
</ul>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1"></a>
<a class="sourceLine" id="cb9-2" title="2">bctdf_mgm &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(</a>
<a class="sourceLine" id="cb9-3" title="3">  <span class="st">&#39;agr-BCTs&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_T1,</a>
<a class="sourceLine" id="cb9-4" title="4">  <span class="st">&#39;frq-BCTs&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_T1,</a>
<a class="sourceLine" id="cb9-5" title="5">  <span class="st">&#39;MVPA questionnaire&#39;</span> =<span class="st"> </span>padaysLastweek_T1,</a>
<a class="sourceLine" id="cb9-6" title="6">  <span class="st">&#39;MVPA accelerometer&#39;</span> =<span class="st"> </span>mvpaAccelerometer_T1,</a>
<a class="sourceLine" id="cb9-7" title="7">  <span class="st">&#39;Intrinsic&#39;</span> =<span class="st"> </span>PA_intrinsic_T1,</a>
<a class="sourceLine" id="cb9-8" title="8">  <span class="st">&#39;Identified&#39;</span> =<span class="st"> </span>PA_identified_T1,</a>
<a class="sourceLine" id="cb9-9" title="9">  <span class="st">&#39;Introjected&#39;</span> =<span class="st"> </span>PA_introjected_T1,</a>
<a class="sourceLine" id="cb9-10" title="10">  <span class="st">&#39;Extrinsic&#39;</span> =<span class="st"> </span>PA_extrinsic_T1) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb9-11" title="11"><span class="st"> </span><span class="kw">rowwise</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb9-12" title="12"><span class="st"> </span><span class="kw">mutate</span>(</a>
<a class="sourceLine" id="cb9-13" title="13">  <span class="st">&#39;BCT usage&#39;</span> =<span class="st"> </span><span class="kw">mean</span>(<span class="kw">c</span>(<span class="st">`</span><span class="dt">agr-BCTs</span><span class="st">`</span>, <span class="st">`</span><span class="dt">frq-BCTs</span><span class="st">`</span>), <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb9-14" title="14">  <span class="co"># &#39;autonomous motivation&#39; = mean(c(identified, intrinsic), na.rm = TRUE),</span></a>
<a class="sourceLine" id="cb9-15" title="15">  <span class="st">&#39;Extrinsic&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">Extrinsic</span><span class="st">`</span> <span class="op">&lt;</span><span class="st"> </span><span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">1</span>), <span class="co"># If &quot;at least partly&quot; or more true, input 1. Normality otherwise a problem. </span></a>
<a class="sourceLine" id="cb9-16" title="16">  <span class="st">&#39;Introjected&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">Introjected</span><span class="st">`</span> <span class="op">&lt;</span><span class="st"> </span><span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">1</span>)) <span class="op">%&gt;%</span><span class="st">  </span><span class="co"># If &quot;at least partly&quot; or more true, input 1. Normality otherwise a problem. </span></a>
<a class="sourceLine" id="cb9-17" title="17"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="st">&#39;MVPA questionnaire&#39;</span>, <span class="st">&#39;MVPA accelerometer&#39;</span>, <span class="st">&#39;BCT usage&#39;</span>, <span class="kw">everything</span>(), <span class="op">-</span><span class="kw">contains</span>(<span class="st">&quot;-BCTs&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb9-18" title="18"><span class="st">  </span><span class="kw">mutate_all</span>(as.numeric)</a>
<a class="sourceLine" id="cb9-19" title="19"></a>
<a class="sourceLine" id="cb9-20" title="20">bctdf_mgm<span class="op">$</span><span class="st">`</span><span class="dt">BCT usage</span><span class="st">`</span>[<span class="kw">is.nan</span>(bctdf_mgm<span class="op">$</span><span class="st">`</span><span class="dt">BCT usage</span><span class="st">`</span>)] &lt;-<span class="st"> </span><span class="ot">NA</span></a>
<a class="sourceLine" id="cb9-21" title="21"></a>
<a class="sourceLine" id="cb9-22" title="22"></a>
<a class="sourceLine" id="cb9-23" title="23"></a>
<a class="sourceLine" id="cb9-24" title="24"><span class="co"># If you need mock data:</span></a>
<a class="sourceLine" id="cb9-25" title="25"><span class="co"># bctdf_mgm &lt;- data.frame(</span></a>
<a class="sourceLine" id="cb9-26" title="26"><span class="co">#   &#39;MVPA questionnaire&#39; = sample(1:8, size = 700, replace = TRUE),</span></a>
<a class="sourceLine" id="cb9-27" title="27"><span class="co">#   &#39;MVPA accelerometer&#39; = rnorm(mean = 130, sd = 40, n = 700),</span></a>
<a class="sourceLine" id="cb9-28" title="28"><span class="co">#   &#39;BCT usage&#39; = replicate(19, sample(1:5, 700, rep = TRUE)) %&gt;% as.data.frame() %&gt;% rowMeans(.),</span></a>
<a class="sourceLine" id="cb9-29" title="29"><span class="co">#   &#39;Intrinsic&#39; = replicate(3, sample(1:5, 700, rep = TRUE)) %&gt;% as.data.frame() %&gt;% rowMeans(.),</span></a>
<a class="sourceLine" id="cb9-30" title="30"><span class="co">#   &#39;Identified&#39; = replicate(3, sample(1:5, 700, rep = TRUE)) %&gt;% as.data.frame() %&gt;% rowMeans(.),</span></a>
<a class="sourceLine" id="cb9-31" title="31"><span class="co">#   &#39;Introjected&#39; = sample(0:1, 700, rep = TRUE) %&gt;% as.data.frame() %&gt;% rowMeans(.),</span></a>
<a class="sourceLine" id="cb9-32" title="32"><span class="co">#   &#39;Extrinsic&#39; = sample(0:1, 700, rep = TRUE) %&gt;% as.data.frame() %&gt;% rowMeans(.)</span></a>
<a class="sourceLine" id="cb9-33" title="33"><span class="co"># )</span></a>
<a class="sourceLine" id="cb9-34" title="34"></a>
<a class="sourceLine" id="cb9-35" title="35">labs &lt;-<span class="st"> </span><span class="kw">names</span>(bctdf_mgm)</a>
<a class="sourceLine" id="cb9-36" title="36"></a>
<a class="sourceLine" id="cb9-37" title="37"><span class="co"># mgm wants full data, see package missForest for imputation methods</span></a>
<a class="sourceLine" id="cb9-38" title="38">bctdf_mgm &lt;-<span class="st"> </span>bctdf_mgm <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">na.omit</span>(.)</a>
<a class="sourceLine" id="cb9-39" title="39"><span class="co"># bctdf_mgm %&gt;% names()</span></a>
<a class="sourceLine" id="cb9-40" title="40">mgm_variable_types &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">&quot;g&quot;</span>, <span class="dv">5</span>), <span class="st">&quot;c&quot;</span>, <span class="st">&quot;c&quot;</span>)</a>
<a class="sourceLine" id="cb9-41" title="41">mgm_variable_levels &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">&quot;1&quot;</span>, <span class="dv">5</span>), <span class="st">&quot;2&quot;</span>, <span class="st">&quot;2&quot;</span>)</a>
<a class="sourceLine" id="cb9-42" title="42"><span class="co"># data.frame(mgm_variable_types, mgm_variable_levels, names(bctdf_mgm))</span></a>
<a class="sourceLine" id="cb9-43" title="43"></a>
<a class="sourceLine" id="cb9-44" title="44">mgm_obj &lt;-<span class="st"> </span>mgm<span class="op">::</span><span class="kw">mgm</span>(<span class="dt">data =</span> bctdf_mgm,</a>
<a class="sourceLine" id="cb9-45" title="45">  <span class="dt">type =</span> mgm_variable_types,</a>
<a class="sourceLine" id="cb9-46" title="46">  <span class="dt">level =</span> mgm_variable_levels,</a>
<a class="sourceLine" id="cb9-47" title="47">  <span class="dt">lambdaSel =</span> <span class="st">&quot;CV&quot;</span>,</a>
<a class="sourceLine" id="cb9-48" title="48">  <span class="dt">lambdaFolds =</span> <span class="dv">10</span>,</a>
<a class="sourceLine" id="cb9-49" title="49">  <span class="dt">pbar =</span> <span class="ot">FALSE</span>, </a>
<a class="sourceLine" id="cb9-50" title="50">  <span class="dt">binarySign =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb9-51" title="51"><span class="co">## Note that the sign of parameter estimates is stored separately; see ?mgm</span></a>
<a class="sourceLine" id="cb9-52" title="52"></a>
<a class="sourceLine" id="cb9-53" title="53">pred_obj &lt;-<span class="st"> </span><span class="kw">predict</span>(<span class="dt">object =</span> mgm_obj,</a>
<a class="sourceLine" id="cb9-54" title="54">                         <span class="dt">data =</span> bctdf_mgm)</a>
<a class="sourceLine" id="cb9-55" title="55"></a>
<a class="sourceLine" id="cb9-56" title="56">pred_obj<span class="op">$</span>errors</a></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Variable"],"name":[1],"type":["chr"],"align":["left"]},{"label":["RMSE"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["R2"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["CC"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["nCC"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["CCmarg"],"name":[6],"type":["dbl"],"align":["right"]}],"data":[{"1":"MVPA questionnaire","2":"0.841","3":"0.292","4":"NA","5":"NA","6":"NA","_rn_":"1"},{"1":"MVPA accelerometer","2":"0.950","3":"0.096","4":"NA","5":"NA","6":"NA","_rn_":"2"},{"1":"BCT usage","2":"0.763","3":"0.417","4":"NA","5":"NA","6":"NA","_rn_":"3"},{"1":"Intrinsic","2":"0.629","3":"0.603","4":"NA","5":"NA","6":"NA","_rn_":"4"},{"1":"Identified","2":"0.636","3":"0.595","4":"NA","5":"NA","6":"NA","_rn_":"5"},{"1":"Introjected","2":"NA","3":"NA","4":"0.706","5":"0.166","6":"0.647","_rn_":"6"},{"1":"Extrinsic","2":"NA","3":"NA","4":"0.900","5":"0.014","6":"0.899","_rn_":"7"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1"></a>
<a class="sourceLine" id="cb10-2" title="2"><span class="co"># Take R2 from gaussian, CC from categorical variables </span></a>
<a class="sourceLine" id="cb10-3" title="3">pie_errors &lt;-<span class="st"> </span><span class="kw">c</span>(pred_obj<span class="op">$</span>errors[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>, <span class="dv">3</span>],</a>
<a class="sourceLine" id="cb10-4" title="4">                pred_obj<span class="op">$</span>errors[<span class="dv">6</span><span class="op">:</span><span class="dv">7</span>, <span class="dv">4</span>])</a>
<a class="sourceLine" id="cb10-5" title="5"></a>
<a class="sourceLine" id="cb10-6" title="6"><span class="co"># Coloring nodes: make a sequence of colors from the viridis palette. We need three colors (MVPA, BCTs, motivation), and &quot;begin&quot; from ones that are not too dark, so that black text shows up ok.</span></a>
<a class="sourceLine" id="cb10-7" title="7"></a>
<a class="sourceLine" id="cb10-8" title="8">node_colors &lt;-<span class="st"> </span><span class="kw">c</span>(viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">5</span>, <span class="dt">begin =</span> <span class="fl">0.4</span>, <span class="dt">end =</span> <span class="fl">0.99</span>)[<span class="dv">1</span>], <span class="co"># Color 1 for MVPA (questionnaire)</span></a>
<a class="sourceLine" id="cb10-9" title="9">                 viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">5</span>, <span class="dt">begin =</span> <span class="fl">0.4</span>, <span class="dt">end =</span> <span class="fl">0.99</span>)[<span class="dv">1</span>], <span class="co"># Color 1 for MVPA (accelerometer)</span></a>
<a class="sourceLine" id="cb10-10" title="10">                 <span class="kw">rep</span>(viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">5</span>, <span class="dt">begin =</span> <span class="fl">0.4</span>, <span class="dt">end =</span> <span class="fl">0.99</span>)[<span class="dv">4</span>], <span class="dv">1</span>), <span class="co"># 1x Color 4 for BCTs</span></a>
<a class="sourceLine" id="cb10-11" title="11">                 <span class="kw">rep</span>(viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">5</span>, <span class="dt">begin =</span> <span class="fl">0.4</span>, <span class="dt">end =</span> <span class="fl">0.99</span>)[<span class="dv">2</span>], <span class="dv">2</span>), <span class="co"># 2x Color 2 for autonomous</span></a>
<a class="sourceLine" id="cb10-12" title="12">                 <span class="kw">rep</span>(viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">5</span>, <span class="dt">begin =</span> <span class="fl">0.4</span>, <span class="dt">end =</span> <span class="fl">0.99</span>)[<span class="dv">3</span>], <span class="dv">2</span>)) <span class="co"># 2x Color 3 for controlled</span></a>
<a class="sourceLine" id="cb10-13" title="13"></a>
<a class="sourceLine" id="cb10-14" title="14">BCT_mgm &lt;-<span class="st"> </span>qgraph<span class="op">::</span><span class="kw">qgraph</span>(mgm_obj<span class="op">$</span>pairwise<span class="op">$</span>wadj, </a>
<a class="sourceLine" id="cb10-15" title="15">            <span class="dt">layout =</span> <span class="st">&quot;spring&quot;</span>,</a>
<a class="sourceLine" id="cb10-16" title="16">            <span class="dt">repulsion =</span> <span class="dv">1</span>, <span class="co"># To nudge the network from originally bad visual state</span></a>
<a class="sourceLine" id="cb10-17" title="17">            <span class="co"># title = &quot;Mixed graphical model: PA, BCTs &amp; motivation&quot;,</span></a>
<a class="sourceLine" id="cb10-18" title="18">            <span class="dt">edge.color =</span> <span class="kw">ifelse</span>(mgm_obj<span class="op">$</span>pairwise<span class="op">$</span>edgecolor <span class="op">==</span><span class="st"> &quot;darkgreen&quot;</span>, <span class="st">&quot;blue&quot;</span>, mgm_obj<span class="op">$</span>pairwise<span class="op">$</span>edgecolor),</a>
<a class="sourceLine" id="cb10-19" title="19">            <span class="dt">pie =</span> pie_errors,</a>
<a class="sourceLine" id="cb10-20" title="20">            <span class="dt">pieColor =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">5</span>, <span class="dt">begin =</span> <span class="fl">0.3</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">5</span>],</a>
<a class="sourceLine" id="cb10-21" title="21">            <span class="dt">color =</span> node_colors,</a>
<a class="sourceLine" id="cb10-22" title="22">            <span class="dt">labels =</span> <span class="kw">names</span>(bctdf_mgm),</a>
<a class="sourceLine" id="cb10-23" title="23">            <span class="dt">label.cex =</span> <span class="fl">0.8</span>,</a>
<a class="sourceLine" id="cb10-24" title="24">            <span class="dt">label.scale =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb10-25" title="25">            <span class="dt">node.width =</span> <span class="fl">1.65</span>)</a></code></pre></div>
<p><img src="baseline-networks_files/figure-html/unnamed-chunk-5-1.png" width="2100" /></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1"></a>
<a class="sourceLine" id="cb11-2" title="2"><span class="co"># adjacency_noAmotivation &lt;- mgm_obj$pairwise$wadj</span></a>
<a class="sourceLine" id="cb11-3" title="3"><span class="co"># save(adjacency_noAmotivation, file = &quot;./Rdata_files/adjacency_noAmotivation.Rdata&quot;)</span></a>
<a class="sourceLine" id="cb11-4" title="4"><span class="co"># signs_noAmotivation &lt;- mgm_obj$pairwise$signs</span></a>
<a class="sourceLine" id="cb11-5" title="5"><span class="co"># save(signs_noAmotivation, file = &quot;./Rdata_files/signs_noAmotivation.Rdata&quot;)</span></a>
<a class="sourceLine" id="cb11-6" title="6"></a>
<a class="sourceLine" id="cb11-7" title="7"><span class="co"># BCT_mgm_noAmotivation_stability &lt;- mgm::resample(object = mgm_obj, data = bctdf_mgm, nB = 100)</span></a>
<a class="sourceLine" id="cb11-8" title="8"><span class="co"># save(BCT_mgm_noAmotivation_stability, file = &quot;./Rdata_files/BCT_mgm_noAmotivation_stability.Rdata&quot;)</span></a>
<a class="sourceLine" id="cb11-9" title="9"><span class="kw">load</span>(<span class="st">&quot;./Rdata_files/BCT_mgm_noAmotivation_stability.Rdata&quot;</span>)</a>
<a class="sourceLine" id="cb11-10" title="10"></a>
<a class="sourceLine" id="cb11-11" title="11"><span class="co"># # Plotting the bootstrapped edge between variables 1 and 4:</span></a>
<a class="sourceLine" id="cb11-12" title="12"><span class="co"># hist(BCT_mgm_noAmotivation_stability$bootParameters[1, 4, ],</span></a>
<a class="sourceLine" id="cb11-13" title="13"><span class="co"># main = &quot;&quot;,</span></a>
<a class="sourceLine" id="cb11-14" title="14"><span class="co"># xlab = &quot;Parameter Estimate&quot;)</span></a>
<a class="sourceLine" id="cb11-15" title="15"></a>
<a class="sourceLine" id="cb11-16" title="16">mgm<span class="op">::</span><span class="kw">plotRes</span>(<span class="dt">object =</span> BCT_mgm_noAmotivation_stability, </a>
<a class="sourceLine" id="cb11-17" title="17">        <span class="dt">quantiles =</span> <span class="kw">c</span>(.<span class="dv">05</span>, <span class="fl">.95</span>), </a>
<a class="sourceLine" id="cb11-18" title="18">        <span class="dt">cex.label =</span> <span class="fl">0.5</span>,</a>
<a class="sourceLine" id="cb11-19" title="19">        <span class="dt">lwd.qtl =</span> <span class="fl">2.5</span>, </a>
<a class="sourceLine" id="cb11-20" title="20">        <span class="dt">cex.mean =</span> <span class="fl">.5</span>,</a>
<a class="sourceLine" id="cb11-21" title="21">        <span class="dt">labels =</span> <span class="kw">names</span>(bctdf_mgm))</a></code></pre></div>
<p><img src="baseline-networks_files/figure-html/unnamed-chunk-5-2.png" width="2100" /></p>
<p>The bootstrap stability plot above shows the proportion of re-samples, which contain a non-zero link between two edges (for a tutorial, see <a href="http://psych-networks.com/bootstrapping-edges-after-regularization-clarifications-tutorial/">this link</a> – or, if it’s down, this <a href="https://web.archive.org/web/20180809113839/http://psych-networks.com/bootstrapping-edges-after-regularization-clarifications-tutorial/">archived page</a>). For example, when we draw observations from the current sample with replacement a 100 times, 99% of these times a non-zero link between questionnaire-measured MVPA and intrinsic motivation is estimated.</p>
</div>
<div id="correlation-network-and-mixed-graphical-model-compared" class="section level1">
<h1>Correlation network and mixed graphical model compared</h1>
<pre><code>## Note that the sign of parameter estimates is stored separately; see ?mgm</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Variable"],"name":[1],"type":["chr"],"align":["left"]},{"label":["RMSE"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["R2"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["CC"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["nCC"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["CCmarg"],"name":[6],"type":["dbl"],"align":["right"]}],"data":[{"1":"MVPA survey","2":"0.841","3":"0.292","4":"NA","5":"NA","6":"NA","_rn_":"1"},{"1":"MVPA accelerom.","2":"0.951","3":"0.095","4":"NA","5":"NA","6":"NA","_rn_":"2"},{"1":"Intrinsic","2":"0.629","3":"0.603","4":"NA","5":"NA","6":"NA","_rn_":"3"},{"1":"Identified","2":"0.635","3":"0.596","4":"NA","5":"NA","6":"NA","_rn_":"4"},{"1":"Introjected","2":"NA","3":"NA","4":"0.706","5":"0.166","6":"0.647","_rn_":"5"},{"1":"Extrinsic","2":"NA","3":"NA","4":"0.900","5":"0.014","6":"0.899","_rn_":"6"},{"1":"BCT usage","2":"0.763","3":"0.417","4":"NA","5":"NA","6":"NA","_rn_":"7"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1"></a>
<a class="sourceLine" id="cb13-2" title="2">averagedLayout &lt;-<span class="st"> </span>qgraph<span class="op">::</span><span class="kw">averageLayout</span>(BCT_mgm, corgraph)</a>
<a class="sourceLine" id="cb13-3" title="3"></a>
<a class="sourceLine" id="cb13-4" title="4"><span class="kw">layout</span>(<span class="kw">t</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb13-5" title="5"></a>
<a class="sourceLine" id="cb13-6" title="6">BCT_mgm &lt;-<span class="st"> </span>qgraph<span class="op">::</span><span class="kw">qgraph</span>(mgm_obj<span class="op">$</span>pairwise<span class="op">$</span>wadj, </a>
<a class="sourceLine" id="cb13-7" title="7">            <span class="dt">layout =</span> averagedLayout,</a>
<a class="sourceLine" id="cb13-8" title="8">            <span class="dt">edge.color =</span> <span class="kw">ifelse</span>(mgm_obj<span class="op">$</span>pairwise<span class="op">$</span>edgecolor <span class="op">==</span><span class="st"> &quot;darkgreen&quot;</span>, <span class="st">&quot;blue&quot;</span>, mgm_obj<span class="op">$</span>pairwise<span class="op">$</span>edgecolor),</a>
<a class="sourceLine" id="cb13-9" title="9">            <span class="dt">pie =</span> pie_errors,</a>
<a class="sourceLine" id="cb13-10" title="10">            <span class="dt">pieColor =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">5</span>, <span class="dt">begin =</span> <span class="fl">0.3</span>, <span class="dt">end =</span> <span class="fl">0.99</span>)[<span class="dv">2</span>],</a>
<a class="sourceLine" id="cb13-11" title="11">            <span class="dt">color =</span> node_colors,</a>
<a class="sourceLine" id="cb13-12" title="12">            <span class="dt">labels =</span> <span class="kw">names</span>(bctdf_mgm),</a>
<a class="sourceLine" id="cb13-13" title="13">            <span class="co"># label.cex = 1,</span></a>
<a class="sourceLine" id="cb13-14" title="14">            <span class="dt">label.scale =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb13-15" title="15">            <span class="co"># node.width = 1,</span></a>
<a class="sourceLine" id="cb13-16" title="16">            <span class="dt">edge.labels =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb13-17" title="17">            <span class="dt">title =</span> <span class="st">&quot;A)&quot;</span>)</a>
<a class="sourceLine" id="cb13-18" title="18"></a>
<a class="sourceLine" id="cb13-19" title="19">corgraph &lt;-<span class="st"> </span>qgraph<span class="op">::</span><span class="kw">qgraph</span>(qgraph<span class="op">::</span><span class="kw">cor_auto</span>(bctdf_mgm), </a>
<a class="sourceLine" id="cb13-20" title="20">              <span class="dt">layout =</span> averagedLayout,</a>
<a class="sourceLine" id="cb13-21" title="21">              <span class="dt">graph =</span> <span class="st">&quot;cor&quot;</span>,</a>
<a class="sourceLine" id="cb13-22" title="22">              <span class="dt">pie =</span> piefill,</a>
<a class="sourceLine" id="cb13-23" title="23">              <span class="dt">pieBorder =</span> <span class="dv">1</span>,</a>
<a class="sourceLine" id="cb13-24" title="24">              <span class="dt">nodeColor =</span> node_colors,</a>
<a class="sourceLine" id="cb13-25" title="25">              <span class="dt">labels =</span> <span class="kw">names</span>(bctdf_mgm),</a>
<a class="sourceLine" id="cb13-26" title="26">              <span class="co"># label.cex = 1,</span></a>
<a class="sourceLine" id="cb13-27" title="27">              <span class="dt">label.scale =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb13-28" title="28">              <span class="co"># node.width = 1,</span></a>
<a class="sourceLine" id="cb13-29" title="29">              <span class="dt">edge.labels =</span> <span class="ot">TRUE</span>, </a>
<a class="sourceLine" id="cb13-30" title="30">              <span class="dt">title =</span> <span class="st">&quot;B)&quot;</span>)</a>
<a class="sourceLine" id="cb13-31" title="31"><span class="co">## Error in drawNode(x, y, shape[i], vsize[i], vsize2[i], borders[i], vertex.colors[i], : Sum of &#39;pie&#39; argument may not be greater than 1 for any node.</span></a></code></pre></div>
<div class="figure">
<img src="baseline-networks_files/figure-html/network-plot-1.png" alt="A) Mixed graphical model with LASSO regularisation and model selection by cross-validation. Pie indicates node predictability. B) Bivariate correlation network. Pie indicates node mean as % of theoretical maximum (for MVPA accelerometer, mean as % average weartime)." width="3600" />
<p class="caption">
<ol style="list-style-type: upper-alpha">
<li>Mixed graphical model with LASSO regularisation and model selection by cross-validation. Pie indicates node predictability. B) Bivariate correlation network. Pie indicates node mean as % of theoretical maximum (for MVPA accelerometer, mean as % average weartime).
</p>
</div></li>
</ol>
<p>The “last motivation type”, i.e. the fifth, is Amotivation (dichotomised due to skew). A node for that is added in the network below:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1"></a>
<a class="sourceLine" id="cb14-2" title="2">bctdf_mgm &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(</a>
<a class="sourceLine" id="cb14-3" title="3">  <span class="st">&#39;agr-BCTs&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_T1,</a>
<a class="sourceLine" id="cb14-4" title="4">  <span class="st">&#39;frq-BCTs&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_T1,</a>
<a class="sourceLine" id="cb14-5" title="5">  <span class="st">&#39;MVPA questionnaire&#39;</span> =<span class="st"> </span>padaysLastweek_T1,</a>
<a class="sourceLine" id="cb14-6" title="6">  <span class="st">&#39;MVPA accelerometer&#39;</span> =<span class="st"> </span>mvpaAccelerometer_T1,</a>
<a class="sourceLine" id="cb14-7" title="7">  <span class="st">&#39;Intrinsic&#39;</span> =<span class="st"> </span>PA_intrinsic_T1,</a>
<a class="sourceLine" id="cb14-8" title="8">  <span class="st">&#39;Identified&#39;</span> =<span class="st"> </span>PA_identified_T1,</a>
<a class="sourceLine" id="cb14-9" title="9">  <span class="st">&#39;Introjected&#39;</span> =<span class="st"> </span>PA_introjected_T1,</a>
<a class="sourceLine" id="cb14-10" title="10">  <span class="st">&#39;Extrinsic&#39;</span> =<span class="st"> </span>PA_extrinsic_T1,</a>
<a class="sourceLine" id="cb14-11" title="11">  <span class="st">&#39;Amotivation&#39;</span> =<span class="st"> </span>PA_amotivation_T1) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb14-12" title="12"><span class="st"> </span><span class="kw">rowwise</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb14-13" title="13"><span class="st"> </span><span class="kw">mutate</span>(</a>
<a class="sourceLine" id="cb14-14" title="14">  <span class="st">&#39;BCT usage&#39;</span> =<span class="st"> </span><span class="kw">mean</span>(<span class="kw">c</span>(<span class="st">`</span><span class="dt">agr-BCTs</span><span class="st">`</span>, <span class="st">`</span><span class="dt">frq-BCTs</span><span class="st">`</span>), <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb14-15" title="15">  <span class="co"># &#39;autonomous motivation&#39; = mean(c(identified, intrinsic), na.rm = TRUE),</span></a>
<a class="sourceLine" id="cb14-16" title="16">  <span class="st">&#39;Extrinsic&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">Extrinsic</span><span class="st">`</span> <span class="op">&lt;</span><span class="st"> </span><span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">1</span>), <span class="co"># If &quot;at least partly&quot; or more true, input 1. Normality otherwise a problem.</span></a>
<a class="sourceLine" id="cb14-17" title="17">  <span class="st">&#39;Amotivation&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">Amotivation</span><span class="st">`</span> <span class="op">&lt;</span><span class="st"> </span><span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">1</span>), <span class="co"># If &quot;at least partly&quot; or more true, input 1. Normality otherwise a problem.</span></a>
<a class="sourceLine" id="cb14-18" title="18">  <span class="st">&#39;Introjected&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">Introjected</span><span class="st">`</span> <span class="op">&lt;</span><span class="st"> </span><span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">1</span>)) <span class="op">%&gt;%</span><span class="st">  </span><span class="co"># If &quot;at least partly&quot; or more true, input 1. Normality otherwise a problem. </span></a>
<a class="sourceLine" id="cb14-19" title="19"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="st">&#39;MVPA questionnaire&#39;</span>, <span class="st">&#39;MVPA accelerometer&#39;</span>, <span class="st">&#39;BCT usage&#39;</span>, <span class="kw">everything</span>(), <span class="op">-</span><span class="kw">contains</span>(<span class="st">&quot;-BCTs&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb14-20" title="20"><span class="st">  </span><span class="kw">mutate_all</span>(as.numeric)</a>
<a class="sourceLine" id="cb14-21" title="21"></a>
<a class="sourceLine" id="cb14-22" title="22">bctdf_mgm<span class="op">$</span><span class="st">`</span><span class="dt">BCT usage</span><span class="st">`</span>[<span class="kw">is.nan</span>(bctdf_mgm<span class="op">$</span><span class="st">`</span><span class="dt">BCT usage</span><span class="st">`</span>)] &lt;-<span class="st"> </span><span class="ot">NA</span></a>
<a class="sourceLine" id="cb14-23" title="23"></a>
<a class="sourceLine" id="cb14-24" title="24">labs &lt;-<span class="st"> </span><span class="kw">names</span>(bctdf_mgm)</a>
<a class="sourceLine" id="cb14-25" title="25"></a>
<a class="sourceLine" id="cb14-26" title="26"><span class="co"># mgm wants full data, see package missForest for imputation methods</span></a>
<a class="sourceLine" id="cb14-27" title="27">bctdf_mgm &lt;-<span class="st"> </span>bctdf_mgm <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">na.omit</span>(.)</a>
<a class="sourceLine" id="cb14-28" title="28"><span class="co"># bctdf_mgm %&gt;% names()</span></a>
<a class="sourceLine" id="cb14-29" title="29">mgm_variable_types &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">&quot;g&quot;</span>, <span class="dv">5</span>), <span class="st">&quot;c&quot;</span>, <span class="st">&quot;c&quot;</span>, <span class="st">&quot;c&quot;</span>)</a>
<a class="sourceLine" id="cb14-30" title="30">mgm_variable_levels &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">&quot;1&quot;</span>, <span class="dv">5</span>), <span class="st">&quot;2&quot;</span>, <span class="st">&quot;2&quot;</span>, <span class="st">&quot;2&quot;</span>)</a>
<a class="sourceLine" id="cb14-31" title="31"><span class="co"># data.frame(mgm_variable_types, mgm_variable_levels, names(bctdf_mgm))</span></a>
<a class="sourceLine" id="cb14-32" title="32"></a>
<a class="sourceLine" id="cb14-33" title="33">mgm_obj &lt;-<span class="st"> </span>mgm<span class="op">::</span><span class="kw">mgm</span>(<span class="dt">data =</span> bctdf_mgm,</a>
<a class="sourceLine" id="cb14-34" title="34">  <span class="dt">type =</span> mgm_variable_types,</a>
<a class="sourceLine" id="cb14-35" title="35">  <span class="dt">level =</span> mgm_variable_levels,</a>
<a class="sourceLine" id="cb14-36" title="36">  <span class="dt">lambdaSel =</span> <span class="st">&quot;CV&quot;</span>,</a>
<a class="sourceLine" id="cb14-37" title="37">  <span class="dt">lambdaFolds =</span> <span class="dv">10</span>,</a>
<a class="sourceLine" id="cb14-38" title="38">  <span class="dt">pbar =</span> <span class="ot">FALSE</span>, </a>
<a class="sourceLine" id="cb14-39" title="39">  <span class="dt">binarySign =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb14-40" title="40"><span class="co">## Note that the sign of parameter estimates is stored separately; see ?mgm</span></a>
<a class="sourceLine" id="cb14-41" title="41"></a>
<a class="sourceLine" id="cb14-42" title="42">pred_obj &lt;-<span class="st"> </span><span class="kw">predict</span>(<span class="dt">object =</span> mgm_obj,</a>
<a class="sourceLine" id="cb14-43" title="43">                         <span class="dt">data =</span> bctdf_mgm)</a>
<a class="sourceLine" id="cb14-44" title="44"></a>
<a class="sourceLine" id="cb14-45" title="45">pred_obj<span class="op">$</span>errors</a></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Variable"],"name":[1],"type":["chr"],"align":["left"]},{"label":["RMSE"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["R2"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["CC"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["nCC"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["CCmarg"],"name":[6],"type":["dbl"],"align":["right"]}],"data":[{"1":"MVPA questionnaire","2":"0.839","3":"0.295","4":"NA","5":"NA","6":"NA","_rn_":"1"},{"1":"MVPA accelerometer","2":"0.947","3":"0.102","4":"NA","5":"NA","6":"NA","_rn_":"2"},{"1":"BCT usage","2":"0.761","3":"0.420","4":"NA","5":"NA","6":"NA","_rn_":"3"},{"1":"Intrinsic","2":"0.623","3":"0.612","4":"NA","5":"NA","6":"NA","_rn_":"4"},{"1":"Identified","2":"0.633","3":"0.599","4":"NA","5":"NA","6":"NA","_rn_":"5"},{"1":"Introjected","2":"NA","3":"NA","4":"0.710","5":"0.178","6":"0.647","_rn_":"6"},{"1":"Extrinsic","2":"NA","3":"NA","4":"0.916","5":"0.178","6":"0.898","_rn_":"7"},{"1":"Amotivation","2":"NA","3":"NA","4":"0.909","5":"0.000","6":"0.909","_rn_":"8"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1"></a>
<a class="sourceLine" id="cb15-2" title="2"><span class="co"># Take R2 from gaussian, CC from categorical variables </span></a>
<a class="sourceLine" id="cb15-3" title="3">pie_errors &lt;-<span class="st"> </span><span class="kw">c</span>(pred_obj<span class="op">$</span>errors[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>, <span class="dv">3</span>],</a>
<a class="sourceLine" id="cb15-4" title="4">                pred_obj<span class="op">$</span>errors[<span class="dv">6</span><span class="op">:</span><span class="dv">8</span>, <span class="dv">4</span>])</a>
<a class="sourceLine" id="cb15-5" title="5"></a>
<a class="sourceLine" id="cb15-6" title="6"><span class="co"># Coloring nodes: make a sequence of colors from the viridis palette. We need three colors (MVPA, BCTs, motivation), and &quot;begin&quot; from ones that are not too dark, so that black text shows up ok.</span></a>
<a class="sourceLine" id="cb15-7" title="7"></a>
<a class="sourceLine" id="cb15-8" title="8">node_colors &lt;-<span class="st"> </span><span class="kw">c</span>(viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">5</span>, <span class="dt">begin =</span> <span class="fl">0.4</span>, <span class="dt">end =</span> <span class="fl">0.99</span>)[<span class="dv">1</span>], <span class="co"># Color 1 for MVPA (questionnaire)</span></a>
<a class="sourceLine" id="cb15-9" title="9">                 viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">5</span>, <span class="dt">begin =</span> <span class="fl">0.4</span>, <span class="dt">end =</span> <span class="fl">0.99</span>)[<span class="dv">1</span>], <span class="co"># Color 1 for MVPA (accelerometer)</span></a>
<a class="sourceLine" id="cb15-10" title="10">                 <span class="kw">rep</span>(viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">5</span>, <span class="dt">begin =</span> <span class="fl">0.4</span>, <span class="dt">end =</span> <span class="fl">0.99</span>)[<span class="dv">4</span>], <span class="dv">1</span>), <span class="co"># 1x Color 4 for BCTs</span></a>
<a class="sourceLine" id="cb15-11" title="11">                 <span class="kw">rep</span>(viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">5</span>, <span class="dt">begin =</span> <span class="fl">0.4</span>, <span class="dt">end =</span> <span class="fl">0.99</span>)[<span class="dv">2</span>], <span class="dv">2</span>), <span class="co"># 2x Color 2 for autonomous</span></a>
<a class="sourceLine" id="cb15-12" title="12">                 <span class="kw">rep</span>(viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">5</span>, <span class="dt">begin =</span> <span class="fl">0.4</span>, <span class="dt">end =</span> <span class="fl">0.99</span>)[<span class="dv">3</span>], <span class="dv">3</span>)) <span class="co"># 3x Color 3 for controlled/amotivation</span></a>
<a class="sourceLine" id="cb15-13" title="13"></a>
<a class="sourceLine" id="cb15-14" title="14">BCT_mgm &lt;-<span class="st"> </span>qgraph<span class="op">::</span><span class="kw">qgraph</span>(mgm_obj<span class="op">$</span>pairwise<span class="op">$</span>wadj, </a>
<a class="sourceLine" id="cb15-15" title="15">            <span class="dt">layout =</span> <span class="st">&quot;spring&quot;</span>,</a>
<a class="sourceLine" id="cb15-16" title="16">            <span class="dt">repulsion =</span> <span class="dv">1</span>, <span class="co"># To nudge the network from originally bad visual state</span></a>
<a class="sourceLine" id="cb15-17" title="17">            <span class="co"># title = &quot;Mixed graphical model: PA, BCTs &amp; motivation&quot;,</span></a>
<a class="sourceLine" id="cb15-18" title="18">            <span class="dt">edge.color =</span> <span class="kw">ifelse</span>(mgm_obj<span class="op">$</span>pairwise<span class="op">$</span>edgecolor <span class="op">==</span><span class="st"> &quot;darkgreen&quot;</span>, <span class="st">&quot;blue&quot;</span>, mgm_obj<span class="op">$</span>pairwise<span class="op">$</span>edgecolor),</a>
<a class="sourceLine" id="cb15-19" title="19">            <span class="dt">pie =</span> pie_errors,</a>
<a class="sourceLine" id="cb15-20" title="20">            <span class="dt">pieColor =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">5</span>, <span class="dt">begin =</span> <span class="fl">0.3</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">5</span>],</a>
<a class="sourceLine" id="cb15-21" title="21">            <span class="dt">color =</span> node_colors,</a>
<a class="sourceLine" id="cb15-22" title="22">            <span class="dt">labels =</span> <span class="kw">names</span>(bctdf_mgm),</a>
<a class="sourceLine" id="cb15-23" title="23">            <span class="dt">label.cex =</span> <span class="fl">0.8</span>,</a>
<a class="sourceLine" id="cb15-24" title="24">            <span class="dt">label.scale =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb15-25" title="25">            <span class="dt">node.width =</span> <span class="fl">1.65</span>)</a></code></pre></div>
<p><img src="baseline-networks_files/figure-html/unnamed-chunk-6-1.png" width="2100" /></p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" title="1"></a>
<a class="sourceLine" id="cb16-2" title="2"><span class="co"># BCT_mgm_withAmotivation_stability &lt;- mgm::resample(object = mgm_obj, data = bctdf_mgm, nB = 100)</span></a>
<a class="sourceLine" id="cb16-3" title="3"><span class="co"># save(BCT_mgm_withAmotivation_stability, file = &quot;./Rdata_files/BCT_mgm_withAmotivation_stability.Rdata&quot;)</span></a>
<a class="sourceLine" id="cb16-4" title="4"><span class="kw">load</span>(<span class="st">&quot;./Rdata_files/BCT_mgm_withAmotivation_stability.Rdata&quot;</span>)</a>
<a class="sourceLine" id="cb16-5" title="5"></a>
<a class="sourceLine" id="cb16-6" title="6">mgm<span class="op">::</span><span class="kw">plotRes</span>(<span class="dt">object =</span> BCT_mgm_withAmotivation_stability, </a>
<a class="sourceLine" id="cb16-7" title="7">        <span class="dt">quantiles =</span> <span class="kw">c</span>(.<span class="dv">05</span>, <span class="fl">.95</span>), </a>
<a class="sourceLine" id="cb16-8" title="8">        <span class="dt">cex.label =</span> <span class="fl">1.25</span>, </a>
<a class="sourceLine" id="cb16-9" title="9">        <span class="dt">lwd.qtl =</span> <span class="fl">2.5</span>, </a>
<a class="sourceLine" id="cb16-10" title="10">        <span class="dt">cex.mean =</span> <span class="fl">.5</span>)</a></code></pre></div>
<p><img src="baseline-networks_files/figure-html/unnamed-chunk-6-2.png" width="2100" /></p>
<p>Theory-wise, Amotivation should be negatively correlated with everything but Extrinsic and Introjected. Given that BCT usage is 19 items, there are probably a lot of ways there can be a positive correlation, although that would be unexpected. But the positive relation with MVPA questionnaire would mean, that people who report having done physical activity on more days last week, would also say they don’t see any point in doing physical activity (another example item: I think exercising is a waste of time). One explanation would be some form of <a href="https://web.archive.org/web/20180807095037/http://www.the100.ci/2017/03/14/that-one-weird-third-variable-problem-nobody-ever-mentions-conditioning-on-a-collider/">conditioning on a collider</a>.</p>
<p>One option would be, that (as the model drops incomplete observations), there is some selection effects based on motivation types and/or BCT usage. To check for this, we estimate a Gaussian Graphical Model, which assumes normally distributed data but uses all observations.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" title="1">bctdf_ggm &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(</a>
<a class="sourceLine" id="cb17-2" title="2">  <span class="st">&#39;agr-BCTs&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_T1,</a>
<a class="sourceLine" id="cb17-3" title="3">  <span class="st">&#39;frq-BCTs&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_T1,</a>
<a class="sourceLine" id="cb17-4" title="4">  <span class="st">&#39;MVPA questionnaire&#39;</span> =<span class="st"> </span>padaysLastweek_T1,</a>
<a class="sourceLine" id="cb17-5" title="5">  <span class="st">&#39;MVPA accelerometer&#39;</span> =<span class="st"> </span>mvpaAccelerometer_T1,</a>
<a class="sourceLine" id="cb17-6" title="6">  <span class="st">&#39;Intrinsic&#39;</span> =<span class="st"> </span>PA_intrinsic_T1,</a>
<a class="sourceLine" id="cb17-7" title="7">  <span class="st">&#39;Identified&#39;</span> =<span class="st"> </span>PA_identified_T1,</a>
<a class="sourceLine" id="cb17-8" title="8">  <span class="st">&#39;Introjected&#39;</span> =<span class="st"> </span>PA_introjected_T1,</a>
<a class="sourceLine" id="cb17-9" title="9">  <span class="st">&#39;Extrinsic&#39;</span> =<span class="st"> </span>PA_extrinsic_T1,</a>
<a class="sourceLine" id="cb17-10" title="10">  <span class="st">&#39;Amotivation&#39;</span> =<span class="st"> </span>PA_amotivation_T1) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb17-11" title="11"><span class="st"> </span><span class="kw">rowwise</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb17-12" title="12"><span class="st"> </span><span class="kw">mutate</span>(</a>
<a class="sourceLine" id="cb17-13" title="13">  <span class="st">&#39;BCT usage&#39;</span> =<span class="st"> </span><span class="kw">mean</span>(<span class="kw">c</span>(<span class="st">`</span><span class="dt">agr-BCTs</span><span class="st">`</span>, <span class="st">`</span><span class="dt">frq-BCTs</span><span class="st">`</span>), <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb17-14" title="14">  <span class="co"># &#39;autonomous motivation&#39; = mean(c(identified, intrinsic), na.rm = TRUE),</span></a>
<a class="sourceLine" id="cb17-15" title="15">  <span class="st">&#39;Extrinsic&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">Extrinsic</span><span class="st">`</span> <span class="op">&lt;</span><span class="st"> </span><span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">1</span>), <span class="co"># If &quot;at least partly&quot; or more true, input 1. Normality otherwise a problem.</span></a>
<a class="sourceLine" id="cb17-16" title="16">  <span class="st">&#39;Amotivation&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">Amotivation</span><span class="st">`</span> <span class="op">&lt;</span><span class="st"> </span><span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">1</span>), <span class="co"># If &quot;at least partly&quot; or more true, input 1. Normality otherwise a problem.</span></a>
<a class="sourceLine" id="cb17-17" title="17">  <span class="st">&#39;Introjected&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">Introjected</span><span class="st">`</span> <span class="op">&lt;</span><span class="st"> </span><span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">1</span>)) <span class="op">%&gt;%</span><span class="st">  </span><span class="co"># If &quot;at least partly&quot; or more true, input 1. Normality otherwise a problem. </span></a>
<a class="sourceLine" id="cb17-18" title="18"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="st">&#39;MVPA questionnaire&#39;</span>, <span class="st">&#39;MVPA accelerometer&#39;</span>, <span class="st">&#39;BCT usage&#39;</span>, <span class="kw">everything</span>(), <span class="op">-</span><span class="kw">contains</span>(<span class="st">&quot;-BCTs&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb17-19" title="19"><span class="st">  </span><span class="kw">mutate_all</span>(as.numeric)</a>
<a class="sourceLine" id="cb17-20" title="20"></a>
<a class="sourceLine" id="cb17-21" title="21">bctdf_ggm<span class="op">$</span><span class="st">`</span><span class="dt">BCT usage</span><span class="st">`</span>[<span class="kw">is.nan</span>(bctdf_ggm<span class="op">$</span><span class="st">`</span><span class="dt">BCT usage</span><span class="st">`</span>)] &lt;-<span class="st"> </span><span class="ot">NA</span></a>
<a class="sourceLine" id="cb17-22" title="22"></a>
<a class="sourceLine" id="cb17-23" title="23"><span class="co"># Network for all participants</span></a>
<a class="sourceLine" id="cb17-24" title="24">S.total_ggm &lt;-<span class="st"> </span>bctdf_ggm</a>
<a class="sourceLine" id="cb17-25" title="25">nwBCT_ggm &lt;-<span class="st"> </span>bootnet<span class="op">::</span><span class="kw">estimateNetwork</span>(S.total_ggm, <span class="dt">default=</span><span class="st">&quot;EBICglasso&quot;</span>)</a>
<a class="sourceLine" id="cb17-26" title="26"></a>
<a class="sourceLine" id="cb17-27" title="27">labs_ggm &lt;-<span class="st"> </span><span class="kw">colnames</span>(S.total_ggm)</a>
<a class="sourceLine" id="cb17-28" title="28"></a>
<a class="sourceLine" id="cb17-29" title="29"><span class="co"># Create means for filling nodes</span></a>
<a class="sourceLine" id="cb17-30" title="30"><span class="co"># piefill_ggm &lt;- S.total_ggm %&gt;% </span></a>
<a class="sourceLine" id="cb17-31" title="31"><span class="co">#   dplyr::select(-contains(&quot;MVPA&quot;), -contains(&quot;motivation&quot;)) %&gt;% data.frame %&gt;% </span></a>
<a class="sourceLine" id="cb17-32" title="32"><span class="co">#   dplyr::summarise_all(funs(mean(., na.rm = TRUE) /6))</span></a>
<a class="sourceLine" id="cb17-33" title="33"><span class="co"># </span></a>
<a class="sourceLine" id="cb17-34" title="34"><span class="co"># piefill_ggm$`MVPA accelerometer` &lt;- median(S.total_ggm$`MVPA accelerometer`, na.rm = TRUE) / (60 * 24)</span></a>
<a class="sourceLine" id="cb17-35" title="35"><span class="co"># piefill_ggm$`MVPA questionnaire` &lt;- median(S.total_ggm$`MVPA questionnaire`, na.rm = TRUE) / 7</span></a>
<a class="sourceLine" id="cb17-36" title="36"><span class="co"># piefill_ggm$autonomous &lt;- median(S.total_ggm$`autonomous motivation`, na.rm = TRUE) / 5</span></a>
<a class="sourceLine" id="cb17-37" title="37"><span class="co"># piefill_ggm$controlled &lt;- median(S.total_ggm$`controlled motivation`, na.rm = TRUE) / 5</span></a>
<a class="sourceLine" id="cb17-38" title="38"><span class="co">#   </span></a>
<a class="sourceLine" id="cb17-39" title="39"><span class="co"># piefill_ggm &lt;- piefill_ggm %&gt;% </span></a>
<a class="sourceLine" id="cb17-40" title="40"><span class="co">#   dplyr::select(&quot;MVPA questionnaire&quot;, &quot;MVPA accelerometer&quot;, autonomous, controlled, everything())</span></a>
<a class="sourceLine" id="cb17-41" title="41"></a>
<a class="sourceLine" id="cb17-42" title="42"><span class="co"># Plot network</span></a>
<a class="sourceLine" id="cb17-43" title="43"></a>
<a class="sourceLine" id="cb17-44" title="44">BCT_ggm &lt;-<span class="st"> </span><span class="kw">plot</span>(nwBCT_ggm, </a>
<a class="sourceLine" id="cb17-45" title="45">                <span class="dt">layout =</span> <span class="st">&quot;spring&quot;</span>, </a>
<a class="sourceLine" id="cb17-46" title="46">                <span class="dt">repulsion =</span> <span class="fl">0.99</span>, <span class="co"># To nudge the network from originally bad visual state</span></a>
<a class="sourceLine" id="cb17-47" title="47">                <span class="dt">label.scale =</span> <span class="ot">FALSE</span>, </a>
<a class="sourceLine" id="cb17-48" title="48">                <span class="dt">title =</span> <span class="st">&quot;GGM: MVPA, BCTs &amp; motivation&quot;</span>, </a>
<a class="sourceLine" id="cb17-49" title="49">                <span class="dt">label.cex =</span> <span class="fl">0.75</span>,</a>
<a class="sourceLine" id="cb17-50" title="50">                <span class="co"># pie = piefill_ggm,</span></a>
<a class="sourceLine" id="cb17-51" title="51">                <span class="dt">color =</span> <span class="st">&quot;skyblue&quot;</span>,</a>
<a class="sourceLine" id="cb17-52" title="52">                <span class="dt">pieBorder =</span> <span class="dv">1</span>)</a></code></pre></div>
<p><img src="baseline-networks_files/figure-html/selection-collider-check-ggm-1.png" width="2100" /></p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" title="1"></a>
<a class="sourceLine" id="cb18-2" title="2"></a>
<a class="sourceLine" id="cb18-3" title="3">qgraph<span class="op">::</span><span class="kw">flow</span>(BCT_ggm, <span class="st">&quot;MVPA accelerometer&quot;</span>, <span class="dt">theme =</span> <span class="st">&quot;colorblind&quot;</span>, <span class="dt">vsize =</span> <span class="dv">8</span>)</a></code></pre></div>
<p><img src="baseline-networks_files/figure-html/selection-collider-check-ggm-2.png" width="2100" /></p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" title="1">qgraph<span class="op">::</span><span class="kw">flow</span>(BCT_ggm, <span class="st">&quot;MVPA questionnaire&quot;</span>, <span class="dt">theme =</span> <span class="st">&quot;colorblind&quot;</span>, <span class="dt">vsize =</span> <span class="dv">8</span>)</a></code></pre></div>
<p><img src="baseline-networks_files/figure-html/selection-collider-check-ggm-3.png" width="2100" /></p>
<p>From the network above, we see that the positive connection between amotivation and questionnaire-measured MVPA has almost completely disappered. Bootstrapping to inspect stability shows, that the connection is likely to be zero (see 13th edge from the bottom; “MVPA questionnaire–Amotivation”).</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" title="1"></a>
<a class="sourceLine" id="cb20-2" title="2"><span class="co"># collider_boot &lt;- bootnet(nwBCT_ggm, nBoots = 2500)</span></a>
<a class="sourceLine" id="cb20-3" title="3"><span class="co"># save(collider_boot, file = &quot;./Rdata_files/collider_boot.Rdata&quot;)</span></a>
<a class="sourceLine" id="cb20-4" title="4"><span class="kw">load</span>(<span class="st">&quot;./Rdata_files/collider_boot.Rdata&quot;</span>)</a>
<a class="sourceLine" id="cb20-5" title="5"><span class="kw">plot</span>(collider_boot, <span class="dt">plot =</span> <span class="st">&quot;interval&quot;</span>, <span class="dt">split0 =</span> <span class="ot">TRUE</span>, <span class="dt">order =</span> <span class="st">&quot;sample&quot;</span>, <span class="dt">labels =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<p><img src="baseline-networks_files/figure-html/stability-1.png" width="2100" /></p>
<p>The bootstrap stability plot above (for a tutorial, see <a href="http://psych-networks.com/bootstrapping-edges-after-regularization-clarifications-tutorial/">this link</a> – or, if it’s down, this <a href="https://web.archive.org/web/20180809113839/http://psych-networks.com/bootstrapping-edges-after-regularization-clarifications-tutorial/">archived page</a>) shows, that when we draw observations from the sample with replacement 2500 times, the connection between amotivation and questionnaire-measured MVPA was estimated as non-zero only about 30% of time.</p>
</div>
<div id="combining-some-bct-items" class="section level1">
<h1>Combining some BCT items</h1>
<p>This section presents a Mixed Graphical Model (MGM) and a Gaussian Graphical Model (GGM). In the MGM, we opted to dichotomise the BCTs in order to increase interpretability while not violating model assumptions. Results do not differ very much. Some nodes were still combined, to reduce estimation burden.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" title="1">bctdf_mgm &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(</a>
<a class="sourceLine" id="cb21-2" title="2"><span class="co">#  id,</span></a>
<a class="sourceLine" id="cb21-3" title="3"><span class="co">#  intervention,</span></a>
<a class="sourceLine" id="cb21-4" title="4"><span class="co">#  group,</span></a>
<a class="sourceLine" id="cb21-5" title="5"><span class="co">#  school,</span></a>
<a class="sourceLine" id="cb21-6" title="6"><span class="co">#  girl,</span></a>
<a class="sourceLine" id="cb21-7" title="7">  <span class="st">&#39;goal setting&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">01</span>_T1,</a>
<a class="sourceLine" id="cb21-8" title="8">  <span class="st">&#39;own plan&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">02</span>_T1,</a>
<a class="sourceLine" id="cb21-9" title="9">  <span class="st">&#39;plan by other&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">03</span>_T1,</a>
<a class="sourceLine" id="cb21-10" title="10">  <span class="st">&#39;reminder of plan&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">04</span>_T1,</a>
<a class="sourceLine" id="cb21-11" title="11">  <span class="st">&#39;subgoals&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">05</span>_T1,</a>
<a class="sourceLine" id="cb21-12" title="12">  <span class="st">&#39;trying new PA&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">06</span>_T1,</a>
<a class="sourceLine" id="cb21-13" title="13">  <span class="st">&#39;barrier identification&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">07</span>_T1,</a>
<a class="sourceLine" id="cb21-14" title="14">  <span class="st">&#39;problem solving&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">08</span>_T1,</a>
<a class="sourceLine" id="cb21-15" title="15">  <span class="st">&#39;PA identity reflection&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">09</span>_T1,</a>
<a class="sourceLine" id="cb21-16" title="16">  <span class="st">&#39;aligning PA with life values&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">10</span>_T1,</a>
<a class="sourceLine" id="cb21-17" title="17">  <span class="st">&#39;remind of PA benefits&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">01</span>_T1,</a>
<a class="sourceLine" id="cb21-18" title="18">  <span class="st">&#39;self-monitor (paper)&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">02</span>_T1,</a>
<a class="sourceLine" id="cb21-19" title="19">  <span class="st">&#39;self-monitor (app)&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">03</span>_T1,</a>
<a class="sourceLine" id="cb21-20" title="20"><span class="co">#  &#39;memory cues&#39; = PA_frequencyDependentBCT_04_T1, # Issues with clarity of item wording </span></a>
<a class="sourceLine" id="cb21-21" title="21">  <span class="st">&#39;goal review&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">05</span>_T1,</a>
<a class="sourceLine" id="cb21-22" title="22">  <span class="st">&#39;personal relevance reflection&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">06</span>_T1,</a>
<a class="sourceLine" id="cb21-23" title="23">  <span class="st">&#39;environmental changes (home)&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">07</span>_T1,</a>
<a class="sourceLine" id="cb21-24" title="24">  <span class="st">&#39;social support&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">08</span>_T1,</a>
<a class="sourceLine" id="cb21-25" title="25">  <span class="st">&#39;analysing goal failure&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">09</span>_T1,</a>
<a class="sourceLine" id="cb21-26" title="26">  <span class="st">&#39;MVPA questionnaire&#39;</span> =<span class="st"> </span>padaysLastweek_T1,</a>
<a class="sourceLine" id="cb21-27" title="27">  <span class="st">&#39;MVPA accelerometer&#39;</span> =<span class="st"> </span>mvpaAccelerometer_T1,</a>
<a class="sourceLine" id="cb21-28" title="28">  <span class="st">&#39;intrinsic&#39;</span> =<span class="st"> </span>PA_intrinsic_T1,</a>
<a class="sourceLine" id="cb21-29" title="29">  <span class="st">&#39;identified&#39;</span> =<span class="st"> </span>PA_identified_T1,</a>
<a class="sourceLine" id="cb21-30" title="30">  <span class="st">&#39;controlled motivation&#39;</span> =<span class="st"> </span>PA_controlled_T1) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb21-31" title="31"><span class="st"> </span><span class="kw">rowwise</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb21-32" title="32"><span class="st"> </span><span class="kw">mutate</span>(</a>
<a class="sourceLine" id="cb21-33" title="33">  <span class="st">&#39;goal setting&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">goal setting</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb21-34" title="34"><span class="co">#  &#39;has plan&#39; = ifelse(`own plan` == 1 &amp; `plan by other` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb21-35" title="35">  <span class="st">&#39;own plan&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">own plan</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb21-36" title="36">  <span class="st">&#39;plan by other&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">plan by other</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb21-37" title="37">  <span class="st">&#39;reminder of plan&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">reminder of plan</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb21-38" title="38">  <span class="st">&#39;subgoals&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">subgoals</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb21-39" title="39">  <span class="st">&#39;trying new PA&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">trying new PA</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb21-40" title="40"><span class="co">#  &#39;barrier identification&#39; = ifelse(`barrier identification` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb21-41" title="41"><span class="co">#  &#39;problem solving&#39; = ifelse(`problem solving` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb21-42" title="42">  <span class="st">&#39;barriers identified or planned for&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">problem solving</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span> <span class="op">&amp;</span><span class="st"> `</span><span class="dt">barrier identification</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb21-43" title="43"><span class="co">#  &#39;PA identity reflection&#39; = ifelse(`PA identity reflection` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb21-44" title="44"><span class="co">#  &#39;aligning PA with life values&#39; = ifelse(`aligning PA with life values` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb21-45" title="45">  <span class="st">&#39;identity, life values&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">PA identity reflection</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span> <span class="op">&amp;</span><span class="st"> `</span><span class="dt">aligning PA with life values</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb21-46" title="46">  <span class="st">&#39;remind of PA benefits&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">remind of PA benefits</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb21-47" title="47">  <span class="st">&#39;monitoring PA&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">self-monitor (paper)</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span> <span class="op">&amp;</span><span class="st"> `</span><span class="dt">self-monitor (app)</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb21-48" title="48"><span class="co">#  &#39;memory cues&#39; = ifelse(`memory cues` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb21-49" title="49">  <span class="st">&#39;goal review&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">goal review</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb21-50" title="50">  <span class="st">&#39;personal relevance reflection&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">personal relevance reflection</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb21-51" title="51">  <span class="st">&#39;environmental changes (home)&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">environmental changes (home)</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb21-52" title="52">  <span class="st">&#39;social support&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">social support</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb21-53" title="53">  <span class="st">&#39;analysing goal failure&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">analysing goal failure</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb21-54" title="54">  <span class="st">&#39;autonomous motivation&#39;</span> =<span class="st"> </span><span class="kw">mean</span>(<span class="kw">c</span>(identified, intrinsic), <span class="dt">na.rm =</span> T),</a>
<a class="sourceLine" id="cb21-55" title="55"><span class="co">#  &#39;girl&#39; = ifelse(girl == &quot;girl&quot;, 1, 0),</span></a>
<a class="sourceLine" id="cb21-56" title="56">  <span class="st">&#39;controlled motivation&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">controlled motivation</span><span class="st">`</span> <span class="op">&lt;</span><span class="st"> </span><span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">1</span>)) <span class="op">%&gt;%</span><span class="st">  </span><span class="co"># If &quot;at least partly&quot; or more true, input 1. Normality otherwise a problem. </span></a>
<a class="sourceLine" id="cb21-57" title="57"><span class="co">#  &#39;intervention&#39; = ifelse(intervention == &quot;1&quot;, 1, 0)) %&gt;% </span></a>
<a class="sourceLine" id="cb21-58" title="58"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span><span class="st">`</span><span class="dt">self-monitor (paper)</span><span class="st">`</span>, <span class="op">-</span><span class="st">`</span><span class="dt">self-monitor (app)</span><span class="st">`</span>, </a>
<a class="sourceLine" id="cb21-59" title="59">                <span class="co"># -`plan by other`, -`own plan`, </span></a>
<a class="sourceLine" id="cb21-60" title="60">                <span class="op">-</span>identified, <span class="op">-</span>intrinsic,</a>
<a class="sourceLine" id="cb21-61" title="61">         <span class="op">-</span><span class="st">`</span><span class="dt">analysing goal failure</span><span class="st">`</span>, <span class="co"># only concerns those who haven&#39;t reached goals</span></a>
<a class="sourceLine" id="cb21-62" title="62">         <span class="op">-</span><span class="st">`</span><span class="dt">barrier identification</span><span class="st">`</span>, <span class="op">-</span><span class="st">`</span><span class="dt">problem solving</span><span class="st">`</span>, <span class="co"># closely related</span></a>
<a class="sourceLine" id="cb21-63" title="63">         <span class="op">-</span><span class="st">`</span><span class="dt">PA identity reflection</span><span class="st">`</span>, <span class="op">-</span><span class="st">`</span><span class="dt">aligning PA with life values</span><span class="st">`</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># closely related</span></a>
<a class="sourceLine" id="cb21-64" title="64"><span class="co">#  dplyr::select(-controlled) %&gt;% # Not really gaussian at all </span></a>
<a class="sourceLine" id="cb21-65" title="65"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="st">&#39;MVPA questionnaire&#39;</span>, <span class="st">&#39;MVPA accelerometer&#39;</span>, <span class="kw">everything</span>())</a>
<a class="sourceLine" id="cb21-66" title="66"></a>
<a class="sourceLine" id="cb21-67" title="67">bctdf_mgm<span class="op">$</span><span class="st">`</span><span class="dt">autonomous motivation</span><span class="st">`</span>[<span class="kw">is.nan</span>(bctdf_mgm<span class="op">$</span><span class="st">`</span><span class="dt">autonomous motivation</span><span class="st">`</span>)] &lt;-<span class="st"> </span><span class="ot">NA</span></a>
<a class="sourceLine" id="cb21-68" title="68"></a>
<a class="sourceLine" id="cb21-69" title="69">labs &lt;-<span class="st"> </span><span class="kw">names</span>(bctdf_mgm)</a></code></pre></div>
<div id="mgm-estimation" class="section level4">
<h4>mgm estimation</h4>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" title="1"><span class="co"># devtools::install_github(&quot;jmbh/mgm&quot;)</span></a>
<a class="sourceLine" id="cb22-2" title="2"><span class="co"># Restart R for the latest package</span></a>
<a class="sourceLine" id="cb22-3" title="3"><span class="co"># .r.restartR()</span></a>
<a class="sourceLine" id="cb22-4" title="4"></a>
<a class="sourceLine" id="cb22-5" title="5"><span class="co"># mgm wants full data, see package missForest for imputation methods</span></a>
<a class="sourceLine" id="cb22-6" title="6">bctdf_mgm &lt;-<span class="st"> </span>bctdf_mgm <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">na.omit</span>(.)</a>
<a class="sourceLine" id="cb22-7" title="7"><span class="co"># bctdf_mgm %&gt;% names()</span></a>
<a class="sourceLine" id="cb22-8" title="8">mgm_variable_types &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;g&quot;</span>, <span class="st">&quot;g&quot;</span>, <span class="kw">rep</span>(<span class="st">&quot;c&quot;</span>, <span class="dv">15</span>), <span class="st">&quot;g&quot;</span>)</a>
<a class="sourceLine" id="cb22-9" title="9">mgm_variable_levels &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;1&quot;</span>, <span class="st">&quot;1&quot;</span>, <span class="kw">rep</span>(<span class="st">&quot;2&quot;</span>, <span class="dv">15</span>), <span class="st">&quot;1&quot;</span>)</a>
<a class="sourceLine" id="cb22-10" title="10"><span class="co"># data.frame(mgm_variable_types, mgm_variable_levels, names(bctdf_mgm))</span></a>
<a class="sourceLine" id="cb22-11" title="11"></a>
<a class="sourceLine" id="cb22-12" title="12">mgm_obj &lt;-<span class="st"> </span>mgm<span class="op">::</span><span class="kw">mgm</span>(<span class="dt">data =</span> bctdf_mgm,</a>
<a class="sourceLine" id="cb22-13" title="13">  <span class="dt">type =</span> mgm_variable_types,</a>
<a class="sourceLine" id="cb22-14" title="14">  <span class="dt">level =</span> mgm_variable_levels,</a>
<a class="sourceLine" id="cb22-15" title="15">  <span class="dt">lambdaSel =</span> <span class="st">&quot;CV&quot;</span>,</a>
<a class="sourceLine" id="cb22-16" title="16">  <span class="dt">lambdaFolds =</span> <span class="dv">10</span>,</a>
<a class="sourceLine" id="cb22-17" title="17">  <span class="dt">pbar =</span> <span class="ot">FALSE</span>, </a>
<a class="sourceLine" id="cb22-18" title="18">  <span class="dt">binarySign =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb22-19" title="19"><span class="co">## Note that the sign of parameter estimates is stored separately; see ?mgm</span></a>
<a class="sourceLine" id="cb22-20" title="20"></a>
<a class="sourceLine" id="cb22-21" title="21">pred_obj &lt;-<span class="st"> </span><span class="kw">predict</span>(<span class="dt">object =</span> mgm_obj,</a>
<a class="sourceLine" id="cb22-22" title="22">                         <span class="dt">data =</span> bctdf_mgm)</a>
<a class="sourceLine" id="cb22-23" title="23"></a>
<a class="sourceLine" id="cb22-24" title="24">pred_obj<span class="op">$</span>errors</a></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Variable"],"name":[1],"type":["chr"],"align":["left"]},{"label":["RMSE"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["R2"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["CC"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["nCC"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["CCmarg"],"name":[6],"type":["dbl"],"align":["right"]}],"data":[{"1":"MVPA questionnaire","2":"0.839","3":"0.295","4":"NA","5":"NA","6":"NA","_rn_":"1"},{"1":"MVPA accelerometer","2":"0.954","3":"0.089","4":"NA","5":"NA","6":"NA","_rn_":"2"},{"1":"goal setting","2":"NA","3":"NA","4":"0.908","5":"0.593","6":"0.774","_rn_":"3"},{"1":"own plan","2":"NA","3":"NA","4":"0.893","5":"0.644","6":"0.699","_rn_":"4"},{"1":"plan by other","2":"NA","3":"NA","4":"0.784","5":"0.526","6":"0.544","_rn_":"5"},{"1":"reminder of plan","2":"NA","3":"NA","4":"0.834","5":"0.638","6":"0.541","_rn_":"6"},{"1":"subgoals","2":"NA","3":"NA","4":"0.851","5":"0.618","6":"0.610","_rn_":"7"},{"1":"trying new PA","2":"NA","3":"NA","4":"0.840","5":"0.401","6":"0.733","_rn_":"8"},{"1":"remind of PA benefits","2":"NA","3":"NA","4":"0.894","5":"0.224","6":"0.863","_rn_":"9"},{"1":"goal review","2":"NA","3":"NA","4":"0.804","5":"0.597","6":"0.514","_rn_":"10"},{"1":"personal relevance reflection","2":"NA","3":"NA","4":"0.885","5":"0.500","6":"0.770","_rn_":"11"},{"1":"environmental changes (home)","2":"NA","3":"NA","4":"0.736","5":"0.381","6":"0.574","_rn_":"12"},{"1":"social support","2":"NA","3":"NA","4":"0.752","5":"0.497","6":"0.507","_rn_":"13"},{"1":"controlled motivation","2":"NA","3":"NA","4":"0.883","5":"0.000","6":"0.883","_rn_":"14"},{"1":"barriers identified or planned for","2":"NA","3":"NA","4":"0.889","5":"0.448","6":"0.799","_rn_":"15"},{"1":"identity, life values","2":"NA","3":"NA","4":"0.933","5":"0.484","6":"0.870","_rn_":"16"},{"1":"monitoring PA","2":"NA","3":"NA","4":"0.748","5":"0.414","6":"0.570","_rn_":"17"},{"1":"autonomous motivation","2":"0.776","3":"0.397","4":"NA","5":"NA","6":"NA","_rn_":"18"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" title="1"></a>
<a class="sourceLine" id="cb23-2" title="2"><span class="co"># Take R2 from gaussian, CC from categorical variables </span></a>
<a class="sourceLine" id="cb23-3" title="3">pie_errors &lt;-<span class="st"> </span><span class="kw">c</span>(pred_obj<span class="op">$</span>errors[<span class="dv">1</span>, <span class="dv">3</span>],</a>
<a class="sourceLine" id="cb23-4" title="4">                pred_obj<span class="op">$</span>errors[<span class="dv">2</span>, <span class="dv">3</span>],</a>
<a class="sourceLine" id="cb23-5" title="5">                pred_obj<span class="op">$</span>errors[<span class="dv">3</span><span class="op">:</span><span class="dv">17</span>, <span class="dv">4</span>],</a>
<a class="sourceLine" id="cb23-6" title="6">                pred_obj<span class="op">$</span>errors[<span class="dv">18</span>, <span class="dv">3</span>])</a></code></pre></div>
</div>
<div id="mgm-plotting" class="section level4">
<h4>mgm plotting</h4>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" title="1"><span class="co"># Coloring nodes: make a sequence of colors from the viridis palette. We need three colors (MVPA, BCTs, motivation), and &quot;begin&quot; from ones that are not too dark, so that black text shows up ok.</span></a>
<a class="sourceLine" id="cb24-2" title="2"></a>
<a class="sourceLine" id="cb24-3" title="3">node_colors &lt;-<span class="st"> </span><span class="kw">c</span>(viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">3</span>, <span class="dt">begin =</span> <span class="fl">0.4</span>, <span class="dt">end =</span> <span class="fl">0.99</span>)[<span class="dv">1</span>], <span class="co"># Color 1 for MVPA (questionnaire)</span></a>
<a class="sourceLine" id="cb24-4" title="4">                 viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">3</span>, <span class="dt">begin =</span> <span class="fl">0.4</span>, <span class="dt">end =</span> <span class="fl">0.99</span>)[<span class="dv">1</span>], <span class="co"># Color 1 for MVPA (accelerometer)</span></a>
<a class="sourceLine" id="cb24-5" title="5">                 <span class="kw">rep</span>(viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">3</span>, <span class="dt">begin =</span> <span class="fl">0.4</span>, <span class="dt">end =</span> <span class="fl">0.99</span>)[<span class="dv">2</span>], <span class="dv">11</span>), <span class="co"># 11x Color 2 for BCTs</span></a>
<a class="sourceLine" id="cb24-6" title="6">                 <span class="kw">rep</span>(viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">3</span>, <span class="dt">begin =</span> <span class="fl">0.4</span>, <span class="dt">end =</span> <span class="fl">0.99</span>)[<span class="dv">3</span>], <span class="dv">1</span>), <span class="co"># Color 3 for motivation (controlled)  </span></a>
<a class="sourceLine" id="cb24-7" title="7">                 <span class="kw">rep</span>(viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">3</span>, <span class="dt">begin =</span> <span class="fl">0.4</span>, <span class="dt">end =</span> <span class="fl">0.99</span>)[<span class="dv">2</span>], <span class="dv">3</span>), <span class="co"># 3x Color 2 for BCTs</span></a>
<a class="sourceLine" id="cb24-8" title="8">                 viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">3</span>, <span class="dt">begin =</span> <span class="fl">0.4</span>, <span class="dt">end =</span> <span class="fl">0.99</span>)[<span class="dv">3</span>]) <span class="co"># Color 3 for motivation (autonomous) </span></a>
<a class="sourceLine" id="cb24-9" title="9"></a>
<a class="sourceLine" id="cb24-10" title="10">BCT_mgm &lt;-<span class="st"> </span>qgraph<span class="op">::</span><span class="kw">qgraph</span>(mgm_obj<span class="op">$</span>pairwise<span class="op">$</span>wadj, </a>
<a class="sourceLine" id="cb24-11" title="11">            <span class="dt">layout =</span> <span class="st">&quot;spring&quot;</span>,</a>
<a class="sourceLine" id="cb24-12" title="12">            <span class="dt">repulsion =</span> <span class="fl">0.9999</span>, <span class="co"># To nudge the network from originally bad visual state</span></a>
<a class="sourceLine" id="cb24-13" title="13">            <span class="dt">title =</span> <span class="st">&quot;Mixed graphical model: PA, BCTs &amp; motivation&quot;</span>,</a>
<a class="sourceLine" id="cb24-14" title="14">            <span class="dt">edge.color =</span> <span class="kw">ifelse</span>(mgm_obj<span class="op">$</span>pairwise<span class="op">$</span>edgecolor <span class="op">==</span><span class="st"> &quot;darkgreen&quot;</span>, <span class="st">&quot;blue&quot;</span>, mgm_obj<span class="op">$</span>pairwise<span class="op">$</span>edgecolor),</a>
<a class="sourceLine" id="cb24-15" title="15">            <span class="dt">pie =</span> pie_errors,</a>
<a class="sourceLine" id="cb24-16" title="16">            <span class="dt">pieColor =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">5</span>, <span class="dt">begin =</span> <span class="fl">0.3</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">5</span>],</a>
<a class="sourceLine" id="cb24-17" title="17">            <span class="dt">color =</span> node_colors,</a>
<a class="sourceLine" id="cb24-18" title="18">            <span class="dt">labels =</span> <span class="kw">names</span>(bctdf_mgm),</a>
<a class="sourceLine" id="cb24-19" title="19">            <span class="dt">label.cex =</span> <span class="fl">0.75</span>,</a>
<a class="sourceLine" id="cb24-20" title="20">            <span class="dt">label.scale =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<p><img src="baseline-networks_files/figure-html/allBctsMotiSurveyPA-mgm-plot-1.png" width="2100" /></p>
</div>
<div id="ggm-estimation-plotting" class="section level3">
<h3>ggm estimation &amp; plotting</h3>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" title="1"></a>
<a class="sourceLine" id="cb25-2" title="2">bctdf_ggm &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(</a>
<a class="sourceLine" id="cb25-3" title="3"><span class="co">#  id,</span></a>
<a class="sourceLine" id="cb25-4" title="4"><span class="co">#  intervention,</span></a>
<a class="sourceLine" id="cb25-5" title="5"><span class="co">#  group,</span></a>
<a class="sourceLine" id="cb25-6" title="6"><span class="co">#  school,</span></a>
<a class="sourceLine" id="cb25-7" title="7"><span class="co">#  girl,</span></a>
<a class="sourceLine" id="cb25-8" title="8">  <span class="st">&#39;goal setting&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">01</span>_T1,</a>
<a class="sourceLine" id="cb25-9" title="9">  <span class="st">&#39;own plan&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">02</span>_T1,</a>
<a class="sourceLine" id="cb25-10" title="10">  <span class="st">&#39;plan by other&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">03</span>_T1,</a>
<a class="sourceLine" id="cb25-11" title="11">  <span class="st">&#39;reminder of plan&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">04</span>_T1,</a>
<a class="sourceLine" id="cb25-12" title="12">  <span class="st">&#39;subgoals&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">05</span>_T1,</a>
<a class="sourceLine" id="cb25-13" title="13">  <span class="st">&#39;trying new PA&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">06</span>_T1,</a>
<a class="sourceLine" id="cb25-14" title="14">  <span class="st">&#39;barrier identification&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">07</span>_T1,</a>
<a class="sourceLine" id="cb25-15" title="15">  <span class="st">&#39;problem solving&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">08</span>_T1,</a>
<a class="sourceLine" id="cb25-16" title="16">  <span class="st">&#39;PA identity reflection&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">09</span>_T1,</a>
<a class="sourceLine" id="cb25-17" title="17">  <span class="st">&#39;aligning PA with life values&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">10</span>_T1,</a>
<a class="sourceLine" id="cb25-18" title="18">  <span class="st">&#39;remind of PA benefits&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">01</span>_T1,</a>
<a class="sourceLine" id="cb25-19" title="19">  <span class="st">&#39;self-monitor (paper)&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">02</span>_T1,</a>
<a class="sourceLine" id="cb25-20" title="20">  <span class="st">&#39;self-monitor (app)&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">03</span>_T1,</a>
<a class="sourceLine" id="cb25-21" title="21"><span class="co">#  &#39;memory cues&#39; = PA_frequencyDependentBCT_04_T1,</span></a>
<a class="sourceLine" id="cb25-22" title="22">  <span class="st">&#39;goal review&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">05</span>_T1,</a>
<a class="sourceLine" id="cb25-23" title="23">  <span class="st">&#39;personal relevance reflection&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">06</span>_T1,</a>
<a class="sourceLine" id="cb25-24" title="24">  <span class="st">&#39;environmental changes (home)&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">07</span>_T1,</a>
<a class="sourceLine" id="cb25-25" title="25">  <span class="st">&#39;social support&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">08</span>_T1,</a>
<a class="sourceLine" id="cb25-26" title="26">  <span class="st">&#39;failure contemplated&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">09</span>_T1,</a>
<a class="sourceLine" id="cb25-27" title="27">  <span class="st">&#39;MVPA questionnaire&#39;</span> =<span class="st"> </span>padaysLastweek_T1,</a>
<a class="sourceLine" id="cb25-28" title="28">  <span class="st">&#39;MVPA accelerometer&#39;</span> =<span class="st"> </span>mvpaAccelerometer_T1,</a>
<a class="sourceLine" id="cb25-29" title="29">  <span class="st">&#39;intrinsic&#39;</span> =<span class="st"> </span>PA_intrinsic_T1,</a>
<a class="sourceLine" id="cb25-30" title="30">  <span class="st">&#39;identified&#39;</span> =<span class="st"> </span>PA_identified_T1,</a>
<a class="sourceLine" id="cb25-31" title="31">  <span class="st">&#39;controlled motivation&#39;</span> =<span class="st"> </span>PA_controlled_T1) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb25-32" title="32"><span class="st"> </span><span class="kw">rowwise</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb25-33" title="33"><span class="st"> </span><span class="kw">mutate</span>(</a>
<a class="sourceLine" id="cb25-34" title="34"><span class="co">#  &#39;has plan&#39; = mean(c(`own plan`, `plan by other`), na.rm = TRUE),</span></a>
<a class="sourceLine" id="cb25-35" title="35">  <span class="st">&#39;barriers identified or planned for&#39;</span> =<span class="st"> </span><span class="kw">mean</span>(<span class="kw">c</span>(<span class="st">`</span><span class="dt">problem solving</span><span class="st">`</span>, <span class="st">`</span><span class="dt">barrier identification</span><span class="st">`</span>), <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb25-36" title="36">  <span class="st">&#39;identity, life values&#39;</span> =<span class="st"> </span><span class="kw">mean</span>(<span class="kw">c</span>(<span class="st">`</span><span class="dt">PA identity reflection</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="st">`</span><span class="dt">aligning PA with life values</span><span class="st">`</span>), <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb25-37" title="37">  <span class="st">&#39;monitoring PA&#39;</span> =<span class="st"> </span><span class="kw">mean</span>(<span class="kw">c</span>(<span class="st">`</span><span class="dt">self-monitor (paper)</span><span class="st">`</span>, <span class="st">`</span><span class="dt">self-monitor (app)</span><span class="st">`</span>), <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb25-38" title="38">  <span class="st">&#39;autonomous motivation&#39;</span> =<span class="st"> </span><span class="kw">mean</span>(<span class="kw">c</span>(identified, intrinsic), <span class="dt">na.rm =</span> T)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb25-39" title="39"><span class="co">#  &#39;girl&#39; = ifelse(girl == &quot;girl&quot;, 1, 0),</span></a>
<a class="sourceLine" id="cb25-40" title="40"><span class="co">#  &#39;intervention&#39; = ifelse(intervention == &quot;1&quot;, 1, 0)) %&gt;% </span></a>
<a class="sourceLine" id="cb25-41" title="41"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span><span class="st">`</span><span class="dt">self-monitor (paper)</span><span class="st">`</span>, <span class="op">-</span><span class="st">`</span><span class="dt">self-monitor (app)</span><span class="st">`</span>, </a>
<a class="sourceLine" id="cb25-42" title="42"><span class="co">#                -`plan by other`, -`own plan`,</span></a>
<a class="sourceLine" id="cb25-43" title="43">                <span class="op">-</span>identified, <span class="op">-</span>intrinsic,</a>
<a class="sourceLine" id="cb25-44" title="44">         <span class="op">-</span><span class="st">`</span><span class="dt">failure contemplated</span><span class="st">`</span>, <span class="co"># only concerns those who haven&#39;t reached goals</span></a>
<a class="sourceLine" id="cb25-45" title="45">         <span class="op">-</span><span class="st">`</span><span class="dt">barrier identification</span><span class="st">`</span>, <span class="op">-</span><span class="st">`</span><span class="dt">problem solving</span><span class="st">`</span>, <span class="co"># closely related</span></a>
<a class="sourceLine" id="cb25-46" title="46">         <span class="op">-</span><span class="st">`</span><span class="dt">PA identity reflection</span><span class="st">`</span>, <span class="op">-</span><span class="st">`</span><span class="dt">aligning PA with life values</span><span class="st">`</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># closely related</span></a>
<a class="sourceLine" id="cb25-47" title="47"><span class="co">#  dplyr::select(-controlled) %&gt;% # Not really gaussian at all </span></a>
<a class="sourceLine" id="cb25-48" title="48"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="st">&quot;MVPA questionnaire&quot;</span>, <span class="st">&quot;MVPA accelerometer&quot;</span>, <span class="st">&quot;autonomous motivation&quot;</span>, <span class="st">&quot;controlled motivation&quot;</span>, <span class="kw">everything</span>()) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb25-49" title="49"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate_all</span>(as.numeric)</a>
<a class="sourceLine" id="cb25-50" title="50"></a>
<a class="sourceLine" id="cb25-51" title="51"><span class="co"># Network for all participants</span></a>
<a class="sourceLine" id="cb25-52" title="52">S.total_ggm &lt;-<span class="st"> </span>bctdf_ggm</a>
<a class="sourceLine" id="cb25-53" title="53">nwBCT_ggm &lt;-<span class="st"> </span>bootnet<span class="op">::</span><span class="kw">estimateNetwork</span>(S.total_ggm, <span class="dt">default=</span><span class="st">&quot;EBICglasso&quot;</span>)</a>
<a class="sourceLine" id="cb25-54" title="54"></a>
<a class="sourceLine" id="cb25-55" title="55">labs_ggm &lt;-<span class="st"> </span><span class="kw">colnames</span>(S.total_ggm)</a>
<a class="sourceLine" id="cb25-56" title="56"></a>
<a class="sourceLine" id="cb25-57" title="57"><span class="co"># Create means for filling nodes</span></a>
<a class="sourceLine" id="cb25-58" title="58">piefill_ggm &lt;-<span class="st"> </span>S.total_ggm <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb25-59" title="59"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span><span class="kw">contains</span>(<span class="st">&quot;MVPA&quot;</span>), <span class="op">-</span><span class="kw">contains</span>(<span class="st">&quot;motivation&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>data.frame <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb25-60" title="60"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">summarise_all</span>(<span class="kw">funs</span>(<span class="kw">mean</span>(., <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">/</span><span class="dv">6</span>))</a>
<a class="sourceLine" id="cb25-61" title="61"></a>
<a class="sourceLine" id="cb25-62" title="62">piefill_ggm<span class="op">$</span><span class="st">`</span><span class="dt">MVPA accelerometer</span><span class="st">`</span> &lt;-<span class="st"> </span><span class="kw">median</span>(S.total_ggm<span class="op">$</span><span class="st">`</span><span class="dt">MVPA accelerometer</span><span class="st">`</span>, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">/</span><span class="st"> </span>(<span class="dv">60</span> <span class="op">*</span><span class="st"> </span><span class="dv">24</span>)</a>
<a class="sourceLine" id="cb25-63" title="63">piefill_ggm<span class="op">$</span><span class="st">`</span><span class="dt">MVPA questionnaire</span><span class="st">`</span> &lt;-<span class="st"> </span><span class="kw">median</span>(S.total_ggm<span class="op">$</span><span class="st">`</span><span class="dt">MVPA questionnaire</span><span class="st">`</span>, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">/</span><span class="st"> </span><span class="dv">7</span></a>
<a class="sourceLine" id="cb25-64" title="64">piefill_ggm<span class="op">$</span>autonomous &lt;-<span class="st"> </span><span class="kw">median</span>(S.total_ggm<span class="op">$</span><span class="st">`</span><span class="dt">autonomous motivation</span><span class="st">`</span>, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">/</span><span class="st"> </span><span class="dv">5</span></a>
<a class="sourceLine" id="cb25-65" title="65">piefill_ggm<span class="op">$</span>controlled &lt;-<span class="st"> </span><span class="kw">median</span>(S.total_ggm<span class="op">$</span><span class="st">`</span><span class="dt">controlled motivation</span><span class="st">`</span>, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">/</span><span class="st"> </span><span class="dv">5</span></a>
<a class="sourceLine" id="cb25-66" title="66">  </a>
<a class="sourceLine" id="cb25-67" title="67">piefill_ggm &lt;-<span class="st"> </span>piefill_ggm <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb25-68" title="68"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="st">&quot;MVPA questionnaire&quot;</span>, <span class="st">&quot;MVPA accelerometer&quot;</span>, autonomous, controlled, <span class="kw">everything</span>())</a>
<a class="sourceLine" id="cb25-69" title="69"></a>
<a class="sourceLine" id="cb25-70" title="70"><span class="co"># Plot network</span></a>
<a class="sourceLine" id="cb25-71" title="71"></a>
<a class="sourceLine" id="cb25-72" title="72">BCT_ggm &lt;-<span class="st"> </span><span class="kw">plot</span>(nwBCT_ggm, </a>
<a class="sourceLine" id="cb25-73" title="73">                <span class="dt">layout =</span> <span class="st">&quot;spring&quot;</span>, </a>
<a class="sourceLine" id="cb25-74" title="74">                <span class="dt">repulsion =</span> <span class="fl">0.99</span>, <span class="co"># To nudge the network from originally bad visual state</span></a>
<a class="sourceLine" id="cb25-75" title="75">                <span class="dt">label.scale =</span> <span class="ot">FALSE</span>, </a>
<a class="sourceLine" id="cb25-76" title="76">                <span class="dt">title =</span> <span class="st">&quot;GGM: MVPA, BCTs &amp; motivation&quot;</span>, </a>
<a class="sourceLine" id="cb25-77" title="77">                <span class="dt">label.cex =</span> <span class="fl">0.75</span>,</a>
<a class="sourceLine" id="cb25-78" title="78">                <span class="dt">pie =</span> piefill_ggm,</a>
<a class="sourceLine" id="cb25-79" title="79">                <span class="dt">color =</span> <span class="st">&quot;skyblue&quot;</span>,</a>
<a class="sourceLine" id="cb25-80" title="80">                <span class="dt">pieBorder =</span> <span class="dv">1</span>)</a></code></pre></div>
<p><img src="baseline-networks_files/figure-html/allBctsMotiSurveyPA-ggm-1.png" width="2100" /></p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" title="1"></a>
<a class="sourceLine" id="cb26-2" title="2"></a>
<a class="sourceLine" id="cb26-3" title="3">qgraph<span class="op">::</span><span class="kw">flow</span>(BCT_ggm, <span class="st">&quot;MVPA accelerometer&quot;</span>, <span class="dt">theme =</span> <span class="st">&quot;colorblind&quot;</span>, <span class="dt">vsize =</span> <span class="dv">8</span>)</a></code></pre></div>
<p><img src="baseline-networks_files/figure-html/allBctsMotiSurveyPA-ggm-2.png" width="2100" /></p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" title="1">qgraph<span class="op">::</span><span class="kw">flow</span>(BCT_ggm, <span class="st">&quot;MVPA questionnaire&quot;</span>, <span class="dt">theme =</span> <span class="st">&quot;colorblind&quot;</span>, <span class="dt">vsize =</span> <span class="dv">8</span>)</a></code></pre></div>
<p><img src="baseline-networks_files/figure-html/allBctsMotiSurveyPA-ggm-3.png" width="2100" /></p>
</div>
<div id="centrality-and-stability" class="section level3">
<h3>Centrality and stability</h3>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" title="1"></a>
<a class="sourceLine" id="cb28-2" title="2">allBctsMotiSurveyPA &lt;-<span class="st"> </span>nwBCT_ggm</a>
<a class="sourceLine" id="cb28-3" title="3"></a>
<a class="sourceLine" id="cb28-4" title="4">allBctsMotiSurveyPA_centralityPlot &lt;-<span class="st"> </span>qgraph<span class="op">::</span><span class="kw">centralityPlot</span>(allBctsMotiSurveyPA)</a></code></pre></div>
<p><img src="baseline-networks_files/figure-html/allBctsMotiSurveyPA-ggm-stability-1.png" width="2100" /></p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" title="1"></a>
<a class="sourceLine" id="cb29-2" title="2">qgraph<span class="op">::</span><span class="kw">centrality</span>(allBctsMotiSurveyPA)<span class="op">$</span>InDegree <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb29-3" title="3"><span class="st">  </span><span class="kw">data.frame</span>(<span class="st">&quot;Node&quot;</span> =<span class="st"> </span><span class="kw">names</span>(.), <span class="st">&quot;Strength&quot;</span> =<span class="st"> </span>.) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb29-4" title="4"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">arrange</span>(<span class="kw">desc</span>(Strength)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb29-5" title="5"><span class="st">  </span>papaja<span class="op">::</span><span class="kw">apa_table</span>()</a>
<a class="sourceLine" id="cb29-6" title="6"><span class="co">## &lt;caption&gt;(\#tab:allBctsMotiSurveyPA-ggm-stability)&lt;/caption&gt;</span></a>
<a class="sourceLine" id="cb29-7" title="7"><span class="co">## </span></a>
<a class="sourceLine" id="cb29-8" title="8"><span class="co">## &lt;caption&gt;**&lt;/caption&gt;</span></a>
<a class="sourceLine" id="cb29-9" title="9"><span class="co">## </span></a>
<a class="sourceLine" id="cb29-10" title="10"><span class="co">## </span></a>
<a class="sourceLine" id="cb29-11" title="11"><span class="co">## </span></a>
<a class="sourceLine" id="cb29-12" title="12"><span class="co">## Node                                 Strength </span></a>
<a class="sourceLine" id="cb29-13" title="13"><span class="co">## -----------------------------------  ---------</span></a>
<a class="sourceLine" id="cb29-14" title="14"><span class="co">## personal relevance reflection        1.27     </span></a>
<a class="sourceLine" id="cb29-15" title="15"><span class="co">## reminder of plan                     1.26     </span></a>
<a class="sourceLine" id="cb29-16" title="16"><span class="co">## goal setting                         1.20     </span></a>
<a class="sourceLine" id="cb29-17" title="17"><span class="co">## goal review                          1.18     </span></a>
<a class="sourceLine" id="cb29-18" title="18"><span class="co">## own plan                             1.15     </span></a>
<a class="sourceLine" id="cb29-19" title="19"><span class="co">## environmental changes (home)         1.11     </span></a>
<a class="sourceLine" id="cb29-20" title="20"><span class="co">## subgoals                             1.07     </span></a>
<a class="sourceLine" id="cb29-21" title="21"><span class="co">## autonomous motivation                1.00     </span></a>
<a class="sourceLine" id="cb29-22" title="22"><span class="co">## barriers identified or planned for   0.99     </span></a>
<a class="sourceLine" id="cb29-23" title="23"><span class="co">## trying new PA                        0.91     </span></a>
<a class="sourceLine" id="cb29-24" title="24"><span class="co">## social support                       0.91     </span></a>
<a class="sourceLine" id="cb29-25" title="25"><span class="co">## identity, life values                0.91     </span></a>
<a class="sourceLine" id="cb29-26" title="26"><span class="co">## plan by other                        0.86     </span></a>
<a class="sourceLine" id="cb29-27" title="27"><span class="co">## remind of PA benefits                0.85     </span></a>
<a class="sourceLine" id="cb29-28" title="28"><span class="co">## monitoring PA                        0.77     </span></a>
<a class="sourceLine" id="cb29-29" title="29"><span class="co">## MVPA questionnaire                   0.73     </span></a>
<a class="sourceLine" id="cb29-30" title="30"><span class="co">## MVPA accelerometer                   0.43     </span></a>
<a class="sourceLine" id="cb29-31" title="31"><span class="co">## controlled motivation                0.33</span></a>
<a class="sourceLine" id="cb29-32" title="32"></a>
<a class="sourceLine" id="cb29-33" title="33"><span class="kw">scale</span>(qgraph<span class="op">::</span><span class="kw">centrality</span>(allBctsMotiSurveyPA)<span class="op">$</span>InDegree) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb29-34" title="34"><span class="st">  </span><span class="kw">data.frame</span>(<span class="dt">Node =</span> <span class="kw">labels</span>(.), <span class="st">`</span><span class="dt">Standardised strength</span><span class="st">`</span> =<span class="st"> </span>.) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb29-35" title="35"><span class="st">  </span>plyr<span class="op">::</span><span class="kw">arrange</span>(<span class="kw">desc</span>(<span class="st">`</span><span class="dt">Standardised.strength</span><span class="st">`</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb29-36" title="36"><span class="st">  </span>papaja<span class="op">::</span><span class="kw">apa_table</span>()</a>
<a class="sourceLine" id="cb29-37" title="37"><span class="co">## &lt;caption&gt;(\#tab:allBctsMotiSurveyPA-ggm-stability)&lt;/caption&gt;</span></a>
<a class="sourceLine" id="cb29-38" title="38"><span class="co">## </span></a>
<a class="sourceLine" id="cb29-39" title="39"><span class="co">## &lt;caption&gt;**&lt;/caption&gt;</span></a>
<a class="sourceLine" id="cb29-40" title="40"><span class="co">## </span></a>
<a class="sourceLine" id="cb29-41" title="41"><span class="co">## </span></a>
<a class="sourceLine" id="cb29-42" title="42"><span class="co">## </span></a>
<a class="sourceLine" id="cb29-43" title="43"><span class="co">## Node.c..MVPA.questionnaire....MVPA.accelerometer....autonomous.motivation...   Node..1.   Standardised.strength </span></a>
<a class="sourceLine" id="cb29-44" title="44"><span class="co">## -----------------------------------------------------------------------------  ---------  ----------------------</span></a>
<a class="sourceLine" id="cb29-45" title="45"><span class="co">## personal relevance reflection                                                  1          1.25                  </span></a>
<a class="sourceLine" id="cb29-46" title="46"><span class="co">## reminder of plan                                                               1          1.23                  </span></a>
<a class="sourceLine" id="cb29-47" title="47"><span class="co">## goal setting                                                                   1          1.00                  </span></a>
<a class="sourceLine" id="cb29-48" title="48"><span class="co">## goal review                                                                    1          0.91                  </span></a>
<a class="sourceLine" id="cb29-49" title="49"><span class="co">## own plan                                                                       1          0.81                  </span></a>
<a class="sourceLine" id="cb29-50" title="50"><span class="co">## environmental changes (home)                                                   1          0.65                  </span></a>
<a class="sourceLine" id="cb29-51" title="51"><span class="co">## subgoals                                                                       1          0.48                  </span></a>
<a class="sourceLine" id="cb29-52" title="52"><span class="co">## autonomous motivation                                                          1          0.24                  </span></a>
<a class="sourceLine" id="cb29-53" title="53"><span class="co">## barriers identified or planned for                                             1          0.20                  </span></a>
<a class="sourceLine" id="cb29-54" title="54"><span class="co">## trying new PA                                                                  1          -0.10                 </span></a>
<a class="sourceLine" id="cb29-55" title="55"><span class="co">## social support                                                                 1          -0.12                 </span></a>
<a class="sourceLine" id="cb29-56" title="56"><span class="co">## identity, life values                                                          1          -0.13                 </span></a>
<a class="sourceLine" id="cb29-57" title="57"><span class="co">## plan by other                                                                  1          -0.31                 </span></a>
<a class="sourceLine" id="cb29-58" title="58"><span class="co">## remind of PA benefits                                                          1          -0.35                 </span></a>
<a class="sourceLine" id="cb29-59" title="59"><span class="co">## monitoring PA                                                                  1          -0.66                 </span></a>
<a class="sourceLine" id="cb29-60" title="60"><span class="co">## MVPA questionnaire                                                             1          -0.81                 </span></a>
<a class="sourceLine" id="cb29-61" title="61"><span class="co">## MVPA accelerometer                                                             1          -1.96                 </span></a>
<a class="sourceLine" id="cb29-62" title="62"><span class="co">## controlled motivation                                                          1          -2.35</span></a>
<a class="sourceLine" id="cb29-63" title="63">  </a>
<a class="sourceLine" id="cb29-64" title="64">qgraph<span class="op">::</span><span class="kw">centrality</span>(allBctsMotiSurveyPA)<span class="op">$</span>Closeness <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">Closeness =</span> .) <span class="op">%&gt;%</span><span class="st"> </span>papaja<span class="op">::</span><span class="kw">apa_table</span>()</a>
<a class="sourceLine" id="cb29-65" title="65"><span class="co">## &lt;caption&gt;(\#tab:allBctsMotiSurveyPA-ggm-stability)&lt;/caption&gt;</span></a>
<a class="sourceLine" id="cb29-66" title="66"><span class="co">## </span></a>
<a class="sourceLine" id="cb29-67" title="67"><span class="co">## &lt;caption&gt;**&lt;/caption&gt;</span></a>
<a class="sourceLine" id="cb29-68" title="68"><span class="co">## </span></a>
<a class="sourceLine" id="cb29-69" title="69"><span class="co">## </span></a>
<a class="sourceLine" id="cb29-70" title="70"><span class="co">## </span></a>
<a class="sourceLine" id="cb29-71" title="71"><span class="co">##                                      Closeness </span></a>
<a class="sourceLine" id="cb29-72" title="72"><span class="co">## -----------------------------------  ----------</span></a>
<a class="sourceLine" id="cb29-73" title="73"><span class="co">## MVPA questionnaire                   0.00      </span></a>
<a class="sourceLine" id="cb29-74" title="74"><span class="co">## MVPA accelerometer                   0.00      </span></a>
<a class="sourceLine" id="cb29-75" title="75"><span class="co">## autonomous motivation                0.00      </span></a>
<a class="sourceLine" id="cb29-76" title="76"><span class="co">## controlled motivation                0.00      </span></a>
<a class="sourceLine" id="cb29-77" title="77"><span class="co">## goal setting                         0.00      </span></a>
<a class="sourceLine" id="cb29-78" title="78"><span class="co">## own plan                             0.00      </span></a>
<a class="sourceLine" id="cb29-79" title="79"><span class="co">## plan by other                        0.00      </span></a>
<a class="sourceLine" id="cb29-80" title="80"><span class="co">## reminder of plan                     0.01      </span></a>
<a class="sourceLine" id="cb29-81" title="81"><span class="co">## subgoals                             0.00      </span></a>
<a class="sourceLine" id="cb29-82" title="82"><span class="co">## trying new PA                        0.00      </span></a>
<a class="sourceLine" id="cb29-83" title="83"><span class="co">## remind of PA benefits                0.00      </span></a>
<a class="sourceLine" id="cb29-84" title="84"><span class="co">## goal review                          0.01      </span></a>
<a class="sourceLine" id="cb29-85" title="85"><span class="co">## personal relevance reflection        0.01      </span></a>
<a class="sourceLine" id="cb29-86" title="86"><span class="co">## environmental changes (home)         0.00      </span></a>
<a class="sourceLine" id="cb29-87" title="87"><span class="co">## social support                       0.00      </span></a>
<a class="sourceLine" id="cb29-88" title="88"><span class="co">## barriers identified or planned for   0.00      </span></a>
<a class="sourceLine" id="cb29-89" title="89"><span class="co">## identity, life values                0.00      </span></a>
<a class="sourceLine" id="cb29-90" title="90"><span class="co">## monitoring PA                        0.01</span></a>
<a class="sourceLine" id="cb29-91" title="91"></a>
<a class="sourceLine" id="cb29-92" title="92">qgraph<span class="op">::</span><span class="kw">centrality</span>(allBctsMotiSurveyPA)<span class="op">$</span>Betweenness <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">names</span>(.), .) <span class="op">%&gt;%</span><span class="st"> </span>papaja<span class="op">::</span><span class="kw">apa_table</span>()</a>
<a class="sourceLine" id="cb29-93" title="93"><span class="co">## &lt;caption&gt;(\#tab:allBctsMotiSurveyPA-ggm-stability)&lt;/caption&gt;</span></a>
<a class="sourceLine" id="cb29-94" title="94"><span class="co">## </span></a>
<a class="sourceLine" id="cb29-95" title="95"><span class="co">## &lt;caption&gt;**&lt;/caption&gt;</span></a>
<a class="sourceLine" id="cb29-96" title="96"><span class="co">## </span></a>
<a class="sourceLine" id="cb29-97" title="97"><span class="co">## </span></a>
<a class="sourceLine" id="cb29-98" title="98"><span class="co">## </span></a>
<a class="sourceLine" id="cb29-99" title="99"><span class="co">##                                      names...                             .     </span></a>
<a class="sourceLine" id="cb29-100" title="100"><span class="co">## -----------------------------------  -----------------------------------  ------</span></a>
<a class="sourceLine" id="cb29-101" title="101"><span class="co">## MVPA questionnaire                   MVPA questionnaire                   32.00 </span></a>
<a class="sourceLine" id="cb29-102" title="102"><span class="co">## MVPA accelerometer                   MVPA accelerometer                   0.00  </span></a>
<a class="sourceLine" id="cb29-103" title="103"><span class="co">## autonomous motivation                autonomous motivation                34.00 </span></a>
<a class="sourceLine" id="cb29-104" title="104"><span class="co">## controlled motivation                controlled motivation                0.00  </span></a>
<a class="sourceLine" id="cb29-105" title="105"><span class="co">## goal setting                         goal setting                         12.00 </span></a>
<a class="sourceLine" id="cb29-106" title="106"><span class="co">## own plan                             own plan                             16.00 </span></a>
<a class="sourceLine" id="cb29-107" title="107"><span class="co">## plan by other                        plan by other                        20.00 </span></a>
<a class="sourceLine" id="cb29-108" title="108"><span class="co">## reminder of plan                     reminder of plan                     52.00 </span></a>
<a class="sourceLine" id="cb29-109" title="109"><span class="co">## subgoals                             subgoals                             24.00 </span></a>
<a class="sourceLine" id="cb29-110" title="110"><span class="co">## trying new PA                        trying new PA                        0.00  </span></a>
<a class="sourceLine" id="cb29-111" title="111"><span class="co">## remind of PA benefits                remind of PA benefits                6.00  </span></a>
<a class="sourceLine" id="cb29-112" title="112"><span class="co">## goal review                          goal review                          22.00 </span></a>
<a class="sourceLine" id="cb29-113" title="113"><span class="co">## personal relevance reflection        personal relevance reflection        54.00 </span></a>
<a class="sourceLine" id="cb29-114" title="114"><span class="co">## environmental changes (home)         environmental changes (home)         24.00 </span></a>
<a class="sourceLine" id="cb29-115" title="115"><span class="co">## social support                       social support                       22.00 </span></a>
<a class="sourceLine" id="cb29-116" title="116"><span class="co">## barriers identified or planned for   barriers identified or planned for   14.00 </span></a>
<a class="sourceLine" id="cb29-117" title="117"><span class="co">## identity, life values                identity, life values                16.00 </span></a>
<a class="sourceLine" id="cb29-118" title="118"><span class="co">## monitoring PA                        monitoring PA                        30.00</span></a>
<a class="sourceLine" id="cb29-119" title="119"></a>
<a class="sourceLine" id="cb29-120" title="120"><span class="kw">cor</span>(qgraph<span class="op">::</span><span class="kw">centrality</span>(allBctsMotiSurveyPA)<span class="op">$</span>InDegree, qgraph<span class="op">::</span><span class="kw">centrality</span>(allBctsMotiSurveyPA)<span class="op">$</span>Betweenness, </a>
<a class="sourceLine" id="cb29-121" title="121">    <span class="dt">method =</span> <span class="st">&quot;spearman&quot;</span>) </a>
<a class="sourceLine" id="cb29-122" title="122"><span class="co">## [1] 0.445368</span></a>
<a class="sourceLine" id="cb29-123" title="123"></a>
<a class="sourceLine" id="cb29-124" title="124"><span class="co"># bootnet_stability_allBctsMotiSurveyPA &lt;- bootnet::bootnet(allBctsMotiSurveyPA, nBoots=1000)</span></a>
<a class="sourceLine" id="cb29-125" title="125"><span class="co"># save(bootnet_stability_allBctsMotiSurveyPA, file = &quot;./Rdata_files/bootnet_stability_allBctsMotiSurveyPA.Rdata&quot;)</span></a>
<a class="sourceLine" id="cb29-126" title="126"><span class="kw">load</span>(<span class="st">&quot;./Rdata_files/bootnet_stability_allBctsMotiSurveyPA.Rdata&quot;</span>)</a>
<a class="sourceLine" id="cb29-127" title="127"></a>
<a class="sourceLine" id="cb29-128" title="128"><span class="kw">plot</span>(bootnet_stability_allBctsMotiSurveyPA, <span class="dt">labels =</span> <span class="ot">FALSE</span>, <span class="dt">order =</span> <span class="st">&quot;sample&quot;</span>) </a></code></pre></div>
<p><img src="baseline-networks_files/figure-html/allBctsMotiSurveyPA-ggm-stability-2.png" width="2100" /></p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" title="1"><span class="kw">plot</span>(bootnet_stability_allBctsMotiSurveyPA, <span class="dt">labels =</span> <span class="ot">FALSE</span>, <span class="st">&quot;edge&quot;</span>, <span class="dt">plot =</span> <span class="st">&quot;difference&quot;</span>, <span class="dt">onlyNonZero =</span> <span class="ot">TRUE</span>, <span class="dt">order =</span> <span class="st">&quot;sample&quot;</span>)</a></code></pre></div>
<p><img src="baseline-networks_files/figure-html/allBctsMotiSurveyPA-ggm-stability-3.png" width="2100" /></p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" title="1"></a>
<a class="sourceLine" id="cb31-2" title="2"><span class="co"># bootnet_centrality_stability_allBctsMotiSurveyPA &lt;- bootnet::bootnet(allBctsMotiSurveyPA, nBoots=1000,nCores=8, type=&quot;case&quot;)</span></a>
<a class="sourceLine" id="cb31-3" title="3"><span class="co"># save(bootnet_centrality_stability_allBctsMotiSurveyPA, file = &quot;./Rdata_files/bootnet_centrality_stability_allBctsMotiSurveyPA.Rdata&quot;)</span></a>
<a class="sourceLine" id="cb31-4" title="4"><span class="kw">load</span>(<span class="st">&quot;./Rdata_files/bootnet_centrality_stability_allBctsMotiSurveyPA.Rdata&quot;</span>)</a>
<a class="sourceLine" id="cb31-5" title="5"></a>
<a class="sourceLine" id="cb31-6" title="6"><span class="kw">plot</span>(bootnet_centrality_stability_allBctsMotiSurveyPA)</a></code></pre></div>
<p><img src="baseline-networks_files/figure-html/allBctsMotiSurveyPA-ggm-stability-4.png" width="2100" /></p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" title="1"><span class="kw">plot</span>(bootnet_centrality_stability_allBctsMotiSurveyPA, <span class="dt">perNode=</span>T, <span class="st">&quot;strength&quot;</span>)</a></code></pre></div>
<p><img src="baseline-networks_files/figure-html/allBctsMotiSurveyPA-ggm-stability-5.png" width="2100" /></p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" title="1"></a>
<a class="sourceLine" id="cb33-2" title="2">bootnet<span class="op">::</span><span class="kw">corStability</span>(bootnet_centrality_stability_allBctsMotiSurveyPA)</a>
<a class="sourceLine" id="cb33-3" title="3"><span class="co">## === Correlation Stability Analysis === </span></a>
<a class="sourceLine" id="cb33-4" title="4"><span class="co">## </span></a>
<a class="sourceLine" id="cb33-5" title="5"><span class="co">## Sampling levels tested:</span></a>
<a class="sourceLine" id="cb33-6" title="6"><span class="co">##    nPerson Drop%   n</span></a>
<a class="sourceLine" id="cb33-7" title="7"><span class="co">## 1      291  75.0 126</span></a>
<a class="sourceLine" id="cb33-8" title="8"><span class="co">## 2      382  67.2  86</span></a>
<a class="sourceLine" id="cb33-9" title="9"><span class="co">## 3      472  59.5  97</span></a>
<a class="sourceLine" id="cb33-10" title="10"><span class="co">## 4      563  51.7  92</span></a>
<a class="sourceLine" id="cb33-11" title="11"><span class="co">## 5      654  43.9  87</span></a>
<a class="sourceLine" id="cb33-12" title="12"><span class="co">## 6      744  36.1 103</span></a>
<a class="sourceLine" id="cb33-13" title="13"><span class="co">## 7      835  28.3 107</span></a>
<a class="sourceLine" id="cb33-14" title="14"><span class="co">## 8      926  20.5  90</span></a>
<a class="sourceLine" id="cb33-15" title="15"><span class="co">## 9     1016  12.8 104</span></a>
<a class="sourceLine" id="cb33-16" title="16"><span class="co">## 10    1107   5.0 108</span></a>
<a class="sourceLine" id="cb33-17" title="17"><span class="co">## </span></a>
<a class="sourceLine" id="cb33-18" title="18"><span class="co">## Maximum drop proportions to retain correlation of 0.7 in at least 95% of the samples:</span></a>
<a class="sourceLine" id="cb33-19" title="19"><span class="co">## </span></a>
<a class="sourceLine" id="cb33-20" title="20"><span class="co">## betweenness: 0.361 </span></a>
<a class="sourceLine" id="cb33-21" title="21"><span class="co">##   - For more accuracy, run bootnet(..., caseMin = 0.283, caseMax = 0.439) </span></a>
<a class="sourceLine" id="cb33-22" title="22"><span class="co">## </span></a>
<a class="sourceLine" id="cb33-23" title="23"><span class="co">## closeness: 0.75 (CS-coefficient is highest level tested)</span></a>
<a class="sourceLine" id="cb33-24" title="24"><span class="co">##   - For more accuracy, run bootnet(..., caseMin = 0.672, caseMax = 1) </span></a>
<a class="sourceLine" id="cb33-25" title="25"><span class="co">## </span></a>
<a class="sourceLine" id="cb33-26" title="26"><span class="co">## edge: 0.75 (CS-coefficient is highest level tested)</span></a>
<a class="sourceLine" id="cb33-27" title="27"><span class="co">##   - For more accuracy, run bootnet(..., caseMin = 0.672, caseMax = 1) </span></a>
<a class="sourceLine" id="cb33-28" title="28"><span class="co">## </span></a>
<a class="sourceLine" id="cb33-29" title="29"><span class="co">## strength: 0.75 (CS-coefficient is highest level tested)</span></a>
<a class="sourceLine" id="cb33-30" title="30"><span class="co">##   - For more accuracy, run bootnet(..., caseMin = 0.672, caseMax = 1) </span></a>
<a class="sourceLine" id="cb33-31" title="31"><span class="co">## </span></a>
<a class="sourceLine" id="cb33-32" title="32"><span class="co">## Accuracy can also be increased by increasing both &#39;nBoots&#39; and &#39;caseN&#39;.</span></a></code></pre></div>
<!-- ## Visually compare ggm and mgm -->
<!-- TODO -->
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" title="1"></a>
<a class="sourceLine" id="cb34-2" title="2">layout_mgm_ggm &lt;-<span class="st"> </span>qgraph<span class="op">::</span><span class="kw">averageLayout</span>(BCT_ggm, BCT_mgm)</a>
<a class="sourceLine" id="cb34-3" title="3"></a>
<a class="sourceLine" id="cb34-4" title="4"><span class="kw">layout</span>(<span class="kw">t</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb34-5" title="5"></a>
<a class="sourceLine" id="cb34-6" title="6"><span class="kw">plot</span>(nwBCT_ggm, <span class="dt">layout =</span> layout_mgm_ggm, <span class="dt">label.scale =</span> <span class="ot">FALSE</span>, <span class="dt">title =</span> <span class="st">&quot;GGM: MVPA, BCTs &amp; motivation&quot;</span>, <span class="dt">label.cex =</span> <span class="fl">0.75</span>,</a>
<a class="sourceLine" id="cb34-7" title="7">     <span class="dt">pie =</span> piefill_ggm,</a>
<a class="sourceLine" id="cb34-8" title="8">     <span class="dt">color =</span> <span class="st">&quot;skyblue&quot;</span>,</a>
<a class="sourceLine" id="cb34-9" title="9">     <span class="dt">pieBorder =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb34-10" title="10"></a>
<a class="sourceLine" id="cb34-11" title="11">qgraph<span class="op">::</span><span class="kw">qgraph</span>(mgm_obj<span class="op">$</span>pairwise<span class="op">$</span>wadj,</a>
<a class="sourceLine" id="cb34-12" title="12">            <span class="dt">layout =</span> layout_mgm_ggm,</a>
<a class="sourceLine" id="cb34-13" title="13">            <span class="dt">title =</span> <span class="st">&quot;MGM: MVPA, BCTs &amp; motivation&quot;</span>,</a>
<a class="sourceLine" id="cb34-14" title="14">            <span class="dt">edge.color =</span> <span class="kw">ifelse</span>(mgm_obj<span class="op">$</span>pairwise<span class="op">$</span>edgecolor <span class="op">==</span><span class="st"> &quot;darkgreen&quot;</span>, <span class="st">&quot;blue&quot;</span>, mgm_obj<span class="op">$</span>pairwise<span class="op">$</span>edgecolor),</a>
<a class="sourceLine" id="cb34-15" title="15">            <span class="dt">pie =</span> pie_errors,</a>
<a class="sourceLine" id="cb34-16" title="16">            <span class="dt">pieColor =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">6</span>, <span class="dt">begin =</span> <span class="fl">0.3</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">6</span>],</a>
<a class="sourceLine" id="cb34-17" title="17">            <span class="dt">color =</span> node_colors,</a>
<a class="sourceLine" id="cb34-18" title="18">            <span class="dt">labels =</span> <span class="kw">names</span>(bctdf_mgm),</a>
<a class="sourceLine" id="cb34-19" title="19">            <span class="dt">label.cex =</span> <span class="fl">0.75</span>,</a>
<a class="sourceLine" id="cb34-20" title="20">            <span class="dt">label.scale =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
</div>
<div id="correlation-and-partial-correlation-networks-visualised" class="section level2">
<h2>Correlation and partial correlation networks visualised</h2>
<p>As we can see, the bivariate correlation network is uninterpretable due to high number of edges.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" title="1"></a>
<a class="sourceLine" id="cb35-2" title="2">corgraph &lt;-<span class="st"> </span>qgraph<span class="op">::</span><span class="kw">qgraph</span>(qgraph<span class="op">::</span><span class="kw">cor_auto</span>(bctdf_ggm), <span class="dt">graph =</span> <span class="st">&quot;cor&quot;</span>,</a>
<a class="sourceLine" id="cb35-3" title="3">                           <span class="dt">repulsion =</span> <span class="fl">0.99</span>,</a>
<a class="sourceLine" id="cb35-4" title="4">       <span class="dt">labels =</span> <span class="kw">names</span>(bctdf_ggm),</a>
<a class="sourceLine" id="cb35-5" title="5">       <span class="dt">edge.labels =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb35-6" title="6">       <span class="dt">edge.label.cex =</span> <span class="fl">0.75</span>,</a>
<a class="sourceLine" id="cb35-7" title="7">       <span class="dt">label.scale =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb35-8" title="8">       <span class="dt">layout =</span> qgraph<span class="op">::</span><span class="kw">averageLayout</span>(BCT_ggm, BCT_mgm), <span class="co"># get the mgm layout </span></a>
<a class="sourceLine" id="cb35-9" title="9">       <span class="dt">title =</span> <span class="st">&quot;bivariate correlation network&quot;</span>,</a>
<a class="sourceLine" id="cb35-10" title="10">       <span class="dt">theme =</span> <span class="st">&quot;colorblind&quot;</span>,</a>
<a class="sourceLine" id="cb35-11" title="11">       <span class="dt">label.cex =</span> <span class="fl">0.75</span>,</a>
<a class="sourceLine" id="cb35-12" title="12">       <span class="dt">pie =</span> piefill_ggm,</a>
<a class="sourceLine" id="cb35-13" title="13">       <span class="dt">pieBorder =</span> <span class="dv">1</span>,</a>
<a class="sourceLine" id="cb35-14" title="14">       <span class="dt">color =</span> <span class="st">&quot;skyblue&quot;</span>)</a></code></pre></div>
<p><img src="baseline-networks_files/figure-html/pa-bct-moti-compare-correlation-partialcorrelation-1.png" width="2100" /></p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb36-1" title="1"></a>
<a class="sourceLine" id="cb36-2" title="2"></a>
<a class="sourceLine" id="cb36-3" title="3">pcorgraph &lt;-<span class="st"> </span>qgraph<span class="op">::</span><span class="kw">qgraph</span>(qgraph<span class="op">::</span><span class="kw">cor_auto</span>(bctdf_ggm), <span class="dt">graph =</span> <span class="st">&quot;pcor&quot;</span>,</a>
<a class="sourceLine" id="cb36-4" title="4">                           <span class="dt">repulsion =</span> <span class="fl">0.99</span>,</a>
<a class="sourceLine" id="cb36-5" title="5">       <span class="dt">labels =</span> <span class="kw">names</span>(bctdf_ggm),</a>
<a class="sourceLine" id="cb36-6" title="6">       <span class="dt">edge.labels =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb36-7" title="7">       <span class="dt">edge.label.cex =</span> <span class="fl">0.75</span>,</a>
<a class="sourceLine" id="cb36-8" title="8">       <span class="dt">label.scale =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb36-9" title="9">       <span class="dt">layout =</span> qgraph<span class="op">::</span><span class="kw">averageLayout</span>(BCT_ggm, BCT_mgm), <span class="co"># get the mgm layout </span></a>
<a class="sourceLine" id="cb36-10" title="10">       <span class="dt">title =</span> <span class="st">&quot;Partial correlation network&quot;</span>,</a>
<a class="sourceLine" id="cb36-11" title="11">       <span class="dt">theme =</span> <span class="st">&quot;colorblind&quot;</span>,</a>
<a class="sourceLine" id="cb36-12" title="12">       <span class="dt">label.cex =</span> <span class="fl">0.75</span>,</a>
<a class="sourceLine" id="cb36-13" title="13">       <span class="dt">pie =</span> piefill_ggm,</a>
<a class="sourceLine" id="cb36-14" title="14">       <span class="dt">pieBorder =</span> <span class="dv">1</span>,</a>
<a class="sourceLine" id="cb36-15" title="15">       <span class="dt">color =</span> <span class="st">&quot;skyblue&quot;</span>)</a></code></pre></div>
<p><img src="baseline-networks_files/figure-html/pa-bct-moti-compare-correlation-partialcorrelation-2.png" width="2100" /></p>
</div>
<div id="correlation-matrix-visualised" class="section level2">
<h2>Correlation matrix visualised</h2>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" title="1"></a>
<a class="sourceLine" id="cb37-2" title="2">bivariate_BCTs &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(</a>
<a class="sourceLine" id="cb37-3" title="3">  <span class="st">&#39;goal setting&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">01</span>_T1,</a>
<a class="sourceLine" id="cb37-4" title="4">  <span class="st">&#39;own plan&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">02</span>_T1,</a>
<a class="sourceLine" id="cb37-5" title="5">  <span class="st">&#39;plan by other&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">03</span>_T1,</a>
<a class="sourceLine" id="cb37-6" title="6">  <span class="st">&#39;reminder of plan&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">04</span>_T1,</a>
<a class="sourceLine" id="cb37-7" title="7">  <span class="st">&#39;subgoals&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">05</span>_T1,</a>
<a class="sourceLine" id="cb37-8" title="8">  <span class="st">&#39;trying new PA&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">06</span>_T1,</a>
<a class="sourceLine" id="cb37-9" title="9">  <span class="st">&#39;barrier identification&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">07</span>_T1,</a>
<a class="sourceLine" id="cb37-10" title="10">  <span class="st">&#39;problem solving&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">08</span>_T1,</a>
<a class="sourceLine" id="cb37-11" title="11">  <span class="st">&#39;PA identity reflection&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">09</span>_T1,</a>
<a class="sourceLine" id="cb37-12" title="12">  <span class="st">&#39;aligning PA with life values&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">10</span>_T1,</a>
<a class="sourceLine" id="cb37-13" title="13">  <span class="st">&#39;remind of PA benefits&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">01</span>_T1,</a>
<a class="sourceLine" id="cb37-14" title="14">  <span class="st">&#39;self-monitor (paper)&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">02</span>_T1,</a>
<a class="sourceLine" id="cb37-15" title="15">  <span class="st">&#39;self-monitor (app)&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">03</span>_T1,</a>
<a class="sourceLine" id="cb37-16" title="16">  <span class="st">&#39;memory cues&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">04</span>_T1,</a>
<a class="sourceLine" id="cb37-17" title="17">  <span class="st">&#39;goal review&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">05</span>_T1,</a>
<a class="sourceLine" id="cb37-18" title="18">  <span class="st">&#39;personal relevance reflection&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">06</span>_T1,</a>
<a class="sourceLine" id="cb37-19" title="19">  <span class="st">&#39;environmental changes (home)&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">07</span>_T1,</a>
<a class="sourceLine" id="cb37-20" title="20">  <span class="st">&#39;social support&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">08</span>_T1,</a>
<a class="sourceLine" id="cb37-21" title="21">  <span class="st">&#39;failure contemplated&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">09</span>_T1,</a>
<a class="sourceLine" id="cb37-22" title="22">  <span class="st">&#39;PA accelerometer&#39;</span> =<span class="st"> </span>mvpaAccelerometer_T1,</a>
<a class="sourceLine" id="cb37-23" title="23">  <span class="st">&#39;PA self-report&#39;</span> =<span class="st"> </span>padaysLastweek_T1,</a>
<a class="sourceLine" id="cb37-24" title="24">  <span class="st">&#39;autonomous&#39;</span> =<span class="st"> </span>PA_autonomous_T1,</a>
<a class="sourceLine" id="cb37-25" title="25">  <span class="st">&#39;controlled&#39;</span> =<span class="st"> </span>PA_controlled_T1) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb37-26" title="26"><span class="st"> </span><span class="kw">rowwise</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb37-27" title="27"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="st">`</span><span class="dt">PA accelerometer</span><span class="st">`</span>, <span class="st">`</span><span class="dt">PA self-report</span><span class="st">`</span>, autonomous, controlled, <span class="kw">everything</span>()) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb37-28" title="28"><span class="st">  </span><span class="kw">mutate_all</span>(as.numeric)</a>
<a class="sourceLine" id="cb37-29" title="29"></a>
<a class="sourceLine" id="cb37-30" title="30"><span class="co"># Create a covariance matrix of the data</span></a>
<a class="sourceLine" id="cb37-31" title="31">covMatrix &lt;-<span class="st"> </span>bctdf_ggm <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">cov</span>(<span class="dt">use =</span> <span class="st">&quot;pairwise.complete.obs&quot;</span>)</a>
<a class="sourceLine" id="cb37-32" title="32"></a>
<a class="sourceLine" id="cb37-33" title="33"><span class="co"># Transform the matrix so, that lower diagonal of the matrix shows partial correlations,</span></a>
<a class="sourceLine" id="cb37-34" title="34"><span class="co"># while the upper one shows bivariate correlations.</span></a>
<a class="sourceLine" id="cb37-35" title="35">matrix_corLower_parcorUpper &lt;-<span class="st"> </span>covMatrix <span class="op">%&gt;%</span><span class="st"> </span>ggm<span class="op">::</span><span class="kw">correlations</span>()</a>
<a class="sourceLine" id="cb37-36" title="36"></a>
<a class="sourceLine" id="cb37-37" title="37"><span class="co"># Show the matrix</span></a>
<a class="sourceLine" id="cb37-38" title="38">matrix_corLower_parcorUpper <span class="op">%&gt;%</span><span class="st"> </span>papaja<span class="op">::</span><span class="kw">apa_table</span>(<span class="dt">caption =</span> <span class="st">&quot;Correlation matrix of key variables of interest. Lower diagonal shows bivariate correlations, upper diagonal shows partial correlations&quot;</span>)</a></code></pre></div>
<caption>
(#tab:allBctsMotiSurveyPA-corrmatrix)
</caption>
<caption>
<em>Correlation matrix of key variables of interest. Lower diagonal shows bivariate correlations, upper diagonal shows partial correlations</em>
</caption>
<table>
<thead>
<tr class="header">
<th></th>
<th align="left">MVPA questionnaire</th>
<th align="left">MVPA accelerometer</th>
<th align="left">autonomous motivation</th>
<th align="left">controlled motivation</th>
<th align="left">goal setting</th>
<th align="left">own plan</th>
<th align="left">plan by other</th>
<th align="left">reminder of plan</th>
<th align="left">subgoals</th>
<th align="left">trying new PA</th>
<th align="left">remind of PA benefits</th>
<th align="left">goal review</th>
<th align="left">personal relevance reflection</th>
<th align="left">environmental changes (home)</th>
<th align="left">social support</th>
<th align="left">barriers identified or planned for</th>
<th align="left">identity, life values</th>
<th align="left">monitoring PA</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>MVPA questionnaire</td>
<td align="left">1.00</td>
<td align="left">0.19</td>
<td align="left">0.19</td>
<td align="left">-0.02</td>
<td align="left">0.02</td>
<td align="left">0.03</td>
<td align="left">0.15</td>
<td align="left">-0.05</td>
<td align="left">0.07</td>
<td align="left">0.10</td>
<td align="left">0.00</td>
<td align="left">0.05</td>
<td align="left">0.02</td>
<td align="left">-0.01</td>
<td align="left">0.01</td>
<td align="left">-0.06</td>
<td align="left">-0.02</td>
<td align="left">0.08</td>
</tr>
<tr class="even">
<td>MVPA accelerometer</td>
<td align="left">0.29</td>
<td align="left">1.00</td>
<td align="left">0.06</td>
<td align="left">-0.04</td>
<td align="left">0.06</td>
<td align="left">-0.08</td>
<td align="left">0.07</td>
<td align="left">-0.02</td>
<td align="left">0.02</td>
<td align="left">0.05</td>
<td align="left">0.02</td>
<td align="left">0.03</td>
<td align="left">-0.03</td>
<td align="left">0.04</td>
<td align="left">0.03</td>
<td align="left">-0.06</td>
<td align="left">0.04</td>
<td align="left">-0.04</td>
</tr>
<tr class="odd">
<td>autonomous motivation</td>
<td align="left">0.43</td>
<td align="left">0.21</td>
<td align="left">1.00</td>
<td align="left">0.02</td>
<td align="left">0.15</td>
<td align="left">0.07</td>
<td align="left">0.08</td>
<td align="left">-0.04</td>
<td align="left">-0.01</td>
<td align="left">0.10</td>
<td align="left">0.14</td>
<td align="left">0.01</td>
<td align="left">0.16</td>
<td align="left">-0.07</td>
<td align="left">-0.04</td>
<td align="left">-0.02</td>
<td align="left">0.16</td>
<td align="left">0.00</td>
</tr>
<tr class="even">
<td>controlled motivation</td>
<td align="left">0.05</td>
<td align="left">-0.02</td>
<td align="left">0.12</td>
<td align="left">1.00</td>
<td align="left">-0.01</td>
<td align="left">0.03</td>
<td align="left">0.01</td>
<td align="left">0.05</td>
<td align="left">0.01</td>
<td align="left">-0.02</td>
<td align="left">0.07</td>
<td align="left">-0.03</td>
<td align="left">0.02</td>
<td align="left">0.02</td>
<td align="left">0.11</td>
<td align="left">0.10</td>
<td align="left">-0.09</td>
<td align="left">-0.01</td>
</tr>
<tr class="odd">
<td>goal setting</td>
<td align="left">0.35</td>
<td align="left">0.17</td>
<td align="left">0.54</td>
<td align="left">0.14</td>
<td align="left">1.00</td>
<td align="left">0.49</td>
<td align="left">-0.01</td>
<td align="left">-0.01</td>
<td align="left">0.06</td>
<td align="left">0.00</td>
<td align="left">0.14</td>
<td align="left">0.05</td>
<td align="left">-0.01</td>
<td align="left">-0.04</td>
<td align="left">0.07</td>
<td align="left">0.09</td>
<td align="left">0.05</td>
<td align="left">-0.06</td>
</tr>
<tr class="even">
<td>own plan</td>
<td align="left">0.36</td>
<td align="left">0.12</td>
<td align="left">0.51</td>
<td align="left">0.16</td>
<td align="left">0.74</td>
<td align="left">1.00</td>
<td align="left">0.13</td>
<td align="left">0.15</td>
<td align="left">0.11</td>
<td align="left">0.05</td>
<td align="left">-0.03</td>
<td align="left">0.07</td>
<td align="left">-0.01</td>
<td align="left">0.01</td>
<td align="left">0.00</td>
<td align="left">0.03</td>
<td align="left">0.07</td>
<td align="left">-0.02</td>
</tr>
<tr class="odd">
<td>plan by other</td>
<td align="left">0.37</td>
<td align="left">0.18</td>
<td align="left">0.37</td>
<td align="left">0.11</td>
<td align="left">0.40</td>
<td align="left">0.48</td>
<td align="left">1.00</td>
<td align="left">0.19</td>
<td align="left">0.12</td>
<td align="left">-0.03</td>
<td align="left">-0.07</td>
<td align="left">0.00</td>
<td align="left">0.02</td>
<td align="left">0.03</td>
<td align="left">0.02</td>
<td align="left">-0.03</td>
<td align="left">0.03</td>
<td align="left">0.03</td>
</tr>
<tr class="even">
<td>reminder of plan</td>
<td align="left">0.29</td>
<td align="left">0.10</td>
<td align="left">0.35</td>
<td align="left">0.17</td>
<td align="left">0.47</td>
<td align="left">0.57</td>
<td align="left">0.50</td>
<td align="left">1.00</td>
<td align="left">0.26</td>
<td align="left">0.05</td>
<td align="left">-0.02</td>
<td align="left">0.11</td>
<td align="left">-0.04</td>
<td align="left">-0.01</td>
<td align="left">-0.03</td>
<td align="left">0.10</td>
<td align="left">0.03</td>
<td align="left">0.27</td>
</tr>
<tr class="odd">
<td>subgoals</td>
<td align="left">0.36</td>
<td align="left">0.15</td>
<td align="left">0.42</td>
<td align="left">0.15</td>
<td align="left">0.54</td>
<td align="left">0.60</td>
<td align="left">0.48</td>
<td align="left">0.64</td>
<td align="left">1.00</td>
<td align="left">0.12</td>
<td align="left">-0.02</td>
<td align="left">0.04</td>
<td align="left">-0.01</td>
<td align="left">0.01</td>
<td align="left">0.01</td>
<td align="left">0.19</td>
<td align="left">0.06</td>
<td align="left">0.04</td>
</tr>
<tr class="even">
<td>trying new PA</td>
<td align="left">0.37</td>
<td align="left">0.17</td>
<td align="left">0.46</td>
<td align="left">0.11</td>
<td align="left">0.47</td>
<td align="left">0.51</td>
<td align="left">0.35</td>
<td align="left">0.47</td>
<td align="left">0.54</td>
<td align="left">1.00</td>
<td align="left">-0.06</td>
<td align="left">0.09</td>
<td align="left">0.04</td>
<td align="left">0.08</td>
<td align="left">0.01</td>
<td align="left">0.17</td>
<td align="left">0.14</td>
<td align="left">0.00</td>
</tr>
<tr class="odd">
<td>remind of PA benefits</td>
<td align="left">0.27</td>
<td align="left">0.13</td>
<td align="left">0.47</td>
<td align="left">0.18</td>
<td align="left">0.47</td>
<td align="left">0.40</td>
<td align="left">0.23</td>
<td align="left">0.31</td>
<td align="left">0.35</td>
<td align="left">0.34</td>
<td align="left">1.00</td>
<td align="left">0.05</td>
<td align="left">0.34</td>
<td align="left">0.00</td>
<td align="left">0.09</td>
<td align="left">0.06</td>
<td align="left">0.04</td>
<td align="left">0.04</td>
</tr>
<tr class="even">
<td>goal review</td>
<td align="left">0.36</td>
<td align="left">0.16</td>
<td align="left">0.43</td>
<td align="left">0.14</td>
<td align="left">0.50</td>
<td align="left">0.53</td>
<td align="left">0.39</td>
<td align="left">0.55</td>
<td align="left">0.53</td>
<td align="left">0.50</td>
<td align="left">0.46</td>
<td align="left">1.00</td>
<td align="left">0.21</td>
<td align="left">0.09</td>
<td align="left">0.09</td>
<td align="left">0.04</td>
<td align="left">-0.01</td>
<td align="left">0.25</td>
</tr>
<tr class="odd">
<td>personal relevance reflection</td>
<td align="left">0.33</td>
<td align="left">0.14</td>
<td align="left">0.53</td>
<td align="left">0.17</td>
<td align="left">0.49</td>
<td align="left">0.47</td>
<td align="left">0.33</td>
<td align="left">0.40</td>
<td align="left">0.44</td>
<td align="left">0.47</td>
<td align="left">0.62</td>
<td align="left">0.58</td>
<td align="left">1.00</td>
<td align="left">0.12</td>
<td align="left">0.11</td>
<td align="left">0.08</td>
<td align="left">0.17</td>
<td align="left">-0.04</td>
</tr>
<tr class="even">
<td>environmental changes (home)</td>
<td align="left">0.24</td>
<td align="left">0.12</td>
<td align="left">0.25</td>
<td align="left">0.16</td>
<td align="left">0.31</td>
<td align="left">0.34</td>
<td align="left">0.30</td>
<td align="left">0.39</td>
<td align="left">0.38</td>
<td align="left">0.38</td>
<td align="left">0.34</td>
<td align="left">0.50</td>
<td align="left">0.45</td>
<td align="left">1.00</td>
<td align="left">0.33</td>
<td align="left">-0.01</td>
<td align="left">0.02</td>
<td align="left">0.27</td>
</tr>
<tr class="odd">
<td>social support</td>
<td align="left">0.24</td>
<td align="left">0.12</td>
<td align="left">0.30</td>
<td align="left">0.22</td>
<td align="left">0.38</td>
<td align="left">0.37</td>
<td align="left">0.29</td>
<td align="left">0.35</td>
<td align="left">0.37</td>
<td align="left">0.35</td>
<td align="left">0.41</td>
<td align="left">0.48</td>
<td align="left">0.48</td>
<td align="left">0.56</td>
<td align="left">1.00</td>
<td align="left">0.04</td>
<td align="left">-0.02</td>
<td align="left">0.05</td>
</tr>
<tr class="even">
<td>barriers identified or planned for</td>
<td align="left">0.27</td>
<td align="left">0.09</td>
<td align="left">0.43</td>
<td align="left">0.20</td>
<td align="left">0.54</td>
<td align="left">0.55</td>
<td align="left">0.37</td>
<td align="left">0.54</td>
<td align="left">0.60</td>
<td align="left">0.56</td>
<td align="left">0.44</td>
<td align="left">0.52</td>
<td align="left">0.53</td>
<td align="left">0.37</td>
<td align="left">0.40</td>
<td align="left">1.00</td>
<td align="left">0.25</td>
<td align="left">0.04</td>
</tr>
<tr class="odd">
<td>identity, life values</td>
<td align="left">0.30</td>
<td align="left">0.16</td>
<td align="left">0.52</td>
<td align="left">0.08</td>
<td align="left">0.53</td>
<td align="left">0.53</td>
<td align="left">0.36</td>
<td align="left">0.43</td>
<td align="left">0.50</td>
<td align="left">0.52</td>
<td align="left">0.43</td>
<td align="left">0.45</td>
<td align="left">0.55</td>
<td align="left">0.32</td>
<td align="left">0.33</td>
<td align="left">0.60</td>
<td align="left">1.00</td>
<td align="left">-0.10</td>
</tr>
<tr class="even">
<td>monitoring PA</td>
<td align="left">0.29</td>
<td align="left">0.08</td>
<td align="left">0.27</td>
<td align="left">0.13</td>
<td align="left">0.31</td>
<td align="left">0.37</td>
<td align="left">0.36</td>
<td align="left">0.55</td>
<td align="left">0.45</td>
<td align="left">0.37</td>
<td align="left">0.31</td>
<td align="left">0.57</td>
<td align="left">0.37</td>
<td align="left">0.53</td>
<td align="left">0.41</td>
<td align="left">0.40</td>
<td align="left">0.27</td>
<td align="left">1.00</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb38-1" title="1"></a>
<a class="sourceLine" id="cb38-2" title="2">labs &lt;-<span class="st"> </span><span class="kw">names</span>(bctdf_ggm)</a>
<a class="sourceLine" id="cb38-3" title="3"><span class="co"># Plot the matrix as a correlogram</span></a>
<a class="sourceLine" id="cb38-4" title="4">matrix_corLower_parcorUpper <span class="op">%&gt;%</span><span class="st"> </span>corrgram<span class="op">::</span><span class="kw">corrgram</span>(</a>
<a class="sourceLine" id="cb38-5" title="5">  <span class="dt">type =</span> <span class="st">&quot;cor&quot;</span>,</a>
<a class="sourceLine" id="cb38-6" title="6">  <span class="dt">lower.panel =</span> corrgram<span class="op">::</span>panel.pie,</a>
<a class="sourceLine" id="cb38-7" title="7">  <span class="dt">upper.panel =</span> corrgram<span class="op">::</span>panel.pie,</a>
<a class="sourceLine" id="cb38-8" title="8">  <span class="dt">outer.labels =</span> <span class="kw">list</span>(<span class="dt">bottom =</span> <span class="kw">list</span>(<span class="dt">labels =</span> labs, <span class="dt">cex =</span> <span class="fl">0.75</span>, <span class="dt">srt =</span> <span class="dv">30</span>),</a>
<a class="sourceLine" id="cb38-9" title="9">                      <span class="dt">left =</span> <span class="kw">list</span>(<span class="dt">labels =</span> labs, <span class="dt">cex =</span> <span class="fl">0.75</span>, <span class="dt">srt =</span> <span class="dv">30</span>)),</a>
<a class="sourceLine" id="cb38-10" title="10">  <span class="dt">main =</span> <span class="st">&quot;Bivariate (upper diagonal) and partial (lower diagonal)</span><span class="ch">\n</span><span class="st">correlations of BCTs, motivation and self-reported PA&quot;</span>)</a></code></pre></div>
<p><img src="baseline-networks_files/figure-html/allBctsMotiSurveyPA-corrmatrix-1.png" width="2100" /></p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" title="1"></a>
<a class="sourceLine" id="cb39-2" title="2">corMatrix_BCTs &lt;-<span class="st"> </span>bivariate_BCTs <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">cor</span>(<span class="dt">use =</span> <span class="st">&quot;pairwise.complete.obs&quot;</span>, <span class="dt">method =</span> <span class="st">&quot;spearman&quot;</span>)</a>
<a class="sourceLine" id="cb39-3" title="3"></a>
<a class="sourceLine" id="cb39-4" title="4"><span class="kw">as.data.frame</span>(<span class="kw">as.table</span>(corMatrix_BCTs)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb39-5" title="5"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(Var1 <span class="op">==</span><span class="st"> &quot;PA accelerometer&quot;</span> <span class="op">|</span><span class="st"> </span>Var1 <span class="op">==</span><span class="st"> &quot;PA self report&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb39-6" title="6"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="st">&quot;Spearman correlation&quot;</span> =<span class="st"> </span>Freq) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb39-7" title="7"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>Freq) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb39-8" title="8"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="st">`</span><span class="dt">Spearman correlation</span><span class="st">`</span> <span class="op">!=</span><span class="st"> </span><span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb39-9" title="9"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">arrange</span>(<span class="kw">desc</span>(<span class="st">`</span><span class="dt">Spearman correlation</span><span class="st">`</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb39-10" title="10"><span class="st">  </span>papaja<span class="op">::</span><span class="kw">apa_table</span>(<span class="dt">caption =</span> <span class="st">&quot;Bivariate correlations between BCTs, motivation and self-reported PA. Sorted by strength.&quot;</span>)</a></code></pre></div>
<caption>
(#tab:allBctsMotiSurveyPA-corrmatrix)
</caption>
<caption>
<em>Bivariate correlations between BCTs, motivation and self-reported PA. Sorted by strength.</em>
</caption>
<table>
<thead>
<tr class="header">
<th align="left">Var1</th>
<th align="left">Var2</th>
<th align="left">Spearman correlation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">PA accelerometer</td>
<td align="left">PA accelerometer</td>
<td align="left">1.00</td>
</tr>
<tr class="even">
<td align="left">PA accelerometer</td>
<td align="left">PA self-report</td>
<td align="left">0.28</td>
</tr>
<tr class="odd">
<td align="left">PA accelerometer</td>
<td align="left">autonomous</td>
<td align="left">0.25</td>
</tr>
<tr class="even">
<td align="left">PA accelerometer</td>
<td align="left">trying new PA</td>
<td align="left">0.18</td>
</tr>
<tr class="odd">
<td align="left">PA accelerometer</td>
<td align="left">goal setting</td>
<td align="left">0.17</td>
</tr>
<tr class="even">
<td align="left">PA accelerometer</td>
<td align="left">aligning PA with life values</td>
<td align="left">0.16</td>
</tr>
<tr class="odd">
<td align="left">PA accelerometer</td>
<td align="left">plan by other</td>
<td align="left">0.16</td>
</tr>
<tr class="even">
<td align="left">PA accelerometer</td>
<td align="left">goal review</td>
<td align="left">0.15</td>
</tr>
<tr class="odd">
<td align="left">PA accelerometer</td>
<td align="left">subgoals</td>
<td align="left">0.14</td>
</tr>
<tr class="even">
<td align="left">PA accelerometer</td>
<td align="left">social support</td>
<td align="left">0.13</td>
</tr>
<tr class="odd">
<td align="left">PA accelerometer</td>
<td align="left">personal relevance reflection</td>
<td align="left">0.13</td>
</tr>
<tr class="even">
<td align="left">PA accelerometer</td>
<td align="left">PA identity reflection</td>
<td align="left">0.13</td>
</tr>
<tr class="odd">
<td align="left">PA accelerometer</td>
<td align="left">remind of PA benefits</td>
<td align="left">0.12</td>
</tr>
<tr class="even">
<td align="left">PA accelerometer</td>
<td align="left">own plan</td>
<td align="left">0.11</td>
</tr>
<tr class="odd">
<td align="left">PA accelerometer</td>
<td align="left">environmental changes (home)</td>
<td align="left">0.11</td>
</tr>
<tr class="even">
<td align="left">PA accelerometer</td>
<td align="left">failure contemplated</td>
<td align="left">0.10</td>
</tr>
<tr class="odd">
<td align="left">PA accelerometer</td>
<td align="left">self-monitor (paper)</td>
<td align="left">0.09</td>
</tr>
<tr class="even">
<td align="left">PA accelerometer</td>
<td align="left">reminder of plan</td>
<td align="left">0.09</td>
</tr>
<tr class="odd">
<td align="left">PA accelerometer</td>
<td align="left">barrier identification</td>
<td align="left">0.08</td>
</tr>
<tr class="even">
<td align="left">PA accelerometer</td>
<td align="left">memory cues</td>
<td align="left">0.08</td>
</tr>
<tr class="odd">
<td align="left">PA accelerometer</td>
<td align="left">problem solving</td>
<td align="left">0.06</td>
</tr>
<tr class="even">
<td align="left">PA accelerometer</td>
<td align="left">self-monitor (app)</td>
<td align="left">0.04</td>
</tr>
<tr class="odd">
<td align="left">PA accelerometer</td>
<td align="left">controlled</td>
<td align="left">-0.03</td>
</tr>
</tbody>
</table>
</div>
<div id="cognitive-bcts-only-added-one-at-a-time" class="section level2">
<h2>Cognitive BCTs only, added one at a time</h2>
<p>Four BCTs can be categorised as being completely cognitive, i.e. not being observable to an outsider. These are (in order of correlation with accelerometer-measured MVPA:</p>
<ol style="list-style-type: decimal">
<li>I have attempted to find ways to exercise so, that it won’t obstruct but instead helps actualise my other life values.</li>
<li>I have thought about which reasons to do PA are important to me personally.</li>
<li>I have reminded myself even in my spare time, what kind of positive consequences frequent PA would have in my life.</li>
<li>I have thought about how PA fits my identity (self concept).</li>
</ol>
<p>First, we fit a model with only the first one:</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb40-1" title="1">bctdf_mgm &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(</a>
<a class="sourceLine" id="cb40-2" title="2"><span class="co">#  id,</span></a>
<a class="sourceLine" id="cb40-3" title="3"><span class="co">#  intervention,</span></a>
<a class="sourceLine" id="cb40-4" title="4"><span class="co">#  group,</span></a>
<a class="sourceLine" id="cb40-5" title="5"><span class="co">#  school,</span></a>
<a class="sourceLine" id="cb40-6" title="6"><span class="co">#  girl,</span></a>
<a class="sourceLine" id="cb40-7" title="7">  <span class="st">&#39;goal setting&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">01</span>_T1,</a>
<a class="sourceLine" id="cb40-8" title="8">  <span class="st">&#39;own plan&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">02</span>_T1,</a>
<a class="sourceLine" id="cb40-9" title="9">  <span class="st">&#39;plan by other&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">03</span>_T1,</a>
<a class="sourceLine" id="cb40-10" title="10">  <span class="st">&#39;reminder of plan&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">04</span>_T1,</a>
<a class="sourceLine" id="cb40-11" title="11">  <span class="st">&#39;subgoals&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">05</span>_T1,</a>
<a class="sourceLine" id="cb40-12" title="12">  <span class="st">&#39;trying new PA&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">06</span>_T1,</a>
<a class="sourceLine" id="cb40-13" title="13">  <span class="st">&#39;barrier identification&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">07</span>_T1,</a>
<a class="sourceLine" id="cb40-14" title="14">  <span class="st">&#39;problem solving&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">08</span>_T1,</a>
<a class="sourceLine" id="cb40-15" title="15">  <span class="st">&#39;PA identity reflection&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">09</span>_T1,</a>
<a class="sourceLine" id="cb40-16" title="16">  <span class="st">&#39;aligning PA with life values&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">10</span>_T1,</a>
<a class="sourceLine" id="cb40-17" title="17">  <span class="st">&#39;remind of PA benefits&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">01</span>_T1,</a>
<a class="sourceLine" id="cb40-18" title="18">  <span class="st">&#39;self-monitor (paper)&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">02</span>_T1,</a>
<a class="sourceLine" id="cb40-19" title="19">  <span class="st">&#39;self-monitor (app)&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">03</span>_T1,</a>
<a class="sourceLine" id="cb40-20" title="20"><span class="co">#  &#39;memory cues&#39; = PA_frequencyDependentBCT_04_T1, # Issues with clarity of item wording </span></a>
<a class="sourceLine" id="cb40-21" title="21">  <span class="st">&#39;goal review&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">05</span>_T1,</a>
<a class="sourceLine" id="cb40-22" title="22">  <span class="st">&#39;personal relevance reflection&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">06</span>_T1,</a>
<a class="sourceLine" id="cb40-23" title="23">  <span class="st">&#39;environmental changes (home)&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">07</span>_T1,</a>
<a class="sourceLine" id="cb40-24" title="24">  <span class="st">&#39;social support&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">08</span>_T1,</a>
<a class="sourceLine" id="cb40-25" title="25">  <span class="st">&#39;analysing goal failure&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">09</span>_T1,</a>
<a class="sourceLine" id="cb40-26" title="26">  <span class="st">&#39;MVPA questionnaire&#39;</span> =<span class="st"> </span>padaysLastweek_T1,</a>
<a class="sourceLine" id="cb40-27" title="27">  <span class="st">&#39;MVPA accelerometer&#39;</span> =<span class="st"> </span>mvpaAccelerometer_T1,</a>
<a class="sourceLine" id="cb40-28" title="28">  <span class="st">&#39;intrinsic&#39;</span> =<span class="st"> </span>PA_intrinsic_T1,</a>
<a class="sourceLine" id="cb40-29" title="29">  <span class="st">&#39;identified&#39;</span> =<span class="st"> </span>PA_identified_T1,</a>
<a class="sourceLine" id="cb40-30" title="30">  <span class="st">&#39;controlled motivation&#39;</span> =<span class="st"> </span>PA_controlled_T1) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb40-31" title="31"><span class="st"> </span><span class="kw">rowwise</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb40-32" title="32"><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">transmute</span>(</a>
<a class="sourceLine" id="cb40-33" title="33">  <span class="co"># &#39;goal setting&#39; = ifelse(`goal setting` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb40-34" title="34">  <span class="co"># &#39;has plan&#39; = ifelse(`own plan` == 1 &amp; `plan by other` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb40-35" title="35">  <span class="co"># &#39;own plan&#39; = ifelse(`own plan` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb40-36" title="36">  <span class="co"># &#39;plan by other&#39; = ifelse(`plan by other` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb40-37" title="37">  <span class="co"># &#39;reminder of plan&#39; = ifelse(`reminder of plan` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb40-38" title="38">  <span class="co"># &#39;subgoals&#39; = ifelse(`subgoals` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb40-39" title="39">  <span class="co"># &#39;trying new PA&#39; = ifelse(`trying new PA` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb40-40" title="40">  <span class="co"># &#39;barrier identification&#39; = ifelse(`barrier identification` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb40-41" title="41">  <span class="co"># &#39;problem solving&#39; = ifelse(`problem solving` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb40-42" title="42">  <span class="co"># &#39;barriers identified or planned for&#39; = ifelse(`problem solving` == 1 &amp; `barrier identification` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb40-43" title="43"> <span class="co"># &#39;PA identity reflection&#39; = ifelse(`PA identity reflection` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb40-44" title="44"> <span class="st">&#39;aligning PA with life values&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">aligning PA with life values</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb40-45" title="45">  <span class="co"># &#39;identity, life values&#39; = ifelse(`PA identity reflection` == 1 &amp; `aligning PA with life values` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb40-46" title="46">  <span class="co"># &#39;remind of PA benefits&#39; = ifelse(`remind of PA benefits` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb40-47" title="47">  <span class="co"># &#39;monitoring PA&#39; = ifelse(`self-monitor (paper)` == 1 &amp; `self-monitor (app)` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb40-48" title="48">  <span class="co"># &#39;memory cues&#39; = ifelse(`memory cues` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb40-49" title="49">  <span class="co"># &#39;goal review&#39; = ifelse(`goal review` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb40-50" title="50">  <span class="co"># &#39;personal relevance reflection&#39; = ifelse(`personal relevance reflection` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb40-51" title="51">  <span class="co"># &#39;environmental changes (home)&#39; = ifelse(`environmental changes (home)` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb40-52" title="52">  <span class="co"># &#39;social support&#39; = ifelse(`social support` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb40-53" title="53">  <span class="co"># &#39;analysing goal failure&#39; = ifelse(`analysing goal failure` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb40-54" title="54">  <span class="st">&#39;autonomous motivation&#39;</span> =<span class="st"> </span><span class="kw">mean</span>(<span class="kw">c</span>(identified, intrinsic), <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb40-55" title="55"><span class="co">#  &#39;girl&#39; = ifelse(girl == &quot;girl&quot;, 1, 0),</span></a>
<a class="sourceLine" id="cb40-56" title="56">  <span class="st">&#39;controlled motivation&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">controlled motivation</span><span class="st">`</span> <span class="op">&lt;</span><span class="st"> </span><span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">1</span>), <span class="co"># If &quot;at least partly&quot; or more true, input 1. Normality otherwise a problem.</span></a>
<a class="sourceLine" id="cb40-57" title="57">  <span class="st">&#39;MVPA questionnaire&#39;</span> =<span class="st"> `</span><span class="dt">MVPA questionnaire</span><span class="st">`</span> <span class="op">*</span><span class="st"> </span><span class="dv">1</span>, </a>
<a class="sourceLine" id="cb40-58" title="58">  <span class="st">&#39;MVPA accelerometer&#39;</span> =<span class="st"> `</span><span class="dt">MVPA accelerometer</span><span class="st">`</span> <span class="op">*</span><span class="st"> </span><span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st">  </span></a>
<a class="sourceLine" id="cb40-59" title="59"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="st">&#39;MVPA questionnaire&#39;</span>, <span class="st">&#39;MVPA accelerometer&#39;</span>, <span class="kw">everything</span>())</a>
<a class="sourceLine" id="cb40-60" title="60"></a>
<a class="sourceLine" id="cb40-61" title="61">bctdf_mgm<span class="op">$</span><span class="st">`</span><span class="dt">autonomous motivation</span><span class="st">`</span>[<span class="kw">is.nan</span>(bctdf_mgm<span class="op">$</span><span class="st">`</span><span class="dt">autonomous motivation</span><span class="st">`</span>)] &lt;-<span class="st"> </span><span class="ot">NA</span></a>
<a class="sourceLine" id="cb40-62" title="62"></a>
<a class="sourceLine" id="cb40-63" title="63">labs &lt;-<span class="st"> </span><span class="kw">names</span>(bctdf_mgm)</a>
<a class="sourceLine" id="cb40-64" title="64"></a>
<a class="sourceLine" id="cb40-65" title="65">bctdf_mgm &lt;-<span class="st"> </span>bctdf_mgm <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">na.omit</span>(.)</a>
<a class="sourceLine" id="cb40-66" title="66"><span class="co"># bctdf_mgm %&gt;% names()</span></a>
<a class="sourceLine" id="cb40-67" title="67">mgm_variable_types &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;g&quot;</span>, <span class="st">&quot;g&quot;</span>, <span class="kw">rep</span>(<span class="st">&quot;c&quot;</span>, <span class="dv">1</span>), <span class="st">&quot;g&quot;</span>, <span class="st">&quot;c&quot;</span>)</a>
<a class="sourceLine" id="cb40-68" title="68">mgm_variable_levels &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;1&quot;</span>, <span class="st">&quot;1&quot;</span>, <span class="kw">rep</span>(<span class="st">&quot;2&quot;</span>, <span class="dv">1</span>), <span class="st">&quot;1&quot;</span>, <span class="st">&quot;2&quot;</span>)</a>
<a class="sourceLine" id="cb40-69" title="69"><span class="co"># data.frame(mgm_variable_types, mgm_variable_levels, names(bctdf_mgm))</span></a>
<a class="sourceLine" id="cb40-70" title="70"></a>
<a class="sourceLine" id="cb40-71" title="71">mgm_obj &lt;-<span class="st"> </span>mgm<span class="op">::</span><span class="kw">mgm</span>(<span class="dt">data =</span> bctdf_mgm,</a>
<a class="sourceLine" id="cb40-72" title="72">  <span class="dt">type =</span> mgm_variable_types,</a>
<a class="sourceLine" id="cb40-73" title="73">  <span class="dt">level =</span> mgm_variable_levels,</a>
<a class="sourceLine" id="cb40-74" title="74">  <span class="dt">lambdaSel =</span> <span class="st">&quot;CV&quot;</span>,</a>
<a class="sourceLine" id="cb40-75" title="75">  <span class="dt">lambdaFolds =</span> <span class="dv">10</span>,</a>
<a class="sourceLine" id="cb40-76" title="76">  <span class="dt">pbar =</span> <span class="ot">FALSE</span>, </a>
<a class="sourceLine" id="cb40-77" title="77">  <span class="dt">binarySign =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb40-78" title="78"><span class="co">## Note that the sign of parameter estimates is stored separately; see ?mgm</span></a>
<a class="sourceLine" id="cb40-79" title="79"></a>
<a class="sourceLine" id="cb40-80" title="80">pred_obj &lt;-<span class="st"> </span><span class="kw">predict</span>(<span class="dt">object =</span> mgm_obj,</a>
<a class="sourceLine" id="cb40-81" title="81">                         <span class="dt">data =</span> bctdf_mgm)</a>
<a class="sourceLine" id="cb40-82" title="82"></a>
<a class="sourceLine" id="cb40-83" title="83">pred_obj<span class="op">$</span>errors</a></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Variable"],"name":[1],"type":["chr"],"align":["left"]},{"label":["RMSE"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["R2"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["CC"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["nCC"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["CCmarg"],"name":[6],"type":["dbl"],"align":["right"]}],"data":[{"1":"MVPA questionnaire","2":"0.862","3":"0.256","4":"NA","5":"NA","6":"NA","_rn_":"1"},{"1":"MVPA accelerometer","2":"0.950","3":"0.096","4":"NA","5":"NA","6":"NA","_rn_":"2"},{"1":"aligning PA with life values","2":"NA","3":"NA","4":"0.843","5":"0.144","6":"0.817","_rn_":"3"},{"1":"autonomous motivation","2":"0.843","3":"0.288","4":"NA","5":"NA","6":"NA","_rn_":"4"},{"1":"controlled motivation","2":"NA","3":"NA","4":"0.883","5":"0.000","6":"0.883","_rn_":"5"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb41-1" title="1"></a>
<a class="sourceLine" id="cb41-2" title="2"><span class="co"># Take R2 from gaussian, CC from categorical variables </span></a>
<a class="sourceLine" id="cb41-3" title="3">pie_errors &lt;-<span class="st"> </span><span class="kw">c</span>(pred_obj<span class="op">$</span>errors[<span class="dv">1</span>, <span class="dv">3</span>],</a>
<a class="sourceLine" id="cb41-4" title="4">                pred_obj<span class="op">$</span>errors[<span class="dv">2</span>, <span class="dv">3</span>],</a>
<a class="sourceLine" id="cb41-5" title="5">                pred_obj<span class="op">$</span>errors[<span class="dv">3</span>, <span class="dv">4</span>],</a>
<a class="sourceLine" id="cb41-6" title="6">                pred_obj<span class="op">$</span>errors[<span class="dv">4</span>, <span class="dv">3</span>],</a>
<a class="sourceLine" id="cb41-7" title="7">                pred_obj<span class="op">$</span>errors[<span class="dv">5</span>, <span class="dv">4</span>])</a>
<a class="sourceLine" id="cb41-8" title="8"></a>
<a class="sourceLine" id="cb41-9" title="9"><span class="co"># Coloring nodes: make a sequence of colors from the viridis palette. We need three colors (MVPA, BCTs, motivation), and &quot;begin&quot; from ones that are not too dark, so that black text shows up ok.</span></a>
<a class="sourceLine" id="cb41-10" title="10"></a>
<a class="sourceLine" id="cb41-11" title="11">node_colors &lt;-<span class="st"> </span><span class="kw">c</span>(viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">3</span>, <span class="dt">begin =</span> <span class="fl">0.4</span>, <span class="dt">end =</span> <span class="fl">0.99</span>)[<span class="dv">1</span>], <span class="co"># Color 1 for MVPA (questionnaire)</span></a>
<a class="sourceLine" id="cb41-12" title="12">                 viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">3</span>, <span class="dt">begin =</span> <span class="fl">0.4</span>, <span class="dt">end =</span> <span class="fl">0.99</span>)[<span class="dv">1</span>], <span class="co"># Color 1 for MVPA (accelerometer)</span></a>
<a class="sourceLine" id="cb41-13" title="13">                 <span class="kw">rep</span>(viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">3</span>, <span class="dt">begin =</span> <span class="fl">0.4</span>, <span class="dt">end =</span> <span class="fl">0.99</span>)[<span class="dv">2</span>], <span class="dv">1</span>), <span class="co"># 4x Color 2 for BCTs</span></a>
<a class="sourceLine" id="cb41-14" title="14">                 <span class="kw">rep</span>(viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">3</span>, <span class="dt">begin =</span> <span class="fl">0.4</span>, <span class="dt">end =</span> <span class="fl">0.99</span>)[<span class="dv">3</span>], <span class="dv">1</span>), <span class="co"># Color 3 for motivation (controlled)</span></a>
<a class="sourceLine" id="cb41-15" title="15">                 viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">3</span>, <span class="dt">begin =</span> <span class="fl">0.4</span>, <span class="dt">end =</span> <span class="fl">0.99</span>)[<span class="dv">3</span>]) <span class="co"># Color 3 for motivation (autonomous) </span></a>
<a class="sourceLine" id="cb41-16" title="16"></a>
<a class="sourceLine" id="cb41-17" title="17">BCT_mgm &lt;-<span class="st"> </span>qgraph<span class="op">::</span><span class="kw">qgraph</span>(mgm_obj<span class="op">$</span>pairwise<span class="op">$</span>wadj, </a>
<a class="sourceLine" id="cb41-18" title="18">            <span class="dt">layout =</span> <span class="st">&quot;spring&quot;</span>,</a>
<a class="sourceLine" id="cb41-19" title="19">            <span class="dt">repulsion =</span> <span class="fl">0.99</span>, <span class="co"># To nudge the network from originally bad visual state</span></a>
<a class="sourceLine" id="cb41-20" title="20">            <span class="dt">title =</span> <span class="st">&quot;cognitive/motivational BCTs, PA &amp; motivation&quot;</span>,</a>
<a class="sourceLine" id="cb41-21" title="21">            <span class="dt">edge.color =</span> <span class="kw">ifelse</span>(mgm_obj<span class="op">$</span>pairwise<span class="op">$</span>edgecolor <span class="op">==</span><span class="st"> &quot;darkgreen&quot;</span>, <span class="st">&quot;blue&quot;</span>, mgm_obj<span class="op">$</span>pairwise<span class="op">$</span>edgecolor),</a>
<a class="sourceLine" id="cb41-22" title="22">            <span class="dt">pie =</span> pie_errors,</a>
<a class="sourceLine" id="cb41-23" title="23">            <span class="dt">pieColor =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">5</span>, <span class="dt">begin =</span> <span class="fl">0.3</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">5</span>],</a>
<a class="sourceLine" id="cb41-24" title="24">            <span class="dt">color =</span> node_colors,</a>
<a class="sourceLine" id="cb41-25" title="25">            <span class="dt">labels =</span> <span class="kw">names</span>(bctdf_mgm),</a>
<a class="sourceLine" id="cb41-26" title="26">            <span class="dt">label.cex =</span> <span class="fl">0.75</span>,</a>
<a class="sourceLine" id="cb41-27" title="27">            <span class="dt">label.scale =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb41-28" title="28">            <span class="dt">vertex.label.dist =</span> <span class="dv">2</span>)</a></code></pre></div>
<p><img src="baseline-networks_files/figure-html/cognitiveBCTs1-1.png" width="2100" /></p>
<p>Adding the second (I have thought about which reasons to do PA are important to me personally):</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb42-1" title="1">bctdf_mgm &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(</a>
<a class="sourceLine" id="cb42-2" title="2"><span class="co">#  id,</span></a>
<a class="sourceLine" id="cb42-3" title="3"><span class="co">#  intervention,</span></a>
<a class="sourceLine" id="cb42-4" title="4"><span class="co">#  group,</span></a>
<a class="sourceLine" id="cb42-5" title="5"><span class="co">#  school,</span></a>
<a class="sourceLine" id="cb42-6" title="6"><span class="co">#  girl,</span></a>
<a class="sourceLine" id="cb42-7" title="7">  <span class="st">&#39;goal setting&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">01</span>_T1,</a>
<a class="sourceLine" id="cb42-8" title="8">  <span class="st">&#39;own plan&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">02</span>_T1,</a>
<a class="sourceLine" id="cb42-9" title="9">  <span class="st">&#39;plan by other&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">03</span>_T1,</a>
<a class="sourceLine" id="cb42-10" title="10">  <span class="st">&#39;reminder of plan&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">04</span>_T1,</a>
<a class="sourceLine" id="cb42-11" title="11">  <span class="st">&#39;subgoals&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">05</span>_T1,</a>
<a class="sourceLine" id="cb42-12" title="12">  <span class="st">&#39;trying new PA&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">06</span>_T1,</a>
<a class="sourceLine" id="cb42-13" title="13">  <span class="st">&#39;barrier identification&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">07</span>_T1,</a>
<a class="sourceLine" id="cb42-14" title="14">  <span class="st">&#39;problem solving&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">08</span>_T1,</a>
<a class="sourceLine" id="cb42-15" title="15">  <span class="st">&#39;PA identity reflection&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">09</span>_T1,</a>
<a class="sourceLine" id="cb42-16" title="16">  <span class="st">&#39;aligning PA with life values&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">10</span>_T1,</a>
<a class="sourceLine" id="cb42-17" title="17">  <span class="st">&#39;remind of PA benefits&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">01</span>_T1,</a>
<a class="sourceLine" id="cb42-18" title="18">  <span class="st">&#39;self-monitor (paper)&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">02</span>_T1,</a>
<a class="sourceLine" id="cb42-19" title="19">  <span class="st">&#39;self-monitor (app)&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">03</span>_T1,</a>
<a class="sourceLine" id="cb42-20" title="20"><span class="co">#  &#39;memory cues&#39; = PA_frequencyDependentBCT_04_T1, # Issues with clarity of item wording </span></a>
<a class="sourceLine" id="cb42-21" title="21">  <span class="st">&#39;goal review&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">05</span>_T1,</a>
<a class="sourceLine" id="cb42-22" title="22">  <span class="st">&#39;personal relevance reflection&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">06</span>_T1,</a>
<a class="sourceLine" id="cb42-23" title="23">  <span class="st">&#39;environmental changes (home)&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">07</span>_T1,</a>
<a class="sourceLine" id="cb42-24" title="24">  <span class="st">&#39;social support&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">08</span>_T1,</a>
<a class="sourceLine" id="cb42-25" title="25">  <span class="st">&#39;analysing goal failure&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">09</span>_T1,</a>
<a class="sourceLine" id="cb42-26" title="26">  <span class="st">&#39;MVPA questionnaire&#39;</span> =<span class="st"> </span>padaysLastweek_T1,</a>
<a class="sourceLine" id="cb42-27" title="27">  <span class="st">&#39;MVPA accelerometer&#39;</span> =<span class="st"> </span>mvpaAccelerometer_T1,</a>
<a class="sourceLine" id="cb42-28" title="28">  <span class="st">&#39;intrinsic&#39;</span> =<span class="st"> </span>PA_intrinsic_T1,</a>
<a class="sourceLine" id="cb42-29" title="29">  <span class="st">&#39;identified&#39;</span> =<span class="st"> </span>PA_identified_T1,</a>
<a class="sourceLine" id="cb42-30" title="30">  <span class="st">&#39;controlled motivation&#39;</span> =<span class="st"> </span>PA_controlled_T1) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb42-31" title="31"><span class="st"> </span><span class="kw">rowwise</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb42-32" title="32"><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">transmute</span>(</a>
<a class="sourceLine" id="cb42-33" title="33">  <span class="co"># &#39;goal setting&#39; = ifelse(`goal setting` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb42-34" title="34">  <span class="co"># &#39;has plan&#39; = ifelse(`own plan` == 1 &amp; `plan by other` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb42-35" title="35">  <span class="co"># &#39;own plan&#39; = ifelse(`own plan` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb42-36" title="36">  <span class="co"># &#39;plan by other&#39; = ifelse(`plan by other` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb42-37" title="37">  <span class="co"># &#39;reminder of plan&#39; = ifelse(`reminder of plan` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb42-38" title="38">  <span class="co"># &#39;subgoals&#39; = ifelse(`subgoals` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb42-39" title="39">  <span class="co"># &#39;trying new PA&#39; = ifelse(`trying new PA` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb42-40" title="40">  <span class="co"># &#39;barrier identification&#39; = ifelse(`barrier identification` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb42-41" title="41">  <span class="co"># &#39;problem solving&#39; = ifelse(`problem solving` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb42-42" title="42">  <span class="co"># &#39;barriers identified or planned for&#39; = ifelse(`problem solving` == 1 &amp; `barrier identification` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb42-43" title="43"> <span class="co"># &#39;PA identity reflection&#39; = ifelse(`PA identity reflection` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb42-44" title="44"> <span class="st">&#39;aligning PA with life values&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">aligning PA with life values</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb42-45" title="45">  <span class="co"># &#39;identity, life values&#39; = ifelse(`PA identity reflection` == 1 &amp; `aligning PA with life values` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb42-46" title="46">  <span class="co"># &#39;remind of PA benefits&#39; = ifelse(`remind of PA benefits` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb42-47" title="47">  <span class="co"># &#39;monitoring PA&#39; = ifelse(`self-monitor (paper)` == 1 &amp; `self-monitor (app)` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb42-48" title="48">  <span class="co"># &#39;memory cues&#39; = ifelse(`memory cues` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb42-49" title="49">  <span class="co"># &#39;goal review&#39; = ifelse(`goal review` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb42-50" title="50">  <span class="st">&#39;personal relevance reflection&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">personal relevance reflection</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb42-51" title="51">  <span class="co"># &#39;environmental changes (home)&#39; = ifelse(`environmental changes (home)` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb42-52" title="52">  <span class="co"># &#39;social support&#39; = ifelse(`social support` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb42-53" title="53">  <span class="co"># &#39;analysing goal failure&#39; = ifelse(`analysing goal failure` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb42-54" title="54">  <span class="st">&#39;autonomous motivation&#39;</span> =<span class="st"> </span><span class="kw">mean</span>(<span class="kw">c</span>(identified, intrinsic), <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb42-55" title="55"><span class="co">#  &#39;girl&#39; = ifelse(girl == &quot;girl&quot;, 1, 0),</span></a>
<a class="sourceLine" id="cb42-56" title="56">  <span class="st">&#39;controlled motivation&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">controlled motivation</span><span class="st">`</span> <span class="op">&lt;</span><span class="st"> </span><span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">1</span>), <span class="co"># If &quot;at least partly&quot; or more true, input 1. Normality otherwise a problem.</span></a>
<a class="sourceLine" id="cb42-57" title="57">  <span class="st">&#39;MVPA questionnaire&#39;</span> =<span class="st"> `</span><span class="dt">MVPA questionnaire</span><span class="st">`</span> <span class="op">*</span><span class="st"> </span><span class="dv">1</span>, </a>
<a class="sourceLine" id="cb42-58" title="58">  <span class="st">&#39;MVPA accelerometer&#39;</span> =<span class="st"> `</span><span class="dt">MVPA accelerometer</span><span class="st">`</span> <span class="op">*</span><span class="st"> </span><span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st">  </span></a>
<a class="sourceLine" id="cb42-59" title="59"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="st">&#39;MVPA questionnaire&#39;</span>, <span class="st">&#39;MVPA accelerometer&#39;</span>, <span class="kw">everything</span>())</a>
<a class="sourceLine" id="cb42-60" title="60"></a>
<a class="sourceLine" id="cb42-61" title="61">bctdf_mgm<span class="op">$</span><span class="st">`</span><span class="dt">autonomous motivation</span><span class="st">`</span>[<span class="kw">is.nan</span>(bctdf_mgm<span class="op">$</span><span class="st">`</span><span class="dt">autonomous motivation</span><span class="st">`</span>)] &lt;-<span class="st"> </span><span class="ot">NA</span></a>
<a class="sourceLine" id="cb42-62" title="62"></a>
<a class="sourceLine" id="cb42-63" title="63">labs &lt;-<span class="st"> </span><span class="kw">names</span>(bctdf_mgm)</a>
<a class="sourceLine" id="cb42-64" title="64"></a>
<a class="sourceLine" id="cb42-65" title="65">bctdf_mgm &lt;-<span class="st"> </span>bctdf_mgm <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">na.omit</span>(.)</a>
<a class="sourceLine" id="cb42-66" title="66"><span class="co"># bctdf_mgm %&gt;% names()</span></a>
<a class="sourceLine" id="cb42-67" title="67">mgm_variable_types &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;g&quot;</span>, <span class="st">&quot;g&quot;</span>, <span class="kw">rep</span>(<span class="st">&quot;c&quot;</span>, <span class="dv">2</span>), <span class="st">&quot;g&quot;</span>, <span class="st">&quot;c&quot;</span>)</a>
<a class="sourceLine" id="cb42-68" title="68">mgm_variable_levels &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;1&quot;</span>, <span class="st">&quot;1&quot;</span>, <span class="kw">rep</span>(<span class="st">&quot;2&quot;</span>, <span class="dv">2</span>), <span class="st">&quot;1&quot;</span>, <span class="st">&quot;2&quot;</span>)</a>
<a class="sourceLine" id="cb42-69" title="69"><span class="co"># data.frame(mgm_variable_types, mgm_variable_levels, names(bctdf_mgm))</span></a>
<a class="sourceLine" id="cb42-70" title="70"></a>
<a class="sourceLine" id="cb42-71" title="71">mgm_obj &lt;-<span class="st"> </span>mgm<span class="op">::</span><span class="kw">mgm</span>(<span class="dt">data =</span> bctdf_mgm,</a>
<a class="sourceLine" id="cb42-72" title="72">  <span class="dt">type =</span> mgm_variable_types,</a>
<a class="sourceLine" id="cb42-73" title="73">  <span class="dt">level =</span> mgm_variable_levels,</a>
<a class="sourceLine" id="cb42-74" title="74">  <span class="dt">lambdaSel =</span> <span class="st">&quot;CV&quot;</span>,</a>
<a class="sourceLine" id="cb42-75" title="75">  <span class="dt">lambdaFolds =</span> <span class="dv">10</span>,</a>
<a class="sourceLine" id="cb42-76" title="76">  <span class="dt">pbar =</span> <span class="ot">FALSE</span>, </a>
<a class="sourceLine" id="cb42-77" title="77">  <span class="dt">binarySign =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb42-78" title="78"><span class="co">## Note that the sign of parameter estimates is stored separately; see ?mgm</span></a>
<a class="sourceLine" id="cb42-79" title="79"></a>
<a class="sourceLine" id="cb42-80" title="80">pred_obj &lt;-<span class="st"> </span><span class="kw">predict</span>(<span class="dt">object =</span> mgm_obj,</a>
<a class="sourceLine" id="cb42-81" title="81">                         <span class="dt">data =</span> bctdf_mgm)</a>
<a class="sourceLine" id="cb42-82" title="82"></a>
<a class="sourceLine" id="cb42-83" title="83">pred_obj<span class="op">$</span>errors</a></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Variable"],"name":[1],"type":["chr"],"align":["left"]},{"label":["RMSE"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["R2"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["CC"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["nCC"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["CCmarg"],"name":[6],"type":["dbl"],"align":["right"]}],"data":[{"1":"MVPA questionnaire","2":"0.862","3":"0.255","4":"NA","5":"NA","6":"NA","_rn_":"1"},{"1":"MVPA accelerometer","2":"0.950","3":"0.096","4":"NA","5":"NA","6":"NA","_rn_":"2"},{"1":"aligning PA with life values","2":"NA","3":"NA","4":"0.861","5":"0.242","6":"0.817","_rn_":"3"},{"1":"personal relevance reflection","2":"NA","3":"NA","4":"0.843","5":"0.319","6":"0.769","_rn_":"4"},{"1":"autonomous motivation","2":"0.812","3":"0.340","4":"NA","5":"NA","6":"NA","_rn_":"5"},{"1":"controlled motivation","2":"NA","3":"NA","4":"0.883","5":"0.000","6":"0.883","_rn_":"6"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb43-1" title="1"></a>
<a class="sourceLine" id="cb43-2" title="2"><span class="co"># Take R2 from gaussian, CC from categorical variables </span></a>
<a class="sourceLine" id="cb43-3" title="3">pie_errors &lt;-<span class="st"> </span><span class="kw">c</span>(pred_obj<span class="op">$</span>errors[<span class="dv">1</span>, <span class="dv">3</span>],</a>
<a class="sourceLine" id="cb43-4" title="4">                pred_obj<span class="op">$</span>errors[<span class="dv">2</span>, <span class="dv">3</span>],</a>
<a class="sourceLine" id="cb43-5" title="5">                pred_obj<span class="op">$</span>errors[<span class="dv">3</span><span class="op">:</span><span class="dv">4</span>, <span class="dv">4</span>],</a>
<a class="sourceLine" id="cb43-6" title="6">                pred_obj<span class="op">$</span>errors[<span class="dv">5</span>, <span class="dv">3</span>],</a>
<a class="sourceLine" id="cb43-7" title="7">                pred_obj<span class="op">$</span>errors[<span class="dv">6</span>, <span class="dv">4</span>])</a>
<a class="sourceLine" id="cb43-8" title="8"></a>
<a class="sourceLine" id="cb43-9" title="9"><span class="co"># Coloring nodes: make a sequence of colors from the viridis palette. We need three colors (MVPA, BCTs, motivation), and &quot;begin&quot; from ones that are not too dark, so that black text shows up ok.</span></a>
<a class="sourceLine" id="cb43-10" title="10"></a>
<a class="sourceLine" id="cb43-11" title="11">node_colors &lt;-<span class="st"> </span><span class="kw">c</span>(viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">3</span>, <span class="dt">begin =</span> <span class="fl">0.4</span>, <span class="dt">end =</span> <span class="fl">0.99</span>)[<span class="dv">1</span>], <span class="co"># Color 1 for MVPA (questionnaire)</span></a>
<a class="sourceLine" id="cb43-12" title="12">                 viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">3</span>, <span class="dt">begin =</span> <span class="fl">0.4</span>, <span class="dt">end =</span> <span class="fl">0.99</span>)[<span class="dv">1</span>], <span class="co"># Color 1 for MVPA (accelerometer)</span></a>
<a class="sourceLine" id="cb43-13" title="13">                 <span class="kw">rep</span>(viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">3</span>, <span class="dt">begin =</span> <span class="fl">0.4</span>, <span class="dt">end =</span> <span class="fl">0.99</span>)[<span class="dv">2</span>], <span class="dv">2</span>), <span class="co"># 2x Color 2 for BCTs</span></a>
<a class="sourceLine" id="cb43-14" title="14">                 <span class="kw">rep</span>(viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">3</span>, <span class="dt">begin =</span> <span class="fl">0.4</span>, <span class="dt">end =</span> <span class="fl">0.99</span>)[<span class="dv">3</span>], <span class="dv">1</span>), <span class="co"># Color 3 for motivation (controlled)</span></a>
<a class="sourceLine" id="cb43-15" title="15">                 viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">3</span>, <span class="dt">begin =</span> <span class="fl">0.4</span>, <span class="dt">end =</span> <span class="fl">0.99</span>)[<span class="dv">3</span>]) <span class="co"># Color 3 for motivation (autonomous) </span></a>
<a class="sourceLine" id="cb43-16" title="16"></a>
<a class="sourceLine" id="cb43-17" title="17">BCT_mgm &lt;-<span class="st"> </span>qgraph<span class="op">::</span><span class="kw">qgraph</span>(mgm_obj<span class="op">$</span>pairwise<span class="op">$</span>wadj, </a>
<a class="sourceLine" id="cb43-18" title="18">            <span class="dt">layout =</span> <span class="st">&quot;spring&quot;</span>,</a>
<a class="sourceLine" id="cb43-19" title="19">            <span class="dt">repulsion =</span> <span class="fl">0.99</span>, <span class="co"># To nudge the network from originally bad visual state</span></a>
<a class="sourceLine" id="cb43-20" title="20">            <span class="dt">title =</span> <span class="st">&quot;cognitive/motivational BCTs, PA &amp; motivation&quot;</span>,</a>
<a class="sourceLine" id="cb43-21" title="21">            <span class="dt">edge.color =</span> <span class="kw">ifelse</span>(mgm_obj<span class="op">$</span>pairwise<span class="op">$</span>edgecolor <span class="op">==</span><span class="st"> &quot;darkgreen&quot;</span>, <span class="st">&quot;blue&quot;</span>, mgm_obj<span class="op">$</span>pairwise<span class="op">$</span>edgecolor),</a>
<a class="sourceLine" id="cb43-22" title="22">            <span class="dt">pie =</span> pie_errors,</a>
<a class="sourceLine" id="cb43-23" title="23">            <span class="dt">pieColor =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">5</span>, <span class="dt">begin =</span> <span class="fl">0.3</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">5</span>],</a>
<a class="sourceLine" id="cb43-24" title="24">            <span class="dt">color =</span> node_colors,</a>
<a class="sourceLine" id="cb43-25" title="25">            <span class="dt">labels =</span> <span class="kw">names</span>(bctdf_mgm),</a>
<a class="sourceLine" id="cb43-26" title="26">            <span class="dt">label.cex =</span> <span class="fl">0.75</span>,</a>
<a class="sourceLine" id="cb43-27" title="27">            <span class="dt">label.scale =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<p><img src="baseline-networks_files/figure-html/cognitiveBCTs2-1.png" width="2100" /></p>
<p>Adding the third (I have reminded myself even in my spare time, what kind of positive consequences frequent PA would have in my life):</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb44-1" title="1">bctdf_mgm &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(</a>
<a class="sourceLine" id="cb44-2" title="2"><span class="co">#  id,</span></a>
<a class="sourceLine" id="cb44-3" title="3"><span class="co">#  intervention,</span></a>
<a class="sourceLine" id="cb44-4" title="4"><span class="co">#  group,</span></a>
<a class="sourceLine" id="cb44-5" title="5"><span class="co">#  school,</span></a>
<a class="sourceLine" id="cb44-6" title="6"><span class="co">#  girl,</span></a>
<a class="sourceLine" id="cb44-7" title="7">  <span class="st">&#39;goal setting&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">01</span>_T1,</a>
<a class="sourceLine" id="cb44-8" title="8">  <span class="st">&#39;own plan&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">02</span>_T1,</a>
<a class="sourceLine" id="cb44-9" title="9">  <span class="st">&#39;plan by other&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">03</span>_T1,</a>
<a class="sourceLine" id="cb44-10" title="10">  <span class="st">&#39;reminder of plan&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">04</span>_T1,</a>
<a class="sourceLine" id="cb44-11" title="11">  <span class="st">&#39;subgoals&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">05</span>_T1,</a>
<a class="sourceLine" id="cb44-12" title="12">  <span class="st">&#39;trying new PA&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">06</span>_T1,</a>
<a class="sourceLine" id="cb44-13" title="13">  <span class="st">&#39;barrier identification&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">07</span>_T1,</a>
<a class="sourceLine" id="cb44-14" title="14">  <span class="st">&#39;problem solving&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">08</span>_T1,</a>
<a class="sourceLine" id="cb44-15" title="15">  <span class="st">&#39;PA identity reflection&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">09</span>_T1,</a>
<a class="sourceLine" id="cb44-16" title="16">  <span class="st">&#39;aligning PA with life values&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">10</span>_T1,</a>
<a class="sourceLine" id="cb44-17" title="17">  <span class="st">&#39;remind of PA benefits&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">01</span>_T1,</a>
<a class="sourceLine" id="cb44-18" title="18">  <span class="st">&#39;self-monitor (paper)&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">02</span>_T1,</a>
<a class="sourceLine" id="cb44-19" title="19">  <span class="st">&#39;self-monitor (app)&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">03</span>_T1,</a>
<a class="sourceLine" id="cb44-20" title="20"><span class="co">#  &#39;memory cues&#39; = PA_frequencyDependentBCT_04_T1, # Issues with clarity of item wording </span></a>
<a class="sourceLine" id="cb44-21" title="21">  <span class="st">&#39;goal review&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">05</span>_T1,</a>
<a class="sourceLine" id="cb44-22" title="22">  <span class="st">&#39;personal relevance reflection&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">06</span>_T1,</a>
<a class="sourceLine" id="cb44-23" title="23">  <span class="st">&#39;environmental changes (home)&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">07</span>_T1,</a>
<a class="sourceLine" id="cb44-24" title="24">  <span class="st">&#39;social support&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">08</span>_T1,</a>
<a class="sourceLine" id="cb44-25" title="25">  <span class="st">&#39;analysing goal failure&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">09</span>_T1,</a>
<a class="sourceLine" id="cb44-26" title="26">  <span class="st">&#39;MVPA questionnaire&#39;</span> =<span class="st"> </span>padaysLastweek_T1,</a>
<a class="sourceLine" id="cb44-27" title="27">  <span class="st">&#39;MVPA accelerometer&#39;</span> =<span class="st"> </span>mvpaAccelerometer_T1,</a>
<a class="sourceLine" id="cb44-28" title="28">  <span class="st">&#39;intrinsic&#39;</span> =<span class="st"> </span>PA_intrinsic_T1,</a>
<a class="sourceLine" id="cb44-29" title="29">  <span class="st">&#39;identified&#39;</span> =<span class="st"> </span>PA_identified_T1,</a>
<a class="sourceLine" id="cb44-30" title="30">  <span class="st">&#39;controlled motivation&#39;</span> =<span class="st"> </span>PA_controlled_T1) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb44-31" title="31"><span class="st"> </span><span class="kw">rowwise</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb44-32" title="32"><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">transmute</span>(</a>
<a class="sourceLine" id="cb44-33" title="33">  <span class="co"># &#39;goal setting&#39; = ifelse(`goal setting` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb44-34" title="34">  <span class="co"># &#39;has plan&#39; = ifelse(`own plan` == 1 &amp; `plan by other` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb44-35" title="35">  <span class="co"># &#39;own plan&#39; = ifelse(`own plan` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb44-36" title="36">  <span class="co"># &#39;plan by other&#39; = ifelse(`plan by other` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb44-37" title="37">  <span class="co"># &#39;reminder of plan&#39; = ifelse(`reminder of plan` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb44-38" title="38">  <span class="co"># &#39;subgoals&#39; = ifelse(`subgoals` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb44-39" title="39">  <span class="co"># &#39;trying new PA&#39; = ifelse(`trying new PA` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb44-40" title="40">  <span class="co"># &#39;barrier identification&#39; = ifelse(`barrier identification` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb44-41" title="41">  <span class="co"># &#39;problem solving&#39; = ifelse(`problem solving` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb44-42" title="42">  <span class="co"># &#39;barriers identified or planned for&#39; = ifelse(`problem solving` == 1 &amp; `barrier identification` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb44-43" title="43"> <span class="co"># &#39;PA identity reflection&#39; = ifelse(`PA identity reflection` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb44-44" title="44"> <span class="st">&#39;aligning PA with life values&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">aligning PA with life values</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb44-45" title="45">  <span class="co"># &#39;identity, life values&#39; = ifelse(`PA identity reflection` == 1 &amp; `aligning PA with life values` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb44-46" title="46">  <span class="st">&#39;remind of PA benefits&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">remind of PA benefits</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb44-47" title="47">  <span class="co"># &#39;monitoring PA&#39; = ifelse(`self-monitor (paper)` == 1 &amp; `self-monitor (app)` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb44-48" title="48">  <span class="co"># &#39;memory cues&#39; = ifelse(`memory cues` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb44-49" title="49">  <span class="co"># &#39;goal review&#39; = ifelse(`goal review` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb44-50" title="50">  <span class="st">&#39;personal relevance reflection&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">personal relevance reflection</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb44-51" title="51">  <span class="co"># &#39;environmental changes (home)&#39; = ifelse(`environmental changes (home)` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb44-52" title="52">  <span class="co"># &#39;social support&#39; = ifelse(`social support` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb44-53" title="53">  <span class="co"># &#39;analysing goal failure&#39; = ifelse(`analysing goal failure` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb44-54" title="54">  <span class="st">&#39;autonomous motivation&#39;</span> =<span class="st"> </span><span class="kw">mean</span>(<span class="kw">c</span>(identified, intrinsic), <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb44-55" title="55"><span class="co">#  &#39;girl&#39; = ifelse(girl == &quot;girl&quot;, 1, 0),</span></a>
<a class="sourceLine" id="cb44-56" title="56">  <span class="st">&#39;controlled motivation&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">controlled motivation</span><span class="st">`</span> <span class="op">&lt;</span><span class="st"> </span><span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">1</span>), <span class="co"># If &quot;at least partly&quot; or more true, input 1. Normality otherwise a problem.</span></a>
<a class="sourceLine" id="cb44-57" title="57">  <span class="st">&#39;MVPA questionnaire&#39;</span> =<span class="st"> `</span><span class="dt">MVPA questionnaire</span><span class="st">`</span> <span class="op">*</span><span class="st"> </span><span class="dv">1</span>, </a>
<a class="sourceLine" id="cb44-58" title="58">  <span class="st">&#39;MVPA accelerometer&#39;</span> =<span class="st"> `</span><span class="dt">MVPA accelerometer</span><span class="st">`</span> <span class="op">*</span><span class="st"> </span><span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st">  </span></a>
<a class="sourceLine" id="cb44-59" title="59"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="st">&#39;MVPA questionnaire&#39;</span>, <span class="st">&#39;MVPA accelerometer&#39;</span>, <span class="kw">everything</span>())</a>
<a class="sourceLine" id="cb44-60" title="60"></a>
<a class="sourceLine" id="cb44-61" title="61">bctdf_mgm<span class="op">$</span><span class="st">`</span><span class="dt">autonomous motivation</span><span class="st">`</span>[<span class="kw">is.nan</span>(bctdf_mgm<span class="op">$</span><span class="st">`</span><span class="dt">autonomous motivation</span><span class="st">`</span>)] &lt;-<span class="st"> </span><span class="ot">NA</span></a>
<a class="sourceLine" id="cb44-62" title="62"></a>
<a class="sourceLine" id="cb44-63" title="63">labs &lt;-<span class="st"> </span><span class="kw">names</span>(bctdf_mgm)</a>
<a class="sourceLine" id="cb44-64" title="64"></a>
<a class="sourceLine" id="cb44-65" title="65">bctdf_mgm &lt;-<span class="st"> </span>bctdf_mgm <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">na.omit</span>(.)</a>
<a class="sourceLine" id="cb44-66" title="66"><span class="co"># bctdf_mgm %&gt;% names()</span></a>
<a class="sourceLine" id="cb44-67" title="67">mgm_variable_types &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;g&quot;</span>, <span class="st">&quot;g&quot;</span>, <span class="kw">rep</span>(<span class="st">&quot;c&quot;</span>, <span class="dv">3</span>), <span class="st">&quot;g&quot;</span>, <span class="st">&quot;c&quot;</span>)</a>
<a class="sourceLine" id="cb44-68" title="68">mgm_variable_levels &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;1&quot;</span>, <span class="st">&quot;1&quot;</span>, <span class="kw">rep</span>(<span class="st">&quot;2&quot;</span>, <span class="dv">3</span>), <span class="st">&quot;1&quot;</span>, <span class="st">&quot;2&quot;</span>)</a>
<a class="sourceLine" id="cb44-69" title="69"><span class="co"># data.frame(mgm_variable_types, mgm_variable_levels, names(bctdf_mgm))</span></a>
<a class="sourceLine" id="cb44-70" title="70"></a>
<a class="sourceLine" id="cb44-71" title="71">mgm_obj &lt;-<span class="st"> </span>mgm<span class="op">::</span><span class="kw">mgm</span>(<span class="dt">data =</span> bctdf_mgm,</a>
<a class="sourceLine" id="cb44-72" title="72">  <span class="dt">type =</span> mgm_variable_types,</a>
<a class="sourceLine" id="cb44-73" title="73">  <span class="dt">level =</span> mgm_variable_levels,</a>
<a class="sourceLine" id="cb44-74" title="74">  <span class="dt">lambdaSel =</span> <span class="st">&quot;CV&quot;</span>,</a>
<a class="sourceLine" id="cb44-75" title="75">  <span class="dt">lambdaFolds =</span> <span class="dv">10</span>,</a>
<a class="sourceLine" id="cb44-76" title="76">  <span class="dt">pbar =</span> <span class="ot">FALSE</span>, </a>
<a class="sourceLine" id="cb44-77" title="77">  <span class="dt">binarySign =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb44-78" title="78"><span class="co">## Note that the sign of parameter estimates is stored separately; see ?mgm</span></a>
<a class="sourceLine" id="cb44-79" title="79"></a>
<a class="sourceLine" id="cb44-80" title="80">pred_obj &lt;-<span class="st"> </span><span class="kw">predict</span>(<span class="dt">object =</span> mgm_obj,</a>
<a class="sourceLine" id="cb44-81" title="81">                         <span class="dt">data =</span> bctdf_mgm)</a>
<a class="sourceLine" id="cb44-82" title="82"></a>
<a class="sourceLine" id="cb44-83" title="83">pred_obj<span class="op">$</span>errors</a></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Variable"],"name":[1],"type":["chr"],"align":["left"]},{"label":["RMSE"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["R2"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["CC"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["nCC"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["CCmarg"],"name":[6],"type":["dbl"],"align":["right"]}],"data":[{"1":"MVPA questionnaire","2":"0.859","3":"0.261","4":"NA","5":"NA","6":"NA","_rn_":"1"},{"1":"MVPA accelerometer","2":"0.954","3":"0.090","4":"NA","5":"NA","6":"NA","_rn_":"2"},{"1":"aligning PA with life values","2":"NA","3":"NA","4":"0.869","5":"0.288","6":"0.816","_rn_":"3"},{"1":"remind of PA benefits","2":"NA","3":"NA","4":"0.898","5":"0.255","6":"0.863","_rn_":"4"},{"1":"personal relevance reflection","2":"NA","3":"NA","4":"0.868","5":"0.428","6":"0.769","_rn_":"5"},{"1":"autonomous motivation","2":"0.809","3":"0.345","4":"NA","5":"NA","6":"NA","_rn_":"6"},{"1":"controlled motivation","2":"NA","3":"NA","4":"0.883","5":"0.000","6":"0.883","_rn_":"7"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb45-1" title="1"></a>
<a class="sourceLine" id="cb45-2" title="2"><span class="co"># Take R2 from gaussian, CC from categorical variables </span></a>
<a class="sourceLine" id="cb45-3" title="3">pie_errors &lt;-<span class="st"> </span><span class="kw">c</span>(pred_obj<span class="op">$</span>errors[<span class="dv">1</span>, <span class="dv">3</span>],</a>
<a class="sourceLine" id="cb45-4" title="4">                pred_obj<span class="op">$</span>errors[<span class="dv">2</span>, <span class="dv">3</span>],</a>
<a class="sourceLine" id="cb45-5" title="5">                pred_obj<span class="op">$</span>errors[<span class="dv">3</span><span class="op">:</span><span class="dv">5</span>, <span class="dv">4</span>],</a>
<a class="sourceLine" id="cb45-6" title="6">                pred_obj<span class="op">$</span>errors[<span class="dv">6</span>, <span class="dv">3</span>],</a>
<a class="sourceLine" id="cb45-7" title="7">                pred_obj<span class="op">$</span>errors[<span class="dv">7</span>, <span class="dv">4</span>])</a>
<a class="sourceLine" id="cb45-8" title="8"></a>
<a class="sourceLine" id="cb45-9" title="9"><span class="co"># Coloring nodes: make a sequence of colors from the viridis palette. We need three colors (MVPA, BCTs, motivation), and &quot;begin&quot; from ones that are not too dark, so that black text shows up ok.</span></a>
<a class="sourceLine" id="cb45-10" title="10"></a>
<a class="sourceLine" id="cb45-11" title="11">node_colors &lt;-<span class="st"> </span><span class="kw">c</span>(viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">3</span>, <span class="dt">begin =</span> <span class="fl">0.4</span>, <span class="dt">end =</span> <span class="fl">0.99</span>)[<span class="dv">1</span>], <span class="co"># Color 1 for MVPA (questionnaire)</span></a>
<a class="sourceLine" id="cb45-12" title="12">                 viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">3</span>, <span class="dt">begin =</span> <span class="fl">0.4</span>, <span class="dt">end =</span> <span class="fl">0.99</span>)[<span class="dv">1</span>], <span class="co"># Color 1 for MVPA (accelerometer)</span></a>
<a class="sourceLine" id="cb45-13" title="13">                 <span class="kw">rep</span>(viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">3</span>, <span class="dt">begin =</span> <span class="fl">0.4</span>, <span class="dt">end =</span> <span class="fl">0.99</span>)[<span class="dv">2</span>], <span class="dv">3</span>), <span class="co"># 3x Color 2 for BCTs</span></a>
<a class="sourceLine" id="cb45-14" title="14">                 <span class="kw">rep</span>(viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">3</span>, <span class="dt">begin =</span> <span class="fl">0.4</span>, <span class="dt">end =</span> <span class="fl">0.99</span>)[<span class="dv">3</span>], <span class="dv">1</span>), <span class="co"># Color 3 for motivation (controlled)</span></a>
<a class="sourceLine" id="cb45-15" title="15">                 viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">3</span>, <span class="dt">begin =</span> <span class="fl">0.4</span>, <span class="dt">end =</span> <span class="fl">0.99</span>)[<span class="dv">3</span>]) <span class="co"># Color 3 for motivation (autonomous) </span></a>
<a class="sourceLine" id="cb45-16" title="16"></a>
<a class="sourceLine" id="cb45-17" title="17">BCT_mgm &lt;-<span class="st"> </span>qgraph<span class="op">::</span><span class="kw">qgraph</span>(mgm_obj<span class="op">$</span>pairwise<span class="op">$</span>wadj, </a>
<a class="sourceLine" id="cb45-18" title="18">            <span class="dt">layout =</span> <span class="st">&quot;spring&quot;</span>,</a>
<a class="sourceLine" id="cb45-19" title="19">            <span class="dt">repulsion =</span> <span class="fl">0.99</span>, <span class="co"># To nudge the network from originally bad visual state</span></a>
<a class="sourceLine" id="cb45-20" title="20">            <span class="dt">title =</span> <span class="st">&quot;cognitive/motivational BCTs, PA &amp; motivation&quot;</span>,</a>
<a class="sourceLine" id="cb45-21" title="21">            <span class="dt">edge.color =</span> <span class="kw">ifelse</span>(mgm_obj<span class="op">$</span>pairwise<span class="op">$</span>edgecolor <span class="op">==</span><span class="st"> &quot;darkgreen&quot;</span>, <span class="st">&quot;blue&quot;</span>, mgm_obj<span class="op">$</span>pairwise<span class="op">$</span>edgecolor),</a>
<a class="sourceLine" id="cb45-22" title="22">            <span class="dt">pie =</span> pie_errors,</a>
<a class="sourceLine" id="cb45-23" title="23">            <span class="dt">pieColor =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">5</span>, <span class="dt">begin =</span> <span class="fl">0.3</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">5</span>],</a>
<a class="sourceLine" id="cb45-24" title="24">            <span class="dt">color =</span> node_colors,</a>
<a class="sourceLine" id="cb45-25" title="25">            <span class="dt">labels =</span> <span class="kw">names</span>(bctdf_mgm),</a>
<a class="sourceLine" id="cb45-26" title="26">            <span class="dt">label.cex =</span> <span class="fl">0.75</span>,</a>
<a class="sourceLine" id="cb45-27" title="27">            <span class="dt">label.scale =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<p><img src="baseline-networks_files/figure-html/cognitiveBCTs3-1.png" width="2100" /></p>
<p>Adding the fourth (I have thought about how PA fits my identity (self concept)):</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb46-1" title="1">bctdf_mgm &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(</a>
<a class="sourceLine" id="cb46-2" title="2"><span class="co">#  id,</span></a>
<a class="sourceLine" id="cb46-3" title="3"><span class="co">#  intervention,</span></a>
<a class="sourceLine" id="cb46-4" title="4"><span class="co">#  group,</span></a>
<a class="sourceLine" id="cb46-5" title="5"><span class="co">#  school,</span></a>
<a class="sourceLine" id="cb46-6" title="6"><span class="co">#  girl,</span></a>
<a class="sourceLine" id="cb46-7" title="7">  <span class="st">&#39;goal setting&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">01</span>_T1,</a>
<a class="sourceLine" id="cb46-8" title="8">  <span class="st">&#39;own plan&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">02</span>_T1,</a>
<a class="sourceLine" id="cb46-9" title="9">  <span class="st">&#39;plan by other&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">03</span>_T1,</a>
<a class="sourceLine" id="cb46-10" title="10">  <span class="st">&#39;reminder of plan&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">04</span>_T1,</a>
<a class="sourceLine" id="cb46-11" title="11">  <span class="st">&#39;subgoals&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">05</span>_T1,</a>
<a class="sourceLine" id="cb46-12" title="12">  <span class="st">&#39;trying new PA&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">06</span>_T1,</a>
<a class="sourceLine" id="cb46-13" title="13">  <span class="st">&#39;barrier identification&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">07</span>_T1,</a>
<a class="sourceLine" id="cb46-14" title="14">  <span class="st">&#39;problem solving&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">08</span>_T1,</a>
<a class="sourceLine" id="cb46-15" title="15">  <span class="st">&#39;PA identity reflection&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">09</span>_T1,</a>
<a class="sourceLine" id="cb46-16" title="16">  <span class="st">&#39;aligning PA with life values&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">10</span>_T1,</a>
<a class="sourceLine" id="cb46-17" title="17">  <span class="st">&#39;remind of PA benefits&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">01</span>_T1,</a>
<a class="sourceLine" id="cb46-18" title="18">  <span class="st">&#39;self-monitor (paper)&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">02</span>_T1,</a>
<a class="sourceLine" id="cb46-19" title="19">  <span class="st">&#39;self-monitor (app)&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">03</span>_T1,</a>
<a class="sourceLine" id="cb46-20" title="20"><span class="co">#  &#39;memory cues&#39; = PA_frequencyDependentBCT_04_T1, # Issues with clarity of item wording </span></a>
<a class="sourceLine" id="cb46-21" title="21">  <span class="st">&#39;goal review&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">05</span>_T1,</a>
<a class="sourceLine" id="cb46-22" title="22">  <span class="st">&#39;personal relevance reflection&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">06</span>_T1,</a>
<a class="sourceLine" id="cb46-23" title="23">  <span class="st">&#39;environmental changes (home)&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">07</span>_T1,</a>
<a class="sourceLine" id="cb46-24" title="24">  <span class="st">&#39;social support&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">08</span>_T1,</a>
<a class="sourceLine" id="cb46-25" title="25">  <span class="st">&#39;analysing goal failure&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">09</span>_T1,</a>
<a class="sourceLine" id="cb46-26" title="26">  <span class="st">&#39;MVPA questionnaire&#39;</span> =<span class="st"> </span>padaysLastweek_T1,</a>
<a class="sourceLine" id="cb46-27" title="27">  <span class="st">&#39;MVPA accelerometer&#39;</span> =<span class="st"> </span>mvpaAccelerometer_T1,</a>
<a class="sourceLine" id="cb46-28" title="28">  <span class="st">&#39;intrinsic&#39;</span> =<span class="st"> </span>PA_intrinsic_T1,</a>
<a class="sourceLine" id="cb46-29" title="29">  <span class="st">&#39;identified&#39;</span> =<span class="st"> </span>PA_identified_T1,</a>
<a class="sourceLine" id="cb46-30" title="30">  <span class="st">&#39;controlled motivation&#39;</span> =<span class="st"> </span>PA_controlled_T1) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb46-31" title="31"><span class="st"> </span><span class="kw">rowwise</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb46-32" title="32"><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">transmute</span>(</a>
<a class="sourceLine" id="cb46-33" title="33">  <span class="co"># &#39;goal setting&#39; = ifelse(`goal setting` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb46-34" title="34">  <span class="co"># &#39;has plan&#39; = ifelse(`own plan` == 1 &amp; `plan by other` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb46-35" title="35">  <span class="co"># &#39;own plan&#39; = ifelse(`own plan` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb46-36" title="36">  <span class="co"># &#39;plan by other&#39; = ifelse(`plan by other` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb46-37" title="37">  <span class="co"># &#39;reminder of plan&#39; = ifelse(`reminder of plan` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb46-38" title="38">  <span class="co"># &#39;subgoals&#39; = ifelse(`subgoals` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb46-39" title="39">  <span class="co"># &#39;trying new PA&#39; = ifelse(`trying new PA` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb46-40" title="40">  <span class="co"># &#39;barrier identification&#39; = ifelse(`barrier identification` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb46-41" title="41">  <span class="co"># &#39;problem solving&#39; = ifelse(`problem solving` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb46-42" title="42">  <span class="co"># &#39;barriers identified or planned for&#39; = ifelse(`problem solving` == 1 &amp; `barrier identification` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb46-43" title="43"> <span class="st">&#39;PA identity reflection&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">PA identity reflection</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb46-44" title="44"> <span class="st">&#39;aligning PA with life values&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">aligning PA with life values</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb46-45" title="45">  <span class="co"># &#39;identity, life values&#39; = ifelse(`PA identity reflection` == 1 &amp; `aligning PA with life values` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb46-46" title="46">  <span class="st">&#39;remind of PA benefits&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">remind of PA benefits</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb46-47" title="47">  <span class="co"># &#39;monitoring PA&#39; = ifelse(`self-monitor (paper)` == 1 &amp; `self-monitor (app)` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb46-48" title="48">  <span class="co"># &#39;memory cues&#39; = ifelse(`memory cues` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb46-49" title="49">  <span class="co"># &#39;goal review&#39; = ifelse(`goal review` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb46-50" title="50">  <span class="st">&#39;personal relevance reflection&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">personal relevance reflection</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb46-51" title="51">  <span class="co"># &#39;environmental changes (home)&#39; = ifelse(`environmental changes (home)` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb46-52" title="52">  <span class="co"># &#39;social support&#39; = ifelse(`social support` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb46-53" title="53">  <span class="co"># &#39;analysing goal failure&#39; = ifelse(`analysing goal failure` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb46-54" title="54">  <span class="st">&#39;autonomous motivation&#39;</span> =<span class="st"> </span><span class="kw">mean</span>(<span class="kw">c</span>(identified, intrinsic), <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb46-55" title="55"><span class="co">#  &#39;girl&#39; = ifelse(girl == &quot;girl&quot;, 1, 0),</span></a>
<a class="sourceLine" id="cb46-56" title="56">  <span class="st">&#39;controlled motivation&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">controlled motivation</span><span class="st">`</span> <span class="op">&lt;</span><span class="st"> </span><span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">1</span>), <span class="co"># If &quot;at least partly&quot; or more true, input 1. Normality otherwise a problem.</span></a>
<a class="sourceLine" id="cb46-57" title="57">  <span class="st">&#39;MVPA questionnaire&#39;</span> =<span class="st"> `</span><span class="dt">MVPA questionnaire</span><span class="st">`</span> <span class="op">*</span><span class="st"> </span><span class="dv">1</span>, </a>
<a class="sourceLine" id="cb46-58" title="58">  <span class="st">&#39;MVPA accelerometer&#39;</span> =<span class="st"> `</span><span class="dt">MVPA accelerometer</span><span class="st">`</span> <span class="op">*</span><span class="st"> </span><span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st">  </span></a>
<a class="sourceLine" id="cb46-59" title="59"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="st">&#39;MVPA questionnaire&#39;</span>, <span class="st">&#39;MVPA accelerometer&#39;</span>, <span class="kw">everything</span>())</a>
<a class="sourceLine" id="cb46-60" title="60"></a>
<a class="sourceLine" id="cb46-61" title="61">bctdf_mgm<span class="op">$</span><span class="st">`</span><span class="dt">autonomous motivation</span><span class="st">`</span>[<span class="kw">is.nan</span>(bctdf_mgm<span class="op">$</span><span class="st">`</span><span class="dt">autonomous motivation</span><span class="st">`</span>)] &lt;-<span class="st"> </span><span class="ot">NA</span></a>
<a class="sourceLine" id="cb46-62" title="62"></a>
<a class="sourceLine" id="cb46-63" title="63">labs &lt;-<span class="st"> </span><span class="kw">names</span>(bctdf_mgm)</a>
<a class="sourceLine" id="cb46-64" title="64"></a>
<a class="sourceLine" id="cb46-65" title="65">bctdf_mgm &lt;-<span class="st"> </span>bctdf_mgm <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">na.omit</span>(.)</a>
<a class="sourceLine" id="cb46-66" title="66"><span class="co"># bctdf_mgm %&gt;% names()</span></a>
<a class="sourceLine" id="cb46-67" title="67">mgm_variable_types &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;g&quot;</span>, <span class="st">&quot;g&quot;</span>, <span class="kw">rep</span>(<span class="st">&quot;c&quot;</span>, <span class="dv">4</span>), <span class="st">&quot;g&quot;</span>, <span class="st">&quot;c&quot;</span>)</a>
<a class="sourceLine" id="cb46-68" title="68">mgm_variable_levels &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;1&quot;</span>, <span class="st">&quot;1&quot;</span>, <span class="kw">rep</span>(<span class="st">&quot;2&quot;</span>, <span class="dv">4</span>), <span class="st">&quot;1&quot;</span>, <span class="st">&quot;2&quot;</span>)</a>
<a class="sourceLine" id="cb46-69" title="69"><span class="co"># data.frame(mgm_variable_types, mgm_variable_levels, names(bctdf_mgm))</span></a>
<a class="sourceLine" id="cb46-70" title="70"></a>
<a class="sourceLine" id="cb46-71" title="71">mgm_obj &lt;-<span class="st"> </span>mgm<span class="op">::</span><span class="kw">mgm</span>(<span class="dt">data =</span> bctdf_mgm,</a>
<a class="sourceLine" id="cb46-72" title="72">  <span class="dt">type =</span> mgm_variable_types,</a>
<a class="sourceLine" id="cb46-73" title="73">  <span class="dt">level =</span> mgm_variable_levels,</a>
<a class="sourceLine" id="cb46-74" title="74">  <span class="dt">lambdaSel =</span> <span class="st">&quot;CV&quot;</span>,</a>
<a class="sourceLine" id="cb46-75" title="75">  <span class="dt">lambdaFolds =</span> <span class="dv">10</span>,</a>
<a class="sourceLine" id="cb46-76" title="76">  <span class="dt">pbar =</span> <span class="ot">FALSE</span>, </a>
<a class="sourceLine" id="cb46-77" title="77">  <span class="dt">binarySign =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb46-78" title="78"><span class="co">## Note that the sign of parameter estimates is stored separately; see ?mgm</span></a>
<a class="sourceLine" id="cb46-79" title="79"></a>
<a class="sourceLine" id="cb46-80" title="80">pred_obj &lt;-<span class="st"> </span><span class="kw">predict</span>(<span class="dt">object =</span> mgm_obj,</a>
<a class="sourceLine" id="cb46-81" title="81">                         <span class="dt">data =</span> bctdf_mgm)</a>
<a class="sourceLine" id="cb46-82" title="82"></a>
<a class="sourceLine" id="cb46-83" title="83">pred_obj<span class="op">$</span>errors</a></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Variable"],"name":[1],"type":["chr"],"align":["left"]},{"label":["RMSE"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["R2"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["CC"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["nCC"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["CCmarg"],"name":[6],"type":["dbl"],"align":["right"]}],"data":[{"1":"MVPA questionnaire","2":"0.857","3":"0.265","4":"NA","5":"NA","6":"NA","_rn_":"1"},{"1":"MVPA accelerometer","2":"0.952","3":"0.092","4":"NA","5":"NA","6":"NA","_rn_":"2"},{"1":"PA identity reflection","2":"NA","3":"NA","4":"0.907","5":"0.455","6":"0.829","_rn_":"3"},{"1":"aligning PA with life values","2":"NA","3":"NA","4":"0.914","5":"0.530","6":"0.817","_rn_":"4"},{"1":"remind of PA benefits","2":"NA","3":"NA","4":"0.900","5":"0.265","6":"0.864","_rn_":"5"},{"1":"personal relevance reflection","2":"NA","3":"NA","4":"0.869","5":"0.434","6":"0.769","_rn_":"6"},{"1":"autonomous motivation","2":"0.809","3":"0.344","4":"NA","5":"NA","6":"NA","_rn_":"7"},{"1":"controlled motivation","2":"NA","3":"NA","4":"0.883","5":"0.000","6":"0.883","_rn_":"8"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb47-1" title="1"></a>
<a class="sourceLine" id="cb47-2" title="2"><span class="co"># Take R2 from gaussian, CC from categorical variables </span></a>
<a class="sourceLine" id="cb47-3" title="3">pie_errors &lt;-<span class="st"> </span><span class="kw">c</span>(pred_obj<span class="op">$</span>errors[<span class="dv">1</span>, <span class="dv">3</span>],</a>
<a class="sourceLine" id="cb47-4" title="4">                pred_obj<span class="op">$</span>errors[<span class="dv">2</span>, <span class="dv">3</span>],</a>
<a class="sourceLine" id="cb47-5" title="5">                pred_obj<span class="op">$</span>errors[<span class="dv">3</span><span class="op">:</span><span class="dv">6</span>, <span class="dv">4</span>],</a>
<a class="sourceLine" id="cb47-6" title="6">                pred_obj<span class="op">$</span>errors[<span class="dv">7</span>, <span class="dv">3</span>],</a>
<a class="sourceLine" id="cb47-7" title="7">                pred_obj<span class="op">$</span>errors[<span class="dv">8</span>, <span class="dv">4</span>])</a>
<a class="sourceLine" id="cb47-8" title="8"></a>
<a class="sourceLine" id="cb47-9" title="9"><span class="co"># Coloring nodes: make a sequence of colors from the viridis palette. We need three colors (MVPA, BCTs, motivation), and &quot;begin&quot; from ones that are not too dark, so that black text shows up ok.</span></a>
<a class="sourceLine" id="cb47-10" title="10"></a>
<a class="sourceLine" id="cb47-11" title="11">node_colors &lt;-<span class="st"> </span><span class="kw">c</span>(viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">3</span>, <span class="dt">begin =</span> <span class="fl">0.4</span>, <span class="dt">end =</span> <span class="fl">0.99</span>)[<span class="dv">1</span>], <span class="co"># Color 1 for MVPA (questionnaire)</span></a>
<a class="sourceLine" id="cb47-12" title="12">                 viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">3</span>, <span class="dt">begin =</span> <span class="fl">0.4</span>, <span class="dt">end =</span> <span class="fl">0.99</span>)[<span class="dv">1</span>], <span class="co"># Color 1 for MVPA (accelerometer)</span></a>
<a class="sourceLine" id="cb47-13" title="13">                 <span class="kw">rep</span>(viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">3</span>, <span class="dt">begin =</span> <span class="fl">0.4</span>, <span class="dt">end =</span> <span class="fl">0.99</span>)[<span class="dv">2</span>], <span class="dv">4</span>), <span class="co"># 4x Color 2 for BCTs</span></a>
<a class="sourceLine" id="cb47-14" title="14">                 <span class="kw">rep</span>(viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">3</span>, <span class="dt">begin =</span> <span class="fl">0.4</span>, <span class="dt">end =</span> <span class="fl">0.99</span>)[<span class="dv">3</span>], <span class="dv">1</span>), <span class="co"># Color 3 for motivation (controlled)</span></a>
<a class="sourceLine" id="cb47-15" title="15">                 viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">3</span>, <span class="dt">begin =</span> <span class="fl">0.4</span>, <span class="dt">end =</span> <span class="fl">0.99</span>)[<span class="dv">3</span>]) <span class="co"># Color 3 for motivation (autonomous) </span></a>
<a class="sourceLine" id="cb47-16" title="16"></a>
<a class="sourceLine" id="cb47-17" title="17">BCT_mgm &lt;-<span class="st"> </span>qgraph<span class="op">::</span><span class="kw">qgraph</span>(mgm_obj<span class="op">$</span>pairwise<span class="op">$</span>wadj, </a>
<a class="sourceLine" id="cb47-18" title="18">            <span class="dt">layout =</span> <span class="st">&quot;spring&quot;</span>,</a>
<a class="sourceLine" id="cb47-19" title="19">            <span class="dt">repulsion =</span> <span class="fl">0.99</span>, <span class="co"># To nudge the network from originally bad visual state</span></a>
<a class="sourceLine" id="cb47-20" title="20">            <span class="dt">title =</span> <span class="st">&quot;cognitive/motivational BCTs, PA &amp; motivation&quot;</span>,</a>
<a class="sourceLine" id="cb47-21" title="21">            <span class="dt">edge.color =</span> <span class="kw">ifelse</span>(mgm_obj<span class="op">$</span>pairwise<span class="op">$</span>edgecolor <span class="op">==</span><span class="st"> &quot;darkgreen&quot;</span>, <span class="st">&quot;blue&quot;</span>, mgm_obj<span class="op">$</span>pairwise<span class="op">$</span>edgecolor),</a>
<a class="sourceLine" id="cb47-22" title="22">            <span class="dt">pie =</span> pie_errors,</a>
<a class="sourceLine" id="cb47-23" title="23">            <span class="dt">pieColor =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">5</span>, <span class="dt">begin =</span> <span class="fl">0.3</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">5</span>],</a>
<a class="sourceLine" id="cb47-24" title="24">            <span class="dt">color =</span> node_colors,</a>
<a class="sourceLine" id="cb47-25" title="25">            <span class="dt">labels =</span> <span class="kw">names</span>(bctdf_mgm),</a>
<a class="sourceLine" id="cb47-26" title="26">            <span class="dt">label.cex =</span> <span class="fl">0.75</span>,</a>
<a class="sourceLine" id="cb47-27" title="27">            <span class="dt">label.scale =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<p><img src="baseline-networks_files/figure-html/cognitiveBCTs4-1.png" width="2100" /></p>
<p>Next: Removing motivation items makes the negative connection between positive consequences and MVPA questionnaire disappear (see following plot). One explanation would be <a href="https://web.archive.org/web/20180807095037/http://www.the100.ci/2017/03/14/that-one-weird-third-variable-problem-nobody-ever-mentions-conditioning-on-a-collider/">conditioning on a collider</a>: if both physical activity and thinking about its positive consequences lead to autonomous motivation, this creates a spurious negative link between the two antecedents.</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb48-1" title="1">bctdf_mgm &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(</a>
<a class="sourceLine" id="cb48-2" title="2"><span class="co">#  id,</span></a>
<a class="sourceLine" id="cb48-3" title="3"><span class="co">#  intervention,</span></a>
<a class="sourceLine" id="cb48-4" title="4"><span class="co">#  group,</span></a>
<a class="sourceLine" id="cb48-5" title="5"><span class="co">#  school,</span></a>
<a class="sourceLine" id="cb48-6" title="6"><span class="co">#  girl,</span></a>
<a class="sourceLine" id="cb48-7" title="7">  <span class="st">&#39;goal setting&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">01</span>_T1,</a>
<a class="sourceLine" id="cb48-8" title="8">  <span class="st">&#39;own plan&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">02</span>_T1,</a>
<a class="sourceLine" id="cb48-9" title="9">  <span class="st">&#39;plan by other&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">03</span>_T1,</a>
<a class="sourceLine" id="cb48-10" title="10">  <span class="st">&#39;reminder of plan&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">04</span>_T1,</a>
<a class="sourceLine" id="cb48-11" title="11">  <span class="st">&#39;subgoals&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">05</span>_T1,</a>
<a class="sourceLine" id="cb48-12" title="12">  <span class="st">&#39;trying new PA&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">06</span>_T1,</a>
<a class="sourceLine" id="cb48-13" title="13">  <span class="st">&#39;barrier identification&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">07</span>_T1,</a>
<a class="sourceLine" id="cb48-14" title="14">  <span class="st">&#39;problem solving&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">08</span>_T1,</a>
<a class="sourceLine" id="cb48-15" title="15">  <span class="st">&#39;PA identity reflection&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">09</span>_T1,</a>
<a class="sourceLine" id="cb48-16" title="16">  <span class="st">&#39;aligning PA with life values&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">10</span>_T1,</a>
<a class="sourceLine" id="cb48-17" title="17">  <span class="st">&#39;remind of PA benefits&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">01</span>_T1,</a>
<a class="sourceLine" id="cb48-18" title="18">  <span class="st">&#39;self-monitor (paper)&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">02</span>_T1,</a>
<a class="sourceLine" id="cb48-19" title="19">  <span class="st">&#39;self-monitor (app)&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">03</span>_T1,</a>
<a class="sourceLine" id="cb48-20" title="20"><span class="co">#  &#39;memory cues&#39; = PA_frequencyDependentBCT_04_T1, # Issues with clarity of item wording </span></a>
<a class="sourceLine" id="cb48-21" title="21">  <span class="st">&#39;goal review&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">05</span>_T1,</a>
<a class="sourceLine" id="cb48-22" title="22">  <span class="st">&#39;personal relevance reflection&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">06</span>_T1,</a>
<a class="sourceLine" id="cb48-23" title="23">  <span class="st">&#39;environmental changes (home)&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">07</span>_T1,</a>
<a class="sourceLine" id="cb48-24" title="24">  <span class="st">&#39;social support&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">08</span>_T1,</a>
<a class="sourceLine" id="cb48-25" title="25">  <span class="st">&#39;analysing goal failure&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">09</span>_T1,</a>
<a class="sourceLine" id="cb48-26" title="26">  <span class="st">&#39;MVPA questionnaire&#39;</span> =<span class="st"> </span>padaysLastweek_T1,</a>
<a class="sourceLine" id="cb48-27" title="27">  <span class="st">&#39;MVPA accelerometer&#39;</span> =<span class="st"> </span>mvpaAccelerometer_T1,</a>
<a class="sourceLine" id="cb48-28" title="28">  <span class="st">&#39;intrinsic&#39;</span> =<span class="st"> </span>PA_intrinsic_T1,</a>
<a class="sourceLine" id="cb48-29" title="29">  <span class="st">&#39;identified&#39;</span> =<span class="st"> </span>PA_identified_T1,</a>
<a class="sourceLine" id="cb48-30" title="30">  <span class="st">&#39;controlled motivation&#39;</span> =<span class="st"> </span>PA_controlled_T1) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb48-31" title="31"><span class="st"> </span><span class="kw">rowwise</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb48-32" title="32"><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">transmute</span>(</a>
<a class="sourceLine" id="cb48-33" title="33">  <span class="co"># &#39;goal setting&#39; = ifelse(`goal setting` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb48-34" title="34">  <span class="co"># &#39;has plan&#39; = ifelse(`own plan` == 1 &amp; `plan by other` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb48-35" title="35">  <span class="co"># &#39;own plan&#39; = ifelse(`own plan` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb48-36" title="36">  <span class="co"># &#39;plan by other&#39; = ifelse(`plan by other` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb48-37" title="37">  <span class="co"># &#39;reminder of plan&#39; = ifelse(`reminder of plan` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb48-38" title="38">  <span class="co"># &#39;subgoals&#39; = ifelse(`subgoals` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb48-39" title="39">  <span class="co"># &#39;trying new PA&#39; = ifelse(`trying new PA` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb48-40" title="40">  <span class="co"># &#39;barrier identification&#39; = ifelse(`barrier identification` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb48-41" title="41">  <span class="co"># &#39;problem solving&#39; = ifelse(`problem solving` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb48-42" title="42">  <span class="co"># &#39;barriers identified or planned for&#39; = ifelse(`problem solving` == 1 &amp; `barrier identification` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb48-43" title="43"> <span class="st">&#39;PA identity reflection&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">PA identity reflection</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb48-44" title="44"> <span class="st">&#39;aligning PA with life values&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">aligning PA with life values</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb48-45" title="45">  <span class="co"># &#39;identity, life values&#39; = ifelse(`PA identity reflection` == 1 &amp; `aligning PA with life values` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb48-46" title="46">  <span class="st">&#39;remind of PA benefits&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">remind of PA benefits</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb48-47" title="47">  <span class="co"># &#39;monitoring PA&#39; = ifelse(`self-monitor (paper)` == 1 &amp; `self-monitor (app)` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb48-48" title="48">  <span class="co"># &#39;memory cues&#39; = ifelse(`memory cues` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb48-49" title="49">  <span class="co"># &#39;goal review&#39; = ifelse(`goal review` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb48-50" title="50">  <span class="st">&#39;personal relevance reflection&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">personal relevance reflection</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb48-51" title="51">  <span class="co"># &#39;environmental changes (home)&#39; = ifelse(`environmental changes (home)` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb48-52" title="52">  <span class="co"># &#39;social support&#39; = ifelse(`social support` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb48-53" title="53">  <span class="co"># &#39;analysing goal failure&#39; = ifelse(`analysing goal failure` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb48-54" title="54">  <span class="st">&#39;autonomous motivation&#39;</span> =<span class="st"> </span><span class="kw">mean</span>(<span class="kw">c</span>(identified, intrinsic), <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb48-55" title="55"><span class="co">#  &#39;girl&#39; = ifelse(girl == &quot;girl&quot;, 1, 0),</span></a>
<a class="sourceLine" id="cb48-56" title="56">  <span class="st">&#39;controlled motivation&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">controlled motivation</span><span class="st">`</span> <span class="op">&lt;</span><span class="st"> </span><span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">1</span>), <span class="co"># If &quot;at least partly&quot; or more true, input 1. Normality otherwise a problem.</span></a>
<a class="sourceLine" id="cb48-57" title="57">  <span class="st">&#39;MVPA questionnaire&#39;</span> =<span class="st"> `</span><span class="dt">MVPA questionnaire</span><span class="st">`</span> <span class="op">*</span><span class="st"> </span><span class="dv">1</span>, </a>
<a class="sourceLine" id="cb48-58" title="58">  <span class="st">&#39;MVPA accelerometer&#39;</span> =<span class="st"> `</span><span class="dt">MVPA accelerometer</span><span class="st">`</span> <span class="op">*</span><span class="st"> </span><span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st">  </span></a>
<a class="sourceLine" id="cb48-59" title="59"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="st">&#39;MVPA questionnaire&#39;</span>, <span class="st">&#39;MVPA accelerometer&#39;</span>, <span class="kw">everything</span>()) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb48-60" title="60"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span><span class="st">&#39;autonomous motivation&#39;</span>, <span class="op">-</span><span class="st">&#39;controlled motivation&#39;</span>)</a>
<a class="sourceLine" id="cb48-61" title="61"></a>
<a class="sourceLine" id="cb48-62" title="62"><span class="co"># bctdf_mgm$`autonomous motivation`[is.nan(bctdf_mgm$`autonomous motivation`)] &lt;- NA</span></a>
<a class="sourceLine" id="cb48-63" title="63"></a>
<a class="sourceLine" id="cb48-64" title="64">labs &lt;-<span class="st"> </span><span class="kw">names</span>(bctdf_mgm)</a>
<a class="sourceLine" id="cb48-65" title="65"></a>
<a class="sourceLine" id="cb48-66" title="66">bctdf_mgm &lt;-<span class="st"> </span>bctdf_mgm <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">na.omit</span>(.)</a>
<a class="sourceLine" id="cb48-67" title="67"><span class="co"># bctdf_mgm %&gt;% names()</span></a>
<a class="sourceLine" id="cb48-68" title="68">mgm_variable_types &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;g&quot;</span>, <span class="st">&quot;g&quot;</span>, <span class="kw">rep</span>(<span class="st">&quot;c&quot;</span>, <span class="dv">4</span>))</a>
<a class="sourceLine" id="cb48-69" title="69">mgm_variable_levels &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;1&quot;</span>, <span class="st">&quot;1&quot;</span>, <span class="kw">rep</span>(<span class="st">&quot;2&quot;</span>, <span class="dv">4</span>))</a>
<a class="sourceLine" id="cb48-70" title="70"><span class="co"># data.frame(mgm_variable_types, mgm_variable_levels, names(bctdf_mgm))</span></a>
<a class="sourceLine" id="cb48-71" title="71"></a>
<a class="sourceLine" id="cb48-72" title="72">mgm_obj &lt;-<span class="st"> </span>mgm<span class="op">::</span><span class="kw">mgm</span>(<span class="dt">data =</span> bctdf_mgm,</a>
<a class="sourceLine" id="cb48-73" title="73">  <span class="dt">type =</span> mgm_variable_types,</a>
<a class="sourceLine" id="cb48-74" title="74">  <span class="dt">level =</span> mgm_variable_levels,</a>
<a class="sourceLine" id="cb48-75" title="75">  <span class="dt">lambdaSel =</span> <span class="st">&quot;CV&quot;</span>,</a>
<a class="sourceLine" id="cb48-76" title="76">  <span class="dt">lambdaFolds =</span> <span class="dv">10</span>,</a>
<a class="sourceLine" id="cb48-77" title="77">  <span class="dt">pbar =</span> <span class="ot">FALSE</span>, </a>
<a class="sourceLine" id="cb48-78" title="78">  <span class="dt">binarySign =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb48-79" title="79"><span class="co">## Note that the sign of parameter estimates is stored separately; see ?mgm</span></a>
<a class="sourceLine" id="cb48-80" title="80"></a>
<a class="sourceLine" id="cb48-81" title="81">pred_obj &lt;-<span class="st"> </span><span class="kw">predict</span>(<span class="dt">object =</span> mgm_obj,</a>
<a class="sourceLine" id="cb48-82" title="82">                         <span class="dt">data =</span> bctdf_mgm)</a>
<a class="sourceLine" id="cb48-83" title="83"></a>
<a class="sourceLine" id="cb48-84" title="84">pred_obj<span class="op">$</span>errors</a></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Variable"],"name":[1],"type":["chr"],"align":["left"]},{"label":["RMSE"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["R2"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["CC"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["nCC"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["CCmarg"],"name":[6],"type":["dbl"],"align":["right"]}],"data":[{"1":"MVPA questionnaire","2":"0.918","3":"0.157","4":"NA","5":"NA","6":"NA","_rn_":"1"},{"1":"MVPA accelerometer","2":"0.952","3":"0.092","4":"NA","5":"NA","6":"NA","_rn_":"2"},{"1":"PA identity reflection","2":"NA","3":"NA","4":"0.908","5":"0.460","6":"0.830","_rn_":"3"},{"1":"aligning PA with life values","2":"NA","3":"NA","4":"0.909","5":"0.504","6":"0.817","_rn_":"4"},{"1":"remind of PA benefits","2":"NA","3":"NA","4":"0.891","5":"0.202","6":"0.863","_rn_":"5"},{"1":"personal relevance reflection","2":"NA","3":"NA","4":"0.859","5":"0.389","6":"0.769","_rn_":"6"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb49-1" title="1"></a>
<a class="sourceLine" id="cb49-2" title="2"><span class="co"># Take R2 from gaussian, CC from categorical variables </span></a>
<a class="sourceLine" id="cb49-3" title="3">pie_errors &lt;-<span class="st"> </span><span class="kw">c</span>(pred_obj<span class="op">$</span>errors[<span class="dv">1</span>, <span class="dv">3</span>],</a>
<a class="sourceLine" id="cb49-4" title="4">                pred_obj<span class="op">$</span>errors[<span class="dv">2</span>, <span class="dv">3</span>],</a>
<a class="sourceLine" id="cb49-5" title="5">                pred_obj<span class="op">$</span>errors[<span class="dv">3</span><span class="op">:</span><span class="dv">6</span>, <span class="dv">4</span>])</a>
<a class="sourceLine" id="cb49-6" title="6"></a>
<a class="sourceLine" id="cb49-7" title="7"><span class="co"># Coloring nodes: make a sequence of colors from the viridis palette. We need three colors (MVPA, BCTs, motivation), and &quot;begin&quot; from ones that are not too dark, so that black text shows up ok.</span></a>
<a class="sourceLine" id="cb49-8" title="8"></a>
<a class="sourceLine" id="cb49-9" title="9">node_colors &lt;-<span class="st"> </span><span class="kw">c</span>(viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">3</span>, <span class="dt">begin =</span> <span class="fl">0.4</span>, <span class="dt">end =</span> <span class="fl">0.99</span>)[<span class="dv">1</span>], <span class="co"># Color 1 for MVPA (questionnaire)</span></a>
<a class="sourceLine" id="cb49-10" title="10">                 viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">3</span>, <span class="dt">begin =</span> <span class="fl">0.4</span>, <span class="dt">end =</span> <span class="fl">0.99</span>)[<span class="dv">1</span>], <span class="co"># Color 1 for MVPA (accelerometer)</span></a>
<a class="sourceLine" id="cb49-11" title="11">                 <span class="kw">rep</span>(viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">3</span>, <span class="dt">begin =</span> <span class="fl">0.4</span>, <span class="dt">end =</span> <span class="fl">0.99</span>)[<span class="dv">2</span>], <span class="dv">4</span>)) <span class="co"># 4x Color 2 for BCTs</span></a>
<a class="sourceLine" id="cb49-12" title="12"></a>
<a class="sourceLine" id="cb49-13" title="13">BCT_mgm &lt;-<span class="st"> </span>qgraph<span class="op">::</span><span class="kw">qgraph</span>(mgm_obj<span class="op">$</span>pairwise<span class="op">$</span>wadj, </a>
<a class="sourceLine" id="cb49-14" title="14">            <span class="dt">layout =</span> <span class="st">&quot;spring&quot;</span>,</a>
<a class="sourceLine" id="cb49-15" title="15">            <span class="dt">repulsion =</span> <span class="fl">0.99</span>, <span class="co"># To nudge the network from originally bad visual state</span></a>
<a class="sourceLine" id="cb49-16" title="16">            <span class="dt">title =</span> <span class="st">&quot;cognitive/motivational BCTs, PA &amp; motivation&quot;</span>,</a>
<a class="sourceLine" id="cb49-17" title="17">            <span class="dt">edge.color =</span> <span class="kw">ifelse</span>(mgm_obj<span class="op">$</span>pairwise<span class="op">$</span>edgecolor <span class="op">==</span><span class="st"> &quot;darkgreen&quot;</span>, <span class="st">&quot;blue&quot;</span>, mgm_obj<span class="op">$</span>pairwise<span class="op">$</span>edgecolor),</a>
<a class="sourceLine" id="cb49-18" title="18">            <span class="dt">pie =</span> pie_errors,</a>
<a class="sourceLine" id="cb49-19" title="19">            <span class="dt">pieColor =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">5</span>, <span class="dt">begin =</span> <span class="fl">0.3</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">5</span>],</a>
<a class="sourceLine" id="cb49-20" title="20">            <span class="dt">color =</span> node_colors,</a>
<a class="sourceLine" id="cb49-21" title="21">            <span class="dt">labels =</span> <span class="kw">names</span>(bctdf_mgm),</a>
<a class="sourceLine" id="cb49-22" title="22">            <span class="dt">label.cex =</span> <span class="fl">0.75</span>,</a>
<a class="sourceLine" id="cb49-23" title="23">            <span class="dt">label.scale =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<p><img src="baseline-networks_files/figure-html/cognitiveBCTs_collider1-1.png" width="2100" /></p>
<p>Keeping only the three items showing a presumable conditioning on a collider effect, does not lend support for the simple collider hypothesis with these variables.</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb50-1" title="1">bctdf_mgm &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(</a>
<a class="sourceLine" id="cb50-2" title="2"><span class="co">#  id,</span></a>
<a class="sourceLine" id="cb50-3" title="3"><span class="co">#  intervention,</span></a>
<a class="sourceLine" id="cb50-4" title="4"><span class="co">#  group,</span></a>
<a class="sourceLine" id="cb50-5" title="5"><span class="co">#  school,</span></a>
<a class="sourceLine" id="cb50-6" title="6"><span class="co">#  girl,</span></a>
<a class="sourceLine" id="cb50-7" title="7">  <span class="st">&#39;goal setting&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">01</span>_T1,</a>
<a class="sourceLine" id="cb50-8" title="8">  <span class="st">&#39;own plan&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">02</span>_T1,</a>
<a class="sourceLine" id="cb50-9" title="9">  <span class="st">&#39;plan by other&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">03</span>_T1,</a>
<a class="sourceLine" id="cb50-10" title="10">  <span class="st">&#39;reminder of plan&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">04</span>_T1,</a>
<a class="sourceLine" id="cb50-11" title="11">  <span class="st">&#39;subgoals&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">05</span>_T1,</a>
<a class="sourceLine" id="cb50-12" title="12">  <span class="st">&#39;trying new PA&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">06</span>_T1,</a>
<a class="sourceLine" id="cb50-13" title="13">  <span class="st">&#39;barrier identification&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">07</span>_T1,</a>
<a class="sourceLine" id="cb50-14" title="14">  <span class="st">&#39;problem solving&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">08</span>_T1,</a>
<a class="sourceLine" id="cb50-15" title="15">  <span class="st">&#39;PA identity reflection&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">09</span>_T1,</a>
<a class="sourceLine" id="cb50-16" title="16">  <span class="st">&#39;aligning PA with life values&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">10</span>_T1,</a>
<a class="sourceLine" id="cb50-17" title="17">  <span class="st">&#39;remind of PA benefits&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">01</span>_T1,</a>
<a class="sourceLine" id="cb50-18" title="18">  <span class="st">&#39;self-monitor (paper)&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">02</span>_T1,</a>
<a class="sourceLine" id="cb50-19" title="19">  <span class="st">&#39;self-monitor (app)&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">03</span>_T1,</a>
<a class="sourceLine" id="cb50-20" title="20"><span class="co">#  &#39;memory cues&#39; = PA_frequencyDependentBCT_04_T1, # Issues with clarity of item wording </span></a>
<a class="sourceLine" id="cb50-21" title="21">  <span class="st">&#39;goal review&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">05</span>_T1,</a>
<a class="sourceLine" id="cb50-22" title="22">  <span class="st">&#39;personal relevance reflection&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">06</span>_T1,</a>
<a class="sourceLine" id="cb50-23" title="23">  <span class="st">&#39;environmental changes (home)&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">07</span>_T1,</a>
<a class="sourceLine" id="cb50-24" title="24">  <span class="st">&#39;social support&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">08</span>_T1,</a>
<a class="sourceLine" id="cb50-25" title="25">  <span class="st">&#39;analysing goal failure&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">09</span>_T1,</a>
<a class="sourceLine" id="cb50-26" title="26">  <span class="st">&#39;MVPA questionnaire&#39;</span> =<span class="st"> </span>padaysLastweek_T1,</a>
<a class="sourceLine" id="cb50-27" title="27">  <span class="st">&#39;MVPA accelerometer&#39;</span> =<span class="st"> </span>mvpaAccelerometer_T1,</a>
<a class="sourceLine" id="cb50-28" title="28">  <span class="st">&#39;intrinsic&#39;</span> =<span class="st"> </span>PA_intrinsic_T1,</a>
<a class="sourceLine" id="cb50-29" title="29">  <span class="st">&#39;identified&#39;</span> =<span class="st"> </span>PA_identified_T1,</a>
<a class="sourceLine" id="cb50-30" title="30">  <span class="st">&#39;controlled motivation&#39;</span> =<span class="st"> </span>PA_controlled_T1) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb50-31" title="31"><span class="st"> </span><span class="kw">rowwise</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb50-32" title="32"><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">transmute</span>(</a>
<a class="sourceLine" id="cb50-33" title="33">  <span class="co"># &#39;goal setting&#39; = ifelse(`goal setting` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb50-34" title="34">  <span class="co"># &#39;has plan&#39; = ifelse(`own plan` == 1 &amp; `plan by other` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb50-35" title="35">  <span class="co"># &#39;own plan&#39; = ifelse(`own plan` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb50-36" title="36">  <span class="co"># &#39;plan by other&#39; = ifelse(`plan by other` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb50-37" title="37">  <span class="co"># &#39;reminder of plan&#39; = ifelse(`reminder of plan` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb50-38" title="38">  <span class="co"># &#39;subgoals&#39; = ifelse(`subgoals` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb50-39" title="39">  <span class="co"># &#39;trying new PA&#39; = ifelse(`trying new PA` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb50-40" title="40">  <span class="co"># &#39;barrier identification&#39; = ifelse(`barrier identification` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb50-41" title="41">  <span class="co"># &#39;problem solving&#39; = ifelse(`problem solving` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb50-42" title="42">  <span class="co"># &#39;barriers identified or planned for&#39; = ifelse(`problem solving` == 1 &amp; `barrier identification` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb50-43" title="43"> <span class="co"># &#39;PA identity reflection&#39; = ifelse(`PA identity reflection` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb50-44" title="44"> <span class="st">&#39;aligning PA with life values&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">aligning PA with life values</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb50-45" title="45">  <span class="co"># &#39;identity, life values&#39; = ifelse(`PA identity reflection` == 1 &amp; `aligning PA with life values` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb50-46" title="46">  <span class="st">&#39;remind of PA benefits&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">remind of PA benefits</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb50-47" title="47">  <span class="co"># &#39;monitoring PA&#39; = ifelse(`self-monitor (paper)` == 1 &amp; `self-monitor (app)` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb50-48" title="48">  <span class="co"># &#39;memory cues&#39; = ifelse(`memory cues` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb50-49" title="49">  <span class="co"># &#39;goal review&#39; = ifelse(`goal review` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb50-50" title="50">  <span class="st">&#39;personal relevance reflection&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">personal relevance reflection</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb50-51" title="51">  <span class="co"># &#39;environmental changes (home)&#39; = ifelse(`environmental changes (home)` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb50-52" title="52">  <span class="co"># &#39;social support&#39; = ifelse(`social support` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb50-53" title="53">  <span class="co"># &#39;analysing goal failure&#39; = ifelse(`analysing goal failure` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb50-54" title="54">  <span class="st">&#39;autonomous motivation&#39;</span> =<span class="st"> </span><span class="kw">mean</span>(<span class="kw">c</span>(identified, intrinsic), <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb50-55" title="55"><span class="co">#  &#39;girl&#39; = ifelse(girl == &quot;girl&quot;, 1, 0),</span></a>
<a class="sourceLine" id="cb50-56" title="56">  <span class="st">&#39;controlled motivation&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">controlled motivation</span><span class="st">`</span> <span class="op">&lt;</span><span class="st"> </span><span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">1</span>), <span class="co"># If &quot;at least partly&quot; or more true, input 1. Normality otherwise a problem.</span></a>
<a class="sourceLine" id="cb50-57" title="57">  <span class="st">&#39;MVPA questionnaire&#39;</span> =<span class="st"> `</span><span class="dt">MVPA questionnaire</span><span class="st">`</span> <span class="op">*</span><span class="st"> </span><span class="dv">1</span>, </a>
<a class="sourceLine" id="cb50-58" title="58">  <span class="st">&#39;MVPA accelerometer&#39;</span> =<span class="st"> `</span><span class="dt">MVPA accelerometer</span><span class="st">`</span> <span class="op">*</span><span class="st"> </span><span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st">  </span></a>
<a class="sourceLine" id="cb50-59" title="59"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="st">&#39;MVPA questionnaire&#39;</span>, <span class="st">&#39;autonomous motivation&#39;</span>, <span class="st">&#39;remind of PA benefits&#39;</span>)</a>
<a class="sourceLine" id="cb50-60" title="60"></a>
<a class="sourceLine" id="cb50-61" title="61">bctdf_mgm<span class="op">$</span><span class="st">`</span><span class="dt">autonomous motivation</span><span class="st">`</span>[<span class="kw">is.nan</span>(bctdf_mgm<span class="op">$</span><span class="st">`</span><span class="dt">autonomous motivation</span><span class="st">`</span>)] &lt;-<span class="st"> </span><span class="ot">NA</span></a>
<a class="sourceLine" id="cb50-62" title="62"></a>
<a class="sourceLine" id="cb50-63" title="63">labs &lt;-<span class="st"> </span><span class="kw">names</span>(bctdf_mgm)</a>
<a class="sourceLine" id="cb50-64" title="64"></a>
<a class="sourceLine" id="cb50-65" title="65">bctdf_mgm &lt;-<span class="st"> </span>bctdf_mgm <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">na.omit</span>(.)</a>
<a class="sourceLine" id="cb50-66" title="66"><span class="co"># bctdf_mgm %&gt;% names()</span></a>
<a class="sourceLine" id="cb50-67" title="67">mgm_variable_types &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;g&quot;</span>, <span class="st">&quot;g&quot;</span>, <span class="st">&quot;c&quot;</span>)</a>
<a class="sourceLine" id="cb50-68" title="68">mgm_variable_levels &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;1&quot;</span>, <span class="st">&quot;1&quot;</span>, <span class="st">&quot;2&quot;</span>)</a>
<a class="sourceLine" id="cb50-69" title="69"><span class="co"># data.frame(mgm_variable_types, mgm_variable_levels, names(bctdf_mgm))</span></a>
<a class="sourceLine" id="cb50-70" title="70"></a>
<a class="sourceLine" id="cb50-71" title="71">mgm_obj &lt;-<span class="st"> </span>mgm<span class="op">::</span><span class="kw">mgm</span>(<span class="dt">data =</span> bctdf_mgm,</a>
<a class="sourceLine" id="cb50-72" title="72">  <span class="dt">type =</span> mgm_variable_types,</a>
<a class="sourceLine" id="cb50-73" title="73">  <span class="dt">level =</span> mgm_variable_levels,</a>
<a class="sourceLine" id="cb50-74" title="74">  <span class="dt">lambdaSel =</span> <span class="st">&quot;CV&quot;</span>,</a>
<a class="sourceLine" id="cb50-75" title="75">  <span class="dt">lambdaFolds =</span> <span class="dv">10</span>,</a>
<a class="sourceLine" id="cb50-76" title="76">  <span class="dt">pbar =</span> <span class="ot">FALSE</span>, </a>
<a class="sourceLine" id="cb50-77" title="77">  <span class="dt">binarySign =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb50-78" title="78"><span class="co">## Note that the sign of parameter estimates is stored separately; see ?mgm</span></a>
<a class="sourceLine" id="cb50-79" title="79"></a>
<a class="sourceLine" id="cb50-80" title="80">pred_obj &lt;-<span class="st"> </span><span class="kw">predict</span>(<span class="dt">object =</span> mgm_obj,</a>
<a class="sourceLine" id="cb50-81" title="81">                         <span class="dt">data =</span> bctdf_mgm)</a>
<a class="sourceLine" id="cb50-82" title="82"></a>
<a class="sourceLine" id="cb50-83" title="83">pred_obj<span class="op">$</span>errors</a></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Variable"],"name":[1],"type":["chr"],"align":["left"]},{"label":["RMSE"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["R2"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["CC"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["nCC"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["CCmarg"],"name":[6],"type":["dbl"],"align":["right"]}],"data":[{"1":"MVPA questionnaire","2":"0.904","3":"0.182","4":"NA","5":"NA","6":"NA","_rn_":"1"},{"1":"autonomous motivation","2":"0.864","3":"0.254","4":"NA","5":"NA","6":"NA","_rn_":"2"},{"1":"remind of PA benefits","2":"NA","3":"NA","4":"0.866","5":"0","6":"0.866","_rn_":"3"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb51-1" title="1"></a>
<a class="sourceLine" id="cb51-2" title="2"><span class="co"># Take R2 from gaussian, CC from categorical variables </span></a>
<a class="sourceLine" id="cb51-3" title="3">pie_errors &lt;-<span class="st"> </span><span class="kw">c</span>(pred_obj<span class="op">$</span>errors[<span class="dv">1</span>, <span class="dv">3</span>],</a>
<a class="sourceLine" id="cb51-4" title="4">                pred_obj<span class="op">$</span>errors[<span class="dv">2</span>, <span class="dv">3</span>],</a>
<a class="sourceLine" id="cb51-5" title="5">                pred_obj<span class="op">$</span>errors[<span class="dv">3</span>, <span class="dv">4</span>])</a>
<a class="sourceLine" id="cb51-6" title="6"></a>
<a class="sourceLine" id="cb51-7" title="7"><span class="co"># Coloring nodes: make a sequence of colors from the viridis palette. We need three colors (MVPA, BCTs, motivation), and &quot;begin&quot; from ones that are not too dark, so that black text shows up ok.</span></a>
<a class="sourceLine" id="cb51-8" title="8"></a>
<a class="sourceLine" id="cb51-9" title="9">node_colors &lt;-<span class="st"> </span><span class="kw">c</span>(viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">3</span>, <span class="dt">begin =</span> <span class="fl">0.4</span>, <span class="dt">end =</span> <span class="fl">0.99</span>)[<span class="dv">1</span>], <span class="co"># Color 1 for MVPA (questionnaire)</span></a>
<a class="sourceLine" id="cb51-10" title="10">                 viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">3</span>, <span class="dt">begin =</span> <span class="fl">0.4</span>, <span class="dt">end =</span> <span class="fl">0.99</span>)[<span class="dv">3</span>], <span class="co"># Color 3 for motivation (autonomous) </span></a>
<a class="sourceLine" id="cb51-11" title="11">                 viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">3</span>, <span class="dt">begin =</span> <span class="fl">0.4</span>, <span class="dt">end =</span> <span class="fl">0.99</span>)[<span class="dv">2</span>]) <span class="co"># Color 2 for BCTs</span></a>
<a class="sourceLine" id="cb51-12" title="12"></a>
<a class="sourceLine" id="cb51-13" title="13">BCT_mgm &lt;-<span class="st"> </span>qgraph<span class="op">::</span><span class="kw">qgraph</span>(mgm_obj<span class="op">$</span>pairwise<span class="op">$</span>wadj, </a>
<a class="sourceLine" id="cb51-14" title="14">            <span class="dt">layout =</span> <span class="st">&quot;spring&quot;</span>,</a>
<a class="sourceLine" id="cb51-15" title="15">            <span class="dt">repulsion =</span> <span class="fl">0.99</span>, <span class="co"># To nudge the network from originally bad visual state</span></a>
<a class="sourceLine" id="cb51-16" title="16">            <span class="dt">title =</span> <span class="st">&quot;cognitive/motivational BCTs, PA &amp; motivation&quot;</span>,</a>
<a class="sourceLine" id="cb51-17" title="17">            <span class="dt">edge.color =</span> <span class="kw">ifelse</span>(mgm_obj<span class="op">$</span>pairwise<span class="op">$</span>edgecolor <span class="op">==</span><span class="st"> &quot;darkgreen&quot;</span>, <span class="st">&quot;blue&quot;</span>, mgm_obj<span class="op">$</span>pairwise<span class="op">$</span>edgecolor),</a>
<a class="sourceLine" id="cb51-18" title="18">            <span class="dt">pie =</span> pie_errors,</a>
<a class="sourceLine" id="cb51-19" title="19">            <span class="dt">pieColor =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">5</span>, <span class="dt">begin =</span> <span class="fl">0.3</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">5</span>],</a>
<a class="sourceLine" id="cb51-20" title="20">            <span class="dt">color =</span> node_colors,</a>
<a class="sourceLine" id="cb51-21" title="21">            <span class="dt">labels =</span> <span class="kw">names</span>(bctdf_mgm),</a>
<a class="sourceLine" id="cb51-22" title="22">            <span class="dt">label.cex =</span> <span class="fl">0.75</span>,</a>
<a class="sourceLine" id="cb51-23" title="23">            <span class="dt">label.scale =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<p><img src="baseline-networks_files/figure-html/cognitiveBCTs_collider2-1.png" width="2100" /></p>
</div>
</div>
<div id="environmental-variables-group-opportunities" class="section level1">
<h1>Environmental variables (group, opportunities)</h1>
<p>Environmental opportunities include having enough money to be physically active, biking and hiking tracks in one’s environment, needed PA equipment (gear), facilities for being physically active (such as sports halls/centres, gyms) nearby, not feeling like lack of PA gear is an obstackle for being active, not being too busy with school, hobbies and/or friends, having good opportunities to be active at home, and not feeling like one’s family or religion restricts their activity.</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb52-1" title="1">environmentdf_mgm_T1 &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb52-2" title="2"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="st">&#39;group feels safe&#39;</span> =<span class="st"> </span>groupFeelsSafe_T1,</a>
<a class="sourceLine" id="cb52-3" title="3">  <span class="st">&#39;group listens to me&#39;</span> =<span class="st"> </span>groupListensToMe_T1,</a>
<a class="sourceLine" id="cb52-4" title="4">  <span class="st">&#39;group supports me&#39;</span> =<span class="st"> </span>groupSupportsMe_T1,</a>
<a class="sourceLine" id="cb52-5" title="5">  <span class="st">&#39;group understands me&#39;</span> =<span class="st"> </span>groupUnderstandsMe_T1,</a>
<a class="sourceLine" id="cb52-6" title="6">  <span class="st">&#39;group values me&#39;</span> =<span class="st"> </span>groupValuesMe_T1,</a>
<a class="sourceLine" id="cb52-7" title="7">  <span class="st">&quot;enough money&quot;</span> =<span class="st"> </span>PA_opportunities_<span class="dv">01</span>_T1,</a>
<a class="sourceLine" id="cb52-8" title="8">  <span class="st">&quot;biking and hiking tracks&quot;</span> =<span class="st"> </span>PA_opportunities_<span class="dv">02</span>_T1,</a>
<a class="sourceLine" id="cb52-9" title="9">  <span class="st">&quot;has PA gear&quot;</span> =<span class="st"> </span>PA_opportunitiesReverseCoded_<span class="dv">03</span>_T1,</a>
<a class="sourceLine" id="cb52-10" title="10">  <span class="st">&quot;facilities (e.g. gyms)&quot;</span> =<span class="st"> </span>PA_opportunities_<span class="dv">04</span>_T1,</a>
<a class="sourceLine" id="cb52-11" title="11">  <span class="st">&quot;PA gear no obstacle&quot;</span> =<span class="st"> </span>PA_opportunities_<span class="dv">05</span>_T1,</a>
<a class="sourceLine" id="cb52-12" title="12">  <span class="st">&quot;life not too busy&quot;</span> =<span class="st"> </span>PA_opportunitiesReverseCoded_<span class="dv">06</span>_T1,</a>
<a class="sourceLine" id="cb52-13" title="13">  <span class="st">&quot;opportunities at home&quot;</span> =<span class="st"> </span>PA_opportunities_<span class="dv">07</span>_T1,  </a>
<a class="sourceLine" id="cb52-14" title="14">  <span class="st">&quot;religion or family&quot;</span> =<span class="st"> </span>PA_opportunitiesReverseCoded_<span class="dv">08</span>_T1,</a>
<a class="sourceLine" id="cb52-15" title="15">  <span class="st">&#39;MVPA survey&#39;</span> =<span class="st"> </span>padaysLastweek_T1,</a>
<a class="sourceLine" id="cb52-16" title="16">  <span class="st">&#39;MVPA accelerometer&#39;</span> =<span class="st"> </span>mvpaAccelerometer_T1) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb52-17" title="17"><span class="st"> </span><span class="kw">rowwise</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb52-18" title="18"><span class="st"> </span><span class="kw">mutate</span>(<span class="st">&quot;religion or family&quot;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">religion or family</span><span class="st">`</span> <span class="op">&lt;</span><span class="st"> </span><span class="dv">7</span>, <span class="dv">0</span>, <span class="dv">1</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># highly skewed, so dichotomised</span></a>
<a class="sourceLine" id="cb52-19" title="19"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="st">&#39;MVPA survey&#39;</span>, <span class="st">&#39;MVPA accelerometer&#39;</span>, <span class="kw">everything</span>())</a>
<a class="sourceLine" id="cb52-20" title="20"></a>
<a class="sourceLine" id="cb52-21" title="21">labs &lt;-<span class="st"> </span><span class="kw">names</span>(environmentdf_mgm_T1)</a>
<a class="sourceLine" id="cb52-22" title="22"></a>
<a class="sourceLine" id="cb52-23" title="23"><span class="co"># mgm wants full data, see package missForest for imputation methods</span></a>
<a class="sourceLine" id="cb52-24" title="24">environmentdf_mgm_T1 &lt;-<span class="st"> </span>environmentdf_mgm_T1 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">na.omit</span>(.)</a>
<a class="sourceLine" id="cb52-25" title="25"><span class="co"># environmentdf_mgm %&gt;% names()</span></a>
<a class="sourceLine" id="cb52-26" title="26">mgm_variable_types &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">&quot;g&quot;</span>, <span class="dv">14</span>), <span class="kw">rep</span>(<span class="st">&quot;c&quot;</span>, <span class="dv">1</span>))</a>
<a class="sourceLine" id="cb52-27" title="27">mgm_variable_levels &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">&quot;1&quot;</span>, <span class="dv">14</span>), <span class="kw">rep</span>(<span class="st">&quot;2&quot;</span>, <span class="dv">1</span>))</a>
<a class="sourceLine" id="cb52-28" title="28"><span class="co"># data.frame(mgm_variable_types, mgm_variable_levels, names(environmentdf_mgm))</span></a>
<a class="sourceLine" id="cb52-29" title="29"></a>
<a class="sourceLine" id="cb52-30" title="30">mgm_obj_T1 &lt;-<span class="st"> </span>mgm<span class="op">::</span><span class="kw">mgm</span>(<span class="dt">data =</span> environmentdf_mgm_T1,</a>
<a class="sourceLine" id="cb52-31" title="31">  <span class="dt">type =</span> mgm_variable_types,</a>
<a class="sourceLine" id="cb52-32" title="32">  <span class="dt">level =</span> mgm_variable_levels,</a>
<a class="sourceLine" id="cb52-33" title="33">  <span class="dt">lambdaSel =</span> <span class="st">&quot;EBIC&quot;</span>,</a>
<a class="sourceLine" id="cb52-34" title="34">  <span class="co"># lambdaFolds = 10,</span></a>
<a class="sourceLine" id="cb52-35" title="35">  <span class="dt">pbar =</span> <span class="ot">FALSE</span>, </a>
<a class="sourceLine" id="cb52-36" title="36">  <span class="dt">binarySign =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb52-37" title="37"><span class="co">## Note that the sign of parameter estimates is stored separately; see ?mgm</span></a>
<a class="sourceLine" id="cb52-38" title="38"></a>
<a class="sourceLine" id="cb52-39" title="39"><span class="co"># Node pies:</span></a>
<a class="sourceLine" id="cb52-40" title="40"><span class="co"># pies_T1 &lt;- environmentdf_mgm_T1 %&gt;% </span></a>
<a class="sourceLine" id="cb52-41" title="41"><span class="co">#   dplyr::summarise_all(~mean(., na.rm = TRUE)) # results in a series of means, which is ok for dichotomous vars</span></a>
<a class="sourceLine" id="cb52-42" title="42"><span class="co"># pies_T1[1] &lt;- pies_T1[1] / 7</span></a>
<a class="sourceLine" id="cb52-43" title="43"><span class="co"># pies_T1[2] &lt;- pies_T1[2] / max(environmentdf_mgm_T1$`MVPA accelerometer`, na.rm = TRUE)</span></a>
<a class="sourceLine" id="cb52-44" title="44"><span class="co"># pies_T1[20] &lt;- pies_T1[20] / 5</span></a>
<a class="sourceLine" id="cb52-45" title="45"></a>
<a class="sourceLine" id="cb52-46" title="46"></a>
<a class="sourceLine" id="cb52-47" title="47">node_colors &lt;-<span class="st"> </span><span class="kw">c</span>(viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">3</span>, <span class="dt">begin =</span> <span class="fl">0.4</span>, <span class="dt">end =</span> <span class="fl">0.99</span>)[<span class="dv">1</span>], <span class="co"># Color 1 for MVPA (questionnaire)</span></a>
<a class="sourceLine" id="cb52-48" title="48">                 viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">3</span>, <span class="dt">begin =</span> <span class="fl">0.4</span>, <span class="dt">end =</span> <span class="fl">0.99</span>)[<span class="dv">1</span>], <span class="co"># Color 1 for MVPA (accelerometer)</span></a>
<a class="sourceLine" id="cb52-49" title="49">                 <span class="kw">rep</span>(viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">3</span>, <span class="dt">begin =</span> <span class="fl">0.4</span>, <span class="dt">end =</span> <span class="fl">0.99</span>)[<span class="dv">2</span>], <span class="dv">5</span>), <span class="co"># 5x Color 2 for group-variables</span></a>
<a class="sourceLine" id="cb52-50" title="50">                 <span class="kw">rep</span>(viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">3</span>, <span class="dt">begin =</span> <span class="fl">0.4</span>, <span class="dt">end =</span> <span class="fl">0.99</span>)[<span class="dv">3</span>], <span class="dv">8</span>)) <span class="co"># Color 3 for opportunities  </span></a>
<a class="sourceLine" id="cb52-51" title="51"></a>
<a class="sourceLine" id="cb52-52" title="52"><span class="co"># environment_mgm_T1 &lt;- qgraph::qgraph(mgm_obj_T1$pairwise$wadj, </span></a>
<a class="sourceLine" id="cb52-53" title="53"><span class="co">#             layout = &quot;spring&quot;,</span></a>
<a class="sourceLine" id="cb52-54" title="54"><span class="co">#             repulsion = 0.99, # To nudge the network from originally bad visual state</span></a>
<a class="sourceLine" id="cb52-55" title="55"><span class="co">#             edge.color = ifelse(mgm_obj_T1$pairwise$edgecolor == &quot;darkgreen&quot;, &quot;blue&quot;, mgm_obj_T1$pairwise$edgecolor),</span></a>
<a class="sourceLine" id="cb52-56" title="56"><span class="co">#             # pie = pies_T1,</span></a>
<a class="sourceLine" id="cb52-57" title="57"><span class="co">#             # pieColor = pie_colors_T1,</span></a>
<a class="sourceLine" id="cb52-58" title="58"><span class="co">#             pieColor = node_colors,</span></a>
<a class="sourceLine" id="cb52-59" title="59"><span class="co">#             labels = names(environmentdf_mgm_T1),</span></a>
<a class="sourceLine" id="cb52-60" title="60"><span class="co">#             # pieBorder = 1,</span></a>
<a class="sourceLine" id="cb52-61" title="61"><span class="co">#             label.cex = 0.75,</span></a>
<a class="sourceLine" id="cb52-62" title="62"><span class="co">#             cut = 0,</span></a>
<a class="sourceLine" id="cb52-63" title="63"><span class="co">#             edge.labels = TRUE,</span></a>
<a class="sourceLine" id="cb52-64" title="64"><span class="co">#             label.scale = FALSE)</span></a>
<a class="sourceLine" id="cb52-65" title="65"></a>
<a class="sourceLine" id="cb52-66" title="66">environment_mgm_T1_circle &lt;-<span class="st"> </span>qgraph<span class="op">::</span><span class="kw">qgraph</span>(mgm_obj_T1<span class="op">$</span>pairwise<span class="op">$</span>wadj, </a>
<a class="sourceLine" id="cb52-67" title="67">            <span class="dt">layout =</span> <span class="st">&quot;circle&quot;</span>,</a>
<a class="sourceLine" id="cb52-68" title="68">            <span class="dt">title =</span> <span class="st">&quot;Mixed graphical model: PA, group environment &amp; opportunities&quot;</span>,</a>
<a class="sourceLine" id="cb52-69" title="69">            <span class="dt">edge.color =</span> <span class="kw">ifelse</span>(mgm_obj_T1<span class="op">$</span>pairwise<span class="op">$</span>edgecolor <span class="op">==</span><span class="st"> &quot;darkgreen&quot;</span>, <span class="st">&quot;blue&quot;</span>, mgm_obj_T1<span class="op">$</span>pairwise<span class="op">$</span>edgecolor),</a>
<a class="sourceLine" id="cb52-70" title="70">            <span class="co"># pie = pies_T1,</span></a>
<a class="sourceLine" id="cb52-71" title="71">            <span class="co"># pieColor = viridis::viridis(5, begin = 0.3, end = 0.8)[5],</span></a>
<a class="sourceLine" id="cb52-72" title="72">            <span class="dt">color =</span> node_colors,</a>
<a class="sourceLine" id="cb52-73" title="73">            <span class="dt">labels =</span> <span class="kw">names</span>(environmentdf_mgm_T1),</a>
<a class="sourceLine" id="cb52-74" title="74">            <span class="dt">label.cex =</span> <span class="fl">0.75</span>,</a>
<a class="sourceLine" id="cb52-75" title="75">            <span class="dt">cut =</span> <span class="dv">0</span>,</a>
<a class="sourceLine" id="cb52-76" title="76">            <span class="dt">label.scale =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<p><img src="baseline-networks_files/figure-html/unnamed-chunk-7-1.png" width="2100" /></p>
</div>
<div id="exercise-types" class="section level1">
<h1>Exercise types</h1>
<p>The first network is an Ising model with all participants.</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb53-1" title="1"></a>
<a class="sourceLine" id="cb53-2" title="2">exerciseTypes_df &lt;-<span class="st"> </span>lmi <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(Kys0051<span class="fl">.1</span><span class="op">:</span>Kys0064<span class="fl">.1</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb53-3" title="3"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="kw">contains</span>(<span class="st">&quot;.1&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb53-4" title="4"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate_all</span>(<span class="kw">funs</span>(<span class="kw">replace_na</span>(., <span class="dv">0</span>)))</a>
<a class="sourceLine" id="cb53-5" title="5"><span class="co"># exerciseTypes_df$track &lt;- df$track</span></a>
<a class="sourceLine" id="cb53-6" title="6"><span class="co"># exerciseTypes_df$girl &lt;- df$girl</span></a>
<a class="sourceLine" id="cb53-7" title="7"></a>
<a class="sourceLine" id="cb53-8" title="8"><span class="kw">names</span>(exerciseTypes_df) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Team ball games&quot;</span>, </a>
<a class="sourceLine" id="cb53-9" title="9">                             <span class="st">&quot;Other ball games&quot;</span>,</a>
<a class="sourceLine" id="cb53-10" title="10">                             <span class="st">&quot;Gym training&quot;</span>,</a>
<a class="sourceLine" id="cb53-11" title="11">                             <span class="st">&quot;Combat sports&quot;</span>,</a>
<a class="sourceLine" id="cb53-12" title="12">                             <span class="st">&quot;Fitness classes&quot;</span>,</a>
<a class="sourceLine" id="cb53-13" title="13">                             <span class="st">&quot;Home workout&quot;</span>,</a>
<a class="sourceLine" id="cb53-14" title="14">                             <span class="st">&quot;Cycling&quot;</span>,</a>
<a class="sourceLine" id="cb53-15" title="15">                             <span class="st">&quot;Swimming&quot;</span>,</a>
<a class="sourceLine" id="cb53-16" title="16">                             <span class="st">&quot;Walking&quot;</span>,</a>
<a class="sourceLine" id="cb53-17" title="17">                             <span class="st">&quot;Running&quot;</span>,</a>
<a class="sourceLine" id="cb53-18" title="18">                             <span class="st">&quot;Skiing&quot;</span>,</a>
<a class="sourceLine" id="cb53-19" title="19">                             <span class="st">&quot;Roller skating&quot;</span>, </a>
<a class="sourceLine" id="cb53-20" title="20">                             <span class="st">&quot;Horseback riding&quot;</span>,</a>
<a class="sourceLine" id="cb53-21" title="21">                             <span class="st">&quot;Other&quot;</span></a>
<a class="sourceLine" id="cb53-22" title="22">                             )</a>
<a class="sourceLine" id="cb53-23" title="23"></a>
<a class="sourceLine" id="cb53-24" title="24">exerciseTypes_df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">summarise_all</span>(<span class="kw">funs</span>(sum))</a></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["Team ball games"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["Other ball games"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["Gym training"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Combat sports"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["Fitness classes"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["Home workout"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["Cycling"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["Swimming"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["Walking"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["Running"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["Skiing"],"name":[11],"type":["dbl"],"align":["right"]},{"label":["Roller skating"],"name":[12],"type":["dbl"],"align":["right"]},{"label":["Horseback riding"],"name":[13],"type":["dbl"],"align":["right"]},{"label":["Other"],"name":[14],"type":["dbl"],"align":["right"]}],"data":[{"1":"228","2":"65","3":"411","4":"77","5":"59","6":"220","7":"163","8":"100","9":"590","10":"284","11":"42","12":"8","13":"39","14":"119"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb54-1" title="1"></a>
<a class="sourceLine" id="cb54-2" title="2"><span class="co"># Roller skating has only 8 observations; leave out</span></a>
<a class="sourceLine" id="cb54-3" title="3">exerciseTypes_df &lt;-<span class="st"> </span>exerciseTypes_df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span><span class="st">`</span><span class="dt">Roller skating</span><span class="st">`</span>)</a>
<a class="sourceLine" id="cb54-4" title="4"></a>
<a class="sourceLine" id="cb54-5" title="5"><span class="co"># Variable types are muddled, change all to numeric</span></a>
<a class="sourceLine" id="cb54-6" title="6">exerciseTypes_df &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(purrr<span class="op">::</span><span class="kw">map</span>(exerciseTypes_df, <span class="st">`</span><span class="dt">class&lt;-</span><span class="st">`</span>, <span class="kw">c</span>(<span class="st">&quot;numeric&quot;</span>))) </a>
<a class="sourceLine" id="cb54-7" title="7"></a>
<a class="sourceLine" id="cb54-8" title="8"><span class="co"># Change data frame to type tbl to allow for spaces</span></a>
<a class="sourceLine" id="cb54-9" title="9">exerciseTypes_df &lt;-<span class="st"> </span><span class="kw">as.tbl</span>(exerciseTypes_df)</a>
<a class="sourceLine" id="cb54-10" title="10"></a>
<a class="sourceLine" id="cb54-11" title="11"><span class="co"># Take all names, replace the dots with space</span></a>
<a class="sourceLine" id="cb54-12" title="12"><span class="kw">names</span>(exerciseTypes_df) &lt;-<span class="st"> </span>stringr<span class="op">::</span><span class="kw">str_replace_all</span>(<span class="kw">names</span>(exerciseTypes_df), <span class="dt">pattern =</span> <span class="st">&quot;</span><span class="ch">\\</span><span class="st">.&quot;</span>, <span class="dt">replacement =</span> <span class="st">&quot; &quot;</span>)</a>
<a class="sourceLine" id="cb54-13" title="13"></a>
<a class="sourceLine" id="cb54-14" title="14">exerciseTypes_network &lt;-<span class="st"> </span>bootnet<span class="op">::</span><span class="kw">estimateNetwork</span>(exerciseTypes_df, <span class="dt">default=</span><span class="st">&quot;IsingFit&quot;</span>)</a>
<a class="sourceLine" id="cb54-15" title="15"><span class="co">## </span></a>
<a class="sourceLine" id="cb54-16" title="16">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb54-17" title="17"><span class="st">  </span><span class="er">|</span><span class="st">                                                                 </span><span class="er">|</span><span class="st">   </span><span class="dv">0</span>%</a>
<a class="sourceLine" id="cb54-18" title="18">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb54-19" title="19"><span class="st">  </span><span class="er">|=====</span><span class="st">                                                            </span><span class="er">|</span><span class="st">   </span><span class="dv">8</span>%</a>
<a class="sourceLine" id="cb54-20" title="20">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb54-21" title="21"><span class="st">  </span><span class="er">|==========</span><span class="st">                                                       </span><span class="er">|</span><span class="st">  </span><span class="dv">15</span>%</a>
<a class="sourceLine" id="cb54-22" title="22">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb54-23" title="23"><span class="st">  </span><span class="er">|===============</span><span class="st">                                                  </span><span class="er">|</span><span class="st">  </span><span class="dv">23</span>%</a>
<a class="sourceLine" id="cb54-24" title="24">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb54-25" title="25"><span class="st">  </span><span class="er">|====================</span><span class="st">                                             </span><span class="er">|</span><span class="st">  </span><span class="dv">31</span>%</a>
<a class="sourceLine" id="cb54-26" title="26">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb54-27" title="27"><span class="st">  </span><span class="er">|=========================</span><span class="st">                                        </span><span class="er">|</span><span class="st">  </span><span class="dv">38</span>%</a>
<a class="sourceLine" id="cb54-28" title="28">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb54-29" title="29"><span class="st">  </span><span class="er">|==============================</span><span class="st">                                   </span><span class="er">|</span><span class="st">  </span><span class="dv">46</span>%</a>
<a class="sourceLine" id="cb54-30" title="30">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb54-31" title="31"><span class="st">  </span><span class="er">|===================================</span><span class="st">                              </span><span class="er">|</span><span class="st">  </span><span class="dv">54</span>%</a>
<a class="sourceLine" id="cb54-32" title="32">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb54-33" title="33"><span class="st">  </span><span class="er">|========================================</span><span class="st">                         </span><span class="er">|</span><span class="st">  </span><span class="dv">62</span>%</a>
<a class="sourceLine" id="cb54-34" title="34">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb54-35" title="35"><span class="st">  </span><span class="er">|=============================================</span><span class="st">                    </span><span class="er">|</span><span class="st">  </span><span class="dv">69</span>%</a>
<a class="sourceLine" id="cb54-36" title="36">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb54-37" title="37"><span class="st">  </span><span class="er">|==================================================</span><span class="st">               </span><span class="er">|</span><span class="st">  </span><span class="dv">77</span>%</a>
<a class="sourceLine" id="cb54-38" title="38">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb54-39" title="39"><span class="st">  </span><span class="er">|=======================================================</span><span class="st">          </span><span class="er">|</span><span class="st">  </span><span class="dv">85</span>%</a>
<a class="sourceLine" id="cb54-40" title="40">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb54-41" title="41"><span class="st">  </span><span class="er">|============================================================</span><span class="st">     </span><span class="er">|</span><span class="st">  </span><span class="dv">92</span>%</a>
<a class="sourceLine" id="cb54-42" title="42">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb54-43" title="43"><span class="st">  </span><span class="er">|=================================================================|</span><span class="st"> </span><span class="dv">100</span>%</a>
<a class="sourceLine" id="cb54-44" title="44"></a>
<a class="sourceLine" id="cb54-45" title="45"><span class="co"># Create means for filling nodes</span></a>
<a class="sourceLine" id="cb54-46" title="46">piefill &lt;-<span class="st"> </span>exerciseTypes_df <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb54-47" title="47"><span class="st">  </span><span class="kw">summarise_all</span>(<span class="kw">funs</span>(<span class="kw">mean</span>(., <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))) </a>
<a class="sourceLine" id="cb54-48" title="48"></a>
<a class="sourceLine" id="cb54-49" title="49"><span class="co"># Plot network</span></a>
<a class="sourceLine" id="cb54-50" title="50">exerciseTypes_ising &lt;-<span class="st"> </span><span class="kw">plot</span>(</a>
<a class="sourceLine" id="cb54-51" title="51">  exerciseTypes_network, </a>
<a class="sourceLine" id="cb54-52" title="52">  <span class="dt">layout =</span> <span class="st">&quot;spring&quot;</span>, </a>
<a class="sourceLine" id="cb54-53" title="53">  <span class="dt">label.scale =</span> <span class="ot">FALSE</span>, </a>
<a class="sourceLine" id="cb54-54" title="54">  <span class="dt">title =</span> <span class="st">&quot;Ising fit: self-reported exercise types&quot;</span>, </a>
<a class="sourceLine" id="cb54-55" title="55">  <span class="co"># label.cex = 0.75,</span></a>
<a class="sourceLine" id="cb54-56" title="56">  <span class="dt">pie =</span> piefill, </a>
<a class="sourceLine" id="cb54-57" title="57">  <span class="dt">color =</span> <span class="st">&quot;skyblue&quot;</span>,</a>
<a class="sourceLine" id="cb54-58" title="58">  <span class="dt">pieBorder =</span> <span class="dv">1</span>)</a></code></pre></div>
<p><img src="baseline-networks_files/figure-html/exercisetypes-ising-1.png" width="2100" /></p>
<p>Same network, but estimated with mgm:</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb55-1" title="1"></a>
<a class="sourceLine" id="cb55-2" title="2">exerciseTypes_df &lt;-<span class="st"> </span>lmi <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(Kys0051<span class="fl">.1</span><span class="op">:</span>Kys0064<span class="fl">.1</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb55-3" title="3"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="kw">contains</span>(<span class="st">&quot;.1&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb55-4" title="4"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate_all</span>(<span class="kw">funs</span>(<span class="kw">replace_na</span>(., <span class="dv">0</span>)))</a>
<a class="sourceLine" id="cb55-5" title="5"><span class="co"># exerciseTypes_df$track &lt;- df$track</span></a>
<a class="sourceLine" id="cb55-6" title="6"><span class="co"># exerciseTypes_df$girl &lt;- df$girl</span></a>
<a class="sourceLine" id="cb55-7" title="7"><span class="co"># exerciseTypes_df$`PA accelerometer` &lt;- df$mvpaAccelerometer_T1</span></a>
<a class="sourceLine" id="cb55-8" title="8"><span class="co"># exerciseTypes_df$`PA self-report` &lt;- df$padaysLastweek_T1</span></a>
<a class="sourceLine" id="cb55-9" title="9"></a>
<a class="sourceLine" id="cb55-10" title="10"><span class="kw">names</span>(exerciseTypes_df) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Team ball games&quot;</span>, </a>
<a class="sourceLine" id="cb55-11" title="11">                             <span class="st">&quot;Other ball games&quot;</span>,</a>
<a class="sourceLine" id="cb55-12" title="12">                             <span class="st">&quot;Gym training&quot;</span>,</a>
<a class="sourceLine" id="cb55-13" title="13">                             <span class="st">&quot;Combat sports&quot;</span>,</a>
<a class="sourceLine" id="cb55-14" title="14">                             <span class="st">&quot;Fitness classes&quot;</span>,</a>
<a class="sourceLine" id="cb55-15" title="15">                             <span class="st">&quot;Home workout&quot;</span>,</a>
<a class="sourceLine" id="cb55-16" title="16">                             <span class="st">&quot;Cycling&quot;</span>,</a>
<a class="sourceLine" id="cb55-17" title="17">                             <span class="st">&quot;Swimming&quot;</span>,</a>
<a class="sourceLine" id="cb55-18" title="18">                             <span class="st">&quot;Walking&quot;</span>,</a>
<a class="sourceLine" id="cb55-19" title="19">                             <span class="st">&quot;Running&quot;</span>,</a>
<a class="sourceLine" id="cb55-20" title="20">                             <span class="st">&quot;Skiing&quot;</span>,</a>
<a class="sourceLine" id="cb55-21" title="21">                             <span class="st">&quot;Roller skating&quot;</span>,</a>
<a class="sourceLine" id="cb55-22" title="22">                             <span class="st">&quot;Horseback riding&quot;</span>,</a>
<a class="sourceLine" id="cb55-23" title="23">                             <span class="st">&quot;Other&quot;</span></a>
<a class="sourceLine" id="cb55-24" title="24">                             <span class="co"># &quot;PA accelerometer&quot;,</span></a>
<a class="sourceLine" id="cb55-25" title="25">                             <span class="co"># &quot;PA self-report&quot;</span></a>
<a class="sourceLine" id="cb55-26" title="26">                             )</a>
<a class="sourceLine" id="cb55-27" title="27"></a>
<a class="sourceLine" id="cb55-28" title="28"><span class="co"># Roller skating has only 8 observations; leave out</span></a>
<a class="sourceLine" id="cb55-29" title="29">exerciseTypes_df &lt;-<span class="st"> </span>exerciseTypes_df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span><span class="st">`</span><span class="dt">Roller skating</span><span class="st">`</span>)</a>
<a class="sourceLine" id="cb55-30" title="30"></a>
<a class="sourceLine" id="cb55-31" title="31"><span class="co"># Variable types are muddled, change all to numeric</span></a>
<a class="sourceLine" id="cb55-32" title="32">exerciseTypes_df &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(purrr<span class="op">::</span><span class="kw">map</span>(exerciseTypes_df, <span class="st">`</span><span class="dt">class&lt;-</span><span class="st">`</span>, <span class="kw">c</span>(<span class="st">&quot;numeric&quot;</span>))) </a>
<a class="sourceLine" id="cb55-33" title="33"></a>
<a class="sourceLine" id="cb55-34" title="34"><span class="co"># Change data frame to type tbl to allow for spaces</span></a>
<a class="sourceLine" id="cb55-35" title="35">exerciseTypes_df &lt;-<span class="st"> </span><span class="kw">as.tbl</span>(exerciseTypes_df)</a>
<a class="sourceLine" id="cb55-36" title="36"></a>
<a class="sourceLine" id="cb55-37" title="37"><span class="co"># Take all names, replace the dots with space</span></a>
<a class="sourceLine" id="cb55-38" title="38"><span class="kw">names</span>(exerciseTypes_df) &lt;-<span class="st"> </span>stringr<span class="op">::</span><span class="kw">str_replace_all</span>(<span class="kw">names</span>(exerciseTypes_df), <span class="dt">pattern =</span> <span class="st">&quot;</span><span class="ch">\\</span><span class="st">.&quot;</span>, <span class="dt">replacement =</span> <span class="st">&quot; &quot;</span>)</a>
<a class="sourceLine" id="cb55-39" title="39"></a>
<a class="sourceLine" id="cb55-40" title="40"><span class="co"># Remove incomplete cases</span></a>
<a class="sourceLine" id="cb55-41" title="41">exerciseTypes_df_fullobs &lt;-<span class="st"> </span>exerciseTypes_df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">na.omit</span>()</a>
<a class="sourceLine" id="cb55-42" title="42"></a>
<a class="sourceLine" id="cb55-43" title="43"><span class="co"># Tell mgm, that the first 14 variables are categorical and the last two are gaussian</span></a>
<a class="sourceLine" id="cb55-44" title="44">exerciseTypes_df_variable_types &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">&quot;c&quot;</span>, <span class="dv">13</span>))</a>
<a class="sourceLine" id="cb55-45" title="45">exerciseTypes_df_variable_levels &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">&quot;2&quot;</span>, <span class="dv">13</span>))</a>
<a class="sourceLine" id="cb55-46" title="46"><span class="co"># data.frame(exerciseTypes_df_variable_types, exerciseTypes_df_variable_levels, names(exerciseTypes_df))</span></a>
<a class="sourceLine" id="cb55-47" title="47"></a>
<a class="sourceLine" id="cb55-48" title="48">mgm_obj &lt;-<span class="st"> </span>mgm<span class="op">::</span><span class="kw">mgm</span>(<span class="dt">data =</span> exerciseTypes_df_fullobs,</a>
<a class="sourceLine" id="cb55-49" title="49">  <span class="dt">type =</span> exerciseTypes_df_variable_types,</a>
<a class="sourceLine" id="cb55-50" title="50">  <span class="dt">level =</span> exerciseTypes_df_variable_levels,</a>
<a class="sourceLine" id="cb55-51" title="51">  <span class="dt">lambdaSel =</span> <span class="st">&quot;CV&quot;</span>,</a>
<a class="sourceLine" id="cb55-52" title="52">  <span class="dt">lambdaFolds =</span> <span class="dv">10</span>,</a>
<a class="sourceLine" id="cb55-53" title="53">  <span class="dt">pbar =</span> <span class="ot">FALSE</span>, </a>
<a class="sourceLine" id="cb55-54" title="54">  <span class="dt">binarySign =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb55-55" title="55"><span class="co">## Note that the sign of parameter estimates is stored separately; see ?mgm</span></a>
<a class="sourceLine" id="cb55-56" title="56"></a>
<a class="sourceLine" id="cb55-57" title="57">pred_obj &lt;-<span class="st"> </span><span class="kw">predict</span>(<span class="dt">object =</span> mgm_obj,</a>
<a class="sourceLine" id="cb55-58" title="58">                         <span class="dt">data =</span> exerciseTypes_df_fullobs)</a>
<a class="sourceLine" id="cb55-59" title="59"></a>
<a class="sourceLine" id="cb55-60" title="60"><span class="co"># pred_obj$errors</span></a>
<a class="sourceLine" id="cb55-61" title="61"></a>
<a class="sourceLine" id="cb55-62" title="62"><span class="co"># Take R2 from gaussian, CC from categorical variables </span></a>
<a class="sourceLine" id="cb55-63" title="63">pie_errors &lt;-<span class="st"> </span><span class="kw">c</span>(pred_obj<span class="op">$</span>errors[<span class="dv">1</span><span class="op">:</span><span class="dv">13</span>, <span class="dv">4</span>])</a>
<a class="sourceLine" id="cb55-64" title="64"></a>
<a class="sourceLine" id="cb55-65" title="65"><span class="co"># Define node colors</span></a>
<a class="sourceLine" id="cb55-66" title="66">node_colors &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">rep</span>(viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">3</span>, <span class="dt">begin =</span> <span class="fl">0.4</span>, <span class="dt">end =</span> <span class="fl">0.95</span>)[<span class="dv">1</span>], <span class="dv">13</span>))</a>
<a class="sourceLine" id="cb55-67" title="67"></a>
<a class="sourceLine" id="cb55-68" title="68">exerciseTypes_mgm &lt;-<span class="st"> </span>qgraph<span class="op">::</span><span class="kw">qgraph</span>(mgm_obj<span class="op">$</span>pairwise<span class="op">$</span>wadj, </a>
<a class="sourceLine" id="cb55-69" title="69">            <span class="dt">layout =</span> <span class="st">&quot;spring&quot;</span>,</a>
<a class="sourceLine" id="cb55-70" title="70">            <span class="dt">repulsion =</span> <span class="fl">0.999</span>, <span class="co"># To nudge the network from originally bad visual state</span></a>
<a class="sourceLine" id="cb55-71" title="71">            <span class="dt">title =</span> <span class="st">&quot;Mixed graphical model: Types of reported physical activity&quot;</span>,</a>
<a class="sourceLine" id="cb55-72" title="72">            <span class="dt">edge.color =</span> <span class="kw">ifelse</span>(mgm_obj<span class="op">$</span>pairwise<span class="op">$</span>edgecolor <span class="op">==</span><span class="st"> &quot;darkgreen&quot;</span>, <span class="st">&quot;blue&quot;</span>, mgm_obj<span class="op">$</span>pairwise<span class="op">$</span>edgecolor),</a>
<a class="sourceLine" id="cb55-73" title="73">            <span class="dt">pie =</span> pie_errors,</a>
<a class="sourceLine" id="cb55-74" title="74">            <span class="dt">pieColor =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">3</span>, <span class="dt">begin =</span> <span class="fl">0.4</span>, <span class="dt">end =</span> <span class="fl">0.95</span>)[<span class="dv">2</span>],</a>
<a class="sourceLine" id="cb55-75" title="75">            <span class="dt">color =</span> node_colors,</a>
<a class="sourceLine" id="cb55-76" title="76">            <span class="dt">labels =</span> <span class="kw">names</span>(exerciseTypes_df_fullobs),</a>
<a class="sourceLine" id="cb55-77" title="77">            <span class="dt">label.cex =</span> <span class="fl">0.75</span>,</a>
<a class="sourceLine" id="cb55-78" title="78">            <span class="dt">label.scale =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb55-79" title="79">            <span class="dt">label.color =</span> <span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">&quot;black&quot;</span>, <span class="dv">13</span>)))</a></code></pre></div>
<p><img src="baseline-networks_files/figure-html/exercisetypes-mgm-1.png" width="2100" /></p>
<p>Below, we average the layout and plot these networks side-by-side for comparison.</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb56-1" title="1">avglayout &lt;-<span class="st"> </span><span class="kw">averageLayout</span>(exerciseTypes_mgm, exerciseTypes_ising)</a>
<a class="sourceLine" id="cb56-2" title="2"><span class="co">## Error in averageLayout(exerciseTypes_mgm, exerciseTypes_ising): could not find function &quot;averageLayout&quot;</span></a>
<a class="sourceLine" id="cb56-3" title="3"></a>
<a class="sourceLine" id="cb56-4" title="4"><span class="kw">layout</span>(<span class="kw">t</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb56-5" title="5"></a>
<a class="sourceLine" id="cb56-6" title="6">exerciseTypes_ising &lt;-<span class="st"> </span><span class="kw">plot</span>(</a>
<a class="sourceLine" id="cb56-7" title="7">  exerciseTypes_network, </a>
<a class="sourceLine" id="cb56-8" title="8">  <span class="dt">layout =</span> avglayout, </a>
<a class="sourceLine" id="cb56-9" title="9">  <span class="dt">label.scale =</span> <span class="ot">FALSE</span>, </a>
<a class="sourceLine" id="cb56-10" title="10">  <span class="dt">title =</span> <span class="st">&quot;Ising fit (EBIC model selection)&quot;</span>, </a>
<a class="sourceLine" id="cb56-11" title="11">  <span class="dt">label.cex =</span> <span class="fl">0.75</span>,</a>
<a class="sourceLine" id="cb56-12" title="12">  <span class="dt">pie =</span> piefill, </a>
<a class="sourceLine" id="cb56-13" title="13">  <span class="dt">color =</span> <span class="st">&quot;skyblue&quot;</span>,</a>
<a class="sourceLine" id="cb56-14" title="14">  <span class="dt">pieBorder =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb56-15" title="15"><span class="co">## Error in qgraph::qgraph(wMat, labels = labels, directed = directed, parallelEdge = parallelEdge, : object &#39;avglayout&#39; not found</span></a>
<a class="sourceLine" id="cb56-16" title="16"></a>
<a class="sourceLine" id="cb56-17" title="17">exerciseTypes_mgm &lt;-<span class="st"> </span>qgraph<span class="op">::</span><span class="kw">qgraph</span>(mgm_obj<span class="op">$</span>pairwise<span class="op">$</span>wadj, </a>
<a class="sourceLine" id="cb56-18" title="18">            <span class="dt">layout =</span> avglayout,</a>
<a class="sourceLine" id="cb56-19" title="19">            <span class="dt">repulsion =</span> <span class="fl">0.999</span>, <span class="co"># To nudge the network from originally bad visual state</span></a>
<a class="sourceLine" id="cb56-20" title="20">            <span class="dt">title =</span> <span class="st">&quot;Mixed graphical model (Cross-validation)&quot;</span>,</a>
<a class="sourceLine" id="cb56-21" title="21">            <span class="dt">edge.color =</span> <span class="kw">ifelse</span>(mgm_obj<span class="op">$</span>pairwise<span class="op">$</span>edgecolor <span class="op">==</span><span class="st"> &quot;darkgreen&quot;</span>, <span class="st">&quot;blue&quot;</span>, mgm_obj<span class="op">$</span>pairwise<span class="op">$</span>edgecolor),</a>
<a class="sourceLine" id="cb56-22" title="22">            <span class="dt">pie =</span> pie_errors,</a>
<a class="sourceLine" id="cb56-23" title="23">            <span class="dt">pieColor =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">3</span>, <span class="dt">begin =</span> <span class="fl">0.4</span>, <span class="dt">end =</span> <span class="fl">0.95</span>)[<span class="dv">2</span>],</a>
<a class="sourceLine" id="cb56-24" title="24">            <span class="dt">color =</span> node_colors,</a>
<a class="sourceLine" id="cb56-25" title="25">            <span class="dt">labels =</span> <span class="kw">names</span>(exerciseTypes_df_fullobs),</a>
<a class="sourceLine" id="cb56-26" title="26">            <span class="dt">label.cex =</span> <span class="fl">0.75</span>,</a>
<a class="sourceLine" id="cb56-27" title="27">            <span class="dt">label.scale =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb56-28" title="28">            <span class="dt">label.color =</span> <span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">&quot;black&quot;</span>, <span class="dv">13</span>))</a>
<a class="sourceLine" id="cb56-29" title="29">            )</a>
<a class="sourceLine" id="cb56-30" title="30"><span class="co">## Error in qgraph::qgraph(mgm_obj$pairwise$wadj, layout = avglayout, repulsion = 0.999, : object &#39;avglayout&#39; not found</span></a></code></pre></div>
<p>Graph below includes the moderate-to-vigorous physical activity measures, and shows a mixed graphical model with model selection done by cross-validation.</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb57-1" title="1"></a>
<a class="sourceLine" id="cb57-2" title="2">exerciseTypes_df &lt;-<span class="st"> </span>lmi <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(Kys0051<span class="fl">.1</span><span class="op">:</span>Kys0064<span class="fl">.1</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb57-3" title="3"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="kw">contains</span>(<span class="st">&quot;.1&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb57-4" title="4"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate_all</span>(<span class="kw">funs</span>(<span class="kw">replace_na</span>(., <span class="dv">0</span>)))</a>
<a class="sourceLine" id="cb57-5" title="5"><span class="co"># exerciseTypes_df$track &lt;- df$track</span></a>
<a class="sourceLine" id="cb57-6" title="6"><span class="co"># exerciseTypes_df$girl &lt;- df$girl</span></a>
<a class="sourceLine" id="cb57-7" title="7">exerciseTypes_df<span class="op">$</span><span class="st">`</span><span class="dt">PA accelerometer</span><span class="st">`</span> &lt;-<span class="st"> </span>df<span class="op">$</span>mvpaAccelerometer_T1</a>
<a class="sourceLine" id="cb57-8" title="8">exerciseTypes_df<span class="op">$</span><span class="st">`</span><span class="dt">PA self-report</span><span class="st">`</span> &lt;-<span class="st"> </span>df<span class="op">$</span>padaysLastweek_T1</a>
<a class="sourceLine" id="cb57-9" title="9"></a>
<a class="sourceLine" id="cb57-10" title="10"><span class="kw">names</span>(exerciseTypes_df) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Team ball games&quot;</span>, </a>
<a class="sourceLine" id="cb57-11" title="11">                             <span class="st">&quot;Other ball games&quot;</span>,</a>
<a class="sourceLine" id="cb57-12" title="12">                             <span class="st">&quot;Gym training&quot;</span>,</a>
<a class="sourceLine" id="cb57-13" title="13">                             <span class="st">&quot;Combat sports&quot;</span>,</a>
<a class="sourceLine" id="cb57-14" title="14">                             <span class="st">&quot;Fitness classes&quot;</span>,</a>
<a class="sourceLine" id="cb57-15" title="15">                             <span class="st">&quot;Home workout&quot;</span>,</a>
<a class="sourceLine" id="cb57-16" title="16">                             <span class="st">&quot;Cycling&quot;</span>,</a>
<a class="sourceLine" id="cb57-17" title="17">                             <span class="st">&quot;Swimming&quot;</span>,</a>
<a class="sourceLine" id="cb57-18" title="18">                             <span class="st">&quot;Walking&quot;</span>,</a>
<a class="sourceLine" id="cb57-19" title="19">                             <span class="st">&quot;Running&quot;</span>,</a>
<a class="sourceLine" id="cb57-20" title="20">                             <span class="st">&quot;Skiing&quot;</span>,</a>
<a class="sourceLine" id="cb57-21" title="21">                             <span class="st">&quot;Roller skating&quot;</span>,</a>
<a class="sourceLine" id="cb57-22" title="22">                             <span class="st">&quot;Horseback riding&quot;</span>,</a>
<a class="sourceLine" id="cb57-23" title="23">                             <span class="st">&quot;Other&quot;</span>,</a>
<a class="sourceLine" id="cb57-24" title="24">                             <span class="st">&quot;PA accelerometer&quot;</span>,</a>
<a class="sourceLine" id="cb57-25" title="25">                             <span class="st">&quot;PA self-report&quot;</span></a>
<a class="sourceLine" id="cb57-26" title="26">                             )</a>
<a class="sourceLine" id="cb57-27" title="27"></a>
<a class="sourceLine" id="cb57-28" title="28"><span class="co"># Roller skating has only 8 observations; leave out</span></a>
<a class="sourceLine" id="cb57-29" title="29">exerciseTypes_df &lt;-<span class="st"> </span>exerciseTypes_df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span><span class="st">`</span><span class="dt">Roller skating</span><span class="st">`</span>)</a>
<a class="sourceLine" id="cb57-30" title="30"></a>
<a class="sourceLine" id="cb57-31" title="31"><span class="co"># Variable types are muddled, change all to numeric</span></a>
<a class="sourceLine" id="cb57-32" title="32">exerciseTypes_df &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(purrr<span class="op">::</span><span class="kw">map</span>(exerciseTypes_df, <span class="st">`</span><span class="dt">class&lt;-</span><span class="st">`</span>, <span class="kw">c</span>(<span class="st">&quot;numeric&quot;</span>))) </a>
<a class="sourceLine" id="cb57-33" title="33"></a>
<a class="sourceLine" id="cb57-34" title="34"><span class="co"># Change data frame to type tbl to allow for spaces</span></a>
<a class="sourceLine" id="cb57-35" title="35">exerciseTypes_df &lt;-<span class="st"> </span><span class="kw">as.tbl</span>(exerciseTypes_df)</a>
<a class="sourceLine" id="cb57-36" title="36"></a>
<a class="sourceLine" id="cb57-37" title="37"><span class="co"># Take all names, replace the dots with space</span></a>
<a class="sourceLine" id="cb57-38" title="38"><span class="kw">names</span>(exerciseTypes_df) &lt;-<span class="st"> </span>stringr<span class="op">::</span><span class="kw">str_replace_all</span>(<span class="kw">names</span>(exerciseTypes_df), <span class="dt">pattern =</span> <span class="st">&quot;</span><span class="ch">\\</span><span class="st">.&quot;</span>, <span class="dt">replacement =</span> <span class="st">&quot; &quot;</span>)</a>
<a class="sourceLine" id="cb57-39" title="39"></a>
<a class="sourceLine" id="cb57-40" title="40"><span class="co"># Remove incomplete cases</span></a>
<a class="sourceLine" id="cb57-41" title="41">exerciseTypes_df_fullobs &lt;-<span class="st"> </span>exerciseTypes_df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">na.omit</span>()</a>
<a class="sourceLine" id="cb57-42" title="42"></a>
<a class="sourceLine" id="cb57-43" title="43"><span class="co"># Tell mgm, that the first 14 variables are categorical and the last two are gaussian</span></a>
<a class="sourceLine" id="cb57-44" title="44">exerciseTypes_df_variable_types &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">&quot;c&quot;</span>, <span class="dv">13</span>), <span class="kw">rep</span>(<span class="st">&quot;g&quot;</span>, <span class="dv">2</span>))</a>
<a class="sourceLine" id="cb57-45" title="45">exerciseTypes_df_variable_levels &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">&quot;2&quot;</span>, <span class="dv">13</span>), <span class="kw">rep</span>(<span class="st">&quot;1&quot;</span>, <span class="dv">2</span>))</a>
<a class="sourceLine" id="cb57-46" title="46"><span class="co"># data.frame(exerciseTypes_df_variable_types, exerciseTypes_df_variable_levels, names(exerciseTypes_df))</span></a>
<a class="sourceLine" id="cb57-47" title="47"></a>
<a class="sourceLine" id="cb57-48" title="48">mgm_obj_CV &lt;-<span class="st"> </span>mgm<span class="op">::</span><span class="kw">mgm</span>(<span class="dt">data =</span> exerciseTypes_df_fullobs,</a>
<a class="sourceLine" id="cb57-49" title="49">  <span class="dt">type =</span> exerciseTypes_df_variable_types,</a>
<a class="sourceLine" id="cb57-50" title="50">  <span class="dt">level =</span> exerciseTypes_df_variable_levels,</a>
<a class="sourceLine" id="cb57-51" title="51">  <span class="dt">lambdaSel =</span> <span class="st">&quot;CV&quot;</span>,</a>
<a class="sourceLine" id="cb57-52" title="52">  <span class="dt">lambdaFolds =</span> <span class="dv">10</span>,</a>
<a class="sourceLine" id="cb57-53" title="53">  <span class="dt">pbar =</span> <span class="ot">FALSE</span>, </a>
<a class="sourceLine" id="cb57-54" title="54">  <span class="dt">binarySign =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb57-55" title="55"><span class="co">## Note that the sign of parameter estimates is stored separately; see ?mgm</span></a>
<a class="sourceLine" id="cb57-56" title="56"></a>
<a class="sourceLine" id="cb57-57" title="57">pred_obj &lt;-<span class="st"> </span><span class="kw">predict</span>(<span class="dt">object =</span> mgm_obj_CV,</a>
<a class="sourceLine" id="cb57-58" title="58">                         <span class="dt">data =</span> exerciseTypes_df_fullobs)</a>
<a class="sourceLine" id="cb57-59" title="59"></a>
<a class="sourceLine" id="cb57-60" title="60"><span class="co"># pred_obj$errors</span></a>
<a class="sourceLine" id="cb57-61" title="61"></a>
<a class="sourceLine" id="cb57-62" title="62"><span class="co"># Take R2 from gaussian, CC from categorical variables </span></a>
<a class="sourceLine" id="cb57-63" title="63">pie_errors &lt;-<span class="st"> </span><span class="kw">c</span>(pred_obj<span class="op">$</span>errors[<span class="dv">1</span><span class="op">:</span><span class="dv">13</span>, <span class="dv">4</span>],</a>
<a class="sourceLine" id="cb57-64" title="64">                pred_obj<span class="op">$</span>errors[<span class="dv">14</span><span class="op">:</span><span class="dv">15</span>, <span class="dv">3</span>])</a>
<a class="sourceLine" id="cb57-65" title="65"></a>
<a class="sourceLine" id="cb57-66" title="66"><span class="co"># Define node colors</span></a>
<a class="sourceLine" id="cb57-67" title="67">node_colors &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">rep</span>(viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">3</span>, <span class="dt">begin =</span> <span class="fl">0.4</span>, <span class="dt">end =</span> <span class="fl">0.95</span>)[<span class="dv">1</span>], <span class="dv">13</span>),</a>
<a class="sourceLine" id="cb57-68" title="68">                 <span class="kw">rep</span>(viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">3</span>, <span class="dt">begin =</span> <span class="fl">0.4</span>, <span class="dt">end =</span> <span class="fl">0.95</span>)[<span class="dv">3</span>], <span class="dv">2</span>))</a>
<a class="sourceLine" id="cb57-69" title="69"></a>
<a class="sourceLine" id="cb57-70" title="70">exerciseTypes_mgm_withMeasures &lt;-<span class="st"> </span>qgraph<span class="op">::</span><span class="kw">qgraph</span>(mgm_obj_CV<span class="op">$</span>pairwise<span class="op">$</span>wadj, </a>
<a class="sourceLine" id="cb57-71" title="71">            <span class="dt">layout =</span> <span class="st">&quot;spring&quot;</span>,</a>
<a class="sourceLine" id="cb57-72" title="72">            <span class="dt">repulsion =</span> <span class="fl">0.99</span>, <span class="co"># To nudge the network from originally bad visual state</span></a>
<a class="sourceLine" id="cb57-73" title="73">            <span class="dt">title =</span> <span class="st">&quot;Mixed graphical model: Types of reported physical activity and their relations to measured MVPA&quot;</span>,</a>
<a class="sourceLine" id="cb57-74" title="74">            <span class="dt">edge.color =</span> <span class="kw">ifelse</span>(mgm_obj_CV<span class="op">$</span>pairwise<span class="op">$</span>edgecolor <span class="op">==</span><span class="st"> &quot;darkgreen&quot;</span>, <span class="st">&quot;blue&quot;</span>, mgm_obj_CV<span class="op">$</span>pairwise<span class="op">$</span>edgecolor),</a>
<a class="sourceLine" id="cb57-75" title="75">            <span class="dt">pie =</span> pie_errors,</a>
<a class="sourceLine" id="cb57-76" title="76">            <span class="dt">pieColor =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">3</span>, <span class="dt">begin =</span> <span class="fl">0.4</span>, <span class="dt">end =</span> <span class="fl">0.95</span>)[<span class="dv">2</span>],</a>
<a class="sourceLine" id="cb57-77" title="77">            <span class="dt">color =</span> node_colors,</a>
<a class="sourceLine" id="cb57-78" title="78">            <span class="dt">labels =</span> <span class="kw">names</span>(exerciseTypes_df_fullobs),</a>
<a class="sourceLine" id="cb57-79" title="79">            <span class="dt">label.cex =</span> <span class="fl">0.75</span>,</a>
<a class="sourceLine" id="cb57-80" title="80">            <span class="dt">label.scale =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb57-81" title="81">            <span class="dt">label.color =</span> <span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">&quot;black&quot;</span>, <span class="dv">15</span>)))</a></code></pre></div>
<p><img src="baseline-networks_files/figure-html/exercisetypes-mgm-CV-1.png" width="2100" /></p>
<p>The next graph is identical, except that model selection is done by the Extended Bayesian Information Criterion (EBIC).</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb58-1" title="1"></a>
<a class="sourceLine" id="cb58-2" title="2">exerciseTypes_df &lt;-<span class="st"> </span>lmi <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(Kys0051<span class="fl">.1</span><span class="op">:</span>Kys0064<span class="fl">.1</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb58-3" title="3"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="kw">contains</span>(<span class="st">&quot;.1&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb58-4" title="4"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate_all</span>(<span class="kw">funs</span>(<span class="kw">replace_na</span>(., <span class="dv">0</span>)))</a>
<a class="sourceLine" id="cb58-5" title="5"><span class="co"># exerciseTypes_df$track &lt;- df$track</span></a>
<a class="sourceLine" id="cb58-6" title="6"><span class="co"># exerciseTypes_df$girl &lt;- df$girl</span></a>
<a class="sourceLine" id="cb58-7" title="7">exerciseTypes_df<span class="op">$</span><span class="st">`</span><span class="dt">PA accelerometer</span><span class="st">`</span> &lt;-<span class="st"> </span>df<span class="op">$</span>mvpaAccelerometer_T1</a>
<a class="sourceLine" id="cb58-8" title="8">exerciseTypes_df<span class="op">$</span><span class="st">`</span><span class="dt">PA self-report</span><span class="st">`</span> &lt;-<span class="st"> </span>df<span class="op">$</span>padaysLastweek_T1</a>
<a class="sourceLine" id="cb58-9" title="9"></a>
<a class="sourceLine" id="cb58-10" title="10"><span class="kw">names</span>(exerciseTypes_df) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Team ball games&quot;</span>, </a>
<a class="sourceLine" id="cb58-11" title="11">                             <span class="st">&quot;Other ball games&quot;</span>,</a>
<a class="sourceLine" id="cb58-12" title="12">                             <span class="st">&quot;Gym training&quot;</span>,</a>
<a class="sourceLine" id="cb58-13" title="13">                             <span class="st">&quot;Combat sports&quot;</span>,</a>
<a class="sourceLine" id="cb58-14" title="14">                             <span class="st">&quot;Fitness classes&quot;</span>,</a>
<a class="sourceLine" id="cb58-15" title="15">                             <span class="st">&quot;Home workout&quot;</span>,</a>
<a class="sourceLine" id="cb58-16" title="16">                             <span class="st">&quot;Cycling&quot;</span>,</a>
<a class="sourceLine" id="cb58-17" title="17">                             <span class="st">&quot;Swimming&quot;</span>,</a>
<a class="sourceLine" id="cb58-18" title="18">                             <span class="st">&quot;Walking&quot;</span>,</a>
<a class="sourceLine" id="cb58-19" title="19">                             <span class="st">&quot;Running&quot;</span>,</a>
<a class="sourceLine" id="cb58-20" title="20">                             <span class="st">&quot;Skiing&quot;</span>,</a>
<a class="sourceLine" id="cb58-21" title="21">                             <span class="st">&quot;Roller skating&quot;</span>,</a>
<a class="sourceLine" id="cb58-22" title="22">                             <span class="st">&quot;Horseback riding&quot;</span>,</a>
<a class="sourceLine" id="cb58-23" title="23">                             <span class="st">&quot;Other&quot;</span>,</a>
<a class="sourceLine" id="cb58-24" title="24">                             <span class="st">&quot;PA accelerometer&quot;</span>,</a>
<a class="sourceLine" id="cb58-25" title="25">                             <span class="st">&quot;PA self-report&quot;</span></a>
<a class="sourceLine" id="cb58-26" title="26">                             )</a>
<a class="sourceLine" id="cb58-27" title="27"></a>
<a class="sourceLine" id="cb58-28" title="28"><span class="co"># Roller skating has only 8 observations; leave out</span></a>
<a class="sourceLine" id="cb58-29" title="29">exerciseTypes_df &lt;-<span class="st"> </span>exerciseTypes_df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span><span class="st">`</span><span class="dt">Roller skating</span><span class="st">`</span>)</a>
<a class="sourceLine" id="cb58-30" title="30"></a>
<a class="sourceLine" id="cb58-31" title="31"><span class="co"># Variable types are muddled, change all to numeric</span></a>
<a class="sourceLine" id="cb58-32" title="32">exerciseTypes_df &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(purrr<span class="op">::</span><span class="kw">map</span>(exerciseTypes_df, <span class="st">`</span><span class="dt">class&lt;-</span><span class="st">`</span>, <span class="kw">c</span>(<span class="st">&quot;numeric&quot;</span>))) </a>
<a class="sourceLine" id="cb58-33" title="33"></a>
<a class="sourceLine" id="cb58-34" title="34"><span class="co"># Change data frame to type tbl to allow for spaces</span></a>
<a class="sourceLine" id="cb58-35" title="35">exerciseTypes_df &lt;-<span class="st"> </span><span class="kw">as.tbl</span>(exerciseTypes_df)</a>
<a class="sourceLine" id="cb58-36" title="36"></a>
<a class="sourceLine" id="cb58-37" title="37"><span class="co"># Take all names, replace the dots with space</span></a>
<a class="sourceLine" id="cb58-38" title="38"><span class="kw">names</span>(exerciseTypes_df) &lt;-<span class="st"> </span>stringr<span class="op">::</span><span class="kw">str_replace_all</span>(<span class="kw">names</span>(exerciseTypes_df), <span class="dt">pattern =</span> <span class="st">&quot;</span><span class="ch">\\</span><span class="st">.&quot;</span>, <span class="dt">replacement =</span> <span class="st">&quot; &quot;</span>)</a>
<a class="sourceLine" id="cb58-39" title="39"></a>
<a class="sourceLine" id="cb58-40" title="40"><span class="co"># Remove incomplete cases</span></a>
<a class="sourceLine" id="cb58-41" title="41">exerciseTypes_df_fullobs &lt;-<span class="st"> </span>exerciseTypes_df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">na.omit</span>()</a>
<a class="sourceLine" id="cb58-42" title="42"></a>
<a class="sourceLine" id="cb58-43" title="43"><span class="co"># Tell mgm, that the first 14 variables are categorical and the last two are gaussian</span></a>
<a class="sourceLine" id="cb58-44" title="44">exerciseTypes_df_variable_types &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">&quot;c&quot;</span>, <span class="dv">13</span>), <span class="kw">rep</span>(<span class="st">&quot;g&quot;</span>, <span class="dv">2</span>))</a>
<a class="sourceLine" id="cb58-45" title="45">exerciseTypes_df_variable_levels &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">&quot;2&quot;</span>, <span class="dv">13</span>), <span class="kw">rep</span>(<span class="st">&quot;1&quot;</span>, <span class="dv">2</span>))</a>
<a class="sourceLine" id="cb58-46" title="46"><span class="co"># data.frame(exerciseTypes_df_variable_types, exerciseTypes_df_variable_levels, names(exerciseTypes_df))</span></a>
<a class="sourceLine" id="cb58-47" title="47"></a>
<a class="sourceLine" id="cb58-48" title="48">mgm_obj_EBIC &lt;-<span class="st"> </span>mgm<span class="op">::</span><span class="kw">mgm</span>(<span class="dt">data =</span> exerciseTypes_df_fullobs,</a>
<a class="sourceLine" id="cb58-49" title="49">  <span class="dt">type =</span> exerciseTypes_df_variable_types,</a>
<a class="sourceLine" id="cb58-50" title="50">  <span class="dt">level =</span> exerciseTypes_df_variable_levels,</a>
<a class="sourceLine" id="cb58-51" title="51">  <span class="dt">lambdaSel =</span> <span class="st">&quot;EBIC&quot;</span>,</a>
<a class="sourceLine" id="cb58-52" title="52">  <span class="co"># lambdaFolds = 10,</span></a>
<a class="sourceLine" id="cb58-53" title="53">  <span class="dt">pbar =</span> <span class="ot">FALSE</span>, </a>
<a class="sourceLine" id="cb58-54" title="54">  <span class="dt">binarySign =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb58-55" title="55"><span class="co">## Note that the sign of parameter estimates is stored separately; see ?mgm</span></a>
<a class="sourceLine" id="cb58-56" title="56"></a>
<a class="sourceLine" id="cb58-57" title="57">pred_obj2 &lt;-<span class="st"> </span><span class="kw">predict</span>(<span class="dt">object =</span> mgm_obj_EBIC,</a>
<a class="sourceLine" id="cb58-58" title="58">                         <span class="dt">data =</span> exerciseTypes_df_fullobs)</a>
<a class="sourceLine" id="cb58-59" title="59"></a>
<a class="sourceLine" id="cb58-60" title="60"><span class="co"># pred_obj$errors</span></a>
<a class="sourceLine" id="cb58-61" title="61"></a>
<a class="sourceLine" id="cb58-62" title="62"><span class="co"># Take R2 from gaussian, CC from categorical variables </span></a>
<a class="sourceLine" id="cb58-63" title="63">pie_errors2 &lt;-<span class="st"> </span><span class="kw">c</span>(pred_obj2<span class="op">$</span>errors[<span class="dv">1</span><span class="op">:</span><span class="dv">13</span>, <span class="dv">4</span>],</a>
<a class="sourceLine" id="cb58-64" title="64">                pred_obj2<span class="op">$</span>errors[<span class="dv">14</span><span class="op">:</span><span class="dv">15</span>, <span class="dv">3</span>])</a>
<a class="sourceLine" id="cb58-65" title="65"></a>
<a class="sourceLine" id="cb58-66" title="66"><span class="co"># Define node colors</span></a>
<a class="sourceLine" id="cb58-67" title="67">node_colors &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">rep</span>(viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">3</span>, <span class="dt">begin =</span> <span class="fl">0.4</span>, <span class="dt">end =</span> <span class="fl">0.95</span>)[<span class="dv">1</span>], <span class="dv">13</span>),</a>
<a class="sourceLine" id="cb58-68" title="68">                 <span class="kw">rep</span>(viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">3</span>, <span class="dt">begin =</span> <span class="fl">0.4</span>, <span class="dt">end =</span> <span class="fl">0.95</span>)[<span class="dv">3</span>], <span class="dv">2</span>))</a>
<a class="sourceLine" id="cb58-69" title="69"></a>
<a class="sourceLine" id="cb58-70" title="70">exerciseTypes_mgm_withMeasures2 &lt;-<span class="st"> </span>qgraph<span class="op">::</span><span class="kw">qgraph</span>(mgm_obj_EBIC<span class="op">$</span>pairwise<span class="op">$</span>wadj, </a>
<a class="sourceLine" id="cb58-71" title="71">            <span class="dt">layout =</span> <span class="st">&quot;spring&quot;</span>,</a>
<a class="sourceLine" id="cb58-72" title="72">            <span class="dt">repulsion =</span> <span class="fl">0.99</span>, <span class="co"># To nudge the network from originally bad visual state</span></a>
<a class="sourceLine" id="cb58-73" title="73">            <span class="dt">title =</span> <span class="st">&quot;Mixed graphical model: Types of reported physical activity and their relations to measured MVPA&quot;</span>,</a>
<a class="sourceLine" id="cb58-74" title="74">            <span class="dt">edge.color =</span> <span class="kw">ifelse</span>(mgm_obj_EBIC<span class="op">$</span>pairwise<span class="op">$</span>edgecolor <span class="op">==</span><span class="st"> &quot;darkgreen&quot;</span>, <span class="st">&quot;blue&quot;</span>,</a>
<a class="sourceLine" id="cb58-75" title="75">                                mgm_obj_EBIC<span class="op">$</span>pairwise<span class="op">$</span>edgecolor),</a>
<a class="sourceLine" id="cb58-76" title="76">            <span class="dt">pie =</span> pie_errors2,</a>
<a class="sourceLine" id="cb58-77" title="77">            <span class="dt">pieColor =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">3</span>, <span class="dt">begin =</span> <span class="fl">0.4</span>, <span class="dt">end =</span> <span class="fl">0.95</span>)[<span class="dv">2</span>],</a>
<a class="sourceLine" id="cb58-78" title="78">            <span class="dt">color =</span> node_colors,</a>
<a class="sourceLine" id="cb58-79" title="79">            <span class="dt">labels =</span> <span class="kw">names</span>(exerciseTypes_df_fullobs),</a>
<a class="sourceLine" id="cb58-80" title="80">            <span class="dt">label.cex =</span> <span class="fl">0.75</span>,</a>
<a class="sourceLine" id="cb58-81" title="81">            <span class="dt">label.scale =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb58-82" title="82">            <span class="dt">label.color =</span> <span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">&quot;black&quot;</span>, <span class="dv">15</span>)))</a></code></pre></div>
<p><img src="baseline-networks_files/figure-html/exercisetypes-mgm-EBIC-1.png" width="2100" /></p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb59-1" title="1"></a>
<a class="sourceLine" id="cb59-2" title="2"><span class="co"># exerciseTypes_mgm_withMeasures_cor &lt;- qgraph::qgraph(cor_auto(exerciseTypes_df), </span></a>
<a class="sourceLine" id="cb59-3" title="3"><span class="co">#             layout = &quot;spring&quot;,</span></a>
<a class="sourceLine" id="cb59-4" title="4"><span class="co">#             repulsion = 0.99, # To nudge the network from originally bad visual state</span></a>
<a class="sourceLine" id="cb59-5" title="5"><span class="co">#             title = &quot;Bivariate correlations&quot;,</span></a>
<a class="sourceLine" id="cb59-6" title="6"><span class="co">#             pie = pie_errors2,</span></a>
<a class="sourceLine" id="cb59-7" title="7"><span class="co">#             pieColor = viridis::viridis(3, begin = 0.4, end = 0.95)[2],</span></a>
<a class="sourceLine" id="cb59-8" title="8"><span class="co">#             color = node_colors,</span></a>
<a class="sourceLine" id="cb59-9" title="9"><span class="co">#             edge.labels = TRUE,</span></a>
<a class="sourceLine" id="cb59-10" title="10"><span class="co">#             labels = names(exerciseTypes_df),</span></a>
<a class="sourceLine" id="cb59-11" title="11"><span class="co">#             label.cex = 0.75,</span></a>
<a class="sourceLine" id="cb59-12" title="12"><span class="co">#             label.scale = FALSE)</span></a></code></pre></div>
<p>To compare the two previous graphs, we again average the layout and plot them next to each other.</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb60-1" title="1">avglayout &lt;-<span class="st"> </span><span class="kw">averageLayout</span>(exerciseTypes_mgm_withMeasures, exerciseTypes_mgm_withMeasures2)</a>
<a class="sourceLine" id="cb60-2" title="2"><span class="co">## Error in averageLayout(exerciseTypes_mgm_withMeasures, exerciseTypes_mgm_withMeasures2): could not find function &quot;averageLayout&quot;</span></a>
<a class="sourceLine" id="cb60-3" title="3"></a>
<a class="sourceLine" id="cb60-4" title="4"><span class="kw">layout</span>(<span class="kw">t</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb60-5" title="5"></a>
<a class="sourceLine" id="cb60-6" title="6">qgraph<span class="op">::</span><span class="kw">qgraph</span>(mgm_obj_CV<span class="op">$</span>pairwise<span class="op">$</span>wadj, </a>
<a class="sourceLine" id="cb60-7" title="7">            <span class="dt">layout =</span> avglayout,</a>
<a class="sourceLine" id="cb60-8" title="8">            <span class="dt">title =</span> <span class="st">&quot;Mixed graphical model (Cross-validation)&quot;</span>,</a>
<a class="sourceLine" id="cb60-9" title="9">            <span class="dt">edge.color =</span> <span class="kw">ifelse</span>(mgm_obj_CV<span class="op">$</span>pairwise<span class="op">$</span>edgecolor <span class="op">==</span><span class="st"> &quot;darkgreen&quot;</span>, <span class="st">&quot;blue&quot;</span>, mgm_obj_CV<span class="op">$</span>pairwise<span class="op">$</span>edgecolor),</a>
<a class="sourceLine" id="cb60-10" title="10">            <span class="dt">pie =</span> pie_errors2,</a>
<a class="sourceLine" id="cb60-11" title="11">            <span class="dt">pieColor =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">3</span>, <span class="dt">begin =</span> <span class="fl">0.4</span>, <span class="dt">end =</span> <span class="fl">0.95</span>)[<span class="dv">2</span>],</a>
<a class="sourceLine" id="cb60-12" title="12">            <span class="dt">color =</span> node_colors,</a>
<a class="sourceLine" id="cb60-13" title="13">            <span class="dt">labels =</span> <span class="kw">names</span>(exerciseTypes_df_fullobs),</a>
<a class="sourceLine" id="cb60-14" title="14">            <span class="dt">label.cex =</span> <span class="fl">0.75</span>,</a>
<a class="sourceLine" id="cb60-15" title="15">            <span class="dt">label.scale =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb60-16" title="16">            <span class="dt">label.color =</span> <span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">&quot;black&quot;</span>, <span class="dv">13</span>)))</a>
<a class="sourceLine" id="cb60-17" title="17"><span class="co">## Error in qgraph::qgraph(mgm_obj_CV$pairwise$wadj, layout = avglayout, : object &#39;avglayout&#39; not found</span></a>
<a class="sourceLine" id="cb60-18" title="18"></a>
<a class="sourceLine" id="cb60-19" title="19">qgraph<span class="op">::</span><span class="kw">qgraph</span>(mgm_obj_EBIC<span class="op">$</span>pairwise<span class="op">$</span>wadj, </a>
<a class="sourceLine" id="cb60-20" title="20">            <span class="dt">layout =</span> avglayout,</a>
<a class="sourceLine" id="cb60-21" title="21">            <span class="dt">title =</span> <span class="st">&quot;Mixed graphical model (EBIC model selection)&quot;</span>,</a>
<a class="sourceLine" id="cb60-22" title="22">            <span class="dt">edge.color =</span> <span class="kw">ifelse</span>(mgm_obj_EBIC<span class="op">$</span>pairwise<span class="op">$</span>edgecolor <span class="op">==</span><span class="st"> &quot;darkgreen&quot;</span>, <span class="st">&quot;blue&quot;</span>, mgm_obj_EBIC<span class="op">$</span>pairwise<span class="op">$</span>edgecolor),</a>
<a class="sourceLine" id="cb60-23" title="23">            <span class="dt">pie =</span> pie_errors2,</a>
<a class="sourceLine" id="cb60-24" title="24">            <span class="dt">pieColor =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">3</span>, <span class="dt">begin =</span> <span class="fl">0.4</span>, <span class="dt">end =</span> <span class="fl">0.95</span>)[<span class="dv">2</span>],</a>
<a class="sourceLine" id="cb60-25" title="25">            <span class="dt">color =</span> node_colors,</a>
<a class="sourceLine" id="cb60-26" title="26">            <span class="dt">labels =</span> <span class="kw">names</span>(exerciseTypes_df_fullobs),</a>
<a class="sourceLine" id="cb60-27" title="27">            <span class="dt">label.cex =</span> <span class="fl">0.75</span>,</a>
<a class="sourceLine" id="cb60-28" title="28">            <span class="dt">label.scale =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb60-29" title="29">            <span class="dt">label.color =</span> <span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">&quot;black&quot;</span>, <span class="dv">15</span>)))</a>
<a class="sourceLine" id="cb60-30" title="30"><span class="co">## Error in qgraph::qgraph(mgm_obj_EBIC$pairwise$wadj, layout = avglayout, : object &#39;avglayout&#39; not found</span></a></code></pre></div>
<div id="bivariate-correlations" class="section level2">
<h2>Bivariate correlations</h2>
<p>Table below shows, how correlations between exercise types differ between the accelerometer and self-reported MVPA measure.</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb61-1" title="1"></a>
<a class="sourceLine" id="cb61-2" title="2">exerciseTypes_df &lt;-<span class="st"> </span>lmi <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(Kys0051<span class="fl">.1</span><span class="op">:</span>Kys0064<span class="fl">.1</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb61-3" title="3"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="kw">contains</span>(<span class="st">&quot;.1&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb61-4" title="4"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate_all</span>(<span class="kw">funs</span>(<span class="kw">replace_na</span>(., <span class="dv">0</span>)))</a>
<a class="sourceLine" id="cb61-5" title="5"><span class="co"># exerciseTypes_df$track &lt;- df$track</span></a>
<a class="sourceLine" id="cb61-6" title="6"><span class="co"># exerciseTypes_df$girl &lt;- df$girl</span></a>
<a class="sourceLine" id="cb61-7" title="7">exerciseTypes_df<span class="op">$</span><span class="st">`</span><span class="dt">PA accelerometer</span><span class="st">`</span> &lt;-<span class="st"> </span>df<span class="op">$</span>mvpaAccelerometer_T1</a>
<a class="sourceLine" id="cb61-8" title="8">exerciseTypes_df<span class="op">$</span><span class="st">`</span><span class="dt">PA self-report</span><span class="st">`</span> &lt;-<span class="st"> </span>df<span class="op">$</span>padaysLastweek_T1</a>
<a class="sourceLine" id="cb61-9" title="9"></a>
<a class="sourceLine" id="cb61-10" title="10"><span class="kw">names</span>(exerciseTypes_df) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Team ball games&quot;</span>, </a>
<a class="sourceLine" id="cb61-11" title="11">                             <span class="st">&quot;Other ball games&quot;</span>,</a>
<a class="sourceLine" id="cb61-12" title="12">                             <span class="st">&quot;Gym training&quot;</span>,</a>
<a class="sourceLine" id="cb61-13" title="13">                             <span class="st">&quot;Combat sports&quot;</span>,</a>
<a class="sourceLine" id="cb61-14" title="14">                             <span class="st">&quot;Fitness classes&quot;</span>,</a>
<a class="sourceLine" id="cb61-15" title="15">                             <span class="st">&quot;Home workout&quot;</span>,</a>
<a class="sourceLine" id="cb61-16" title="16">                             <span class="st">&quot;Cycling&quot;</span>,</a>
<a class="sourceLine" id="cb61-17" title="17">                             <span class="st">&quot;Swimming&quot;</span>,</a>
<a class="sourceLine" id="cb61-18" title="18">                             <span class="st">&quot;Walking&quot;</span>,</a>
<a class="sourceLine" id="cb61-19" title="19">                             <span class="st">&quot;Running&quot;</span>,</a>
<a class="sourceLine" id="cb61-20" title="20">                             <span class="st">&quot;Skiing&quot;</span>,</a>
<a class="sourceLine" id="cb61-21" title="21">                             <span class="st">&quot;Roller skating&quot;</span>,</a>
<a class="sourceLine" id="cb61-22" title="22">                             <span class="st">&quot;Horseback riding&quot;</span>,</a>
<a class="sourceLine" id="cb61-23" title="23">                             <span class="st">&quot;Other&quot;</span>,</a>
<a class="sourceLine" id="cb61-24" title="24">                             <span class="st">&quot;PA accelerometer&quot;</span>,</a>
<a class="sourceLine" id="cb61-25" title="25">                             <span class="st">&quot;PA self-report&quot;</span></a>
<a class="sourceLine" id="cb61-26" title="26">                             )</a>
<a class="sourceLine" id="cb61-27" title="27"></a>
<a class="sourceLine" id="cb61-28" title="28"><span class="co"># Roller skating has only 8 observations; leave out</span></a>
<a class="sourceLine" id="cb61-29" title="29">exerciseTypes_df &lt;-<span class="st"> </span>exerciseTypes_df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span><span class="st">`</span><span class="dt">Roller skating</span><span class="st">`</span>)</a>
<a class="sourceLine" id="cb61-30" title="30"></a>
<a class="sourceLine" id="cb61-31" title="31"><span class="co"># Variable types are muddled, change all to numeric</span></a>
<a class="sourceLine" id="cb61-32" title="32">exerciseTypes_df &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(purrr<span class="op">::</span><span class="kw">map</span>(exerciseTypes_df, <span class="st">`</span><span class="dt">class&lt;-</span><span class="st">`</span>, <span class="kw">c</span>(<span class="st">&quot;numeric&quot;</span>))) </a>
<a class="sourceLine" id="cb61-33" title="33"></a>
<a class="sourceLine" id="cb61-34" title="34"><span class="co"># Change data frame to type tbl to allow for spaces</span></a>
<a class="sourceLine" id="cb61-35" title="35">exerciseTypes_df &lt;-<span class="st"> </span><span class="kw">as.tbl</span>(exerciseTypes_df)</a>
<a class="sourceLine" id="cb61-36" title="36"></a>
<a class="sourceLine" id="cb61-37" title="37"><span class="co"># Take all names, replace the dots with space</span></a>
<a class="sourceLine" id="cb61-38" title="38"><span class="kw">names</span>(exerciseTypes_df) &lt;-<span class="st"> </span>stringr<span class="op">::</span><span class="kw">str_replace_all</span>(<span class="kw">names</span>(exerciseTypes_df), <span class="dt">pattern =</span> <span class="st">&quot;</span><span class="ch">\\</span><span class="st">.&quot;</span>, <span class="dt">replacement =</span> <span class="st">&quot; &quot;</span>)</a>
<a class="sourceLine" id="cb61-39" title="39"></a>
<a class="sourceLine" id="cb61-40" title="40"><span class="kw">cor_auto</span>(exerciseTypes_df) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">data.frame</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb61-41" title="41"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">variable =</span> <span class="kw">names</span>(exerciseTypes_df)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb61-42" title="42"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate_at</span>(<span class="kw">vars</span>(PA.accelerometer, PA.self.report), <span class="kw">funs</span>(<span class="kw">round</span>(., <span class="dv">3</span>))) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb61-43" title="43"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(variable, PA.accelerometer, PA.self.report) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb61-44" title="44"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">diff =</span> PA.accelerometer <span class="op">-</span><span class="st"> </span>PA.self.report) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb61-45" title="45"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">arrange</span>(<span class="kw">desc</span>(<span class="kw">abs</span>(diff))) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb61-46" title="46"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(variable <span class="op">!=</span><span class="st"> &quot;PA accelerometer&quot;</span>, variable <span class="op">!=</span><span class="st"> &quot;PA self report&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb61-47" title="47"><span class="st">  </span>DT<span class="op">::</span><span class="kw">datatable</span>(<span class="dt">caption =</span> <span class="st">&quot;Bivariate correlations between PA measures and self-reported activity types&quot;</span>)</a>
<a class="sourceLine" id="cb61-48" title="48"><span class="co">## Error in cor_auto(exerciseTypes_df): could not find function &quot;cor_auto&quot;</span></a></code></pre></div>
</div>
</div>
<div id="chunked-bcts-pa-motivation" class="section level1">
<h1>Chunked BCTs, PA, motivation</h1>
<p>This section shows the correlations structure between BCTs (lumped into chunks based on whether they relate to frequency or agreement), motivational regulations and MVPA (self-reported MVPA the previous week and accelerometer-measured MVPA the following week).</p>
<p>Note: This is only to demonstrate data exploration, as many assumptions (such as multivariate normality, homogeneity, multilevel structure) are not accounted for.</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb62-1" title="1"></a>
<a class="sourceLine" id="cb62-2" title="2">bivariate_BCTs &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(</a>
<a class="sourceLine" id="cb62-3" title="3">  <span class="st">&#39;goal setting&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">01</span>_T1,</a>
<a class="sourceLine" id="cb62-4" title="4">  <span class="st">&#39;own plan&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">02</span>_T1,</a>
<a class="sourceLine" id="cb62-5" title="5">  <span class="st">&#39;plan by other&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">03</span>_T1,</a>
<a class="sourceLine" id="cb62-6" title="6">  <span class="st">&#39;reminder of plan&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">04</span>_T1,</a>
<a class="sourceLine" id="cb62-7" title="7">  <span class="st">&#39;subgoals&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">05</span>_T1,</a>
<a class="sourceLine" id="cb62-8" title="8">  <span class="st">&#39;trying new PA&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">06</span>_T1,</a>
<a class="sourceLine" id="cb62-9" title="9">  <span class="st">&#39;barrier identification&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">07</span>_T1,</a>
<a class="sourceLine" id="cb62-10" title="10">  <span class="st">&#39;problem solving&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">08</span>_T1,</a>
<a class="sourceLine" id="cb62-11" title="11">  <span class="st">&#39;PA identity reflection&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">09</span>_T1,</a>
<a class="sourceLine" id="cb62-12" title="12">  <span class="st">&#39;aligning PA with life values&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">10</span>_T1,</a>
<a class="sourceLine" id="cb62-13" title="13">  <span class="st">&#39;remind of PA benefits&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">01</span>_T1,</a>
<a class="sourceLine" id="cb62-14" title="14">  <span class="st">&#39;self-monitor (paper)&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">02</span>_T1,</a>
<a class="sourceLine" id="cb62-15" title="15">  <span class="st">&#39;self-monitor (app)&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">03</span>_T1,</a>
<a class="sourceLine" id="cb62-16" title="16">  <span class="st">&#39;memory cues&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">04</span>_T1,</a>
<a class="sourceLine" id="cb62-17" title="17">  <span class="st">&#39;goal review&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">05</span>_T1,</a>
<a class="sourceLine" id="cb62-18" title="18">  <span class="st">&#39;personal relevance reflection&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">06</span>_T1,</a>
<a class="sourceLine" id="cb62-19" title="19">  <span class="st">&#39;environmental changes (home)&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">07</span>_T1,</a>
<a class="sourceLine" id="cb62-20" title="20">  <span class="st">&#39;social support&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">08</span>_T1,</a>
<a class="sourceLine" id="cb62-21" title="21">  <span class="st">&#39;failure contemplated&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">09</span>_T1,</a>
<a class="sourceLine" id="cb62-22" title="22">  <span class="st">&#39;PA accelerometer&#39;</span> =<span class="st"> </span>mvpaAccelerometer_T1,</a>
<a class="sourceLine" id="cb62-23" title="23">  <span class="st">&#39;PA self-report&#39;</span> =<span class="st"> </span>padaysLastweek_T1,</a>
<a class="sourceLine" id="cb62-24" title="24">  <span class="st">&#39;autonomous&#39;</span> =<span class="st"> </span>PA_autonomous_T1,</a>
<a class="sourceLine" id="cb62-25" title="25">  <span class="st">&#39;controlled&#39;</span> =<span class="st"> </span>PA_controlled_T1) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb62-26" title="26"><span class="st"> </span><span class="kw">rowwise</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb62-27" title="27"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="st">`</span><span class="dt">PA accelerometer</span><span class="st">`</span>, <span class="st">`</span><span class="dt">PA self-report</span><span class="st">`</span>, autonomous, controlled, <span class="kw">everything</span>()) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb62-28" title="28"><span class="st">  </span><span class="kw">mutate_all</span>(as.numeric)</a>
<a class="sourceLine" id="cb62-29" title="29"></a>
<a class="sourceLine" id="cb62-30" title="30"><span class="co"># Create a covariance matrix of the data</span></a>
<a class="sourceLine" id="cb62-31" title="31">covMatrix &lt;-<span class="st"> </span>bivariate_BCTs <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">cov</span>(<span class="dt">use =</span> <span class="st">&quot;pairwise.complete.obs&quot;</span>)</a>
<a class="sourceLine" id="cb62-32" title="32"></a>
<a class="sourceLine" id="cb62-33" title="33"><span class="co"># Transform the matrix so, that lower diagonal of the matrix shows partial correlations,</span></a>
<a class="sourceLine" id="cb62-34" title="34"><span class="co"># while the upper one shows bivariate correlations.</span></a>
<a class="sourceLine" id="cb62-35" title="35">matrix_corLower_parcorUpper &lt;-<span class="st"> </span>covMatrix <span class="op">%&gt;%</span><span class="st"> </span>ggm<span class="op">::</span><span class="kw">correlations</span>()</a>
<a class="sourceLine" id="cb62-36" title="36"></a>
<a class="sourceLine" id="cb62-37" title="37"><span class="co"># Show the matrix</span></a>
<a class="sourceLine" id="cb62-38" title="38">matrix_corLower_parcorUpper <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb62-39" title="39"><span class="st">  </span>papaja<span class="op">::</span><span class="kw">apa_table</span>(<span class="dt">caption =</span> <span class="st">&quot;Correlation matrix of key variables of interest. Lower diagonal shows bivariate correlations, upper diagonal shows partial correlations&quot;</span>)</a></code></pre></div>
<caption>
(#tab:bivariate-correlations)
</caption>
<caption>
<em>Correlation matrix of key variables of interest. Lower diagonal shows bivariate correlations, upper diagonal shows partial correlations</em>
</caption>
<table>
<thead>
<tr class="header">
<th></th>
<th align="left">PA accelerometer</th>
<th align="left">PA self-report</th>
<th align="left">autonomous</th>
<th align="left">controlled</th>
<th align="left">goal setting</th>
<th align="left">own plan</th>
<th align="left">plan by other</th>
<th align="left">reminder of plan</th>
<th align="left">subgoals</th>
<th align="left">trying new PA</th>
<th align="left">barrier identification</th>
<th align="left">problem solving</th>
<th align="left">PA identity reflection</th>
<th align="left">aligning PA with life values</th>
<th align="left">remind of PA benefits</th>
<th align="left">self-monitor (paper)</th>
<th align="left">self-monitor (app)</th>
<th align="left">memory cues</th>
<th align="left">goal review</th>
<th align="left">personal relevance reflection</th>
<th align="left">environmental changes (home)</th>
<th align="left">social support</th>
<th align="left">failure contemplated</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>PA accelerometer</td>
<td align="left">1.00</td>
<td align="left">0.18</td>
<td align="left">0.10</td>
<td align="left">-0.05</td>
<td align="left">0.05</td>
<td align="left">-0.08</td>
<td align="left">0.06</td>
<td align="left">-0.02</td>
<td align="left">0.02</td>
<td align="left">0.04</td>
<td align="left">0.01</td>
<td align="left">-0.08</td>
<td align="left">0.02</td>
<td align="left">0.04</td>
<td align="left">0.01</td>
<td align="left">-0.01</td>
<td align="left">-0.03</td>
<td align="left">-0.02</td>
<td align="left">0.03</td>
<td align="left">-0.04</td>
<td align="left">0.03</td>
<td align="left">0.03</td>
<td align="left">0.01</td>
</tr>
<tr class="even">
<td>PA self-report</td>
<td align="left">0.29</td>
<td align="left">1.00</td>
<td align="left">0.20</td>
<td align="left">-0.02</td>
<td align="left">0.02</td>
<td align="left">0.03</td>
<td align="left">0.14</td>
<td align="left">-0.06</td>
<td align="left">0.06</td>
<td align="left">0.10</td>
<td align="left">-0.03</td>
<td align="left">-0.02</td>
<td align="left">-0.04</td>
<td align="left">0.01</td>
<td align="left">0.01</td>
<td align="left">0.09</td>
<td align="left">0.01</td>
<td align="left">0.01</td>
<td align="left">0.05</td>
<td align="left">0.02</td>
<td align="left">-0.02</td>
<td align="left">0.01</td>
<td align="left">-0.01</td>
</tr>
<tr class="odd">
<td>autonomous</td>
<td align="left">0.24</td>
<td align="left">0.45</td>
<td align="left">1.00</td>
<td align="left">0.03</td>
<td align="left">0.14</td>
<td align="left">0.07</td>
<td align="left">0.11</td>
<td align="left">-0.03</td>
<td align="left">-0.01</td>
<td align="left">0.10</td>
<td align="left">-0.01</td>
<td align="left">0.00</td>
<td align="left">0.01</td>
<td align="left">0.12</td>
<td align="left">0.12</td>
<td align="left">0.02</td>
<td align="left">0.00</td>
<td align="left">-0.03</td>
<td align="left">0.01</td>
<td align="left">0.15</td>
<td align="left">-0.04</td>
<td align="left">-0.05</td>
<td align="left">0.02</td>
</tr>
<tr class="even">
<td>controlled</td>
<td align="left">-0.02</td>
<td align="left">0.05</td>
<td align="left">0.13</td>
<td align="left">1.00</td>
<td align="left">-0.02</td>
<td align="left">0.03</td>
<td align="left">0.00</td>
<td align="left">0.05</td>
<td align="left">0.00</td>
<td align="left">-0.02</td>
<td align="left">0.07</td>
<td align="left">-0.01</td>
<td align="left">0.08</td>
<td align="left">-0.09</td>
<td align="left">0.04</td>
<td align="left">-0.01</td>
<td align="left">-0.01</td>
<td align="left">0.01</td>
<td align="left">-0.04</td>
<td align="left">-0.01</td>
<td align="left">0.01</td>
<td align="left">0.10</td>
<td align="left">0.12</td>
</tr>
<tr class="odd">
<td>goal setting</td>
<td align="left">0.17</td>
<td align="left">0.35</td>
<td align="left">0.56</td>
<td align="left">0.14</td>
<td align="left">1.00</td>
<td align="left">0.49</td>
<td align="left">-0.02</td>
<td align="left">0.00</td>
<td align="left">0.05</td>
<td align="left">0.00</td>
<td align="left">-0.02</td>
<td align="left">0.10</td>
<td align="left">0.03</td>
<td align="left">0.04</td>
<td align="left">0.13</td>
<td align="left">-0.05</td>
<td align="left">-0.01</td>
<td align="left">-0.02</td>
<td align="left">0.05</td>
<td align="left">-0.01</td>
<td align="left">-0.03</td>
<td align="left">0.07</td>
<td align="left">0.03</td>
</tr>
<tr class="even">
<td>own plan</td>
<td align="left">0.12</td>
<td align="left">0.36</td>
<td align="left">0.53</td>
<td align="left">0.16</td>
<td align="left">0.74</td>
<td align="left">1.00</td>
<td align="left">0.12</td>
<td align="left">0.15</td>
<td align="left">0.11</td>
<td align="left">0.05</td>
<td align="left">0.01</td>
<td align="left">0.02</td>
<td align="left">-0.02</td>
<td align="left">0.07</td>
<td align="left">-0.02</td>
<td align="left">0.03</td>
<td align="left">-0.04</td>
<td align="left">-0.02</td>
<td align="left">0.07</td>
<td align="left">0.00</td>
<td align="left">0.01</td>
<td align="left">0.00</td>
<td align="left">-0.03</td>
</tr>
<tr class="odd">
<td>plan by other</td>
<td align="left">0.18</td>
<td align="left">0.37</td>
<td align="left">0.41</td>
<td align="left">0.11</td>
<td align="left">0.40</td>
<td align="left">0.48</td>
<td align="left">1.00</td>
<td align="left">0.18</td>
<td align="left">0.11</td>
<td align="left">-0.03</td>
<td align="left">-0.04</td>
<td align="left">0.00</td>
<td align="left">0.02</td>
<td align="left">0.01</td>
<td align="left">-0.07</td>
<td align="left">0.05</td>
<td align="left">-0.01</td>
<td align="left">0.01</td>
<td align="left">-0.01</td>
<td align="left">0.01</td>
<td align="left">0.03</td>
<td align="left">0.02</td>
<td align="left">0.04</td>
</tr>
<tr class="even">
<td>reminder of plan</td>
<td align="left">0.10</td>
<td align="left">0.29</td>
<td align="left">0.38</td>
<td align="left">0.17</td>
<td align="left">0.47</td>
<td align="left">0.57</td>
<td align="left">0.50</td>
<td align="left">1.00</td>
<td align="left">0.25</td>
<td align="left">0.05</td>
<td align="left">0.08</td>
<td align="left">0.01</td>
<td align="left">0.06</td>
<td align="left">0.02</td>
<td align="left">-0.02</td>
<td align="left">0.20</td>
<td align="left">0.08</td>
<td align="left">0.08</td>
<td align="left">0.09</td>
<td align="left">-0.04</td>
<td align="left">-0.03</td>
<td align="left">-0.03</td>
<td align="left">-0.05</td>
</tr>
<tr class="odd">
<td>subgoals</td>
<td align="left">0.15</td>
<td align="left">0.36</td>
<td align="left">0.45</td>
<td align="left">0.15</td>
<td align="left">0.54</td>
<td align="left">0.60</td>
<td align="left">0.48</td>
<td align="left">0.64</td>
<td align="left">1.00</td>
<td align="left">0.13</td>
<td align="left">0.02</td>
<td align="left">0.13</td>
<td align="left">0.03</td>
<td align="left">0.05</td>
<td align="left">-0.03</td>
<td align="left">0.05</td>
<td align="left">-0.02</td>
<td align="left">0.06</td>
<td align="left">0.01</td>
<td align="left">-0.03</td>
<td align="left">-0.01</td>
<td align="left">-0.01</td>
<td align="left">0.09</td>
</tr>
<tr class="even">
<td>trying new PA</td>
<td align="left">0.17</td>
<td align="left">0.37</td>
<td align="left">0.47</td>
<td align="left">0.11</td>
<td align="left">0.47</td>
<td align="left">0.51</td>
<td align="left">0.35</td>
<td align="left">0.47</td>
<td align="left">0.54</td>
<td align="left">1.00</td>
<td align="left">0.11</td>
<td align="left">0.06</td>
<td align="left">0.05</td>
<td align="left">0.12</td>
<td align="left">-0.07</td>
<td align="left">-0.05</td>
<td align="left">0.07</td>
<td align="left">-0.04</td>
<td align="left">0.11</td>
<td align="left">0.04</td>
<td align="left">0.09</td>
<td align="left">0.02</td>
<td align="left">-0.10</td>
</tr>
<tr class="odd">
<td>barrier identification</td>
<td align="left">0.09</td>
<td align="left">0.23</td>
<td align="left">0.40</td>
<td align="left">0.21</td>
<td align="left">0.46</td>
<td align="left">0.48</td>
<td align="left">0.32</td>
<td align="left">0.49</td>
<td align="left">0.52</td>
<td align="left">0.50</td>
<td align="left">1.00</td>
<td align="left">0.46</td>
<td align="left">0.08</td>
<td align="left">0.05</td>
<td align="left">0.07</td>
<td align="left">-0.02</td>
<td align="left">-0.03</td>
<td align="left">0.11</td>
<td align="left">-0.06</td>
<td align="left">0.01</td>
<td align="left">0.02</td>
<td align="left">0.01</td>
<td align="left">0.06</td>
</tr>
<tr class="even">
<td>problem solving</td>
<td align="left">0.08</td>
<td align="left">0.27</td>
<td align="left">0.45</td>
<td align="left">0.17</td>
<td align="left">0.55</td>
<td align="left">0.55</td>
<td align="left">0.37</td>
<td align="left">0.51</td>
<td align="left">0.59</td>
<td align="left">0.53</td>
<td align="left">0.73</td>
<td align="left">1.00</td>
<td align="left">0.12</td>
<td align="left">0.15</td>
<td align="left">-0.06</td>
<td align="left">0.01</td>
<td align="left">0.07</td>
<td align="left">-0.04</td>
<td align="left">0.07</td>
<td align="left">0.01</td>
<td align="left">-0.05</td>
<td align="left">0.02</td>
<td align="left">0.09</td>
</tr>
<tr class="odd">
<td>PA identity reflection</td>
<td align="left">0.14</td>
<td align="left">0.28</td>
<td align="left">0.49</td>
<td align="left">0.20</td>
<td align="left">0.52</td>
<td align="left">0.51</td>
<td align="left">0.36</td>
<td align="left">0.47</td>
<td align="left">0.51</td>
<td align="left">0.51</td>
<td align="left">0.57</td>
<td align="left">0.62</td>
<td align="left">1.00</td>
<td align="left">0.36</td>
<td align="left">0.10</td>
<td align="left">0.01</td>
<td align="left">-0.05</td>
<td align="left">-0.02</td>
<td align="left">0.03</td>
<td align="left">0.13</td>
<td align="left">-0.03</td>
<td align="left">0.02</td>
<td align="left">0.03</td>
</tr>
<tr class="even">
<td>aligning PA with life values</td>
<td align="left">0.17</td>
<td align="left">0.32</td>
<td align="left">0.55</td>
<td align="left">0.11</td>
<td align="left">0.56</td>
<td align="left">0.56</td>
<td align="left">0.38</td>
<td align="left">0.46</td>
<td align="left">0.54</td>
<td align="left">0.55</td>
<td align="left">0.57</td>
<td align="left">0.64</td>
<td align="left">0.71</td>
<td align="left">1.00</td>
<td align="left">0.03</td>
<td align="left">-0.09</td>
<td align="left">-0.01</td>
<td align="left">0.02</td>
<td align="left">-0.03</td>
<td align="left">0.13</td>
<td align="left">0.04</td>
<td align="left">-0.03</td>
<td align="left">0.01</td>
</tr>
<tr class="odd">
<td>remind of PA benefits</td>
<td align="left">0.13</td>
<td align="left">0.27</td>
<td align="left">0.47</td>
<td align="left">0.18</td>
<td align="left">0.47</td>
<td align="left">0.40</td>
<td align="left">0.23</td>
<td align="left">0.31</td>
<td align="left">0.35</td>
<td align="left">0.34</td>
<td align="left">0.41</td>
<td align="left">0.41</td>
<td align="left">0.50</td>
<td align="left">0.48</td>
<td align="left">1.00</td>
<td align="left">0.00</td>
<td align="left">0.07</td>
<td align="left">-0.03</td>
<td align="left">0.05</td>
<td align="left">0.31</td>
<td align="left">0.00</td>
<td align="left">0.09</td>
<td align="left">0.07</td>
</tr>
<tr class="even">
<td>self-monitor (paper)</td>
<td align="left">0.10</td>
<td align="left">0.31</td>
<td align="left">0.30</td>
<td align="left">0.14</td>
<td align="left">0.31</td>
<td align="left">0.39</td>
<td align="left">0.38</td>
<td align="left">0.56</td>
<td align="left">0.46</td>
<td align="left">0.34</td>
<td align="left">0.35</td>
<td align="left">0.36</td>
<td align="left">0.31</td>
<td align="left">0.28</td>
<td align="left">0.29</td>
<td align="left">1.00</td>
<td align="left">0.19</td>
<td align="left">0.26</td>
<td align="left">0.12</td>
<td align="left">0.00</td>
<td align="left">0.12</td>
<td align="left">0.08</td>
<td align="left">-0.01</td>
</tr>
<tr class="odd">
<td>self-monitor (app)</td>
<td align="left">0.05</td>
<td align="left">0.20</td>
<td align="left">0.22</td>
<td align="left">0.09</td>
<td align="left">0.23</td>
<td align="left">0.26</td>
<td align="left">0.24</td>
<td align="left">0.41</td>
<td align="left">0.32</td>
<td align="left">0.30</td>
<td align="left">0.28</td>
<td align="left">0.31</td>
<td align="left">0.23</td>
<td align="left">0.23</td>
<td align="left">0.25</td>
<td align="left">0.51</td>
<td align="left">1.00</td>
<td align="left">0.19</td>
<td align="left">0.07</td>
<td align="left">-0.03</td>
<td align="left">0.09</td>
<td align="left">-0.02</td>
<td align="left">0.01</td>
</tr>
<tr class="even">
<td>memory cues</td>
<td align="left">0.09</td>
<td align="left">0.26</td>
<td align="left">0.28</td>
<td align="left">0.14</td>
<td align="left">0.31</td>
<td align="left">0.37</td>
<td align="left">0.34</td>
<td align="left">0.52</td>
<td align="left">0.46</td>
<td align="left">0.36</td>
<td align="left">0.41</td>
<td align="left">0.38</td>
<td align="left">0.34</td>
<td align="left">0.33</td>
<td align="left">0.30</td>
<td align="left">0.63</td>
<td align="left">0.52</td>
<td align="left">1.00</td>
<td align="left">0.20</td>
<td align="left">-0.02</td>
<td align="left">0.23</td>
<td align="left">0.03</td>
<td align="left">0.01</td>
</tr>
<tr class="odd">
<td>goal review</td>
<td align="left">0.16</td>
<td align="left">0.36</td>
<td align="left">0.45</td>
<td align="left">0.14</td>
<td align="left">0.50</td>
<td align="left">0.53</td>
<td align="left">0.39</td>
<td align="left">0.55</td>
<td align="left">0.53</td>
<td align="left">0.50</td>
<td align="left">0.45</td>
<td align="left">0.51</td>
<td align="left">0.49</td>
<td align="left">0.48</td>
<td align="left">0.46</td>
<td align="left">0.55</td>
<td align="left">0.43</td>
<td align="left">0.58</td>
<td align="left">1.00</td>
<td align="left">0.19</td>
<td align="left">0.03</td>
<td align="left">0.07</td>
<td align="left">0.08</td>
</tr>
<tr class="even">
<td>personal relevance reflection</td>
<td align="left">0.14</td>
<td align="left">0.33</td>
<td align="left">0.54</td>
<td align="left">0.17</td>
<td align="left">0.49</td>
<td align="left">0.47</td>
<td align="left">0.33</td>
<td align="left">0.40</td>
<td align="left">0.44</td>
<td align="left">0.47</td>
<td align="left">0.48</td>
<td align="left">0.51</td>
<td align="left">0.58</td>
<td align="left">0.59</td>
<td align="left">0.62</td>
<td align="left">0.36</td>
<td align="left">0.28</td>
<td align="left">0.38</td>
<td align="left">0.58</td>
<td align="left">1.00</td>
<td align="left">0.11</td>
<td align="left">0.10</td>
<td align="left">0.09</td>
</tr>
<tr class="odd">
<td>environmental changes (home)</td>
<td align="left">0.12</td>
<td align="left">0.24</td>
<td align="left">0.28</td>
<td align="left">0.16</td>
<td align="left">0.31</td>
<td align="left">0.34</td>
<td align="left">0.30</td>
<td align="left">0.39</td>
<td align="left">0.38</td>
<td align="left">0.38</td>
<td align="left">0.36</td>
<td align="left">0.34</td>
<td align="left">0.34</td>
<td align="left">0.35</td>
<td align="left">0.34</td>
<td align="left">0.51</td>
<td align="left">0.41</td>
<td align="left">0.57</td>
<td align="left">0.50</td>
<td align="left">0.45</td>
<td align="left">1.00</td>
<td align="left">0.30</td>
<td align="left">0.07</td>
</tr>
<tr class="even">
<td>social support</td>
<td align="left">0.12</td>
<td align="left">0.24</td>
<td align="left">0.31</td>
<td align="left">0.22</td>
<td align="left">0.38</td>
<td align="left">0.37</td>
<td align="left">0.29</td>
<td align="left">0.35</td>
<td align="left">0.37</td>
<td align="left">0.35</td>
<td align="left">0.37</td>
<td align="left">0.37</td>
<td align="left">0.38</td>
<td align="left">0.36</td>
<td align="left">0.41</td>
<td align="left">0.42</td>
<td align="left">0.30</td>
<td align="left">0.43</td>
<td align="left">0.48</td>
<td align="left">0.48</td>
<td align="left">0.56</td>
<td align="left">1.00</td>
<td align="left">0.09</td>
</tr>
<tr class="odd">
<td>failure contemplated</td>
<td align="left">0.09</td>
<td align="left">0.20</td>
<td align="left">0.32</td>
<td align="left">0.23</td>
<td align="left">0.36</td>
<td align="left">0.34</td>
<td align="left">0.27</td>
<td align="left">0.31</td>
<td align="left">0.38</td>
<td align="left">0.27</td>
<td align="left">0.40</td>
<td align="left">0.43</td>
<td align="left">0.40</td>
<td align="left">0.38</td>
<td align="left">0.39</td>
<td align="left">0.29</td>
<td align="left">0.23</td>
<td align="left">0.32</td>
<td align="left">0.41</td>
<td align="left">0.44</td>
<td align="left">0.35</td>
<td align="left">0.38</td>
<td align="left">1.00</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb63-1" title="1"></a>
<a class="sourceLine" id="cb63-2" title="2"><span class="co"># Plot the matrix as a correlogram</span></a>
<a class="sourceLine" id="cb63-3" title="3">matrix_corLower_parcorUpper <span class="op">%&gt;%</span><span class="st"> </span>corrgram<span class="op">::</span><span class="kw">corrgram</span>(</a>
<a class="sourceLine" id="cb63-4" title="4">  <span class="dt">type =</span> <span class="st">&quot;cor&quot;</span>,</a>
<a class="sourceLine" id="cb63-5" title="5">  <span class="dt">lower.panel =</span> corrgram<span class="op">::</span>panel.pie,</a>
<a class="sourceLine" id="cb63-6" title="6">  <span class="dt">upper.panel =</span> corrgram<span class="op">::</span>panel.pie,</a>
<a class="sourceLine" id="cb63-7" title="7">  <span class="dt">main =</span> <span class="st">&quot;Bivariate (upper diagonal) and partial (lower diagonal)</span><span class="ch">\n</span><span class="st">correlations of key PA variables&quot;</span>)</a></code></pre></div>
<p><img src="baseline-networks_files/figure-html/bivariate-correlations-1.png" width="2100" /></p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb64-1" title="1"></a>
<a class="sourceLine" id="cb64-2" title="2">corMatrix_BCTs &lt;-<span class="st"> </span>bivariate_BCTs <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">cor</span>(<span class="dt">use =</span> <span class="st">&quot;pairwise.complete.obs&quot;</span>, <span class="dt">method =</span> <span class="st">&quot;spearman&quot;</span>)</a>
<a class="sourceLine" id="cb64-3" title="3"></a>
<a class="sourceLine" id="cb64-4" title="4"><span class="kw">as.data.frame</span>(<span class="kw">as.table</span>(corMatrix_BCTs)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb64-5" title="5"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(Var1 <span class="op">==</span><span class="st"> &quot;PA accelerometer&quot;</span> <span class="op">|</span><span class="st"> </span>Var1 <span class="op">==</span><span class="st"> &quot;PA self report&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb64-6" title="6"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="st">&quot;Spearman correlation&quot;</span> =<span class="st"> </span>Freq <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">round</span>(., <span class="dv">3</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">format</span>(., <span class="dt">nsmall =</span> <span class="dv">3</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb64-7" title="7"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>Freq) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb64-8" title="8"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="st">`</span><span class="dt">Spearman correlation</span><span class="st">`</span> <span class="op">!=</span><span class="st"> </span><span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb64-9" title="9"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">arrange</span>(<span class="kw">desc</span>(<span class="st">`</span><span class="dt">Spearman correlation</span><span class="st">`</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb64-10" title="10"><span class="st">  </span>DT<span class="op">::</span><span class="kw">datatable</span>(<span class="dt">caption =</span> <span class="st">&quot;Bivariate correlations between BCTs, motivation and PA. Sorted by strength.&quot;</span>)</a></code></pre></div>
<div id="htmlwidget-1552a6bfb6ebcc80c571" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-1552a6bfb6ebcc80c571">{"x":{"filter":"none","caption":"<caption>Bivariate correlations between BCTs, motivation and PA. Sorted by strength.<\/caption>","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23"],["PA accelerometer","PA accelerometer","PA accelerometer","PA accelerometer","PA accelerometer","PA accelerometer","PA accelerometer","PA accelerometer","PA accelerometer","PA accelerometer","PA accelerometer","PA accelerometer","PA accelerometer","PA accelerometer","PA accelerometer","PA accelerometer","PA accelerometer","PA accelerometer","PA accelerometer","PA accelerometer","PA accelerometer","PA accelerometer","PA accelerometer"],["PA accelerometer","PA self-report","autonomous","trying new PA","goal setting","aligning PA with life values","plan by other","goal review","subgoals","social support","personal relevance reflection","PA identity reflection","remind of PA benefits","own plan","environmental changes (home)","failure contemplated","reminder of plan","self-monitor (paper)","barrier identification","memory cues","problem solving","self-monitor (app)","controlled"],[" 1.000"," 0.280"," 0.252"," 0.176"," 0.171"," 0.160"," 0.158"," 0.155"," 0.135"," 0.135"," 0.134"," 0.133"," 0.123"," 0.112"," 0.107"," 0.101"," 0.087"," 0.087"," 0.081"," 0.079"," 0.058"," 0.035","-0.031"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Var1<\/th>\n      <th>Var2<\/th>\n      <th>Spearman correlation<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-center","targets":"_all"},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<p>Highest bivariate (Spearman) correlations with self-reported PA:</p>
<ol style="list-style-type: decimal">
<li>I have tried out new ways for me to be physically active.</li>
<li>I have personally made a specific plan (“what, where, how”) to implement my PA.</li>
<li>I have a PA plan, which has been made by someone else, e.g. my sports club (e.g. a workout schedule).</li>
<li>I have set PA goals for myself.</li>
<li>I have broken down larger PA goals to smaller subgoals.</li>
<li>I have compared my actualized PA with the PA goal I have set.</li>
<li>I have attempted to find ways to exercise so, that it won’t obstruct but instead helps actualise my other life values.</li>
<li>I have thought about which reasons to do PA are important to me personally.</li>
<li>I have monitored my PA by marking the PA occasions on an exercise log on paper.</li>
<li>I have a way by which I remind myself of my PA plan, e.g. I write it down in the calendar.</li>
</ol>
<div id="prepare-data-and-show-correlation-structure" class="section level2">
<h2>Prepare data and show correlation structure</h2>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb65-1" title="1">bctdf_chunks &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(</a>
<a class="sourceLine" id="cb65-2" title="2">  <span class="st">&#39;agr-BCTs&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_T1,</a>
<a class="sourceLine" id="cb65-3" title="3">  <span class="st">&#39;frq-BCTs&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_T1,</a>
<a class="sourceLine" id="cb65-4" title="4">  <span class="st">&#39;Accelerometer&#39;</span> =<span class="st"> </span>mvpaAccelerometer_T1,</a>
<a class="sourceLine" id="cb65-5" title="5">  <span class="st">&#39;Self-report&#39;</span> =<span class="st"> </span>padaysLastweek_T1,</a>
<a class="sourceLine" id="cb65-6" title="6">  <span class="st">&#39;intrinsic&#39;</span> =<span class="st"> </span>PA_intrinsic_T1,</a>
<a class="sourceLine" id="cb65-7" title="7">  <span class="st">&#39;identified&#39;</span> =<span class="st"> </span>PA_identified_T1,</a>
<a class="sourceLine" id="cb65-8" title="8">  <span class="st">&#39;introjected&#39;</span> =<span class="st"> </span>PA_introjected_T1,</a>
<a class="sourceLine" id="cb65-9" title="9">  <span class="st">&#39;extrinsic&#39;</span> =<span class="st"> </span>PA_extrinsic_T1) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb65-10" title="10"><span class="st">  </span><span class="kw">rowwise</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb65-11" title="11"><span class="st">  </span><span class="kw">mutate_all</span>(as.numeric)</a>
<a class="sourceLine" id="cb65-12" title="12"></a>
<a class="sourceLine" id="cb65-13" title="13">labs &lt;-<span class="st"> </span><span class="kw">names</span>(bctdf_chunks)</a>
<a class="sourceLine" id="cb65-14" title="14"></a>
<a class="sourceLine" id="cb65-15" title="15">bctdf_chunks <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb65-16" title="16"><span class="st">  </span>corrgram<span class="op">::</span><span class="kw">corrgram</span>( </a>
<a class="sourceLine" id="cb65-17" title="17">         <span class="dt">cor.method =</span> <span class="st">&quot;pearson&quot;</span>, </a>
<a class="sourceLine" id="cb65-18" title="18">         <span class="co"># diag.panel=panel.minmax, </span></a>
<a class="sourceLine" id="cb65-19" title="19">         <span class="co"># lower.panel=panel.shade, </span></a>
<a class="sourceLine" id="cb65-20" title="20">         <span class="co"># lower.panel=panel.ellipse,</span></a>
<a class="sourceLine" id="cb65-21" title="21">         <span class="co"># lower.panel=panel.cor,</span></a>
<a class="sourceLine" id="cb65-22" title="22">         <span class="dt">upper.panel=</span>corrgram<span class="op">::</span>panel.conf,</a>
<a class="sourceLine" id="cb65-23" title="23">         <span class="dt">lower.panel=</span>corrgram<span class="op">::</span>panel.pie,</a>
<a class="sourceLine" id="cb65-24" title="24">         <span class="dt">outer.labels=</span><span class="kw">list</span>(</a>
<a class="sourceLine" id="cb65-25" title="25">           <span class="dt">bottom=</span><span class="kw">list</span>(<span class="dt">labels=</span>labs,<span class="dt">cex=</span>.<span class="dv">75</span>, <span class="dt">srt=</span><span class="dv">60</span>),</a>
<a class="sourceLine" id="cb65-26" title="26">           <span class="dt">left=</span><span class="kw">list</span>(<span class="dt">labels=</span>labs,<span class="dt">cex=</span>.<span class="dv">75</span>, <span class="dt">srt=</span><span class="dv">30</span>))</a>
<a class="sourceLine" id="cb65-27" title="27">         )</a></code></pre></div>
<p><img src="baseline-networks_files/figure-html/chunked-dataprep-corr-1.png" width="2100" /></p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb66-1" title="1"></a>
<a class="sourceLine" id="cb66-2" title="2"><span class="co"># Create a covariance matrix of the data</span></a>
<a class="sourceLine" id="cb66-3" title="3">covMatrix &lt;-<span class="st"> </span>bctdf_chunks <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">cov</span>(<span class="dt">use =</span> <span class="st">&quot;pairwise.complete.obs&quot;</span>)</a>
<a class="sourceLine" id="cb66-4" title="4"></a>
<a class="sourceLine" id="cb66-5" title="5"><span class="co"># Transform the matrix so, that lower diagonal of the matrix shows partial correlations,</span></a>
<a class="sourceLine" id="cb66-6" title="6"><span class="co"># while the upper one shows bivariate correlations.</span></a>
<a class="sourceLine" id="cb66-7" title="7">matrix_corLower_parcorUpper &lt;-<span class="st"> </span>covMatrix <span class="op">%&gt;%</span><span class="st"> </span>ggm<span class="op">::</span><span class="kw">correlations</span>()</a>
<a class="sourceLine" id="cb66-8" title="8"></a>
<a class="sourceLine" id="cb66-9" title="9"><span class="co"># Show the matrix</span></a>
<a class="sourceLine" id="cb66-10" title="10">matrix_corLower_parcorUpper <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb66-11" title="11"><span class="st">  </span>papaja<span class="op">::</span><span class="kw">apa_table</span>(<span class="dt">caption =</span> <span class="st">&quot;Correlation matrix of key variables of interest. Lower diagonal shows bivariate correlations, upper diagonal shows partial correlations&quot;</span>)</a></code></pre></div>
<caption>
(#tab:chunked-dataprep-corr)
</caption>
<caption>
<em>Correlation matrix of key variables of interest. Lower diagonal shows bivariate correlations, upper diagonal shows partial correlations</em>
</caption>
<table>
<thead>
<tr class="header">
<th></th>
<th align="left">agr-BCTs</th>
<th align="left">frq-BCTs</th>
<th align="left">Accelerometer</th>
<th align="left">Self-report</th>
<th align="left">intrinsic</th>
<th align="left">identified</th>
<th align="left">introjected</th>
<th align="left">extrinsic</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>agr-BCTs</td>
<td align="left">1.00</td>
<td align="left">0.59</td>
<td align="left">0.01</td>
<td align="left">0.12</td>
<td align="left">0.19</td>
<td align="left">0.12</td>
<td align="left">0.07</td>
<td align="left">0.01</td>
</tr>
<tr class="even">
<td>frq-BCTs</td>
<td align="left">0.73</td>
<td align="left">1.00</td>
<td align="left">0.02</td>
<td align="left">0.10</td>
<td align="left">-0.01</td>
<td align="left">0.06</td>
<td align="left">0.06</td>
<td align="left">0.08</td>
</tr>
<tr class="odd">
<td>Accelerometer</td>
<td align="left">0.18</td>
<td align="left">0.16</td>
<td align="left">1.00</td>
<td align="left">0.20</td>
<td align="left">0.10</td>
<td align="left">-0.03</td>
<td align="left">-0.03</td>
<td align="left">-0.02</td>
</tr>
<tr class="even">
<td>Self-report</td>
<td align="left">0.43</td>
<td align="left">0.38</td>
<td align="left">0.29</td>
<td align="left">1.00</td>
<td align="left">0.14</td>
<td align="left">0.05</td>
<td align="left">-0.03</td>
<td align="left">-0.01</td>
</tr>
<tr class="odd">
<td>intrinsic</td>
<td align="left">0.56</td>
<td align="left">0.44</td>
<td align="left">0.23</td>
<td align="left">0.42</td>
<td align="left">1.00</td>
<td align="left">0.59</td>
<td align="left">0.03</td>
<td align="left">-0.13</td>
</tr>
<tr class="even">
<td>identified</td>
<td align="left">0.55</td>
<td align="left">0.46</td>
<td align="left">0.16</td>
<td align="left">0.38</td>
<td align="left">0.74</td>
<td align="left">1.00</td>
<td align="left">0.18</td>
<td align="left">-0.07</td>
</tr>
<tr class="odd">
<td>introjected</td>
<td align="left">0.30</td>
<td align="left">0.28</td>
<td align="left">0.02</td>
<td align="left">0.12</td>
<td align="left">0.24</td>
<td align="left">0.32</td>
<td align="left">1.00</td>
<td align="left">0.36</td>
</tr>
<tr class="even">
<td>extrinsic</td>
<td align="left">0.03</td>
<td align="left">0.09</td>
<td align="left">-0.06</td>
<td align="left">-0.05</td>
<td align="left">-0.13</td>
<td align="left">-0.08</td>
<td align="left">0.33</td>
<td align="left">1.00</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb67-1" title="1"></a>
<a class="sourceLine" id="cb67-2" title="2"><span class="co"># Plot the matrix as a correlogram</span></a>
<a class="sourceLine" id="cb67-3" title="3">matrix_corLower_parcorUpper <span class="op">%&gt;%</span><span class="st"> </span>corrgram<span class="op">::</span><span class="kw">corrgram</span>(</a>
<a class="sourceLine" id="cb67-4" title="4">  <span class="dt">type =</span> <span class="st">&quot;cor&quot;</span>,</a>
<a class="sourceLine" id="cb67-5" title="5">  <span class="dt">lower.panel =</span> corrgram<span class="op">::</span>panel.pie,</a>
<a class="sourceLine" id="cb67-6" title="6">  <span class="dt">upper.panel =</span> corrgram<span class="op">::</span>panel.pie,</a>
<a class="sourceLine" id="cb67-7" title="7">  <span class="dt">main =</span> <span class="st">&quot;Bivariate (upper diagonal) and partial (lower diagonal)</span><span class="ch">\n</span><span class="st">correlations of key PA variables&quot;</span>)</a></code></pre></div>
<p><img src="baseline-networks_files/figure-html/chunked-dataprep-corr-2.png" width="2100" /></p>
</div>
<div id="estimate-and-plot-networks" class="section level2">
<h2>Estimate and plot networks</h2>
<p><img src="baseline-networks_files/figure-html/chunked-networks-1.png" width="2100" /><img src="baseline-networks_files/figure-html/chunked-networks-2.png" width="2100" /><img src="baseline-networks_files/figure-html/chunked-networks-3.png" width="2100" /></p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb68-1" title="1"></a>
<a class="sourceLine" id="cb68-2" title="2"><span class="co"># Average the layout according to three previous plots, and plot each according to the layout</span></a>
<a class="sourceLine" id="cb68-3" title="3">avlayout &lt;-<span class="st"> </span>qgraph<span class="op">::</span><span class="kw">averageLayout</span>(bootnetgraph, corgraph, pcorgraph)</a>
<a class="sourceLine" id="cb68-4" title="4"></a>
<a class="sourceLine" id="cb68-5" title="5">corgraph &lt;-<span class="st"> </span>qgraph<span class="op">::</span><span class="kw">qgraph</span>(qgraph<span class="op">::</span><span class="kw">cor_auto</span>(bctdf_chunks), <span class="dt">graph =</span> <span class="st">&quot;cor&quot;</span>,</a>
<a class="sourceLine" id="cb68-6" title="6">       <span class="dt">labels =</span> <span class="kw">names</span>(bctdf_chunks),</a>
<a class="sourceLine" id="cb68-7" title="7">       <span class="dt">edge.labels =</span> <span class="ot">TRUE</span>, </a>
<a class="sourceLine" id="cb68-8" title="8">       <span class="dt">layout =</span> avlayout, </a>
<a class="sourceLine" id="cb68-9" title="9">       <span class="dt">title =</span> <span class="st">&quot;bivariate correlation network&quot;</span>,</a>
<a class="sourceLine" id="cb68-10" title="10">       <span class="dt">theme =</span> <span class="st">&quot;colorblind&quot;</span>,</a>
<a class="sourceLine" id="cb68-11" title="11">       <span class="dt">maximum =</span> <span class="kw">max</span>(<span class="kw">c</span>(bootnetgraph<span class="op">$</span>graph<span class="op">$</span>Graph<span class="op">$</span>maximum,</a>
<a class="sourceLine" id="cb68-12" title="12">                     pcorgraph<span class="op">$</span>graph<span class="op">$</span>Graph<span class="op">$</span>maximum, </a>
<a class="sourceLine" id="cb68-13" title="13">                     corgraph<span class="op">$</span>graph<span class="op">$</span>Graph<span class="op">$</span>maximum)))</a></code></pre></div>
<p><img src="baseline-networks_files/figure-html/chunked-networks2-1.png" width="2100" /></p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb69-1" title="1"></a>
<a class="sourceLine" id="cb69-2" title="2"><span class="co"># To help with visual comparison, that last argument takes the maximum edge of the three </span></a>
<a class="sourceLine" id="cb69-3" title="3"><span class="co"># graphs and places that as the benchmark for the thickest line in all plots.</span></a>
<a class="sourceLine" id="cb69-4" title="4"></a>
<a class="sourceLine" id="cb69-5" title="5">pcorgraph &lt;-<span class="st"> </span>qgraph<span class="op">::</span><span class="kw">qgraph</span>(qgraph<span class="op">::</span><span class="kw">cor_auto</span>(bctdf_chunks), <span class="dt">graph =</span> <span class="st">&quot;pcor&quot;</span>,</a>
<a class="sourceLine" id="cb69-6" title="6">       <span class="dt">labels =</span> <span class="kw">names</span>(bctdf_chunks),</a>
<a class="sourceLine" id="cb69-7" title="7">       <span class="dt">edge.labels =</span> <span class="ot">TRUE</span>, </a>
<a class="sourceLine" id="cb69-8" title="8">       <span class="dt">layout =</span> avlayout,</a>
<a class="sourceLine" id="cb69-9" title="9">       <span class="dt">title =</span> <span class="st">&quot;partial correlation network&quot;</span>,</a>
<a class="sourceLine" id="cb69-10" title="10">       <span class="dt">theme =</span> <span class="st">&quot;colorblind&quot;</span>,</a>
<a class="sourceLine" id="cb69-11" title="11">       <span class="dt">maximum =</span> <span class="kw">max</span>(<span class="kw">c</span>(bootnetgraph<span class="op">$</span>graph<span class="op">$</span>Graph<span class="op">$</span>maximum,</a>
<a class="sourceLine" id="cb69-12" title="12">                     pcorgraph<span class="op">$</span>graph<span class="op">$</span>Graph<span class="op">$</span>maximum, </a>
<a class="sourceLine" id="cb69-13" title="13">                     corgraph<span class="op">$</span>graph<span class="op">$</span>Graph<span class="op">$</span>maximum)))</a></code></pre></div>
<p><img src="baseline-networks_files/figure-html/chunked-networks2-2.png" width="2100" /></p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb70-1" title="1"></a>
<a class="sourceLine" id="cb70-2" title="2">bootnetgraph &lt;-<span class="st"> </span><span class="kw">plot</span>(nwBCT_chunks, </a>
<a class="sourceLine" id="cb70-3" title="3">                     <span class="dt">edge.labels =</span> <span class="ot">TRUE</span>, </a>
<a class="sourceLine" id="cb70-4" title="4">                     <span class="dt">layout =</span> avlayout, </a>
<a class="sourceLine" id="cb70-5" title="5">                     <span class="dt">title =</span> <span class="st">&quot;partial correlation network, with LASSO regularisation and EBIC model selection&quot;</span>,</a>
<a class="sourceLine" id="cb70-6" title="6">       <span class="dt">maximum =</span> <span class="kw">max</span>(<span class="kw">c</span>(bootnetgraph<span class="op">$</span>graph<span class="op">$</span>Graph<span class="op">$</span>maximum,</a>
<a class="sourceLine" id="cb70-7" title="7">                     pcorgraph<span class="op">$</span>graph<span class="op">$</span>Graph<span class="op">$</span>maximum, </a>
<a class="sourceLine" id="cb70-8" title="8">                     corgraph<span class="op">$</span>graph<span class="op">$</span>Graph<span class="op">$</span>maximum)))</a></code></pre></div>
<p><img src="baseline-networks_files/figure-html/chunked-networks2-3.png" width="2100" /></p>
<div id="stability" class="section level3">
<h3>Stability</h3>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb71-1" title="1"><span class="co"># bootnet_stability_output &lt;- bootnet::bootnet(nwBCT_chunks, nBoots=1000)</span></a>
<a class="sourceLine" id="cb71-2" title="2"><span class="co"># save(bootnet_stability_output, file = &quot;./Rdata_files/bootnet_stability_output.Rdata&quot;)</span></a>
<a class="sourceLine" id="cb71-3" title="3"><span class="kw">load</span>(<span class="st">&quot;./Rdata_files/bootnet_stability_output.Rdata&quot;</span>)</a>
<a class="sourceLine" id="cb71-4" title="4"></a>
<a class="sourceLine" id="cb71-5" title="5"><span class="kw">plot</span>(bootnet_stability_output, <span class="dt">labels =</span> <span class="ot">TRUE</span>, <span class="dt">order =</span> <span class="st">&quot;sample&quot;</span>) </a></code></pre></div>
<p><img src="baseline-networks_files/figure-html/chunked-stability-1.png" width="2100" /></p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb72-1" title="1"><span class="kw">plot</span>(bootnet_stability_output, <span class="st">&quot;edge&quot;</span>, <span class="dt">plot =</span> <span class="st">&quot;difference&quot;</span>, <span class="dt">onlyNonZero =</span> <span class="ot">TRUE</span>, <span class="dt">order =</span> <span class="st">&quot;sample&quot;</span>)</a></code></pre></div>
<p><img src="baseline-networks_files/figure-html/chunked-stability-2.png" width="2100" /></p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb73-1" title="1"></a>
<a class="sourceLine" id="cb73-2" title="2"><span class="co"># bootnet_centrality_stability_output &lt;- bootnet::bootnet(nwBCT_chunks, nBoots=1000,nCores=8, type=&quot;case&quot;)</span></a>
<a class="sourceLine" id="cb73-3" title="3"><span class="co"># save(bootnet_centrality_stability_output, file = &quot;./Rdata_files/bootnet_centrality_stability_output.Rdata&quot;)</span></a>
<a class="sourceLine" id="cb73-4" title="4"><span class="kw">load</span>(<span class="st">&quot;./Rdata_files/bootnet_centrality_stability_output.Rdata&quot;</span>)</a>
<a class="sourceLine" id="cb73-5" title="5"></a>
<a class="sourceLine" id="cb73-6" title="6"><span class="kw">plot</span>(bootnet_centrality_stability_output)</a></code></pre></div>
<p><img src="baseline-networks_files/figure-html/chunked-stability-3.png" width="2100" /></p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb74-1" title="1"><span class="kw">plot</span>(bootnet_centrality_stability_output, <span class="dt">perNode=</span>T, <span class="st">&quot;strength&quot;</span>)</a></code></pre></div>
<p><img src="baseline-networks_files/figure-html/chunked-stability-4.png" width="2100" /></p>
</div>
</div>
</div>
<div id="individual-agreement-related-bcts-and-pa" class="section level1">
<h1>Individual agreement-related BCTs and PA</h1>
<p>Network without combining nodes</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb75-1" title="1"></a>
<a class="sourceLine" id="cb75-2" title="2">bctdf_pa_mgm &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(</a>
<a class="sourceLine" id="cb75-3" title="3"><span class="co">#  id,</span></a>
<a class="sourceLine" id="cb75-4" title="4"><span class="co">#  intervention,</span></a>
<a class="sourceLine" id="cb75-5" title="5"><span class="co">#  group,</span></a>
<a class="sourceLine" id="cb75-6" title="6"><span class="co">#  school,</span></a>
<a class="sourceLine" id="cb75-7" title="7">  <span class="st">&#39;PA selfrep&#39;</span> =<span class="st"> </span>padaysLastweek_T1,</a>
<a class="sourceLine" id="cb75-8" title="8">  <span class="st">&#39;PA accelerometer&#39;</span> =<span class="st"> </span>mvpaAccelerometer_T1,</a>
<a class="sourceLine" id="cb75-9" title="9">  <span class="st">&#39;goal setting&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">01</span>_T1,</a>
<a class="sourceLine" id="cb75-10" title="10">  <span class="st">&#39;own plan&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">02</span>_T1,</a>
<a class="sourceLine" id="cb75-11" title="11">  <span class="st">&#39;plan by other&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">03</span>_T1,</a>
<a class="sourceLine" id="cb75-12" title="12">  <span class="st">&#39;reminder of plan&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">04</span>_T1,</a>
<a class="sourceLine" id="cb75-13" title="13">  <span class="st">&#39;subgoals&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">05</span>_T1,</a>
<a class="sourceLine" id="cb75-14" title="14">  <span class="st">&#39;trying new PA&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">06</span>_T1,</a>
<a class="sourceLine" id="cb75-15" title="15">  <span class="st">&#39;barrier identification&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">07</span>_T1,</a>
<a class="sourceLine" id="cb75-16" title="16">  <span class="st">&#39;problem solving&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">08</span>_T1,</a>
<a class="sourceLine" id="cb75-17" title="17">  <span class="st">&#39;PA identity reflection&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">09</span>_T1,</a>
<a class="sourceLine" id="cb75-18" title="18">  <span class="st">&#39;aligning PA with life values&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">10</span>_T1) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb75-19" title="19"><span class="st"> </span><span class="kw">rowwise</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb75-20" title="20"><span class="st"> </span><span class="kw">mutate</span>(</a>
<a class="sourceLine" id="cb75-21" title="21">  <span class="st">&#39;goal setting&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">goal setting</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb75-22" title="22">  <span class="co"># &#39;has plan&#39; = ifelse(`own plan` == 1 &amp; `plan by other` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb75-23" title="23">  <span class="st">&#39;own plan&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">own plan</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb75-24" title="24">  <span class="st">&#39;reminder of plan&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">reminder of plan</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb75-25" title="25">  <span class="st">&#39;subgoals&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">subgoals</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb75-26" title="26">  <span class="st">&#39;trying new PA&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">trying new PA</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb75-27" title="27">  <span class="st">&#39;plan by other&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">plan by other</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb75-28" title="28"> <span class="st">&#39;barrier identification&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">barrier identification</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb75-29" title="29"> <span class="st">&#39;problem solving&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">problem solving</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb75-30" title="30">  <span class="co"># &#39;barriers identified or planned for&#39; = ifelse(`problem solving` == 1 &amp; `barrier identification` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb75-31" title="31"> <span class="st">&#39;PA identity reflection&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">PA identity reflection</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb75-32" title="32"> <span class="st">&#39;aligning PA with life values&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">aligning PA with life values</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb75-33" title="33"><span class="st">  </span><span class="co"># &#39;identity, life values&#39; = ifelse(`PA identity reflection` == 1 &amp; `aligning PA with life values` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb75-34" title="34"><span class="st">  </span><span class="co"># dplyr::select(-`self-monitor (paper)`, -`self-monitor (app)`, -`plan by other`, -`own plan`, -identified, -intrinsic,</span></a>
<a class="sourceLine" id="cb75-35" title="35"><span class="st">  </span><span class="co">#        -`failure contemplated`, # only concerns those who haven&#39;t reached goals</span></a>
<a class="sourceLine" id="cb75-36" title="36"><span class="st">  </span><span class="co">#        -`barrier identification`, -`problem solving`, # closely related</span></a>
<a class="sourceLine" id="cb75-37" title="37"><span class="st">  </span><span class="co">#        -`PA identity reflection`, -`aligning PA with life values`) %&gt;% # closely related</span></a>
<a class="sourceLine" id="cb75-38" title="38"><span class="co">#  dplyr::select(-controlled) %&gt;% # Not really gaussian at all </span></a>
<a class="sourceLine" id="cb75-39" title="39"><span class="st">  </span><span class="co"># data.frame %&gt;% </span></a>
<a class="sourceLine" id="cb75-40" title="40"><span class="st">  </span><span class="kw">mutate_all</span>(as.numeric)</a>
<a class="sourceLine" id="cb75-41" title="41"></a>
<a class="sourceLine" id="cb75-42" title="42"><span class="co"># bctdf_mgm$autonomous[is.nan(bctdf_mgm$autonomous)] &lt;- NA</span></a>
<a class="sourceLine" id="cb75-43" title="43"></a>
<a class="sourceLine" id="cb75-44" title="44"><span class="co"># Create a covariance matrix of the data</span></a>
<a class="sourceLine" id="cb75-45" title="45">covMatrix &lt;-<span class="st"> </span>bctdf_pa_mgm <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">cov</span>(<span class="dt">use =</span> <span class="st">&quot;pairwise.complete.obs&quot;</span>)</a>
<a class="sourceLine" id="cb75-46" title="46"></a>
<a class="sourceLine" id="cb75-47" title="47"><span class="co"># Transform the matrix so, that lower diagonal of the matrix shows partial correlations,</span></a>
<a class="sourceLine" id="cb75-48" title="48"><span class="co"># while the upper one shows bivariate correlations.</span></a>
<a class="sourceLine" id="cb75-49" title="49">matrix_corLower_parcorUpper &lt;-<span class="st"> </span>covMatrix <span class="op">%&gt;%</span><span class="st"> </span>ggm<span class="op">::</span><span class="kw">correlations</span>()</a>
<a class="sourceLine" id="cb75-50" title="50"></a>
<a class="sourceLine" id="cb75-51" title="51"><span class="co"># Show the matrix</span></a>
<a class="sourceLine" id="cb75-52" title="52">matrix_corLower_parcorUpper <span class="op">%&gt;%</span><span class="st"> </span>papaja<span class="op">::</span><span class="kw">apa_table</span>(<span class="dt">caption =</span> <span class="st">&quot;Correlation matrix of key variables of interest. Lower diagonal shows bivariate correlations, upper diagonal shows partial correlations&quot;</span>)</a></code></pre></div>
<caption>
(#tab:individualAgreementBCTs-dataprep-corr)
</caption>
<caption>
<em>Correlation matrix of key variables of interest. Lower diagonal shows bivariate correlations, upper diagonal shows partial correlations</em>
</caption>
<table>
<thead>
<tr class="header">
<th></th>
<th align="left">PA selfrep</th>
<th align="left">PA accelerometer</th>
<th align="left">goal setting</th>
<th align="left">own plan</th>
<th align="left">plan by other</th>
<th align="left">reminder of plan</th>
<th align="left">subgoals</th>
<th align="left">trying new PA</th>
<th align="left">barrier identification</th>
<th align="left">problem solving</th>
<th align="left">PA identity reflection</th>
<th align="left">aligning PA with life values</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>PA selfrep</td>
<td align="left">1.00</td>
<td align="left">0.23</td>
<td align="left">0.01</td>
<td align="left">0.06</td>
<td align="left">0.15</td>
<td align="left">0.00</td>
<td align="left">0.03</td>
<td align="left">0.14</td>
<td align="left">-0.03</td>
<td align="left">-0.03</td>
<td align="left">0.02</td>
<td align="left">0.03</td>
</tr>
<tr class="even">
<td>PA accelerometer</td>
<td align="left">0.29</td>
<td align="left">1.00</td>
<td align="left">0.05</td>
<td align="left">0.00</td>
<td align="left">0.05</td>
<td align="left">-0.05</td>
<td align="left">0.02</td>
<td align="left">0.04</td>
<td align="left">-0.02</td>
<td align="left">-0.08</td>
<td align="left">0.05</td>
<td align="left">0.02</td>
</tr>
<tr class="odd">
<td>goal setting</td>
<td align="left">0.26</td>
<td align="left">0.14</td>
<td align="left">1.00</td>
<td align="left">0.51</td>
<td align="left">-0.02</td>
<td align="left">0.02</td>
<td align="left">0.00</td>
<td align="left">0.07</td>
<td align="left">0.07</td>
<td align="left">0.10</td>
<td align="left">0.06</td>
<td align="left">0.03</td>
</tr>
<tr class="even">
<td>own plan</td>
<td align="left">0.30</td>
<td align="left">0.13</td>
<td align="left">0.71</td>
<td align="left">1.00</td>
<td align="left">0.13</td>
<td align="left">0.09</td>
<td align="left">0.15</td>
<td align="left">0.05</td>
<td align="left">-0.03</td>
<td align="left">0.06</td>
<td align="left">-0.04</td>
<td align="left">0.09</td>
</tr>
<tr class="odd">
<td>plan by other</td>
<td align="left">0.32</td>
<td align="left">0.14</td>
<td align="left">0.38</td>
<td align="left">0.47</td>
<td align="left">1.00</td>
<td align="left">0.28</td>
<td align="left">0.15</td>
<td align="left">0.00</td>
<td align="left">0.05</td>
<td align="left">-0.01</td>
<td align="left">-0.01</td>
<td align="left">0.03</td>
</tr>
<tr class="even">
<td>reminder of plan</td>
<td align="left">0.25</td>
<td align="left">0.07</td>
<td align="left">0.45</td>
<td align="left">0.52</td>
<td align="left">0.56</td>
<td align="left">1.00</td>
<td align="left">0.32</td>
<td align="left">0.10</td>
<td align="left">0.11</td>
<td align="left">0.03</td>
<td align="left">0.02</td>
<td align="left">-0.04</td>
</tr>
<tr class="odd">
<td>subgoals</td>
<td align="left">0.29</td>
<td align="left">0.12</td>
<td align="left">0.50</td>
<td align="left">0.58</td>
<td align="left">0.52</td>
<td align="left">0.64</td>
<td align="left">1.00</td>
<td align="left">0.13</td>
<td align="left">0.01</td>
<td align="left">0.14</td>
<td align="left">0.04</td>
<td align="left">0.05</td>
</tr>
<tr class="even">
<td>trying new PA</td>
<td align="left">0.32</td>
<td align="left">0.15</td>
<td align="left">0.47</td>
<td align="left">0.48</td>
<td align="left">0.38</td>
<td align="left">0.48</td>
<td align="left">0.52</td>
<td align="left">1.00</td>
<td align="left">0.10</td>
<td align="left">0.03</td>
<td align="left">0.07</td>
<td align="left">0.14</td>
</tr>
<tr class="odd">
<td>barrier identification</td>
<td align="left">0.20</td>
<td align="left">0.06</td>
<td align="left">0.50</td>
<td align="left">0.48</td>
<td align="left">0.40</td>
<td align="left">0.50</td>
<td align="left">0.52</td>
<td align="left">0.51</td>
<td align="left">1.00</td>
<td align="left">0.46</td>
<td align="left">0.14</td>
<td align="left">0.07</td>
</tr>
<tr class="even">
<td>problem solving</td>
<td align="left">0.21</td>
<td align="left">0.05</td>
<td align="left">0.54</td>
<td align="left">0.53</td>
<td align="left">0.39</td>
<td align="left">0.50</td>
<td align="left">0.57</td>
<td align="left">0.51</td>
<td align="left">0.74</td>
<td align="left">1.00</td>
<td align="left">0.15</td>
<td align="left">0.15</td>
</tr>
<tr class="odd">
<td>PA identity reflection</td>
<td align="left">0.24</td>
<td align="left">0.13</td>
<td align="left">0.47</td>
<td align="left">0.45</td>
<td align="left">0.35</td>
<td align="left">0.42</td>
<td align="left">0.49</td>
<td align="left">0.49</td>
<td align="left">0.59</td>
<td align="left">0.62</td>
<td align="left">1.00</td>
<td align="left">0.42</td>
</tr>
<tr class="even">
<td>aligning PA with life values</td>
<td align="left">0.26</td>
<td align="left">0.12</td>
<td align="left">0.49</td>
<td align="left">0.50</td>
<td align="left">0.37</td>
<td align="left">0.42</td>
<td align="left">0.51</td>
<td align="left">0.53</td>
<td align="left">0.58</td>
<td align="left">0.62</td>
<td align="left">0.69</td>
<td align="left">1.00</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb76-1" title="1"></a>
<a class="sourceLine" id="cb76-2" title="2"><span class="co"># Plot the matrix as a correlogram</span></a>
<a class="sourceLine" id="cb76-3" title="3">matrix_corLower_parcorUpper <span class="op">%&gt;%</span><span class="st"> </span>corrgram<span class="op">::</span><span class="kw">corrgram</span>(</a>
<a class="sourceLine" id="cb76-4" title="4">  <span class="dt">type =</span> <span class="st">&quot;cor&quot;</span>,</a>
<a class="sourceLine" id="cb76-5" title="5">  <span class="dt">lower.panel =</span> corrgram<span class="op">::</span>panel.pie,</a>
<a class="sourceLine" id="cb76-6" title="6">  <span class="dt">upper.panel =</span> corrgram<span class="op">::</span>panel.pie,</a>
<a class="sourceLine" id="cb76-7" title="7">  <span class="dt">main =</span> <span class="st">&quot;Bivariate (upper diagonal) and partial (lower diagonal)</span><span class="ch">\n</span><span class="st">correlations of agreement-BCTs and PA&quot;</span>)</a></code></pre></div>
<p><img src="baseline-networks_files/figure-html/individualAgreementBCTs-dataprep-corr-1.png" width="2100" /></p>
<div id="mgm-estimation-1" class="section level2">
<h2>mgm estimation</h2>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb77-1" title="1"><span class="co"># devtools::install_github(&quot;jmbh/mgm&quot;)</span></a>
<a class="sourceLine" id="cb77-2" title="2"><span class="co"># Restart R for the latest package</span></a>
<a class="sourceLine" id="cb77-3" title="3"><span class="co"># .r.restartR()</span></a>
<a class="sourceLine" id="cb77-4" title="4"></a>
<a class="sourceLine" id="cb77-5" title="5"><span class="co"># mgm wants full data, see package missForest for imputation</span></a>
<a class="sourceLine" id="cb77-6" title="6">bctdf_pa_mgm_fullobs &lt;-<span class="st"> </span>bctdf_pa_mgm <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">na.omit</span>()</a>
<a class="sourceLine" id="cb77-7" title="7"></a>
<a class="sourceLine" id="cb77-8" title="8">mgm_pa_variable_types &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;c&quot;</span>, <span class="st">&quot;g&quot;</span>, <span class="kw">rep</span>(<span class="st">&quot;c&quot;</span>, <span class="dv">10</span>))</a>
<a class="sourceLine" id="cb77-9" title="9">mgm_pa_variable_levels &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;8&quot;</span>, <span class="st">&quot;1&quot;</span>, <span class="kw">rep</span>(<span class="st">&quot;2&quot;</span>, <span class="dv">10</span>))</a>
<a class="sourceLine" id="cb77-10" title="10"><span class="co"># data.frame(mgm_pa_variable_types, mgm_pa_variable_levels, names(bctdf_pa_mgm_fullobs))</span></a>
<a class="sourceLine" id="cb77-11" title="11"></a>
<a class="sourceLine" id="cb77-12" title="12">mgm_obj &lt;-<span class="st"> </span>mgm<span class="op">::</span><span class="kw">mgm</span>(<span class="dt">data =</span> bctdf_pa_mgm_fullobs,</a>
<a class="sourceLine" id="cb77-13" title="13">  <span class="dt">type =</span> mgm_pa_variable_types,</a>
<a class="sourceLine" id="cb77-14" title="14">  <span class="dt">level =</span> mgm_pa_variable_levels,</a>
<a class="sourceLine" id="cb77-15" title="15">  <span class="dt">lambdaSel =</span> <span class="st">&quot;CV&quot;</span>,</a>
<a class="sourceLine" id="cb77-16" title="16">  <span class="dt">lambdaFolds =</span> <span class="dv">10</span>,</a>
<a class="sourceLine" id="cb77-17" title="17">  <span class="dt">pbar =</span> <span class="ot">FALSE</span>, </a>
<a class="sourceLine" id="cb77-18" title="18">  <span class="dt">binarySign =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb77-19" title="19"><span class="co">## Note that the sign of parameter estimates is stored separately; see ?mgm</span></a>
<a class="sourceLine" id="cb77-20" title="20"></a>
<a class="sourceLine" id="cb77-21" title="21">pred_obj &lt;-<span class="st"> </span><span class="kw">predict</span>(<span class="dt">object =</span> mgm_obj,</a>
<a class="sourceLine" id="cb77-22" title="22">                         <span class="dt">data =</span> bctdf_pa_mgm_fullobs)</a>
<a class="sourceLine" id="cb77-23" title="23"></a>
<a class="sourceLine" id="cb77-24" title="24">pred_obj<span class="op">$</span>errors</a></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Variable"],"name":[1],"type":["chr"],"align":["left"]},{"label":["RMSE"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["R2"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["CC"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["nCC"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["CCmarg"],"name":[6],"type":["dbl"],"align":["right"]}],"data":[{"1":"PA selfrep","2":"NA","3":"NA","4":"0.284","5":"0.093","6":"0.211","_rn_":"1"},{"1":"PA accelerometer","2":"0.945","3":"0.106","4":"NA","5":"NA","6":"NA","_rn_":"2"},{"1":"goal setting","2":"NA","3":"NA","4":"0.908","5":"0.594","6":"0.773","_rn_":"3"},{"1":"own plan","2":"NA","3":"NA","4":"0.888","5":"0.630","6":"0.697","_rn_":"4"},{"1":"plan by other","2":"NA","3":"NA","4":"0.782","5":"0.521","6":"0.545","_rn_":"5"},{"1":"reminder of plan","2":"NA","3":"NA","4":"0.841","5":"0.655","6":"0.539","_rn_":"6"},{"1":"subgoals","2":"NA","3":"NA","4":"0.851","5":"0.618","6":"0.610","_rn_":"7"},{"1":"trying new PA","2":"NA","3":"NA","4":"0.830","5":"0.372","6":"0.729","_rn_":"8"},{"1":"barrier identification","2":"NA","3":"NA","4":"0.901","5":"0.617","6":"0.742","_rn_":"9"},{"1":"problem solving","2":"NA","3":"NA","4":"0.912","5":"0.656","6":"0.744","_rn_":"10"},{"1":"PA identity reflection","2":"NA","3":"NA","4":"0.914","5":"0.500","6":"0.828","_rn_":"11"},{"1":"aligning PA with life values","2":"NA","3":"NA","4":"0.910","5":"0.511","6":"0.816","_rn_":"12"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb78-1" title="1"></a>
<a class="sourceLine" id="cb78-2" title="2"><span class="co"># Take R2 from gaussian, CC from categorical variables </span></a>
<a class="sourceLine" id="cb78-3" title="3">pie_errors &lt;-<span class="st"> </span><span class="kw">c</span>(pred_obj<span class="op">$</span>errors[<span class="dv">1</span>, <span class="dv">4</span>],</a>
<a class="sourceLine" id="cb78-4" title="4">                pred_obj<span class="op">$</span>errors[<span class="dv">2</span>, <span class="dv">3</span>],</a>
<a class="sourceLine" id="cb78-5" title="5">                pred_obj<span class="op">$</span>errors[<span class="dv">3</span><span class="op">:</span><span class="kw">nrow</span>(pred_obj<span class="op">$</span>errors), <span class="dv">4</span>])</a>
<a class="sourceLine" id="cb78-6" title="6"></a>
<a class="sourceLine" id="cb78-7" title="7"><span class="co"># PLOT NETWORK </span></a>
<a class="sourceLine" id="cb78-8" title="8"></a>
<a class="sourceLine" id="cb78-9" title="9">node_colors &lt;-<span class="st"> </span><span class="kw">c</span>(viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">begin =</span> <span class="fl">0.3</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">1</span>], </a>
<a class="sourceLine" id="cb78-10" title="10">                 viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">begin =</span> <span class="fl">0.3</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">2</span>],</a>
<a class="sourceLine" id="cb78-11" title="11">                 <span class="kw">rep</span>(viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">begin =</span> <span class="fl">0.3</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">3</span>], <span class="dv">10</span>))</a>
<a class="sourceLine" id="cb78-12" title="12"></a>
<a class="sourceLine" id="cb78-13" title="13">BCT_mgm &lt;-<span class="st"> </span>qgraph<span class="op">::</span><span class="kw">qgraph</span>(mgm_obj<span class="op">$</span>pairwise<span class="op">$</span>wadj, </a>
<a class="sourceLine" id="cb78-14" title="14">            <span class="dt">layout =</span> <span class="st">&quot;spring&quot;</span>,</a>
<a class="sourceLine" id="cb78-15" title="15">            <span class="dt">repulsion =</span> <span class="fl">0.90</span>, <span class="co"># To nudge the network from originally bad visual state</span></a>
<a class="sourceLine" id="cb78-16" title="16">            <span class="dt">title =</span> <span class="st">&quot;agreement-measured BCTs and PA (accelerometer &amp; self-reported)&quot;</span>,</a>
<a class="sourceLine" id="cb78-17" title="17">            <span class="dt">edge.color =</span> <span class="kw">ifelse</span>(mgm_obj<span class="op">$</span>pairwise<span class="op">$</span>edgecolor <span class="op">==</span><span class="st"> &quot;darkgreen&quot;</span>, <span class="st">&quot;blue&quot;</span>, mgm_obj<span class="op">$</span>pairwise<span class="op">$</span>edgecolor),</a>
<a class="sourceLine" id="cb78-18" title="18">            <span class="dt">pie =</span> pie_errors,</a>
<a class="sourceLine" id="cb78-19" title="19">            <span class="dt">pieColor =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">begin =</span> <span class="fl">0.3</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">4</span>],</a>
<a class="sourceLine" id="cb78-20" title="20">            <span class="dt">color =</span> node_colors,</a>
<a class="sourceLine" id="cb78-21" title="21">            <span class="dt">labels =</span> <span class="kw">names</span>(bctdf_pa_mgm_fullobs),</a>
<a class="sourceLine" id="cb78-22" title="22">            <span class="dt">label.cex =</span> <span class="fl">0.75</span>,</a>
<a class="sourceLine" id="cb78-23" title="23">            <span class="dt">label.scale =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb78-24" title="24">            <span class="dt">label.color =</span> <span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">&quot;black&quot;</span>, <span class="dv">12</span>)))</a></code></pre></div>
<p><img src="baseline-networks_files/figure-html/individualAgreementBCTs-mgm-1.png" width="2100" /></p>
</div>
<div id="ggm-estimation" class="section level2">
<h2>ggm estimation</h2>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb79-1" title="1"></a>
<a class="sourceLine" id="cb79-2" title="2"><span class="co"># Estimate a network</span></a>
<a class="sourceLine" id="cb79-3" title="3"></a>
<a class="sourceLine" id="cb79-4" title="4">individualAgreementBCTs &lt;-<span class="st"> </span>bootnet<span class="op">::</span><span class="kw">estimateNetwork</span>(bctdf_pa_mgm, <span class="dt">default=</span><span class="st">&quot;EBICglasso&quot;</span>)</a>
<a class="sourceLine" id="cb79-5" title="5"></a>
<a class="sourceLine" id="cb79-6" title="6">bootnetgraph &lt;-<span class="st"> </span><span class="kw">plot</span>(individualAgreementBCTs, <span class="dt">edge.labels =</span> <span class="ot">TRUE</span>, </a>
<a class="sourceLine" id="cb79-7" title="7">       <span class="dt">title =</span> <span class="st">&quot;partial correlation network, with LASSO regularisation and EBIC model selection&quot;</span>)</a></code></pre></div>
<p><img src="baseline-networks_files/figure-html/individualAgreementBCTs-ggm-1.png" width="2100" /></p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb80-1" title="1"></a>
<a class="sourceLine" id="cb80-2" title="2">corgraph &lt;-<span class="st"> </span>qgraph<span class="op">::</span><span class="kw">qgraph</span>(qgraph<span class="op">::</span><span class="kw">cor_auto</span>(bctdf_pa_mgm), <span class="dt">graph =</span> <span class="st">&quot;cor&quot;</span>,</a>
<a class="sourceLine" id="cb80-3" title="3">       <span class="dt">labels =</span> <span class="kw">names</span>(bctdf_pa_mgm),</a>
<a class="sourceLine" id="cb80-4" title="4">       <span class="dt">edge.labels =</span> <span class="ot">TRUE</span>, </a>
<a class="sourceLine" id="cb80-5" title="5">       <span class="dt">title =</span> <span class="st">&quot;bivariate correlation network&quot;</span>)</a></code></pre></div>
<p><img src="baseline-networks_files/figure-html/individualAgreementBCTs-ggm-2.png" width="2100" /></p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb81-1" title="1"></a>
<a class="sourceLine" id="cb81-2" title="2">pcorgraph &lt;-<span class="st"> </span>qgraph<span class="op">::</span><span class="kw">qgraph</span>(qgraph<span class="op">::</span><span class="kw">cor_auto</span>(bctdf_pa_mgm), <span class="dt">graph =</span> <span class="st">&quot;pcor&quot;</span>,</a>
<a class="sourceLine" id="cb81-3" title="3">       <span class="dt">labels =</span> <span class="kw">names</span>(bctdf_pa_mgm),</a>
<a class="sourceLine" id="cb81-4" title="4">       <span class="dt">edge.labels =</span> <span class="ot">TRUE</span>, </a>
<a class="sourceLine" id="cb81-5" title="5">       <span class="dt">title =</span> <span class="st">&quot;partial correlation network&quot;</span>)</a></code></pre></div>
<p><img src="baseline-networks_files/figure-html/individualAgreementBCTs-ggm-3.png" width="2100" /></p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb82-1" title="1"></a>
<a class="sourceLine" id="cb82-2" title="2"><span class="co"># Average the layout and plot all according to that</span></a>
<a class="sourceLine" id="cb82-3" title="3">avlayout &lt;-<span class="st"> </span>qgraph<span class="op">::</span><span class="kw">averageLayout</span>(bootnetgraph, corgraph, pcorgraph)</a>
<a class="sourceLine" id="cb82-4" title="4"></a>
<a class="sourceLine" id="cb82-5" title="5">corgraph &lt;-<span class="st"> </span>qgraph<span class="op">::</span><span class="kw">qgraph</span>(qgraph<span class="op">::</span><span class="kw">cor_auto</span>(bctdf_pa_mgm), <span class="dt">graph =</span> <span class="st">&quot;cor&quot;</span>,</a>
<a class="sourceLine" id="cb82-6" title="6">       <span class="dt">labels =</span> <span class="kw">names</span>(bctdf_pa_mgm),</a>
<a class="sourceLine" id="cb82-7" title="7">       <span class="dt">edge.labels =</span> <span class="ot">TRUE</span>, </a>
<a class="sourceLine" id="cb82-8" title="8">       <span class="dt">layout =</span> avlayout, </a>
<a class="sourceLine" id="cb82-9" title="9">       <span class="dt">title =</span> <span class="st">&quot;bivariate correlation network&quot;</span>,</a>
<a class="sourceLine" id="cb82-10" title="10">       <span class="dt">theme =</span> <span class="st">&quot;colorblind&quot;</span>,</a>
<a class="sourceLine" id="cb82-11" title="11">       <span class="dt">maximum =</span> <span class="kw">max</span>(<span class="kw">c</span>(bootnetgraph<span class="op">$</span>graph<span class="op">$</span>Graph<span class="op">$</span>maximum,</a>
<a class="sourceLine" id="cb82-12" title="12">                     pcorgraph<span class="op">$</span>graph<span class="op">$</span>Graph<span class="op">$</span>maximum, </a>
<a class="sourceLine" id="cb82-13" title="13">                     corgraph<span class="op">$</span>graph<span class="op">$</span>Graph<span class="op">$</span>maximum)),</a>
<a class="sourceLine" id="cb82-14" title="14">       <span class="dt">label.scale =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<p><img src="baseline-networks_files/figure-html/individualAgreementBCTs-ggm-4.png" width="2100" /></p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb83-1" title="1"></a>
<a class="sourceLine" id="cb83-2" title="2"><span class="co"># To help with visual comparison, that last argument takes the maximum edge of the three </span></a>
<a class="sourceLine" id="cb83-3" title="3"><span class="co"># graphs and places that as the benchmark for the thickest line in all plots.</span></a>
<a class="sourceLine" id="cb83-4" title="4"></a>
<a class="sourceLine" id="cb83-5" title="5">pcorgraph &lt;-<span class="st"> </span>qgraph<span class="op">::</span><span class="kw">qgraph</span>(qgraph<span class="op">::</span><span class="kw">cor_auto</span>(bctdf_pa_mgm), <span class="dt">graph =</span> <span class="st">&quot;pcor&quot;</span>,</a>
<a class="sourceLine" id="cb83-6" title="6">       <span class="dt">labels =</span> <span class="kw">names</span>(bctdf_pa_mgm),</a>
<a class="sourceLine" id="cb83-7" title="7">       <span class="dt">edge.labels =</span> <span class="ot">TRUE</span>, </a>
<a class="sourceLine" id="cb83-8" title="8">       <span class="dt">layout =</span> avlayout,</a>
<a class="sourceLine" id="cb83-9" title="9">       <span class="dt">title =</span> <span class="st">&quot;partial correlation network&quot;</span>,</a>
<a class="sourceLine" id="cb83-10" title="10">       <span class="dt">theme =</span> <span class="st">&quot;colorblind&quot;</span>,</a>
<a class="sourceLine" id="cb83-11" title="11">       <span class="dt">maximum =</span> <span class="kw">max</span>(<span class="kw">c</span>(bootnetgraph<span class="op">$</span>graph<span class="op">$</span>Graph<span class="op">$</span>maximum,</a>
<a class="sourceLine" id="cb83-12" title="12">                     pcorgraph<span class="op">$</span>graph<span class="op">$</span>Graph<span class="op">$</span>maximum, </a>
<a class="sourceLine" id="cb83-13" title="13">                     corgraph<span class="op">$</span>graph<span class="op">$</span>Graph<span class="op">$</span>maximum)),</a>
<a class="sourceLine" id="cb83-14" title="14">       <span class="dt">label.scale =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<p><img src="baseline-networks_files/figure-html/individualAgreementBCTs-ggm-5.png" width="2100" /></p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb84-1" title="1"></a>
<a class="sourceLine" id="cb84-2" title="2">bootnetgraph &lt;-<span class="st"> </span><span class="kw">plot</span>(individualAgreementBCTs, </a>
<a class="sourceLine" id="cb84-3" title="3">                     <span class="dt">edge.labels =</span> <span class="ot">TRUE</span>, </a>
<a class="sourceLine" id="cb84-4" title="4">                     <span class="dt">layout =</span> avlayout, </a>
<a class="sourceLine" id="cb84-5" title="5">                     <span class="dt">title =</span> <span class="st">&quot;partial correlation network, with LASSO regularisation and EBIC model selection&quot;</span>,</a>
<a class="sourceLine" id="cb84-6" title="6">       <span class="dt">maximum =</span> <span class="kw">max</span>(<span class="kw">c</span>(bootnetgraph<span class="op">$</span>graph<span class="op">$</span>Graph<span class="op">$</span>maximum,</a>
<a class="sourceLine" id="cb84-7" title="7">                     pcorgraph<span class="op">$</span>graph<span class="op">$</span>Graph<span class="op">$</span>maximum, </a>
<a class="sourceLine" id="cb84-8" title="8">                     corgraph<span class="op">$</span>graph<span class="op">$</span>Graph<span class="op">$</span>maximum)),</a>
<a class="sourceLine" id="cb84-9" title="9">       <span class="dt">label.scale =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<p><img src="baseline-networks_files/figure-html/individualAgreementBCTs-ggm-6.png" width="2100" /></p>
<div id="centrality-and-stability-1" class="section level3">
<h3>Centrality and stability</h3>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb85-1" title="1"></a>
<a class="sourceLine" id="cb85-2" title="2">combinedAgreementBcts_centralityPlot &lt;-<span class="st"> </span>qgraph<span class="op">::</span><span class="kw">centralityPlot</span>(bootnetgraph)</a></code></pre></div>
<p><img src="baseline-networks_files/figure-html/individualAgreementBCTs-stability-1.png" width="2100" /></p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb86-1" title="1"></a>
<a class="sourceLine" id="cb86-2" title="2">qgraph<span class="op">::</span><span class="kw">centralityPlot</span>(bootnetgraph, </a>
<a class="sourceLine" id="cb86-3" title="3">               <span class="dt">include =</span> <span class="kw">c</span>(<span class="st">&quot;Strength&quot;</span>, <span class="st">&quot;ExpectedInfluence&quot;</span>),</a>
<a class="sourceLine" id="cb86-4" title="4">               <span class="dt">orderBy =</span> <span class="st">&quot;ExpectedInfluence&quot;</span>)</a></code></pre></div>
<p><img src="baseline-networks_files/figure-html/individualAgreementBCTs-stability-2.png" width="2100" /></p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb87-1" title="1"></a>
<a class="sourceLine" id="cb87-2" title="2">qgraph<span class="op">::</span><span class="kw">centrality</span>(bootnetgraph)<span class="op">$</span>InDegree</a>
<a class="sourceLine" id="cb87-3" title="3"><span class="co">##                   PA selfrep             PA accelerometer </span></a>
<a class="sourceLine" id="cb87-4" title="4"><span class="co">##                    0.7344495                    0.8631169 </span></a>
<a class="sourceLine" id="cb87-5" title="5"><span class="co">##                 goal setting                     own plan </span></a>
<a class="sourceLine" id="cb87-6" title="6"><span class="co">##                    1.1122095                    1.4116131 </span></a>
<a class="sourceLine" id="cb87-7" title="7"><span class="co">##                plan by other             reminder of plan </span></a>
<a class="sourceLine" id="cb87-8" title="8"><span class="co">##                    0.9842937                    1.2430976 </span></a>
<a class="sourceLine" id="cb87-9" title="9"><span class="co">##                     subgoals                trying new PA </span></a>
<a class="sourceLine" id="cb87-10" title="10"><span class="co">##                    1.1106047                    0.9091887 </span></a>
<a class="sourceLine" id="cb87-11" title="11"><span class="co">##       barrier identification              problem solving </span></a>
<a class="sourceLine" id="cb87-12" title="12"><span class="co">##                    1.1354783                    1.4925863 </span></a>
<a class="sourceLine" id="cb87-13" title="13"><span class="co">##       PA identity reflection aligning PA with life values </span></a>
<a class="sourceLine" id="cb87-14" title="14"><span class="co">##                    1.2331688                    1.1865952</span></a>
<a class="sourceLine" id="cb87-15" title="15"><span class="kw">scale</span>(qgraph<span class="op">::</span><span class="kw">centrality</span>(bootnetgraph)<span class="op">$</span>InDegree)</a>
<a class="sourceLine" id="cb87-16" title="16"><span class="co">##                                     [,1]</span></a>
<a class="sourceLine" id="cb87-17" title="17"><span class="co">## PA selfrep                   -1.74080008</span></a>
<a class="sourceLine" id="cb87-18" title="18"><span class="co">## PA accelerometer             -1.15687559</span></a>
<a class="sourceLine" id="cb87-19" title="19"><span class="co">## goal setting                 -0.02643071</span></a>
<a class="sourceLine" id="cb87-20" title="20"><span class="co">## own plan                      1.33233746</span></a>
<a class="sourceLine" id="cb87-21" title="21"><span class="co">## plan by other                -0.60694500</span></a>
<a class="sourceLine" id="cb87-22" title="22"><span class="co">## reminder of plan              0.56757194</span></a>
<a class="sourceLine" id="cb87-23" title="23"><span class="co">## subgoals                     -0.03371369</span></a>
<a class="sourceLine" id="cb87-24" title="24"><span class="co">## trying new PA                -0.94778999</span></a>
<a class="sourceLine" id="cb87-25" title="25"><span class="co">## barrier identification        0.07916875</span></a>
<a class="sourceLine" id="cb87-26" title="26"><span class="co">## problem solving               1.69981413</span></a>
<a class="sourceLine" id="cb87-27" title="27"><span class="co">## PA identity reflection        0.52251267</span></a>
<a class="sourceLine" id="cb87-28" title="28"><span class="co">## aligning PA with life values  0.31115010</span></a>
<a class="sourceLine" id="cb87-29" title="29"><span class="co">## attr(,&quot;scaled:center&quot;)</span></a>
<a class="sourceLine" id="cb87-30" title="30"><span class="co">## [1] 1.118034</span></a>
<a class="sourceLine" id="cb87-31" title="31"><span class="co">## attr(,&quot;scaled:scale&quot;)</span></a>
<a class="sourceLine" id="cb87-32" title="32"><span class="co">## [1] 0.2203493</span></a>
<a class="sourceLine" id="cb87-33" title="33">qgraph<span class="op">::</span><span class="kw">centrality</span>(bootnetgraph)<span class="op">$</span>Closeness</a>
<a class="sourceLine" id="cb87-34" title="34"><span class="co">##                   PA selfrep             PA accelerometer </span></a>
<a class="sourceLine" id="cb87-35" title="35"><span class="co">##                  0.008799345                  0.010146721 </span></a>
<a class="sourceLine" id="cb87-36" title="36"><span class="co">##                 goal setting                     own plan </span></a>
<a class="sourceLine" id="cb87-37" title="37"><span class="co">##                  0.009564132                  0.009725691 </span></a>
<a class="sourceLine" id="cb87-38" title="38"><span class="co">##                plan by other             reminder of plan </span></a>
<a class="sourceLine" id="cb87-39" title="39"><span class="co">##                  0.009613141                  0.010388001 </span></a>
<a class="sourceLine" id="cb87-40" title="40"><span class="co">##                     subgoals                trying new PA </span></a>
<a class="sourceLine" id="cb87-41" title="41"><span class="co">##                  0.010313718                  0.009572614 </span></a>
<a class="sourceLine" id="cb87-42" title="42"><span class="co">##       barrier identification              problem solving </span></a>
<a class="sourceLine" id="cb87-43" title="43"><span class="co">##                  0.011045838                  0.011717843 </span></a>
<a class="sourceLine" id="cb87-44" title="44"><span class="co">##       PA identity reflection aligning PA with life values </span></a>
<a class="sourceLine" id="cb87-45" title="45"><span class="co">##                  0.009491669                  0.009750378</span></a>
<a class="sourceLine" id="cb87-46" title="46">qgraph<span class="op">::</span><span class="kw">centrality</span>(bootnetgraph)<span class="op">$</span>Betweenness</a>
<a class="sourceLine" id="cb87-47" title="47"><span class="co">##                   PA selfrep             PA accelerometer </span></a>
<a class="sourceLine" id="cb87-48" title="48"><span class="co">##                            4                            6 </span></a>
<a class="sourceLine" id="cb87-49" title="49"><span class="co">##                 goal setting                     own plan </span></a>
<a class="sourceLine" id="cb87-50" title="50"><span class="co">##                            8                           10 </span></a>
<a class="sourceLine" id="cb87-51" title="51"><span class="co">##                plan by other             reminder of plan </span></a>
<a class="sourceLine" id="cb87-52" title="52"><span class="co">##                           10                            8 </span></a>
<a class="sourceLine" id="cb87-53" title="53"><span class="co">##                     subgoals                trying new PA </span></a>
<a class="sourceLine" id="cb87-54" title="54"><span class="co">##                            4                            8 </span></a>
<a class="sourceLine" id="cb87-55" title="55"><span class="co">##       barrier identification              problem solving </span></a>
<a class="sourceLine" id="cb87-56" title="56"><span class="co">##                            6                           20 </span></a>
<a class="sourceLine" id="cb87-57" title="57"><span class="co">##       PA identity reflection aligning PA with life values </span></a>
<a class="sourceLine" id="cb87-58" title="58"><span class="co">##                            2                            6</span></a>
<a class="sourceLine" id="cb87-59" title="59"></a>
<a class="sourceLine" id="cb87-60" title="60"><span class="kw">cor</span>(qgraph<span class="op">::</span><span class="kw">centrality</span>(bootnetgraph)<span class="op">$</span>InDegree, qgraph<span class="op">::</span><span class="kw">centrality</span>(bootnetgraph)<span class="op">$</span>Betweenness, </a>
<a class="sourceLine" id="cb87-61" title="61">    <span class="dt">method =</span> <span class="st">&quot;spearman&quot;</span>) </a>
<a class="sourceLine" id="cb87-62" title="62"><span class="co">## [1] 0.3950803</span></a>
<a class="sourceLine" id="cb87-63" title="63"></a>
<a class="sourceLine" id="cb87-64" title="64"><span class="co"># bootnet_stability_individualAgreementBcts &lt;- bootnet::bootnet(individualAgreementBCTs, nBoots=1000)</span></a>
<a class="sourceLine" id="cb87-65" title="65"><span class="co"># save(bootnet_stability_individualAgreementBcts, file = &quot;./Rdata_files/bootnet_stability_individualAgreementBcts.Rdata&quot;)</span></a>
<a class="sourceLine" id="cb87-66" title="66"><span class="kw">load</span>(<span class="st">&quot;./Rdata_files/bootnet_stability_individualAgreementBcts.Rdata&quot;</span>)</a>
<a class="sourceLine" id="cb87-67" title="67"></a>
<a class="sourceLine" id="cb87-68" title="68"><span class="kw">plot</span>(bootnet_stability_individualAgreementBcts, <span class="dt">labels =</span> <span class="ot">TRUE</span>, <span class="dt">order =</span> <span class="st">&quot;sample&quot;</span>) </a></code></pre></div>
<p><img src="baseline-networks_files/figure-html/individualAgreementBCTs-stability-3.png" width="2100" /></p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb88-1" title="1"><span class="kw">plot</span>(bootnet_stability_individualAgreementBcts, <span class="st">&quot;edge&quot;</span>, <span class="dt">plot =</span> <span class="st">&quot;difference&quot;</span>, <span class="dt">onlyNonZero =</span> <span class="ot">TRUE</span>, <span class="dt">order =</span> <span class="st">&quot;sample&quot;</span>)</a></code></pre></div>
<p><img src="baseline-networks_files/figure-html/individualAgreementBCTs-stability-4.png" width="2100" /></p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb89-1" title="1"></a>
<a class="sourceLine" id="cb89-2" title="2"><span class="co"># bootnet_centrality_stability_individualAgreementBcts &lt;- bootnet::bootnet(individualAgreementBCTs, nBoots=1000,nCores=8, type=&quot;case&quot;)</span></a>
<a class="sourceLine" id="cb89-3" title="3"><span class="co"># save(bootnet_centrality_stability_individualAgreementBcts, file = &quot;./Rdata_files/bootnet_centrality_stability_individualAgreementBcts.Rdata&quot;)</span></a>
<a class="sourceLine" id="cb89-4" title="4"><span class="kw">load</span>(<span class="st">&quot;./Rdata_files/bootnet_centrality_stability_individualAgreementBcts.Rdata&quot;</span>)</a>
<a class="sourceLine" id="cb89-5" title="5"></a>
<a class="sourceLine" id="cb89-6" title="6"><span class="kw">plot</span>(bootnet_centrality_stability_individualAgreementBcts)</a></code></pre></div>
<p><img src="baseline-networks_files/figure-html/individualAgreementBCTs-stability-5.png" width="2100" /></p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb90-1" title="1"><span class="kw">plot</span>(bootnet_centrality_stability_individualAgreementBcts, <span class="dt">perNode=</span>T, <span class="st">&quot;strength&quot;</span>)</a></code></pre></div>
<p><img src="baseline-networks_files/figure-html/individualAgreementBCTs-stability-6.png" width="2100" /></p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb91-1" title="1"></a>
<a class="sourceLine" id="cb91-2" title="2">bootnet<span class="op">::</span><span class="kw">corStability</span>(bootnet_centrality_stability_individualAgreementBcts)</a>
<a class="sourceLine" id="cb91-3" title="3"><span class="co">## === Correlation Stability Analysis === </span></a>
<a class="sourceLine" id="cb91-4" title="4"><span class="co">## </span></a>
<a class="sourceLine" id="cb91-5" title="5"><span class="co">## Sampling levels tested:</span></a>
<a class="sourceLine" id="cb91-6" title="6"><span class="co">##    nPerson Drop%   n</span></a>
<a class="sourceLine" id="cb91-7" title="7"><span class="co">## 1      291  75.0  96</span></a>
<a class="sourceLine" id="cb91-8" title="8"><span class="co">## 2      382  67.2 101</span></a>
<a class="sourceLine" id="cb91-9" title="9"><span class="co">## 3      472  59.5  95</span></a>
<a class="sourceLine" id="cb91-10" title="10"><span class="co">## 4      563  51.7 104</span></a>
<a class="sourceLine" id="cb91-11" title="11"><span class="co">## 5      654  43.9  94</span></a>
<a class="sourceLine" id="cb91-12" title="12"><span class="co">## 6      744  36.1 112</span></a>
<a class="sourceLine" id="cb91-13" title="13"><span class="co">## 7      835  28.3 107</span></a>
<a class="sourceLine" id="cb91-14" title="14"><span class="co">## 8      926  20.5 109</span></a>
<a class="sourceLine" id="cb91-15" title="15"><span class="co">## 9     1016  12.8  90</span></a>
<a class="sourceLine" id="cb91-16" title="16"><span class="co">## 10    1107   5.0  92</span></a>
<a class="sourceLine" id="cb91-17" title="17"><span class="co">## </span></a>
<a class="sourceLine" id="cb91-18" title="18"><span class="co">## Maximum drop proportions to retain correlation of 0.7 in at least 95% of the samples:</span></a>
<a class="sourceLine" id="cb91-19" title="19"><span class="co">## </span></a>
<a class="sourceLine" id="cb91-20" title="20"><span class="co">## betweenness: 0 </span></a>
<a class="sourceLine" id="cb91-21" title="21"><span class="co">##   - For more accuracy, run bootnet(..., caseMin = 0, caseMax = 0.05) </span></a>
<a class="sourceLine" id="cb91-22" title="22"><span class="co">## </span></a>
<a class="sourceLine" id="cb91-23" title="23"><span class="co">## closeness: 0.05 (CS-coefficient is lowest level tested)</span></a>
<a class="sourceLine" id="cb91-24" title="24"><span class="co">##   - For more accuracy, run bootnet(..., caseMin = 0, caseMax = 0.128) </span></a>
<a class="sourceLine" id="cb91-25" title="25"><span class="co">## </span></a>
<a class="sourceLine" id="cb91-26" title="26"><span class="co">## edge: 0.672 </span></a>
<a class="sourceLine" id="cb91-27" title="27"><span class="co">##   - For more accuracy, run bootnet(..., caseMin = 0.595, caseMax = 0.75) </span></a>
<a class="sourceLine" id="cb91-28" title="28"><span class="co">## </span></a>
<a class="sourceLine" id="cb91-29" title="29"><span class="co">## strength: 0.283 </span></a>
<a class="sourceLine" id="cb91-30" title="30"><span class="co">##   - For more accuracy, run bootnet(..., caseMin = 0.205, caseMax = 0.361) </span></a>
<a class="sourceLine" id="cb91-31" title="31"><span class="co">## </span></a>
<a class="sourceLine" id="cb91-32" title="32"><span class="co">## Accuracy can also be increased by increasing both &#39;nBoots&#39; and &#39;caseN&#39;.</span></a></code></pre></div>
</div>
</div>
</div>
<div id="combined-agreement-related-bcts-and-pa" class="section level1">
<h1>Combined agreement-related BCTs and PA</h1>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb92-1" title="1"></a>
<a class="sourceLine" id="cb92-2" title="2">bctdf_pa_combinedAgreementBcts &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(</a>
<a class="sourceLine" id="cb92-3" title="3">  <span class="st">&#39;PA selfrep&#39;</span> =<span class="st"> </span>padaysLastweek_T1,</a>
<a class="sourceLine" id="cb92-4" title="4">  <span class="st">&#39;PA accelerometer&#39;</span> =<span class="st"> </span>mvpaAccelerometer_T1,</a>
<a class="sourceLine" id="cb92-5" title="5">  <span class="st">&#39;goal setting&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">01</span>_T1,</a>
<a class="sourceLine" id="cb92-6" title="6">  <span class="st">&#39;own plan&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">02</span>_T1,</a>
<a class="sourceLine" id="cb92-7" title="7">  <span class="st">&#39;plan by other&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">03</span>_T1,</a>
<a class="sourceLine" id="cb92-8" title="8">  <span class="st">&#39;reminder of plan&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">04</span>_T1,</a>
<a class="sourceLine" id="cb92-9" title="9">  <span class="st">&#39;subgoals&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">05</span>_T1,</a>
<a class="sourceLine" id="cb92-10" title="10">  <span class="st">&#39;trying new PA&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">06</span>_T1,</a>
<a class="sourceLine" id="cb92-11" title="11">  <span class="st">&#39;barrier identification&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">07</span>_T1,</a>
<a class="sourceLine" id="cb92-12" title="12">  <span class="st">&#39;problem solving&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">08</span>_T1,</a>
<a class="sourceLine" id="cb92-13" title="13">  <span class="st">&#39;PA identity reflection&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">09</span>_T1,</a>
<a class="sourceLine" id="cb92-14" title="14">  <span class="st">&#39;aligning PA with life values&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">10</span>_T1) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb92-15" title="15"><span class="st"> </span><span class="kw">rowwise</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb92-16" title="16"><span class="st"> </span><span class="kw">mutate</span>(</a>
<a class="sourceLine" id="cb92-17" title="17">  <span class="st">&#39;goal setting&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">goal setting</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb92-18" title="18">  <span class="st">&#39;has plan&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">own plan</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span> <span class="op">&amp;</span><span class="st"> `</span><span class="dt">plan by other</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb92-19" title="19">  <span class="co"># &#39;own plan&#39; = ifelse(`own plan` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb92-20" title="20">  <span class="st">&#39;reminder of plan&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">reminder of plan</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb92-21" title="21">  <span class="st">&#39;subgoals&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">subgoals</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb92-22" title="22">  <span class="st">&#39;trying new PA&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">trying new PA</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb92-23" title="23">  <span class="co"># &#39;plan by other&#39; = ifelse(`plan by other` == 1, 0, 1), </span></a>
<a class="sourceLine" id="cb92-24" title="24">  <span class="co"># &#39;barrier identification&#39; = ifelse(`barrier identification` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb92-25" title="25">  <span class="co"># &#39;problem solving&#39; = ifelse(`problem solving` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb92-26" title="26">  <span class="st">&#39;barriers identified or planned for&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">problem solving</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span> <span class="op">&amp;</span><span class="st"> `</span><span class="dt">barrier identification</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb92-27" title="27">  <span class="co"># &#39;PA identity reflection&#39; = ifelse(`PA identity reflection` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb92-28" title="28">  <span class="co"># &#39;aligning PA with life values&#39; = ifelse(`aligning PA with life values` == 1, 0, 1)) %&gt;% </span></a>
<a class="sourceLine" id="cb92-29" title="29">  <span class="st">&#39;identity, life values&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">PA identity reflection</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span> <span class="op">&amp;</span><span class="st"> `</span><span class="dt">aligning PA with life values</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb92-30" title="30"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span><span class="st">`</span><span class="dt">plan by other</span><span class="st">`</span>, <span class="op">-</span><span class="st">`</span><span class="dt">own plan</span><span class="st">`</span>,</a>
<a class="sourceLine" id="cb92-31" title="31">         <span class="op">-</span><span class="st">`</span><span class="dt">barrier identification</span><span class="st">`</span>, <span class="op">-</span><span class="st">`</span><span class="dt">problem solving</span><span class="st">`</span>, <span class="co"># closely related</span></a>
<a class="sourceLine" id="cb92-32" title="32">         <span class="op">-</span><span class="st">`</span><span class="dt">PA identity reflection</span><span class="st">`</span>, <span class="op">-</span><span class="st">`</span><span class="dt">aligning PA with life values</span><span class="st">`</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># closely related</span></a>
<a class="sourceLine" id="cb92-33" title="33"><span class="st">  </span><span class="kw">mutate_all</span>(as.numeric)</a></code></pre></div>
<div id="mgm-estimation-2" class="section level4">
<h4>mgm estimation</h4>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb93-1" title="1"><span class="co"># devtools::install_github(&quot;jmbh/mgm&quot;)</span></a>
<a class="sourceLine" id="cb93-2" title="2"><span class="co"># Restart R for the latest package</span></a>
<a class="sourceLine" id="cb93-3" title="3"><span class="co"># .r.restartR()</span></a>
<a class="sourceLine" id="cb93-4" title="4"></a>
<a class="sourceLine" id="cb93-5" title="5"><span class="co"># mgm wants full data, see package missForest for imputation</span></a>
<a class="sourceLine" id="cb93-6" title="6">bctdf_pa_combinedAgreementBcts &lt;-<span class="st"> </span>bctdf_pa_combinedAgreementBcts <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">na.omit</span>()</a>
<a class="sourceLine" id="cb93-7" title="7"><span class="co"># bctdf_pa_combinedAgreementBcts %&gt;% names()</span></a>
<a class="sourceLine" id="cb93-8" title="8">mgm_pa_variable_types &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;g&quot;</span>, <span class="st">&quot;g&quot;</span>, <span class="kw">rep</span>(<span class="st">&quot;c&quot;</span>, <span class="dv">7</span>))</a>
<a class="sourceLine" id="cb93-9" title="9">mgm_pa_variable_levels &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;1&quot;</span>, <span class="st">&quot;1&quot;</span>, <span class="kw">rep</span>(<span class="st">&quot;2&quot;</span>, <span class="dv">7</span>))</a>
<a class="sourceLine" id="cb93-10" title="10"><span class="co"># data.frame(mgm_pa_variable_types, mgm_pa_variable_levels, names(bctdf_pa_combinedAgreementBcts))</span></a>
<a class="sourceLine" id="cb93-11" title="11"></a>
<a class="sourceLine" id="cb93-12" title="12">mgm_obj &lt;-<span class="st"> </span>mgm<span class="op">::</span><span class="kw">mgm</span>(<span class="dt">data =</span> bctdf_pa_combinedAgreementBcts,</a>
<a class="sourceLine" id="cb93-13" title="13">  <span class="dt">type =</span> mgm_pa_variable_types,</a>
<a class="sourceLine" id="cb93-14" title="14">  <span class="dt">level =</span> mgm_pa_variable_levels,</a>
<a class="sourceLine" id="cb93-15" title="15">  <span class="dt">lambdaSel =</span> <span class="st">&quot;CV&quot;</span>,</a>
<a class="sourceLine" id="cb93-16" title="16">  <span class="dt">lambdaFolds =</span> <span class="dv">10</span>,</a>
<a class="sourceLine" id="cb93-17" title="17">  <span class="dt">pbar =</span> <span class="ot">FALSE</span>, </a>
<a class="sourceLine" id="cb93-18" title="18">  <span class="dt">binarySign =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb93-19" title="19"><span class="co">## Note that the sign of parameter estimates is stored separately; see ?mgm</span></a>
<a class="sourceLine" id="cb93-20" title="20"></a>
<a class="sourceLine" id="cb93-21" title="21">pred_obj &lt;-<span class="st"> </span><span class="kw">predict</span>(<span class="dt">object =</span> mgm_obj,</a>
<a class="sourceLine" id="cb93-22" title="22">                         <span class="dt">data =</span> bctdf_pa_combinedAgreementBcts)</a>
<a class="sourceLine" id="cb93-23" title="23"></a>
<a class="sourceLine" id="cb93-24" title="24">pred_obj<span class="op">$</span>errors</a></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Variable"],"name":[1],"type":["chr"],"align":["left"]},{"label":["RMSE"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["R2"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["CC"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["nCC"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["CCmarg"],"name":[6],"type":["dbl"],"align":["right"]}],"data":[{"1":"PA selfrep","2":"0.897","3":"0.194","4":"NA","5":"NA","6":"NA","_rn_":"1"},{"1":"PA accelerometer","2":"0.952","3":"0.092","4":"NA","5":"NA","6":"NA","_rn_":"2"},{"1":"goal setting","2":"NA","3":"NA","4":"0.898","5":"0.552","6":"0.772","_rn_":"3"},{"1":"reminder of plan","2":"NA","3":"NA","4":"0.830","5":"0.631","6":"0.539","_rn_":"4"},{"1":"subgoals","2":"NA","3":"NA","4":"0.857","5":"0.633","6":"0.610","_rn_":"5"},{"1":"trying new PA","2":"NA","3":"NA","4":"0.829","5":"0.367","6":"0.730","_rn_":"6"},{"1":"has plan","2":"NA","3":"NA","4":"0.887","5":"0.584","6":"0.728","_rn_":"7"},{"1":"barriers identified or planned for","2":"NA","3":"NA","4":"0.883","5":"0.426","6":"0.796","_rn_":"8"},{"1":"identity, life values","2":"NA","3":"NA","4":"0.924","5":"0.415","6":"0.870","_rn_":"9"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb94-1" title="1"></a>
<a class="sourceLine" id="cb94-2" title="2"><span class="co"># Take R2 from gaussian, CC from categorical variables </span></a>
<a class="sourceLine" id="cb94-3" title="3">pie_errors &lt;-<span class="st"> </span><span class="kw">c</span>(pred_obj<span class="op">$</span>errors[<span class="dv">1</span>, <span class="dv">3</span>],</a>
<a class="sourceLine" id="cb94-4" title="4">                pred_obj<span class="op">$</span>errors[<span class="dv">2</span>, <span class="dv">3</span>],</a>
<a class="sourceLine" id="cb94-5" title="5">                pred_obj<span class="op">$</span>errors[<span class="dv">3</span><span class="op">:</span><span class="kw">nrow</span>(pred_obj<span class="op">$</span>errors), <span class="dv">4</span>])</a>
<a class="sourceLine" id="cb94-6" title="6"></a>
<a class="sourceLine" id="cb94-7" title="7"><span class="co"># PLOT NETWORK </span></a>
<a class="sourceLine" id="cb94-8" title="8"></a>
<a class="sourceLine" id="cb94-9" title="9">node_colors &lt;-<span class="st"> </span><span class="kw">c</span>(viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">begin =</span> <span class="fl">0.3</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">1</span>], </a>
<a class="sourceLine" id="cb94-10" title="10">                 viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">begin =</span> <span class="fl">0.3</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">2</span>],</a>
<a class="sourceLine" id="cb94-11" title="11">                 <span class="kw">rep</span>(viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">begin =</span> <span class="fl">0.3</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">3</span>], <span class="dv">7</span>))</a>
<a class="sourceLine" id="cb94-12" title="12"></a>
<a class="sourceLine" id="cb94-13" title="13">BCT_mgm &lt;-<span class="st"> </span>qgraph<span class="op">::</span><span class="kw">qgraph</span>(mgm_obj<span class="op">$</span>pairwise<span class="op">$</span>wadj, </a>
<a class="sourceLine" id="cb94-14" title="14">            <span class="dt">layout =</span> <span class="st">&quot;spring&quot;</span>,</a>
<a class="sourceLine" id="cb94-15" title="15">            <span class="dt">repulsion =</span> <span class="dv">1</span>, <span class="co"># To nudge the network from originally bad visual state</span></a>
<a class="sourceLine" id="cb94-16" title="16">            <span class="dt">title =</span> <span class="st">&quot;agreement-measured BCTs and PA&quot;</span>,</a>
<a class="sourceLine" id="cb94-17" title="17">            <span class="dt">edge.color =</span> <span class="kw">ifelse</span>(mgm_obj<span class="op">$</span>pairwise<span class="op">$</span>edgecolor <span class="op">==</span><span class="st"> &quot;darkgreen&quot;</span>, <span class="st">&quot;blue&quot;</span>, mgm_obj<span class="op">$</span>pairwise<span class="op">$</span>edgecolor),</a>
<a class="sourceLine" id="cb94-18" title="18">            <span class="dt">pie =</span> pie_errors,</a>
<a class="sourceLine" id="cb94-19" title="19">            <span class="dt">pieColor =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">begin =</span> <span class="fl">0.3</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">4</span>],</a>
<a class="sourceLine" id="cb94-20" title="20">            <span class="dt">color =</span> node_colors,</a>
<a class="sourceLine" id="cb94-21" title="21">            <span class="dt">labels =</span> <span class="kw">names</span>(bctdf_pa_combinedAgreementBcts),</a>
<a class="sourceLine" id="cb94-22" title="22">            <span class="dt">label.cex =</span> <span class="fl">0.75</span>,</a>
<a class="sourceLine" id="cb94-23" title="23">            <span class="dt">label.scale =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb94-24" title="24">            <span class="dt">label.color =</span> <span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">&quot;black&quot;</span>, <span class="dv">9</span>)))</a></code></pre></div>
<p><img src="baseline-networks_files/figure-html/combinedAgreementBcts-mgm-1.png" width="2100" /></p>
</div>
<div id="ggm-plot" class="section level2">
<h2>GGM plot</h2>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb95-1" title="1"></a>
<a class="sourceLine" id="cb95-2" title="2">combinedAgreementBcts_ggm_df &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(</a>
<a class="sourceLine" id="cb95-3" title="3">  <span class="st">&#39;PA selfrep&#39;</span> =<span class="st"> </span>padaysLastweek_T1,</a>
<a class="sourceLine" id="cb95-4" title="4">  <span class="st">&#39;PA accelerometer&#39;</span> =<span class="st"> </span>mvpaAccelerometer_T1,</a>
<a class="sourceLine" id="cb95-5" title="5">  <span class="st">&#39;goal setting&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">01</span>_T1,</a>
<a class="sourceLine" id="cb95-6" title="6">  <span class="st">&#39;own plan&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">02</span>_T1,</a>
<a class="sourceLine" id="cb95-7" title="7">  <span class="st">&#39;plan by other&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">03</span>_T1,</a>
<a class="sourceLine" id="cb95-8" title="8">  <span class="st">&#39;reminder of plan&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">04</span>_T1,</a>
<a class="sourceLine" id="cb95-9" title="9">  <span class="st">&#39;subgoals&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">05</span>_T1,</a>
<a class="sourceLine" id="cb95-10" title="10">  <span class="st">&#39;trying new PA&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">06</span>_T1,</a>
<a class="sourceLine" id="cb95-11" title="11">  <span class="st">&#39;barrier identification&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">07</span>_T1,</a>
<a class="sourceLine" id="cb95-12" title="12">  <span class="st">&#39;problem solving&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">08</span>_T1,</a>
<a class="sourceLine" id="cb95-13" title="13">  <span class="st">&#39;PA identity reflection&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">09</span>_T1,</a>
<a class="sourceLine" id="cb95-14" title="14">  <span class="st">&#39;aligning PA with life values&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">10</span>_T1) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb95-15" title="15"><span class="st"> </span><span class="kw">rowwise</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb95-16" title="16"><span class="st"> </span><span class="kw">mutate</span>(</a>
<a class="sourceLine" id="cb95-17" title="17">  <span class="st">&#39;has plan&#39;</span> =<span class="st"> </span><span class="kw">mean</span>(<span class="kw">c</span>(<span class="st">`</span><span class="dt">own plan</span><span class="st">`</span>, <span class="st">`</span><span class="dt">plan by other</span><span class="st">`</span>), <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb95-18" title="18">  <span class="st">&#39;barriers identified or planned for&#39;</span> =<span class="st"> </span><span class="kw">mean</span>(<span class="kw">c</span>(<span class="st">`</span><span class="dt">problem solving</span><span class="st">`</span>, <span class="st">`</span><span class="dt">barrier identification</span><span class="st">`</span>), <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb95-19" title="19">  <span class="st">&#39;identity, life values&#39;</span> =<span class="st"> </span><span class="kw">mean</span>(<span class="kw">c</span>(<span class="st">`</span><span class="dt">PA identity reflection</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="st">`</span><span class="dt">aligning PA with life values</span><span class="st">`</span>), <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb95-20" title="20"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span><span class="st">`</span><span class="dt">plan by other</span><span class="st">`</span>, <span class="op">-</span><span class="st">`</span><span class="dt">own plan</span><span class="st">`</span>, </a>
<a class="sourceLine" id="cb95-21" title="21">         <span class="op">-</span><span class="st">`</span><span class="dt">barrier identification</span><span class="st">`</span>, <span class="op">-</span><span class="st">`</span><span class="dt">problem solving</span><span class="st">`</span>, <span class="co"># closely related</span></a>
<a class="sourceLine" id="cb95-22" title="22">         <span class="op">-</span><span class="st">`</span><span class="dt">PA identity reflection</span><span class="st">`</span>, <span class="op">-</span><span class="st">`</span><span class="dt">aligning PA with life values</span><span class="st">`</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># closely related</span></a>
<a class="sourceLine" id="cb95-23" title="23"><span class="st">  </span><span class="kw">mutate_all</span>(as.numeric)</a>
<a class="sourceLine" id="cb95-24" title="24"></a>
<a class="sourceLine" id="cb95-25" title="25"><span class="co"># Create means for filling nodes</span></a>
<a class="sourceLine" id="cb95-26" title="26"><span class="co"># piefill_ggm &lt;- S.total_ggm %&gt;% </span></a>
<a class="sourceLine" id="cb95-27" title="27"><span class="co">#   dplyr::select(-contains(&quot;MVPA&quot;), -girl, -intervention) %&gt;%</span></a>
<a class="sourceLine" id="cb95-28" title="28"><span class="co">#   summarise_all(funs(median(., na.rm = TRUE) / 6)) </span></a>
<a class="sourceLine" id="cb95-29" title="29"><span class="co"># </span></a>
<a class="sourceLine" id="cb95-30" title="30"><span class="co"># piefill_ggm$MVPA &lt;- median(S.total_ggm$MVPA, na.rm = TRUE) / (60*24) </span></a>
<a class="sourceLine" id="cb95-31" title="31"><span class="co"># piefill_ggm$girl &lt;- mean(S.total_ggm$girl, na.rm = TRUE)</span></a>
<a class="sourceLine" id="cb95-32" title="32"><span class="co"># piefill_ggm$intervention &lt;- mean(S.total_ggm$intervention, na.rm = TRUE)</span></a>
<a class="sourceLine" id="cb95-33" title="33"><span class="co"># </span></a>
<a class="sourceLine" id="cb95-34" title="34"><span class="co"># piefill_ggm &lt;- piefill_ggm %&gt;% dplyr::select(MVPA, girl, intervention, everything())</span></a></code></pre></div>
<p><img src="baseline-networks_files/figure-html/combinedAgreementBcts-ggm-1.png" width="2100" /><img src="baseline-networks_files/figure-html/combinedAgreementBcts-ggm-2.png" width="2100" /><img src="baseline-networks_files/figure-html/combinedAgreementBcts-ggm-3.png" width="2100" /></p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb96-1" title="1"></a>
<a class="sourceLine" id="cb96-2" title="2"></a>
<a class="sourceLine" id="cb96-3" title="3"><span class="co"># Average the layout of three previous plots, and plot each according to that</span></a>
<a class="sourceLine" id="cb96-4" title="4">avlayout &lt;-<span class="st"> </span>qgraph<span class="op">::</span><span class="kw">averageLayout</span>(bootnetgraph, corgraph, pcorgraph)</a>
<a class="sourceLine" id="cb96-5" title="5"></a>
<a class="sourceLine" id="cb96-6" title="6">corgraph &lt;-<span class="st"> </span>qgraph<span class="op">::</span><span class="kw">qgraph</span>(qgraph<span class="op">::</span><span class="kw">cor_auto</span>(combinedAgreementBcts_ggm_df), <span class="dt">graph =</span> <span class="st">&quot;cor&quot;</span>,</a>
<a class="sourceLine" id="cb96-7" title="7">       <span class="dt">labels =</span> <span class="kw">names</span>(combinedAgreementBcts_ggm_df),</a>
<a class="sourceLine" id="cb96-8" title="8">       <span class="dt">edge.labels =</span> <span class="ot">TRUE</span>, </a>
<a class="sourceLine" id="cb96-9" title="9">       <span class="dt">layout =</span> avlayout, </a>
<a class="sourceLine" id="cb96-10" title="10">       <span class="dt">title =</span> <span class="st">&quot;bivariate correlation network&quot;</span>,</a>
<a class="sourceLine" id="cb96-11" title="11">       <span class="dt">theme =</span> <span class="st">&quot;colorblind&quot;</span>,</a>
<a class="sourceLine" id="cb96-12" title="12">       <span class="dt">maximum =</span> <span class="kw">max</span>(<span class="kw">c</span>(bootnetgraph<span class="op">$</span>graph<span class="op">$</span>Graph<span class="op">$</span>maximum,</a>
<a class="sourceLine" id="cb96-13" title="13">                     pcorgraph<span class="op">$</span>graph<span class="op">$</span>Graph<span class="op">$</span>maximum, </a>
<a class="sourceLine" id="cb96-14" title="14">                     corgraph<span class="op">$</span>graph<span class="op">$</span>Graph<span class="op">$</span>maximum)),</a>
<a class="sourceLine" id="cb96-15" title="15">       <span class="dt">label.scale =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<p><img src="baseline-networks_files/figure-html/combinedAgreementBcts-ggm2-1.png" width="2100" /></p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb97-1" title="1"></a>
<a class="sourceLine" id="cb97-2" title="2"><span class="co"># To help with visual comparison, that last argument takes the maximum edge of the three </span></a>
<a class="sourceLine" id="cb97-3" title="3"><span class="co"># graphs and places that as the benchmark for the thickest line in all plots.</span></a>
<a class="sourceLine" id="cb97-4" title="4"></a>
<a class="sourceLine" id="cb97-5" title="5">pcorgraph &lt;-<span class="st"> </span>qgraph<span class="op">::</span><span class="kw">qgraph</span>(qgraph<span class="op">::</span><span class="kw">cor_auto</span>(combinedAgreementBcts_ggm_df), <span class="dt">graph =</span> <span class="st">&quot;pcor&quot;</span>,</a>
<a class="sourceLine" id="cb97-6" title="6">       <span class="dt">labels =</span> <span class="kw">names</span>(combinedAgreementBcts_ggm_df),</a>
<a class="sourceLine" id="cb97-7" title="7">       <span class="dt">edge.labels =</span> <span class="ot">TRUE</span>, </a>
<a class="sourceLine" id="cb97-8" title="8">       <span class="dt">layout =</span> avlayout,</a>
<a class="sourceLine" id="cb97-9" title="9">       <span class="dt">title =</span> <span class="st">&quot;partial correlation network&quot;</span>,</a>
<a class="sourceLine" id="cb97-10" title="10">       <span class="dt">theme =</span> <span class="st">&quot;colorblind&quot;</span>,</a>
<a class="sourceLine" id="cb97-11" title="11">       <span class="dt">maximum =</span> <span class="kw">max</span>(<span class="kw">c</span>(bootnetgraph<span class="op">$</span>graph<span class="op">$</span>Graph<span class="op">$</span>maximum,</a>
<a class="sourceLine" id="cb97-12" title="12">                     pcorgraph<span class="op">$</span>graph<span class="op">$</span>Graph<span class="op">$</span>maximum, </a>
<a class="sourceLine" id="cb97-13" title="13">                     corgraph<span class="op">$</span>graph<span class="op">$</span>Graph<span class="op">$</span>maximum)),</a>
<a class="sourceLine" id="cb97-14" title="14">       <span class="dt">label.scale =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<p><img src="baseline-networks_files/figure-html/combinedAgreementBcts-ggm2-2.png" width="2100" /></p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb98-1" title="1"></a>
<a class="sourceLine" id="cb98-2" title="2">bootnetgraph &lt;-<span class="st"> </span><span class="kw">plot</span>(combinedAgreementBcts_network, </a>
<a class="sourceLine" id="cb98-3" title="3">                     <span class="dt">edge.labels =</span> <span class="ot">TRUE</span>, </a>
<a class="sourceLine" id="cb98-4" title="4">                     <span class="dt">layout =</span> avlayout, </a>
<a class="sourceLine" id="cb98-5" title="5">                     <span class="dt">title =</span> <span class="st">&quot;partial correlation network, with LASSO regularisation and EBIC model selection&quot;</span>,</a>
<a class="sourceLine" id="cb98-6" title="6">       <span class="dt">maximum =</span> <span class="kw">max</span>(<span class="kw">c</span>(bootnetgraph<span class="op">$</span>graph<span class="op">$</span>Graph<span class="op">$</span>maximum,</a>
<a class="sourceLine" id="cb98-7" title="7">                     pcorgraph<span class="op">$</span>graph<span class="op">$</span>Graph<span class="op">$</span>maximum, </a>
<a class="sourceLine" id="cb98-8" title="8">                     corgraph<span class="op">$</span>graph<span class="op">$</span>Graph<span class="op">$</span>maximum)),</a>
<a class="sourceLine" id="cb98-9" title="9">       <span class="dt">label.scale =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<p><img src="baseline-networks_files/figure-html/combinedAgreementBcts-ggm2-3.png" width="2100" /></p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb99-1" title="1"></a>
<a class="sourceLine" id="cb99-2" title="2">qgraph<span class="op">::</span><span class="kw">flow</span>(bootnetgraph, <span class="st">&quot;PA selfrep&quot;</span>, <span class="dt">theme =</span> <span class="st">&quot;colorblind&quot;</span>, <span class="dt">vsize =</span> <span class="dv">8</span>)</a></code></pre></div>
<p><img src="baseline-networks_files/figure-html/combinedAgreementBcts-ggm2-4.png" width="2100" /></p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb100-1" title="1">qgraph<span class="op">::</span><span class="kw">flow</span>(bootnetgraph, <span class="st">&quot;PA accelerometer&quot;</span>, <span class="dt">theme =</span> <span class="st">&quot;colorblind&quot;</span>, <span class="dt">vsize =</span> <span class="dv">8</span>)</a></code></pre></div>
<p><img src="baseline-networks_files/figure-html/combinedAgreementBcts-ggm2-5.png" width="2100" /></p>
<div id="centrality-and-stability-2" class="section level3">
<h3>Centrality and stability</h3>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb101-1" title="1">combinedAgreementBcts_centralityPlot &lt;-<span class="st"> </span>qgraph<span class="op">::</span><span class="kw">centralityPlot</span>(bootnetgraph)</a></code></pre></div>
<p><img src="baseline-networks_files/figure-html/combinedAgreementBcts-stability-1.png" width="2100" /></p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb102-1" title="1"></a>
<a class="sourceLine" id="cb102-2" title="2">qgraph<span class="op">::</span><span class="kw">centralityPlot</span>(bootnetgraph, </a>
<a class="sourceLine" id="cb102-3" title="3">               <span class="dt">include =</span> <span class="kw">c</span>(<span class="st">&quot;Strength&quot;</span>, <span class="st">&quot;ExpectedInfluence&quot;</span>),</a>
<a class="sourceLine" id="cb102-4" title="4">               <span class="dt">orderBy =</span> <span class="st">&quot;ExpectedInfluence&quot;</span>)</a></code></pre></div>
<p><img src="baseline-networks_files/figure-html/combinedAgreementBcts-stability-2.png" width="2100" /></p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb103-1" title="1"></a>
<a class="sourceLine" id="cb103-2" title="2">qgraph<span class="op">::</span><span class="kw">centrality</span>(bootnetgraph)<span class="op">$</span>InDegree</a>
<a class="sourceLine" id="cb103-3" title="3"><span class="co">##                         PA selfrep                   PA accelerometer </span></a>
<a class="sourceLine" id="cb103-4" title="4"><span class="co">##                          0.6439006                          0.4139822 </span></a>
<a class="sourceLine" id="cb103-5" title="5"><span class="co">##                       goal setting                   reminder of plan </span></a>
<a class="sourceLine" id="cb103-6" title="6"><span class="co">##                          0.9839638                          0.9221817 </span></a>
<a class="sourceLine" id="cb103-7" title="7"><span class="co">##                           subgoals                      trying new PA </span></a>
<a class="sourceLine" id="cb103-8" title="8"><span class="co">##                          1.1136877                          0.9082713 </span></a>
<a class="sourceLine" id="cb103-9" title="9"><span class="co">##                           has plan barriers identified or planned for </span></a>
<a class="sourceLine" id="cb103-10" title="10"><span class="co">##                          1.0168465                          0.9585078 </span></a>
<a class="sourceLine" id="cb103-11" title="11"><span class="co">##              identity, life values </span></a>
<a class="sourceLine" id="cb103-12" title="12"><span class="co">##                          0.7721001</span></a>
<a class="sourceLine" id="cb103-13" title="13"><span class="kw">scale</span>(qgraph<span class="op">::</span><span class="kw">centrality</span>(bootnetgraph)<span class="op">$</span>InDegree)</a>
<a class="sourceLine" id="cb103-14" title="14"><span class="co">##                                          [,1]</span></a>
<a class="sourceLine" id="cb103-15" title="15"><span class="co">## PA selfrep                         -0.9966457</span></a>
<a class="sourceLine" id="cb103-16" title="16"><span class="co">## PA accelerometer                   -2.0606123</span></a>
<a class="sourceLine" id="cb103-17" title="17"><span class="co">## goal setting                        0.5770250</span></a>
<a class="sourceLine" id="cb103-18" title="18"><span class="co">## reminder of plan                    0.2911230</span></a>
<a class="sourceLine" id="cb103-19" title="19"><span class="co">## subgoals                            1.1773331</span></a>
<a class="sourceLine" id="cb103-20" title="20"><span class="co">## trying new PA                       0.2267515</span></a>
<a class="sourceLine" id="cb103-21" title="21"><span class="co">## has plan                            0.7291924</span></a>
<a class="sourceLine" id="cb103-22" title="22"><span class="co">## barriers identified or planned for  0.4592252</span></a>
<a class="sourceLine" id="cb103-23" title="23"><span class="co">## identity, life values              -0.4033922</span></a>
<a class="sourceLine" id="cb103-24" title="24"><span class="co">## attr(,&quot;scaled:center&quot;)</span></a>
<a class="sourceLine" id="cb103-25" title="25"><span class="co">## [1] 0.8592713</span></a>
<a class="sourceLine" id="cb103-26" title="26"><span class="co">## attr(,&quot;scaled:scale&quot;)</span></a>
<a class="sourceLine" id="cb103-27" title="27"><span class="co">## [1] 0.2160955</span></a>
<a class="sourceLine" id="cb103-28" title="28">qgraph<span class="op">::</span><span class="kw">centrality</span>(bootnetgraph)<span class="op">$</span>Closeness</a>
<a class="sourceLine" id="cb103-29" title="29"><span class="co">##                         PA selfrep                   PA accelerometer </span></a>
<a class="sourceLine" id="cb103-30" title="30"><span class="co">##                        0.013000598                        0.009176838 </span></a>
<a class="sourceLine" id="cb103-31" title="31"><span class="co">##                       goal setting                   reminder of plan </span></a>
<a class="sourceLine" id="cb103-32" title="32"><span class="co">##                        0.015436687                        0.015510837 </span></a>
<a class="sourceLine" id="cb103-33" title="33"><span class="co">##                           subgoals                      trying new PA </span></a>
<a class="sourceLine" id="cb103-34" title="34"><span class="co">##                        0.014690024                        0.014307331 </span></a>
<a class="sourceLine" id="cb103-35" title="35"><span class="co">##                           has plan barriers identified or planned for </span></a>
<a class="sourceLine" id="cb103-36" title="36"><span class="co">##                        0.015808026                        0.013765434 </span></a>
<a class="sourceLine" id="cb103-37" title="37"><span class="co">##              identity, life values </span></a>
<a class="sourceLine" id="cb103-38" title="38"><span class="co">##                        0.013154367</span></a>
<a class="sourceLine" id="cb103-39" title="39">qgraph<span class="op">::</span><span class="kw">centrality</span>(bootnetgraph)<span class="op">$</span>Betweenness</a>
<a class="sourceLine" id="cb103-40" title="40"><span class="co">##                         PA selfrep                   PA accelerometer </span></a>
<a class="sourceLine" id="cb103-41" title="41"><span class="co">##                                 14                                  0 </span></a>
<a class="sourceLine" id="cb103-42" title="42"><span class="co">##                       goal setting                   reminder of plan </span></a>
<a class="sourceLine" id="cb103-43" title="43"><span class="co">##                                  4                                  8 </span></a>
<a class="sourceLine" id="cb103-44" title="44"><span class="co">##                           subgoals                      trying new PA </span></a>
<a class="sourceLine" id="cb103-45" title="45"><span class="co">##                                  4                                  8 </span></a>
<a class="sourceLine" id="cb103-46" title="46"><span class="co">##                           has plan barriers identified or planned for </span></a>
<a class="sourceLine" id="cb103-47" title="47"><span class="co">##                                 14                                  4 </span></a>
<a class="sourceLine" id="cb103-48" title="48"><span class="co">##              identity, life values </span></a>
<a class="sourceLine" id="cb103-49" title="49"><span class="co">##                                  0</span></a>
<a class="sourceLine" id="cb103-50" title="50"></a>
<a class="sourceLine" id="cb103-51" title="51"><span class="kw">cor</span>(qgraph<span class="op">::</span><span class="kw">centrality</span>(bootnetgraph)<span class="op">$</span>InDegree, qgraph<span class="op">::</span><span class="kw">centrality</span>(bootnetgraph)<span class="op">$</span>Betweenness, </a>
<a class="sourceLine" id="cb103-52" title="52">    <span class="dt">method =</span> <span class="st">&quot;spearman&quot;</span>) </a>
<a class="sourceLine" id="cb103-53" title="53"><span class="co">## [1] 0.2146892</span></a>
<a class="sourceLine" id="cb103-54" title="54"></a>
<a class="sourceLine" id="cb103-55" title="55"><span class="co"># bootnet_stability_combinedAgreementBcts &lt;- bootnet::bootnet(combinedAgreementBcts_network, nBoots=1000)</span></a>
<a class="sourceLine" id="cb103-56" title="56"><span class="co"># save(bootnet_stability_combinedAgreementBcts, file = &quot;./Rdata_files/bootnet_stability_combinedAgreementBcts.Rdata&quot;)</span></a>
<a class="sourceLine" id="cb103-57" title="57"><span class="kw">load</span>(<span class="st">&quot;./Rdata_files/bootnet_stability_combinedAgreementBcts.Rdata&quot;</span>)</a>
<a class="sourceLine" id="cb103-58" title="58"></a>
<a class="sourceLine" id="cb103-59" title="59"><span class="kw">plot</span>(bootnet_stability_combinedAgreementBcts, <span class="dt">labels =</span> <span class="ot">TRUE</span>, <span class="dt">order =</span> <span class="st">&quot;sample&quot;</span>) </a></code></pre></div>
<p><img src="baseline-networks_files/figure-html/combinedAgreementBcts-stability-3.png" width="2100" /></p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb104-1" title="1"><span class="kw">plot</span>(bootnet_stability_combinedAgreementBcts, <span class="st">&quot;edge&quot;</span>, <span class="dt">plot =</span> <span class="st">&quot;difference&quot;</span>, <span class="dt">onlyNonZero =</span> <span class="ot">TRUE</span>, <span class="dt">order =</span> <span class="st">&quot;sample&quot;</span>)</a></code></pre></div>
<p><img src="baseline-networks_files/figure-html/combinedAgreementBcts-stability-4.png" width="2100" /></p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb105-1" title="1"></a>
<a class="sourceLine" id="cb105-2" title="2"><span class="co"># bootnet_centrality_stability_combinedAgreementBcts &lt;- bootnet::bootnet(combinedAgreementBcts_network, nBoots=1000,nCores=8, type=&quot;case&quot;)</span></a>
<a class="sourceLine" id="cb105-3" title="3"><span class="co"># save(bootnet_centrality_stability_combinedAgreementBcts, file = &quot;./Rdata_files/bootnet_centrality_stability_combinedAgreementBcts.Rdata&quot;)</span></a>
<a class="sourceLine" id="cb105-4" title="4"><span class="kw">load</span>(<span class="st">&quot;./Rdata_files/bootnet_centrality_stability_combinedAgreementBcts.Rdata&quot;</span>)</a>
<a class="sourceLine" id="cb105-5" title="5"></a>
<a class="sourceLine" id="cb105-6" title="6"><span class="kw">plot</span>(bootnet_centrality_stability_combinedAgreementBcts)</a></code></pre></div>
<p><img src="baseline-networks_files/figure-html/combinedAgreementBcts-stability-5.png" width="2100" /></p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb106-1" title="1"><span class="kw">plot</span>(bootnet_centrality_stability_combinedAgreementBcts, <span class="dt">perNode=</span>T, <span class="st">&quot;strength&quot;</span>)</a></code></pre></div>
<p><img src="baseline-networks_files/figure-html/combinedAgreementBcts-stability-6.png" width="2100" /></p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb107-1" title="1"></a>
<a class="sourceLine" id="cb107-2" title="2">bootnet<span class="op">::</span><span class="kw">corStability</span>(bootnet_centrality_stability_combinedAgreementBcts)</a>
<a class="sourceLine" id="cb107-3" title="3"><span class="co">## === Correlation Stability Analysis === </span></a>
<a class="sourceLine" id="cb107-4" title="4"><span class="co">## </span></a>
<a class="sourceLine" id="cb107-5" title="5"><span class="co">## Sampling levels tested:</span></a>
<a class="sourceLine" id="cb107-6" title="6"><span class="co">##    nPerson Drop%   n</span></a>
<a class="sourceLine" id="cb107-7" title="7"><span class="co">## 1      291  75.0 112</span></a>
<a class="sourceLine" id="cb107-8" title="8"><span class="co">## 2      382  67.2 108</span></a>
<a class="sourceLine" id="cb107-9" title="9"><span class="co">## 3      472  59.5  94</span></a>
<a class="sourceLine" id="cb107-10" title="10"><span class="co">## 4      563  51.7  92</span></a>
<a class="sourceLine" id="cb107-11" title="11"><span class="co">## 5      654  43.9  96</span></a>
<a class="sourceLine" id="cb107-12" title="12"><span class="co">## 6      744  36.1 105</span></a>
<a class="sourceLine" id="cb107-13" title="13"><span class="co">## 7      835  28.3 117</span></a>
<a class="sourceLine" id="cb107-14" title="14"><span class="co">## 8      926  20.5  96</span></a>
<a class="sourceLine" id="cb107-15" title="15"><span class="co">## 9     1016  12.8  86</span></a>
<a class="sourceLine" id="cb107-16" title="16"><span class="co">## 10    1107   5.0  94</span></a>
<a class="sourceLine" id="cb107-17" title="17"><span class="co">## </span></a>
<a class="sourceLine" id="cb107-18" title="18"><span class="co">## Maximum drop proportions to retain correlation of 0.7 in at least 95% of the samples:</span></a>
<a class="sourceLine" id="cb107-19" title="19"><span class="co">## </span></a>
<a class="sourceLine" id="cb107-20" title="20"><span class="co">## betweenness: 0.128 </span></a>
<a class="sourceLine" id="cb107-21" title="21"><span class="co">##   - For more accuracy, run bootnet(..., caseMin = 0.05, caseMax = 0.205) </span></a>
<a class="sourceLine" id="cb107-22" title="22"><span class="co">## </span></a>
<a class="sourceLine" id="cb107-23" title="23"><span class="co">## closeness: 0.672 </span></a>
<a class="sourceLine" id="cb107-24" title="24"><span class="co">##   - For more accuracy, run bootnet(..., caseMin = 0.595, caseMax = 0.75) </span></a>
<a class="sourceLine" id="cb107-25" title="25"><span class="co">## </span></a>
<a class="sourceLine" id="cb107-26" title="26"><span class="co">## edge: 0.75 (CS-coefficient is highest level tested)</span></a>
<a class="sourceLine" id="cb107-27" title="27"><span class="co">##   - For more accuracy, run bootnet(..., caseMin = 0.672, caseMax = 1) </span></a>
<a class="sourceLine" id="cb107-28" title="28"><span class="co">## </span></a>
<a class="sourceLine" id="cb107-29" title="29"><span class="co">## strength: 0.75 (CS-coefficient is highest level tested)</span></a>
<a class="sourceLine" id="cb107-30" title="30"><span class="co">##   - For more accuracy, run bootnet(..., caseMin = 0.672, caseMax = 1) </span></a>
<a class="sourceLine" id="cb107-31" title="31"><span class="co">## </span></a>
<a class="sourceLine" id="cb107-32" title="32"><span class="co">## Accuracy can also be increased by increasing both &#39;nBoots&#39; and &#39;caseN&#39;.</span></a></code></pre></div>
</div>
<div id="heterogeneity" class="section level3">
<h3>Heterogeneity</h3>
<p>The smallest track (IT) has 163 observations. According to the heuristic sample size for p variables for Gaussian data, (p*(p-1)/2 + p), we could estimate about 7 variables. (based on <a href="https://cvborkulo.files.wordpress.com/2014/09/winterschool2017.pdf">these slides</a> referring to this source: Bühlmann, P. &amp; van de Geer, S. (2011). Statistics for High-Dimensional Data: Methods, Theory and Applications. Springer.)</p>
<p>All tracks seem sufficiently similar on these BCTs.</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb108-1" title="1"></a>
<a class="sourceLine" id="cb108-2" title="2">combinedAgreementBcts_tracks_df &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb108-3" title="3"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(</a>
<a class="sourceLine" id="cb108-4" title="4">  <span class="st">&#39;PA selfrep&#39;</span> =<span class="st"> </span>padaysLastweek_T1,</a>
<a class="sourceLine" id="cb108-5" title="5">  <span class="co"># &#39;PA accelerometer&#39; = mvpaAccelerometer_T1,</span></a>
<a class="sourceLine" id="cb108-6" title="6">  <span class="st">&#39;Autonomous&#39;</span> =<span class="st"> </span>PA_autonomous_T1,</a>
<a class="sourceLine" id="cb108-7" title="7">  <span class="st">&#39;goal setting&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">01</span>_T1,</a>
<a class="sourceLine" id="cb108-8" title="8">  <span class="st">&#39;own plan&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">02</span>_T1,</a>
<a class="sourceLine" id="cb108-9" title="9">  <span class="co"># &#39;plan by other&#39; = PA_agreementDependentBCT_03_T1,</span></a>
<a class="sourceLine" id="cb108-10" title="10">  <span class="st">&#39;reminder of plan&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">04</span>_T1,</a>
<a class="sourceLine" id="cb108-11" title="11">  <span class="st">&#39;subgoals&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">05</span>_T1,</a>
<a class="sourceLine" id="cb108-12" title="12">  <span class="co"># &#39;trying new PA&#39; = PA_agreementDependentBCT_06_T1,</span></a>
<a class="sourceLine" id="cb108-13" title="13">  <span class="st">&#39;barrier identification&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">07</span>_T1,</a>
<a class="sourceLine" id="cb108-14" title="14">  <span class="st">&#39;problem solving&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">08</span>_T1,</a>
<a class="sourceLine" id="cb108-15" title="15">  <span class="st">&#39;PA identity reflection&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">09</span>_T1,</a>
<a class="sourceLine" id="cb108-16" title="16">  <span class="st">&#39;aligning PA with life values&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">10</span>_T1) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb108-17" title="17"><span class="st"> </span><span class="kw">rowwise</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb108-18" title="18"><span class="st"> </span><span class="kw">mutate</span>(</a>
<a class="sourceLine" id="cb108-19" title="19">  <span class="st">&#39;barriers identified or planned for&#39;</span> =<span class="st"> </span><span class="kw">mean</span>(<span class="kw">c</span>(<span class="st">`</span><span class="dt">problem solving</span><span class="st">`</span>, <span class="st">`</span><span class="dt">barrier identification</span><span class="st">`</span>), <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), </a>
<a class="sourceLine" id="cb108-20" title="20">  <span class="st">&#39;identity, life values&#39;</span> =<span class="st"> </span><span class="kw">mean</span>(<span class="kw">c</span>(<span class="st">`</span><span class="dt">PA identity reflection</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="st">`</span><span class="dt">aligning PA with life values</span><span class="st">`</span>), <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb108-21" title="21"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>( </a>
<a class="sourceLine" id="cb108-22" title="22">         <span class="op">-</span><span class="st">`</span><span class="dt">barrier identification</span><span class="st">`</span>, <span class="op">-</span><span class="st">`</span><span class="dt">problem solving</span><span class="st">`</span>, <span class="co"># closely related</span></a>
<a class="sourceLine" id="cb108-23" title="23">         <span class="op">-</span><span class="st">`</span><span class="dt">PA identity reflection</span><span class="st">`</span>, <span class="op">-</span><span class="st">`</span><span class="dt">aligning PA with life values</span><span class="st">`</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># closely related</span></a>
<a class="sourceLine" id="cb108-24" title="24"><span class="st">  </span><span class="kw">mutate_all</span>(as.numeric) </a>
<a class="sourceLine" id="cb108-25" title="25"></a>
<a class="sourceLine" id="cb108-26" title="26">combinedAgreementBcts_tracks_df &lt;-<span class="st"> </span><span class="kw">cbind</span>(<span class="dt">track =</span> df<span class="op">$</span>track, combinedAgreementBcts_tracks_df) </a>
<a class="sourceLine" id="cb108-27" title="27"></a>
<a class="sourceLine" id="cb108-28" title="28">combinedAgreementBcts_tracks_df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">group_by</span>(track) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarise</span>(<span class="dt">n =</span> <span class="kw">n</span>())</a></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["track"],"name":[1],"type":["fctr"],"align":["left"]},{"label":["n"],"name":[2],"type":["int"],"align":["right"]}],"data":[{"1":"Other","2":"24"},{"1":"IT","2":"163"},{"1":"BA","2":"282"},{"1":"HRC","2":"213"},{"1":"Nur","2":"402"},{"1":"NA","2":"82"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb109-1" title="1"></a>
<a class="sourceLine" id="cb109-2" title="2">heterogeneity_Nur &lt;-<span class="st"> </span>combinedAgreementBcts_tracks_df <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb109-3" title="3"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;Nur&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb109-4" title="4"><span class="st">  </span><span class="kw">na.omit</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb109-5" title="5"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>track)</a>
<a class="sourceLine" id="cb109-6" title="6"></a>
<a class="sourceLine" id="cb109-7" title="7">heterogeneity_HRC &lt;-<span class="st"> </span>combinedAgreementBcts_tracks_df <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb109-8" title="8"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;HRC&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb109-9" title="9"><span class="st">  </span><span class="kw">na.omit</span>() <span class="op">%&gt;%</span><span class="st">  </span></a>
<a class="sourceLine" id="cb109-10" title="10"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>track)</a>
<a class="sourceLine" id="cb109-11" title="11"></a>
<a class="sourceLine" id="cb109-12" title="12">heterogeneity_BA &lt;-<span class="st"> </span>combinedAgreementBcts_tracks_df <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb109-13" title="13"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;BA&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb109-14" title="14"><span class="st">  </span><span class="kw">na.omit</span>() <span class="op">%&gt;%</span><span class="st">  </span></a>
<a class="sourceLine" id="cb109-15" title="15"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>track)</a>
<a class="sourceLine" id="cb109-16" title="16"></a>
<a class="sourceLine" id="cb109-17" title="17">heterogeneity_IT &lt;-<span class="st"> </span>combinedAgreementBcts_tracks_df <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb109-18" title="18"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;IT&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb109-19" title="19"><span class="st">  </span><span class="kw">na.omit</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb109-20" title="20"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>track)</a>
<a class="sourceLine" id="cb109-21" title="21"></a>
<a class="sourceLine" id="cb109-22" title="22">network_Nur &lt;-<span class="st"> </span>bootnet<span class="op">::</span><span class="kw">estimateNetwork</span>(heterogeneity_Nur, <span class="dt">default=</span><span class="st">&quot;EBICglasso&quot;</span>)</a>
<a class="sourceLine" id="cb109-23" title="23">network_HRC &lt;-<span class="st"> </span>bootnet<span class="op">::</span><span class="kw">estimateNetwork</span>(heterogeneity_HRC, <span class="dt">default=</span><span class="st">&quot;EBICglasso&quot;</span>)</a>
<a class="sourceLine" id="cb109-24" title="24">network_BA &lt;-<span class="st"> </span>bootnet<span class="op">::</span><span class="kw">estimateNetwork</span>(heterogeneity_BA, <span class="dt">default=</span><span class="st">&quot;EBICglasso&quot;</span>)</a>
<a class="sourceLine" id="cb109-25" title="25">network_IT &lt;-<span class="st"> </span>bootnet<span class="op">::</span><span class="kw">estimateNetwork</span>(heterogeneity_IT, <span class="dt">default=</span><span class="st">&quot;EBICglasso&quot;</span>)</a>
<a class="sourceLine" id="cb109-26" title="26"></a>
<a class="sourceLine" id="cb109-27" title="27">graph_Nur &lt;-<span class="st"> </span><span class="kw">plot</span>(network_Nur, <span class="dt">layout=</span><span class="st">&quot;spring&quot;</span>, <span class="dt">cut=</span><span class="dv">0</span>, <span class="dt">label.scale =</span> <span class="ot">FALSE</span>, <span class="dt">title =</span> <span class="st">&quot;Practical nurse&quot;</span>)</a></code></pre></div>
<p><img src="baseline-networks_files/figure-html/combinedAgreementBcts-heterogeneity-1.png" width="2100" /></p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb110-1" title="1">graph_HRC &lt;-<span class="st"> </span><span class="kw">plot</span>(network_HRC, <span class="dt">layout=</span><span class="st">&quot;spring&quot;</span>, <span class="dt">cut=</span><span class="dv">0</span>, <span class="dt">label.scale =</span> <span class="ot">FALSE</span>, <span class="dt">title =</span> <span class="st">&quot;HRC&quot;</span>)</a></code></pre></div>
<p><img src="baseline-networks_files/figure-html/combinedAgreementBcts-heterogeneity-2.png" width="2100" /></p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb111-1" title="1">graph_BA &lt;-<span class="st"> </span><span class="kw">plot</span>(network_BA, <span class="dt">layout=</span><span class="st">&quot;spring&quot;</span>, <span class="dt">cut=</span><span class="dv">0</span>, <span class="dt">label.scale =</span> <span class="ot">FALSE</span>, <span class="dt">title =</span> <span class="st">&quot;BA&quot;</span>)</a></code></pre></div>
<p><img src="baseline-networks_files/figure-html/combinedAgreementBcts-heterogeneity-3.png" width="2100" /></p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb112-1" title="1">graph_IT &lt;-<span class="st"> </span><span class="kw">plot</span>(network_IT, <span class="dt">layout=</span><span class="st">&quot;spring&quot;</span>, <span class="dt">cut=</span><span class="dv">0</span>, <span class="dt">label.scale =</span> <span class="ot">FALSE</span>, <span class="dt">title =</span> <span class="st">&quot;IT&quot;</span>)</a></code></pre></div>
<p><img src="baseline-networks_files/figure-html/combinedAgreementBcts-heterogeneity-4.png" width="2100" /></p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb113-1" title="1"></a>
<a class="sourceLine" id="cb113-2" title="2">maxedge &lt;-<span class="st"> </span><span class="kw">max</span>(<span class="kw">c</span>(graph_Nur<span class="op">$</span>graphAttributes<span class="op">$</span>Graph<span class="op">$</span>maximum, </a>
<a class="sourceLine" id="cb113-3" title="3">                 graph_HRC<span class="op">$</span>graphAttributes<span class="op">$</span>Graph<span class="op">$</span>maximum, </a>
<a class="sourceLine" id="cb113-4" title="4">                 graph_BA<span class="op">$</span>graphAttributes<span class="op">$</span>Graph<span class="op">$</span>maximum, </a>
<a class="sourceLine" id="cb113-5" title="5">                 graph_IT<span class="op">$</span>graphAttributes<span class="op">$</span>Graph<span class="op">$</span>maximum))</a>
<a class="sourceLine" id="cb113-6" title="6"></a>
<a class="sourceLine" id="cb113-7" title="7">L &lt;-<span class="st"> </span>qgraph<span class="op">::</span><span class="kw">averageLayout</span>(graph_Nur, graph_HRC, graph_BA, graph_IT)</a>
<a class="sourceLine" id="cb113-8" title="8"></a>
<a class="sourceLine" id="cb113-9" title="9"><span class="kw">layout</span>(<span class="kw">matrix</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>, <span class="dt">nrow =</span> <span class="dv">2</span>, <span class="dt">byrow =</span> <span class="ot">TRUE</span>))</a>
<a class="sourceLine" id="cb113-10" title="10">graph_Nur &lt;-<span class="st"> </span><span class="kw">plot</span>(network_Nur, <span class="dt">layout=</span>L, <span class="dt">cut=</span><span class="dv">0</span>, <span class="dt">label.scale =</span> <span class="ot">FALSE</span>, <span class="dt">title =</span> <span class="st">&quot;Practical nurse&quot;</span>, </a>
<a class="sourceLine" id="cb113-11" title="11">                  <span class="dt">maximum =</span> maxedge)</a>
<a class="sourceLine" id="cb113-12" title="12">graph_HRC &lt;-<span class="st"> </span><span class="kw">plot</span>(network_HRC, <span class="dt">layout=</span>L, <span class="dt">cut=</span><span class="dv">0</span>, <span class="dt">label.scale =</span> <span class="ot">FALSE</span>, <span class="dt">title =</span> <span class="st">&quot;HRC&quot;</span>,</a>
<a class="sourceLine" id="cb113-13" title="13">                  <span class="dt">maximum =</span> maxedge)</a>
<a class="sourceLine" id="cb113-14" title="14">graph_BA &lt;-<span class="st"> </span><span class="kw">plot</span>(network_BA, <span class="dt">layout=</span>L, <span class="dt">cut=</span><span class="dv">0</span>, <span class="dt">label.scale =</span> <span class="ot">FALSE</span>, <span class="dt">title =</span> <span class="st">&quot;BA&quot;</span>, </a>
<a class="sourceLine" id="cb113-15" title="15">                 <span class="dt">maximum =</span> maxedge)</a>
<a class="sourceLine" id="cb113-16" title="16">graph_IT &lt;-<span class="st"> </span><span class="kw">plot</span>(network_IT, <span class="dt">layout=</span>L, <span class="dt">cut=</span><span class="dv">0</span>, <span class="dt">label.scale =</span> <span class="ot">FALSE</span>, <span class="dt">title =</span> <span class="st">&quot;IT&quot;</span>,</a>
<a class="sourceLine" id="cb113-17" title="17">                 <span class="dt">maximum =</span> maxedge)</a></code></pre></div>
<p><img src="baseline-networks_files/figure-html/combinedAgreementBcts-heterogeneity-5.png" width="2100" /></p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb114-1" title="1"></a>
<a class="sourceLine" id="cb114-2" title="2"><span class="co"># nct_results &lt;- NetworkComparisonTest::NCT(heterogeneity_Nur, heterogeneity_IT, it=1000, binary.data=FALSE, paired=FALSE, test.edges=TRUE,</span></a>
<a class="sourceLine" id="cb114-3" title="3"><span class="co"># edges=&#39;all&#39;, progressbar=TRUE)</span></a>
<a class="sourceLine" id="cb114-4" title="4"><span class="co"># </span></a>
<a class="sourceLine" id="cb114-5" title="5"><span class="co"># save(nct_results, file = &quot;./Rdata_files/nct_results.Rdata&quot;)</span></a>
<a class="sourceLine" id="cb114-6" title="6"><span class="kw">load</span>(<span class="st">&quot;./Rdata_files/nct_results.Rdata&quot;</span>)</a></code></pre></div>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb115-1" title="1"></a>
<a class="sourceLine" id="cb115-2" title="2"><span class="kw">print</span>(<span class="st">&quot;These are the sizes of educational tracks:&quot;</span>)</a>
<a class="sourceLine" id="cb115-3" title="3"><span class="co">## [1] &quot;These are the sizes of educational tracks:&quot;</span></a>
<a class="sourceLine" id="cb115-4" title="4">combinedAgreementBcts_tracks_df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">group_by</span>(track) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarise</span>(<span class="dt">n =</span> <span class="kw">n</span>()) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb115-5" title="5"><span class="st">  </span>papaja<span class="op">::</span><span class="kw">apa_table</span>()</a>
<a class="sourceLine" id="cb115-6" title="6"><span class="co">## &lt;caption&gt;(\#tab:combinedAgreementBcts-heterogeneity-nct)&lt;/caption&gt;</span></a>
<a class="sourceLine" id="cb115-7" title="7"><span class="co">## </span></a>
<a class="sourceLine" id="cb115-8" title="8"><span class="co">## &lt;caption&gt;**&lt;/caption&gt;</span></a>
<a class="sourceLine" id="cb115-9" title="9"><span class="co">## </span></a>
<a class="sourceLine" id="cb115-10" title="10"><span class="co">## </span></a>
<a class="sourceLine" id="cb115-11" title="11"><span class="co">## </span></a>
<a class="sourceLine" id="cb115-12" title="12"><span class="co">## track   n   </span></a>
<a class="sourceLine" id="cb115-13" title="13"><span class="co">## ------  ----</span></a>
<a class="sourceLine" id="cb115-14" title="14"><span class="co">## Other   24  </span></a>
<a class="sourceLine" id="cb115-15" title="15"><span class="co">## IT      163 </span></a>
<a class="sourceLine" id="cb115-16" title="16"><span class="co">## BA      282 </span></a>
<a class="sourceLine" id="cb115-17" title="17"><span class="co">## HRC     213 </span></a>
<a class="sourceLine" id="cb115-18" title="18"><span class="co">## Nur     402 </span></a>
<a class="sourceLine" id="cb115-19" title="19"><span class="co">## NA      82</span></a>
<a class="sourceLine" id="cb115-20" title="20"></a>
<a class="sourceLine" id="cb115-21" title="21"><span class="kw">print</span>(<span class="st">&quot;Similarity&quot;</span>)</a>
<a class="sourceLine" id="cb115-22" title="22"><span class="co">## [1] &quot;Similarity&quot;</span></a>
<a class="sourceLine" id="cb115-23" title="23"><span class="kw">cat</span>(<span class="st">&quot;Correlation between Nur and IT edge strengths:&quot;</span>, <span class="kw">cor</span>(qgraph<span class="op">::</span><span class="kw">centrality</span>(network_Nur)<span class="op">$</span>InDegree, qgraph<span class="op">::</span><span class="kw">centrality</span>(network_IT)<span class="op">$</span>InDegree))</a>
<a class="sourceLine" id="cb115-24" title="24"><span class="co">## Correlation between Nur and IT edge strengths: 0.9199116</span></a>
<a class="sourceLine" id="cb115-25" title="25"></a>
<a class="sourceLine" id="cb115-26" title="26"><span class="kw">cat</span>(<span class="st">&quot;Correlation between Nur and IT networks:&quot;</span>, <span class="kw">cor</span>(network_Nur<span class="op">$</span>graph[<span class="kw">lower.tri</span>(network_Nur<span class="op">$</span>graph)], network_IT<span class="op">$</span>graph[<span class="kw">lower.tri</span>(network_Nur<span class="op">$</span>graph)], <span class="dt">method=</span><span class="st">&quot;spearman&quot;</span>))</a>
<a class="sourceLine" id="cb115-27" title="27"><span class="co">## Correlation between Nur and IT networks: 0.7352177</span></a>
<a class="sourceLine" id="cb115-28" title="28"></a>
<a class="sourceLine" id="cb115-29" title="29"><span class="kw">print</span>(<span class="st">&quot;Difference&quot;</span>)</a>
<a class="sourceLine" id="cb115-30" title="30"><span class="co">## [1] &quot;Difference&quot;</span></a>
<a class="sourceLine" id="cb115-31" title="31"><span class="kw">cat</span>(<span class="st">&quot;P-value for the test of identical network structure:&quot;</span>, nct_results<span class="op">$</span>nwinv.pval)</a>
<a class="sourceLine" id="cb115-32" title="32"><span class="co">## P-value for the test of identical network structure: 0.582</span></a>
<a class="sourceLine" id="cb115-33" title="33"><span class="kw">cat</span>(<span class="st">&quot;P-value for the test of identical connectivity in networks:&quot;</span>, nct_results<span class="op">$</span>glstrinv.pval)</a>
<a class="sourceLine" id="cb115-34" title="34"><span class="co">## P-value for the test of identical connectivity in networks: 0.976</span></a>
<a class="sourceLine" id="cb115-35" title="35">nct_results<span class="op">$</span>einv.pvals <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb115-36" title="36"><span class="st">  </span>papaja<span class="op">::</span><span class="kw">apa_table</span>(<span class="dt">caption =</span> <span class="st">&quot;p-values on difference test in edges between Nur and IT&quot;</span>)</a>
<a class="sourceLine" id="cb115-37" title="37"><span class="co">## &lt;caption&gt;(\#tab:combinedAgreementBcts-heterogeneity-nct)&lt;/caption&gt;</span></a>
<a class="sourceLine" id="cb115-38" title="38"><span class="co">## </span></a>
<a class="sourceLine" id="cb115-39" title="39"><span class="co">## &lt;caption&gt;*p-values on difference test in edges between Nur and IT*&lt;/caption&gt;</span></a>
<a class="sourceLine" id="cb115-40" title="40"><span class="co">## </span></a>
<a class="sourceLine" id="cb115-41" title="41"><span class="co">## </span></a>
<a class="sourceLine" id="cb115-42" title="42"><span class="co">## </span></a>
<a class="sourceLine" id="cb115-43" title="43"><span class="co">##      Var1                                 Var2                                 p-value </span></a>
<a class="sourceLine" id="cb115-44" title="44"><span class="co">## ---  -----------------------------------  -----------------------------------  --------</span></a>
<a class="sourceLine" id="cb115-45" title="45"><span class="co">## 9    PA selfrep                           Autonomous                           1.00    </span></a>
<a class="sourceLine" id="cb115-46" title="46"><span class="co">## 17   PA selfrep                           goal setting                         1.00    </span></a>
<a class="sourceLine" id="cb115-47" title="47"><span class="co">## 18   Autonomous                           goal setting                         1.00    </span></a>
<a class="sourceLine" id="cb115-48" title="48"><span class="co">## 25   PA selfrep                           implementation plan                  1.00    </span></a>
<a class="sourceLine" id="cb115-49" title="49"><span class="co">## 26   Autonomous                           implementation plan                  0.97    </span></a>
<a class="sourceLine" id="cb115-50" title="50"><span class="co">## 27   goal setting                         implementation plan                  1.00    </span></a>
<a class="sourceLine" id="cb115-51" title="51"><span class="co">## 33   PA selfrep                           reminder of plan                     1.00    </span></a>
<a class="sourceLine" id="cb115-52" title="52"><span class="co">## 34   Autonomous                           reminder of plan                     1.00    </span></a>
<a class="sourceLine" id="cb115-53" title="53"><span class="co">## 35   goal setting                         reminder of plan                     1.00    </span></a>
<a class="sourceLine" id="cb115-54" title="54"><span class="co">## 36   implementation plan                  reminder of plan                     1.00    </span></a>
<a class="sourceLine" id="cb115-55" title="55"><span class="co">## 41   PA selfrep                           subgoals                             1.00    </span></a>
<a class="sourceLine" id="cb115-56" title="56"><span class="co">## 42   Autonomous                           subgoals                             1.00    </span></a>
<a class="sourceLine" id="cb115-57" title="57"><span class="co">## 43   goal setting                         subgoals                             1.00    </span></a>
<a class="sourceLine" id="cb115-58" title="58"><span class="co">## 44   implementation plan                  subgoals                             1.00    </span></a>
<a class="sourceLine" id="cb115-59" title="59"><span class="co">## 45   reminder of plan                     subgoals                             1.00    </span></a>
<a class="sourceLine" id="cb115-60" title="60"><span class="co">## 49   PA selfrep                           barriers identified or planned for   1.00    </span></a>
<a class="sourceLine" id="cb115-61" title="61"><span class="co">## 50   Autonomous                           barriers identified or planned for   1.00    </span></a>
<a class="sourceLine" id="cb115-62" title="62"><span class="co">## 51   goal setting                         barriers identified or planned for   1.00    </span></a>
<a class="sourceLine" id="cb115-63" title="63"><span class="co">## 52   implementation plan                  barriers identified or planned for   1.00    </span></a>
<a class="sourceLine" id="cb115-64" title="64"><span class="co">## 53   reminder of plan                     barriers identified or planned for   1.00    </span></a>
<a class="sourceLine" id="cb115-65" title="65"><span class="co">## 54   subgoals                             barriers identified or planned for   1.00    </span></a>
<a class="sourceLine" id="cb115-66" title="66"><span class="co">## 57   PA selfrep                           identity, life values                1.00    </span></a>
<a class="sourceLine" id="cb115-67" title="67"><span class="co">## 58   Autonomous                           identity, life values                1.00    </span></a>
<a class="sourceLine" id="cb115-68" title="68"><span class="co">## 59   goal setting                         identity, life values                1.00    </span></a>
<a class="sourceLine" id="cb115-69" title="69"><span class="co">## 60   implementation plan                  identity, life values                1.00    </span></a>
<a class="sourceLine" id="cb115-70" title="70"><span class="co">## 61   reminder of plan                     identity, life values                1.00    </span></a>
<a class="sourceLine" id="cb115-71" title="71"><span class="co">## 62   subgoals                             identity, life values                0.62    </span></a>
<a class="sourceLine" id="cb115-72" title="72"><span class="co">## 63   barriers identified or planned for   identity, life values                1.00</span></a>
<a class="sourceLine" id="cb115-73" title="73"></a>
<a class="sourceLine" id="cb115-74" title="74"><span class="kw">cat</span>(<span class="st">&quot;Number of edges, which appear different (p&lt;0.05):&quot;</span>, <span class="kw">sum</span>(nct_results<span class="op">$</span>einv.pvals<span class="op">$</span><span class="st">&quot;p-value&quot;</span> <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.05</span>))</a>
<a class="sourceLine" id="cb115-75" title="75"><span class="co">## Number of edges, which appear different (p&lt;0.05): 0</span></a></code></pre></div>
</div>
</div>
</div>
<div id="ising-networks" class="section level1">
<h1>Ising networks</h1>
<div id="plot-with-only-the-bcts" class="section level2">
<h2>Plot with only the BCTs</h2>
<p>Prepare and dichotomise data (lots of skew in distributions).</p>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb116-1" title="1">nItems &lt;-<span class="st"> </span><span class="dv">19</span></a>
<a class="sourceLine" id="cb116-2" title="2"></a>
<a class="sourceLine" id="cb116-3" title="3">bctdf &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(id,</a>
<a class="sourceLine" id="cb116-4" title="4">  intervention,</a>
<a class="sourceLine" id="cb116-5" title="5">  group,</a>
<a class="sourceLine" id="cb116-6" title="6">  school,</a>
<a class="sourceLine" id="cb116-7" title="7">  girl,</a>
<a class="sourceLine" id="cb116-8" title="8">  <span class="st">&#39;goal setting&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">01</span>_T1,</a>
<a class="sourceLine" id="cb116-9" title="9">  <span class="st">&#39;own plan&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">02</span>_T1,</a>
<a class="sourceLine" id="cb116-10" title="10">  <span class="st">&#39;plan by other&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">03</span>_T1,</a>
<a class="sourceLine" id="cb116-11" title="11">  <span class="st">&#39;reminder of plan&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">04</span>_T1,</a>
<a class="sourceLine" id="cb116-12" title="12">  <span class="st">&#39;subgoals&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">05</span>_T1,</a>
<a class="sourceLine" id="cb116-13" title="13">  <span class="st">&#39;trying new PA&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">06</span>_T1,</a>
<a class="sourceLine" id="cb116-14" title="14">  <span class="st">&#39;barrier identification&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">07</span>_T1,</a>
<a class="sourceLine" id="cb116-15" title="15">  <span class="st">&#39;problem solving&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">08</span>_T1,</a>
<a class="sourceLine" id="cb116-16" title="16">  <span class="st">&#39;PA identity reflection&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">09</span>_T1,</a>
<a class="sourceLine" id="cb116-17" title="17">  <span class="st">&#39;aligning PA with life values&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">10</span>_T1,</a>
<a class="sourceLine" id="cb116-18" title="18">  <span class="st">&#39;remind of PA benefits&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">01</span>_T1,</a>
<a class="sourceLine" id="cb116-19" title="19">  <span class="st">&#39;self-monitor (paper)&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">02</span>_T1,</a>
<a class="sourceLine" id="cb116-20" title="20">  <span class="st">&#39;self-monitor (app)&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">03</span>_T1,</a>
<a class="sourceLine" id="cb116-21" title="21">  <span class="st">&#39;memory cues&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">04</span>_T1,</a>
<a class="sourceLine" id="cb116-22" title="22">  <span class="st">&#39;goal review&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">05</span>_T1,</a>
<a class="sourceLine" id="cb116-23" title="23">  <span class="st">&#39;personal relevance reflection&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">06</span>_T1,</a>
<a class="sourceLine" id="cb116-24" title="24">  <span class="st">&#39;environmental changes (home)&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">07</span>_T1,</a>
<a class="sourceLine" id="cb116-25" title="25">  <span class="st">&#39;social support&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">08</span>_T1,</a>
<a class="sourceLine" id="cb116-26" title="26">  <span class="st">&#39;failure contemplated&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">09</span>_T1) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb116-27" title="27"><span class="st"> </span><span class="kw">mutate</span>(</a>
<a class="sourceLine" id="cb116-28" title="28">  <span class="st">&#39;goal setting&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">goal setting</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb116-29" title="29">  <span class="st">&#39;own plan&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">own plan</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb116-30" title="30">  <span class="st">&#39;plan by other&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">plan by other</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb116-31" title="31">  <span class="st">&#39;reminder of plan&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">reminder of plan</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb116-32" title="32">  <span class="st">&#39;subgoals&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">subgoals</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb116-33" title="33">  <span class="st">&#39;trying new PA&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">trying new PA</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb116-34" title="34">  <span class="st">&#39;barrier identification&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">barrier identification</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb116-35" title="35">  <span class="st">&#39;problem solving&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">problem solving</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb116-36" title="36">  <span class="st">&#39;PA identity reflection&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">PA identity reflection</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb116-37" title="37">  <span class="st">&#39;aligning PA with life values&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">aligning PA with life values</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb116-38" title="38">  <span class="st">&#39;remind of PA benefits&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">remind of PA benefits</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb116-39" title="39">  <span class="st">&#39;self-monitor (paper)&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">self-monitor (paper)</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb116-40" title="40">  <span class="st">&#39;self-monitor (app)&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">self-monitor (app)</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb116-41" title="41">  <span class="st">&#39;memory cues&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">memory cues</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb116-42" title="42">  <span class="st">&#39;goal review&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">goal review</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb116-43" title="43">  <span class="st">&#39;personal relevance reflection&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">personal relevance reflection</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb116-44" title="44">  <span class="st">&#39;environmental changes (home)&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">environmental changes (home)</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb116-45" title="45">  <span class="st">&#39;social support&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">social support</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb116-46" title="46">  <span class="st">&#39;failure contemplated&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">failure contemplated</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>)) </a>
<a class="sourceLine" id="cb116-47" title="47"></a>
<a class="sourceLine" id="cb116-48" title="48">S.boys &lt;-<span class="st"> </span>bctdf <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(girl <span class="op">==</span><span class="st"> &quot;boy&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="st">`</span><span class="dt">goal setting</span><span class="st">`</span><span class="op">:</span><span class="kw">ncol</span>(bctdf)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">na.omit</span>(.) </a>
<a class="sourceLine" id="cb116-49" title="49">S.girls &lt;-<span class="st"> </span>bctdf <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(girl <span class="op">==</span><span class="st"> &quot;girl&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="st">`</span><span class="dt">goal setting</span><span class="st">`</span><span class="op">:</span><span class="kw">ncol</span>(bctdf)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">na.omit</span>(.)</a>
<a class="sourceLine" id="cb116-50" title="50">nwBoys &lt;-<span class="st"> </span>bootnet<span class="op">::</span><span class="kw">estimateNetwork</span>(S.boys, <span class="dt">default=</span><span class="st">&quot;IsingFit&quot;</span>)</a>
<a class="sourceLine" id="cb116-51" title="51"><span class="co">## </span></a>
<a class="sourceLine" id="cb116-52" title="52">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb116-53" title="53"><span class="st">  </span><span class="er">|</span><span class="st">                                                                 </span><span class="er">|</span><span class="st">   </span><span class="dv">0</span>%</a>
<a class="sourceLine" id="cb116-54" title="54">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb116-55" title="55"><span class="st">  </span><span class="er">|===</span><span class="st">                                                              </span><span class="er">|</span><span class="st">   </span><span class="dv">5</span>%</a>
<a class="sourceLine" id="cb116-56" title="56">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb116-57" title="57"><span class="st">  </span><span class="er">|=======</span><span class="st">                                                          </span><span class="er">|</span><span class="st">  </span><span class="dv">11</span>%</a>
<a class="sourceLine" id="cb116-58" title="58">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb116-59" title="59"><span class="st">  </span><span class="er">|==========</span><span class="st">                                                       </span><span class="er">|</span><span class="st">  </span><span class="dv">16</span>%</a>
<a class="sourceLine" id="cb116-60" title="60">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb116-61" title="61"><span class="st">  </span><span class="er">|==============</span><span class="st">                                                   </span><span class="er">|</span><span class="st">  </span><span class="dv">21</span>%</a>
<a class="sourceLine" id="cb116-62" title="62">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb116-63" title="63"><span class="st">  </span><span class="er">|=================</span><span class="st">                                                </span><span class="er">|</span><span class="st">  </span><span class="dv">26</span>%</a>
<a class="sourceLine" id="cb116-64" title="64">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb116-65" title="65"><span class="st">  </span><span class="er">|=====================</span><span class="st">                                            </span><span class="er">|</span><span class="st">  </span><span class="dv">32</span>%</a>
<a class="sourceLine" id="cb116-66" title="66">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb116-67" title="67"><span class="st">  </span><span class="er">|========================</span><span class="st">                                         </span><span class="er">|</span><span class="st">  </span><span class="dv">37</span>%</a>
<a class="sourceLine" id="cb116-68" title="68">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb116-69" title="69"><span class="st">  </span><span class="er">|===========================</span><span class="st">                                      </span><span class="er">|</span><span class="st">  </span><span class="dv">42</span>%</a>
<a class="sourceLine" id="cb116-70" title="70">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb116-71" title="71"><span class="st">  </span><span class="er">|===============================</span><span class="st">                                  </span><span class="er">|</span><span class="st">  </span><span class="dv">47</span>%</a>
<a class="sourceLine" id="cb116-72" title="72">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb116-73" title="73"><span class="st">  </span><span class="er">|==================================</span><span class="st">                               </span><span class="er">|</span><span class="st">  </span><span class="dv">53</span>%</a>
<a class="sourceLine" id="cb116-74" title="74">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb116-75" title="75"><span class="st">  </span><span class="er">|======================================</span><span class="st">                           </span><span class="er">|</span><span class="st">  </span><span class="dv">58</span>%</a>
<a class="sourceLine" id="cb116-76" title="76">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb116-77" title="77"><span class="st">  </span><span class="er">|=========================================</span><span class="st">                        </span><span class="er">|</span><span class="st">  </span><span class="dv">63</span>%</a>
<a class="sourceLine" id="cb116-78" title="78">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb116-79" title="79"><span class="st">  </span><span class="er">|============================================</span><span class="st">                     </span><span class="er">|</span><span class="st">  </span><span class="dv">68</span>%</a>
<a class="sourceLine" id="cb116-80" title="80">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb116-81" title="81"><span class="st">  </span><span class="er">|================================================</span><span class="st">                 </span><span class="er">|</span><span class="st">  </span><span class="dv">74</span>%</a>
<a class="sourceLine" id="cb116-82" title="82">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb116-83" title="83"><span class="st">  </span><span class="er">|===================================================</span><span class="st">              </span><span class="er">|</span><span class="st">  </span><span class="dv">79</span>%</a>
<a class="sourceLine" id="cb116-84" title="84">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb116-85" title="85"><span class="st">  </span><span class="er">|=======================================================</span><span class="st">          </span><span class="er">|</span><span class="st">  </span><span class="dv">84</span>%</a>
<a class="sourceLine" id="cb116-86" title="86">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb116-87" title="87"><span class="st">  </span><span class="er">|==========================================================</span><span class="st">       </span><span class="er">|</span><span class="st">  </span><span class="dv">89</span>%</a>
<a class="sourceLine" id="cb116-88" title="88">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb116-89" title="89"><span class="st">  </span><span class="er">|==============================================================</span><span class="st">   </span><span class="er">|</span><span class="st">  </span><span class="dv">95</span>%</a>
<a class="sourceLine" id="cb116-90" title="90">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb116-91" title="91"><span class="st">  </span><span class="er">|=================================================================|</span><span class="st"> </span><span class="dv">100</span>%</a>
<a class="sourceLine" id="cb116-92" title="92">nwGirls &lt;-<span class="st"> </span>bootnet<span class="op">::</span><span class="kw">estimateNetwork</span>(S.girls, <span class="dt">default=</span><span class="st">&quot;IsingFit&quot;</span>)</a>
<a class="sourceLine" id="cb116-93" title="93"><span class="co">## </span></a>
<a class="sourceLine" id="cb116-94" title="94">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb116-95" title="95"><span class="st">  </span><span class="er">|</span><span class="st">                                                                 </span><span class="er">|</span><span class="st">   </span><span class="dv">0</span>%</a>
<a class="sourceLine" id="cb116-96" title="96">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb116-97" title="97"><span class="st">  </span><span class="er">|===</span><span class="st">                                                              </span><span class="er">|</span><span class="st">   </span><span class="dv">5</span>%</a>
<a class="sourceLine" id="cb116-98" title="98">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb116-99" title="99"><span class="st">  </span><span class="er">|=======</span><span class="st">                                                          </span><span class="er">|</span><span class="st">  </span><span class="dv">11</span>%</a>
<a class="sourceLine" id="cb116-100" title="100">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb116-101" title="101"><span class="st">  </span><span class="er">|==========</span><span class="st">                                                       </span><span class="er">|</span><span class="st">  </span><span class="dv">16</span>%</a>
<a class="sourceLine" id="cb116-102" title="102">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb116-103" title="103"><span class="st">  </span><span class="er">|==============</span><span class="st">                                                   </span><span class="er">|</span><span class="st">  </span><span class="dv">21</span>%</a>
<a class="sourceLine" id="cb116-104" title="104">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb116-105" title="105"><span class="st">  </span><span class="er">|=================</span><span class="st">                                                </span><span class="er">|</span><span class="st">  </span><span class="dv">26</span>%</a>
<a class="sourceLine" id="cb116-106" title="106">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb116-107" title="107"><span class="st">  </span><span class="er">|=====================</span><span class="st">                                            </span><span class="er">|</span><span class="st">  </span><span class="dv">32</span>%</a>
<a class="sourceLine" id="cb116-108" title="108">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb116-109" title="109"><span class="st">  </span><span class="er">|========================</span><span class="st">                                         </span><span class="er">|</span><span class="st">  </span><span class="dv">37</span>%</a>
<a class="sourceLine" id="cb116-110" title="110">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb116-111" title="111"><span class="st">  </span><span class="er">|===========================</span><span class="st">                                      </span><span class="er">|</span><span class="st">  </span><span class="dv">42</span>%</a>
<a class="sourceLine" id="cb116-112" title="112">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb116-113" title="113"><span class="st">  </span><span class="er">|===============================</span><span class="st">                                  </span><span class="er">|</span><span class="st">  </span><span class="dv">47</span>%</a>
<a class="sourceLine" id="cb116-114" title="114">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb116-115" title="115"><span class="st">  </span><span class="er">|==================================</span><span class="st">                               </span><span class="er">|</span><span class="st">  </span><span class="dv">53</span>%</a>
<a class="sourceLine" id="cb116-116" title="116">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb116-117" title="117"><span class="st">  </span><span class="er">|======================================</span><span class="st">                           </span><span class="er">|</span><span class="st">  </span><span class="dv">58</span>%</a>
<a class="sourceLine" id="cb116-118" title="118">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb116-119" title="119"><span class="st">  </span><span class="er">|=========================================</span><span class="st">                        </span><span class="er">|</span><span class="st">  </span><span class="dv">63</span>%</a>
<a class="sourceLine" id="cb116-120" title="120">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb116-121" title="121"><span class="st">  </span><span class="er">|============================================</span><span class="st">                     </span><span class="er">|</span><span class="st">  </span><span class="dv">68</span>%</a>
<a class="sourceLine" id="cb116-122" title="122">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb116-123" title="123"><span class="st">  </span><span class="er">|================================================</span><span class="st">                 </span><span class="er">|</span><span class="st">  </span><span class="dv">74</span>%</a>
<a class="sourceLine" id="cb116-124" title="124">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb116-125" title="125"><span class="st">  </span><span class="er">|===================================================</span><span class="st">              </span><span class="er">|</span><span class="st">  </span><span class="dv">79</span>%</a>
<a class="sourceLine" id="cb116-126" title="126">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb116-127" title="127"><span class="st">  </span><span class="er">|=======================================================</span><span class="st">          </span><span class="er">|</span><span class="st">  </span><span class="dv">84</span>%</a>
<a class="sourceLine" id="cb116-128" title="128">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb116-129" title="129"><span class="st">  </span><span class="er">|==========================================================</span><span class="st">       </span><span class="er">|</span><span class="st">  </span><span class="dv">89</span>%</a>
<a class="sourceLine" id="cb116-130" title="130">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb116-131" title="131"><span class="st">  </span><span class="er">|==============================================================</span><span class="st">   </span><span class="er">|</span><span class="st">  </span><span class="dv">95</span>%</a>
<a class="sourceLine" id="cb116-132" title="132">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb116-133" title="133"><span class="st">  </span><span class="er">|=================================================================|</span><span class="st"> </span><span class="dv">100</span>%</a>
<a class="sourceLine" id="cb116-134" title="134"></a>
<a class="sourceLine" id="cb116-135" title="135"><span class="co"># Create means for filling nodes</span></a>
<a class="sourceLine" id="cb116-136" title="136"></a>
<a class="sourceLine" id="cb116-137" title="137">girlmeans &lt;-<span class="st"> </span>bctdf <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">group_by</span>(girl) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb116-138" title="138"><span class="st">  </span><span class="kw">summarise_at</span>(<span class="kw">vars</span>(<span class="op">-</span>(id<span class="op">:</span>girl)),</a>
<a class="sourceLine" id="cb116-139" title="139">  <span class="kw">funs</span>(<span class="kw">mean</span>(., <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb116-140" title="140"><span class="st">  </span><span class="kw">filter</span>(girl <span class="op">==</span><span class="st"> &quot;girl&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb116-141" title="141"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>girl)</a>
<a class="sourceLine" id="cb116-142" title="142"><span class="co">## Error in is_character(x, encoding = encoding, n = 1L): object &#39;girl&#39; not found</span></a>
<a class="sourceLine" id="cb116-143" title="143"></a>
<a class="sourceLine" id="cb116-144" title="144">boymeans &lt;-<span class="st"> </span>bctdf <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(girl) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb116-145" title="145"><span class="st">  </span><span class="kw">summarise_at</span>(<span class="kw">vars</span>(<span class="op">-</span>(id<span class="op">:</span>girl)),</a>
<a class="sourceLine" id="cb116-146" title="146">  <span class="kw">funs</span>(<span class="kw">mean</span>(., <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb116-147" title="147"><span class="st">  </span><span class="kw">filter</span>(girl <span class="op">==</span><span class="st"> &quot;boy&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb116-148" title="148"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>girl)</a>
<a class="sourceLine" id="cb116-149" title="149"><span class="co">## Error in is_character(x, encoding = encoding, n = 1L): object &#39;girl&#39; not found</span></a></code></pre></div>
</div>
<div id="plot-bct-ising-networks" class="section level2">
<h2>Plot BCT Ising-networks</h2>
<p>For girls and boys.</p>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb117-1" title="1"></a>
<a class="sourceLine" id="cb117-2" title="2"><span class="co"># Find average layout for comparability and plot graphs next to each other</span></a>
<a class="sourceLine" id="cb117-3" title="3"></a>
<a class="sourceLine" id="cb117-4" title="4">Layout &lt;-<span class="st"> </span>qgraph<span class="op">::</span><span class="kw">averageLayout</span>(nwGirls, nwBoys)</a>
<a class="sourceLine" id="cb117-5" title="5"></a>
<a class="sourceLine" id="cb117-6" title="6"><span class="kw">layout</span>(<span class="kw">t</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb117-7" title="7"></a>
<a class="sourceLine" id="cb117-8" title="8"><span class="kw">plot</span>(nwGirls, <span class="dt">layout =</span> Layout, <span class="dt">label.scale =</span> <span class="ot">FALSE</span>, <span class="dt">title =</span> <span class="st">&quot;Girls&quot;</span>, <span class="dt">label.cex =</span> <span class="fl">0.75</span>,</a>
<a class="sourceLine" id="cb117-9" title="9">     <span class="dt">pie =</span> girlmeans, </a>
<a class="sourceLine" id="cb117-10" title="10">     <span class="dt">color =</span> <span class="st">&quot;skyblue&quot;</span>,</a>
<a class="sourceLine" id="cb117-11" title="11">     <span class="dt">pieBorder =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb117-12" title="12"><span class="co">## Error in qgraph::qgraph(wMat, labels = labels, directed = directed, parallelEdge = parallelEdge, : object &#39;girlmeans&#39; not found</span></a>
<a class="sourceLine" id="cb117-13" title="13"></a>
<a class="sourceLine" id="cb117-14" title="14"><span class="kw">plot</span>(nwBoys, <span class="dt">layout =</span> Layout, <span class="dt">label.scale =</span> <span class="ot">FALSE</span>, <span class="dt">title =</span> <span class="st">&quot;Boys&quot;</span>, <span class="dt">label.cex =</span> <span class="fl">0.75</span>, </a>
<a class="sourceLine" id="cb117-15" title="15">     <span class="dt">pie =</span> boymeans, </a>
<a class="sourceLine" id="cb117-16" title="16">     <span class="dt">color =</span> <span class="st">&quot;skyblue&quot;</span>,</a>
<a class="sourceLine" id="cb117-17" title="17">     <span class="dt">pieBorder =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb117-18" title="18"><span class="co">## Error in qgraph::qgraph(wMat, labels = labels, directed = directed, parallelEdge = parallelEdge, : object &#39;boymeans&#39; not found</span></a></code></pre></div>
<p>For all participants.</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb118-1" title="1"></a>
<a class="sourceLine" id="cb118-2" title="2">S.total &lt;-<span class="st"> </span>bctdf <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="dv">6</span><span class="op">:</span><span class="kw">ncol</span>(bctdf))</a>
<a class="sourceLine" id="cb118-3" title="3">nwBCT &lt;-<span class="st"> </span>bootnet<span class="op">::</span><span class="kw">estimateNetwork</span>(S.total, <span class="dt">default=</span><span class="st">&quot;IsingFit&quot;</span>)</a>
<a class="sourceLine" id="cb118-4" title="4"><span class="co">## </span></a>
<a class="sourceLine" id="cb118-5" title="5">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb118-6" title="6"><span class="st">  </span><span class="er">|</span><span class="st">                                                                 </span><span class="er">|</span><span class="st">   </span><span class="dv">0</span>%</a>
<a class="sourceLine" id="cb118-7" title="7">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb118-8" title="8"><span class="st">  </span><span class="er">|===</span><span class="st">                                                              </span><span class="er">|</span><span class="st">   </span><span class="dv">5</span>%</a>
<a class="sourceLine" id="cb118-9" title="9">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb118-10" title="10"><span class="st">  </span><span class="er">|=======</span><span class="st">                                                          </span><span class="er">|</span><span class="st">  </span><span class="dv">11</span>%</a>
<a class="sourceLine" id="cb118-11" title="11">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb118-12" title="12"><span class="st">  </span><span class="er">|==========</span><span class="st">                                                       </span><span class="er">|</span><span class="st">  </span><span class="dv">16</span>%</a>
<a class="sourceLine" id="cb118-13" title="13">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb118-14" title="14"><span class="st">  </span><span class="er">|==============</span><span class="st">                                                   </span><span class="er">|</span><span class="st">  </span><span class="dv">21</span>%</a>
<a class="sourceLine" id="cb118-15" title="15">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb118-16" title="16"><span class="st">  </span><span class="er">|=================</span><span class="st">                                                </span><span class="er">|</span><span class="st">  </span><span class="dv">26</span>%</a>
<a class="sourceLine" id="cb118-17" title="17">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb118-18" title="18"><span class="st">  </span><span class="er">|=====================</span><span class="st">                                            </span><span class="er">|</span><span class="st">  </span><span class="dv">32</span>%</a>
<a class="sourceLine" id="cb118-19" title="19">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb118-20" title="20"><span class="st">  </span><span class="er">|========================</span><span class="st">                                         </span><span class="er">|</span><span class="st">  </span><span class="dv">37</span>%</a>
<a class="sourceLine" id="cb118-21" title="21">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb118-22" title="22"><span class="st">  </span><span class="er">|===========================</span><span class="st">                                      </span><span class="er">|</span><span class="st">  </span><span class="dv">42</span>%</a>
<a class="sourceLine" id="cb118-23" title="23">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb118-24" title="24"><span class="st">  </span><span class="er">|===============================</span><span class="st">                                  </span><span class="er">|</span><span class="st">  </span><span class="dv">47</span>%</a>
<a class="sourceLine" id="cb118-25" title="25">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb118-26" title="26"><span class="st">  </span><span class="er">|==================================</span><span class="st">                               </span><span class="er">|</span><span class="st">  </span><span class="dv">53</span>%</a>
<a class="sourceLine" id="cb118-27" title="27">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb118-28" title="28"><span class="st">  </span><span class="er">|======================================</span><span class="st">                           </span><span class="er">|</span><span class="st">  </span><span class="dv">58</span>%</a>
<a class="sourceLine" id="cb118-29" title="29">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb118-30" title="30"><span class="st">  </span><span class="er">|=========================================</span><span class="st">                        </span><span class="er">|</span><span class="st">  </span><span class="dv">63</span>%</a>
<a class="sourceLine" id="cb118-31" title="31">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb118-32" title="32"><span class="st">  </span><span class="er">|============================================</span><span class="st">                     </span><span class="er">|</span><span class="st">  </span><span class="dv">68</span>%</a>
<a class="sourceLine" id="cb118-33" title="33">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb118-34" title="34"><span class="st">  </span><span class="er">|================================================</span><span class="st">                 </span><span class="er">|</span><span class="st">  </span><span class="dv">74</span>%</a>
<a class="sourceLine" id="cb118-35" title="35">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb118-36" title="36"><span class="st">  </span><span class="er">|===================================================</span><span class="st">              </span><span class="er">|</span><span class="st">  </span><span class="dv">79</span>%</a>
<a class="sourceLine" id="cb118-37" title="37">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb118-38" title="38"><span class="st">  </span><span class="er">|=======================================================</span><span class="st">          </span><span class="er">|</span><span class="st">  </span><span class="dv">84</span>%</a>
<a class="sourceLine" id="cb118-39" title="39">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb118-40" title="40"><span class="st">  </span><span class="er">|==========================================================</span><span class="st">       </span><span class="er">|</span><span class="st">  </span><span class="dv">89</span>%</a>
<a class="sourceLine" id="cb118-41" title="41">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb118-42" title="42"><span class="st">  </span><span class="er">|==============================================================</span><span class="st">   </span><span class="er">|</span><span class="st">  </span><span class="dv">95</span>%</a>
<a class="sourceLine" id="cb118-43" title="43">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb118-44" title="44"><span class="st">  </span><span class="er">|=================================================================|</span><span class="st"> </span><span class="dv">100</span>%</a>
<a class="sourceLine" id="cb118-45" title="45"></a>
<a class="sourceLine" id="cb118-46" title="46"><span class="co"># smallworldIndex(plot(nwBCT))</span></a>
<a class="sourceLine" id="cb118-47" title="47"></a>
<a class="sourceLine" id="cb118-48" title="48"><span class="co"># Create means for filling nodes</span></a>
<a class="sourceLine" id="cb118-49" title="49">piefill &lt;-<span class="st"> </span>S.total <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb118-50" title="50"><span class="st">  </span><span class="kw">summarise_all</span>(<span class="kw">funs</span>(<span class="kw">mean</span>(., <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))) </a>
<a class="sourceLine" id="cb118-51" title="51"></a>
<a class="sourceLine" id="cb118-52" title="52"><span class="co"># Plot network</span></a>
<a class="sourceLine" id="cb118-53" title="53"><span class="kw">plot</span>(nwBCT, <span class="dt">layout =</span> <span class="st">&quot;spring&quot;</span>, <span class="dt">label.scale =</span> <span class="ot">FALSE</span>, <span class="dt">title =</span> <span class="st">&quot;Ising fit&quot;</span>, <span class="dt">label.cex =</span> <span class="fl">0.75</span>,</a>
<a class="sourceLine" id="cb118-54" title="54">     <span class="dt">pie =</span> piefill, </a>
<a class="sourceLine" id="cb118-55" title="55">     <span class="dt">color =</span> <span class="st">&quot;skyblue&quot;</span>,</a>
<a class="sourceLine" id="cb118-56" title="56">     <span class="dt">pieBorder =</span> <span class="dv">1</span>)</a></code></pre></div>
<p><img src="baseline-networks_files/figure-html/onlyAllBctsIsing-allparticipants-1.png" width="2100" /></p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb119-1" title="1"></a>
<a class="sourceLine" id="cb119-2" title="2"><span class="co"># Estimate ising network without regularisation</span></a>
<a class="sourceLine" id="cb119-3" title="3">nwBCT_nonreg &lt;-<span class="st"> </span>bootnet<span class="op">::</span><span class="kw">estimateNetwork</span>(S.total, <span class="dt">default=</span><span class="st">&quot;IsingSampler&quot;</span>)</a>
<a class="sourceLine" id="cb119-4" title="4"><span class="co">## 20 iterations: deviation 0.4458221</span></a>
<a class="sourceLine" id="cb119-5" title="5"></a>
<a class="sourceLine" id="cb119-6" title="6"><span class="kw">plot</span>(nwBCT_nonreg, <span class="dt">layout =</span> <span class="st">&quot;spring&quot;</span>, <span class="dt">label.scale =</span> <span class="ot">FALSE</span>, <span class="dt">title =</span> <span class="st">&quot;Non-regularised Ising model&quot;</span>, <span class="dt">label.cex =</span> <span class="fl">0.75</span>,</a>
<a class="sourceLine" id="cb119-7" title="7">     <span class="dt">pie =</span> piefill, </a>
<a class="sourceLine" id="cb119-8" title="8">     <span class="dt">color =</span> <span class="st">&quot;skyblue&quot;</span>,</a>
<a class="sourceLine" id="cb119-9" title="9">     <span class="dt">pieBorder =</span> <span class="dv">1</span>)</a></code></pre></div>
<p><img src="baseline-networks_files/figure-html/onlyAllBctsIsing-allparticipants-2.png" width="2100" /></p>
</div>
<div id="ising-network-combined-items" class="section level2">
<h2>Ising network Combined items</h2>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb120-1" title="1">nItems &lt;-<span class="st"> </span><span class="dv">17</span></a>
<a class="sourceLine" id="cb120-2" title="2"></a>
<a class="sourceLine" id="cb120-3" title="3">bctdf &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(id,</a>
<a class="sourceLine" id="cb120-4" title="4">  intervention,</a>
<a class="sourceLine" id="cb120-5" title="5">  group,</a>
<a class="sourceLine" id="cb120-6" title="6">  school,</a>
<a class="sourceLine" id="cb120-7" title="7">  girl,</a>
<a class="sourceLine" id="cb120-8" title="8">  <span class="st">&#39;goal setting&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">01</span>_T1,</a>
<a class="sourceLine" id="cb120-9" title="9">  <span class="st">&#39;own plan&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">02</span>_T1,</a>
<a class="sourceLine" id="cb120-10" title="10">  <span class="st">&#39;plan by other&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">03</span>_T1,</a>
<a class="sourceLine" id="cb120-11" title="11">  <span class="st">&#39;reminder of plan&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">04</span>_T1,</a>
<a class="sourceLine" id="cb120-12" title="12">  <span class="st">&#39;subgoals&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">05</span>_T1,</a>
<a class="sourceLine" id="cb120-13" title="13">  <span class="st">&#39;trying new PA&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">06</span>_T1,</a>
<a class="sourceLine" id="cb120-14" title="14">  <span class="st">&#39;barrier identification&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">07</span>_T1,</a>
<a class="sourceLine" id="cb120-15" title="15">  <span class="st">&#39;problem solving&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">08</span>_T1,</a>
<a class="sourceLine" id="cb120-16" title="16">  <span class="st">&#39;PA identity reflection&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">09</span>_T1,</a>
<a class="sourceLine" id="cb120-17" title="17">  <span class="st">&#39;aligning PA with life values&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">10</span>_T1,</a>
<a class="sourceLine" id="cb120-18" title="18">  <span class="st">&#39;remind of PA benefits&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">01</span>_T1,</a>
<a class="sourceLine" id="cb120-19" title="19">  <span class="st">&#39;self-monitor (paper)&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">02</span>_T1,</a>
<a class="sourceLine" id="cb120-20" title="20">  <span class="st">&#39;self-monitor (app)&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">03</span>_T1,</a>
<a class="sourceLine" id="cb120-21" title="21"><span class="co">#  &#39;memory cues&#39; = PA_frequencyDependentBCT_04_T1,</span></a>
<a class="sourceLine" id="cb120-22" title="22">  <span class="st">&#39;goal review&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">05</span>_T1,</a>
<a class="sourceLine" id="cb120-23" title="23">  <span class="st">&#39;personal relevance reflection&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">06</span>_T1,</a>
<a class="sourceLine" id="cb120-24" title="24">  <span class="st">&#39;environmental changes (home)&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">07</span>_T1,</a>
<a class="sourceLine" id="cb120-25" title="25">  <span class="st">&#39;social support&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">08</span>_T1,</a>
<a class="sourceLine" id="cb120-26" title="26">  <span class="st">&#39;failure contemplated&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">09</span>_T1) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb120-27" title="27"><span class="st"> </span><span class="kw">mutate</span>(</a>
<a class="sourceLine" id="cb120-28" title="28">  <span class="st">&#39;goal setting&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">goal setting</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb120-29" title="29">  <span class="st">&#39;own plan&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">own plan</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span> <span class="op">&amp;</span><span class="st"> `</span><span class="dt">plan by other</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb120-30" title="30">  <span class="st">&#39;reminder of plan&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">reminder of plan</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb120-31" title="31">  <span class="st">&#39;subgoals&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">subgoals</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb120-32" title="32">  <span class="st">&#39;trying new PA&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">trying new PA</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb120-33" title="33">  <span class="st">&#39;barrier identification&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">barrier identification</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb120-34" title="34">  <span class="st">&#39;problem solving&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">problem solving</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb120-35" title="35">  <span class="st">&#39;PA identity reflection&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">PA identity reflection</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb120-36" title="36">  <span class="st">&#39;aligning PA with life values&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">aligning PA with life values</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb120-37" title="37">  <span class="st">&#39;remind of PA benefits&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">remind of PA benefits</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb120-38" title="38">  <span class="st">&#39;self-monitor&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">self-monitor (paper)</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span> <span class="op">&amp;</span><span class="st"> `</span><span class="dt">self-monitor (app)</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb120-39" title="39"><span class="co">#  &#39;memory cues&#39; = ifelse(`memory cues` == 1, 0, 1),</span></a>
<a class="sourceLine" id="cb120-40" title="40">  <span class="st">&#39;goal review&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">goal review</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb120-41" title="41">  <span class="st">&#39;personal relevance reflection&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">personal relevance reflection</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb120-42" title="42">  <span class="st">&#39;environmental changes (home)&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">environmental changes (home)</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb120-43" title="43">  <span class="st">&#39;social support&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">social support</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb120-44" title="44">  <span class="st">&#39;failure contemplated&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">failure contemplated</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb120-45" title="45"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span><span class="st">`</span><span class="dt">self-monitor (paper)</span><span class="st">`</span>, <span class="op">-</span><span class="st">`</span><span class="dt">self-monitor (app)</span><span class="st">`</span>, <span class="op">-</span><span class="st">`</span><span class="dt">plan by other</span><span class="st">`</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb120-46" title="46"><span class="st">  </span><span class="kw">mutate_all</span>(as.numeric)</a>
<a class="sourceLine" id="cb120-47" title="47"></a>
<a class="sourceLine" id="cb120-48" title="48"><span class="co"># Network for all participants</span></a>
<a class="sourceLine" id="cb120-49" title="49"></a>
<a class="sourceLine" id="cb120-50" title="50">S.total &lt;-<span class="st"> </span>bctdf <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="dv">6</span><span class="op">:</span><span class="kw">ncol</span>(bctdf))</a>
<a class="sourceLine" id="cb120-51" title="51">nwBCT &lt;-<span class="st"> </span>bootnet<span class="op">::</span><span class="kw">estimateNetwork</span>(S.total, <span class="dt">default=</span><span class="st">&quot;IsingFit&quot;</span>)</a>
<a class="sourceLine" id="cb120-52" title="52"><span class="co">## </span></a>
<a class="sourceLine" id="cb120-53" title="53">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb120-54" title="54"><span class="st">  </span><span class="er">|</span><span class="st">                                                                 </span><span class="er">|</span><span class="st">   </span><span class="dv">0</span>%</a>
<a class="sourceLine" id="cb120-55" title="55">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb120-56" title="56"><span class="st">  </span><span class="er">|====</span><span class="st">                                                             </span><span class="er">|</span><span class="st">   </span><span class="dv">6</span>%</a>
<a class="sourceLine" id="cb120-57" title="57">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb120-58" title="58"><span class="st">  </span><span class="er">|========</span><span class="st">                                                         </span><span class="er">|</span><span class="st">  </span><span class="dv">12</span>%</a>
<a class="sourceLine" id="cb120-59" title="59">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb120-60" title="60"><span class="st">  </span><span class="er">|============</span><span class="st">                                                     </span><span class="er">|</span><span class="st">  </span><span class="dv">19</span>%</a>
<a class="sourceLine" id="cb120-61" title="61">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb120-62" title="62"><span class="st">  </span><span class="er">|================</span><span class="st">                                                 </span><span class="er">|</span><span class="st">  </span><span class="dv">25</span>%</a>
<a class="sourceLine" id="cb120-63" title="63">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb120-64" title="64"><span class="st">  </span><span class="er">|====================</span><span class="st">                                             </span><span class="er">|</span><span class="st">  </span><span class="dv">31</span>%</a>
<a class="sourceLine" id="cb120-65" title="65">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb120-66" title="66"><span class="st">  </span><span class="er">|========================</span><span class="st">                                         </span><span class="er">|</span><span class="st">  </span><span class="dv">38</span>%</a>
<a class="sourceLine" id="cb120-67" title="67">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb120-68" title="68"><span class="st">  </span><span class="er">|============================</span><span class="st">                                     </span><span class="er">|</span><span class="st">  </span><span class="dv">44</span>%</a>
<a class="sourceLine" id="cb120-69" title="69">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb120-70" title="70"><span class="st">  </span><span class="er">|================================</span><span class="st">                                 </span><span class="er">|</span><span class="st">  </span><span class="dv">50</span>%</a>
<a class="sourceLine" id="cb120-71" title="71">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb120-72" title="72"><span class="st">  </span><span class="er">|=====================================</span><span class="st">                            </span><span class="er">|</span><span class="st">  </span><span class="dv">56</span>%</a>
<a class="sourceLine" id="cb120-73" title="73">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb120-74" title="74"><span class="st">  </span><span class="er">|=========================================</span><span class="st">                        </span><span class="er">|</span><span class="st">  </span><span class="dv">62</span>%</a>
<a class="sourceLine" id="cb120-75" title="75">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb120-76" title="76"><span class="st">  </span><span class="er">|=============================================</span><span class="st">                    </span><span class="er">|</span><span class="st">  </span><span class="dv">69</span>%</a>
<a class="sourceLine" id="cb120-77" title="77">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb120-78" title="78"><span class="st">  </span><span class="er">|=================================================</span><span class="st">                </span><span class="er">|</span><span class="st">  </span><span class="dv">75</span>%</a>
<a class="sourceLine" id="cb120-79" title="79">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb120-80" title="80"><span class="st">  </span><span class="er">|=====================================================</span><span class="st">            </span><span class="er">|</span><span class="st">  </span><span class="dv">81</span>%</a>
<a class="sourceLine" id="cb120-81" title="81">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb120-82" title="82"><span class="st">  </span><span class="er">|=========================================================</span><span class="st">        </span><span class="er">|</span><span class="st">  </span><span class="dv">88</span>%</a>
<a class="sourceLine" id="cb120-83" title="83">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb120-84" title="84"><span class="st">  </span><span class="er">|=============================================================</span><span class="st">    </span><span class="er">|</span><span class="st">  </span><span class="dv">94</span>%</a>
<a class="sourceLine" id="cb120-85" title="85">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb120-86" title="86"><span class="st">  </span><span class="er">|=================================================================|</span><span class="st"> </span><span class="dv">100</span>%</a>
<a class="sourceLine" id="cb120-87" title="87"></a>
<a class="sourceLine" id="cb120-88" title="88"><span class="co"># Create means for filling nodes</span></a>
<a class="sourceLine" id="cb120-89" title="89">piefill &lt;-<span class="st"> </span>S.total <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb120-90" title="90"><span class="st">  </span><span class="kw">summarise_all</span>(<span class="kw">funs</span>(<span class="kw">mean</span>(., <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))) </a>
<a class="sourceLine" id="cb120-91" title="91"></a>
<a class="sourceLine" id="cb120-92" title="92"><span class="co"># Plot network</span></a>
<a class="sourceLine" id="cb120-93" title="93"><span class="kw">plot</span>(nwBCT, <span class="dt">layout =</span> <span class="st">&quot;spring&quot;</span>, <span class="dt">label.scale =</span> <span class="ot">FALSE</span>, <span class="dt">title =</span> <span class="st">&quot;Ising fit&quot;</span>, <span class="dt">label.cex =</span> <span class="fl">0.75</span>,</a>
<a class="sourceLine" id="cb120-94" title="94">     <span class="dt">pie =</span> piefill, </a>
<a class="sourceLine" id="cb120-95" title="95">     <span class="dt">color =</span> <span class="st">&quot;skyblue&quot;</span>,</a>
<a class="sourceLine" id="cb120-96" title="96">     <span class="dt">pieBorder =</span> <span class="dv">1</span>)</a></code></pre></div>
<p><img src="baseline-networks_files/figure-html/onlyCombinedBctsIsing-dataprep-1.png" width="2100" /></p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb121-1" title="1"></a>
<a class="sourceLine" id="cb121-2" title="2"><span class="co"># # Estimate ising network without regularisation</span></a>
<a class="sourceLine" id="cb121-3" title="3"><span class="co"># nwBCT_nonreg &lt;- bootnet::estimateNetwork(S.total, default=&quot;IsingSampler&quot;)</span></a>
<a class="sourceLine" id="cb121-4" title="4"><span class="co"># </span></a>
<a class="sourceLine" id="cb121-5" title="5"><span class="co"># plot(nwBCT_nonreg, layout = &quot;spring&quot;, label.scale = FALSE, title = &quot;Non-regularised Ising model&quot;, label.cex = 0.75,</span></a>
<a class="sourceLine" id="cb121-6" title="6"><span class="co">#      pie = piefill, </span></a>
<a class="sourceLine" id="cb121-7" title="7"><span class="co">#      color = &quot;skyblue&quot;,</span></a>
<a class="sourceLine" id="cb121-8" title="8"><span class="co">#      pieBorder = 1)</span></a></code></pre></div>
<div id="centrality-and-stability-3" class="section level4">
<h4>Centrality and stability</h4>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb122-1" title="1"></a>
<a class="sourceLine" id="cb122-2" title="2">onlyCombinedBctsIsing &lt;-<span class="st"> </span>nwBCT_ggm</a>
<a class="sourceLine" id="cb122-3" title="3"></a>
<a class="sourceLine" id="cb122-4" title="4">onlyCombinedBctsIsing_centralityPlot &lt;-<span class="st"> </span>qgraph<span class="op">::</span><span class="kw">centralityPlot</span>(onlyCombinedBctsIsing)</a></code></pre></div>
<p><img src="baseline-networks_files/figure-html/onlyCombinedBctsIsing-stability-1.png" width="2100" /></p>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb123-1" title="1"></a>
<a class="sourceLine" id="cb123-2" title="2">qgraph<span class="op">::</span><span class="kw">centrality</span>(onlyCombinedBctsIsing)<span class="op">$</span>InDegree</a>
<a class="sourceLine" id="cb123-3" title="3"><span class="co">##                 MVPA questionnaire                 MVPA accelerometer </span></a>
<a class="sourceLine" id="cb123-4" title="4"><span class="co">##                          0.7291769                          0.4283575 </span></a>
<a class="sourceLine" id="cb123-5" title="5"><span class="co">##              autonomous motivation              controlled motivation </span></a>
<a class="sourceLine" id="cb123-6" title="6"><span class="co">##                          1.0018541                          0.3266061 </span></a>
<a class="sourceLine" id="cb123-7" title="7"><span class="co">##                       goal setting                           own plan </span></a>
<a class="sourceLine" id="cb123-8" title="8"><span class="co">##                          1.2013255                          1.1515237 </span></a>
<a class="sourceLine" id="cb123-9" title="9"><span class="co">##                      plan by other                   reminder of plan </span></a>
<a class="sourceLine" id="cb123-10" title="10"><span class="co">##                          0.8586703                          1.2616401 </span></a>
<a class="sourceLine" id="cb123-11" title="11"><span class="co">##                           subgoals                      trying new PA </span></a>
<a class="sourceLine" id="cb123-12" title="12"><span class="co">##                          1.0657569                          0.9139912 </span></a>
<a class="sourceLine" id="cb123-13" title="13"><span class="co">##              remind of PA benefits                        goal review </span></a>
<a class="sourceLine" id="cb123-14" title="14"><span class="co">##                          0.8476815                          1.1772245 </span></a>
<a class="sourceLine" id="cb123-15" title="15"><span class="co">##      personal relevance reflection       environmental changes (home) </span></a>
<a class="sourceLine" id="cb123-16" title="16"><span class="co">##                          1.2665951                          1.1101028 </span></a>
<a class="sourceLine" id="cb123-17" title="17"><span class="co">##                     social support barriers identified or planned for </span></a>
<a class="sourceLine" id="cb123-18" title="18"><span class="co">##                          0.9094109                          0.9906679 </span></a>
<a class="sourceLine" id="cb123-19" title="19"><span class="co">##              identity, life values                      monitoring PA </span></a>
<a class="sourceLine" id="cb123-20" title="20"><span class="co">##                          0.9063097                          0.7674526</span></a>
<a class="sourceLine" id="cb123-21" title="21"><span class="kw">scale</span>(qgraph<span class="op">::</span><span class="kw">centrality</span>(onlyCombinedBctsIsing)<span class="op">$</span>InDegree)</a>
<a class="sourceLine" id="cb123-22" title="22"><span class="co">##                                           [,1]</span></a>
<a class="sourceLine" id="cb123-23" title="23"><span class="co">## MVPA questionnaire                 -0.80562913</span></a>
<a class="sourceLine" id="cb123-24" title="24"><span class="co">## MVPA accelerometer                 -1.95688105</span></a>
<a class="sourceLine" id="cb123-25" title="25"><span class="co">## autonomous motivation               0.23792071</span></a>
<a class="sourceLine" id="cb123-26" title="26"><span class="co">## controlled motivation              -2.34628881</span></a>
<a class="sourceLine" id="cb123-27" title="27"><span class="co">## goal setting                        1.00130819</span></a>
<a class="sourceLine" id="cb123-28" title="28"><span class="co">## own plan                            0.81071431</span></a>
<a class="sourceLine" id="cb123-29" title="29"><span class="co">## plan by other                      -0.31005101</span></a>
<a class="sourceLine" id="cb123-30" title="30"><span class="co">## reminder of plan                    1.23213552</span></a>
<a class="sourceLine" id="cb123-31" title="31"><span class="co">## subgoals                            0.48247997</span></a>
<a class="sourceLine" id="cb123-32" title="32"><span class="co">## trying new PA                      -0.09833535</span></a>
<a class="sourceLine" id="cb123-33" title="33"><span class="co">## remind of PA benefits              -0.35210604</span></a>
<a class="sourceLine" id="cb123-34" title="34"><span class="co">## goal review                         0.90907258</span></a>
<a class="sourceLine" id="cb123-35" title="35"><span class="co">## personal relevance reflection       1.25109860</span></a>
<a class="sourceLine" id="cb123-36" title="36"><span class="co">## environmental changes (home)        0.65219430</span></a>
<a class="sourceLine" id="cb123-37" title="37"><span class="co">## social support                     -0.11586424</span></a>
<a class="sourceLine" id="cb123-38" title="38"><span class="co">## barriers identified or planned for  0.19511044</span></a>
<a class="sourceLine" id="cb123-39" title="39"><span class="co">## identity, life values              -0.12773282</span></a>
<a class="sourceLine" id="cb123-40" title="40"><span class="co">## monitoring PA                      -0.65914617</span></a>
<a class="sourceLine" id="cb123-41" title="41"><span class="co">## attr(,&quot;scaled:center&quot;)</span></a>
<a class="sourceLine" id="cb123-42" title="42"><span class="co">## [1] 0.939686</span></a>
<a class="sourceLine" id="cb123-43" title="43"><span class="co">## attr(,&quot;scaled:scale&quot;)</span></a>
<a class="sourceLine" id="cb123-44" title="44"><span class="co">## [1] 0.2612977</span></a>
<a class="sourceLine" id="cb123-45" title="45">qgraph<span class="op">::</span><span class="kw">centrality</span>(onlyCombinedBctsIsing)<span class="op">$</span>Closeness</a>
<a class="sourceLine" id="cb123-46" title="46"><span class="co">##                 MVPA questionnaire                 MVPA accelerometer </span></a>
<a class="sourceLine" id="cb123-47" title="47"><span class="co">##                        0.004130868                        0.003077148 </span></a>
<a class="sourceLine" id="cb123-48" title="48"><span class="co">##              autonomous motivation              controlled motivation </span></a>
<a class="sourceLine" id="cb123-49" title="49"><span class="co">##                        0.004875669                        0.002858496 </span></a>
<a class="sourceLine" id="cb123-50" title="50"><span class="co">##                       goal setting                           own plan </span></a>
<a class="sourceLine" id="cb123-51" title="51"><span class="co">##                        0.004476649                        0.004473799 </span></a>
<a class="sourceLine" id="cb123-52" title="52"><span class="co">##                      plan by other                   reminder of plan </span></a>
<a class="sourceLine" id="cb123-53" title="53"><span class="co">##                        0.004763152                        0.005479487 </span></a>
<a class="sourceLine" id="cb123-54" title="54"><span class="co">##                           subgoals                      trying new PA </span></a>
<a class="sourceLine" id="cb123-55" title="55"><span class="co">##                        0.004862465                        0.004430459 </span></a>
<a class="sourceLine" id="cb123-56" title="56"><span class="co">##              remind of PA benefits                        goal review </span></a>
<a class="sourceLine" id="cb123-57" title="57"><span class="co">##                        0.004675338                        0.005090471 </span></a>
<a class="sourceLine" id="cb123-58" title="58"><span class="co">##      personal relevance reflection       environmental changes (home) </span></a>
<a class="sourceLine" id="cb123-59" title="59"><span class="co">##                        0.005353198                        0.004471818 </span></a>
<a class="sourceLine" id="cb123-60" title="60"><span class="co">##                     social support barriers identified or planned for </span></a>
<a class="sourceLine" id="cb123-61" title="61"><span class="co">##                        0.004086210                        0.004347481 </span></a>
<a class="sourceLine" id="cb123-62" title="62"><span class="co">##              identity, life values                      monitoring PA </span></a>
<a class="sourceLine" id="cb123-63" title="63"><span class="co">##                        0.004666629                        0.005112564</span></a>
<a class="sourceLine" id="cb123-64" title="64">qgraph<span class="op">::</span><span class="kw">centrality</span>(onlyCombinedBctsIsing)<span class="op">$</span>Betweenness</a>
<a class="sourceLine" id="cb123-65" title="65"><span class="co">##                 MVPA questionnaire                 MVPA accelerometer </span></a>
<a class="sourceLine" id="cb123-66" title="66"><span class="co">##                                 32                                  0 </span></a>
<a class="sourceLine" id="cb123-67" title="67"><span class="co">##              autonomous motivation              controlled motivation </span></a>
<a class="sourceLine" id="cb123-68" title="68"><span class="co">##                                 34                                  0 </span></a>
<a class="sourceLine" id="cb123-69" title="69"><span class="co">##                       goal setting                           own plan </span></a>
<a class="sourceLine" id="cb123-70" title="70"><span class="co">##                                 12                                 16 </span></a>
<a class="sourceLine" id="cb123-71" title="71"><span class="co">##                      plan by other                   reminder of plan </span></a>
<a class="sourceLine" id="cb123-72" title="72"><span class="co">##                                 20                                 52 </span></a>
<a class="sourceLine" id="cb123-73" title="73"><span class="co">##                           subgoals                      trying new PA </span></a>
<a class="sourceLine" id="cb123-74" title="74"><span class="co">##                                 24                                  0 </span></a>
<a class="sourceLine" id="cb123-75" title="75"><span class="co">##              remind of PA benefits                        goal review </span></a>
<a class="sourceLine" id="cb123-76" title="76"><span class="co">##                                  6                                 22 </span></a>
<a class="sourceLine" id="cb123-77" title="77"><span class="co">##      personal relevance reflection       environmental changes (home) </span></a>
<a class="sourceLine" id="cb123-78" title="78"><span class="co">##                                 54                                 24 </span></a>
<a class="sourceLine" id="cb123-79" title="79"><span class="co">##                     social support barriers identified or planned for </span></a>
<a class="sourceLine" id="cb123-80" title="80"><span class="co">##                                 22                                 14 </span></a>
<a class="sourceLine" id="cb123-81" title="81"><span class="co">##              identity, life values                      monitoring PA </span></a>
<a class="sourceLine" id="cb123-82" title="82"><span class="co">##                                 16                                 30</span></a>
<a class="sourceLine" id="cb123-83" title="83"></a>
<a class="sourceLine" id="cb123-84" title="84"><span class="kw">cor</span>(qgraph<span class="op">::</span><span class="kw">centrality</span>(onlyCombinedBctsIsing)<span class="op">$</span>InDegree, qgraph<span class="op">::</span><span class="kw">centrality</span>(onlyCombinedBctsIsing)<span class="op">$</span>Betweenness, </a>
<a class="sourceLine" id="cb123-85" title="85">    <span class="dt">method =</span> <span class="st">&quot;spearman&quot;</span>) </a>
<a class="sourceLine" id="cb123-86" title="86"><span class="co">## [1] 0.445368</span></a>
<a class="sourceLine" id="cb123-87" title="87"></a>
<a class="sourceLine" id="cb123-88" title="88"><span class="co"># bootnet_stability_onlyCombinedBctsIsing &lt;- bootnet::bootnet(onlyCombinedBctsIsing, nBoots=1000)</span></a>
<a class="sourceLine" id="cb123-89" title="89"><span class="co"># save(bootnet_stability_onlyCombinedBctsIsing, file = &quot;./Rdata_files/bootnet_stability_onlyCombinedBctsIsing.Rdata&quot;)</span></a>
<a class="sourceLine" id="cb123-90" title="90"><span class="kw">load</span>(<span class="st">&quot;./Rdata_files/bootnet_stability_onlyCombinedBctsIsing.Rdata&quot;</span>)</a>
<a class="sourceLine" id="cb123-91" title="91"></a>
<a class="sourceLine" id="cb123-92" title="92"><span class="kw">plot</span>(bootnet_stability_onlyCombinedBctsIsing, <span class="dt">labels =</span> <span class="ot">FALSE</span>, <span class="dt">order =</span> <span class="st">&quot;sample&quot;</span>) </a></code></pre></div>
<p><img src="baseline-networks_files/figure-html/onlyCombinedBctsIsing-stability-2.png" width="2100" /></p>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb124-1" title="1"><span class="kw">plot</span>(bootnet_stability_onlyCombinedBctsIsing, <span class="dt">labels =</span> <span class="ot">FALSE</span>, <span class="st">&quot;edge&quot;</span>, <span class="dt">plot =</span> <span class="st">&quot;difference&quot;</span>, <span class="dt">onlyNonZero =</span> <span class="ot">TRUE</span>, <span class="dt">order =</span> <span class="st">&quot;sample&quot;</span>)</a></code></pre></div>
<p><img src="baseline-networks_files/figure-html/onlyCombinedBctsIsing-stability-3.png" width="2100" /></p>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb125-1" title="1"></a>
<a class="sourceLine" id="cb125-2" title="2"><span class="co"># bootnet_centrality_stability_onlyCombinedBctsIsing &lt;- bootnet::bootnet(onlyCombinedBctsIsing, nBoots=1000,nCores=8, type=&quot;case&quot;)</span></a>
<a class="sourceLine" id="cb125-3" title="3"><span class="co"># save(bootnet_centrality_stability_onlyCombinedBctsIsing, file = &quot;./Rdata_files/bootnet_centrality_stability_onlyCombinedBctsIsing.Rdata&quot;)</span></a>
<a class="sourceLine" id="cb125-4" title="4"><span class="kw">load</span>(<span class="st">&quot;./Rdata_files/bootnet_centrality_stability_onlyCombinedBctsIsing.Rdata&quot;</span>)</a>
<a class="sourceLine" id="cb125-5" title="5"></a>
<a class="sourceLine" id="cb125-6" title="6"><span class="kw">plot</span>(bootnet_centrality_stability_onlyCombinedBctsIsing)</a></code></pre></div>
<p><img src="baseline-networks_files/figure-html/onlyCombinedBctsIsing-stability-4.png" width="2100" /></p>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb126-1" title="1"><span class="kw">plot</span>(bootnet_centrality_stability_onlyCombinedBctsIsing, <span class="dt">perNode=</span>T, <span class="st">&quot;strength&quot;</span>)</a></code></pre></div>
<p><img src="baseline-networks_files/figure-html/onlyCombinedBctsIsing-stability-5.png" width="2100" /></p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb127-1" title="1"></a>
<a class="sourceLine" id="cb127-2" title="2">bootnet<span class="op">::</span><span class="kw">corStability</span>(bootnet_centrality_stability_onlyCombinedBctsIsing)</a>
<a class="sourceLine" id="cb127-3" title="3"><span class="co">## === Correlation Stability Analysis === </span></a>
<a class="sourceLine" id="cb127-4" title="4"><span class="co">## </span></a>
<a class="sourceLine" id="cb127-5" title="5"><span class="co">## Sampling levels tested:</span></a>
<a class="sourceLine" id="cb127-6" title="6"><span class="co">##    nPerson Drop%   n</span></a>
<a class="sourceLine" id="cb127-7" title="7"><span class="co">## 1      291  75.0 130</span></a>
<a class="sourceLine" id="cb127-8" title="8"><span class="co">## 2      382  67.2  83</span></a>
<a class="sourceLine" id="cb127-9" title="9"><span class="co">## 3      472  59.5  98</span></a>
<a class="sourceLine" id="cb127-10" title="10"><span class="co">## 4      563  51.7  94</span></a>
<a class="sourceLine" id="cb127-11" title="11"><span class="co">## 5      654  43.9  98</span></a>
<a class="sourceLine" id="cb127-12" title="12"><span class="co">## 6      744  36.1 111</span></a>
<a class="sourceLine" id="cb127-13" title="13"><span class="co">## 7      835  28.3 102</span></a>
<a class="sourceLine" id="cb127-14" title="14"><span class="co">## 8      926  20.5  94</span></a>
<a class="sourceLine" id="cb127-15" title="15"><span class="co">## 9     1016  12.8  86</span></a>
<a class="sourceLine" id="cb127-16" title="16"><span class="co">## 10    1107   5.0 104</span></a>
<a class="sourceLine" id="cb127-17" title="17"><span class="co">## </span></a>
<a class="sourceLine" id="cb127-18" title="18"><span class="co">## Maximum drop proportions to retain correlation of 0.7 in at least 95% of the samples:</span></a>
<a class="sourceLine" id="cb127-19" title="19"><span class="co">## </span></a>
<a class="sourceLine" id="cb127-20" title="20"><span class="co">## betweenness: 0.361 </span></a>
<a class="sourceLine" id="cb127-21" title="21"><span class="co">##   - For more accuracy, run bootnet(..., caseMin = 0.283, caseMax = 0.439) </span></a>
<a class="sourceLine" id="cb127-22" title="22"><span class="co">## </span></a>
<a class="sourceLine" id="cb127-23" title="23"><span class="co">## closeness: 0.75 (CS-coefficient is highest level tested)</span></a>
<a class="sourceLine" id="cb127-24" title="24"><span class="co">##   - For more accuracy, run bootnet(..., caseMin = 0.672, caseMax = 1) </span></a>
<a class="sourceLine" id="cb127-25" title="25"><span class="co">## </span></a>
<a class="sourceLine" id="cb127-26" title="26"><span class="co">## edge: 0.75 (CS-coefficient is highest level tested)</span></a>
<a class="sourceLine" id="cb127-27" title="27"><span class="co">##   - For more accuracy, run bootnet(..., caseMin = 0.672, caseMax = 1) </span></a>
<a class="sourceLine" id="cb127-28" title="28"><span class="co">## </span></a>
<a class="sourceLine" id="cb127-29" title="29"><span class="co">## strength: 0.75 (CS-coefficient is highest level tested)</span></a>
<a class="sourceLine" id="cb127-30" title="30"><span class="co">##   - For more accuracy, run bootnet(..., caseMin = 0.672, caseMax = 1) </span></a>
<a class="sourceLine" id="cb127-31" title="31"><span class="co">## </span></a>
<a class="sourceLine" id="cb127-32" title="32"><span class="co">## Accuracy can also be increased by increasing both &#39;nBoots&#39; and &#39;caseN&#39;.</span></a></code></pre></div>
</div>
<div id="network-comparison-test-boys-vs.-girls" class="section level4">
<h4>Network comparison test: boys vs. girls</h4>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb128-1" title="1"></a>
<a class="sourceLine" id="cb128-2" title="2">nct_results &lt;-<span class="st"> </span>NetworkComparisonTest<span class="op">::</span><span class="kw">NCT</span>(nwGirls, nwBoys, <span class="dt">it=</span><span class="dv">1000</span>, <span class="dt">binary.data=</span><span class="ot">TRUE</span>, <span class="dt">paired=</span><span class="ot">FALSE</span>, <span class="dt">test.edges=</span><span class="ot">TRUE</span>, <span class="dt">edges=</span><span class="st">&#39;all&#39;</span>, <span class="dt">progressbar=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb128-3" title="3"></a>
<a class="sourceLine" id="cb128-4" title="4">nct_results<span class="op">$</span>nwinv.pval  <span class="co"># p value of network structure diff test: 0.424</span></a>
<a class="sourceLine" id="cb128-5" title="5">nct_results<span class="op">$</span>glstrinv.pval  <span class="co"># p value of global connectivity diff test: 0.071</span></a>
<a class="sourceLine" id="cb128-6" title="6">nct_results<span class="op">$</span>einv.pvals     <span class="co">#p values testing diffs for all individual edges: lowest p-value 0.017, most = 1</span></a>
<a class="sourceLine" id="cb128-7" title="7"><span class="kw">sum</span>(nct_results<span class="op">$</span>einv.pvals<span class="op">$</span><span class="st">&quot;p-value&quot;</span> <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.05</span>)  <span class="co"># how many edges are different0</span></a></code></pre></div>
</div>
<div id="ggm-bcts-motivation" class="section level3">
<h3>GGM BCTs &amp; motivation</h3>
<p>The pie on nodes represents the median, as proportion of the theoretical maximum value (i.e. highest value on the questionnaire scale).</p>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb129-1" title="1"><span class="kw">library</span>(corrgram)</a>
<a class="sourceLine" id="cb129-2" title="2"></a>
<a class="sourceLine" id="cb129-3" title="3">nItems &lt;-<span class="st"> </span><span class="dv">19</span></a>
<a class="sourceLine" id="cb129-4" title="4"></a>
<a class="sourceLine" id="cb129-5" title="5">bctdf &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(id,</a>
<a class="sourceLine" id="cb129-6" title="6">  intervention,</a>
<a class="sourceLine" id="cb129-7" title="7">  group,</a>
<a class="sourceLine" id="cb129-8" title="8">  school,</a>
<a class="sourceLine" id="cb129-9" title="9">  girl,</a>
<a class="sourceLine" id="cb129-10" title="10">  <span class="st">&#39;Autonomous&#39;</span> =<span class="st"> </span>PA_autonomous_T1,</a>
<a class="sourceLine" id="cb129-11" title="11">  <span class="st">&#39;Controlled&#39;</span> =<span class="st"> </span>PA_controlled_T1,</a>
<a class="sourceLine" id="cb129-12" title="12">  <span class="st">&#39;goal setting&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">01</span>_T1,</a>
<a class="sourceLine" id="cb129-13" title="13">  <span class="st">&#39;own plan&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">02</span>_T1,</a>
<a class="sourceLine" id="cb129-14" title="14">  <span class="st">&#39;plan by other&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">03</span>_T1,</a>
<a class="sourceLine" id="cb129-15" title="15">  <span class="st">&#39;reminder of plan&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">04</span>_T1,</a>
<a class="sourceLine" id="cb129-16" title="16">  <span class="st">&#39;subgoals&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">05</span>_T1,</a>
<a class="sourceLine" id="cb129-17" title="17">  <span class="st">&#39;trying new PA&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">06</span>_T1,</a>
<a class="sourceLine" id="cb129-18" title="18">  <span class="st">&#39;barrier identification&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">07</span>_T1,</a>
<a class="sourceLine" id="cb129-19" title="19">  <span class="st">&#39;problem solving&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">08</span>_T1,</a>
<a class="sourceLine" id="cb129-20" title="20">  <span class="st">&#39;PA identity reflection&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">09</span>_T1,</a>
<a class="sourceLine" id="cb129-21" title="21">  <span class="st">&#39;aligning PA with life values&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">10</span>_T1,</a>
<a class="sourceLine" id="cb129-22" title="22">  <span class="st">&#39;remind of PA benefits&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">01</span>_T1,</a>
<a class="sourceLine" id="cb129-23" title="23">  <span class="st">&#39;self-monitor (paper)&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">02</span>_T1,</a>
<a class="sourceLine" id="cb129-24" title="24">  <span class="st">&#39;self-monitor (app)&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">03</span>_T1,</a>
<a class="sourceLine" id="cb129-25" title="25"><span class="co">#  &#39;memory cues&#39; = PA_frequencyDependentBCT_04_T1,</span></a>
<a class="sourceLine" id="cb129-26" title="26">  <span class="st">&#39;goal review&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">05</span>_T1,</a>
<a class="sourceLine" id="cb129-27" title="27">  <span class="st">&#39;personal relevance reflection&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">06</span>_T1,</a>
<a class="sourceLine" id="cb129-28" title="28">  <span class="st">&#39;environmental changes (home)&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">07</span>_T1,</a>
<a class="sourceLine" id="cb129-29" title="29">  <span class="st">&#39;social support&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">08</span>_T1,</a>
<a class="sourceLine" id="cb129-30" title="30">  <span class="st">&#39;failure contemplated&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">09</span>_T1) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb129-31" title="31"><span class="st">  </span><span class="kw">rowwise</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb129-32" title="32"><span class="st">  </span><span class="kw">mutate</span>( </a>
<a class="sourceLine" id="cb129-33" title="33">  <span class="co">#&#39;has plan&#39; = mean(c(`own plan`, `plan by other`), na.rm = TRUE),</span></a>
<a class="sourceLine" id="cb129-34" title="34">  <span class="st">&#39;self-monitor&#39;</span> =<span class="st"> </span><span class="kw">mean</span>(<span class="kw">c</span>(<span class="st">`</span><span class="dt">self-monitor (paper)</span><span class="st">`</span>, <span class="st">`</span><span class="dt">self-monitor (app)</span><span class="st">`</span>), <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb129-35" title="35"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span><span class="st">`</span><span class="dt">self-monitor (paper)</span><span class="st">`</span>, <span class="op">-</span><span class="st">`</span><span class="dt">self-monitor (app)</span><span class="st">`</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb129-36" title="36"><span class="st">  </span><span class="kw">mutate_all</span>(as.numeric)</a>
<a class="sourceLine" id="cb129-37" title="37"></a>
<a class="sourceLine" id="cb129-38" title="38"><span class="co"># Network for all participants</span></a>
<a class="sourceLine" id="cb129-39" title="39"></a>
<a class="sourceLine" id="cb129-40" title="40">S.total &lt;-<span class="st"> </span>bctdf <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="st">`</span><span class="dt">Autonomous</span><span class="st">`</span><span class="op">:</span><span class="kw">ncol</span>(bctdf))</a>
<a class="sourceLine" id="cb129-41" title="41">nwBCT &lt;-<span class="st"> </span>bootnet<span class="op">::</span><span class="kw">estimateNetwork</span>(S.total, <span class="dt">default=</span><span class="st">&quot;EBICglasso&quot;</span>)</a>
<a class="sourceLine" id="cb129-42" title="42"></a>
<a class="sourceLine" id="cb129-43" title="43"><span class="co"># Plot correlations (minmax crowds the diagonal as it plots the minimum and maximum values for each variable).</span></a>
<a class="sourceLine" id="cb129-44" title="44">labs &lt;-<span class="st"> </span><span class="kw">colnames</span>(S.total)</a>
<a class="sourceLine" id="cb129-45" title="45">corrgram<span class="op">::</span><span class="kw">corrgram</span>(S.total, </a>
<a class="sourceLine" id="cb129-46" title="46">         <span class="dt">cor.method =</span> <span class="st">&quot;spearman&quot;</span>, </a>
<a class="sourceLine" id="cb129-47" title="47">         <span class="co"># diag.panel=panel.minmax, </span></a>
<a class="sourceLine" id="cb129-48" title="48">         <span class="co"># lower.panel=panel.shade, </span></a>
<a class="sourceLine" id="cb129-49" title="49">         <span class="co"># lower.panel=panel.ellipse,</span></a>
<a class="sourceLine" id="cb129-50" title="50">         <span class="co"># lower.panel=panel.cor,</span></a>
<a class="sourceLine" id="cb129-51" title="51">         <span class="dt">upper.panel=</span>corrgram<span class="op">::</span>panel.conf,</a>
<a class="sourceLine" id="cb129-52" title="52">         <span class="dt">lower.panel=</span>corrgram<span class="op">::</span>panel.conf,</a>
<a class="sourceLine" id="cb129-53" title="53">         <span class="dt">outer.labels=</span><span class="kw">list</span>(</a>
<a class="sourceLine" id="cb129-54" title="54">           <span class="dt">bottom=</span><span class="kw">list</span>(<span class="dt">labels=</span>labs,<span class="dt">cex=</span>.<span class="dv">75</span>, <span class="dt">srt=</span><span class="dv">60</span>),</a>
<a class="sourceLine" id="cb129-55" title="55">           <span class="dt">left=</span><span class="kw">list</span>(<span class="dt">labels=</span>labs,<span class="dt">cex=</span>.<span class="dv">75</span>, <span class="dt">srt=</span><span class="dv">30</span>))</a>
<a class="sourceLine" id="cb129-56" title="56">         )</a></code></pre></div>
<p><img src="baseline-networks_files/figure-html/bct-moti-ggm-noncombined-1.png" width="2100" /></p>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb130-1" title="1"></a>
<a class="sourceLine" id="cb130-2" title="2"><span class="co"># Create means for filling nodes</span></a>
<a class="sourceLine" id="cb130-3" title="3">piefill &lt;-<span class="st"> </span>S.total <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb130-4" title="4"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>Autonomous, <span class="op">-</span>Controlled) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb130-5" title="5"><span class="st">  </span><span class="kw">data.frame</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb130-6" title="6"><span class="st">  </span><span class="kw">summarise_all</span>(<span class="kw">funs</span>(<span class="kw">mean</span>(., <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">/</span><span class="st"> </span><span class="dv">6</span>)) </a>
<a class="sourceLine" id="cb130-7" title="7"></a>
<a class="sourceLine" id="cb130-8" title="8">piefill<span class="op">$</span>Autonomous &lt;-<span class="st"> </span><span class="kw">median</span>(S.total<span class="op">$</span>Autonomous, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">/</span><span class="st"> </span><span class="dv">5</span></a>
<a class="sourceLine" id="cb130-9" title="9">piefill<span class="op">$</span>Controlled &lt;-<span class="st"> </span><span class="kw">median</span>(S.total<span class="op">$</span>Controlled, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">/</span><span class="st"> </span><span class="dv">5</span></a>
<a class="sourceLine" id="cb130-10" title="10"></a>
<a class="sourceLine" id="cb130-11" title="11">piefill &lt;-<span class="st"> </span>piefill <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(Autonomous, Controlled, <span class="kw">everything</span>())</a>
<a class="sourceLine" id="cb130-12" title="12"></a>
<a class="sourceLine" id="cb130-13" title="13"><span class="co"># Plot network</span></a>
<a class="sourceLine" id="cb130-14" title="14"><span class="kw">plot</span>(nwBCT, <span class="dt">layout =</span> <span class="st">&quot;spring&quot;</span>, <span class="dt">label.scale =</span> <span class="ot">FALSE</span>, <span class="dt">title =</span> <span class="st">&quot;GGM: BCTs &amp; motivation&quot;</span>, <span class="dt">label.cex =</span> <span class="fl">0.75</span>,</a>
<a class="sourceLine" id="cb130-15" title="15">     <span class="dt">pie =</span> piefill, </a>
<a class="sourceLine" id="cb130-16" title="16">     <span class="dt">color =</span> <span class="st">&quot;skyblue&quot;</span>,</a>
<a class="sourceLine" id="cb130-17" title="17">     <span class="dt">pieBorder =</span> <span class="dv">1</span>)</a></code></pre></div>
<p><img src="baseline-networks_files/figure-html/bct-moti-ggm-noncombined-2.png" width="2100" /></p>
<p>Network after combining goal setting and own planning, as well as barrier identification and problem solving:</p>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb131-1" title="1"><span class="co"># Combine items further:</span></a>
<a class="sourceLine" id="cb131-2" title="2">bctdf2 &lt;-<span class="st"> </span>bctdf <span class="op">%&gt;%</span><span class="st"> </span>rowwise <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb131-3" title="3"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="st">&#39;goals and plans&#39;</span> =<span class="st"> </span><span class="kw">mean</span>(<span class="kw">c</span>(<span class="st">`</span><span class="dt">goal setting</span><span class="st">`</span>, <span class="st">`</span><span class="dt">own plan</span><span class="st">`</span>), <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb131-4" title="4"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="st">&#39;barriers identified</span><span class="ch">\n</span><span class="st">and planned for&#39;</span> =<span class="st"> </span><span class="kw">mean</span>(<span class="kw">c</span>(<span class="st">`</span><span class="dt">barrier identification</span><span class="st">`</span>, <span class="st">`</span><span class="dt">problem solving</span><span class="st">`</span>), <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb131-5" title="5"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span><span class="st">`</span><span class="dt">goal setting</span><span class="st">`</span>, <span class="op">-</span><span class="st">`</span><span class="dt">own plan</span><span class="st">`</span>, <span class="op">-</span><span class="st">`</span><span class="dt">barrier identification</span><span class="st">`</span>, <span class="op">-</span><span class="st">`</span><span class="dt">problem solving</span><span class="st">`</span>)</a>
<a class="sourceLine" id="cb131-6" title="6"></a>
<a class="sourceLine" id="cb131-7" title="7">S.total2 &lt;-<span class="st"> </span>bctdf2 <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="st">`</span><span class="dt">Autonomous</span><span class="st">`</span><span class="op">:</span><span class="kw">ncol</span>(bctdf2))</a>
<a class="sourceLine" id="cb131-8" title="8">nwBCT2 &lt;-<span class="st"> </span>bootnet<span class="op">::</span><span class="kw">estimateNetwork</span>(S.total2, <span class="dt">default=</span><span class="st">&quot;EBICglasso&quot;</span>)</a>
<a class="sourceLine" id="cb131-9" title="9"></a>
<a class="sourceLine" id="cb131-10" title="10"><span class="co"># Create means for filling nodes</span></a>
<a class="sourceLine" id="cb131-11" title="11">piefill2 &lt;-<span class="st"> </span>S.total2 <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb131-12" title="12"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>Autonomous, <span class="op">-</span>Controlled) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb131-13" title="13"><span class="st">  </span><span class="kw">data.frame</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb131-14" title="14"><span class="st">  </span><span class="kw">summarise_all</span>(<span class="kw">funs</span>(<span class="kw">median</span>(., <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">/</span><span class="st"> </span><span class="dv">6</span>)) </a>
<a class="sourceLine" id="cb131-15" title="15"></a>
<a class="sourceLine" id="cb131-16" title="16">piefill2<span class="op">$</span>Autonomous &lt;-<span class="st"> </span><span class="kw">median</span>(S.total<span class="op">$</span>Autonomous, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">/</span><span class="st"> </span><span class="dv">5</span></a>
<a class="sourceLine" id="cb131-17" title="17">piefill2<span class="op">$</span>Controlled &lt;-<span class="st"> </span><span class="kw">median</span>(S.total<span class="op">$</span>Controlled, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">/</span><span class="st"> </span><span class="dv">5</span></a>
<a class="sourceLine" id="cb131-18" title="18"></a>
<a class="sourceLine" id="cb131-19" title="19">piefill2 &lt;-<span class="st"> </span>piefill2 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(Autonomous, Controlled, <span class="kw">everything</span>())</a>
<a class="sourceLine" id="cb131-20" title="20"></a>
<a class="sourceLine" id="cb131-21" title="21"><span class="co"># Plot network</span></a>
<a class="sourceLine" id="cb131-22" title="22"><span class="kw">plot</span>(nwBCT2, <span class="dt">layout =</span> <span class="st">&quot;spring&quot;</span>, <span class="dt">label.scale =</span> <span class="ot">FALSE</span>, <span class="dt">title =</span> <span class="st">&quot;GGM, BCTs &amp; motivation, items combined&quot;</span>, <span class="dt">label.cex =</span> <span class="fl">0.75</span>,</a>
<a class="sourceLine" id="cb131-23" title="23">     <span class="dt">pie =</span> piefill2, </a>
<a class="sourceLine" id="cb131-24" title="24">     <span class="dt">color =</span> <span class="st">&quot;skyblue&quot;</span>,</a>
<a class="sourceLine" id="cb131-25" title="25">     <span class="dt">pieBorder =</span> <span class="dv">1</span>)</a></code></pre></div>
<p><img src="baseline-networks_files/figure-html/bct-moti-ggm-combined-1.png" width="2100" /></p>
<div id="stability-and-robustness" class="section level4">
<h4>Stability and robustness</h4>
<p>Robustness test</p>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb132-1" title="1"><span class="kw">print</span>(<span class="st">&quot;Original items:&quot;</span>)</a>
<a class="sourceLine" id="cb132-2" title="2"><span class="co">## [1] &quot;Original items:&quot;</span></a>
<a class="sourceLine" id="cb132-3" title="3">qgraph<span class="op">::</span><span class="kw">centralityPlot</span>(nwBCT)</a></code></pre></div>
<p><img src="baseline-networks_files/figure-html/bct-robustness-1.png" width="2100" /></p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb133-1" title="1"></a>
<a class="sourceLine" id="cb133-2" title="2"><span class="kw">print</span>(<span class="st">&quot;Combined items:&quot;</span>)</a>
<a class="sourceLine" id="cb133-3" title="3"><span class="co">## [1] &quot;Combined items:&quot;</span></a>
<a class="sourceLine" id="cb133-4" title="4">qgraph<span class="op">::</span><span class="kw">centralityPlot</span>(nwBCT2)</a></code></pre></div>
<p><img src="baseline-networks_files/figure-html/bct-robustness-2.png" width="2100" /></p>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb134-1" title="1"></a>
<a class="sourceLine" id="cb134-2" title="2"><span class="co"># BCTboot1 &lt;- bootnet::bootnet(nwBCT, nBoots = 2500)</span></a>
<a class="sourceLine" id="cb134-3" title="3"><span class="co"># BCTboot2 &lt;- bootnet::bootnet(nwBCT2, nBoots = 2500)</span></a>
<a class="sourceLine" id="cb134-4" title="4"><span class="co"># save(BCTboot1, file = &quot;./Rdata_files/BCTboot1.Rdata&quot;)</span></a>
<a class="sourceLine" id="cb134-5" title="5"><span class="co"># save(BCTboot2, file = &quot;./Rdata_files/BCTboot2.Rdata&quot;)</span></a>
<a class="sourceLine" id="cb134-6" title="6"></a>
<a class="sourceLine" id="cb134-7" title="7"><span class="kw">load</span>(<span class="st">&quot;./Rdata_files/BCTboot1.Rdata&quot;</span>)</a>
<a class="sourceLine" id="cb134-8" title="8"><span class="kw">load</span>(<span class="st">&quot;./Rdata_files/BCTboot2.Rdata&quot;</span>)</a>
<a class="sourceLine" id="cb134-9" title="9"></a>
<a class="sourceLine" id="cb134-10" title="10"><span class="kw">print</span>(<span class="st">&quot;Original items:&quot;</span>)</a>
<a class="sourceLine" id="cb134-11" title="11"><span class="co">## [1] &quot;Original items:&quot;</span></a>
<a class="sourceLine" id="cb134-12" title="12"><span class="kw">plot</span>(BCTboot1, <span class="dt">labels =</span> <span class="ot">FALSE</span>, <span class="dt">order =</span> <span class="st">&quot;sample&quot;</span>)</a></code></pre></div>
<p><img src="baseline-networks_files/figure-html/bct-robustness-3.png" width="2100" /></p>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb135-1" title="1"></a>
<a class="sourceLine" id="cb135-2" title="2"><span class="kw">print</span>(<span class="st">&quot;Combined items:&quot;</span>)</a>
<a class="sourceLine" id="cb135-3" title="3"><span class="co">## [1] &quot;Combined items:&quot;</span></a>
<a class="sourceLine" id="cb135-4" title="4"><span class="kw">plot</span>(BCTboot2, <span class="dt">labels =</span> <span class="ot">FALSE</span>, <span class="dt">order =</span> <span class="st">&quot;sample&quot;</span>)</a></code></pre></div>
<p><img src="baseline-networks_files/figure-html/bct-robustness-4.png" width="2100" /></p>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb136-1" title="1"></a>
<a class="sourceLine" id="cb136-2" title="2">autEdges &lt;-<span class="st"> </span><span class="kw">summary</span>(BCTboot1, <span class="dt">statistics =</span> <span class="st">&quot;edge&quot;</span>, <span class="dt">rank =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb136-3" title="3"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">arrange</span>(mean) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb136-4" title="4"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(stringr<span class="op">::</span><span class="kw">str_detect</span>(node1, <span class="st">&#39;Autonomous&#39;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># str_detect(id, &#39;Autonomous|Controlled&#39;) for both</span></a>
<a class="sourceLine" id="cb136-5" title="5"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="op">!</span>(node2 <span class="op">==</span><span class="st"> &#39;Controlled&#39;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb136-6" title="6"><span class="st">  </span><span class="kw">data.frame</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb136-7" title="7"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(CIlower, mean, CIupper, node2)</a>
<a class="sourceLine" id="cb136-8" title="8"></a>
<a class="sourceLine" id="cb136-9" title="9">contEdges &lt;-<span class="st"> </span><span class="kw">summary</span>(BCTboot1, <span class="dt">statistics =</span> <span class="st">&quot;edge&quot;</span>, <span class="dt">rank =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb136-10" title="10"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">arrange</span>(mean) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb136-11" title="11"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(stringr<span class="op">::</span><span class="kw">str_detect</span>(node1, <span class="st">&#39;Controlled&#39;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># str_detect(id, &#39;Autonomous|Controlled&#39;) for both</span></a>
<a class="sourceLine" id="cb136-12" title="12"><span class="st">  </span><span class="kw">data.frame</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb136-13" title="13"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(CIlower, mean, CIupper, node2)</a>
<a class="sourceLine" id="cb136-14" title="14"></a>
<a class="sourceLine" id="cb136-15" title="15">userfriendlyscience<span class="op">::</span><span class="kw">diamondPlot</span>(autEdges, </a>
<a class="sourceLine" id="cb136-16" title="16">            <span class="dt">ciCols =</span> <span class="kw">c</span>(<span class="st">&quot;CIlower&quot;</span>, <span class="st">&quot;mean&quot;</span>, <span class="st">&quot;CIupper&quot;</span>), </a>
<a class="sourceLine" id="cb136-17" title="17">            <span class="dt">color =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">2</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">1</span>], </a>
<a class="sourceLine" id="cb136-18" title="18">            <span class="dt">alpha =</span> <span class="fl">0.3</span>, </a>
<a class="sourceLine" id="cb136-19" title="19">            <span class="dt">yLabels =</span> autEdges<span class="op">$</span>node2, </a>
<a class="sourceLine" id="cb136-20" title="20">            <span class="dt">fixedSize =</span> <span class="fl">0.3</span>, </a>
<a class="sourceLine" id="cb136-21" title="21">            <span class="dt">xlab =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb136-22" title="22"><span class="st">  </span>userfriendlyscience<span class="op">::</span><span class="kw">diamondPlot</span>(contEdges, </a>
<a class="sourceLine" id="cb136-23" title="23">              <span class="dt">ciCols =</span> <span class="kw">c</span>(<span class="st">&quot;CIlower&quot;</span>, <span class="st">&quot;mean&quot;</span>, <span class="st">&quot;CIupper&quot;</span>), </a>
<a class="sourceLine" id="cb136-24" title="24">              <span class="dt">color =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">2</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">2</span>], </a>
<a class="sourceLine" id="cb136-25" title="25">              <span class="dt">alpha =</span> <span class="fl">0.3</span>, </a>
<a class="sourceLine" id="cb136-26" title="26">              <span class="dt">yLabels =</span> autEdges<span class="op">$</span>node2, </a>
<a class="sourceLine" id="cb136-27" title="27">              <span class="dt">fixedSize =</span> <span class="fl">0.3</span>, </a>
<a class="sourceLine" id="cb136-28" title="28">              <span class="dt">xlab =</span> <span class="ot">NULL</span>, </a>
<a class="sourceLine" id="cb136-29" title="29">              <span class="dt">returnLayerOnly =</span> <span class="ot">TRUE</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb136-30" title="30"><span class="st">  </span><span class="kw">geom_rect</span>(<span class="kw">aes</span>(<span class="dt">xmin=</span><span class="ot">Inf</span>, <span class="dt">xmax=</span><span class="ot">Inf</span>, <span class="dt">ymin=</span><span class="ot">Inf</span>, <span class="dt">ymax=</span><span class="ot">Inf</span>, <span class="dt">fill =</span> <span class="st">&quot;Controlled&quot;</span>), </a>
<a class="sourceLine" id="cb136-31" title="31">            <span class="dt">colour=</span><span class="ot">NA</span>, <span class="dt">alpha=</span><span class="fl">0.05</span>) <span class="op">+</span><span class="st"> </span><span class="co"># Create invisible rectangle for legend</span></a>
<a class="sourceLine" id="cb136-32" title="32"><span class="st">  </span><span class="kw">geom_rect</span>(<span class="kw">aes</span>(<span class="dt">xmin=</span><span class="ot">Inf</span>, <span class="dt">xmax=</span><span class="ot">Inf</span>, <span class="dt">ymin=</span><span class="ot">Inf</span>, <span class="dt">ymax=</span><span class="ot">Inf</span>, <span class="dt">fill =</span> <span class="st">&quot;Autonomous&quot;</span>), </a>
<a class="sourceLine" id="cb136-33" title="33">            <span class="dt">colour=</span><span class="ot">NA</span>, <span class="dt">alpha=</span><span class="fl">0.05</span>) <span class="op">+</span><span class="st"> </span><span class="co"># Create invisible rectangle for legend</span></a>
<a class="sourceLine" id="cb136-34" title="34"><span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="st">&#39;Connected node&#39;</span>,</a>
<a class="sourceLine" id="cb136-35" title="35">                      <span class="dt">values =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">2</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>],  </a>
<a class="sourceLine" id="cb136-36" title="36">                      <span class="dt">guide =</span> <span class="kw">guide_legend</span>(<span class="dt">override.aes =</span> <span class="kw">list</span>(<span class="dt">alpha =</span> <span class="dv">1</span>))) <span class="op">+</span></a>
<a class="sourceLine" id="cb136-37" title="37"><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Relative strengths of edges containing autonomous </span><span class="ch">\n</span><span class="st">or controlled motivation (model with all items)&quot;</span>)</a></code></pre></div>
<p><img src="baseline-networks_files/figure-html/bct-robustness-5.png" width="2100" /></p>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb137-1" title="1">  </a>
<a class="sourceLine" id="cb137-2" title="2"><span class="co"># Combined items</span></a>
<a class="sourceLine" id="cb137-3" title="3"></a>
<a class="sourceLine" id="cb137-4" title="4">autEdges &lt;-<span class="st"> </span><span class="kw">summary</span>(BCTboot2, <span class="dt">statistics =</span> <span class="st">&quot;edge&quot;</span>, <span class="dt">rank =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb137-5" title="5"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">arrange</span>(mean) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb137-6" title="6"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(stringr<span class="op">::</span><span class="kw">str_detect</span>(node1, <span class="st">&#39;Autonomous&#39;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># str_detect(id, &#39;Autonomous|Controlled&#39;) for both</span></a>
<a class="sourceLine" id="cb137-7" title="7"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="op">!</span>(node2 <span class="op">==</span><span class="st"> &#39;Controlled&#39;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb137-8" title="8"><span class="st">  </span><span class="kw">data.frame</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb137-9" title="9"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(CIlower, mean, CIupper, node2)</a>
<a class="sourceLine" id="cb137-10" title="10"></a>
<a class="sourceLine" id="cb137-11" title="11">contEdges &lt;-<span class="st"> </span><span class="kw">summary</span>(BCTboot2, <span class="dt">statistics =</span> <span class="st">&quot;edge&quot;</span>, <span class="dt">rank =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb137-12" title="12"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">arrange</span>(mean) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb137-13" title="13"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(stringr<span class="op">::</span><span class="kw">str_detect</span>(node1, <span class="st">&#39;Controlled&#39;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># str_detect(id, &#39;Autonomous|Controlled&#39;) for both</span></a>
<a class="sourceLine" id="cb137-14" title="14"><span class="st">  </span><span class="kw">data.frame</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb137-15" title="15"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(CIlower, mean, CIupper, node2)</a>
<a class="sourceLine" id="cb137-16" title="16"></a>
<a class="sourceLine" id="cb137-17" title="17">userfriendlyscience<span class="op">::</span><span class="kw">diamondPlot</span>(autEdges, </a>
<a class="sourceLine" id="cb137-18" title="18">            <span class="dt">ciCols =</span> <span class="kw">c</span>(<span class="st">&quot;CIlower&quot;</span>, <span class="st">&quot;mean&quot;</span>, <span class="st">&quot;CIupper&quot;</span>), </a>
<a class="sourceLine" id="cb137-19" title="19">            <span class="dt">color =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">2</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">1</span>], </a>
<a class="sourceLine" id="cb137-20" title="20">            <span class="dt">alpha =</span> <span class="fl">0.3</span>, </a>
<a class="sourceLine" id="cb137-21" title="21">            <span class="dt">yLabels =</span> autEdges<span class="op">$</span>node2, </a>
<a class="sourceLine" id="cb137-22" title="22">            <span class="dt">fixedSize =</span> <span class="fl">0.3</span>, </a>
<a class="sourceLine" id="cb137-23" title="23">            <span class="dt">xlab =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb137-24" title="24"><span class="st">  </span>userfriendlyscience<span class="op">::</span><span class="kw">diamondPlot</span>(contEdges, </a>
<a class="sourceLine" id="cb137-25" title="25">              <span class="dt">ciCols =</span> <span class="kw">c</span>(<span class="st">&quot;CIlower&quot;</span>, <span class="st">&quot;mean&quot;</span>, <span class="st">&quot;CIupper&quot;</span>), </a>
<a class="sourceLine" id="cb137-26" title="26">              <span class="dt">color =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">2</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">2</span>], </a>
<a class="sourceLine" id="cb137-27" title="27">              <span class="dt">alpha =</span> <span class="fl">0.3</span>, </a>
<a class="sourceLine" id="cb137-28" title="28">              <span class="dt">yLabels =</span> autEdges<span class="op">$</span>node2, </a>
<a class="sourceLine" id="cb137-29" title="29">              <span class="dt">fixedSize =</span> <span class="fl">0.3</span>, </a>
<a class="sourceLine" id="cb137-30" title="30">              <span class="dt">xlab =</span> <span class="ot">NULL</span>, </a>
<a class="sourceLine" id="cb137-31" title="31">              <span class="dt">returnLayerOnly =</span> <span class="ot">TRUE</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb137-32" title="32"><span class="st">  </span><span class="kw">geom_rect</span>(<span class="kw">aes</span>(<span class="dt">xmin=</span><span class="ot">Inf</span>, <span class="dt">xmax=</span><span class="ot">Inf</span>, <span class="dt">ymin=</span><span class="ot">Inf</span>, <span class="dt">ymax=</span><span class="ot">Inf</span>, <span class="dt">fill =</span> <span class="st">&quot;Controlled&quot;</span>), </a>
<a class="sourceLine" id="cb137-33" title="33">            <span class="dt">colour=</span><span class="ot">NA</span>, <span class="dt">alpha=</span><span class="fl">0.05</span>) <span class="op">+</span><span class="st"> </span><span class="co"># Create invisible rectangle for legend</span></a>
<a class="sourceLine" id="cb137-34" title="34"><span class="st">  </span><span class="kw">geom_rect</span>(<span class="kw">aes</span>(<span class="dt">xmin=</span><span class="ot">Inf</span>, <span class="dt">xmax=</span><span class="ot">Inf</span>, <span class="dt">ymin=</span><span class="ot">Inf</span>, <span class="dt">ymax=</span><span class="ot">Inf</span>, <span class="dt">fill =</span> <span class="st">&quot;Autonomous&quot;</span>), </a>
<a class="sourceLine" id="cb137-35" title="35">            <span class="dt">colour=</span><span class="ot">NA</span>, <span class="dt">alpha=</span><span class="fl">0.05</span>) <span class="op">+</span><span class="st"> </span><span class="co"># Create invisible rectangle for legend</span></a>
<a class="sourceLine" id="cb137-36" title="36"><span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="st">&#39;Connected node&#39;</span>,</a>
<a class="sourceLine" id="cb137-37" title="37">                      <span class="dt">values =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">2</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>],  </a>
<a class="sourceLine" id="cb137-38" title="38">                      <span class="dt">guide =</span> <span class="kw">guide_legend</span>(<span class="dt">override.aes =</span> <span class="kw">list</span>(<span class="dt">alpha =</span> <span class="dv">1</span>))) <span class="op">+</span></a>
<a class="sourceLine" id="cb137-39" title="39"><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Relative strengths of edges containing autonomous </span><span class="ch">\n</span><span class="st">or controlled motivation (model with combined items)&quot;</span>)</a></code></pre></div>
<p><img src="baseline-networks_files/figure-html/bct-robustness-6.png" width="2100" /></p>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb138-1" title="1"></a>
<a class="sourceLine" id="cb138-2" title="2"><span class="co"># summary(BCTboot1, statistics = &quot;edge&quot;, rank = TRUE) %&gt;% </span></a>
<a class="sourceLine" id="cb138-3" title="3"><span class="co">#   dplyr::arrange(mean) %&gt;% </span></a>
<a class="sourceLine" id="cb138-4" title="4"><span class="co">#   dplyr::filter(stringr::str_detect(id, &#39;Controlled&#39;)) %&gt;%</span></a>
<a class="sourceLine" id="cb138-5" title="5"><span class="co">#   data.frame() %&gt;% </span></a>
<a class="sourceLine" id="cb138-6" title="6"><span class="co">#   dplyr::select(CIlower, mean, CIupper, id) %&gt;% </span></a>
<a class="sourceLine" id="cb138-7" title="7"><span class="co">#   userfriendlyscience::diamondPlot(ciCols = c(&quot;CIlower&quot;, &quot;mean&quot;, &quot;CIupper&quot;), ylabels = id)</span></a></code></pre></div>
</div>
<div id="add-accelerometer-measured-mvpa" class="section level4">
<h4>Add accelerometer-measured MVPA</h4>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb139-1" title="1"></a>
<a class="sourceLine" id="cb139-2" title="2">nItems_PA &lt;-<span class="st"> </span><span class="dv">20</span></a>
<a class="sourceLine" id="cb139-3" title="3"></a>
<a class="sourceLine" id="cb139-4" title="4">bctdf_PA &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(id,</a>
<a class="sourceLine" id="cb139-5" title="5">  intervention,</a>
<a class="sourceLine" id="cb139-6" title="6">  group,</a>
<a class="sourceLine" id="cb139-7" title="7">  school,</a>
<a class="sourceLine" id="cb139-8" title="8">  girl,</a>
<a class="sourceLine" id="cb139-9" title="9">  <span class="st">&#39;MVPA&#39;</span> =<span class="st"> </span>mvpaAccelerometer_T1,</a>
<a class="sourceLine" id="cb139-10" title="10">  <span class="st">&#39;Autonomous&#39;</span> =<span class="st"> </span>PA_autonomous_T1,</a>
<a class="sourceLine" id="cb139-11" title="11">  <span class="st">&#39;Controlled&#39;</span> =<span class="st"> </span>PA_controlled_T1,</a>
<a class="sourceLine" id="cb139-12" title="12">  <span class="st">&#39;goal setting&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">01</span>_T1,</a>
<a class="sourceLine" id="cb139-13" title="13">  <span class="st">&#39;own plan&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">02</span>_T1,</a>
<a class="sourceLine" id="cb139-14" title="14">  <span class="st">&#39;plan by other&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">03</span>_T1,</a>
<a class="sourceLine" id="cb139-15" title="15">  <span class="st">&#39;reminder of plan&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">04</span>_T1,</a>
<a class="sourceLine" id="cb139-16" title="16">  <span class="st">&#39;subgoals&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">05</span>_T1,</a>
<a class="sourceLine" id="cb139-17" title="17">  <span class="st">&#39;trying new PA&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">06</span>_T1,</a>
<a class="sourceLine" id="cb139-18" title="18">  <span class="st">&#39;barrier identification&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">07</span>_T1,</a>
<a class="sourceLine" id="cb139-19" title="19">  <span class="st">&#39;problem solving&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">08</span>_T1,</a>
<a class="sourceLine" id="cb139-20" title="20">  <span class="st">&#39;PA identity reflection&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">09</span>_T1,</a>
<a class="sourceLine" id="cb139-21" title="21">  <span class="st">&#39;aligning PA with life values&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">10</span>_T1,</a>
<a class="sourceLine" id="cb139-22" title="22">  <span class="st">&#39;remind of PA benefits&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">01</span>_T1,</a>
<a class="sourceLine" id="cb139-23" title="23">  <span class="st">&#39;self-monitor (paper)&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">02</span>_T1,</a>
<a class="sourceLine" id="cb139-24" title="24">  <span class="st">&#39;self-monitor (app)&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">03</span>_T1,</a>
<a class="sourceLine" id="cb139-25" title="25"><span class="co">#  &#39;memory cues&#39; = PA_frequencyDependentBCT_04_T1,</span></a>
<a class="sourceLine" id="cb139-26" title="26">  <span class="st">&#39;goal review&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">05</span>_T1,</a>
<a class="sourceLine" id="cb139-27" title="27">  <span class="st">&#39;personal relevance reflection&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">06</span>_T1,</a>
<a class="sourceLine" id="cb139-28" title="28">  <span class="st">&#39;environmental changes (home)&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">07</span>_T1,</a>
<a class="sourceLine" id="cb139-29" title="29">  <span class="st">&#39;social support&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">08</span>_T1,</a>
<a class="sourceLine" id="cb139-30" title="30">  <span class="st">&#39;failure contemplated&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">09</span>_T1) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb139-31" title="31"><span class="st">  </span><span class="kw">rowwise</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb139-32" title="32"><span class="st">  </span><span class="kw">mutate</span>( </a>
<a class="sourceLine" id="cb139-33" title="33">  <span class="co">#&#39;has plan&#39; = mean(c(`own plan`, `plan by other`), na.rm = TRUE),</span></a>
<a class="sourceLine" id="cb139-34" title="34">  <span class="st">&#39;self-monitor&#39;</span> =<span class="st"> </span><span class="kw">mean</span>(<span class="kw">c</span>(<span class="st">`</span><span class="dt">self-monitor (paper)</span><span class="st">`</span>, <span class="st">`</span><span class="dt">self-monitor (app)</span><span class="st">`</span>), <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb139-35" title="35"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span><span class="st">`</span><span class="dt">self-monitor (paper)</span><span class="st">`</span>, <span class="op">-</span><span class="st">`</span><span class="dt">self-monitor (app)</span><span class="st">`</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb139-36" title="36"><span class="st">  </span><span class="kw">mutate_all</span>(as.numeric)</a>
<a class="sourceLine" id="cb139-37" title="37"></a>
<a class="sourceLine" id="cb139-38" title="38"><span class="co"># Network for all participants</span></a>
<a class="sourceLine" id="cb139-39" title="39"></a>
<a class="sourceLine" id="cb139-40" title="40">S.total_PA &lt;-<span class="st"> </span>bctdf_PA <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="st">`</span><span class="dt">MVPA</span><span class="st">`</span><span class="op">:</span><span class="kw">ncol</span>(bctdf_PA))</a>
<a class="sourceLine" id="cb139-41" title="41">nwBCT_PA &lt;-<span class="st"> </span>bootnet<span class="op">::</span><span class="kw">estimateNetwork</span>(S.total_PA, <span class="dt">default=</span><span class="st">&quot;EBICglasso&quot;</span>)</a>
<a class="sourceLine" id="cb139-42" title="42"></a>
<a class="sourceLine" id="cb139-43" title="43">labs &lt;-<span class="st"> </span><span class="kw">colnames</span>(S.total_PA)</a>
<a class="sourceLine" id="cb139-44" title="44"></a>
<a class="sourceLine" id="cb139-45" title="45"><span class="co"># Create means for filling nodes</span></a>
<a class="sourceLine" id="cb139-46" title="46">piefill &lt;-<span class="st"> </span>S.total_PA <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb139-47" title="47"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>MVPA, <span class="op">-</span>Autonomous, <span class="op">-</span>Controlled) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb139-48" title="48"><span class="st">  </span><span class="kw">data.frame</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb139-49" title="49"><span class="st">  </span><span class="kw">summarise_all</span>(<span class="kw">funs</span>(<span class="kw">median</span>(., <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">/</span><span class="st"> </span><span class="dv">6</span>))   </a>
<a class="sourceLine" id="cb139-50" title="50"></a>
<a class="sourceLine" id="cb139-51" title="51">piefill<span class="op">$</span>MVPA &lt;-<span class="st"> </span><span class="kw">median</span>(S.total_PA<span class="op">$</span>MVPA, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">/</span><span class="st"> </span>(<span class="dv">60</span><span class="op">*</span><span class="dv">24</span>) </a>
<a class="sourceLine" id="cb139-52" title="52">piefill<span class="op">$</span>Autonomous &lt;-<span class="st"> </span><span class="kw">median</span>(S.total_PA<span class="op">$</span>Autonomous, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">/</span><span class="st"> </span><span class="dv">5</span></a>
<a class="sourceLine" id="cb139-53" title="53">piefill<span class="op">$</span>Controlled &lt;-<span class="st"> </span><span class="kw">median</span>(S.total_PA<span class="op">$</span>Controlled, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">/</span><span class="st"> </span><span class="dv">5</span></a>
<a class="sourceLine" id="cb139-54" title="54"></a>
<a class="sourceLine" id="cb139-55" title="55">piefill &lt;-<span class="st"> </span>piefill <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(MVPA, Autonomous, Controlled, <span class="kw">everything</span>())</a>
<a class="sourceLine" id="cb139-56" title="56"></a>
<a class="sourceLine" id="cb139-57" title="57"><span class="co"># Plot network</span></a>
<a class="sourceLine" id="cb139-58" title="58"><span class="kw">plot</span>(nwBCT_PA, <span class="dt">layout =</span> <span class="st">&quot;spring&quot;</span>, <span class="dt">label.scale =</span> <span class="ot">FALSE</span>, <span class="dt">title =</span> <span class="st">&quot;GGM: Accelerometer-MVPA, BCTs &amp; motivation (all items)&quot;</span>, <span class="dt">label.cex =</span> <span class="fl">0.75</span>,</a>
<a class="sourceLine" id="cb139-59" title="59">     <span class="dt">pie =</span> piefill, </a>
<a class="sourceLine" id="cb139-60" title="60">     <span class="dt">color =</span> <span class="st">&quot;skyblue&quot;</span>,</a>
<a class="sourceLine" id="cb139-61" title="61">     <span class="dt">pieBorder =</span> <span class="dv">1</span>)</a></code></pre></div>
<p><img src="baseline-networks_files/figure-html/bct-pa-motivation-ggm-1.png" width="2100" /></p>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb140-1" title="1"></a>
<a class="sourceLine" id="cb140-2" title="2"><span class="co"># Combine items further:</span></a>
<a class="sourceLine" id="cb140-3" title="3">bctdf_PA2 &lt;-<span class="st"> </span>bctdf_PA <span class="op">%&gt;%</span><span class="st"> </span>rowwise <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb140-4" title="4"><span class="st">  </span><span class="kw">mutate</span>(<span class="st">&#39;goals and plans&#39;</span> =<span class="st"> </span><span class="kw">mean</span>(<span class="kw">c</span>(<span class="st">`</span><span class="dt">goal setting</span><span class="st">`</span>, <span class="st">`</span><span class="dt">own plan</span><span class="st">`</span>), <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb140-5" title="5"><span class="st">  </span><span class="kw">mutate</span>(<span class="st">&#39;barriers identified</span><span class="ch">\n</span><span class="st">and planned for&#39;</span> =<span class="st"> </span><span class="kw">mean</span>(<span class="kw">c</span>(<span class="st">`</span><span class="dt">barrier identification</span><span class="st">`</span>, <span class="st">`</span><span class="dt">problem solving</span><span class="st">`</span>), <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb140-6" title="6"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span><span class="st">`</span><span class="dt">goal setting</span><span class="st">`</span>, <span class="op">-</span><span class="st">`</span><span class="dt">own plan</span><span class="st">`</span>, <span class="op">-</span><span class="st">`</span><span class="dt">barrier identification</span><span class="st">`</span>, <span class="op">-</span><span class="st">`</span><span class="dt">problem solving</span><span class="st">`</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb140-7" title="7"><span class="st">  </span>data.frame</a>
<a class="sourceLine" id="cb140-8" title="8"></a>
<a class="sourceLine" id="cb140-9" title="9">S.total_PA2 &lt;-<span class="st"> </span>bctdf_PA2 <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(MVPA<span class="op">:</span><span class="kw">ncol</span>(bctdf_PA2))</a>
<a class="sourceLine" id="cb140-10" title="10">nwBCT_PA2 &lt;-<span class="st"> </span>bootnet<span class="op">::</span><span class="kw">estimateNetwork</span>(S.total_PA2, <span class="dt">default=</span><span class="st">&quot;EBICglasso&quot;</span>)</a>
<a class="sourceLine" id="cb140-11" title="11"></a>
<a class="sourceLine" id="cb140-12" title="12"><span class="co"># Create means for filling nodes</span></a>
<a class="sourceLine" id="cb140-13" title="13">piefill_PA2 &lt;-<span class="st"> </span>S.total_PA2 <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb140-14" title="14"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>MVPA, <span class="op">-</span>Autonomous, <span class="op">-</span>Controlled) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb140-15" title="15"><span class="st">  </span><span class="kw">data.frame</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb140-16" title="16"><span class="st">  </span><span class="kw">summarise_all</span>(<span class="kw">funs</span>(<span class="kw">median</span>(., <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">/</span><span class="st"> </span><span class="dv">6</span>)) </a>
<a class="sourceLine" id="cb140-17" title="17"></a>
<a class="sourceLine" id="cb140-18" title="18">piefill_PA2<span class="op">$</span>MVPA &lt;-<span class="st"> </span><span class="kw">median</span>(S.total_PA2<span class="op">$</span>MVPA, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">/</span><span class="st"> </span>(<span class="dv">60</span><span class="op">*</span><span class="dv">24</span>) </a>
<a class="sourceLine" id="cb140-19" title="19">piefill_PA2<span class="op">$</span>Autonomous &lt;-<span class="st"> </span><span class="kw">median</span>(S.total_PA2<span class="op">$</span>Autonomous, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">/</span><span class="st"> </span><span class="dv">5</span></a>
<a class="sourceLine" id="cb140-20" title="20">piefill_PA2<span class="op">$</span>Controlled &lt;-<span class="st"> </span><span class="kw">median</span>(S.total_PA2<span class="op">$</span>Controlled, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">/</span><span class="st"> </span><span class="dv">5</span></a>
<a class="sourceLine" id="cb140-21" title="21"></a>
<a class="sourceLine" id="cb140-22" title="22">piefill_PA2 &lt;-<span class="st"> </span>piefill_PA2 <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(MVPA, <span class="kw">everything</span>())</a>
<a class="sourceLine" id="cb140-23" title="23"></a>
<a class="sourceLine" id="cb140-24" title="24"></a>
<a class="sourceLine" id="cb140-25" title="25"><span class="co"># Plot network</span></a>
<a class="sourceLine" id="cb140-26" title="26"><span class="kw">plot</span>(nwBCT_PA2, <span class="dt">layout =</span> <span class="st">&quot;spring&quot;</span>, <span class="dt">label.scale =</span> <span class="ot">FALSE</span>, <span class="dt">title =</span> <span class="st">&quot;GGM: Accelerometer-MVPA, BCTs &amp; motivation (combined items)&quot;</span>, <span class="dt">label.cex =</span> <span class="fl">0.75</span>,</a>
<a class="sourceLine" id="cb140-27" title="27">     <span class="dt">pie =</span> piefill_PA2, </a>
<a class="sourceLine" id="cb140-28" title="28">     <span class="dt">color =</span> <span class="st">&quot;skyblue&quot;</span>,</a>
<a class="sourceLine" id="cb140-29" title="29">     <span class="dt">pieBorder =</span> <span class="dv">1</span>)</a></code></pre></div>
<p><img src="baseline-networks_files/figure-html/bct-pa-motivation-ggm-2.png" width="2100" /></p>
</div>
<div id="centrality-and-stability-4" class="section level4">
<h4>Centrality and stability</h4>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb141-1" title="1"><span class="co"># BCTbootPA &lt;- bootnet::bootnet(nwBCT_PA2, nBoots = 2500)</span></a>
<a class="sourceLine" id="cb141-2" title="2"><span class="co"># save(BCTbootPA, file = &quot;./Rdata_files/BCTbootPA.Rdata&quot;)</span></a>
<a class="sourceLine" id="cb141-3" title="3"></a>
<a class="sourceLine" id="cb141-4" title="4"><span class="kw">load</span>(<span class="st">&quot;./Rdata_files/BCTbootPA.Rdata&quot;</span>)</a>
<a class="sourceLine" id="cb141-5" title="5"></a>
<a class="sourceLine" id="cb141-6" title="6">qgraph<span class="op">::</span><span class="kw">centralityPlot</span>(nwBCT_PA2)</a></code></pre></div>
<p><img src="baseline-networks_files/figure-html/unnamed-chunk-8-1.png" width="2100" /></p>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb142-1" title="1"></a>
<a class="sourceLine" id="cb142-2" title="2"><span class="kw">plot</span>(BCTbootPA, <span class="dt">labels =</span> <span class="ot">FALSE</span>, <span class="dt">order =</span> <span class="st">&quot;sample&quot;</span>)</a></code></pre></div>
<p><img src="baseline-networks_files/figure-html/unnamed-chunk-8-2.png" width="2100" /></p>
</div>
</div>
</div>
<div id="demonstrating-the-ising-network" class="section level2">
<h2>Demonstrating the Ising network</h2>
<p>… in PA, autonomous motivation, and top-5 BCTs</p>
<p>Variables are binarised: * If one reports not using the BCT, they get a zero, otherwise a 1 * If one reports not having done no MVPA during the last week, they get a zero, otherwise a 1 * On the autonomous motivation sum score, if one reports lower agreement than 3 (indicating “sometimes true for me”) on average, they get a zero, otherwise a 1</p>
<p>We include the top 5 BCTs according to their bivariate Spearman correlations with self-reported PA. Self-report instead of accelerometer due to higher sample size and accounting for e.g. gym.</p>
<ol style="list-style-type: decimal">
<li>I have tried out new ways for me to be physically active.</li>
<li>I have personally made a specific plan (“what, where, how”) to implement my PA.</li>
<li>I have a PA plan, which has been made by someone else, e.g. my sports club (e.g. a workout schedule).</li>
<li>I have set PA goals for myself.</li>
<li>I have broken down larger PA goals to smaller subgoals.</li>
</ol>
<p>When a person has tried out a new PA way to be physically active, they have almost (because question time scales don’t overlap completely) by definition done MVPA lately. Therefore, we substitute this with:</p>
<ol start="6" style="list-style-type: decimal">
<li>I have compared my actualized PA with the PA goal I have set.</li>
</ol>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb143-1" title="1"></a>
<a class="sourceLine" id="cb143-2" title="2"></a>
<a class="sourceLine" id="cb143-3" title="3">top5Bcts_df &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(</a>
<a class="sourceLine" id="cb143-4" title="4">  <span class="dt">MVPA =</span> padaysLastweek_T1,</a>
<a class="sourceLine" id="cb143-5" title="5">  <span class="dt">Autonomous =</span> PA_autonomous_T1, </a>
<a class="sourceLine" id="cb143-6" title="6">  <span class="st">&#39;goal review&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">05</span>_T1,</a>
<a class="sourceLine" id="cb143-7" title="7">  <span class="st">&#39;own plan&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">02</span>_T1,</a>
<a class="sourceLine" id="cb143-8" title="8">  <span class="st">&#39;plan by other&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">03</span>_T1,</a>
<a class="sourceLine" id="cb143-9" title="9">  <span class="st">&#39;goal setting&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">01</span>_T1,</a>
<a class="sourceLine" id="cb143-10" title="10">  <span class="st">&#39;subgoals&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">05</span>_T1) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb143-11" title="11"><span class="st"> </span><span class="kw">mutate</span>(</a>
<a class="sourceLine" id="cb143-12" title="12">  <span class="st">&#39;MVPA&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">MVPA</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb143-13" title="13">  <span class="st">&#39;Autonomous&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">Autonomous</span><span class="st">`</span> <span class="op">&lt;</span><span class="st"> </span><span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb143-14" title="14">  <span class="st">&#39;goal review&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">goal review</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb143-15" title="15">  <span class="st">&#39;own plan&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">own plan</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb143-16" title="16">  <span class="st">&#39;plan by other&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">plan by other</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb143-17" title="17">  <span class="st">&#39;goal setting&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">goal setting</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb143-18" title="18">  <span class="st">&#39;subgoals&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">subgoals</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>))  </a>
<a class="sourceLine" id="cb143-19" title="19"></a>
<a class="sourceLine" id="cb143-20" title="20">allMeans &lt;-<span class="st"> </span>top5Bcts_df <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb143-21" title="21"><span class="st">  </span><span class="kw">summarise_all</span>(<span class="kw">funs</span>(<span class="kw">mean</span>(., <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))) </a>
<a class="sourceLine" id="cb143-22" title="22"></a>
<a class="sourceLine" id="cb143-23" title="23">network_all &lt;-<span class="st"> </span>bootnet<span class="op">::</span><span class="kw">estimateNetwork</span>(top5Bcts_df, <span class="dt">default=</span><span class="st">&quot;IsingFit&quot;</span>)</a>
<a class="sourceLine" id="cb143-24" title="24"><span class="co">## </span></a>
<a class="sourceLine" id="cb143-25" title="25">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb143-26" title="26"><span class="st">  </span><span class="er">|</span><span class="st">                                                                 </span><span class="er">|</span><span class="st">   </span><span class="dv">0</span>%</a>
<a class="sourceLine" id="cb143-27" title="27">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb143-28" title="28"><span class="st">  </span><span class="er">|=========</span><span class="st">                                                        </span><span class="er">|</span><span class="st">  </span><span class="dv">14</span>%</a>
<a class="sourceLine" id="cb143-29" title="29">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb143-30" title="30"><span class="st">  </span><span class="er">|===================</span><span class="st">                                              </span><span class="er">|</span><span class="st">  </span><span class="dv">29</span>%</a>
<a class="sourceLine" id="cb143-31" title="31">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb143-32" title="32"><span class="st">  </span><span class="er">|============================</span><span class="st">                                     </span><span class="er">|</span><span class="st">  </span><span class="dv">43</span>%</a>
<a class="sourceLine" id="cb143-33" title="33">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb143-34" title="34"><span class="st">  </span><span class="er">|=====================================</span><span class="st">                            </span><span class="er">|</span><span class="st">  </span><span class="dv">57</span>%</a>
<a class="sourceLine" id="cb143-35" title="35">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb143-36" title="36"><span class="st">  </span><span class="er">|==============================================</span><span class="st">                   </span><span class="er">|</span><span class="st">  </span><span class="dv">71</span>%</a>
<a class="sourceLine" id="cb143-37" title="37">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb143-38" title="38"><span class="st">  </span><span class="er">|========================================================</span><span class="st">         </span><span class="er">|</span><span class="st">  </span><span class="dv">86</span>%</a>
<a class="sourceLine" id="cb143-39" title="39">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb143-40" title="40"><span class="st">  </span><span class="er">|=================================================================|</span><span class="st"> </span><span class="dv">100</span>%</a>
<a class="sourceLine" id="cb143-41" title="41"></a>
<a class="sourceLine" id="cb143-42" title="42">graph_cor &lt;-<span class="st"> </span>qgraph<span class="op">::</span><span class="kw">qgraph</span>(qgraph<span class="op">::</span><span class="kw">cor_auto</span>(top5Bcts_df), <span class="dt">graph =</span> <span class="st">&quot;cor&quot;</span>, <span class="dt">layout=</span><span class="st">&quot;spring&quot;</span>, <span class="dt">cut=</span><span class="dv">0</span>, </a>
<a class="sourceLine" id="cb143-43" title="43">                  <span class="dt">label.scale =</span> <span class="ot">FALSE</span>, <span class="dt">edge.labels =</span> <span class="ot">TRUE</span>, <span class="dt">labels =</span> <span class="kw">names</span>(top5Bcts_df),</a>
<a class="sourceLine" id="cb143-44" title="44">                  <span class="dt">pie =</span> allMeans, <span class="dt">pieBorder =</span> <span class="dv">1</span>, <span class="dt">title =</span> <span class="st">&quot;Bivariate correlations&quot;</span>)</a></code></pre></div>
<p><img src="baseline-networks_files/figure-html/ising-demo-pa-autmot-top5bcts-1.png" width="2100" /></p>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb144-1" title="1">graph_Ising &lt;-<span class="st"> </span><span class="kw">plot</span>(network_all, <span class="dt">layout=</span><span class="st">&quot;spring&quot;</span>, <span class="dt">cut=</span><span class="dv">0</span>, <span class="dt">label.scale =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb144-2" title="2">                  <span class="dt">pie =</span> allMeans, <span class="dt">pieBorder =</span> <span class="dv">1</span>, <span class="dt">title =</span> <span class="st">&quot;Ising model&quot;</span>)</a></code></pre></div>
<p><img src="baseline-networks_files/figure-html/ising-demo-pa-autmot-top5bcts-2.png" width="2100" /></p>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb145-1" title="1"></a>
<a class="sourceLine" id="cb145-2" title="2"><span class="co"># maxedge &lt;- max(c(graph_Ising$graphAttributes$Graph$maximum, </span></a>
<a class="sourceLine" id="cb145-3" title="3"><span class="co">#                  graph_cor$graphAttributes$Graph$maximum))</span></a>
<a class="sourceLine" id="cb145-4" title="4"></a>
<a class="sourceLine" id="cb145-5" title="5">L &lt;-<span class="st"> </span>qgraph<span class="op">::</span><span class="kw">averageLayout</span>(graph_cor, graph_Ising)</a>
<a class="sourceLine" id="cb145-6" title="6"></a>
<a class="sourceLine" id="cb145-7" title="7"><span class="kw">layout</span>(<span class="kw">matrix</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>, <span class="dt">nrow =</span> <span class="dv">1</span>, <span class="dt">byrow =</span> <span class="ot">TRUE</span>))</a>
<a class="sourceLine" id="cb145-8" title="8">graph_cor &lt;-<span class="st"> </span>qgraph<span class="op">::</span><span class="kw">qgraph</span>(qgraph<span class="op">::</span><span class="kw">cor_auto</span>(top5Bcts_df), <span class="dt">graph =</span> <span class="st">&quot;cor&quot;</span>, <span class="dt">layout=</span>L, <span class="dt">cut=</span><span class="dv">0</span>, </a>
<a class="sourceLine" id="cb145-9" title="9">                  <span class="dt">label.scale =</span> <span class="ot">FALSE</span>, <span class="dt">edge.labels =</span> <span class="ot">TRUE</span>, <span class="dt">labels =</span> <span class="kw">names</span>(top5Bcts_df), <span class="dt">label.cex =</span> <span class="fl">0.8</span>,</a>
<a class="sourceLine" id="cb145-10" title="10">                  <span class="dt">pie =</span> allMeans, <span class="dt">pieBorder =</span> <span class="dv">1</span>, <span class="dt">title =</span> <span class="st">&quot;Bivariate correlations&quot;</span>)</a>
<a class="sourceLine" id="cb145-11" title="11">graph_Ising &lt;-<span class="st"> </span><span class="kw">plot</span>(network_all, <span class="dt">layout=</span>L, <span class="dt">cut=</span><span class="dv">0</span>, <span class="dt">label.scale =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb145-12" title="12">                  <span class="dt">pie =</span> allMeans, <span class="dt">pieBorder =</span> <span class="dv">1</span>, <span class="dt">title =</span> <span class="st">&quot;Ising model&quot;</span>, <span class="dt">label.cex =</span> <span class="fl">0.8</span>)</a></code></pre></div>
<p><img src="baseline-networks_files/figure-html/ising-demo-pa-autmot-top5bcts-3.png" width="2100" /></p>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb146-1" title="1"></a>
<a class="sourceLine" id="cb146-2" title="2">qgraph<span class="op">::</span><span class="kw">flow</span>(graph_Ising, </a>
<a class="sourceLine" id="cb146-3" title="3">             <span class="st">&quot;MVPA&quot;</span>, </a>
<a class="sourceLine" id="cb146-4" title="4">             <span class="dt">groups =</span> <span class="kw">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="kw">rep</span>(<span class="st">&quot;C&quot;</span>, <span class="dv">5</span>)),</a>
<a class="sourceLine" id="cb146-5" title="5">             <span class="dt">legend =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb146-6" title="6">             <span class="dt">title =</span> <span class="st">&quot;&quot;</span>,</a>
<a class="sourceLine" id="cb146-7" title="7">             <span class="dt">vsize =</span> <span class="dv">15</span>,</a>
<a class="sourceLine" id="cb146-8" title="8">             <span class="dt">label.cex =</span> <span class="fl">1.5</span>,</a>
<a class="sourceLine" id="cb146-9" title="9">             <span class="dt">colors =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">3</span>),</a>
<a class="sourceLine" id="cb146-10" title="10">             <span class="dt">label.color =</span> <span class="kw">c</span>(<span class="st">&quot;white&quot;</span>, <span class="kw">rep</span>(<span class="st">&quot;black&quot;</span>, <span class="dv">6</span>)))</a></code></pre></div>
<p><img src="baseline-networks_files/figure-html/ising-demo-pa-autmot-top5bcts-4.png" width="2100" /></p>
<p>Centrality and stability:</p>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb147-1" title="1">Ising_centralityPlot &lt;-<span class="st"> </span>qgraph<span class="op">::</span><span class="kw">centralityPlot</span>(graph_Ising)</a></code></pre></div>
<p><img src="baseline-networks_files/figure-html/top5Bcts-stability-1.png" width="2100" /></p>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb148-1" title="1"></a>
<a class="sourceLine" id="cb148-2" title="2">qgraph<span class="op">::</span><span class="kw">centrality</span>(graph_Ising)<span class="op">$</span>InDegree</a>
<a class="sourceLine" id="cb148-3" title="3"><span class="co">##          MVPA    Autonomous   goal review      own plan plan by other </span></a>
<a class="sourceLine" id="cb148-4" title="4"><span class="co">##      2.738643      3.198366      3.771397      7.473934      4.181088 </span></a>
<a class="sourceLine" id="cb148-5" title="5"><span class="co">##  goal setting      subgoals </span></a>
<a class="sourceLine" id="cb148-6" title="6"><span class="co">##      4.805290      5.656572</span></a>
<a class="sourceLine" id="cb148-7" title="7"><span class="kw">scale</span>(qgraph<span class="op">::</span><span class="kw">centrality</span>(graph_Ising)<span class="op">$</span>InDegree)</a>
<a class="sourceLine" id="cb148-8" title="8"><span class="co">##                     [,1]</span></a>
<a class="sourceLine" id="cb148-9" title="9"><span class="co">## MVPA          -1.1179740</span></a>
<a class="sourceLine" id="cb148-10" title="10"><span class="co">## Autonomous    -0.8336781</span></a>
<a class="sourceLine" id="cb148-11" title="11"><span class="co">## goal review   -0.4793110</span></a>
<a class="sourceLine" id="cb148-12" title="12"><span class="co">## own plan       1.8103664</span></a>
<a class="sourceLine" id="cb148-13" title="13"><span class="co">## plan by other -0.2259548</span></a>
<a class="sourceLine" id="cb148-14" title="14"><span class="co">## goal setting   0.1600562</span></a>
<a class="sourceLine" id="cb148-15" title="15"><span class="co">## subgoals       0.6864954</span></a>
<a class="sourceLine" id="cb148-16" title="16"><span class="co">## attr(,&quot;scaled:center&quot;)</span></a>
<a class="sourceLine" id="cb148-17" title="17"><span class="co">## [1] 4.54647</span></a>
<a class="sourceLine" id="cb148-18" title="18"><span class="co">## attr(,&quot;scaled:scale&quot;)</span></a>
<a class="sourceLine" id="cb148-19" title="19"><span class="co">## [1] 1.617056</span></a>
<a class="sourceLine" id="cb148-20" title="20">qgraph<span class="op">::</span><span class="kw">centrality</span>(graph_Ising)<span class="op">$</span>Closeness</a>
<a class="sourceLine" id="cb148-21" title="21"><span class="co">##          MVPA    Autonomous   goal review      own plan plan by other </span></a>
<a class="sourceLine" id="cb148-22" title="22"><span class="co">##    0.08689381    0.08758533    0.09784630    0.15833382    0.12275906 </span></a>
<a class="sourceLine" id="cb148-23" title="23"><span class="co">##  goal setting      subgoals </span></a>
<a class="sourceLine" id="cb148-24" title="24"><span class="co">##    0.10532717    0.13454803</span></a>
<a class="sourceLine" id="cb148-25" title="25">qgraph<span class="op">::</span><span class="kw">centrality</span>(graph_Ising)<span class="op">$</span>Betweenness</a>
<a class="sourceLine" id="cb148-26" title="26"><span class="co">##          MVPA    Autonomous   goal review      own plan plan by other </span></a>
<a class="sourceLine" id="cb148-27" title="27"><span class="co">##             0             0             0            16             4 </span></a>
<a class="sourceLine" id="cb148-28" title="28"><span class="co">##  goal setting      subgoals </span></a>
<a class="sourceLine" id="cb148-29" title="29"><span class="co">##             0             2</span></a>
<a class="sourceLine" id="cb148-30" title="30"></a>
<a class="sourceLine" id="cb148-31" title="31"><span class="kw">cor</span>(qgraph<span class="op">::</span><span class="kw">centrality</span>(graph_Ising)<span class="op">$</span>InDegree, qgraph<span class="op">::</span><span class="kw">centrality</span>(graph_Ising)<span class="op">$</span>Betweenness, </a>
<a class="sourceLine" id="cb148-32" title="32">    <span class="dt">method =</span> <span class="st">&quot;spearman&quot;</span>) </a>
<a class="sourceLine" id="cb148-33" title="33"><span class="co">## [1] 0.7290021</span></a>
<a class="sourceLine" id="cb148-34" title="34"></a>
<a class="sourceLine" id="cb148-35" title="35"><span class="co"># bootnet_stability_top5Bcts &lt;- bootnet::bootnet(network_all, nBoots=1000)</span></a>
<a class="sourceLine" id="cb148-36" title="36"><span class="co"># save(bootnet_stability_top5Bcts, file = &quot;./Rdata_files/bootnet_stability_top5Bcts.Rdata&quot;)</span></a>
<a class="sourceLine" id="cb148-37" title="37"><span class="kw">load</span>(<span class="st">&quot;./Rdata_files/bootnet_stability_top5Bcts.Rdata&quot;</span>)</a>
<a class="sourceLine" id="cb148-38" title="38"></a>
<a class="sourceLine" id="cb148-39" title="39"><span class="kw">plot</span>(bootnet_stability_top5Bcts, <span class="dt">labels =</span> <span class="ot">TRUE</span>, <span class="dt">order =</span> <span class="st">&quot;sample&quot;</span>) </a></code></pre></div>
<p><img src="baseline-networks_files/figure-html/top5Bcts-stability-2.png" width="2100" /></p>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb149-1" title="1"><span class="kw">plot</span>(bootnet_stability_top5Bcts, <span class="st">&quot;edge&quot;</span>, <span class="dt">plot =</span> <span class="st">&quot;difference&quot;</span>, <span class="dt">onlyNonZero =</span> <span class="ot">TRUE</span>, <span class="dt">order =</span> <span class="st">&quot;sample&quot;</span>)</a></code></pre></div>
<p><img src="baseline-networks_files/figure-html/top5Bcts-stability-3.png" width="2100" /></p>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb150-1" title="1"></a>
<a class="sourceLine" id="cb150-2" title="2"><span class="co"># bootnet_centrality_stability_top5Bcts &lt;- bootnet::bootnet(network_all, nBoots=1000,nCores=8, type=&quot;case&quot;)</span></a>
<a class="sourceLine" id="cb150-3" title="3"><span class="co"># save(bootnet_centrality_stability_top5Bcts, file = &quot;./Rdata_files/bootnet_centrality_stability_top5Bcts.Rdata&quot;)</span></a>
<a class="sourceLine" id="cb150-4" title="4"><span class="kw">load</span>(<span class="st">&quot;./Rdata_files/bootnet_centrality_stability_top5Bcts.Rdata&quot;</span>)</a>
<a class="sourceLine" id="cb150-5" title="5"></a>
<a class="sourceLine" id="cb150-6" title="6"><span class="kw">plot</span>(bootnet_centrality_stability_top5Bcts)</a></code></pre></div>
<p><img src="baseline-networks_files/figure-html/top5Bcts-stability-4.png" width="2100" /></p>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb151-1" title="1"><span class="kw">plot</span>(bootnet_centrality_stability_top5Bcts, <span class="dt">perNode=</span>T, <span class="st">&quot;strength&quot;</span>)</a></code></pre></div>
<p><img src="baseline-networks_files/figure-html/top5Bcts-stability-5.png" width="2100" /></p>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb152-1" title="1"></a>
<a class="sourceLine" id="cb152-2" title="2">bootnet<span class="op">::</span><span class="kw">corStability</span>(bootnet_centrality_stability_top5Bcts) </a>
<a class="sourceLine" id="cb152-3" title="3"><span class="co">## === Correlation Stability Analysis === </span></a>
<a class="sourceLine" id="cb152-4" title="4"><span class="co">## </span></a>
<a class="sourceLine" id="cb152-5" title="5"><span class="co">## Sampling levels tested:</span></a>
<a class="sourceLine" id="cb152-6" title="6"><span class="co">##    nPerson Drop%   n</span></a>
<a class="sourceLine" id="cb152-7" title="7"><span class="co">## 1      291  75.0  92</span></a>
<a class="sourceLine" id="cb152-8" title="8"><span class="co">## 2      382  67.2  94</span></a>
<a class="sourceLine" id="cb152-9" title="9"><span class="co">## 3      472  59.5 125</span></a>
<a class="sourceLine" id="cb152-10" title="10"><span class="co">## 4      563  51.7  97</span></a>
<a class="sourceLine" id="cb152-11" title="11"><span class="co">## 5      654  43.9  94</span></a>
<a class="sourceLine" id="cb152-12" title="12"><span class="co">## 6      744  36.1 103</span></a>
<a class="sourceLine" id="cb152-13" title="13"><span class="co">## 7      835  28.3 102</span></a>
<a class="sourceLine" id="cb152-14" title="14"><span class="co">## 8      926  20.5  92</span></a>
<a class="sourceLine" id="cb152-15" title="15"><span class="co">## 9     1016  12.8 105</span></a>
<a class="sourceLine" id="cb152-16" title="16"><span class="co">## 10    1107   5.0  96</span></a>
<a class="sourceLine" id="cb152-17" title="17"><span class="co">## </span></a>
<a class="sourceLine" id="cb152-18" title="18"><span class="co">## Maximum drop proportions to retain correlation of 0.7 in at least 95% of the samples:</span></a>
<a class="sourceLine" id="cb152-19" title="19"><span class="co">## </span></a>
<a class="sourceLine" id="cb152-20" title="20"><span class="co">## betweenness: 0.283 </span></a>
<a class="sourceLine" id="cb152-21" title="21"><span class="co">##   - For more accuracy, run bootnet(..., caseMin = 0.205, caseMax = 0.361) </span></a>
<a class="sourceLine" id="cb152-22" title="22"><span class="co">## </span></a>
<a class="sourceLine" id="cb152-23" title="23"><span class="co">## closeness: Could not be computed (likely due to non-finite values) </span></a>
<a class="sourceLine" id="cb152-24" title="24"><span class="co">## </span></a>
<a class="sourceLine" id="cb152-25" title="25"><span class="co">## edge: 0.75 (CS-coefficient is highest level tested)</span></a>
<a class="sourceLine" id="cb152-26" title="26"><span class="co">##   - For more accuracy, run bootnet(..., caseMin = 0.672, caseMax = 1) </span></a>
<a class="sourceLine" id="cb152-27" title="27"><span class="co">## </span></a>
<a class="sourceLine" id="cb152-28" title="28"><span class="co">## intercept: 0.75 (CS-coefficient is highest level tested)</span></a>
<a class="sourceLine" id="cb152-29" title="29"><span class="co">##   - For more accuracy, run bootnet(..., caseMin = 0.672, caseMax = 1) </span></a>
<a class="sourceLine" id="cb152-30" title="30"><span class="co">## </span></a>
<a class="sourceLine" id="cb152-31" title="31"><span class="co">## strength: 0.75 (CS-coefficient is highest level tested)</span></a>
<a class="sourceLine" id="cb152-32" title="32"><span class="co">##   - For more accuracy, run bootnet(..., caseMin = 0.672, caseMax = 1) </span></a>
<a class="sourceLine" id="cb152-33" title="33"><span class="co">## </span></a>
<a class="sourceLine" id="cb152-34" title="34"><span class="co">## Accuracy can also be increased by increasing both &#39;nBoots&#39; and &#39;caseN&#39;.</span></a></code></pre></div>
<div id="heterogeneity-check" class="section level3">
<h3>Heterogeneity check</h3>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb153-1" title="1"></a>
<a class="sourceLine" id="cb153-2" title="2">top5Bcts_tracks_df &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(</a>
<a class="sourceLine" id="cb153-3" title="3">  track,</a>
<a class="sourceLine" id="cb153-4" title="4">  <span class="dt">PA =</span> padaysLastweek_T1,</a>
<a class="sourceLine" id="cb153-5" title="5">  <span class="dt">Autonomous =</span> PA_autonomous_T1, </a>
<a class="sourceLine" id="cb153-6" title="6">  <span class="st">&#39;trying new PA&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">06</span>_T1,</a>
<a class="sourceLine" id="cb153-7" title="7">  <span class="st">&#39;own plan&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">02</span>_T1,</a>
<a class="sourceLine" id="cb153-8" title="8">  <span class="st">&#39;plan by other&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">03</span>_T1,</a>
<a class="sourceLine" id="cb153-9" title="9">  <span class="st">&#39;goal setting&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">01</span>_T1,</a>
<a class="sourceLine" id="cb153-10" title="10">  <span class="st">&#39;subgoals&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">05</span>_T1) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb153-11" title="11"><span class="st"> </span><span class="kw">mutate</span>(</a>
<a class="sourceLine" id="cb153-12" title="12">  <span class="st">&#39;PA&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">PA</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb153-13" title="13">  <span class="st">&#39;Autonomous&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">Autonomous</span><span class="st">`</span> <span class="op">&lt;</span><span class="st"> </span><span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb153-14" title="14">  <span class="st">&#39;trying new PA&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">trying new PA</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb153-15" title="15">  <span class="st">&#39;own plan&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">own plan</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb153-16" title="16">  <span class="st">&#39;plan by other&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">plan by other</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb153-17" title="17">  <span class="st">&#39;goal setting&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">goal setting</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb153-18" title="18">  <span class="st">&#39;subgoals&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">subgoals</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>))</a>
<a class="sourceLine" id="cb153-19" title="19"></a>
<a class="sourceLine" id="cb153-20" title="20">heterogeneity_Nur &lt;-<span class="st"> </span>top5Bcts_tracks_df <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb153-21" title="21"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;Nur&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb153-22" title="22"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>track) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb153-23" title="23"><span class="st">  </span><span class="kw">na.omit</span>() </a>
<a class="sourceLine" id="cb153-24" title="24">NurMeans &lt;-<span class="st"> </span>heterogeneity_Nur <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb153-25" title="25"><span class="st">  </span><span class="kw">summarise_all</span>(<span class="kw">funs</span>(<span class="kw">mean</span>(., <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))) </a>
<a class="sourceLine" id="cb153-26" title="26"></a>
<a class="sourceLine" id="cb153-27" title="27">heterogeneity_HRC &lt;-<span class="st"> </span>top5Bcts_tracks_df <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb153-28" title="28"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;HRC&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb153-29" title="29"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>track) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb153-30" title="30"><span class="st">  </span><span class="kw">na.omit</span>()</a>
<a class="sourceLine" id="cb153-31" title="31">HRCMeans &lt;-<span class="st"> </span>heterogeneity_HRC <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb153-32" title="32"><span class="st">  </span><span class="kw">summarise_all</span>(<span class="kw">funs</span>(<span class="kw">mean</span>(., <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))) </a>
<a class="sourceLine" id="cb153-33" title="33"></a>
<a class="sourceLine" id="cb153-34" title="34">heterogeneity_BA &lt;-<span class="st"> </span>top5Bcts_tracks_df <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb153-35" title="35"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;BA&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb153-36" title="36"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>track) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb153-37" title="37"><span class="st">  </span><span class="kw">na.omit</span>()</a>
<a class="sourceLine" id="cb153-38" title="38">BAMeans &lt;-<span class="st"> </span>heterogeneity_BA <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb153-39" title="39"><span class="st">  </span><span class="kw">summarise_all</span>(<span class="kw">funs</span>(<span class="kw">mean</span>(., <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))) </a>
<a class="sourceLine" id="cb153-40" title="40"></a>
<a class="sourceLine" id="cb153-41" title="41">heterogeneity_IT &lt;-<span class="st"> </span>top5Bcts_tracks_df <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb153-42" title="42"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(track <span class="op">==</span><span class="st"> &quot;IT&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb153-43" title="43"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>track) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb153-44" title="44"><span class="st">  </span><span class="kw">na.omit</span>() </a>
<a class="sourceLine" id="cb153-45" title="45">ITMeans &lt;-<span class="st"> </span>heterogeneity_IT <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb153-46" title="46"><span class="st">  </span><span class="kw">summarise_all</span>(<span class="kw">funs</span>(<span class="kw">mean</span>(., <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))) </a>
<a class="sourceLine" id="cb153-47" title="47"></a>
<a class="sourceLine" id="cb153-48" title="48">network_Nur &lt;-<span class="st"> </span>bootnet<span class="op">::</span><span class="kw">estimateNetwork</span>(heterogeneity_Nur, <span class="dt">default=</span><span class="st">&quot;IsingFit&quot;</span>)</a>
<a class="sourceLine" id="cb153-49" title="49"><span class="co">## </span></a>
<a class="sourceLine" id="cb153-50" title="50">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb153-51" title="51"><span class="st">  </span><span class="er">|</span><span class="st">                                                                 </span><span class="er">|</span><span class="st">   </span><span class="dv">0</span>%</a>
<a class="sourceLine" id="cb153-52" title="52">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb153-53" title="53"><span class="st">  </span><span class="er">|=========</span><span class="st">                                                        </span><span class="er">|</span><span class="st">  </span><span class="dv">14</span>%</a>
<a class="sourceLine" id="cb153-54" title="54">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb153-55" title="55"><span class="st">  </span><span class="er">|===================</span><span class="st">                                              </span><span class="er">|</span><span class="st">  </span><span class="dv">29</span>%</a>
<a class="sourceLine" id="cb153-56" title="56">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb153-57" title="57"><span class="st">  </span><span class="er">|============================</span><span class="st">                                     </span><span class="er">|</span><span class="st">  </span><span class="dv">43</span>%</a>
<a class="sourceLine" id="cb153-58" title="58">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb153-59" title="59"><span class="st">  </span><span class="er">|=====================================</span><span class="st">                            </span><span class="er">|</span><span class="st">  </span><span class="dv">57</span>%</a>
<a class="sourceLine" id="cb153-60" title="60">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb153-61" title="61"><span class="st">  </span><span class="er">|==============================================</span><span class="st">                   </span><span class="er">|</span><span class="st">  </span><span class="dv">71</span>%</a>
<a class="sourceLine" id="cb153-62" title="62">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb153-63" title="63"><span class="st">  </span><span class="er">|========================================================</span><span class="st">         </span><span class="er">|</span><span class="st">  </span><span class="dv">86</span>%</a>
<a class="sourceLine" id="cb153-64" title="64">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb153-65" title="65"><span class="st">  </span><span class="er">|=================================================================|</span><span class="st"> </span><span class="dv">100</span>%</a>
<a class="sourceLine" id="cb153-66" title="66">network_HRC &lt;-<span class="st"> </span>bootnet<span class="op">::</span><span class="kw">estimateNetwork</span>(heterogeneity_HRC, <span class="dt">default=</span><span class="st">&quot;IsingFit&quot;</span>)</a>
<a class="sourceLine" id="cb153-67" title="67"><span class="co">## </span></a>
<a class="sourceLine" id="cb153-68" title="68">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb153-69" title="69"><span class="st">  </span><span class="er">|</span><span class="st">                                                                 </span><span class="er">|</span><span class="st">   </span><span class="dv">0</span>%</a>
<a class="sourceLine" id="cb153-70" title="70">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb153-71" title="71"><span class="st">  </span><span class="er">|=========</span><span class="st">                                                        </span><span class="er">|</span><span class="st">  </span><span class="dv">14</span>%</a>
<a class="sourceLine" id="cb153-72" title="72">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb153-73" title="73"><span class="st">  </span><span class="er">|===================</span><span class="st">                                              </span><span class="er">|</span><span class="st">  </span><span class="dv">29</span>%</a>
<a class="sourceLine" id="cb153-74" title="74">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb153-75" title="75"><span class="st">  </span><span class="er">|============================</span><span class="st">                                     </span><span class="er">|</span><span class="st">  </span><span class="dv">43</span>%</a>
<a class="sourceLine" id="cb153-76" title="76">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb153-77" title="77"><span class="st">  </span><span class="er">|=====================================</span><span class="st">                            </span><span class="er">|</span><span class="st">  </span><span class="dv">57</span>%</a>
<a class="sourceLine" id="cb153-78" title="78">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb153-79" title="79"><span class="st">  </span><span class="er">|==============================================</span><span class="st">                   </span><span class="er">|</span><span class="st">  </span><span class="dv">71</span>%</a>
<a class="sourceLine" id="cb153-80" title="80">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb153-81" title="81"><span class="st">  </span><span class="er">|========================================================</span><span class="st">         </span><span class="er">|</span><span class="st">  </span><span class="dv">86</span>%</a>
<a class="sourceLine" id="cb153-82" title="82">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb153-83" title="83"><span class="st">  </span><span class="er">|=================================================================|</span><span class="st"> </span><span class="dv">100</span>%</a>
<a class="sourceLine" id="cb153-84" title="84">network_BA &lt;-<span class="st"> </span>bootnet<span class="op">::</span><span class="kw">estimateNetwork</span>(heterogeneity_BA, <span class="dt">default=</span><span class="st">&quot;IsingFit&quot;</span>)</a>
<a class="sourceLine" id="cb153-85" title="85"><span class="co">## </span></a>
<a class="sourceLine" id="cb153-86" title="86">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb153-87" title="87"><span class="st">  </span><span class="er">|</span><span class="st">                                                                 </span><span class="er">|</span><span class="st">   </span><span class="dv">0</span>%</a>
<a class="sourceLine" id="cb153-88" title="88">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb153-89" title="89"><span class="st">  </span><span class="er">|=========</span><span class="st">                                                        </span><span class="er">|</span><span class="st">  </span><span class="dv">14</span>%</a>
<a class="sourceLine" id="cb153-90" title="90">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb153-91" title="91"><span class="st">  </span><span class="er">|===================</span><span class="st">                                              </span><span class="er">|</span><span class="st">  </span><span class="dv">29</span>%</a>
<a class="sourceLine" id="cb153-92" title="92">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb153-93" title="93"><span class="st">  </span><span class="er">|============================</span><span class="st">                                     </span><span class="er">|</span><span class="st">  </span><span class="dv">43</span>%</a>
<a class="sourceLine" id="cb153-94" title="94">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb153-95" title="95"><span class="st">  </span><span class="er">|=====================================</span><span class="st">                            </span><span class="er">|</span><span class="st">  </span><span class="dv">57</span>%</a>
<a class="sourceLine" id="cb153-96" title="96">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb153-97" title="97"><span class="st">  </span><span class="er">|==============================================</span><span class="st">                   </span><span class="er">|</span><span class="st">  </span><span class="dv">71</span>%</a>
<a class="sourceLine" id="cb153-98" title="98">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb153-99" title="99"><span class="st">  </span><span class="er">|========================================================</span><span class="st">         </span><span class="er">|</span><span class="st">  </span><span class="dv">86</span>%</a>
<a class="sourceLine" id="cb153-100" title="100">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb153-101" title="101"><span class="st">  </span><span class="er">|=================================================================|</span><span class="st"> </span><span class="dv">100</span>%</a>
<a class="sourceLine" id="cb153-102" title="102">network_IT &lt;-<span class="st"> </span>bootnet<span class="op">::</span><span class="kw">estimateNetwork</span>(heterogeneity_IT, <span class="dt">default=</span><span class="st">&quot;IsingFit&quot;</span>)</a>
<a class="sourceLine" id="cb153-103" title="103"><span class="co">## </span></a>
<a class="sourceLine" id="cb153-104" title="104">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb153-105" title="105"><span class="st">  </span><span class="er">|</span><span class="st">                                                                 </span><span class="er">|</span><span class="st">   </span><span class="dv">0</span>%</a>
<a class="sourceLine" id="cb153-106" title="106">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb153-107" title="107"><span class="st">  </span><span class="er">|=========</span><span class="st">                                                        </span><span class="er">|</span><span class="st">  </span><span class="dv">14</span>%</a>
<a class="sourceLine" id="cb153-108" title="108">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb153-109" title="109"><span class="st">  </span><span class="er">|===================</span><span class="st">                                              </span><span class="er">|</span><span class="st">  </span><span class="dv">29</span>%</a>
<a class="sourceLine" id="cb153-110" title="110">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb153-111" title="111"><span class="st">  </span><span class="er">|============================</span><span class="st">                                     </span><span class="er">|</span><span class="st">  </span><span class="dv">43</span>%</a>
<a class="sourceLine" id="cb153-112" title="112">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb153-113" title="113"><span class="st">  </span><span class="er">|=====================================</span><span class="st">                            </span><span class="er">|</span><span class="st">  </span><span class="dv">57</span>%</a>
<a class="sourceLine" id="cb153-114" title="114">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb153-115" title="115"><span class="st">  </span><span class="er">|==============================================</span><span class="st">                   </span><span class="er">|</span><span class="st">  </span><span class="dv">71</span>%</a>
<a class="sourceLine" id="cb153-116" title="116">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb153-117" title="117"><span class="st">  </span><span class="er">|========================================================</span><span class="st">         </span><span class="er">|</span><span class="st">  </span><span class="dv">86</span>%</a>
<a class="sourceLine" id="cb153-118" title="118">  <span class="op">|</span><span class="st">                                                                       </span></a>
<a class="sourceLine" id="cb153-119" title="119"><span class="st">  </span><span class="er">|=================================================================|</span><span class="st"> </span><span class="dv">100</span>%</a>
<a class="sourceLine" id="cb153-120" title="120"></a>
<a class="sourceLine" id="cb153-121" title="121">graph_Nur &lt;-<span class="st"> </span><span class="kw">plot</span>(network_Nur, <span class="dt">layout=</span><span class="st">&quot;spring&quot;</span>, <span class="dt">cut=</span><span class="dv">0</span>, <span class="dt">label.scale =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb153-122" title="122">                  <span class="dt">pie =</span> NurMeans, <span class="dt">pieBorder =</span> <span class="dv">1</span>, <span class="dt">title =</span> <span class="st">&quot;Practical nurse&quot;</span>)</a></code></pre></div>
<p><img src="baseline-networks_files/figure-html/top5Bcts-heterogeneity-1.png" width="2100" /></p>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb154-1" title="1">graph_HRC &lt;-<span class="st"> </span><span class="kw">plot</span>(network_HRC, <span class="dt">layout=</span><span class="st">&quot;spring&quot;</span>, <span class="dt">cut=</span><span class="dv">0</span>, <span class="dt">label.scale =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb154-2" title="2">                  <span class="dt">pie =</span> HRCMeans, <span class="dt">pieBorder =</span> <span class="dv">1</span>, <span class="dt">title =</span> <span class="st">&quot;HRC&quot;</span>)</a></code></pre></div>
<p><img src="baseline-networks_files/figure-html/top5Bcts-heterogeneity-2.png" width="2100" /></p>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb155-1" title="1">graph_BA &lt;-<span class="st"> </span><span class="kw">plot</span>(network_BA, <span class="dt">layout=</span><span class="st">&quot;spring&quot;</span>, <span class="dt">cut=</span><span class="dv">0</span>, <span class="dt">label.scale =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb155-2" title="2">                  <span class="dt">pie =</span> BAMeans, <span class="dt">pieBorder =</span> <span class="dv">1</span>, <span class="dt">title =</span> <span class="st">&quot;BA&quot;</span>)</a></code></pre></div>
<p><img src="baseline-networks_files/figure-html/top5Bcts-heterogeneity-3.png" width="2100" /></p>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb156-1" title="1">graph_IT &lt;-<span class="st"> </span><span class="kw">plot</span>(network_IT, <span class="dt">layout=</span><span class="st">&quot;spring&quot;</span>, <span class="dt">cut=</span><span class="dv">0</span>, <span class="dt">label.scale =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb156-2" title="2">                  <span class="dt">pie =</span> ITMeans, <span class="dt">pieBorder =</span> <span class="dv">1</span>, <span class="dt">title =</span> <span class="st">&quot;IT&quot;</span>)</a></code></pre></div>
<p><img src="baseline-networks_files/figure-html/top5Bcts-heterogeneity-4.png" width="2100" /></p>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb157-1" title="1"></a>
<a class="sourceLine" id="cb157-2" title="2">maxedge &lt;-<span class="st"> </span><span class="kw">max</span>(<span class="kw">c</span>(graph_Nur<span class="op">$</span>graphAttributes<span class="op">$</span>Graph<span class="op">$</span>maximum, </a>
<a class="sourceLine" id="cb157-3" title="3">                 graph_HRC<span class="op">$</span>graphAttributes<span class="op">$</span>Graph<span class="op">$</span>maximum, </a>
<a class="sourceLine" id="cb157-4" title="4">                 graph_BA<span class="op">$</span>graphAttributes<span class="op">$</span>Graph<span class="op">$</span>maximum, </a>
<a class="sourceLine" id="cb157-5" title="5">                 graph_IT<span class="op">$</span>graphAttributes<span class="op">$</span>Graph<span class="op">$</span>maximum))</a>
<a class="sourceLine" id="cb157-6" title="6"></a>
<a class="sourceLine" id="cb157-7" title="7">L &lt;-<span class="st"> </span>qgraph<span class="op">::</span><span class="kw">averageLayout</span>(graph_Nur, graph_HRC, graph_BA, graph_IT)</a>
<a class="sourceLine" id="cb157-8" title="8"></a>
<a class="sourceLine" id="cb157-9" title="9"><span class="kw">layout</span>(<span class="kw">matrix</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>, <span class="dt">nrow =</span> <span class="dv">2</span>, <span class="dt">byrow =</span> <span class="ot">TRUE</span>))</a>
<a class="sourceLine" id="cb157-10" title="10">graph_Nur &lt;-<span class="st"> </span><span class="kw">plot</span>(network_Nur, <span class="dt">layout=</span>L, <span class="dt">cut=</span><span class="dv">0</span>, <span class="dt">label.scale =</span> <span class="ot">FALSE</span>, <span class="dt">title =</span> <span class="st">&quot;Practical nurse&quot;</span>, </a>
<a class="sourceLine" id="cb157-11" title="11">                  <span class="dt">maximum =</span> maxedge, <span class="dt">pie =</span> NurMeans, <span class="dt">pieBorder =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb157-12" title="12">graph_HRC &lt;-<span class="st"> </span><span class="kw">plot</span>(network_HRC, <span class="dt">layout=</span>L, <span class="dt">cut=</span><span class="dv">0</span>, <span class="dt">label.scale =</span> <span class="ot">FALSE</span>, <span class="dt">title =</span> <span class="st">&quot;HRC&quot;</span>,</a>
<a class="sourceLine" id="cb157-13" title="13">                  <span class="dt">maximum =</span> maxedge, <span class="dt">pie =</span> HRCMeans, <span class="dt">pieBorder =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb157-14" title="14">graph_BA &lt;-<span class="st"> </span><span class="kw">plot</span>(network_BA, <span class="dt">layout=</span>L, <span class="dt">cut=</span><span class="dv">0</span>, <span class="dt">label.scale =</span> <span class="ot">FALSE</span>, <span class="dt">title =</span> <span class="st">&quot;BA&quot;</span>, </a>
<a class="sourceLine" id="cb157-15" title="15">                 <span class="dt">maximum =</span> maxedge, <span class="dt">pie =</span> BAMeans, <span class="dt">pieBorder =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb157-16" title="16">graph_IT &lt;-<span class="st"> </span><span class="kw">plot</span>(network_IT, <span class="dt">layout=</span>L, <span class="dt">cut=</span><span class="dv">0</span>, <span class="dt">label.scale =</span> <span class="ot">FALSE</span>, <span class="dt">title =</span> <span class="st">&quot;IT&quot;</span>,</a>
<a class="sourceLine" id="cb157-17" title="17">                 <span class="dt">maximum =</span> maxedge, <span class="dt">pie =</span> ITMeans, <span class="dt">pieBorder =</span> <span class="dv">1</span>)</a></code></pre></div>
<p><img src="baseline-networks_files/figure-html/top5Bcts-heterogeneity-5.png" width="2100" /></p>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb158-1" title="1"></a>
<a class="sourceLine" id="cb158-2" title="2"></a>
<a class="sourceLine" id="cb158-3" title="3"><span class="co"># nct_results_top5Bcts &lt;- NetworkComparisonTest::NCT(heterogeneity_Nur, heterogeneity_IT, it=1000, binary.data=FALSE, paired=FALSE, test.edges=TRUE,</span></a>
<a class="sourceLine" id="cb158-4" title="4"><span class="co"># edges=&#39;all&#39;, progressbar=TRUE)</span></a>
<a class="sourceLine" id="cb158-5" title="5"><span class="co"># </span></a>
<a class="sourceLine" id="cb158-6" title="6"><span class="co"># save(nct_results_top5Bcts, file = &quot;./Rdata_files/nct_results_top5Bcts.Rdata&quot;)</span></a>
<a class="sourceLine" id="cb158-7" title="7"><span class="co"># alternatively, load </span></a>
<a class="sourceLine" id="cb158-8" title="8"><span class="kw">load</span>(<span class="st">&quot;./Rdata_files/nct_results_top5Bcts.Rdata&quot;</span>)</a></code></pre></div>
<p>Results from the network comparison test between Nur and IT on “top-5” BCTs:</p>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb159-1" title="1"></a>
<a class="sourceLine" id="cb159-2" title="2"><span class="kw">print</span>(<span class="st">&quot;Similarity&quot;</span>)</a></code></pre></div>
<p>[1] “Similarity”</p>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb160-1" title="1"><span class="kw">cat</span>(<span class="st">&quot;Correlation between Nur and IT edge strengths:&quot;</span>, <span class="kw">cor</span>(qgraph<span class="op">::</span><span class="kw">centrality</span>(network_Nur)<span class="op">$</span>InDegree, qgraph<span class="op">::</span><span class="kw">centrality</span>(network_IT)<span class="op">$</span>InDegree))</a></code></pre></div>
<p>Correlation between Nur and IT edge strengths: 0.7378432</p>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb161-1" title="1"></a>
<a class="sourceLine" id="cb161-2" title="2"><span class="kw">cat</span>(<span class="st">&quot;Correlation between Nur and IT networks:&quot;</span>, <span class="kw">cor</span>(network_Nur<span class="op">$</span>graph[<span class="kw">lower.tri</span>(network_Nur<span class="op">$</span>graph)], network_IT<span class="op">$</span>graph[<span class="kw">lower.tri</span>(network_Nur<span class="op">$</span>graph)], <span class="dt">method=</span><span class="st">&quot;spearman&quot;</span>))</a></code></pre></div>
<p>Correlation between Nur and IT networks: 0.4107089</p>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb162-1" title="1"></a>
<a class="sourceLine" id="cb162-2" title="2"><span class="kw">print</span>(<span class="st">&quot;Difference&quot;</span>)</a></code></pre></div>
<p>[1] “Difference”</p>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb163-1" title="1"><span class="kw">cat</span>(<span class="st">&quot;P-value for the test of identical network structure:&quot;</span>, nct_results_top5Bcts<span class="op">$</span>nwinv.pval)</a></code></pre></div>
<p>P-value for the test of identical network structure: 0.804</p>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb164-1" title="1"><span class="kw">cat</span>(<span class="st">&quot;P-value for the test of identical connectivity in networks:&quot;</span>, nct_results_top5Bcts<span class="op">$</span>glstrinv.pval)</a></code></pre></div>
<p>P-value for the test of identical connectivity in networks: 0.443</p>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb165-1" title="1">nct_results_top5Bcts<span class="op">$</span>einv.pvals <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb165-2" title="2"><span class="st">  </span>papaja<span class="op">::</span><span class="kw">apa_table</span>(<span class="dt">caption =</span> <span class="st">&quot;p-values on difference test in edges between Nur and IT&quot;</span>)</a></code></pre></div>
<caption>
(#tab:top5bcts-nct-results)
</caption>
<caption>
<em>p-values on difference test in edges between Nur and IT</em>
</caption>
<table>
<thead>
<tr class="header">
<th></th>
<th align="left">Var1</th>
<th align="left">Var2</th>
<th align="left">p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>8</td>
<td align="left">PA</td>
<td align="left">Autonomous</td>
<td align="left">1.00</td>
</tr>
<tr class="even">
<td>15</td>
<td align="left">PA</td>
<td align="left">new PA options</td>
<td align="left">1.00</td>
</tr>
<tr class="odd">
<td>16</td>
<td align="left">Autonomous</td>
<td align="left">new PA options</td>
<td align="left">1.00</td>
</tr>
<tr class="even">
<td>22</td>
<td align="left">PA</td>
<td align="left">implementation plan</td>
<td align="left">1.00</td>
</tr>
<tr class="odd">
<td>23</td>
<td align="left">Autonomous</td>
<td align="left">implementation plan</td>
<td align="left">1.00</td>
</tr>
<tr class="even">
<td>24</td>
<td align="left">new PA options</td>
<td align="left">implementation plan</td>
<td align="left">1.00</td>
</tr>
<tr class="odd">
<td>29</td>
<td align="left">PA</td>
<td align="left">plan by other</td>
<td align="left">1.00</td>
</tr>
<tr class="even">
<td>30</td>
<td align="left">Autonomous</td>
<td align="left">plan by other</td>
<td align="left">1.00</td>
</tr>
<tr class="odd">
<td>31</td>
<td align="left">new PA options</td>
<td align="left">plan by other</td>
<td align="left">1.00</td>
</tr>
<tr class="even">
<td>32</td>
<td align="left">implementation plan</td>
<td align="left">plan by other</td>
<td align="left">1.00</td>
</tr>
<tr class="odd">
<td>36</td>
<td align="left">PA</td>
<td align="left">goal setting</td>
<td align="left">1.00</td>
</tr>
<tr class="even">
<td>37</td>
<td align="left">Autonomous</td>
<td align="left">goal setting</td>
<td align="left">1.00</td>
</tr>
<tr class="odd">
<td>38</td>
<td align="left">new PA options</td>
<td align="left">goal setting</td>
<td align="left">1.00</td>
</tr>
<tr class="even">
<td>39</td>
<td align="left">implementation plan</td>
<td align="left">goal setting</td>
<td align="left">1.00</td>
</tr>
<tr class="odd">
<td>40</td>
<td align="left">plan by other</td>
<td align="left">goal setting</td>
<td align="left">1.00</td>
</tr>
<tr class="even">
<td>43</td>
<td align="left">PA</td>
<td align="left">subgoals</td>
<td align="left">1.00</td>
</tr>
<tr class="odd">
<td>44</td>
<td align="left">Autonomous</td>
<td align="left">subgoals</td>
<td align="left">1.00</td>
</tr>
<tr class="even">
<td>45</td>
<td align="left">new PA options</td>
<td align="left">subgoals</td>
<td align="left">1.00</td>
</tr>
<tr class="odd">
<td>46</td>
<td align="left">implementation plan</td>
<td align="left">subgoals</td>
<td align="left">1.00</td>
</tr>
<tr class="even">
<td>47</td>
<td align="left">plan by other</td>
<td align="left">subgoals</td>
<td align="left">1.00</td>
</tr>
<tr class="odd">
<td>48</td>
<td align="left">goal setting</td>
<td align="left">subgoals</td>
<td align="left">1.00</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb166-1" title="1"></a>
<a class="sourceLine" id="cb166-2" title="2"><span class="kw">cat</span>(<span class="st">&quot;Number of edges, which appear different (p&lt;0.05):&quot;</span>, <span class="kw">sum</span>(nct_results_top5Bcts<span class="op">$</span>einv.pvals<span class="op">$</span><span class="st">&quot;p-value&quot;</span> <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.05</span>))</a></code></pre></div>
<p>Number of edges, which appear different (p&lt;0.05): 0</p>
</div>
</div>
</div>
<div id="bct-sdt-regression-analyses" class="section level1">
<h1>BCT-SDT Regression analyses</h1>
<p>Here’s the classical linear model.</p>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb167-1" title="1"></a>
<a class="sourceLine" id="cb167-2" title="2">bctdf &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(id,</a>
<a class="sourceLine" id="cb167-3" title="3">  intervention,</a>
<a class="sourceLine" id="cb167-4" title="4">  group,</a>
<a class="sourceLine" id="cb167-5" title="5">  school,</a>
<a class="sourceLine" id="cb167-6" title="6">  girl,</a>
<a class="sourceLine" id="cb167-7" title="7">  <span class="st">&#39;Autonomous&#39;</span> =<span class="st"> </span>PA_autonomous_T1,</a>
<a class="sourceLine" id="cb167-8" title="8">  <span class="st">&#39;Controlled&#39;</span> =<span class="st"> </span>PA_controlled_T1,</a>
<a class="sourceLine" id="cb167-9" title="9">  <span class="st">&#39;Intrinsic&#39;</span> =<span class="st"> </span>PA_intrinsic_T1,</a>
<a class="sourceLine" id="cb167-10" title="10">  <span class="st">&#39;Identified&#39;</span> =<span class="st"> </span>PA_identified_T1,</a>
<a class="sourceLine" id="cb167-11" title="11">  <span class="st">&#39;Integrated&#39;</span> =<span class="st"> </span>PA_integrated_T1,</a>
<a class="sourceLine" id="cb167-12" title="12">  <span class="st">&#39;Introjected&#39;</span> =<span class="st"> </span>PA_introjected_T1,</a>
<a class="sourceLine" id="cb167-13" title="13">  <span class="st">&#39;Extrinsic&#39;</span> =<span class="st"> </span>PA_extrinsic_T1,</a>
<a class="sourceLine" id="cb167-14" title="14">  <span class="st">&#39;goal setting&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">01</span>_T1,</a>
<a class="sourceLine" id="cb167-15" title="15">  <span class="st">&#39;own plan&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">02</span>_T1,</a>
<a class="sourceLine" id="cb167-16" title="16">  <span class="st">&#39;plan by other&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">03</span>_T1,</a>
<a class="sourceLine" id="cb167-17" title="17">  <span class="st">&#39;reminder of plan&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">04</span>_T1,</a>
<a class="sourceLine" id="cb167-18" title="18">  <span class="st">&#39;subgoals&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">05</span>_T1,</a>
<a class="sourceLine" id="cb167-19" title="19">  <span class="st">&#39;trying new PA&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">06</span>_T1,</a>
<a class="sourceLine" id="cb167-20" title="20">  <span class="st">&#39;barrier identification&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">07</span>_T1,</a>
<a class="sourceLine" id="cb167-21" title="21">  <span class="st">&#39;problem solving&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">08</span>_T1,</a>
<a class="sourceLine" id="cb167-22" title="22">  <span class="st">&#39;PA identity reflection&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">09</span>_T1,</a>
<a class="sourceLine" id="cb167-23" title="23">  <span class="st">&#39;aligning PA with life values&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_<span class="dv">10</span>_T1,</a>
<a class="sourceLine" id="cb167-24" title="24">  <span class="st">&#39;remind of PA benefits&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">01</span>_T1,</a>
<a class="sourceLine" id="cb167-25" title="25">  <span class="st">&#39;self-monitor (paper)&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">02</span>_T1,</a>
<a class="sourceLine" id="cb167-26" title="26">  <span class="st">&#39;self-monitor (app)&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">03</span>_T1,</a>
<a class="sourceLine" id="cb167-27" title="27"><span class="co">#  &#39;memory cues&#39; = PA_frequencyDependentBCT_04_T1,</span></a>
<a class="sourceLine" id="cb167-28" title="28">  <span class="st">&#39;goal review&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">05</span>_T1,</a>
<a class="sourceLine" id="cb167-29" title="29">  <span class="st">&#39;personal relevance reflection&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">06</span>_T1,</a>
<a class="sourceLine" id="cb167-30" title="30">  <span class="st">&#39;environmental changes (home)&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">07</span>_T1,</a>
<a class="sourceLine" id="cb167-31" title="31">  <span class="st">&#39;social support&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">08</span>_T1,</a>
<a class="sourceLine" id="cb167-32" title="32">  <span class="st">&#39;failure contemplated&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_<span class="dv">09</span>_T1) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb167-33" title="33"><span class="st">  </span><span class="kw">rowwise</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb167-34" title="34"><span class="st">  </span><span class="kw">mutate</span>( </a>
<a class="sourceLine" id="cb167-35" title="35">  <span class="co">#&#39;has plan&#39; = mean(c(`own plan`, `plan by other`), na.rm = TRUE),</span></a>
<a class="sourceLine" id="cb167-36" title="36">  <span class="st">&#39;self-monitor&#39;</span> =<span class="st"> </span><span class="kw">mean</span>(<span class="kw">c</span>(<span class="st">`</span><span class="dt">self-monitor (paper)</span><span class="st">`</span>, <span class="st">`</span><span class="dt">self-monitor (app)</span><span class="st">`</span>), <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb167-37" title="37"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span><span class="st">`</span><span class="dt">self-monitor (paper)</span><span class="st">`</span>, <span class="op">-</span><span class="st">`</span><span class="dt">self-monitor (app)</span><span class="st">`</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb167-38" title="38"><span class="st">  </span>data.frame <span class="co"># %&gt;% </span></a>
<a class="sourceLine" id="cb167-39" title="39">  <span class="co"># mutate_all(as.numeric)</span></a>
<a class="sourceLine" id="cb167-40" title="40"></a>
<a class="sourceLine" id="cb167-41" title="41">outcomevars &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;Autonomous&#39;</span>, </a>
<a class="sourceLine" id="cb167-42" title="42">  <span class="st">&#39;Controlled&#39;</span>, </a>
<a class="sourceLine" id="cb167-43" title="43">  <span class="st">&#39;Intrinsic&#39;</span>,</a>
<a class="sourceLine" id="cb167-44" title="44">  <span class="st">&#39;Identified&#39;</span>, </a>
<a class="sourceLine" id="cb167-45" title="45">  <span class="st">&#39;Integrated&#39;</span>, </a>
<a class="sourceLine" id="cb167-46" title="46">  <span class="st">&#39;Introjected&#39;</span>,</a>
<a class="sourceLine" id="cb167-47" title="47">  <span class="st">&#39;Extrinsic&#39;</span>)</a>
<a class="sourceLine" id="cb167-48" title="48"></a>
<a class="sourceLine" id="cb167-49" title="49"><span class="cf">for</span> (i <span class="cf">in</span> outcomevars) {</a>
<a class="sourceLine" id="cb167-50" title="50">m &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">paste0</span>(i, <span class="st">&quot; ~ </span></a>
<a class="sourceLine" id="cb167-51" title="51"><span class="st">  goal.setting +</span></a>
<a class="sourceLine" id="cb167-52" title="52"><span class="st">  implementation.plan +</span></a>
<a class="sourceLine" id="cb167-53" title="53"><span class="st">  plan.by.other +</span></a>
<a class="sourceLine" id="cb167-54" title="54"><span class="st">  reminder.of.plan +</span></a>
<a class="sourceLine" id="cb167-55" title="55"><span class="st">  subgoals +</span></a>
<a class="sourceLine" id="cb167-56" title="56"><span class="st">  new.PA.options +</span></a>
<a class="sourceLine" id="cb167-57" title="57"><span class="st">  barrier.identification +</span></a>
<a class="sourceLine" id="cb167-58" title="58"><span class="st">  coping.planning +</span></a>
<a class="sourceLine" id="cb167-59" title="59"><span class="st">  PA.identity +</span></a>
<a class="sourceLine" id="cb167-60" title="60"><span class="st">  PA.life.values +</span></a>
<a class="sourceLine" id="cb167-61" title="61"><span class="st">  positive.consequences&quot;</span>), </a>
<a class="sourceLine" id="cb167-62" title="62">  <span class="dt">data =</span> bctdf)</a>
<a class="sourceLine" id="cb167-63" title="63"></a>
<a class="sourceLine" id="cb167-64" title="64"><span class="kw">cat</span>(<span class="st">&quot;</span><span class="ch">\n\n</span><span class="st">Estimates for&quot;</span>, i, <span class="st">&quot;regulation&quot;</span>, <span class="dt">sep =</span> <span class="st">&quot; &quot;</span>)</a>
<a class="sourceLine" id="cb167-65" title="65"><span class="kw">summary</span>(m) <span class="op">%&gt;%</span><span class="st"> </span>broom<span class="op">::</span><span class="kw">tidy</span>() <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">arrange</span>(<span class="kw">desc</span>(estimate)) <span class="op">%&gt;%</span><span class="st"> </span>papaja<span class="op">::</span><span class="kw">apa_table</span>() </a>
<a class="sourceLine" id="cb167-66" title="66">}</a>
<a class="sourceLine" id="cb167-67" title="67"><span class="co">## Error in eval(predvars, data, env): object &#39;implementation.plan&#39; not found</span></a></code></pre></div>
</div>
<div id="pa-determinants-unregularised-correlations-visualised" class="section level1">
<h1>PA determinants: unregularised correlations visualised</h1>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb168-1" title="1"><span class="co"># Network without motivation variables</span></a>
<a class="sourceLine" id="cb168-2" title="2">data &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="st">&#39;PA&#39;</span> =<span class="st"> </span>mvpaAccelerometer_T1, <span class="st">&#39;SB&#39;</span> =<span class="st"> </span>sitLieAccelerometer_T1,</a>
<a class="sourceLine" id="cb168-3" title="3"><span class="st">&#39;fat%&#39;</span> =<span class="st"> </span>fatpct_T1,<span class="st">&#39;action planning&#39;</span> =<span class="st"> </span>PA_actionplan_T1, <span class="st">&#39;coping planning&#39;</span> =<span class="st"> </span>PA_copingplan_T1, <span class="st">&#39;frequency-related BCTs&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_T1, <span class="st">&#39;agreement-related BCTs&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_T1, <span class="st">&#39;amotivation&#39;</span> =<span class="st"> </span>PA_amotivation_T1, <span class="st">&#39;autonomous motivation&#39;</span> =<span class="st"> </span>PA_autonomous_T1, <span class="st">&#39;controlled motivation&#39;</span> =<span class="st"> </span>PA_controlled_T1, <span class="st">&#39;descriptive norm&#39;</span> =<span class="st"> </span>PA_descriptiveNorm_T1, <span class="st">&#39;injunctive norm&#39;</span> =<span class="st"> </span>PA_injunctiveNorm_T1, <span class="st">&#39;intention&#39;</span> =<span class="st"> </span>PA_intention_T1, <span class="st">&#39;outcome expectations&#39;</span> =<span class="st"> </span>PA_outcomeExpectations_T1, <span class="st">&#39;self-efficacy / perceivedBehaviouralControl&#39;</span> =<span class="st"> </span>PA_selfEfficacyperceivedBehaviouralControl_T1, <span class="st">&#39;perceived opportunities&#39;</span> =<span class="st"> </span>PA_opportunities_T1) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb168-4" title="4"><span class="st">  </span><span class="kw">mutate_all</span>(as.numeric)</a>
<a class="sourceLine" id="cb168-5" title="5"></a>
<a class="sourceLine" id="cb168-6" title="6">names &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="st">&#39;PA&#39;</span> =<span class="st"> </span>mvpaAccelerometer_T1, <span class="st">&#39;SB&#39;</span> =<span class="st"> </span>sitLieAccelerometer_T1,</a>
<a class="sourceLine" id="cb168-7" title="7"><span class="st">&#39;fat%&#39;</span> =<span class="st"> </span>fatpct_T1,<span class="st">&#39;action planning&#39;</span> =<span class="st"> </span>PA_actionplan_T1, <span class="st">&#39;coping planning&#39;</span> =<span class="st"> </span>PA_copingplan_T1, <span class="st">&#39;frequency-related BCTs&#39;</span> =<span class="st"> </span>PA_frequencyDependentBCT_T1, <span class="st">&#39;agreement-related BCTs&#39;</span> =<span class="st"> </span>PA_agreementDependentBCT_T1, <span class="st">&#39;amotivation&#39;</span> =<span class="st"> </span>PA_amotivation_T1, <span class="st">&#39;autonomous motivation&#39;</span> =<span class="st"> </span>PA_autonomous_T1, <span class="st">&#39;controlled motivation&#39;</span> =<span class="st"> </span>PA_controlled_T1, <span class="st">&#39;descriptive norm&#39;</span> =<span class="st"> </span>PA_descriptiveNorm_T1, <span class="st">&#39;injunctive norm&#39;</span> =<span class="st"> </span>PA_injunctiveNorm_T1, <span class="st">&#39;intention&#39;</span> =<span class="st"> </span>PA_intention_T1, <span class="st">&#39;outcome expectations&#39;</span> =<span class="st"> </span>PA_outcomeExpectations_T1, <span class="st">&#39;self-efficacy / perceivedBehaviouralControl&#39;</span> =<span class="st"> </span>PA_selfEfficacyperceivedBehaviouralControl_T1, <span class="st">&#39;perceived opportunities&#39;</span> =<span class="st"> </span>PA_opportunities_T1) <span class="op">%&gt;%</span><span class="st"> </span>names</a>
<a class="sourceLine" id="cb168-8" title="8"></a>
<a class="sourceLine" id="cb168-9" title="9"><span class="co"># Spinglass algorithm detects communities. Tutorial here: http://psych-networks.com/r-tutorial-identify-communities-items-networks/</span></a>
<a class="sourceLine" id="cb168-10" title="10"></a>
<a class="sourceLine" id="cb168-11" title="11">cormatrix &lt;-<span class="st"> </span><span class="kw">cor_auto</span>(data) </a>
<a class="sourceLine" id="cb168-12" title="12"><span class="co">## Error in cor_auto(data): could not find function &quot;cor_auto&quot;</span></a>
<a class="sourceLine" id="cb168-13" title="13"></a>
<a class="sourceLine" id="cb168-14" title="14">piefill &lt;-<span class="st"> </span>data <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb168-15" title="15"><span class="st">  </span><span class="kw">summarise_all</span>(<span class="kw">funs</span>(<span class="kw">mean</span>(., <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb168-16" title="16"><span class="st">  </span><span class="kw">mutate_at</span>(<span class="kw">vars</span>(PA, SB),</a>
<a class="sourceLine" id="cb168-17" title="17">            <span class="kw">funs</span>(. <span class="op">/</span><span class="st"> </span>(<span class="dv">24</span><span class="op">*</span><span class="dv">60</span>))) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># proportion of day used doing the behaviour</span></a>
<a class="sourceLine" id="cb168-18" title="18"><span class="st">  </span><span class="kw">mutate_at</span>(<span class="kw">vars</span>(<span class="st">`</span><span class="dt">action planning</span><span class="st">`</span>, <span class="st">`</span><span class="dt">problem solving</span><span class="st">`</span>),</a>
<a class="sourceLine" id="cb168-19" title="19">            <span class="kw">funs</span>(. <span class="op">/</span><span class="st"> </span><span class="dv">4</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb168-20" title="20"><span class="st">  </span><span class="kw">mutate_at</span>(<span class="kw">vars</span>(<span class="dv">6</span><span class="op">:</span><span class="kw">ncol</span>(data)),</a>
<a class="sourceLine" id="cb168-21" title="21">            <span class="kw">funs</span>(. <span class="op">/</span><span class="st"> </span><span class="dv">7</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb168-22" title="22"><span class="st">  </span><span class="kw">mutate_at</span>(<span class="kw">vars</span>(<span class="st">`</span><span class="dt">fat%</span><span class="st">`</span>),</a>
<a class="sourceLine" id="cb168-23" title="23">            <span class="kw">funs</span>(. <span class="op">/</span><span class="st"> </span><span class="dv">100</span>))  </a>
<a class="sourceLine" id="cb168-24" title="24"><span class="co">## Error in .f(.x[[i]], ...): object &#39;problem solving&#39; not found</span></a>
<a class="sourceLine" id="cb168-25" title="25"></a>
<a class="sourceLine" id="cb168-26" title="26">nodeColors &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">rep</span>(viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">7</span>, <span class="dt">begin =</span> <span class="fl">0.3</span>, <span class="dt">end =</span> <span class="dv">1</span>)[<span class="dv">1</span>], <span class="dv">2</span>), <span class="co"># PA, SB</span></a>
<a class="sourceLine" id="cb168-27" title="27">                <span class="kw">rep</span>(viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">7</span>, <span class="dt">begin =</span> <span class="fl">0.3</span>, <span class="dt">end =</span> <span class="dv">1</span>)[<span class="dv">2</span>], <span class="dv">1</span>), <span class="co"># fat</span></a>
<a class="sourceLine" id="cb168-28" title="28">                <span class="kw">rep</span>(viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">7</span>, <span class="dt">begin =</span> <span class="fl">0.3</span>, <span class="dt">end =</span> <span class="dv">1</span>)[<span class="dv">3</span>], <span class="dv">2</span>), <span class="co"># Action, coping planning</span></a>
<a class="sourceLine" id="cb168-29" title="29">                <span class="kw">rep</span>(viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">7</span>, <span class="dt">begin =</span> <span class="fl">0.3</span>, <span class="dt">end =</span> <span class="dv">1</span>)[<span class="dv">4</span>], <span class="dv">2</span>), <span class="co"># 2x bcts</span></a>
<a class="sourceLine" id="cb168-30" title="30">                <span class="kw">rep</span>(viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">7</span>, <span class="dt">begin =</span> <span class="fl">0.3</span>, <span class="dt">end =</span> <span class="dv">1</span>)[<span class="dv">5</span>], <span class="dv">3</span>), <span class="co"># Motivations</span></a>
<a class="sourceLine" id="cb168-31" title="31">                <span class="kw">rep</span>(viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">7</span>, <span class="dt">begin =</span> <span class="fl">0.3</span>, <span class="dt">end =</span> <span class="dv">1</span>)[<span class="dv">6</span>], <span class="dv">2</span>), <span class="co"># norms</span></a>
<a class="sourceLine" id="cb168-32" title="32">                <span class="kw">rep</span>(viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">7</span>, <span class="dt">begin =</span> <span class="fl">0.3</span>, <span class="dt">end =</span> <span class="dv">1</span>)[<span class="dv">7</span>], <span class="dv">1</span>), <span class="co"># intention</span></a>
<a class="sourceLine" id="cb168-33" title="33">                <span class="kw">rep</span>(viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">7</span>, <span class="dt">begin =</span> <span class="fl">0.3</span>, <span class="dt">end =</span> <span class="dv">1</span>)[<span class="dv">6</span>], <span class="dv">3</span>)) <span class="co"># OE, SE/perceivedBehaviouralControl, Opportunities</span></a>
<a class="sourceLine" id="cb168-34" title="34"></a>
<a class="sourceLine" id="cb168-35" title="35"></a>
<a class="sourceLine" id="cb168-36" title="36"><span class="kw">qgraph</span>(<span class="kw">cor_auto</span>(data), <span class="dt">layout =</span> <span class="st">&quot;spring&quot;</span>, <span class="dt">labels =</span> <span class="ot">TRUE</span>, </a>
<a class="sourceLine" id="cb168-37" title="37">       <span class="co"># groups = group.spinglass, </span></a>
<a class="sourceLine" id="cb168-38" title="38">     <span class="dt">color=</span>nodeColors,</a>
<a class="sourceLine" id="cb168-39" title="39">     <span class="dt">label.cex =</span> <span class="fl">0.75</span>,</a>
<a class="sourceLine" id="cb168-40" title="40">     <span class="dt">label.scale =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb168-41" title="41">     <span class="dt">pie =</span> piefill, </a>
<a class="sourceLine" id="cb168-42" title="42">     <span class="dt">color =</span> <span class="st">&quot;skyblue&quot;</span>,</a>
<a class="sourceLine" id="cb168-43" title="43">     <span class="dt">nodeNames =</span> names,</a>
<a class="sourceLine" id="cb168-44" title="44">     <span class="dt">pieBorder =</span> <span class="dv">1</span>,</a>
<a class="sourceLine" id="cb168-45" title="45">     <span class="dt">legend.cex =</span> <span class="fl">0.4</span>,</a>
<a class="sourceLine" id="cb168-46" title="46">     <span class="dt">theme =</span> <span class="st">&quot;colorblind&quot;</span>,</a>
<a class="sourceLine" id="cb168-47" title="47">     <span class="dt">edge.labels =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb168-48" title="48">     <span class="dt">edge.label.cex =</span> <span class="fl">0.75</span>,</a>
<a class="sourceLine" id="cb168-49" title="49">     <span class="dt">minimum =</span> <span class="fl">0.1</span>,</a>
<a class="sourceLine" id="cb168-50" title="50">     <span class="dt">title =</span> <span class="st">&quot;Bivariate correlations of PA determinants (&lt;0.1 not shown)&quot;</span>)</a>
<a class="sourceLine" id="cb168-51" title="51"><span class="co">## Error in qgraph(cor_auto(data), layout = &quot;spring&quot;, labels = TRUE, color = nodeColors, : could not find function &quot;qgraph&quot;</span></a></code></pre></div>
<!-- Out of a hundred iterations, spinglass algorithm found `  table(matrix_spinglass)[[1]]` instances of ` table(matrix_spinglass)[1] %>% names` communities, `  table(matrix_spinglass)[[2]]` instances of `  table(matrix_spinglass)[2] %>% names` communities, and `  table(matrix_spinglass)[[3]]` instances of `  table(matrix_spinglass)[3] %>% names` communities. Thus, a random seed which found four communities was chosen.   -->
<div id="symptom-network-all" class="section level2">
<h2>Symptom network: all</h2>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb169-1" title="1"></a>
<a class="sourceLine" id="cb169-2" title="2">sympdf &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(id,</a>
<a class="sourceLine" id="cb169-3" title="3">  intervention,</a>
<a class="sourceLine" id="cb169-4" title="4">  group,</a>
<a class="sourceLine" id="cb169-5" title="5">  school,</a>
<a class="sourceLine" id="cb169-6" title="6">  girl,</a>
<a class="sourceLine" id="cb169-7" title="7">  <span class="st">&quot;Neck and shoulder pain&quot;</span> =<span class="st"> </span>symptom_neckShoulderPain_T1,</a>
<a class="sourceLine" id="cb169-8" title="8">  <span class="st">&quot;Lower back pain&quot;</span> =<span class="st"> </span>symptom_lowerBackPain_T1,</a>
<a class="sourceLine" id="cb169-9" title="9">  <span class="st">&quot;Stomach ache&quot;</span> =<span class="st"> </span>symptom_stomachAche_T1,</a>
<a class="sourceLine" id="cb169-10" title="10">  <span class="st">&quot;Tension or nervousness&quot;</span> =<span class="st"> </span>symptom_tensionNervousness_T1,</a>
<a class="sourceLine" id="cb169-11" title="11">  <span class="st">&quot;Irritability or anger bursts&quot;</span> =<span class="st"> </span>symptom_irritabilityAngerbursts_T1,</a>
<a class="sourceLine" id="cb169-12" title="12">  <span class="st">&quot;Difficulty with sleep&quot;</span> =<span class="st"> </span>symptom_sleepDifficulty_T1,</a>
<a class="sourceLine" id="cb169-13" title="13">  <span class="st">&quot;Headache&quot;</span> =<span class="st"> </span>symptom_headAche_T1,</a>
<a class="sourceLine" id="cb169-14" title="14">  <span class="st">&quot;Tiredness or faintness&quot;</span> =<span class="st"> </span>symptom_tirednessFaintness_T1,</a>
<a class="sourceLine" id="cb169-15" title="15">  <span class="st">&quot;Fat pct&quot;</span> =<span class="st"> </span>fatpct_T1,</a>
<a class="sourceLine" id="cb169-16" title="16">  <span class="st">&quot;PA&quot;</span> =<span class="st"> </span>mvpaAccelerometer_T1,</a>
<a class="sourceLine" id="cb169-17" title="17">  <span class="st">&quot;SB&quot;</span> =<span class="st"> </span>sitLieAccelerometer_T1</a>
<a class="sourceLine" id="cb169-18" title="18">) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb169-19" title="19"><span class="st">  </span><span class="kw">mutate</span>(</a>
<a class="sourceLine" id="cb169-20" title="20">    <span class="st">&#39;Neck and shoulder pain&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">Neck and shoulder pain</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb169-21" title="21">    <span class="st">&#39;Lower back pain&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">Lower back pain</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb169-22" title="22">    <span class="st">&#39;Stomach ache&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">Stomach ache</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb169-23" title="23">    <span class="st">&#39;Tension or nervousness&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">Tension or nervousness</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb169-24" title="24">    <span class="st">&#39;Irritability or anger bursts&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">Irritability or anger bursts</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb169-25" title="25">    <span class="st">&#39;Difficulty with sleep&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">Difficulty with sleep</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb169-26" title="26">    <span class="st">&#39;Headache&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">Headache</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb169-27" title="27">    <span class="st">&#39;Tiredness or faintness&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">Tiredness or faintness</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb169-28" title="28">    <span class="st">&#39;Fat pct&#39;</span> =<span class="st"> `</span><span class="dt">Fat pct</span><span class="st">`</span> <span class="op">/</span><span class="st"> </span><span class="dv">100</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb169-29" title="29"><span class="st">  </span>data.frame</a>
<a class="sourceLine" id="cb169-30" title="30"></a>
<a class="sourceLine" id="cb169-31" title="31">S.all &lt;-<span class="st"> </span>sympdf <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="dv">6</span><span class="op">:</span><span class="kw">ncol</span>(sympdf)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">na.omit</span>(.) </a>
<a class="sourceLine" id="cb169-32" title="32"></a>
<a class="sourceLine" id="cb169-33" title="33">nwAll &lt;-<span class="st"> </span>bootnet<span class="op">::</span><span class="kw">estimateNetwork</span>(S.all, <span class="dt">default=</span><span class="st">&quot;mgm&quot;</span>)</a>
<a class="sourceLine" id="cb169-34" title="34"></a>
<a class="sourceLine" id="cb169-35" title="35">allmeans &lt;-<span class="st"> </span>sympdf <span class="op">%&gt;%</span><span class="st">  </span></a>
<a class="sourceLine" id="cb169-36" title="36"><span class="st">  </span><span class="kw">summarise_at</span>(<span class="kw">vars</span>(<span class="dv">6</span><span class="op">:</span><span class="dv">16</span>),</a>
<a class="sourceLine" id="cb169-37" title="37">  <span class="kw">funs</span>(<span class="kw">mean</span>(., <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))) <span class="op">%&gt;%</span><span class="st">  </span></a>
<a class="sourceLine" id="cb169-38" title="38"><span class="st">  </span><span class="kw">mutate_at</span>(<span class="kw">vars</span>(PA, SB),</a>
<a class="sourceLine" id="cb169-39" title="39">            <span class="kw">funs</span>(. <span class="op">/</span><span class="st"> </span>(<span class="dv">24</span><span class="op">*</span><span class="dv">60</span>)))  <span class="co"># proportion of day used doing the behaviour</span></a>
<a class="sourceLine" id="cb169-40" title="40"></a>
<a class="sourceLine" id="cb169-41" title="41"></a>
<a class="sourceLine" id="cb169-42" title="42"><span class="kw">plot</span>(nwAll, <span class="dt">label.scale =</span> <span class="ot">FALSE</span>, <span class="dt">title =</span> <span class="st">&quot;All&quot;</span>, <span class="dt">label.cex =</span> <span class="fl">0.75</span>, </a>
<a class="sourceLine" id="cb169-43" title="43">     <span class="dt">pie =</span> allmeans, </a>
<a class="sourceLine" id="cb169-44" title="44">     <span class="dt">color =</span> <span class="st">&quot;skyblue&quot;</span>,</a>
<a class="sourceLine" id="cb169-45" title="45">     <span class="dt">pieBorder =</span> <span class="dv">1</span>)</a></code></pre></div>
<p><img src="baseline-networks_files/figure-html/symptoms-all-1.png" width="2100" /></p>
</div>
<div id="symptom-network-boys-and-girls" class="section level2">
<h2>Symptom network: boys and girls</h2>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb170-1" title="1"></a>
<a class="sourceLine" id="cb170-2" title="2">sympdf &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(id,</a>
<a class="sourceLine" id="cb170-3" title="3">  intervention,</a>
<a class="sourceLine" id="cb170-4" title="4">  group,</a>
<a class="sourceLine" id="cb170-5" title="5">  school,</a>
<a class="sourceLine" id="cb170-6" title="6">  girl,</a>
<a class="sourceLine" id="cb170-7" title="7">  <span class="st">&quot;Neck and shoulder pain&quot;</span> =<span class="st"> </span>symptom_neckShoulderPain_T1,</a>
<a class="sourceLine" id="cb170-8" title="8">  <span class="st">&quot;Lower back pain&quot;</span> =<span class="st"> </span>symptom_lowerBackPain_T1,</a>
<a class="sourceLine" id="cb170-9" title="9">  <span class="st">&quot;Stomach ache&quot;</span> =<span class="st"> </span>symptom_stomachAche_T1,</a>
<a class="sourceLine" id="cb170-10" title="10">  <span class="st">&quot;Tension or nervousness&quot;</span> =<span class="st"> </span>symptom_tensionNervousness_T1,</a>
<a class="sourceLine" id="cb170-11" title="11">  <span class="st">&quot;Irritability or anger bursts&quot;</span> =<span class="st"> </span>symptom_irritabilityAngerbursts_T1,</a>
<a class="sourceLine" id="cb170-12" title="12">  <span class="st">&quot;Difficulty with sleep&quot;</span> =<span class="st"> </span>symptom_sleepDifficulty_T1,</a>
<a class="sourceLine" id="cb170-13" title="13">  <span class="st">&quot;Headache&quot;</span> =<span class="st"> </span>symptom_headAche_T1,</a>
<a class="sourceLine" id="cb170-14" title="14">  <span class="st">&quot;Tiredness or faintness&quot;</span> =<span class="st"> </span>symptom_tirednessFaintness_T1,</a>
<a class="sourceLine" id="cb170-15" title="15">  <span class="st">&quot;Fat pct&quot;</span> =<span class="st"> </span>fatpct_T1,</a>
<a class="sourceLine" id="cb170-16" title="16">  <span class="st">&quot;PA&quot;</span> =<span class="st"> </span>mvpaAccelerometer_T1,</a>
<a class="sourceLine" id="cb170-17" title="17">  <span class="st">&quot;SB&quot;</span> =<span class="st"> </span>sitLieAccelerometer_T1</a>
<a class="sourceLine" id="cb170-18" title="18">) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb170-19" title="19"><span class="st">  </span><span class="kw">mutate</span>(</a>
<a class="sourceLine" id="cb170-20" title="20">    <span class="st">&#39;Neck and shoulder pain&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">Neck and shoulder pain</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb170-21" title="21">    <span class="st">&#39;Lower back pain&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">Lower back pain</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb170-22" title="22">    <span class="st">&#39;Stomach ache&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">Stomach ache</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb170-23" title="23">    <span class="st">&#39;Tension or nervousness&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">Tension or nervousness</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb170-24" title="24">    <span class="st">&#39;Irritability or anger bursts&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">Irritability or anger bursts</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb170-25" title="25">    <span class="st">&#39;Difficulty with sleep&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">Difficulty with sleep</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb170-26" title="26">    <span class="st">&#39;Headache&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">Headache</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb170-27" title="27">    <span class="st">&#39;Tiredness or faintness&#39;</span> =<span class="st"> </span><span class="kw">ifelse</span>(<span class="st">`</span><span class="dt">Tiredness or faintness</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb170-28" title="28">    <span class="st">&#39;Fat pct&#39;</span> =<span class="st"> `</span><span class="dt">Fat pct</span><span class="st">`</span> <span class="op">/</span><span class="st"> </span><span class="dv">100</span>)</a>
<a class="sourceLine" id="cb170-29" title="29"></a>
<a class="sourceLine" id="cb170-30" title="30">S.boys &lt;-<span class="st"> </span>sympdf <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(girl <span class="op">==</span><span class="st"> &quot;boy&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="st">&quot;Neck and shoulder pain&quot;</span><span class="op">:</span><span class="kw">ncol</span>(sympdf)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">na.omit</span>(.) </a>
<a class="sourceLine" id="cb170-31" title="31">S.girls &lt;-<span class="st"> </span>sympdf <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(girl <span class="op">==</span><span class="st"> &quot;girl&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="st">&quot;Neck and shoulder pain&quot;</span><span class="op">:</span><span class="kw">ncol</span>(sympdf)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">na.omit</span>(.)</a>
<a class="sourceLine" id="cb170-32" title="32">nwBoys &lt;-<span class="st"> </span>bootnet<span class="op">::</span><span class="kw">estimateNetwork</span>(S.boys, <span class="dt">default=</span><span class="st">&quot;mgm&quot;</span>)</a>
<a class="sourceLine" id="cb170-33" title="33">nwGirls &lt;-<span class="st"> </span>bootnet<span class="op">::</span><span class="kw">estimateNetwork</span>(S.girls, <span class="dt">default=</span><span class="st">&quot;mgm&quot;</span>)</a>
<a class="sourceLine" id="cb170-34" title="34"></a>
<a class="sourceLine" id="cb170-35" title="35">girlmeans &lt;-<span class="st"> </span>sympdf <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(girl) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb170-36" title="36"><span class="st">  </span><span class="kw">summarise_at</span>(<span class="kw">vars</span>(<span class="st">&quot;Neck and shoulder pain&quot;</span><span class="op">:</span><span class="st">&quot;SB&quot;</span>),</a>
<a class="sourceLine" id="cb170-37" title="37">  <span class="kw">funs</span>(<span class="kw">mean</span>(., <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb170-38" title="38"><span class="st">  </span><span class="kw">filter</span>(girl <span class="op">==</span><span class="st"> &quot;girl&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb170-39" title="39"><span class="st">  </span><span class="kw">mutate_at</span>(<span class="kw">vars</span>(PA, SB),</a>
<a class="sourceLine" id="cb170-40" title="40">            <span class="kw">funs</span>(. <span class="op">/</span><span class="st"> </span>(<span class="dv">24</span><span class="op">*</span><span class="dv">60</span>))) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># proportion of day used doing the behaviour</span></a>
<a class="sourceLine" id="cb170-41" title="41"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>(girl))</a>
<a class="sourceLine" id="cb170-42" title="42"></a>
<a class="sourceLine" id="cb170-43" title="43">boymeans &lt;-<span class="st"> </span>sympdf <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(girl) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb170-44" title="44"><span class="st">  </span><span class="kw">summarise_at</span>(<span class="kw">vars</span>(<span class="st">&quot;Neck and shoulder pain&quot;</span><span class="op">:</span><span class="st">&quot;SB&quot;</span>),</a>
<a class="sourceLine" id="cb170-45" title="45">  <span class="kw">funs</span>(<span class="kw">mean</span>(., <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb170-46" title="46"><span class="st">  </span><span class="kw">filter</span>(girl <span class="op">==</span><span class="st"> &quot;boy&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb170-47" title="47"><span class="st">  </span><span class="kw">mutate_at</span>(<span class="kw">vars</span>(PA, SB),</a>
<a class="sourceLine" id="cb170-48" title="48">            <span class="kw">funs</span>(. <span class="op">/</span><span class="st"> </span>(<span class="dv">24</span><span class="op">*</span><span class="dv">60</span>))) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># proportion of day used doing the behaviour</span></a>
<a class="sourceLine" id="cb170-49" title="49"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>(girl))</a>
<a class="sourceLine" id="cb170-50" title="50"></a>
<a class="sourceLine" id="cb170-51" title="51"></a>
<a class="sourceLine" id="cb170-52" title="52"><span class="kw">layout</span>(<span class="kw">t</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb170-53" title="53"><span class="kw">plot</span>(nwGirls, <span class="dt">label.scale =</span> <span class="ot">FALSE</span>, <span class="dt">title =</span> <span class="st">&quot;Girls&quot;</span>, <span class="dt">label.cex =</span> <span class="fl">0.75</span>,</a>
<a class="sourceLine" id="cb170-54" title="54">     <span class="dt">pie =</span> girlmeans, </a>
<a class="sourceLine" id="cb170-55" title="55">     <span class="dt">color =</span> <span class="st">&quot;skyblue&quot;</span>,</a>
<a class="sourceLine" id="cb170-56" title="56">     <span class="dt">pieBorder =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb170-57" title="57"></a>
<a class="sourceLine" id="cb170-58" title="58"><span class="kw">plot</span>(nwBoys, <span class="dt">label.scale =</span> <span class="ot">FALSE</span>, <span class="dt">title =</span> <span class="st">&quot;Boys&quot;</span>, <span class="dt">label.cex =</span> <span class="fl">0.75</span>, </a>
<a class="sourceLine" id="cb170-59" title="59">     <span class="dt">pie =</span> boymeans, </a>
<a class="sourceLine" id="cb170-60" title="60">     <span class="dt">color =</span> <span class="st">&quot;skyblue&quot;</span>,</a>
<a class="sourceLine" id="cb170-61" title="61">     <span class="dt">pieBorder =</span> <span class="dv">1</span>)</a></code></pre></div>
<p><img src="baseline-networks_files/figure-html/symptoms-boygirl-1.png" width="2100" /></p>
</div>
<div id="symptom-network-educational-tracks" class="section level2">
<h2>symptom network: educational tracks</h2>
</div>
</div>
<div id="pa-determinant-network" class="section level1">
<h1>PA determinant network</h1>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb171-1" title="1"></a>
<a class="sourceLine" id="cb171-2" title="2">data &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb171-3" title="3"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(</a>
<a class="sourceLine" id="cb171-4" title="4">    <span class="st">&quot;MVPA accelerometer&quot;</span> =<span class="st"> </span>mvpaAccelerometer_T1, </a>
<a class="sourceLine" id="cb171-5" title="5">    <span class="st">&quot;planning&quot;</span> =<span class="st"> </span>PA_actCop_T1, </a>
<a class="sourceLine" id="cb171-6" title="6">    <span class="st">&quot;BCT&quot;</span> =<span class="st"> </span>PA_frequencyDependentBCT_T1, </a>
<a class="sourceLine" id="cb171-7" title="7">    <span class="st">&quot;amotivation&quot;</span> =<span class="st"> </span>PA_amotivation_T1, </a>
<a class="sourceLine" id="cb171-8" title="8">    <span class="st">&quot;autonomous&quot;</span> =<span class="st"> </span>PA_autonomous_T1, </a>
<a class="sourceLine" id="cb171-9" title="9">    <span class="st">&quot;controlled&quot;</span> =<span class="st"> </span>PA_controlled_T1, </a>
<a class="sourceLine" id="cb171-10" title="10">    <span class="st">&quot;descriptive norm&quot;</span> =<span class="st"> </span>PA_descriptiveNorm_T1, </a>
<a class="sourceLine" id="cb171-11" title="11">    <span class="st">&quot;fat pct&quot;</span> =<span class="st"> </span>fatpct_T1, </a>
<a class="sourceLine" id="cb171-12" title="12">    <span class="st">&quot;injunctive norm&quot;</span> =<span class="st"> </span>PA_injunctiveNorm_T1, </a>
<a class="sourceLine" id="cb171-13" title="13">    <span class="st">&quot;intention&quot;</span> =<span class="st"> </span>PA_intention_T1, </a>
<a class="sourceLine" id="cb171-14" title="14">    <span class="st">&quot;outcome expectations&quot;</span> =<span class="st"> </span>PA_outcomeExpectations_T1, </a>
<a class="sourceLine" id="cb171-15" title="15">    <span class="st">&quot;opportunities&quot;</span> =<span class="st"> </span>PA_opportunities_T1, </a>
<a class="sourceLine" id="cb171-16" title="16">    <span class="st">&quot;self-efficacy perceivedBehaviouralControl&quot;</span> =<span class="st"> </span>PA_selfEfficacyperceivedBehaviouralControl_T1) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb171-17" title="17"><span class="st">  </span><span class="kw">mutate_all</span>(<span class="kw">funs</span>(<span class="kw">as.numeric</span>(.))) </a>
<a class="sourceLine" id="cb171-18" title="18"></a>
<a class="sourceLine" id="cb171-19" title="19">covMatrix &lt;-<span class="st"> </span>data <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">cov</span>(<span class="dt">use =</span> <span class="st">&quot;pairwise.complete.obs&quot;</span>)</a>
<a class="sourceLine" id="cb171-20" title="20"></a>
<a class="sourceLine" id="cb171-21" title="21"><span class="co"># Transform the matrix so, that lower diagonal of the matrix shows partial correlations,</span></a>
<a class="sourceLine" id="cb171-22" title="22"><span class="co"># while the upper one shows bivariate correlations.</span></a>
<a class="sourceLine" id="cb171-23" title="23">matrix_corLower_parcorUpper &lt;-<span class="st"> </span>covMatrix <span class="op">%&gt;%</span><span class="st"> </span>ggm<span class="op">::</span><span class="kw">correlations</span>()</a>
<a class="sourceLine" id="cb171-24" title="24"></a>
<a class="sourceLine" id="cb171-25" title="25"><span class="co"># Show the matrix</span></a>
<a class="sourceLine" id="cb171-26" title="26">matrix_corLower_parcorUpper <span class="op">%&gt;%</span><span class="st"> </span>papaja<span class="op">::</span><span class="kw">apa_table</span>(<span class="dt">caption =</span> <span class="st">&quot;Correlation matrix of hypothesised determinants. Lower diagonal shows bivariate correlations, upper diagonal shows partial correlations&quot;</span>)</a>
<a class="sourceLine" id="cb171-27" title="27"><span class="co">## &lt;caption&gt;(\#tab:determinants)&lt;/caption&gt;</span></a>
<a class="sourceLine" id="cb171-28" title="28"><span class="co">## </span></a>
<a class="sourceLine" id="cb171-29" title="29"><span class="co">## &lt;caption&gt;*Correlation matrix of hypothesised determinants. Lower diagonal shows bivariate correlations, upper diagonal shows partial correlations*&lt;/caption&gt;</span></a>
<a class="sourceLine" id="cb171-30" title="30"><span class="co">## </span></a>
<a class="sourceLine" id="cb171-31" title="31"><span class="co">## </span></a>
<a class="sourceLine" id="cb171-32" title="32"><span class="co">## </span></a>
<a class="sourceLine" id="cb171-33" title="33"><span class="co">##                                             MVPA accelerometer   planning   BCT     amotivation   autonomous   controlled   descriptive norm   fat pct   injunctive norm   intention   outcome expectations   opportunities   self-efficacy perceivedBehaviouralControl </span></a>
<a class="sourceLine" id="cb171-34" title="34"><span class="co">## ------------------------------------------  -------------------  ---------  ------  ------------  -----------  -----------  -----------------  --------  ----------------  ----------  ---------------------  --------------  ------------------------------------------</span></a>
<a class="sourceLine" id="cb171-35" title="35"><span class="co">## MVPA accelerometer                          1.00                 0.01       0.07    -0.09         0.13         -0.02        -0.03              -0.08     0.00              0.01        -0.10                  -0.05           0.06                                      </span></a>
<a class="sourceLine" id="cb171-36" title="36"><span class="co">## planning                                    0.17                 1.00       0.23    0.04          0.27         0.00         0.01               -0.03     0.04              0.25        -0.03                  0.11            0.05                                      </span></a>
<a class="sourceLine" id="cb171-37" title="37"><span class="co">## BCT                                         0.16                 0.47       1.00    0.10          0.26         0.13         0.02               0.06      -0.01             0.06        0.01                   -0.01           -0.11                                     </span></a>
<a class="sourceLine" id="cb171-38" title="38"><span class="co">## amotivation                                 -0.15                -0.25      -0.08   1.00          -0.15        0.29         0.03               -0.07     -0.02             -0.24       -0.14                  -0.12           0.05                                      </span></a>
<a class="sourceLine" id="cb171-39" title="39"><span class="co">## autonomous                                  0.24                 0.62       0.51    -0.37         1.00         0.16         0.08               -0.18     -0.05             0.24        0.32                   0.04            0.08                                      </span></a>
<a class="sourceLine" id="cb171-40" title="40"><span class="co">## controlled                                  -0.02                0.09       0.23    0.26          0.13         1.00         -0.02              0.14      0.16              0.00        0.02                   -0.08           -0.13                                     </span></a>
<a class="sourceLine" id="cb171-41" title="41"><span class="co">## descriptive norm                            0.06                 0.33       0.21    -0.18         0.37         0.04         1.00               -0.05     0.38              0.15        0.00                   0.14            0.05                                      </span></a>
<a class="sourceLine" id="cb171-42" title="42"><span class="co">## fat pct                                     -0.13                -0.12      -0.02   0.03          -0.17        0.12         -0.09              1.00      0.02              0.03        0.11                   0.02            -0.06                                     </span></a>
<a class="sourceLine" id="cb171-43" title="43"><span class="co">## injunctive norm                             0.03                 0.23       0.15    -0.11         0.23         0.15         0.47               0.00      1.00              0.04        0.08                   0.04            0.06                                      </span></a>
<a class="sourceLine" id="cb171-44" title="44"><span class="co">## intention                                   0.17                 0.57       0.37    -0.43         0.63         0.02         0.40               -0.08     0.26              1.00        0.04                   -0.03           0.11                                      </span></a>
<a class="sourceLine" id="cb171-45" title="45"><span class="co">## outcome expectations                        0.05                 0.35       0.26    -0.35         0.54         0.04         0.28               0.01      0.24              0.42        1.00                   0.12            0.06                                      </span></a>
<a class="sourceLine" id="cb171-46" title="46"><span class="co">## opportunities                               0.05                 0.33       0.14    -0.31         0.35         -0.11        0.33               -0.06     0.22              0.33        0.35                   1.00            0.27                                      </span></a>
<a class="sourceLine" id="cb171-47" title="47"><span class="co">## self-efficacy perceivedBehaviouralControl   0.11                 0.28       0.06    -0.22         0.32         -0.15        0.27               -0.12     0.20              0.33        0.28                   0.42            1.00</span></a>
<a class="sourceLine" id="cb171-48" title="48"></a>
<a class="sourceLine" id="cb171-49" title="49"><span class="co"># Plot the matrix as a correlogram</span></a>
<a class="sourceLine" id="cb171-50" title="50">matrix_corLower_parcorUpper <span class="op">%&gt;%</span><span class="st"> </span>corrgram<span class="op">::</span><span class="kw">corrgram</span>(</a>
<a class="sourceLine" id="cb171-51" title="51">  <span class="dt">type =</span> <span class="st">&quot;cor&quot;</span>,</a>
<a class="sourceLine" id="cb171-52" title="52">  <span class="dt">lower.panel =</span> corrgram<span class="op">::</span>panel.pie,</a>
<a class="sourceLine" id="cb171-53" title="53">  <span class="dt">upper.panel =</span> corrgram<span class="op">::</span>panel.pie,</a>
<a class="sourceLine" id="cb171-54" title="54">  <span class="dt">main =</span> <span class="st">&quot;Bivariate (upper diagonal) and partial (lower diagonal)</span><span class="ch">\n</span><span class="st">correlations of PA determinants&quot;</span>)</a></code></pre></div>
<p><img src="baseline-networks_files/figure-html/determinants-1.png" width="2100" /></p>
<div id="ggm-estimation-1" class="section level2">
<h2>ggm estimation</h2>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb172-1" title="1"></a>
<a class="sourceLine" id="cb172-2" title="2"><span class="co"># Estimate a network</span></a>
<a class="sourceLine" id="cb172-3" title="3"></a>
<a class="sourceLine" id="cb172-4" title="4">determinants_ggm_network &lt;-<span class="st"> </span>bootnet<span class="op">::</span><span class="kw">estimateNetwork</span>(data, <span class="dt">default=</span><span class="st">&quot;EBICglasso&quot;</span>)</a>
<a class="sourceLine" id="cb172-5" title="5"></a>
<a class="sourceLine" id="cb172-6" title="6">bootnetgraph &lt;-<span class="st"> </span><span class="kw">plot</span>(determinants_ggm_network, <span class="dt">edge.labels =</span> <span class="ot">TRUE</span>, <span class="dt">labels =</span> <span class="kw">names</span>(data), <span class="dt">label.scale =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb172-7" title="7">       <span class="dt">title =</span> <span class="st">&quot;partial correlation network, with LASSO regularisation and EBIC model selection&quot;</span>)</a></code></pre></div>
<p><img src="baseline-networks_files/figure-html/determinants-ggm-1.png" width="2100" /></p>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb173-1" title="1"></a>
<a class="sourceLine" id="cb173-2" title="2">corgraph &lt;-<span class="st"> </span>qgraph<span class="op">::</span><span class="kw">qgraph</span>(qgraph<span class="op">::</span><span class="kw">cor_auto</span>(data), <span class="dt">graph =</span> <span class="st">&quot;cor&quot;</span>,</a>
<a class="sourceLine" id="cb173-3" title="3">       <span class="dt">labels =</span> <span class="kw">names</span>(data),</a>
<a class="sourceLine" id="cb173-4" title="4">       <span class="dt">label.scale =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb173-5" title="5">       <span class="dt">edge.labels =</span> <span class="ot">TRUE</span>, </a>
<a class="sourceLine" id="cb173-6" title="6">       <span class="dt">title =</span> <span class="st">&quot;bivariate correlation network&quot;</span>)</a></code></pre></div>
<p><img src="baseline-networks_files/figure-html/determinants-ggm-2.png" width="2100" /></p>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb174-1" title="1"></a>
<a class="sourceLine" id="cb174-2" title="2">pcorgraph &lt;-<span class="st"> </span>qgraph<span class="op">::</span><span class="kw">qgraph</span>(qgraph<span class="op">::</span><span class="kw">cor_auto</span>(data), <span class="dt">graph =</span> <span class="st">&quot;pcor&quot;</span>,</a>
<a class="sourceLine" id="cb174-3" title="3">       <span class="dt">labels =</span> <span class="kw">names</span>(data),</a>
<a class="sourceLine" id="cb174-4" title="4">       <span class="dt">label.scale =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb174-5" title="5">       <span class="dt">edge.labels =</span> <span class="ot">TRUE</span>, </a>
<a class="sourceLine" id="cb174-6" title="6">       <span class="dt">title =</span> <span class="st">&quot;partial correlation network&quot;</span>)</a></code></pre></div>
<p><img src="baseline-networks_files/figure-html/determinants-ggm-3.png" width="2100" /></p>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb175-1" title="1"></a>
<a class="sourceLine" id="cb175-2" title="2"><span class="co"># Average the layout and plot all according to that</span></a>
<a class="sourceLine" id="cb175-3" title="3">avlayout &lt;-<span class="st"> </span>qgraph<span class="op">::</span><span class="kw">averageLayout</span>(bootnetgraph, corgraph, pcorgraph)</a>
<a class="sourceLine" id="cb175-4" title="4"></a>
<a class="sourceLine" id="cb175-5" title="5">corgraph &lt;-<span class="st"> </span>qgraph<span class="op">::</span><span class="kw">qgraph</span>(qgraph<span class="op">::</span><span class="kw">cor_auto</span>(data), <span class="dt">graph =</span> <span class="st">&quot;cor&quot;</span>,</a>
<a class="sourceLine" id="cb175-6" title="6">       <span class="dt">labels =</span> <span class="kw">names</span>(data),</a>
<a class="sourceLine" id="cb175-7" title="7">       <span class="dt">edge.labels =</span> <span class="ot">TRUE</span>, </a>
<a class="sourceLine" id="cb175-8" title="8">       <span class="dt">layout =</span> avlayout, </a>
<a class="sourceLine" id="cb175-9" title="9">       <span class="dt">title =</span> <span class="st">&quot;bivariate correlation network&quot;</span>,</a>
<a class="sourceLine" id="cb175-10" title="10">       <span class="dt">theme =</span> <span class="st">&quot;colorblind&quot;</span>,</a>
<a class="sourceLine" id="cb175-11" title="11">       <span class="dt">maximum =</span> <span class="kw">max</span>(<span class="kw">c</span>(bootnetgraph<span class="op">$</span>graph<span class="op">$</span>Graph<span class="op">$</span>maximum,</a>
<a class="sourceLine" id="cb175-12" title="12">                     pcorgraph<span class="op">$</span>graph<span class="op">$</span>Graph<span class="op">$</span>maximum, </a>
<a class="sourceLine" id="cb175-13" title="13">                     corgraph<span class="op">$</span>graph<span class="op">$</span>Graph<span class="op">$</span>maximum)),</a>
<a class="sourceLine" id="cb175-14" title="14">       <span class="dt">label.scale =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<p><img src="baseline-networks_files/figure-html/determinants-ggm-4.png" width="2100" /></p>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb176-1" title="1"></a>
<a class="sourceLine" id="cb176-2" title="2"><span class="co"># To help with visual comparison, that last argument takes the maximum edge of the three </span></a>
<a class="sourceLine" id="cb176-3" title="3"><span class="co"># graphs and places that as the benchmark for the thickest line in all plots.</span></a>
<a class="sourceLine" id="cb176-4" title="4"></a>
<a class="sourceLine" id="cb176-5" title="5">pcorgraph &lt;-<span class="st"> </span>qgraph<span class="op">::</span><span class="kw">qgraph</span>(qgraph<span class="op">::</span><span class="kw">cor_auto</span>(data), <span class="dt">graph =</span> <span class="st">&quot;pcor&quot;</span>,</a>
<a class="sourceLine" id="cb176-6" title="6">       <span class="dt">labels =</span> <span class="kw">names</span>(data),</a>
<a class="sourceLine" id="cb176-7" title="7">       <span class="dt">edge.labels =</span> <span class="ot">TRUE</span>, </a>
<a class="sourceLine" id="cb176-8" title="8">       <span class="dt">layout =</span> avlayout,</a>
<a class="sourceLine" id="cb176-9" title="9">       <span class="dt">title =</span> <span class="st">&quot;partial correlation network&quot;</span>,</a>
<a class="sourceLine" id="cb176-10" title="10">       <span class="dt">theme =</span> <span class="st">&quot;colorblind&quot;</span>,</a>
<a class="sourceLine" id="cb176-11" title="11">       <span class="dt">maximum =</span> <span class="kw">max</span>(<span class="kw">c</span>(bootnetgraph<span class="op">$</span>graph<span class="op">$</span>Graph<span class="op">$</span>maximum,</a>
<a class="sourceLine" id="cb176-12" title="12">                     pcorgraph<span class="op">$</span>graph<span class="op">$</span>Graph<span class="op">$</span>maximum, </a>
<a class="sourceLine" id="cb176-13" title="13">                     corgraph<span class="op">$</span>graph<span class="op">$</span>Graph<span class="op">$</span>maximum)),</a>
<a class="sourceLine" id="cb176-14" title="14">       <span class="dt">label.scale =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<p><img src="baseline-networks_files/figure-html/determinants-ggm-5.png" width="2100" /></p>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb177-1" title="1"></a>
<a class="sourceLine" id="cb177-2" title="2"></a>
<a class="sourceLine" id="cb177-3" title="3"></a>
<a class="sourceLine" id="cb177-4" title="4">bootnetgraph &lt;-<span class="st"> </span><span class="kw">plot</span>(determinants_ggm_network, </a>
<a class="sourceLine" id="cb177-5" title="5">                     <span class="dt">edge.labels =</span> <span class="ot">TRUE</span>, </a>
<a class="sourceLine" id="cb177-6" title="6">                     <span class="dt">layout =</span> avlayout, </a>
<a class="sourceLine" id="cb177-7" title="7">                     <span class="dt">title =</span> <span class="st">&quot;partial correlation network, with LASSO regularisation and EBIC model selection&quot;</span>,</a>
<a class="sourceLine" id="cb177-8" title="8">       <span class="dt">maximum =</span> <span class="kw">max</span>(<span class="kw">c</span>(bootnetgraph<span class="op">$</span>graph<span class="op">$</span>Graph<span class="op">$</span>maximum,</a>
<a class="sourceLine" id="cb177-9" title="9">                     pcorgraph<span class="op">$</span>graph<span class="op">$</span>Graph<span class="op">$</span>maximum, </a>
<a class="sourceLine" id="cb177-10" title="10">                     corgraph<span class="op">$</span>graph<span class="op">$</span>Graph<span class="op">$</span>maximum)),</a>
<a class="sourceLine" id="cb177-11" title="11">       <span class="dt">label.scale =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<p><img src="baseline-networks_files/figure-html/determinants-ggm-6.png" width="2100" /></p>
<p>A dressed-up version of the last graph. Pies indicate mean as a proportion of the maximum observed value in that variable in question.</p>
<div class="sourceCode" id="cb178"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb178-1" title="1"></a>
<a class="sourceLine" id="cb178-2" title="2">data &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb178-3" title="3"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(</a>
<a class="sourceLine" id="cb178-4" title="4">    <span class="st">&quot;MVPA accelerometer&quot;</span> =<span class="st"> </span>mvpaAccelerometer_T1, </a>
<a class="sourceLine" id="cb178-5" title="5">    <span class="st">&quot;planning&quot;</span> =<span class="st"> </span>PA_actCop_T1, </a>
<a class="sourceLine" id="cb178-6" title="6">    <span class="st">&quot;BCT&quot;</span> =<span class="st"> </span>PA_frequencyDependentBCT_T1, </a>
<a class="sourceLine" id="cb178-7" title="7">    <span class="st">&quot;amotivation&quot;</span> =<span class="st"> </span>PA_amotivation_T1, </a>
<a class="sourceLine" id="cb178-8" title="8">    <span class="st">&quot;autonomous&quot;</span> =<span class="st"> </span>PA_autonomous_T1, </a>
<a class="sourceLine" id="cb178-9" title="9">    <span class="st">&quot;controlled&quot;</span> =<span class="st"> </span>PA_controlled_T1, </a>
<a class="sourceLine" id="cb178-10" title="10">    <span class="st">&quot;descriptive norm&quot;</span> =<span class="st"> </span>PA_descriptiveNorm_T1, </a>
<a class="sourceLine" id="cb178-11" title="11">    <span class="st">&quot;fat pct&quot;</span> =<span class="st"> </span>fatpct_T1, </a>
<a class="sourceLine" id="cb178-12" title="12">    <span class="st">&quot;injunctive norm&quot;</span> =<span class="st"> </span>PA_injunctiveNorm_T1, </a>
<a class="sourceLine" id="cb178-13" title="13">    <span class="st">&quot;intention&quot;</span> =<span class="st"> </span>PA_intention_T1, </a>
<a class="sourceLine" id="cb178-14" title="14">    <span class="st">&quot;outcome expectations&quot;</span> =<span class="st"> </span>PA_outcomeExpectations_T1, </a>
<a class="sourceLine" id="cb178-15" title="15">    <span class="st">&quot;opportunities&quot;</span> =<span class="st"> </span>PA_opportunities_T1, </a>
<a class="sourceLine" id="cb178-16" title="16">    <span class="st">&quot;self-efficacy perceivedBehaviouralControl&quot;</span> =<span class="st"> </span>PA_selfEfficacyperceivedBehaviouralControl_T1) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb178-17" title="17"><span class="st">  </span><span class="kw">mutate_all</span>(<span class="kw">funs</span>(<span class="kw">as.numeric</span>(.))) </a>
<a class="sourceLine" id="cb178-18" title="18"></a>
<a class="sourceLine" id="cb178-19" title="19">piefill_determinantggm2 &lt;-<span class="st"> </span>data <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate_all</span>(<span class="kw">funs</span>(<span class="kw">mean</span>(., <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">/</span><span class="st"> </span><span class="kw">max</span>(., <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)))</a>
<a class="sourceLine" id="cb178-20" title="20">piefill_determinantggm2 &lt;-<span class="st"> </span>piefill_determinantggm2[<span class="dv">1</span>, ]</a>
<a class="sourceLine" id="cb178-21" title="21"></a>
<a class="sourceLine" id="cb178-22" title="22">itemGroups &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Objective&quot;</span>, <span class="st">&quot;Determinants&quot;</span>, <span class="st">&quot;BCTs&quot;</span>,</a>
<a class="sourceLine" id="cb178-23" title="23">                <span class="kw">rep</span>(<span class="st">&quot;Motivation&quot;</span>, <span class="dv">3</span>),</a>
<a class="sourceLine" id="cb178-24" title="24">                <span class="st">&quot;Determinants&quot;</span>, <span class="st">&quot;Objective&quot;</span>, </a>
<a class="sourceLine" id="cb178-25" title="25">                <span class="kw">rep</span>(<span class="st">&quot;Determinants&quot;</span>, <span class="dv">5</span>))</a>
<a class="sourceLine" id="cb178-26" title="26"></a>
<a class="sourceLine" id="cb178-27" title="27">determinantgraph &lt;-<span class="st"> </span><span class="kw">plot</span>(</a>
<a class="sourceLine" id="cb178-28" title="28">  determinants_ggm_network, </a>
<a class="sourceLine" id="cb178-29" title="29">  <span class="dt">edge.labels =</span> <span class="ot">FALSE</span>, </a>
<a class="sourceLine" id="cb178-30" title="30">  <span class="dt">layout =</span> <span class="st">&quot;spring&quot;</span>,</a>
<a class="sourceLine" id="cb178-31" title="31">  <span class="dt">label.scale =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb178-32" title="32">  <span class="dt">groups =</span> itemGroups,</a>
<a class="sourceLine" id="cb178-33" title="33">  <span class="dt">pie =</span> piefill_determinantggm2,</a>
<a class="sourceLine" id="cb178-34" title="34">  <span class="dt">cut =</span> <span class="fl">0.1</span>,</a>
<a class="sourceLine" id="cb178-35" title="35">  <span class="dt">pieBorder =</span> <span class="dv">1</span>,</a>
<a class="sourceLine" id="cb178-36" title="36">  <span class="dt">legend =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb178-37" title="37">  <span class="dt">color =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">5</span>, <span class="dt">begin =</span> <span class="fl">0.5</span>, <span class="dt">option =</span> <span class="st">&quot;D&quot;</span>))</a></code></pre></div>
<p><img src="baseline-networks_files/figure-html/determinants-ggm-2-1.png" width="2100" /></p>
<div id="centrality-and-stability-5" class="section level3">
<h3>Centrality and stability</h3>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb179-1" title="1"></a>
<a class="sourceLine" id="cb179-2" title="2">determinants_centralityPlot &lt;-<span class="st"> </span>qgraph<span class="op">::</span><span class="kw">centralityPlot</span>(bootnetgraph)</a></code></pre></div>
<p><img src="baseline-networks_files/figure-html/determinants-stability-1.png" width="2100" /></p>
<div class="sourceCode" id="cb180"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb180-1" title="1"></a>
<a class="sourceLine" id="cb180-2" title="2">qgraph<span class="op">::</span><span class="kw">centralityPlot</span>(bootnetgraph, </a>
<a class="sourceLine" id="cb180-3" title="3">               <span class="dt">include =</span> <span class="kw">c</span>(<span class="st">&quot;Strength&quot;</span>, <span class="st">&quot;ExpectedInfluence&quot;</span>),</a>
<a class="sourceLine" id="cb180-4" title="4">               <span class="dt">orderBy =</span> <span class="st">&quot;ExpectedInfluence&quot;</span>)</a></code></pre></div>
<p><img src="baseline-networks_files/figure-html/determinants-stability-2.png" width="2100" /></p>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb181-1" title="1"></a>
<a class="sourceLine" id="cb181-2" title="2">qgraph<span class="op">::</span><span class="kw">centrality</span>(bootnetgraph)<span class="op">$</span>InDegree</a>
<a class="sourceLine" id="cb181-3" title="3"><span class="co">##                        MVPA accelerometer </span></a>
<a class="sourceLine" id="cb181-4" title="4"><span class="co">##                                 0.3378674 </span></a>
<a class="sourceLine" id="cb181-5" title="5"><span class="co">##                                  planning </span></a>
<a class="sourceLine" id="cb181-6" title="6"><span class="co">##                                 0.9020016 </span></a>
<a class="sourceLine" id="cb181-7" title="7"><span class="co">##                                       BCT </span></a>
<a class="sourceLine" id="cb181-8" title="8"><span class="co">##                                 0.7714705 </span></a>
<a class="sourceLine" id="cb181-9" title="9"><span class="co">##                               amotivation </span></a>
<a class="sourceLine" id="cb181-10" title="10"><span class="co">##                                 0.8800841 </span></a>
<a class="sourceLine" id="cb181-11" title="11"><span class="co">##                                autonomous </span></a>
<a class="sourceLine" id="cb181-12" title="12"><span class="co">##                                 1.6336916 </span></a>
<a class="sourceLine" id="cb181-13" title="13"><span class="co">##                                controlled </span></a>
<a class="sourceLine" id="cb181-14" title="14"><span class="co">##                                 0.8537876 </span></a>
<a class="sourceLine" id="cb181-15" title="15"><span class="co">##                          descriptive norm </span></a>
<a class="sourceLine" id="cb181-16" title="16"><span class="co">##                                 0.7949501 </span></a>
<a class="sourceLine" id="cb181-17" title="17"><span class="co">##                                   fat pct </span></a>
<a class="sourceLine" id="cb181-18" title="18"><span class="co">##                                 0.4041712 </span></a>
<a class="sourceLine" id="cb181-19" title="19"><span class="co">##                           injunctive norm </span></a>
<a class="sourceLine" id="cb181-20" title="20"><span class="co">##                                 0.6559810 </span></a>
<a class="sourceLine" id="cb181-21" title="21"><span class="co">##                                 intention </span></a>
<a class="sourceLine" id="cb181-22" title="22"><span class="co">##                                 1.0528221 </span></a>
<a class="sourceLine" id="cb181-23" title="23"><span class="co">##                      outcome expectations </span></a>
<a class="sourceLine" id="cb181-24" title="24"><span class="co">##                                 0.8175585 </span></a>
<a class="sourceLine" id="cb181-25" title="25"><span class="co">##                             opportunities </span></a>
<a class="sourceLine" id="cb181-26" title="26"><span class="co">##                                 0.8264137 </span></a>
<a class="sourceLine" id="cb181-27" title="27"><span class="co">## self-efficacy perceivedBehaviouralControl </span></a>
<a class="sourceLine" id="cb181-28" title="28"><span class="co">##                                 0.8096254</span></a>
<a class="sourceLine" id="cb181-29" title="29"><span class="kw">scale</span>(qgraph<span class="op">::</span><span class="kw">centrality</span>(bootnetgraph)<span class="op">$</span>InDegree)</a>
<a class="sourceLine" id="cb181-30" title="30"><span class="co">##                                                    [,1]</span></a>
<a class="sourceLine" id="cb181-31" title="31"><span class="co">## MVPA accelerometer                        -1.5687855800</span></a>
<a class="sourceLine" id="cb181-32" title="32"><span class="co">## planning                                   0.2435652896</span></a>
<a class="sourceLine" id="cb181-33" title="33"><span class="co">## BCT                                       -0.1757820801</span></a>
<a class="sourceLine" id="cb181-34" title="34"><span class="co">## amotivation                                0.1731528179</span></a>
<a class="sourceLine" id="cb181-35" title="35"><span class="co">## autonomous                                 2.5942098691</span></a>
<a class="sourceLine" id="cb181-36" title="36"><span class="co">## controlled                                 0.0886718029</span></a>
<a class="sourceLine" id="cb181-37" title="37"><span class="co">## descriptive norm                          -0.1003509447</span></a>
<a class="sourceLine" id="cb181-38" title="38"><span class="co">## fat pct                                   -1.3557765261</span></a>
<a class="sourceLine" id="cb181-39" title="39"><span class="co">## injunctive norm                           -0.5468063077</span></a>
<a class="sourceLine" id="cb181-40" title="40"><span class="co">## intention                                  0.7280947618</span></a>
<a class="sourceLine" id="cb181-41" title="41"><span class="co">## outcome expectations                      -0.0277184210</span></a>
<a class="sourceLine" id="cb181-42" title="42"><span class="co">## opportunities                              0.0007298052</span></a>
<a class="sourceLine" id="cb181-43" title="43"><span class="co">## self-efficacy perceivedBehaviouralControl -0.0532044870</span></a>
<a class="sourceLine" id="cb181-44" title="44"><span class="co">## attr(,&quot;scaled:center&quot;)</span></a>
<a class="sourceLine" id="cb181-45" title="45"><span class="co">## [1] 0.8261865</span></a>
<a class="sourceLine" id="cb181-46" title="46"><span class="co">## attr(,&quot;scaled:scale&quot;)</span></a>
<a class="sourceLine" id="cb181-47" title="47"><span class="co">## [1] 0.3112721</span></a>
<a class="sourceLine" id="cb181-48" title="48">qgraph<span class="op">::</span><span class="kw">centrality</span>(bootnetgraph)<span class="op">$</span>Closeness</a>
<a class="sourceLine" id="cb181-49" title="49"><span class="co">##                        MVPA accelerometer </span></a>
<a class="sourceLine" id="cb181-50" title="50"><span class="co">##                               0.005129389 </span></a>
<a class="sourceLine" id="cb181-51" title="51"><span class="co">##                                  planning </span></a>
<a class="sourceLine" id="cb181-52" title="52"><span class="co">##                               0.008537893 </span></a>
<a class="sourceLine" id="cb181-53" title="53"><span class="co">##                                       BCT </span></a>
<a class="sourceLine" id="cb181-54" title="54"><span class="co">##                               0.007661927 </span></a>
<a class="sourceLine" id="cb181-55" title="55"><span class="co">##                               amotivation </span></a>
<a class="sourceLine" id="cb181-56" title="56"><span class="co">##                               0.007976853 </span></a>
<a class="sourceLine" id="cb181-57" title="57"><span class="co">##                                autonomous </span></a>
<a class="sourceLine" id="cb181-58" title="58"><span class="co">##                               0.009696260 </span></a>
<a class="sourceLine" id="cb181-59" title="59"><span class="co">##                                controlled </span></a>
<a class="sourceLine" id="cb181-60" title="60"><span class="co">##                               0.007949323 </span></a>
<a class="sourceLine" id="cb181-61" title="61"><span class="co">##                          descriptive norm </span></a>
<a class="sourceLine" id="cb181-62" title="62"><span class="co">##                               0.006965730 </span></a>
<a class="sourceLine" id="cb181-63" title="63"><span class="co">##                                   fat pct </span></a>
<a class="sourceLine" id="cb181-64" title="64"><span class="co">##                               0.005435458 </span></a>
<a class="sourceLine" id="cb181-65" title="65"><span class="co">##                           injunctive norm </span></a>
<a class="sourceLine" id="cb181-66" title="66"><span class="co">##                               0.006318542 </span></a>
<a class="sourceLine" id="cb181-67" title="67"><span class="co">##                                 intention </span></a>
<a class="sourceLine" id="cb181-68" title="68"><span class="co">##                               0.009428010 </span></a>
<a class="sourceLine" id="cb181-69" title="69"><span class="co">##                      outcome expectations </span></a>
<a class="sourceLine" id="cb181-70" title="70"><span class="co">##                               0.008375771 </span></a>
<a class="sourceLine" id="cb181-71" title="71"><span class="co">##                             opportunities </span></a>
<a class="sourceLine" id="cb181-72" title="72"><span class="co">##                               0.006765863 </span></a>
<a class="sourceLine" id="cb181-73" title="73"><span class="co">## self-efficacy perceivedBehaviouralControl </span></a>
<a class="sourceLine" id="cb181-74" title="74"><span class="co">##                               0.006042403</span></a>
<a class="sourceLine" id="cb181-75" title="75">qgraph<span class="op">::</span><span class="kw">centrality</span>(bootnetgraph)<span class="op">$</span>Betweenness</a>
<a class="sourceLine" id="cb181-76" title="76"><span class="co">##                        MVPA accelerometer </span></a>
<a class="sourceLine" id="cb181-77" title="77"><span class="co">##                                         0 </span></a>
<a class="sourceLine" id="cb181-78" title="78"><span class="co">##                                  planning </span></a>
<a class="sourceLine" id="cb181-79" title="79"><span class="co">##                                         2 </span></a>
<a class="sourceLine" id="cb181-80" title="80"><span class="co">##                                       BCT </span></a>
<a class="sourceLine" id="cb181-81" title="81"><span class="co">##                                         2 </span></a>
<a class="sourceLine" id="cb181-82" title="82"><span class="co">##                               amotivation </span></a>
<a class="sourceLine" id="cb181-83" title="83"><span class="co">##                                         8 </span></a>
<a class="sourceLine" id="cb181-84" title="84"><span class="co">##                                autonomous </span></a>
<a class="sourceLine" id="cb181-85" title="85"><span class="co">##                                        44 </span></a>
<a class="sourceLine" id="cb181-86" title="86"><span class="co">##                                controlled </span></a>
<a class="sourceLine" id="cb181-87" title="87"><span class="co">##                                        14 </span></a>
<a class="sourceLine" id="cb181-88" title="88"><span class="co">##                          descriptive norm </span></a>
<a class="sourceLine" id="cb181-89" title="89"><span class="co">##                                        12 </span></a>
<a class="sourceLine" id="cb181-90" title="90"><span class="co">##                                   fat pct </span></a>
<a class="sourceLine" id="cb181-91" title="91"><span class="co">##                                         0 </span></a>
<a class="sourceLine" id="cb181-92" title="92"><span class="co">##                           injunctive norm </span></a>
<a class="sourceLine" id="cb181-93" title="93"><span class="co">##                                         2 </span></a>
<a class="sourceLine" id="cb181-94" title="94"><span class="co">##                                 intention </span></a>
<a class="sourceLine" id="cb181-95" title="95"><span class="co">##                                        30 </span></a>
<a class="sourceLine" id="cb181-96" title="96"><span class="co">##                      outcome expectations </span></a>
<a class="sourceLine" id="cb181-97" title="97"><span class="co">##                                         6 </span></a>
<a class="sourceLine" id="cb181-98" title="98"><span class="co">##                             opportunities </span></a>
<a class="sourceLine" id="cb181-99" title="99"><span class="co">##                                        10 </span></a>
<a class="sourceLine" id="cb181-100" title="100"><span class="co">## self-efficacy perceivedBehaviouralControl </span></a>
<a class="sourceLine" id="cb181-101" title="101"><span class="co">##                                         0</span></a>
<a class="sourceLine" id="cb181-102" title="102"></a>
<a class="sourceLine" id="cb181-103" title="103"><span class="kw">cor</span>(qgraph<span class="op">::</span><span class="kw">centrality</span>(bootnetgraph)<span class="op">$</span>InDegree, qgraph<span class="op">::</span><span class="kw">centrality</span>(bootnetgraph)<span class="op">$</span>Betweenness, </a>
<a class="sourceLine" id="cb181-104" title="104">    <span class="dt">method =</span> <span class="st">&quot;spearman&quot;</span>) </a>
<a class="sourceLine" id="cb181-105" title="105"><span class="co">## [1] 0.7444904</span></a>
<a class="sourceLine" id="cb181-106" title="106"></a>
<a class="sourceLine" id="cb181-107" title="107"><span class="co"># bootnet_stability_determinants &lt;- bootnet::bootnet(determinants_bootnet, nBoots=1000)</span></a>
<a class="sourceLine" id="cb181-108" title="108"><span class="co"># save(bootnet_stability_determinants, file = &quot;./Rdata_files/bootnet_stability_determinants.Rdata&quot;)</span></a>
<a class="sourceLine" id="cb181-109" title="109"><span class="kw">load</span>(<span class="st">&quot;./Rdata_files/bootnet_stability_determinants.Rdata&quot;</span>)</a>
<a class="sourceLine" id="cb181-110" title="110"></a>
<a class="sourceLine" id="cb181-111" title="111"><span class="kw">plot</span>(bootnet_stability_determinants, <span class="dt">labels =</span> <span class="ot">TRUE</span>, <span class="dt">order =</span> <span class="st">&quot;sample&quot;</span>) </a></code></pre></div>
<p><img src="baseline-networks_files/figure-html/determinants-stability-3.png" width="2100" /></p>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb182-1" title="1"><span class="kw">plot</span>(bootnet_stability_determinants, <span class="st">&quot;edge&quot;</span>, <span class="dt">plot =</span> <span class="st">&quot;difference&quot;</span>, <span class="dt">onlyNonZero =</span> <span class="ot">TRUE</span>, <span class="dt">order =</span> <span class="st">&quot;sample&quot;</span>)</a></code></pre></div>
<p><img src="baseline-networks_files/figure-html/determinants-stability-4.png" width="2100" /></p>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb183-1" title="1"></a>
<a class="sourceLine" id="cb183-2" title="2"><span class="co"># bootnet_centrality_stability_determinants &lt;- bootnet::bootnet(determinants_bootnet, nBoots=1000,nCores=8, type=&quot;case&quot;)</span></a>
<a class="sourceLine" id="cb183-3" title="3"><span class="co"># save(bootnet_centrality_stability_determinants, file = &quot;./Rdata_files/bootnet_centrality_stability_determinants.Rdata&quot;)</span></a>
<a class="sourceLine" id="cb183-4" title="4"><span class="kw">load</span>(<span class="st">&quot;./Rdata_files/bootnet_centrality_stability_determinants.Rdata&quot;</span>)</a>
<a class="sourceLine" id="cb183-5" title="5"></a>
<a class="sourceLine" id="cb183-6" title="6"><span class="kw">plot</span>(bootnet_centrality_stability_determinants)</a></code></pre></div>
<p><img src="baseline-networks_files/figure-html/determinants-stability-5.png" width="2100" /></p>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb184-1" title="1"><span class="kw">plot</span>(bootnet_centrality_stability_determinants, <span class="dt">perNode=</span>T, <span class="st">&quot;strength&quot;</span>)</a></code></pre></div>
<p><img src="baseline-networks_files/figure-html/determinants-stability-6.png" width="2100" /></p>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb185-1" title="1"></a>
<a class="sourceLine" id="cb185-2" title="2">bootnet<span class="op">::</span><span class="kw">corStability</span>(bootnet_centrality_stability_determinants)</a>
<a class="sourceLine" id="cb185-3" title="3"><span class="co">## === Correlation Stability Analysis === </span></a>
<a class="sourceLine" id="cb185-4" title="4"><span class="co">## </span></a>
<a class="sourceLine" id="cb185-5" title="5"><span class="co">## Sampling levels tested:</span></a>
<a class="sourceLine" id="cb185-6" title="6"><span class="co">##    nPerson Drop%   n</span></a>
<a class="sourceLine" id="cb185-7" title="7"><span class="co">## 1      291  75.0  91</span></a>
<a class="sourceLine" id="cb185-8" title="8"><span class="co">## 2      382  67.2 105</span></a>
<a class="sourceLine" id="cb185-9" title="9"><span class="co">## 3      472  59.5  93</span></a>
<a class="sourceLine" id="cb185-10" title="10"><span class="co">## 4      563  51.7  95</span></a>
<a class="sourceLine" id="cb185-11" title="11"><span class="co">## 5      654  43.9 107</span></a>
<a class="sourceLine" id="cb185-12" title="12"><span class="co">## 6      744  36.1 111</span></a>
<a class="sourceLine" id="cb185-13" title="13"><span class="co">## 7      835  28.3 101</span></a>
<a class="sourceLine" id="cb185-14" title="14"><span class="co">## 8      926  20.5 106</span></a>
<a class="sourceLine" id="cb185-15" title="15"><span class="co">## 9     1016  12.8  96</span></a>
<a class="sourceLine" id="cb185-16" title="16"><span class="co">## 10    1107   5.0  95</span></a>
<a class="sourceLine" id="cb185-17" title="17"><span class="co">## </span></a>
<a class="sourceLine" id="cb185-18" title="18"><span class="co">## Maximum drop proportions to retain correlation of 0.7 in at least 95% of the samples:</span></a>
<a class="sourceLine" id="cb185-19" title="19"><span class="co">## </span></a>
<a class="sourceLine" id="cb185-20" title="20"><span class="co">## betweenness: 0.672 </span></a>
<a class="sourceLine" id="cb185-21" title="21"><span class="co">##   - For more accuracy, run bootnet(..., caseMin = 0.595, caseMax = 0.75) </span></a>
<a class="sourceLine" id="cb185-22" title="22"><span class="co">## </span></a>
<a class="sourceLine" id="cb185-23" title="23"><span class="co">## closeness: 0.75 (CS-coefficient is highest level tested)</span></a>
<a class="sourceLine" id="cb185-24" title="24"><span class="co">##   - For more accuracy, run bootnet(..., caseMin = 0.672, caseMax = 1) </span></a>
<a class="sourceLine" id="cb185-25" title="25"><span class="co">## </span></a>
<a class="sourceLine" id="cb185-26" title="26"><span class="co">## edge: 0.75 (CS-coefficient is highest level tested)</span></a>
<a class="sourceLine" id="cb185-27" title="27"><span class="co">##   - For more accuracy, run bootnet(..., caseMin = 0.672, caseMax = 1) </span></a>
<a class="sourceLine" id="cb185-28" title="28"><span class="co">## </span></a>
<a class="sourceLine" id="cb185-29" title="29"><span class="co">## strength: 0.75 (CS-coefficient is highest level tested)</span></a>
<a class="sourceLine" id="cb185-30" title="30"><span class="co">##   - For more accuracy, run bootnet(..., caseMin = 0.672, caseMax = 1) </span></a>
<a class="sourceLine" id="cb185-31" title="31"><span class="co">## </span></a>
<a class="sourceLine" id="cb185-32" title="32"><span class="co">## Accuracy can also be increased by increasing both &#39;nBoots&#39; and &#39;caseN&#39;.</span></a></code></pre></div>
</div>
<div id="pa-network-without-sdt-motivations" class="section level3">
<h3>PA network without SDT motivations</h3>
</div>
<div id="pa-network-without-bcts-and-sdt" class="section level3">
<h3>PA network without BCTs and SDT</h3>
</div>
<div id="pa-network-without-bcts-and-sdt-intention-mvpa-fat" class="section level3">
<h3>PA network without BCTs and SDT, intention, MVPA, fat%</h3>
</div>
</div>
<div id="robustness-test" class="section level2">
<h2>Robustness test</h2>
</div>
<div id="centrality-stability" class="section level2">
<h2>Centrality stability</h2>
<div class="sourceCode" id="cb186"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb186-1" title="1">boot2 &lt;-<span class="st"> </span>bootnet<span class="op">::</span><span class="kw">bootnet</span>(Network1, <span class="dt">nBoots =</span> <span class="dv">2500</span>, <span class="dt">type =</span> <span class="st">&quot;case&quot;</span>, <span class="dt">nCores =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb186-2" title="2">bootnet<span class="op">::</span><span class="kw">corStability</span>(boot2)</a>
<a class="sourceLine" id="cb186-3" title="3"></a>
<a class="sourceLine" id="cb186-4" title="4"><span class="kw">plot</span>(boot2)</a>
<a class="sourceLine" id="cb186-5" title="5"></a>
<a class="sourceLine" id="cb186-6" title="6"><span class="kw">differenceTest</span>(boot1, <span class="st">&quot;auton&quot;</span>, <span class="st">&quot;intent&quot;</span>,  <span class="dt">measure =</span> <span class="kw">c</span>(<span class="st">&quot;strength&quot;</span>, <span class="st">&quot;closeness&quot;</span>, <span class="st">&quot;betweenness&quot;</span>))</a>
<a class="sourceLine" id="cb186-7" title="7"></a>
<a class="sourceLine" id="cb186-8" title="8"><span class="kw">plot</span>(boot1, <span class="st">&quot;edge&quot;</span>, <span class="dt">plot =</span> <span class="st">&quot;difference&quot;</span>, <span class="dt">onlyNonZero =</span> <span class="ot">TRUE</span>, <span class="dt">order =</span> <span class="st">&quot;sample&quot;</span>)</a>
<a class="sourceLine" id="cb186-9" title="9"></a>
<a class="sourceLine" id="cb186-10" title="10"><span class="kw">plot</span>(boot1, <span class="st">&quot;strength&quot;</span>)</a>
<a class="sourceLine" id="cb186-11" title="11"><span class="kw">plot</span>(boot1, <span class="st">&quot;betweenness&quot;</span>)</a>
<a class="sourceLine" id="cb186-12" title="12"><span class="kw">plot</span>(boot1, <span class="st">&quot;closeness&quot;</span>)</a></code></pre></div>
</div>
<div id="network-comparison-test-girls-and-boys" class="section level2">
<h2>Network comparison test: girls and boys</h2>
</div>
<div id="robustness-test-1" class="section level2">
<h2>Robustness test</h2>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb187-1" title="1">data &lt;-<span class="st"> </span>data <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="dt">BCT =</span> agreementDependentBCT_T1,</a>
<a class="sourceLine" id="cb187-2" title="2">    <span class="dt">AUT =</span> autonomous_T1,</a>
<a class="sourceLine" id="cb187-3" title="3">    <span class="dt">Intn =</span> intention_T1,</a>
<a class="sourceLine" id="cb187-4" title="4">    <span class="dt">perceivedBehaviouralControl =</span> perceivedBehaviouralControl_T1,</a>
<a class="sourceLine" id="cb187-5" title="5">    <span class="dt">outcomeExpectations =</span> outcomeExpectations_T1,</a>
<a class="sourceLine" id="cb187-6" title="6">    <span class="dt">descriptiveNorm =</span> norm_T1)</a>
<a class="sourceLine" id="cb187-7" title="7"></a>
<a class="sourceLine" id="cb187-8" title="8">Network &lt;-<span class="st"> </span>bootnet<span class="op">::</span><span class="kw">estimateNetwork</span>(data, <span class="dt">default =</span> <span class="st">&quot;EBICglasso&quot;</span>)</a>
<a class="sourceLine" id="cb187-9" title="9"></a>
<a class="sourceLine" id="cb187-10" title="10">boot1 &lt;-<span class="st"> </span>bootnet<span class="op">::</span><span class="kw">bootnet</span>(Network, <span class="dt">nBoots =</span> <span class="dv">2500</span>, <span class="dt">nCores =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb187-11" title="11"></a>
<a class="sourceLine" id="cb187-12" title="12"><span class="kw">plot</span>(boot1, <span class="dt">labels =</span> <span class="ot">TRUE</span>, <span class="dt">order =</span> <span class="st">&quot;sample&quot;</span>)</a>
<a class="sourceLine" id="cb187-13" title="13"></a>
<a class="sourceLine" id="cb187-14" title="14"><span class="kw">plot</span>(Network, <span class="dt">layout =</span> <span class="st">&quot;spring&quot;</span>, <span class="dt">labels =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb187-15" title="15"></a>
<a class="sourceLine" id="cb187-16" title="16">Network2 &lt;-<span class="st"> </span>bootnet<span class="op">::</span><span class="kw">estimateNetwork</span>(data, <span class="dt">default =</span> <span class="st">&quot;pcor&quot;</span>)</a>
<a class="sourceLine" id="cb187-17" title="17"><span class="kw">plot</span>(Network2, <span class="dt">layout =</span> <span class="st">&quot;spring&quot;</span>, <span class="dt">labels =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb187-18" title="18"></a>
<a class="sourceLine" id="cb187-19" title="19">boot1 &lt;-<span class="st"> </span>bootnet<span class="op">::</span><span class="kw">bootnet</span>(Network2, <span class="dt">nBoots =</span> <span class="dv">2500</span>, <span class="dt">nCores =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb187-20" title="20"></a>
<a class="sourceLine" id="cb187-21" title="21">qgraph<span class="op">::</span><span class="kw">centralityPlot</span>(Network)</a>
<a class="sourceLine" id="cb187-22" title="22">qgraph<span class="op">::</span><span class="kw">centralityPlot</span>(Network2)</a></code></pre></div>
</div>
</div>
<div id="centrality-stability-1" class="section level1">
<h1>Centrality stability</h1>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb188-1" title="1">boot2 &lt;-<span class="st"> </span>bootnet<span class="op">::</span><span class="kw">bootnet</span>(Network, <span class="dt">nBoots =</span> <span class="dv">2500</span>, <span class="dt">type =</span> <span class="st">&quot;case&quot;</span>, <span class="dt">nCores =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb188-2" title="2">bootnet<span class="op">::</span><span class="kw">corStability</span>(boot2)</a>
<a class="sourceLine" id="cb188-3" title="3"></a>
<a class="sourceLine" id="cb188-4" title="4"><span class="kw">plot</span>(boot2)</a>
<a class="sourceLine" id="cb188-5" title="5"></a>
<a class="sourceLine" id="cb188-6" title="6"><span class="kw">differenceTest</span>(boot1, <span class="st">&quot;AUT&quot;</span>, <span class="st">&quot;Intn&quot;</span>,  <span class="dt">measure =</span> <span class="kw">c</span>(<span class="st">&quot;strength&quot;</span>, <span class="st">&quot;closeness&quot;</span>, <span class="st">&quot;betweenness&quot;</span>))</a>
<a class="sourceLine" id="cb188-7" title="7"></a>
<a class="sourceLine" id="cb188-8" title="8"><span class="kw">plot</span>(boot1, <span class="st">&quot;edge&quot;</span>, <span class="dt">plot =</span> <span class="st">&quot;difference&quot;</span>, <span class="dt">onlyNonZero =</span> <span class="ot">TRUE</span>, <span class="dt">order =</span> <span class="st">&quot;sample&quot;</span>)</a>
<a class="sourceLine" id="cb188-9" title="9"></a>
<a class="sourceLine" id="cb188-10" title="10"><span class="kw">plot</span>(boot1, <span class="st">&quot;strength&quot;</span>)</a>
<a class="sourceLine" id="cb188-11" title="11"><span class="kw">plot</span>(boot1, <span class="st">&quot;betweenness&quot;</span>)</a>
<a class="sourceLine" id="cb188-12" title="12"><span class="kw">plot</span>(boot1, <span class="st">&quot;closeness&quot;</span>)</a></code></pre></div>
</div>
<div id="pa-motivation-examined" class="section level1">
<h1>PA motivation examined</h1>
<div id="motivation-correlation-matrix" class="section level2">
<h2>Motivation correlation matrix</h2>
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb189-1" title="1">regulations.df &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(</a>
<a class="sourceLine" id="cb189-2" title="2">  mvpaAccelerometer_T1,</a>
<a class="sourceLine" id="cb189-3" title="3">  padaysLastweek_T1,</a>
<a class="sourceLine" id="cb189-4" title="4">  PA_amotivation_<span class="dv">02</span>_T1,</a>
<a class="sourceLine" id="cb189-5" title="5">  PA_amotivation_<span class="dv">01</span>_T1,</a>
<a class="sourceLine" id="cb189-6" title="6">  PA_amotivation_<span class="dv">03</span>_T1,</a>
<a class="sourceLine" id="cb189-7" title="7">  PA_amotivation_<span class="dv">04</span>_T1,</a>
<a class="sourceLine" id="cb189-8" title="8">  PA_extrinsic_<span class="dv">01</span>_T1,</a>
<a class="sourceLine" id="cb189-9" title="9">  PA_extrinsic_<span class="dv">02</span>_T1,</a>
<a class="sourceLine" id="cb189-10" title="10">  PA_extrinsic_<span class="dv">03</span>_T1,</a>
<a class="sourceLine" id="cb189-11" title="11">  PA_introjected_<span class="dv">01</span>_T1,</a>
<a class="sourceLine" id="cb189-12" title="12">  PA_introjected_<span class="dv">02</span>_T1,</a>
<a class="sourceLine" id="cb189-13" title="13">  PA_identified_<span class="dv">01</span>_T1,</a>
<a class="sourceLine" id="cb189-14" title="14">  PA_identified_<span class="dv">02</span>_T1,</a>
<a class="sourceLine" id="cb189-15" title="15">  PA_identified_<span class="dv">03</span>_T1,</a>
<a class="sourceLine" id="cb189-16" title="16">  PA_integrated_<span class="dv">01</span>_T1, </a>
<a class="sourceLine" id="cb189-17" title="17">  PA_integrated_<span class="dv">02</span>_T1,</a>
<a class="sourceLine" id="cb189-18" title="18">  PA_integrated_<span class="dv">03</span>_T1, </a>
<a class="sourceLine" id="cb189-19" title="19">  PA_intrinsic_<span class="dv">01</span>_T1,</a>
<a class="sourceLine" id="cb189-20" title="20">  PA_intrinsic_<span class="dv">02</span>_T1,</a>
<a class="sourceLine" id="cb189-21" title="21">  PA_intrinsic_<span class="dv">03</span>_T1,</a>
<a class="sourceLine" id="cb189-22" title="22">  <span class="dt">Autonomous_sumscore =</span> PA_autonomous_T1,</a>
<a class="sourceLine" id="cb189-23" title="23">  <span class="dt">Controlled_sumscore =</span> PA_controlled_T1,</a>
<a class="sourceLine" id="cb189-24" title="24">  weartimeAccelerometer_T1) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb189-25" title="25"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">mvpaAccelerometer_percentageWeartime_T1 =</span> mvpaAccelerometer_T1 <span class="op">/</span><span class="st"> </span>weartimeAccelerometer_T1)</a>
<a class="sourceLine" id="cb189-26" title="26"></a>
<a class="sourceLine" id="cb189-27" title="27"><span class="co"># Create a covariance matrix of the data</span></a>
<a class="sourceLine" id="cb189-28" title="28">covMatrix &lt;-<span class="st"> </span>regulations.df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">cov</span>(<span class="dt">use =</span> <span class="st">&quot;pairwise.complete.obs&quot;</span>)</a>
<a class="sourceLine" id="cb189-29" title="29"></a>
<a class="sourceLine" id="cb189-30" title="30"><span class="co"># Transform the matrix so, that lower diagonal of the matrix shows partial correlations,</span></a>
<a class="sourceLine" id="cb189-31" title="31"><span class="co"># while the upper one shows bivariate correlations.</span></a>
<a class="sourceLine" id="cb189-32" title="32">matrix_corLower_parcorUpper &lt;-<span class="st"> </span>covMatrix <span class="op">%&gt;%</span><span class="st"> </span>ggm<span class="op">::</span><span class="kw">correlations</span>()</a>
<a class="sourceLine" id="cb189-33" title="33"></a>
<a class="sourceLine" id="cb189-34" title="34"><span class="co"># Show the matrix</span></a>
<a class="sourceLine" id="cb189-35" title="35">matrix_corLower_parcorUpper <span class="op">%&gt;%</span><span class="st"> </span>papaja<span class="op">::</span><span class="kw">apa_table</span>(<span class="dt">caption =</span> <span class="st">&quot;Correlation matrix of key variables of interest. Lower diagonal shows bivariate correlations, upper diagonal shows partial correlations&quot;</span>)</a></code></pre></div>
<caption>
(#tab:motivation-corrmatrix)
</caption>
<caption>
<em>Correlation matrix of key variables of interest. Lower diagonal shows bivariate correlations, upper diagonal shows partial correlations</em>
</caption>
<table>
<thead>
<tr class="header">
<th></th>
<th align="left">mvpaAccelerometer_T1</th>
<th align="left">padaysLastweek_T1</th>
<th align="left">PA_amotivation_02_T1</th>
<th align="left">PA_amotivation_01_T1</th>
<th align="left">PA_amotivation_03_T1</th>
<th align="left">PA_amotivation_04_T1</th>
<th align="left">PA_extrinsic_01_T1</th>
<th align="left">PA_extrinsic_02_T1</th>
<th align="left">PA_extrinsic_03_T1</th>
<th align="left">PA_introjected_01_T1</th>
<th align="left">PA_introjected_02_T1</th>
<th align="left">PA_identified_01_T1</th>
<th align="left">PA_identified_02_T1</th>
<th align="left">PA_identified_03_T1</th>
<th align="left">PA_integrated_01_T1</th>
<th align="left">PA_integrated_02_T1</th>
<th align="left">PA_integrated_03_T1</th>
<th align="left">PA_intrinsic_01_T1</th>
<th align="left">PA_intrinsic_02_T1</th>
<th align="left">PA_intrinsic_03_T1</th>
<th align="left">Autonomous_sumscore</th>
<th align="left">Controlled_sumscore</th>
<th align="left">weartimeAccelerometer_T1</th>
<th align="left">mvpaAccelerometer_percentageWeartime_T1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>mvpaAccelerometer_T1</td>
<td align="left">1.00</td>
<td align="left">0.11</td>
<td align="left">0.02</td>
<td align="left">-0.01</td>
<td align="left">-0.02</td>
<td align="left">-0.02</td>
<td align="left">-0.03</td>
<td align="left">-0.05</td>
<td align="left">-0.05</td>
<td align="left">-0.05</td>
<td align="left">-0.05</td>
<td align="left">0.01</td>
<td align="left">-0.01</td>
<td align="left">0.03</td>
<td align="left">0.06</td>
<td align="left">0.01</td>
<td align="left">0.00</td>
<td align="left">0.04</td>
<td align="left">-0.01</td>
<td align="left">0.06</td>
<td align="left">-0.03</td>
<td align="left">0.05</td>
<td align="left">0.90</td>
<td align="left">1.00</td>
</tr>
<tr class="even">
<td>padaysLastweek_T1</td>
<td align="left">0.29</td>
<td align="left">1.00</td>
<td align="left">0.01</td>
<td align="left">0.03</td>
<td align="left">-0.02</td>
<td align="left">0.05</td>
<td align="left">-0.04</td>
<td align="left">-0.01</td>
<td align="left">-0.03</td>
<td align="left">-0.03</td>
<td align="left">-0.02</td>
<td align="left">-0.01</td>
<td align="left">-0.01</td>
<td align="left">0.03</td>
<td align="left">-0.01</td>
<td align="left">-0.02</td>
<td align="left">0.03</td>
<td align="left">-0.04</td>
<td align="left">0.00</td>
<td align="left">0.03</td>
<td align="left">0.02</td>
<td align="left">0.03</td>
<td align="left">-0.11</td>
<td align="left">-0.09</td>
</tr>
<tr class="odd">
<td>PA_amotivation_02_T1</td>
<td align="left">-0.15</td>
<td align="left">-0.11</td>
<td align="left">1.00</td>
<td align="left">0.33</td>
<td align="left">0.23</td>
<td align="left">0.13</td>
<td align="left">0.00</td>
<td align="left">0.03</td>
<td align="left">0.04</td>
<td align="left">0.00</td>
<td align="left">0.02</td>
<td align="left">-0.02</td>
<td align="left">-0.02</td>
<td align="left">-0.02</td>
<td align="left">-0.04</td>
<td align="left">-0.01</td>
<td align="left">-0.04</td>
<td align="left">-0.05</td>
<td align="left">-0.02</td>
<td align="left">-0.01</td>
<td align="left">0.03</td>
<td align="left">-0.01</td>
<td align="left">-0.04</td>
<td align="left">-0.03</td>
</tr>
<tr class="even">
<td>PA_amotivation_01_T1</td>
<td align="left">-0.17</td>
<td align="left">-0.13</td>
<td align="left">0.59</td>
<td align="left">1.00</td>
<td align="left">0.13</td>
<td align="left">0.15</td>
<td align="left">0.03</td>
<td align="left">0.01</td>
<td align="left">0.05</td>
<td align="left">0.02</td>
<td align="left">0.00</td>
<td align="left">-0.02</td>
<td align="left">-0.03</td>
<td align="left">-0.03</td>
<td align="left">0.00</td>
<td align="left">-0.05</td>
<td align="left">-0.03</td>
<td align="left">-0.03</td>
<td align="left">-0.02</td>
<td align="left">-0.04</td>
<td align="left">0.03</td>
<td align="left">-0.02</td>
<td align="left">0.03</td>
<td align="left">0.01</td>
</tr>
<tr class="odd">
<td>PA_amotivation_03_T1</td>
<td align="left">-0.08</td>
<td align="left">-0.11</td>
<td align="left">0.57</td>
<td align="left">0.54</td>
<td align="left">1.00</td>
<td align="left">0.47</td>
<td align="left">0.04</td>
<td align="left">0.02</td>
<td align="left">0.02</td>
<td align="left">0.02</td>
<td align="left">0.01</td>
<td align="left">-0.04</td>
<td align="left">-0.09</td>
<td align="left">-0.01</td>
<td align="left">0.01</td>
<td align="left">-0.03</td>
<td align="left">0.00</td>
<td align="left">-0.03</td>
<td align="left">-0.07</td>
<td align="left">-0.07</td>
<td align="left">0.04</td>
<td align="left">-0.02</td>
<td align="left">0.03</td>
<td align="left">0.02</td>
</tr>
<tr class="even">
<td>PA_amotivation_04_T1</td>
<td align="left">-0.10</td>
<td align="left">-0.06</td>
<td align="left">0.53</td>
<td align="left">0.52</td>
<td align="left">0.69</td>
<td align="left">1.00</td>
<td align="left">0.00</td>
<td align="left">0.01</td>
<td align="left">0.02</td>
<td align="left">-0.01</td>
<td align="left">0.01</td>
<td align="left">0.01</td>
<td align="left">-0.04</td>
<td align="left">-0.01</td>
<td align="left">-0.02</td>
<td align="left">0.04</td>
<td align="left">0.03</td>
<td align="left">-0.01</td>
<td align="left">-0.01</td>
<td align="left">0.06</td>
<td align="left">-0.01</td>
<td align="left">0.00</td>
<td align="left">0.02</td>
<td align="left">0.02</td>
</tr>
<tr class="odd">
<td>PA_extrinsic_01_T1</td>
<td align="left">-0.05</td>
<td align="left">-0.07</td>
<td align="left">0.28</td>
<td align="left">0.29</td>
<td align="left">0.27</td>
<td align="left">0.27</td>
<td align="left">1.00</td>
<td align="left">-0.80</td>
<td align="left">-0.83</td>
<td align="left">-0.89</td>
<td align="left">-0.89</td>
<td align="left">0.56</td>
<td align="left">0.53</td>
<td align="left">0.51</td>
<td align="left">0.53</td>
<td align="left">0.48</td>
<td align="left">0.51</td>
<td align="left">0.50</td>
<td align="left">0.51</td>
<td align="left">0.48</td>
<td align="left">-0.61</td>
<td align="left">0.93</td>
<td align="left">0.04</td>
<td align="left">0.02</td>
</tr>
<tr class="even">
<td>PA_extrinsic_02_T1</td>
<td align="left">-0.03</td>
<td align="left">0.00</td>
<td align="left">0.29</td>
<td align="left">0.26</td>
<td align="left">0.26</td>
<td align="left">0.28</td>
<td align="left">0.63</td>
<td align="left">1.00</td>
<td align="left">-0.80</td>
<td align="left">-0.87</td>
<td align="left">-0.88</td>
<td align="left">0.55</td>
<td align="left">0.53</td>
<td align="left">0.52</td>
<td align="left">0.53</td>
<td align="left">0.48</td>
<td align="left">0.53</td>
<td align="left">0.51</td>
<td align="left">0.51</td>
<td align="left">0.46</td>
<td align="left">-0.61</td>
<td align="left">0.92</td>
<td align="left">0.06</td>
<td align="left">0.04</td>
</tr>
<tr class="odd">
<td>PA_extrinsic_03_T1</td>
<td align="left">-0.07</td>
<td align="left">-0.04</td>
<td align="left">0.35</td>
<td align="left">0.33</td>
<td align="left">0.29</td>
<td align="left">0.32</td>
<td align="left">0.59</td>
<td align="left">0.61</td>
<td align="left">1.00</td>
<td align="left">-0.88</td>
<td align="left">-0.89</td>
<td align="left">0.55</td>
<td align="left">0.54</td>
<td align="left">0.51</td>
<td align="left">0.54</td>
<td align="left">0.48</td>
<td align="left">0.54</td>
<td align="left">0.51</td>
<td align="left">0.53</td>
<td align="left">0.46</td>
<td align="left">-0.62</td>
<td align="left">0.93</td>
<td align="left">0.05</td>
<td align="left">0.04</td>
</tr>
<tr class="even">
<td>PA_introjected_01_T1</td>
<td align="left">0.02</td>
<td align="left">0.09</td>
<td align="left">0.05</td>
<td align="left">0.00</td>
<td align="left">0.01</td>
<td align="left">0.02</td>
<td align="left">0.27</td>
<td align="left">0.32</td>
<td align="left">0.30</td>
<td align="left">1.00</td>
<td align="left">-0.87</td>
<td align="left">0.56</td>
<td align="left">0.53</td>
<td align="left">0.52</td>
<td align="left">0.53</td>
<td align="left">0.48</td>
<td align="left">0.51</td>
<td align="left">0.52</td>
<td align="left">0.51</td>
<td align="left">0.47</td>
<td align="left">-0.62</td>
<td align="left">0.96</td>
<td align="left">0.06</td>
<td align="left">0.04</td>
</tr>
<tr class="odd">
<td>PA_introjected_02_T1</td>
<td align="left">0.01</td>
<td align="left">0.13</td>
<td align="left">0.02</td>
<td align="left">-0.05</td>
<td align="left">-0.03</td>
<td align="left">0.00</td>
<td align="left">0.21</td>
<td align="left">0.25</td>
<td align="left">0.23</td>
<td align="left">0.69</td>
<td align="left">1.00</td>
<td align="left">0.59</td>
<td align="left">0.55</td>
<td align="left">0.54</td>
<td align="left">0.56</td>
<td align="left">0.50</td>
<td align="left">0.55</td>
<td align="left">0.55</td>
<td align="left">0.53</td>
<td align="left">0.48</td>
<td align="left">-0.64</td>
<td align="left">0.96</td>
<td align="left">0.05</td>
<td align="left">0.04</td>
</tr>
<tr class="even">
<td>PA_identified_01_T1</td>
<td align="left">0.11</td>
<td align="left">0.27</td>
<td align="left">-0.19</td>
<td align="left">-0.22</td>
<td align="left">-0.23</td>
<td align="left">-0.20</td>
<td align="left">-0.01</td>
<td align="left">0.01</td>
<td align="left">-0.01</td>
<td align="left">0.25</td>
<td align="left">0.31</td>
<td align="left">1.00</td>
<td align="left">-0.70</td>
<td align="left">-0.71</td>
<td align="left">-0.75</td>
<td align="left">-0.73</td>
<td align="left">-0.73</td>
<td align="left">-0.74</td>
<td align="left">-0.76</td>
<td align="left">-0.68</td>
<td align="left">0.90</td>
<td align="left">-0.59</td>
<td align="left">-0.03</td>
<td align="left">0.00</td>
</tr>
<tr class="odd">
<td>PA_identified_02_T1</td>
<td align="left">0.08</td>
<td align="left">0.28</td>
<td align="left">-0.30</td>
<td align="left">-0.32</td>
<td align="left">-0.38</td>
<td align="left">-0.35</td>
<td align="left">-0.10</td>
<td align="left">-0.07</td>
<td align="left">-0.07</td>
<td align="left">0.20</td>
<td align="left">0.25</td>
<td align="left">0.61</td>
<td align="left">1.00</td>
<td align="left">-0.68</td>
<td align="left">-0.72</td>
<td align="left">-0.73</td>
<td align="left">-0.73</td>
<td align="left">-0.68</td>
<td align="left">-0.73</td>
<td align="left">-0.63</td>
<td align="left">0.87</td>
<td align="left">-0.57</td>
<td align="left">-0.02</td>
<td align="left">0.01</td>
</tr>
<tr class="even">
<td>PA_identified_03_T1</td>
<td align="left">0.24</td>
<td align="left">0.42</td>
<td align="left">-0.27</td>
<td align="left">-0.31</td>
<td align="left">-0.25</td>
<td align="left">-0.23</td>
<td align="left">-0.11</td>
<td align="left">-0.05</td>
<td align="left">-0.08</td>
<td align="left">0.22</td>
<td align="left">0.27</td>
<td align="left">0.55</td>
<td align="left">0.61</td>
<td align="left">1.00</td>
<td align="left">-0.61</td>
<td align="left">-0.64</td>
<td align="left">-0.64</td>
<td align="left">-0.62</td>
<td align="left">-0.69</td>
<td align="left">-0.61</td>
<td align="left">0.82</td>
<td align="left">-0.55</td>
<td align="left">-0.04</td>
<td align="left">-0.02</td>
</tr>
<tr class="odd">
<td>PA_integrated_01_T1</td>
<td align="left">0.23</td>
<td align="left">0.37</td>
<td align="left">-0.23</td>
<td align="left">-0.25</td>
<td align="left">-0.18</td>
<td align="left">-0.18</td>
<td align="left">-0.05</td>
<td align="left">-0.01</td>
<td align="left">-0.01</td>
<td align="left">0.22</td>
<td align="left">0.29</td>
<td align="left">0.48</td>
<td align="left">0.53</td>
<td align="left">0.74</td>
<td align="left">1.00</td>
<td align="left">-0.59</td>
<td align="left">-0.67</td>
<td align="left">-0.65</td>
<td align="left">-0.72</td>
<td align="left">-0.64</td>
<td align="left">0.84</td>
<td align="left">-0.57</td>
<td align="left">-0.07</td>
<td align="left">-0.05</td>
</tr>
<tr class="even">
<td>PA_integrated_02_T1</td>
<td align="left">0.21</td>
<td align="left">0.37</td>
<td align="left">-0.23</td>
<td align="left">-0.28</td>
<td align="left">-0.20</td>
<td align="left">-0.16</td>
<td align="left">-0.07</td>
<td align="left">-0.01</td>
<td align="left">-0.02</td>
<td align="left">0.22</td>
<td align="left">0.27</td>
<td align="left">0.48</td>
<td align="left">0.52</td>
<td align="left">0.71</td>
<td align="left">0.74</td>
<td align="left">1.00</td>
<td align="left">-0.62</td>
<td align="left">-0.60</td>
<td align="left">-0.66</td>
<td align="left">-0.64</td>
<td align="left">0.82</td>
<td align="left">-0.51</td>
<td align="left">-0.02</td>
<td align="left">0.00</td>
</tr>
<tr class="odd">
<td>PA_integrated_03_T1</td>
<td align="left">0.30</td>
<td align="left">0.44</td>
<td align="left">-0.23</td>
<td align="left">-0.27</td>
<td align="left">-0.19</td>
<td align="left">-0.14</td>
<td align="left">-0.11</td>
<td align="left">-0.04</td>
<td align="left">-0.03</td>
<td align="left">0.13</td>
<td align="left">0.20</td>
<td align="left">0.48</td>
<td align="left">0.51</td>
<td align="left">0.70</td>
<td align="left">0.67</td>
<td align="left">0.71</td>
<td align="left">1.00</td>
<td align="left">-0.73</td>
<td align="left">-0.66</td>
<td align="left">-0.50</td>
<td align="left">0.84</td>
<td align="left">-0.56</td>
<td align="left">-0.02</td>
<td align="left">0.01</td>
</tr>
<tr class="even">
<td>PA_intrinsic_01_T1</td>
<td align="left">0.20</td>
<td align="left">0.35</td>
<td align="left">-0.32</td>
<td align="left">-0.35</td>
<td align="left">-0.31</td>
<td align="left">-0.27</td>
<td align="left">-0.13</td>
<td align="left">-0.08</td>
<td align="left">-0.09</td>
<td align="left">0.26</td>
<td align="left">0.31</td>
<td align="left">0.49</td>
<td align="left">0.61</td>
<td align="left">0.72</td>
<td align="left">0.68</td>
<td align="left">0.72</td>
<td align="left">0.64</td>
<td align="left">1.00</td>
<td align="left">-0.62</td>
<td align="left">-0.52</td>
<td align="left">0.82</td>
<td align="left">-0.55</td>
<td align="left">-0.05</td>
<td align="left">-0.03</td>
</tr>
<tr class="odd">
<td>PA_intrinsic_02_T1</td>
<td align="left">0.21</td>
<td align="left">0.38</td>
<td align="left">-0.30</td>
<td align="left">-0.32</td>
<td align="left">-0.32</td>
<td align="left">-0.25</td>
<td align="left">-0.15</td>
<td align="left">-0.10</td>
<td align="left">-0.07</td>
<td align="left">0.13</td>
<td align="left">0.17</td>
<td align="left">0.45</td>
<td align="left">0.55</td>
<td align="left">0.66</td>
<td align="left">0.60</td>
<td align="left">0.67</td>
<td align="left">0.72</td>
<td align="left">0.73</td>
<td align="left">1.00</td>
<td align="left">-0.52</td>
<td align="left">0.85</td>
<td align="left">-0.55</td>
<td align="left">-0.01</td>
<td align="left">0.01</td>
</tr>
<tr class="even">
<td>PA_intrinsic_03_T1</td>
<td align="left">0.20</td>
<td align="left">0.41</td>
<td align="left">-0.27</td>
<td align="left">-0.31</td>
<td align="left">-0.29</td>
<td align="left">-0.20</td>
<td align="left">-0.14</td>
<td align="left">-0.10</td>
<td align="left">-0.09</td>
<td align="left">0.15</td>
<td align="left">0.19</td>
<td align="left">0.47</td>
<td align="left">0.58</td>
<td align="left">0.68</td>
<td align="left">0.62</td>
<td align="left">0.66</td>
<td align="left">0.77</td>
<td align="left">0.74</td>
<td align="left">0.79</td>
<td align="left">1.00</td>
<td align="left">0.76</td>
<td align="left">-0.50</td>
<td align="left">-0.08</td>
<td align="left">-0.06</td>
</tr>
<tr class="odd">
<td>Autonomous_sumscore</td>
<td align="left">0.24</td>
<td align="left">0.45</td>
<td align="left">-0.31</td>
<td align="left">-0.35</td>
<td align="left">-0.31</td>
<td align="left">-0.27</td>
<td align="left">-0.12</td>
<td align="left">-0.06</td>
<td align="left">-0.06</td>
<td align="left">0.24</td>
<td align="left">0.31</td>
<td align="left">0.68</td>
<td align="left">0.75</td>
<td align="left">0.86</td>
<td align="left">0.82</td>
<td align="left">0.84</td>
<td align="left">0.84</td>
<td align="left">0.86</td>
<td align="left">0.84</td>
<td align="left">0.85</td>
<td align="left">1.00</td>
<td align="left">0.66</td>
<td align="left">0.05</td>
<td align="left">0.02</td>
</tr>
<tr class="even">
<td>Controlled_sumscore</td>
<td align="left">-0.02</td>
<td align="left">0.05</td>
<td align="left">0.24</td>
<td align="left">0.19</td>
<td align="left">0.19</td>
<td align="left">0.21</td>
<td align="left">0.69</td>
<td align="left">0.71</td>
<td align="left">0.69</td>
<td align="left">0.78</td>
<td align="left">0.72</td>
<td align="left">0.18</td>
<td align="left">0.09</td>
<td align="left">0.11</td>
<td align="left">0.15</td>
<td align="left">0.14</td>
<td align="left">0.06</td>
<td align="left">0.12</td>
<td align="left">0.03</td>
<td align="left">0.04</td>
<td align="left">0.13</td>
<td align="left">1.00</td>
<td align="left">-0.06</td>
<td align="left">-0.04</td>
</tr>
<tr class="odd">
<td>weartimeAccelerometer_T1</td>
<td align="left">0.15</td>
<td align="left">-0.04</td>
<td align="left">0.02</td>
<td align="left">0.08</td>
<td align="left">0.07</td>
<td align="left">0.06</td>
<td align="left">0.05</td>
<td align="left">0.05</td>
<td align="left">0.04</td>
<td align="left">0.01</td>
<td align="left">-0.06</td>
<td align="left">-0.06</td>
<td align="left">-0.07</td>
<td align="left">-0.01</td>
<td align="left">-0.01</td>
<td align="left">-0.01</td>
<td align="left">-0.01</td>
<td align="left">-0.03</td>
<td align="left">0.00</td>
<td align="left">-0.03</td>
<td align="left">-0.03</td>
<td align="left">0.02</td>
<td align="left">1.00</td>
<td align="left">-0.90</td>
</tr>
<tr class="even">
<td>mvpaAccelerometer_percentageWeartime_T1</td>
<td align="left">0.98</td>
<td align="left">0.29</td>
<td align="left">-0.15</td>
<td align="left">-0.18</td>
<td align="left">-0.10</td>
<td align="left">-0.11</td>
<td align="left">-0.07</td>
<td align="left">-0.04</td>
<td align="left">-0.08</td>
<td align="left">0.02</td>
<td align="left">0.03</td>
<td align="left">0.12</td>
<td align="left">0.09</td>
<td align="left">0.24</td>
<td align="left">0.23</td>
<td align="left">0.22</td>
<td align="left">0.30</td>
<td align="left">0.20</td>
<td align="left">0.22</td>
<td align="left">0.20</td>
<td align="left">0.25</td>
<td align="left">-0.02</td>
<td align="left">-0.03</td>
<td align="left">1.00</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb190"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb190-1" title="1"></a>
<a class="sourceLine" id="cb190-2" title="2">labs &lt;-<span class="st"> </span><span class="kw">names</span>(regulations.df)</a>
<a class="sourceLine" id="cb190-3" title="3"><span class="co"># Plot the matrix as a correlogram</span></a>
<a class="sourceLine" id="cb190-4" title="4">matrix_corLower_parcorUpper <span class="op">%&gt;%</span><span class="st"> </span>corrgram<span class="op">::</span><span class="kw">corrgram</span>(</a>
<a class="sourceLine" id="cb190-5" title="5">  <span class="dt">type =</span> <span class="st">&quot;cor&quot;</span>,</a>
<a class="sourceLine" id="cb190-6" title="6">  <span class="dt">lower.panel =</span> corrgram<span class="op">::</span>panel.pie,</a>
<a class="sourceLine" id="cb190-7" title="7">  <span class="dt">upper.panel =</span> corrgram<span class="op">::</span>panel.pie,</a>
<a class="sourceLine" id="cb190-8" title="8">  <span class="dt">outer.labels =</span> <span class="kw">list</span>(<span class="dt">bottom =</span> <span class="kw">list</span>(<span class="dt">labels =</span> labs, <span class="dt">cex =</span> <span class="fl">0.75</span>, <span class="dt">srt =</span> <span class="dv">30</span>),</a>
<a class="sourceLine" id="cb190-9" title="9">                      <span class="dt">left =</span> <span class="kw">list</span>(<span class="dt">labels =</span> labs, <span class="dt">cex =</span> <span class="fl">0.75</span>, <span class="dt">srt =</span> <span class="dv">30</span>)),</a>
<a class="sourceLine" id="cb190-10" title="10">  <span class="dt">main =</span> <span class="st">&quot;Bivariate (upper diagonal) and partial (lower diagonal)</span><span class="ch">\n</span><span class="st">correlations of BCTs, motivation and self-reported MVPA&quot;</span>)</a></code></pre></div>
<p><img src="baseline-networks_files/figure-html/motivation-corrmatrix-1.png" width="2100" /></p>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb191-1" title="1"></a>
<a class="sourceLine" id="cb191-2" title="2">corMatrix_motivations &lt;-<span class="st"> </span>regulations.df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">cor</span>(<span class="dt">use =</span> <span class="st">&quot;pairwise.complete.obs&quot;</span>, <span class="dt">method =</span> <span class="st">&quot;spearman&quot;</span>)</a>
<a class="sourceLine" id="cb191-3" title="3"></a>
<a class="sourceLine" id="cb191-4" title="4">variableNames &lt;-<span class="st"> </span><span class="kw">labels</span>(corMatrix_motivations)[[<span class="dv">1</span>]] <span class="co"># Extract list of variable names to use in the next call</span></a>
<a class="sourceLine" id="cb191-5" title="5"></a>
<a class="sourceLine" id="cb191-6" title="6">corMatrix_motivations <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb191-7" title="7"><span class="st">  </span><span class="kw">as.data.frame</span>(.) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb191-8" title="8"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">Variable =</span> variableNames) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb191-9" title="9"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(Variable, </a>
<a class="sourceLine" id="cb191-10" title="10">                <span class="st">`</span><span class="dt">MVPA accelerometer</span><span class="st">`</span> =<span class="st"> </span>mvpaAccelerometer_T1, <span class="st">`</span><span class="dt">MVPA self report</span><span class="st">`</span> =<span class="st"> </span>padaysLastweek_T1, </a>
<a class="sourceLine" id="cb191-11" title="11">                <span class="st">`</span><span class="dt">MVPA accelerometer (% weartime)</span><span class="st">`</span> =<span class="st"> </span>mvpaAccelerometer_percentageWeartime_T1, </a>
<a class="sourceLine" id="cb191-12" title="12">                <span class="st">`</span><span class="dt">Accelerometer wear time</span><span class="st">`</span> =<span class="st"> </span>weartimeAccelerometer_T1) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb191-13" title="13"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">arrange</span>(<span class="kw">desc</span>(<span class="st">`</span><span class="dt">MVPA accelerometer</span><span class="st">`</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb191-14" title="14"><span class="st">  </span>DT<span class="op">::</span><span class="kw">datatable</span>(<span class="dt">caption =</span> <span class="st">&quot;Bivariate correlations between motivation and MVPA. Sorted by correlation strength with MVPA accelerometer.&quot;</span>)</a></code></pre></div>
<div id="htmlwidget-8d0b1831151de2d4fed4" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-8d0b1831151de2d4fed4">{"x":{"filter":"none","caption":"<caption>Bivariate correlations between motivation and MVPA. Sorted by correlation strength with MVPA accelerometer.<\/caption>","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24"],["mvpaAccelerometer_T1","mvpaAccelerometer_percentageWeartime_T1","PA_integrated_03_T1","padaysLastweek_T1","Autonomous_sumscore","PA_integrated_01_T1","PA_identified_03_T1","PA_integrated_02_T1","PA_intrinsic_02_T1","PA_intrinsic_03_T1","PA_intrinsic_01_T1","weartimeAccelerometer_T1","PA_identified_02_T1","PA_identified_01_T1","PA_introjected_02_T1","PA_introjected_01_T1","Controlled_sumscore","PA_extrinsic_02_T1","PA_extrinsic_01_T1","PA_extrinsic_03_T1","PA_amotivation_03_T1","PA_amotivation_04_T1","PA_amotivation_02_T1","PA_amotivation_01_T1"],[1,0.982319713668686,0.324635010678387,0.280047599216251,0.251634459945734,0.237658178689819,0.235631183229874,0.228921388961473,0.226434411942486,0.193673763787552,0.190569006070162,0.12728441678422,0.11866582914777,0.118500520038329,0.00881310695204056,0.000308587917285443,-0.0309285033734422,-0.0540486056776082,-0.068377165416897,-0.0814992348479128,-0.11676117438091,-0.126756177918612,-0.197480683834506,-0.202227941490557],[0.280047599216251,0.294227440531594,0.448114072969901,1,0.458334534779223,0.382239938566911,0.426499466432745,0.372416922244264,0.387806239766034,0.421145362988844,0.359629178435929,-0.0485106213885537,0.304279649355291,0.277554365701712,0.13049133714851,0.0766178132943774,0.0457982336481229,-0.027209684664043,-0.0932687833564905,-0.0634487099740452,-0.139507307905678,-0.106474733245353,-0.144931914571863,-0.15572969803233],[0.982319713668686,1,0.329868334070072,0.294227440531594,0.257839962851189,0.244236514557928,0.23971071772545,0.230011536023326,0.226925738976912,0.200279787427982,0.19483611707413,-0.0412100452934308,0.126637939139956,0.131971914082993,0.0233208485272188,-0.000714444220341709,-0.0299763569279694,-0.0630537448889903,-0.0756762898035619,-0.0886716849439817,-0.125092305445784,-0.133153347237017,-0.201312616129788,-0.212646207811558],[0.12728441678422,-0.0412100452934308,-0.0202182443486166,-0.0485106213885537,-0.0224131033970594,-0.0065522536760913,-0.00763873504062242,-0.00348857322757756,-0.00445581306655485,-0.0323612462846052,-0.0192089634646343,1,-0.0294642814467847,-0.068980591121809,-0.0607782611744422,0.0174730257474378,-0.00663858254839478,0.029782681375653,0.029403711202955,0.0189379105742895,0.0352197548444269,0.0377021318708342,0.00484957698363522,0.0561972077276152]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Variable<\/th>\n      <th>MVPA accelerometer<\/th>\n      <th>MVPA self report<\/th>\n      <th>MVPA accelerometer (% weartime)<\/th>\n      <th>Accelerometer wear time<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-center","targets":"_all"},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode" id="cb192"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb192-1" title="1"></a>
<a class="sourceLine" id="cb192-2" title="2">corMatrix_motivations <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb192-3" title="3"><span class="st">  </span><span class="kw">as.data.frame</span>(.) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb192-4" title="4"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">transmute</span>(<span class="dt">Variable =</span> variableNames,</a>
<a class="sourceLine" id="cb192-5" title="5">                   <span class="st">&quot;Accelerometer minus self-report&quot;</span> =<span class="st"> </span>mvpaAccelerometer_T1 <span class="op">-</span><span class="st"> </span>padaysLastweek_T1,</a>
<a class="sourceLine" id="cb192-6" title="6">                   <span class="st">&quot;Accelerometer minus accelerometer-as-%-weartime&quot;</span> =<span class="st"> </span>mvpaAccelerometer_T1 <span class="op">-</span><span class="st"> </span>mvpaAccelerometer_percentageWeartime_T1) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb192-7" title="7"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">arrange</span>(<span class="kw">desc</span>(<span class="st">`</span><span class="dt">Accelerometer minus self-report</span><span class="st">`</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb192-8" title="8"><span class="st">  </span>DT<span class="op">::</span><span class="kw">datatable</span>(<span class="dt">caption =</span> <span class="st">&quot;Differences in correlations among the measures&quot;</span>)</a></code></pre></div>
<div id="htmlwidget-309596f048520ca5648f" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-309596f048520ca5648f">{"x":{"filter":"none","caption":"<caption>Differences in correlations among the measures<\/caption>","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24"],["mvpaAccelerometer_T1","mvpaAccelerometer_percentageWeartime_T1","weartimeAccelerometer_T1","PA_extrinsic_01_T1","PA_amotivation_03_T1","PA_extrinsic_03_T1","PA_amotivation_04_T1","PA_extrinsic_02_T1","PA_amotivation_01_T1","PA_amotivation_02_T1","PA_introjected_01_T1","Controlled_sumscore","PA_introjected_02_T1","PA_integrated_03_T1","PA_integrated_02_T1","PA_integrated_01_T1","PA_identified_01_T1","PA_intrinsic_02_T1","PA_intrinsic_01_T1","PA_identified_02_T1","PA_identified_03_T1","Autonomous_sumscore","PA_intrinsic_03_T1","padaysLastweek_T1"],[0.719952400783749,0.688092273137092,0.175795038172774,0.0248916179395935,0.0227461335247678,-0.0180505248738676,-0.0202814446732593,-0.0268389210135652,-0.0464982434582264,-0.0525487692626426,-0.0763092253770919,-0.0767267370215651,-0.12167823019647,-0.123479062291514,-0.143495533282791,-0.144581759877092,-0.159053845663383,-0.161371827823548,-0.169060172365767,-0.185613820207521,-0.190868283202872,-0.206700074833489,-0.227471599201292,-0.719952400783749],[0.0176802863313141,-0.0176802863313142,0.168494462077651,0.00729912438666486,0.00833113106487392,0.00717245009606896,0.00639716931840481,0.00900513921138206,0.0104182663210011,0.00383193229528211,0.00102303213762715,-0.000952146445472833,-0.0145077415751783,-0.00523332339168464,-0.00109014706185279,-0.0065783358681086,-0.0134713940446643,-0.000491327034426031,-0.00426711100396859,-0.00797210999218602,-0.00407953449557652,-0.0062055029054553,-0.00660602364042989,-0.0141798413153429]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Variable<\/th>\n      <th>Accelerometer minus self-report<\/th>\n      <th>Accelerometer minus accelerometer-as-%-weartime<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-center","targets":"_all"},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="motivational-regulations-network" class="section level2">
<h2>Motivational regulations network</h2>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
