<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title>Network analyses</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>


</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 66px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 71px;
  margin-top: -71px;
}

.section h2 {
  padding-top: 71px;
  margin-top: -71px;
}
.section h3 {
  padding-top: 71px;
  margin-top: -71px;
}
.section h4 {
  padding-top: 71px;
  margin-top: -71px;
}
.section h5 {
  padding-top: 71px;
  margin-top: -71px;
}
.section h6 {
  padding-top: 71px;
  margin-top: -71px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>




<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
  padding-left: 25px;
  text-indent: 0;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>

<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Visualising baseline characteristics</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">About</a>
</li>
<li>
  <a href="manuscript/baseline-manuscript.pdf">Manuscript</a>
</li>
<li>
  <a href="baseline-supplement.html">Descriptives</a>
</li>
<li>
  <a href="baseline-networks.html">Network analysis</a>
</li>
<li>
  <a href="baseline-forestplots.html">Forest plots of posteriors</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">

<div class="btn-group pull-right">
<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Network analyses</h1>

</div>


<pre class="r"><code>source(&quot;baseline-datasetup.R&quot;)
## Skipping install of &#39;papaja&#39; from a github remote, the SHA1 (849df30a) has not changed since last install.
##   Use `force = TRUE` to force installation
## Warning in pacman::p_install_gh(&quot;crsh/papaja&quot;): The following may have incorrect capitalization specification:
## 
## papaja
## 
## The following packages were not able to be installed:
## papaja
## Skipping install of &#39;NetworkComparisonTest&#39; from a github remote, the SHA1 (178d9a14) has not changed since last install.
##   Use `force = TRUE` to force installation
## Warning in pacman::p_install_gh(&quot;sachaepskamp/NetworkComparisonTest&quot;): The following may have incorrect capitalization specification:
## 
## NetworkComparisonTest
## 
## The following packages were not able to be installed:
## NetworkComparisonTest</code></pre>
<p>Clicking the “Code”-buttons on the right shows code for each chunk.</p>
<div id="under-construction-networks-of-psychosocial-variables" class="section level1">
<h1>UNDER CONSTRUCTION: Networks of psychosocial variables</h1>
</div>
<div id="bcts" class="section level1">
<h1>BCTs</h1>
<div id="graph-analysis" class="section level2">
<h2>Graph analysis</h2>
<div id="ising-networks" class="section level3">
<h3>Ising networks</h3>
<p>Prepare and dichotomise data (lots of skew in distributions).</p>
<pre class="r"><code>nItems &lt;- 19

bctdf &lt;- df %&gt;% dplyr::select(id,
  intervention,
  group,
  school,
  girl,
  &#39;goal setting&#39; = PA_agrbct_01_T1,
  &#39;implementation plan&#39; = PA_agrbct_02_T1,
  &#39;plan by other&#39; = PA_agrbct_03_T1,
  &#39;reminder of plan&#39; = PA_agrbct_04_T1,
  &#39;subgoals&#39; = PA_agrbct_05_T1,
  &#39;new PA options&#39; = PA_agrbct_06_T1,
  &#39;barrier identification&#39; = PA_agrbct_07_T1,
  &#39;coping planning&#39; = PA_agrbct_08_T1,
  &#39;PA identity&#39; = PA_agrbct_09_T1,
  &#39;PA life values&#39; = PA_agrbct_10_T1,
  &#39;positive consequences&#39; = PA_frqbct_01_T1,
  &#39;log on paper&#39; = PA_frqbct_02_T1,
  &#39;smartphone&#39; = PA_frqbct_03_T1,
  &#39;mnemonic cues&#39; = PA_frqbct_04_T1,
  &#39;goal contrast&#39; = PA_frqbct_05_T1,
  &#39;relevance of PA&#39; = PA_frqbct_06_T1,
  &#39;changes at home&#39; = PA_frqbct_07_T1,
  &#39;social support&#39; = PA_frqbct_08_T1,
  &#39;failure contemplated&#39; = PA_frqbct_09_T1) %&gt;%
 mutate(
  &#39;goal setting&#39; = ifelse(`goal setting` == 1, 0, 1),
  &#39;plan&#39; = ifelse(`plan` == 1, 0, 1),
  &#39;plan by other&#39; = ifelse(`plan by other` == 1, 0, 1),
  &#39;reminder of plan&#39; = ifelse(`reminder of plan` == 1, 0, 1),
  &#39;subgoals&#39; = ifelse(`subgoals` == 1, 0, 1),
  &#39;new PA options&#39; = ifelse(`new PA options` == 1, 0, 1),
  &#39;barrier identification&#39; = ifelse(`barrier identification` == 1, 0, 1),
  &#39;coping planning&#39; = ifelse(`coping planning` == 1, 0, 1),
  &#39;PA identity&#39; = ifelse(`PA identity` == 1, 0, 1),
  &#39;PA life values&#39; = ifelse(`PA life values` == 1, 0, 1),
  &#39;positive consequences&#39; = ifelse(`positive consequences` == 1, 0, 1),
  &#39;log on paper&#39; = ifelse(`log on paper` == 1, 0, 1),
  &#39;smartphone&#39; = ifelse(`smartphone` == 1, 0, 1),
  &#39;mnemonic cues&#39; = ifelse(`mnemonic cues` == 1, 0, 1),
  &#39;goal contrast&#39; = ifelse(`goal contrast` == 1, 0, 1),
  &#39;relevance of PA&#39; = ifelse(`relevance of PA` == 1, 0, 1),
  &#39;changes at home&#39; = ifelse(`changes at home` == 1, 0, 1),
  &#39;social support&#39; = ifelse(`social support` == 1, 0, 1),
  &#39;failure contemplated&#39; = ifelse(`failure contemplated` == 1, 0, 1)) %&gt;% 
  data.frame
## Error in mutate_impl(.data, dots): Evaluation error: object &#39;plan&#39; not found.

S.boys &lt;- bctdf %&gt;% filter(girl == 0) %&gt;% select(6:ncol(bctdf)) %&gt;% na.omit(.) 
## Error in eval(lhs, parent, parent): object &#39;bctdf&#39; not found
S.girls &lt;- bctdf %&gt;% filter(girl == 1) %&gt;% select(6:ncol(bctdf)) %&gt;% na.omit(.)
## Error in eval(lhs, parent, parent): object &#39;bctdf&#39; not found
nwBoys &lt;- bootnet::estimateNetwork(S.boys, default=&quot;IsingFit&quot;)
## Error in is.data.frame(data): object &#39;S.boys&#39; not found
nwGirls &lt;- bootnet::estimateNetwork(S.girls, default=&quot;IsingFit&quot;)
## Error in is.data.frame(data): object &#39;S.girls&#39; not found

# Create means for filling nodes

girlmeans &lt;- bctdf %&gt;% group_by(girl) %&gt;% 
  summarise_at(vars(5:(5+nItems-1)),
  funs(mean(., na.rm = TRUE))) %&gt;% 
  filter(girl == 1) %&gt;% 
  select(-1)
## Error in eval(lhs, parent, parent): object &#39;bctdf&#39; not found

boymeans &lt;- bctdf %&gt;% group_by(girl) %&gt;% 
  summarise_at(vars(5:(5+nItems-1)),
  funs(mean(., na.rm = TRUE))) %&gt;% 
  filter(girl == 0) %&gt;% 
  select(-1)
## Error in eval(lhs, parent, parent): object &#39;bctdf&#39; not found</code></pre>
<div id="plot-bct-ising-networks" class="section level4">
<h4>Plot BCT Ising-networks</h4>
<p>For girls and boys.</p>
<pre class="r"><code>
# Find average layout for comparability and plot graphs next to each other

Layout &lt;- averageLayout(nwGirls, nwBoys)
## Error in averageWmat(...): object &#39;nwGirls&#39; not found

layout(t(1:2))

plot(nwGirls, layout = Layout, label.scale = FALSE, title = &quot;Girls&quot;, label.cex = 0.75,
     pie = girlmeans, 
     color = &quot;skyblue&quot;,
     pieBorder = 1)
## Error in plot(nwGirls, layout = Layout, label.scale = FALSE, title = &quot;Girls&quot;, : object &#39;nwGirls&#39; not found

plot(nwBoys, layout = Layout, label.scale = FALSE, title = &quot;Boys&quot;, label.cex = 0.75, 
     pie = boymeans, 
     color = &quot;skyblue&quot;,
     pieBorder = 1)
## Error in plot(nwBoys, layout = Layout, label.scale = FALSE, title = &quot;Boys&quot;, : object &#39;nwBoys&#39; not found</code></pre>
<p>For all participants.</p>
<pre class="r"><code>
S.total &lt;- bctdf %&gt;% select(6:ncol(bctdf))
## Error in eval(lhs, parent, parent): object &#39;bctdf&#39; not found
nwBCT &lt;- bootnet::estimateNetwork(S.total, default=&quot;IsingFit&quot;)
## Error in is.data.frame(data): object &#39;S.total&#39; not found

# smallworldIndex(plot(nwBCT))

# Create means for filling nodes
piefill &lt;- S.total %&gt;%
  summarise_all(funs(mean(., na.rm = TRUE))) 
## Error in eval(lhs, parent, parent): object &#39;S.total&#39; not found

# Plot network
plot(nwBCT, layout = &quot;spring&quot;, label.scale = FALSE, title = &quot;Ising fit&quot;, label.cex = 0.75,
     pie = piefill, 
     color = &quot;skyblue&quot;,
     pieBorder = 1)
## Error in plot(nwBCT, layout = &quot;spring&quot;, label.scale = FALSE, title = &quot;Ising fit&quot;, : object &#39;nwBCT&#39; not found

# Estimate ising network without regularisation
nwBCT_nonreg &lt;- bootnet::estimateNetwork(S.total, default=&quot;IsingSampler&quot;)
## Error in is.data.frame(data): object &#39;S.total&#39; not found

plot(nwBCT_nonreg, layout = &quot;spring&quot;, label.scale = FALSE, title = &quot;Non-regularised Ising model&quot;, label.cex = 0.75,
     pie = piefill, 
     color = &quot;skyblue&quot;,
     pieBorder = 1)
## Error in plot(nwBCT_nonreg, layout = &quot;spring&quot;, label.scale = FALSE, title = &quot;Non-regularised Ising model&quot;, : object &#39;nwBCT_nonreg&#39; not found</code></pre>
<pre class="r"><code>
nItems &lt;- 19

bctdf &lt;- df %&gt;% dplyr::select(id,
  intervention,
  group,
  school,
  girl,
  &#39;goal setting&#39; = PA_agrbct_01_T1,
  &#39;implementation plan&#39; = PA_agrbct_02_T1,
  &#39;plan by other&#39; = PA_agrbct_03_T1,
  &#39;reminder of plan&#39; = PA_agrbct_04_T1,
  &#39;subgoals&#39; = PA_agrbct_05_T1,
  &#39;new PA options&#39; = PA_agrbct_06_T1,
  &#39;barrier identification&#39; = PA_agrbct_07_T1,
  &#39;coping planning&#39; = PA_agrbct_08_T1,
  &#39;PA identity&#39; = PA_agrbct_09_T1,
  &#39;PA life values&#39; = PA_agrbct_10_T1,
  &#39;positive consequences&#39; = PA_frqbct_01_T1,
  &#39;log on paper&#39; = PA_frqbct_02_T1,
  &#39;smartphone&#39; = PA_frqbct_03_T1,
  &#39;mnemonic cues&#39; = PA_frqbct_04_T1,
  &#39;goal contrast&#39; = PA_frqbct_05_T1,
  &#39;relevance of PA&#39; = PA_frqbct_06_T1,
  &#39;changes at home&#39; = PA_frqbct_07_T1,
  &#39;social support&#39; = PA_frqbct_08_T1,
  &#39;failure contemplated&#39; = PA_frqbct_09_T1) %&gt;%
 mutate(
  &#39;goals&#39; = ifelse(`goal setting` == 1, 0, 1),
  &#39;plan&#39; = ifelse(`plan` == 1, 0, 1),
  &#39;plan by other&#39; = ifelse(`plan by other` == 1, 0, 1),
  &#39;reminder of plan&#39; = ifelse(`reminder of plan` == 1, 0, 1),
  &#39;subgoals&#39; = ifelse(`subgoals` == 1, 0, 1),
  &#39;new PA options&#39; = ifelse(`new PA options` == 1, 0, 1),
  &#39;barrier identification&#39; = ifelse(`barrier identification` == 1, 0, 1),
  &#39;coping planning&#39; = ifelse(`coping planning` == 1, 0, 1),
  &#39;PA identity&#39; = ifelse(`PA identity` == 1, 0, 1),
  &#39;PA life values&#39; = ifelse(`PA life values` == 1, 0, 1),
  &#39;positive consequences&#39; = ifelse(`positive consequences` == 1, 0, 1),
  &#39;log on paper&#39; = ifelse(`log on paper` == 1, 0, 1),
  &#39;smartphone&#39; = ifelse(`smartphone` == 1, 0, 1),
  &#39;mnemonic cues&#39; = ifelse(`mnemonic cues` == 1, 0, 1),
  &#39;goal contrast&#39; = ifelse(`goal contrast` == 1, 0, 1),
  &#39;relevance of PA&#39; = ifelse(`relevance of PA` == 1, 0, 1),
  &#39;changes at home&#39; = ifelse(`changes at home` == 1, 0, 1),
  &#39;social support&#39; = ifelse(`social support` == 1, 0, 1),
  &#39;failure contemplated&#39; = ifelse(`failure contemplated` == 1, 0, 1)) %&gt;% 
  data.frame
## Error in mutate_impl(.data, dots): Evaluation error: object &#39;plan&#39; not found.

S.boys &lt;- bctdf %&gt;% filter(girl == 0) %&gt;% select(6:ncol(bctdf)) %&gt;% na.omit(.) 
## Error in eval(lhs, parent, parent): object &#39;bctdf&#39; not found
S.girls &lt;- bctdf %&gt;% filter(girl == 1) %&gt;% select(6:ncol(bctdf)) %&gt;% na.omit(.)
## Error in eval(lhs, parent, parent): object &#39;bctdf&#39; not found
nwBoys &lt;- bootnet::estimateNetwork(S.boys, default=&quot;IsingFit&quot;)
## Error in is.data.frame(data): object &#39;S.boys&#39; not found
nwGirls &lt;- bootnet::estimateNetwork(S.girls, default=&quot;IsingFit&quot;)
## Error in is.data.frame(data): object &#39;S.girls&#39; not found

# Create means for filling nodes

girlmeans &lt;- bctdf %&gt;% group_by(girl) %&gt;% 
  summarise_at(vars(5:(5+nItems-1)),
  funs(mean(., na.rm = TRUE))) %&gt;% 
  filter(girl == 1) %&gt;% 
  select(-1)
## Error in eval(lhs, parent, parent): object &#39;bctdf&#39; not found

boymeans &lt;- bctdf %&gt;% group_by(girl) %&gt;% 
  summarise_at(vars(5:(5+nItems-1)),
  funs(mean(., na.rm = TRUE))) %&gt;% 
  filter(girl == 0) %&gt;% 
  select(-1)
## Error in eval(lhs, parent, parent): object &#39;bctdf&#39; not found

# Find average layout for comparability and plot graphs next to each other

Layout &lt;- averageLayout(nwGirls, nwBoys)
## Error in averageWmat(...): object &#39;nwGirls&#39; not found

layout(t(1:2))
plot(nwGirls, layout = Layout, label.scale = FALSE, title = &quot;Girls&quot;, label.cex = 0.75,
     pie = girlmeans, 
     color = &quot;skyblue&quot;,
     pieBorder = 1)
## Error in plot(nwGirls, layout = Layout, label.scale = FALSE, title = &quot;Girls&quot;, : object &#39;nwGirls&#39; not found

plot(nwBoys, layout = Layout, label.scale = FALSE, title = &quot;Boys&quot;, label.cex = 0.75, 
     pie = boymeans, 
     color = &quot;skyblue&quot;,
     pieBorder = 1)
## Error in plot(nwBoys, layout = Layout, label.scale = FALSE, title = &quot;Boys&quot;, : object &#39;nwBoys&#39; not found</code></pre>
</div>
<div id="combine-items" class="section level4">
<h4>Combine items</h4>
<pre class="r"><code>nItems &lt;- 17

bctdf &lt;- df %&gt;% dplyr::select(id,
  intervention,
  group,
  school,
  girl,
  &#39;goal setting&#39; = PA_agrbct_01_T1,
  &#39;implementation plan&#39; = PA_agrbct_02_T1,
  &#39;plan by other&#39; = PA_agrbct_03_T1,
  &#39;reminder of plan&#39; = PA_agrbct_04_T1,
  &#39;subgoals&#39; = PA_agrbct_05_T1,
  &#39;new PA options&#39; = PA_agrbct_06_T1,
  &#39;barrier identification&#39; = PA_agrbct_07_T1,
  &#39;coping planning&#39; = PA_agrbct_08_T1,
  &#39;PA identity&#39; = PA_agrbct_09_T1,
  &#39;PA life values&#39; = PA_agrbct_10_T1,
  &#39;positive consequences&#39; = PA_frqbct_01_T1,
  &#39;log on paper&#39; = PA_frqbct_02_T1,
  &#39;smartphone&#39; = PA_frqbct_03_T1,
#  &#39;mnemonic cues&#39; = PA_frqbct_04_T1,
  &#39;goal contrast&#39; = PA_frqbct_05_T1,
  &#39;relevance of PA&#39; = PA_frqbct_06_T1,
  &#39;changes at home&#39; = PA_frqbct_07_T1,
  &#39;social support&#39; = PA_frqbct_08_T1,
  &#39;failure contemplated&#39; = PA_frqbct_09_T1) %&gt;%
 mutate(
  &#39;goals&#39; = ifelse(`goal setting` == 1, 0, 1),
  &#39;plan&#39; = ifelse(`plan` == 1 &amp; `plan by other` == 1, 0, 1),
  &#39;reminder of plan&#39; = ifelse(`reminder of plan` == 1, 0, 1),
  &#39;subgoals&#39; = ifelse(`subgoals` == 1, 0, 1),
  &#39;new PA options&#39; = ifelse(`new PA options` == 1, 0, 1),
  &#39;barrier identification&#39; = ifelse(`barrier identification` == 1, 0, 1),
  &#39;coping planning&#39; = ifelse(`coping planning` == 1, 0, 1),
  &#39;PA identity&#39; = ifelse(`PA identity` == 1, 0, 1),
  &#39;PA life values&#39; = ifelse(`PA life values` == 1, 0, 1),
  &#39;positive consequences&#39; = ifelse(`positive consequences` == 1, 0, 1),
  &#39;monitored PA&#39; = ifelse(`log on paper` == 1 &amp; `smartphone` == 1, 0, 1),
#  &#39;mnemonic cues&#39; = ifelse(`mnemonic cues` == 1, 0, 1),
  &#39;goal contrast&#39; = ifelse(`goal contrast` == 1, 0, 1),
  &#39;relevance of PA&#39; = ifelse(`relevance of PA` == 1, 0, 1),
  &#39;changes at home&#39; = ifelse(`changes at home` == 1, 0, 1),
  &#39;social support&#39; = ifelse(`social support` == 1, 0, 1),
  &#39;failure contemplated&#39; = ifelse(`failure contemplated` == 1, 0, 1)) %&gt;%
  select(-`log on paper`, -`smartphone`, -`plan by other`) %&gt;% 
  data.frame
## Error in mutate_impl(.data, dots): Evaluation error: object &#39;plan&#39; not found.

# S.boys &lt;- bctdf %&gt;% filter(girl == 0) %&gt;% select(6:ncol(bctdf)) %&gt;% na.omit(.) 
# S.girls &lt;- bctdf %&gt;% filter(girl == 1) %&gt;% select(6:ncol(bctdf)) %&gt;% na.omit(.)
# nwBoys &lt;- bootnet::estimateNetwork(S.boys, default=&quot;IsingFit&quot;)
# nwGirls &lt;- bootnet::estimateNetwork(S.girls, default=&quot;IsingFit&quot;)
# 
# # Create means for filling nodes
# 
# girlmeans &lt;- bctdf %&gt;% group_by(girl) %&gt;% 
#   summarise_at(vars(5:(5+nItems-1)),
#   funs(mean(., na.rm = TRUE))) %&gt;% 
#   filter(girl == 1) %&gt;% 
#   select(-1)
# 
# boymeans &lt;- bctdf %&gt;% group_by(girl) %&gt;% 
#   summarise_at(vars(5:(5+nItems-1)),
#   funs(mean(., na.rm = TRUE))) %&gt;% 
#   filter(girl == 0) %&gt;% 
#   select(-1)
# 
# # Find average layout for comparability and plot graphs next to each other
# 
# Layout &lt;- averageLayout(nwGirls, nwBoys)
# 
# layout(t(1:2))
# plot(nwGirls, layout = Layout, label.scale = FALSE, title = &quot;Girls&quot;, label.cex = 0.75,
#      pie = girlmeans, 
#      color = &quot;skyblue&quot;,
#      pieBorder = 1)
# 
# plot(nwBoys, layout = Layout, label.scale = FALSE, title = &quot;Boys&quot;, label.cex = 0.75, 
#      pie = boymeans, 
#      color = &quot;skyblue&quot;,
#      pieBorder = 1)

# Network for all participants

S.total &lt;- bctdf %&gt;% select(6:ncol(bctdf))
## Error in eval(lhs, parent, parent): object &#39;bctdf&#39; not found
nwBCT &lt;- bootnet::estimateNetwork(S.total, default=&quot;IsingFit&quot;)
## Error in is.data.frame(data): object &#39;S.total&#39; not found

# smallworldIndex(plot(nwBCT))

# Create means for filling nodes
piefill &lt;- S.total %&gt;%
  summarise_all(funs(mean(., na.rm = TRUE))) 
## Error in eval(lhs, parent, parent): object &#39;S.total&#39; not found

# Plot network
plot(nwBCT, layout = &quot;spring&quot;, label.scale = FALSE, title = &quot;Ising fit&quot;, label.cex = 0.75,
     pie = piefill, 
     color = &quot;skyblue&quot;,
     pieBorder = 1)
## Error in plot(nwBCT, layout = &quot;spring&quot;, label.scale = FALSE, title = &quot;Ising fit&quot;, : object &#39;nwBCT&#39; not found

# # Estimate ising network without regularisation
# nwBCT_nonreg &lt;- bootnet::estimateNetwork(S.total, default=&quot;IsingSampler&quot;)
# 
# plot(nwBCT_nonreg, layout = &quot;spring&quot;, label.scale = FALSE, title = &quot;Non-regularised Ising model&quot;, label.cex = 0.75,
#      pie = piefill, 
#      color = &quot;skyblue&quot;,
#      pieBorder = 1)</code></pre>
</div>
<div id="centrality-and-stability" class="section level4">
<h4>Centrality and stability</h4>
<pre class="r"><code>qgraph::centralityPlot(nwBCT)
## Note: z-scores are shown on x-axis rather than raw centrality indices.
## Error in getWmat(list(...)): object &#39;nwBCT&#39; not found

boot2 &lt;- bootnet::bootnet(nwBCT, nBoots = 2500, type = &quot;case&quot;, nCores = 2)
## Error in is(data, &quot;bootnetResult&quot;): object &#39;nwBCT&#39; not found
bootnet::corStability(boot2)
## Error in x$type %in% c(&quot;node&quot;, &quot;person&quot;): object &#39;boot2&#39; not found

plot(boot2)
## Error in plot(boot2): object &#39;boot2&#39; not found
plot(boot2, &quot;strength&quot;)
## Error in plot(boot2, &quot;strength&quot;): object &#39;boot2&#39; not found
plot(boot2, &quot;betweenness&quot;)
## Error in plot(boot2, &quot;betweenness&quot;): object &#39;boot2&#39; not found
plot(boot2, &quot;closeness&quot;)
## Error in plot(boot2, &quot;closeness&quot;): object &#39;boot2&#39; not found</code></pre>
</div>
<div id="network-comparison-test-boys-vs.girls" class="section level4">
<h4>Network comparison test: boys vs. girls</h4>
<pre class="r"><code>
nct_results &lt;- NetworkComparisonTest::NCT(nwGirls, nwBoys, it=1000, binary.data=TRUE, paired=FALSE, test.edges=TRUE, edges=&#39;all&#39;, progressbar=TRUE)

nct_results$nwinv.pval  # p value of network structure diff test: 0.424
nct_results$glstrinv.pval  # p value of global connectivity diff test: 0.071
nct_results$einv.pvals     #p values testing diffs for all individual edges: lowest p-value 0.017, most = 1
sum(nct_results$einv.pvals$&quot;p-value&quot; &lt; 0.05)  # how many edges are different0
</code></pre>
</div>
</div>
<div id="ggm-bcts-motivation" class="section level3">
<h3>GGM BCTs &amp; motivation</h3>
<pre class="r"><code>library(corrgram)

nItems &lt;- 19

bctdf &lt;- df %&gt;% dplyr::select(id,
  intervention,
  group,
  school,
  girl,
  &#39;Autonomous&#39; = PA_autonomous_T1,
  &#39;Controlled&#39; = PA_controlled_T1,
  &#39;goal setting&#39; = PA_agrbct_01_T1,
  &#39;implementation plan&#39; = PA_agrbct_02_T1,
  &#39;plan by other&#39; = PA_agrbct_03_T1,
  &#39;reminder of plan&#39; = PA_agrbct_04_T1,
  &#39;subgoals&#39; = PA_agrbct_05_T1,
  &#39;new PA options&#39; = PA_agrbct_06_T1,
  &#39;barrier identification&#39; = PA_agrbct_07_T1,
  &#39;coping planning&#39; = PA_agrbct_08_T1,
  &#39;PA identity&#39; = PA_agrbct_09_T1,
  &#39;PA life values&#39; = PA_agrbct_10_T1,
  &#39;positive consequences&#39; = PA_frqbct_01_T1,
  &#39;log on paper&#39; = PA_frqbct_02_T1,
  &#39;smartphone&#39; = PA_frqbct_03_T1,
#  &#39;mnemonic cues&#39; = PA_frqbct_04_T1,
  &#39;goal contrast&#39; = PA_frqbct_05_T1,
  &#39;relevance of PA&#39; = PA_frqbct_06_T1,
  &#39;changes at home&#39; = PA_frqbct_07_T1,
  &#39;social support&#39; = PA_frqbct_08_T1,
  &#39;failure contemplated&#39; = PA_frqbct_09_T1) %&gt;%
  rowwise() %&gt;% 
  mutate( 
  #&#39;has plan&#39; = mean(c(`implementation plan`, `plan by other`), na.rm = TRUE),
  &#39;monitored PA&#39; = mean(c(`log on paper`, `smartphone`), na.rm = TRUE)) %&gt;%
  select(-`log on paper`, -`smartphone`) %&gt;% 
  data.frame %&gt;% 
  mutate_all(as.numeric)
## Warning in evalq(as.numeric(id), &lt;environment&gt;): NAs introduced by coercion
## Warning in evalq(as.numeric(group), &lt;environment&gt;): NAs introduced by
## coercion

# Network for all participants

S.total &lt;- bctdf %&gt;% select(`Autonomous`:ncol(bctdf))
nwBCT &lt;- bootnet::estimateNetwork(S.total, default=&quot;EBICglasso&quot;)
## Estimating Network. Using package::function:
##   - qgraph::EBICglasso for EBIC model selection
##     - using glasso::glasso
##   - qgraph::cor_auto for correlation computation
##     - using lavaan::lavCor
## Variables detected as ordinal: goal.setting; implementation.plan; plan.by.other; reminder.of.plan; subgoals; new.PA.options; barrier.identification; coping.planning; PA.identity; PA.life.values; positive.consequences; goal.contrast; relevance.of.PA; changes.at.home; social.support

# Plot correlations (minmax crowds the diagonal as it plots the minimum and maximum values for each variable).
labs &lt;- colnames(S.total)
corrgram::corrgram(S.total, 
         cor.method = &quot;spearman&quot;, 
         # diag.panel=panel.minmax, 
         # lower.panel=panel.shade, 
         # lower.panel=panel.ellipse,
         # lower.panel=panel.cor,
         upper.panel=panel.conf,
         lower.panel=panel.pie,
         outer.labels=list(
           bottom=list(labels=labs,cex=.75, srt=60),
           left=list(labels=labs,cex=.75, srt=30))
         )</code></pre>
<p><img src="baseline-networks_files/figure-html/unnamed-chunk-7-1.png" width="2100" /></p>
<pre class="r"><code>
labs &lt;- colnames(S.total)
corrgram::corrgram(S.total, 
         cor.method = &quot;spearman&quot;,
         upper.panel=panel.ellipse,
         lower.panel=panel.pie,
         outer.labels=list(
           bottom=list(labels=labs,cex=.75, srt=60),
           left=list(labels=labs,cex=.75, srt=30))
         )</code></pre>
<p><img src="baseline-networks_files/figure-html/unnamed-chunk-7-2.png" width="2100" /></p>
<pre class="r"><code>
# Create means for filling nodes
piefill &lt;- S.total %&gt;%
  summarise_all(funs(median(., na.rm = TRUE) / 6)) 

# Plot network
plot(nwBCT, layout = &quot;spring&quot;, label.scale = FALSE, title = &quot;GGM, BCTs &amp; motivation&quot;, label.cex = 0.75,
     pie = piefill, 
     color = &quot;skyblue&quot;,
     pieBorder = 1)</code></pre>
<p><img src="baseline-networks_files/figure-html/unnamed-chunk-7-3.png" width="2100" /></p>
<pre class="r"><code>
# Combine items further:
bctdf2 &lt;- bctdf %&gt;% rowwise %&gt;% 
  mutate(&#39;goals and plans&#39; = mean(c(`goal.setting`, `implementation.plan`), na.rm = TRUE)) %&gt;% 
  mutate(&#39;barriers identified\nand planned for&#39; = mean(c(`barrier.identification`, `coping.planning`), na.rm = TRUE)) %&gt;% 
  select(-`goal.setting`, -`implementation.plan`, -`barrier.identification`, -`coping.planning`) %&gt;% 
  data.frame

S.total2 &lt;- bctdf2 %&gt;% select(`Autonomous`:ncol(bctdf2))
nwBCT2 &lt;- bootnet::estimateNetwork(S.total2, default=&quot;EBICglasso&quot;)
## Estimating Network. Using package::function:
##   - qgraph::EBICglasso for EBIC model selection
##     - using glasso::glasso
##   - qgraph::cor_auto for correlation computation
##     - using lavaan::lavCor
## Variables detected as ordinal: plan.by.other; reminder.of.plan; subgoals; new.PA.options; PA.identity; PA.life.values; positive.consequences; goal.contrast; relevance.of.PA; changes.at.home; social.support

# Create means for filling nodes
piefill2 &lt;- S.total2 %&gt;%
  mutate(Autonomous = Autonomous * 6/5, # Transform these from scale 1-5 to 1-6
         Controlled = Controlled * 6/5) %&gt;% 
  summarise_all(funs(median(., na.rm = TRUE) / 6)) 

# Plot network
plot(nwBCT2, layout = &quot;spring&quot;, label.scale = FALSE, title = &quot;GGM, BCTs &amp; motivation&quot;, label.cex = 0.75,
     pie = piefill2, 
     color = &quot;skyblue&quot;,
     pieBorder = 1)</code></pre>
<p><img src="baseline-networks_files/figure-html/unnamed-chunk-7-4.png" width="2100" /></p>
<div id="stability-and-robustness" class="section level4">
<h4>Stability and robustness</h4>
<p>Robustness test</p>
<pre class="r"><code>
qgraph::centralityPlot(nwBCT)
## Note: z-scores are shown on x-axis rather than raw centrality indices.</code></pre>
<p><img src="baseline-networks_files/figure-html/bct-robustness-1.png" width="2100" /></p>
<pre class="r"><code>qgraph::centralityPlot(nwBCT2)
## Note: z-scores are shown on x-axis rather than raw centrality indices.</code></pre>
<p><img src="baseline-networks_files/figure-html/bct-robustness-2.png" width="2100" /></p>
<pre class="r"><code>
BCTboot1 &lt;- bootnet::bootnet(nwBCT, nBoots = 2500)
## Estimating sample network...
## Estimating Network. Using package::function:
##   - qgraph::EBICglasso for EBIC model selection
##     - using glasso::glasso
##   - qgraph::cor_auto for correlation computation
##     - using lavaan::lavCor
## Variables detected as ordinal: goal.setting; implementation.plan; plan.by.other; reminder.of.plan; subgoals; new.PA.options; barrier.identification; coping.planning; PA.identity; PA.life.values; positive.consequences; goal.contrast; relevance.of.PA; changes.at.home; social.support
## Bootstrapping...
## 
  |                                                                       
  |                                                                 |   0%
  |                                                                       
  |                                                                 |   1%
  |                                                                       
  |=                                                                |   1%
  |                                                                       
  |=                                                                |   2%
  |                                                                       
  |==                                                               |   2%
  |                                                                       
  |==                                                               |   3%
  |                                                                       
  |==                                                               |   4%
  |                                                                       
  |===                                                              |   4%
  |                                                                       
  |===                                                              |   5%
  |                                                                       
  |====                                                             |   5%
  |                                                                       
  |====                                                             |   6%
  |                                                                       
  |====                                                             |   7%
  |                                                                       
  |=====                                                            |   7%
  |                                                                       
  |=====                                                            |   8%
  |                                                                       
  |======                                                           |   8%
  |                                                                       
  |======                                                           |   9%
  |                                                                       
  |======                                                           |  10%
  |                                                                       
  |=======                                                          |  10%
  |                                                                       
  |=======                                                          |  11%
  |                                                                       
  |=======                                                          |  12%
  |                                                                       
  |========                                                         |  12%
  |                                                                       
  |========                                                         |  13%
  |                                                                       
  |=========                                                        |  13%
  |                                                                       
  |=========                                                        |  14%
  |                                                                       
  |=========                                                        |  15%
  |                                                                       
  |==========                                                       |  15%
  |                                                                       
  |==========                                                       |  16%
  |                                                                       
  |===========                                                      |  16%
  |                                                                       
  |===========                                                      |  17%
  |                                                                       
  |===========                                                      |  18%
  |                                                                       
  |============                                                     |  18%
  |                                                                       
  |============                                                     |  19%
  |                                                                       
  |=============                                                    |  19%
  |                                                                       
  |=============                                                    |  20%
  |                                                                       
  |=============                                                    |  21%
  |                                                                       
  |==============                                                   |  21%
  |                                                                       
  |==============                                                   |  22%
  |                                                                       
  |===============                                                  |  22%
  |                                                                       
  |===============                                                  |  23%
  |                                                                       
  |===============                                                  |  24%
  |                                                                       
  |================                                                 |  24%
  |                                                                       
  |================                                                 |  25%
  |                                                                       
  |=================                                                |  25%
  |                                                                       
  |=================                                                |  26%
  |                                                                       
  |=================                                                |  27%
  |                                                                       
  |==================                                               |  27%
  |                                                                       
  |==================                                               |  28%
  |                                                                       
  |===================                                              |  28%
  |                                                                       
  |===================                                              |  29%
  |                                                                       
  |===================                                              |  30%
  |                                                                       
  |====================                                             |  30%
  |                                                                       
  |====================                                             |  31%
  |                                                                       
  |====================                                             |  32%
  |                                                                       
  |=====================                                            |  32%
  |                                                                       
  |=====================                                            |  33%
  |                                                                       
  |======================                                           |  33%
  |                                                                       
  |======================                                           |  34%
  |                                                                       
  |======================                                           |  35%
  |                                                                       
  |=======================                                          |  35%
  |                                                                       
  |=======================                                          |  36%
  |                                                                       
  |========================                                         |  36%
  |                                                                       
  |========================                                         |  37%
  |                                                                       
  |========================                                         |  38%
  |                                                                       
  |=========================                                        |  38%
  |                                                                       
  |=========================                                        |  39%
  |                                                                       
  |==========================                                       |  39%
  |                                                                       
  |==========================                                       |  40%
  |                                                                       
  |==========================                                       |  41%
  |                                                                       
  |===========================                                      |  41%
  |                                                                       
  |===========================                                      |  42%
  |                                                                       
  |============================                                     |  42%
  |                                                                       
  |============================                                     |  43%
  |                                                                       
  |============================                                     |  44%
  |                                                                       
  |=============================                                    |  44%
  |                                                                       
  |=============================                                    |  45%
  |                                                                       
  |==============================                                   |  45%
  |                                                                       
  |==============================                                   |  46%
  |                                                                       
  |==============================                                   |  47%
  |                                                                       
  |===============================                                  |  47%
  |                                                                       
  |===============================                                  |  48%
  |                                                                       
  |================================                                 |  48%
  |                                                                       
  |================================                                 |  49%
  |                                                                       
  |================================                                 |  50%
  |                                                                       
  |=================================                                |  50%
  |                                                                       
  |=================================                                |  51%
  |                                                                       
  |=================================                                |  52%
  |                                                                       
  |==================================                               |  52%
  |                                                                       
  |==================================                               |  53%
  |                                                                       
  |===================================                              |  53%
  |                                                                       
  |===================================                              |  54%
  |                                                                       
  |===================================                              |  55%
  |                                                                       
  |====================================                             |  55%
  |                                                                       
  |====================================                             |  56%
  |                                                                       
  |=====================================                            |  56%
  |                                                                       
  |=====================================                            |  57%
  |                                                                       
  |=====================================                            |  58%
  |                                                                       
  |======================================                           |  58%
  |                                                                       
  |======================================                           |  59%
  |                                                                       
  |=======================================                          |  59%
  |                                                                       
  |=======================================                          |  60%
  |                                                                       
  |=======================================                          |  61%
  |                                                                       
  |========================================                         |  61%
  |                                                                       
  |========================================                         |  62%
  |                                                                       
  |=========================================                        |  62%
  |                                                                       
  |=========================================                        |  63%
  |                                                                       
  |=========================================                        |  64%
  |                                                                       
  |==========================================                       |  64%
  |                                                                       
  |==========================================                       |  65%
  |                                                                       
  |===========================================                      |  65%
  |                                                                       
  |===========================================                      |  66%
  |                                                                       
  |===========================================                      |  67%
  |                                                                       
  |============================================                     |  67%
  |                                                                       
  |============================================                     |  68%
  |                                                                       
  |=============================================                    |  68%
  |                                                                       
  |=============================================                    |  69%
  |                                                                       
  |=============================================                    |  70%
  |                                                                       
  |==============================================                   |  70%
  |                                                                       
  |==============================================                   |  71%
  |                                                                       
  |==============================================                   |  72%
  |                                                                       
  |===============================================                  |  72%
  |                                                                       
  |===============================================                  |  73%
  |                                                                       
  |================================================                 |  73%
  |                                                                       
  |================================================                 |  74%
  |                                                                       
  |================================================                 |  75%
  |                                                                       
  |=================================================                |  75%
  |                                                                       
  |=================================================                |  76%
  |                                                                       
  |==================================================               |  76%
  |                                                                       
  |==================================================               |  77%
  |                                                                       
  |==================================================               |  78%
  |                                                                       
  |===================================================              |  78%
  |                                                                       
  |===================================================              |  79%
  |                                                                       
  |====================================================             |  79%
  |                                                                       
  |====================================================             |  80%
  |                                                                       
  |====================================================             |  81%
  |                                                                       
  |=====================================================            |  81%
  |                                                                       
  |=====================================================            |  82%
  |                                                                       
  |======================================================           |  82%
  |                                                                       
  |======================================================           |  83%
  |                                                                       
  |======================================================           |  84%
  |                                                                       
  |=======================================================          |  84%
  |                                                                       
  |=======================================================          |  85%
  |                                                                       
  |========================================================         |  85%
  |                                                                       
  |========================================================         |  86%
  |                                                                       
  |========================================================         |  87%
  |                                                                       
  |=========================================================        |  87%
  |                                                                       
  |=========================================================        |  88%
  |                                                                       
  |==========================================================       |  88%
  |                                                                       
  |==========================================================       |  89%
  |                                                                       
  |==========================================================       |  90%
  |                                                                       
  |===========================================================      |  90%
  |                                                                       
  |===========================================================      |  91%
  |                                                                       
  |===========================================================      |  92%
  |                                                                       
  |============================================================     |  92%
  |                                                                       
  |============================================================     |  93%
  |                                                                       
  |=============================================================    |  93%
  |                                                                       
  |=============================================================    |  94%
  |                                                                       
  |=============================================================    |  95%
  |                                                                       
  |==============================================================   |  95%
  |                                                                       
  |==============================================================   |  96%
  |                                                                       
  |===============================================================  |  96%
  |                                                                       
  |===============================================================  |  97%
  |                                                                       
  |===============================================================  |  98%
  |                                                                       
  |================================================================ |  98%
  |                                                                       
  |================================================================ |  99%
  |                                                                       
  |=================================================================|  99%
  |                                                                       
  |=================================================================| 100%
## Computing statistics...
## 
  |                                                                       
  |                                                                 |   0%
  |                                                                       
  |                                                                 |   1%
  |                                                                       
  |=                                                                |   1%
  |                                                                       
  |=                                                                |   2%
  |                                                                       
  |==                                                               |   2%
  |                                                                       
  |==                                                               |   3%
  |                                                                       
  |==                                                               |   4%
  |                                                                       
  |===                                                              |   4%
  |                                                                       
  |===                                                              |   5%
  |                                                                       
  |====                                                             |   5%
  |                                                                       
  |====                                                             |   6%
  |                                                                       
  |====                                                             |   7%
  |                                                                       
  |=====                                                            |   7%
  |                                                                       
  |=====                                                            |   8%
  |                                                                       
  |======                                                           |   8%
  |                                                                       
  |======                                                           |   9%
  |                                                                       
  |======                                                           |  10%
  |                                                                       
  |=======                                                          |  10%
  |                                                                       
  |=======                                                          |  11%
  |                                                                       
  |=======                                                          |  12%
  |                                                                       
  |========                                                         |  12%
  |                                                                       
  |========                                                         |  13%
  |                                                                       
  |=========                                                        |  13%
  |                                                                       
  |=========                                                        |  14%
  |                                                                       
  |=========                                                        |  15%
  |                                                                       
  |==========                                                       |  15%
  |                                                                       
  |==========                                                       |  16%
  |                                                                       
  |===========                                                      |  16%
  |                                                                       
  |===========                                                      |  17%
  |                                                                       
  |===========                                                      |  18%
  |                                                                       
  |============                                                     |  18%
  |                                                                       
  |============                                                     |  19%
  |                                                                       
  |=============                                                    |  19%
  |                                                                       
  |=============                                                    |  20%
  |                                                                       
  |=============                                                    |  21%
  |                                                                       
  |==============                                                   |  21%
  |                                                                       
  |==============                                                   |  22%
  |                                                                       
  |===============                                                  |  22%
  |                                                                       
  |===============                                                  |  23%
  |                                                                       
  |===============                                                  |  24%
  |                                                                       
  |================                                                 |  24%
  |                                                                       
  |================                                                 |  25%
  |                                                                       
  |=================                                                |  25%
  |                                                                       
  |=================                                                |  26%
  |                                                                       
  |=================                                                |  27%
  |                                                                       
  |==================                                               |  27%
  |                                                                       
  |==================                                               |  28%
  |                                                                       
  |===================                                              |  28%
  |                                                                       
  |===================                                              |  29%
  |                                                                       
  |===================                                              |  30%
  |                                                                       
  |====================                                             |  30%
  |                                                                       
  |====================                                             |  31%
  |                                                                       
  |====================                                             |  32%
  |                                                                       
  |=====================                                            |  32%
  |                                                                       
  |=====================                                            |  33%
  |                                                                       
  |======================                                           |  33%
  |                                                                       
  |======================                                           |  34%
  |                                                                       
  |======================                                           |  35%
  |                                                                       
  |=======================                                          |  35%
  |                                                                       
  |=======================                                          |  36%
  |                                                                       
  |========================                                         |  36%
  |                                                                       
  |========================                                         |  37%
  |                                                                       
  |========================                                         |  38%
  |                                                                       
  |=========================                                        |  38%
  |                                                                       
  |=========================                                        |  39%
  |                                                                       
  |==========================                                       |  39%
  |                                                                       
  |==========================                                       |  40%
  |                                                                       
  |==========================                                       |  41%
  |                                                                       
  |===========================                                      |  41%
  |                                                                       
  |===========================                                      |  42%
  |                                                                       
  |============================                                     |  42%
  |                                                                       
  |============================                                     |  43%
  |                                                                       
  |============================                                     |  44%
  |                                                                       
  |=============================                                    |  44%
  |                                                                       
  |=============================                                    |  45%
  |                                                                       
  |==============================                                   |  45%
  |                                                                       
  |==============================                                   |  46%
  |                                                                       
  |==============================                                   |  47%
  |                                                                       
  |===============================                                  |  47%
  |                                                                       
  |===============================                                  |  48%
  |                                                                       
  |================================                                 |  48%
  |                                                                       
  |================================                                 |  49%
  |                                                                       
  |================================                                 |  50%
  |                                                                       
  |=================================                                |  50%
  |                                                                       
  |=================================                                |  51%
  |                                                                       
  |=================================                                |  52%
  |                                                                       
  |==================================                               |  52%
  |                                                                       
  |==================================                               |  53%
  |                                                                       
  |===================================                              |  53%
  |                                                                       
  |===================================                              |  54%
  |                                                                       
  |===================================                              |  55%
  |                                                                       
  |====================================                             |  55%
  |                                                                       
  |====================================                             |  56%
  |                                                                       
  |=====================================                            |  56%
  |                                                                       
  |=====================================                            |  57%
  |                                                                       
  |=====================================                            |  58%
  |                                                                       
  |======================================                           |  58%
  |                                                                       
  |======================================                           |  59%
  |                                                                       
  |=======================================                          |  59%
  |                                                                       
  |=======================================                          |  60%
  |                                                                       
  |=======================================                          |  61%
  |                                                                       
  |========================================                         |  61%
  |                                                                       
  |========================================                         |  62%
  |                                                                       
  |=========================================                        |  62%
  |                                                                       
  |=========================================                        |  63%
  |                                                                       
  |=========================================                        |  64%
  |                                                                       
  |==========================================                       |  64%
  |                                                                       
  |==========================================                       |  65%
  |                                                                       
  |===========================================                      |  65%
  |                                                                       
  |===========================================                      |  66%
  |                                                                       
  |===========================================                      |  67%
  |                                                                       
  |============================================                     |  67%
  |                                                                       
  |============================================                     |  68%
  |                                                                       
  |=============================================                    |  68%
  |                                                                       
  |=============================================                    |  69%
  |                                                                       
  |=============================================                    |  70%
  |                                                                       
  |==============================================                   |  70%
  |                                                                       
  |==============================================                   |  71%
  |                                                                       
  |==============================================                   |  72%
  |                                                                       
  |===============================================                  |  72%
  |                                                                       
  |===============================================                  |  73%
  |                                                                       
  |================================================                 |  73%
  |                                                                       
  |================================================                 |  74%
  |                                                                       
  |================================================                 |  75%
  |                                                                       
  |=================================================                |  75%
  |                                                                       
  |=================================================                |  76%
  |                                                                       
  |==================================================               |  76%
  |                                                                       
  |==================================================               |  77%
  |                                                                       
  |==================================================               |  78%
  |                                                                       
  |===================================================              |  78%
  |                                                                       
  |===================================================              |  79%
  |                                                                       
  |====================================================             |  79%
  |                                                                       
  |====================================================             |  80%
  |                                                                       
  |====================================================             |  81%
  |                                                                       
  |=====================================================            |  81%
  |                                                                       
  |=====================================================            |  82%
  |                                                                       
  |======================================================           |  82%
  |                                                                       
  |======================================================           |  83%
  |                                                                       
  |======================================================           |  84%
  |                                                                       
  |=======================================================          |  84%
  |                                                                       
  |=======================================================          |  85%
  |                                                                       
  |========================================================         |  85%
  |                                                                       
  |========================================================         |  86%
  |                                                                       
  |========================================================         |  87%
  |                                                                       
  |=========================================================        |  87%
  |                                                                       
  |=========================================================        |  88%
  |                                                                       
  |==========================================================       |  88%
  |                                                                       
  |==========================================================       |  89%
  |                                                                       
  |==========================================================       |  90%
  |                                                                       
  |===========================================================      |  90%
  |                                                                       
  |===========================================================      |  91%
  |                                                                       
  |===========================================================      |  92%
  |                                                                       
  |============================================================     |  92%
  |                                                                       
  |============================================================     |  93%
  |                                                                       
  |=============================================================    |  93%
  |                                                                       
  |=============================================================    |  94%
  |                                                                       
  |=============================================================    |  95%
  |                                                                       
  |==============================================================   |  95%
  |                                                                       
  |==============================================================   |  96%
  |                                                                       
  |===============================================================  |  96%
  |                                                                       
  |===============================================================  |  97%
  |                                                                       
  |===============================================================  |  98%
  |                                                                       
  |================================================================ |  98%
  |                                                                       
  |================================================================ |  99%
  |                                                                       
  |=================================================================|  99%
  |                                                                       
  |=================================================================| 100%
BCTboot2 &lt;- bootnet::bootnet(nwBCT2, nBoots = 2500)
## Estimating sample network...
## Estimating Network. Using package::function:
##   - qgraph::EBICglasso for EBIC model selection
##     - using glasso::glasso
##   - qgraph::cor_auto for correlation computation
##     - using lavaan::lavCor
## Variables detected as ordinal: plan.by.other; reminder.of.plan; subgoals; new.PA.options; PA.identity; PA.life.values; positive.consequences; goal.contrast; relevance.of.PA; changes.at.home; social.support
## Bootstrapping...
## 
  |                                                                       
  |                                                                 |   0%
  |                                                                       
  |                                                                 |   1%
  |                                                                       
  |=                                                                |   1%
  |                                                                       
  |=                                                                |   2%
  |                                                                       
  |==                                                               |   2%
  |                                                                       
  |==                                                               |   3%
  |                                                                       
  |==                                                               |   4%
  |                                                                       
  |===                                                              |   4%
  |                                                                       
  |===                                                              |   5%
  |                                                                       
  |====                                                             |   5%
  |                                                                       
  |====                                                             |   6%
  |                                                                       
  |====                                                             |   7%
  |                                                                       
  |=====                                                            |   7%
  |                                                                       
  |=====                                                            |   8%
  |                                                                       
  |======                                                           |   8%
  |                                                                       
  |======                                                           |   9%
  |                                                                       
  |======                                                           |  10%
  |                                                                       
  |=======                                                          |  10%
  |                                                                       
  |=======                                                          |  11%
  |                                                                       
  |=======                                                          |  12%
  |                                                                       
  |========                                                         |  12%
  |                                                                       
  |========                                                         |  13%
  |                                                                       
  |=========                                                        |  13%
  |                                                                       
  |=========                                                        |  14%
  |                                                                       
  |=========                                                        |  15%
  |                                                                       
  |==========                                                       |  15%
  |                                                                       
  |==========                                                       |  16%
  |                                                                       
  |===========                                                      |  16%
  |                                                                       
  |===========                                                      |  17%
  |                                                                       
  |===========                                                      |  18%
  |                                                                       
  |============                                                     |  18%
  |                                                                       
  |============                                                     |  19%
  |                                                                       
  |=============                                                    |  19%
  |                                                                       
  |=============                                                    |  20%
  |                                                                       
  |=============                                                    |  21%
  |                                                                       
  |==============                                                   |  21%
  |                                                                       
  |==============                                                   |  22%
  |                                                                       
  |===============                                                  |  22%
  |                                                                       
  |===============                                                  |  23%
  |                                                                       
  |===============                                                  |  24%
  |                                                                       
  |================                                                 |  24%
  |                                                                       
  |================                                                 |  25%
  |                                                                       
  |=================                                                |  25%
  |                                                                       
  |=================                                                |  26%
  |                                                                       
  |=================                                                |  27%
  |                                                                       
  |==================                                               |  27%
  |                                                                       
  |==================                                               |  28%
  |                                                                       
  |===================                                              |  28%
  |                                                                       
  |===================                                              |  29%
  |                                                                       
  |===================                                              |  30%
  |                                                                       
  |====================                                             |  30%
  |                                                                       
  |====================                                             |  31%
  |                                                                       
  |====================                                             |  32%
  |                                                                       
  |=====================                                            |  32%
  |                                                                       
  |=====================                                            |  33%
  |                                                                       
  |======================                                           |  33%
  |                                                                       
  |======================                                           |  34%
  |                                                                       
  |======================                                           |  35%
  |                                                                       
  |=======================                                          |  35%
  |                                                                       
  |=======================                                          |  36%
  |                                                                       
  |========================                                         |  36%
  |                                                                       
  |========================                                         |  37%
  |                                                                       
  |========================                                         |  38%
  |                                                                       
  |=========================                                        |  38%
  |                                                                       
  |=========================                                        |  39%
  |                                                                       
  |==========================                                       |  39%
  |                                                                       
  |==========================                                       |  40%
  |                                                                       
  |==========================                                       |  41%
  |                                                                       
  |===========================                                      |  41%
  |                                                                       
  |===========================                                      |  42%
  |                                                                       
  |============================                                     |  42%
  |                                                                       
  |============================                                     |  43%
  |                                                                       
  |============================                                     |  44%
  |                                                                       
  |=============================                                    |  44%
  |                                                                       
  |=============================                                    |  45%
  |                                                                       
  |==============================                                   |  45%
  |                                                                       
  |==============================                                   |  46%
  |                                                                       
  |==============================                                   |  47%
  |                                                                       
  |===============================                                  |  47%
  |                                                                       
  |===============================                                  |  48%
  |                                                                       
  |================================                                 |  48%
  |                                                                       
  |================================                                 |  49%
  |                                                                       
  |================================                                 |  50%
  |                                                                       
  |=================================                                |  50%
  |                                                                       
  |=================================                                |  51%
  |                                                                       
  |=================================                                |  52%
  |                                                                       
  |==================================                               |  52%
  |                                                                       
  |==================================                               |  53%
  |                                                                       
  |===================================                              |  53%
  |                                                                       
  |===================================                              |  54%
  |                                                                       
  |===================================                              |  55%
  |                                                                       
  |====================================                             |  55%
  |                                                                       
  |====================================                             |  56%
  |                                                                       
  |=====================================                            |  56%
  |                                                                       
  |=====================================                            |  57%
  |                                                                       
  |=====================================                            |  58%
  |                                                                       
  |======================================                           |  58%
  |                                                                       
  |======================================                           |  59%
  |                                                                       
  |=======================================                          |  59%
  |                                                                       
  |=======================================                          |  60%
  |                                                                       
  |=======================================                          |  61%
  |                                                                       
  |========================================                         |  61%
  |                                                                       
  |========================================                         |  62%
  |                                                                       
  |=========================================                        |  62%
  |                                                                       
  |=========================================                        |  63%
  |                                                                       
  |=========================================                        |  64%
  |                                                                       
  |==========================================                       |  64%
  |                                                                       
  |==========================================                       |  65%
  |                                                                       
  |===========================================                      |  65%
  |                                                                       
  |===========================================                      |  66%
  |                                                                       
  |===========================================                      |  67%
  |                                                                       
  |============================================                     |  67%
  |                                                                       
  |============================================                     |  68%
  |                                                                       
  |=============================================                    |  68%
  |                                                                       
  |=============================================                    |  69%
  |                                                                       
  |=============================================                    |  70%
  |                                                                       
  |==============================================                   |  70%
  |                                                                       
  |==============================================                   |  71%
  |                                                                       
  |==============================================                   |  72%
  |                                                                       
  |===============================================                  |  72%
  |                                                                       
  |===============================================                  |  73%
  |                                                                       
  |================================================                 |  73%
  |                                                                       
  |================================================                 |  74%
  |                                                                       
  |================================================                 |  75%
  |                                                                       
  |=================================================                |  75%
  |                                                                       
  |=================================================                |  76%
  |                                                                       
  |==================================================               |  76%
  |                                                                       
  |==================================================               |  77%
  |                                                                       
  |==================================================               |  78%
  |                                                                       
  |===================================================              |  78%
  |                                                                       
  |===================================================              |  79%
  |                                                                       
  |====================================================             |  79%
  |                                                                       
  |====================================================             |  80%
  |                                                                       
  |====================================================             |  81%
  |                                                                       
  |=====================================================            |  81%
  |                                                                       
  |=====================================================            |  82%
  |                                                                       
  |======================================================           |  82%
  |                                                                       
  |======================================================           |  83%
  |                                                                       
  |======================================================           |  84%
  |                                                                       
  |=======================================================          |  84%
  |                                                                       
  |=======================================================          |  85%
  |                                                                       
  |========================================================         |  85%
  |                                                                       
  |========================================================         |  86%
  |                                                                       
  |========================================================         |  87%
  |                                                                       
  |=========================================================        |  87%
  |                                                                       
  |=========================================================        |  88%
  |                                                                       
  |==========================================================       |  88%
  |                                                                       
  |==========================================================       |  89%
  |                                                                       
  |==========================================================       |  90%
  |                                                                       
  |===========================================================      |  90%
  |                                                                       
  |===========================================================      |  91%
  |                                                                       
  |===========================================================      |  92%
  |                                                                       
  |============================================================     |  92%
  |                                                                       
  |============================================================     |  93%
  |                                                                       
  |=============================================================    |  93%
  |                                                                       
  |=============================================================    |  94%
  |                                                                       
  |=============================================================    |  95%
  |                                                                       
  |==============================================================   |  95%
  |                                                                       
  |==============================================================   |  96%
  |                                                                       
  |===============================================================  |  96%
  |                                                                       
  |===============================================================  |  97%
  |                                                                       
  |===============================================================  |  98%
  |                                                                       
  |================================================================ |  98%
  |                                                                       
  |================================================================ |  99%
  |                                                                       
  |=================================================================|  99%
  |                                                                       
  |=================================================================| 100%
## Computing statistics...
## 
  |                                                                       
  |                                                                 |   0%
  |                                                                       
  |                                                                 |   1%
  |                                                                       
  |=                                                                |   1%
  |                                                                       
  |=                                                                |   2%
  |                                                                       
  |==                                                               |   2%
  |                                                                       
  |==                                                               |   3%
  |                                                                       
  |==                                                               |   4%
  |                                                                       
  |===                                                              |   4%
  |                                                                       
  |===                                                              |   5%
  |                                                                       
  |====                                                             |   5%
  |                                                                       
  |====                                                             |   6%
  |                                                                       
  |====                                                             |   7%
  |                                                                       
  |=====                                                            |   7%
  |                                                                       
  |=====                                                            |   8%
  |                                                                       
  |======                                                           |   8%
  |                                                                       
  |======                                                           |   9%
  |                                                                       
  |======                                                           |  10%
  |                                                                       
  |=======                                                          |  10%
  |                                                                       
  |=======                                                          |  11%
  |                                                                       
  |=======                                                          |  12%
  |                                                                       
  |========                                                         |  12%
  |                                                                       
  |========                                                         |  13%
  |                                                                       
  |=========                                                        |  13%
  |                                                                       
  |=========                                                        |  14%
  |                                                                       
  |=========                                                        |  15%
  |                                                                       
  |==========                                                       |  15%
  |                                                                       
  |==========                                                       |  16%
  |                                                                       
  |===========                                                      |  16%
  |                                                                       
  |===========                                                      |  17%
  |                                                                       
  |===========                                                      |  18%
  |                                                                       
  |============                                                     |  18%
  |                                                                       
  |============                                                     |  19%
  |                                                                       
  |=============                                                    |  19%
  |                                                                       
  |=============                                                    |  20%
  |                                                                       
  |=============                                                    |  21%
  |                                                                       
  |==============                                                   |  21%
  |                                                                       
  |==============                                                   |  22%
  |                                                                       
  |===============                                                  |  22%
  |                                                                       
  |===============                                                  |  23%
  |                                                                       
  |===============                                                  |  24%
  |                                                                       
  |================                                                 |  24%
  |                                                                       
  |================                                                 |  25%
  |                                                                       
  |=================                                                |  25%
  |                                                                       
  |=================                                                |  26%
  |                                                                       
  |=================                                                |  27%
  |                                                                       
  |==================                                               |  27%
  |                                                                       
  |==================                                               |  28%
  |                                                                       
  |===================                                              |  28%
  |                                                                       
  |===================                                              |  29%
  |                                                                       
  |===================                                              |  30%
  |                                                                       
  |====================                                             |  30%
  |                                                                       
  |====================                                             |  31%
  |                                                                       
  |====================                                             |  32%
  |                                                                       
  |=====================                                            |  32%
  |                                                                       
  |=====================                                            |  33%
  |                                                                       
  |======================                                           |  33%
  |                                                                       
  |======================                                           |  34%
  |                                                                       
  |======================                                           |  35%
  |                                                                       
  |=======================                                          |  35%
  |                                                                       
  |=======================                                          |  36%
  |                                                                       
  |========================                                         |  36%
  |                                                                       
  |========================                                         |  37%
  |                                                                       
  |========================                                         |  38%
  |                                                                       
  |=========================                                        |  38%
  |                                                                       
  |=========================                                        |  39%
  |                                                                       
  |==========================                                       |  39%
  |                                                                       
  |==========================                                       |  40%
  |                                                                       
  |==========================                                       |  41%
  |                                                                       
  |===========================                                      |  41%
  |                                                                       
  |===========================                                      |  42%
  |                                                                       
  |============================                                     |  42%
  |                                                                       
  |============================                                     |  43%
  |                                                                       
  |============================                                     |  44%
  |                                                                       
  |=============================                                    |  44%
  |                                                                       
  |=============================                                    |  45%
  |                                                                       
  |==============================                                   |  45%
  |                                                                       
  |==============================                                   |  46%
  |                                                                       
  |==============================                                   |  47%
  |                                                                       
  |===============================                                  |  47%
  |                                                                       
  |===============================                                  |  48%
  |                                                                       
  |================================                                 |  48%
  |                                                                       
  |================================                                 |  49%
  |                                                                       
  |================================                                 |  50%
  |                                                                       
  |=================================                                |  50%
  |                                                                       
  |=================================                                |  51%
  |                                                                       
  |=================================                                |  52%
  |                                                                       
  |==================================                               |  52%
  |                                                                       
  |==================================                               |  53%
  |                                                                       
  |===================================                              |  53%
  |                                                                       
  |===================================                              |  54%
  |                                                                       
  |===================================                              |  55%
  |                                                                       
  |====================================                             |  55%
  |                                                                       
  |====================================                             |  56%
  |                                                                       
  |=====================================                            |  56%
  |                                                                       
  |=====================================                            |  57%
  |                                                                       
  |=====================================                            |  58%
  |                                                                       
  |======================================                           |  58%
  |                                                                       
  |======================================                           |  59%
  |                                                                       
  |=======================================                          |  59%
  |                                                                       
  |=======================================                          |  60%
  |                                                                       
  |=======================================                          |  61%
  |                                                                       
  |========================================                         |  61%
  |                                                                       
  |========================================                         |  62%
  |                                                                       
  |=========================================                        |  62%
  |                                                                       
  |=========================================                        |  63%
  |                                                                       
  |=========================================                        |  64%
  |                                                                       
  |==========================================                       |  64%
  |                                                                       
  |==========================================                       |  65%
  |                                                                       
  |===========================================                      |  65%
  |                                                                       
  |===========================================                      |  66%
  |                                                                       
  |===========================================                      |  67%
  |                                                                       
  |============================================                     |  67%
  |                                                                       
  |============================================                     |  68%
  |                                                                       
  |=============================================                    |  68%
  |                                                                       
  |=============================================                    |  69%
  |                                                                       
  |=============================================                    |  70%
  |                                                                       
  |==============================================                   |  70%
  |                                                                       
  |==============================================                   |  71%
  |                                                                       
  |==============================================                   |  72%
  |                                                                       
  |===============================================                  |  72%
  |                                                                       
  |===============================================                  |  73%
  |                                                                       
  |================================================                 |  73%
  |                                                                       
  |================================================                 |  74%
  |                                                                       
  |================================================                 |  75%
  |                                                                       
  |=================================================                |  75%
  |                                                                       
  |=================================================                |  76%
  |                                                                       
  |==================================================               |  76%
  |                                                                       
  |==================================================               |  77%
  |                                                                       
  |==================================================               |  78%
  |                                                                       
  |===================================================              |  78%
  |                                                                       
  |===================================================              |  79%
  |                                                                       
  |====================================================             |  79%
  |                                                                       
  |====================================================             |  80%
  |                                                                       
  |====================================================             |  81%
  |                                                                       
  |=====================================================            |  81%
  |                                                                       
  |=====================================================            |  82%
  |                                                                       
  |======================================================           |  82%
  |                                                                       
  |======================================================           |  83%
  |                                                                       
  |======================================================           |  84%
  |                                                                       
  |=======================================================          |  84%
  |                                                                       
  |=======================================================          |  85%
  |                                                                       
  |========================================================         |  85%
  |                                                                       
  |========================================================         |  86%
  |                                                                       
  |========================================================         |  87%
  |                                                                       
  |=========================================================        |  87%
  |                                                                       
  |=========================================================        |  88%
  |                                                                       
  |==========================================================       |  88%
  |                                                                       
  |==========================================================       |  89%
  |                                                                       
  |==========================================================       |  90%
  |                                                                       
  |===========================================================      |  90%
  |                                                                       
  |===========================================================      |  91%
  |                                                                       
  |===========================================================      |  92%
  |                                                                       
  |============================================================     |  92%
  |                                                                       
  |============================================================     |  93%
  |                                                                       
  |=============================================================    |  93%
  |                                                                       
  |=============================================================    |  94%
  |                                                                       
  |=============================================================    |  95%
  |                                                                       
  |==============================================================   |  95%
  |                                                                       
  |==============================================================   |  96%
  |                                                                       
  |===============================================================  |  96%
  |                                                                       
  |===============================================================  |  97%
  |                                                                       
  |===============================================================  |  98%
  |                                                                       
  |================================================================ |  98%
  |                                                                       
  |================================================================ |  99%
  |                                                                       
  |=================================================================|  99%
  |                                                                       
  |=================================================================| 100%

plot(BCTboot1, labels = TRUE, order = &quot;sample&quot;)</code></pre>
<p><img src="baseline-networks_files/figure-html/bct-robustness-3.png" width="2100" /></p>
<pre class="r"><code>plot(BCTboot2, labels = TRUE, order = &quot;sample&quot;)</code></pre>
<p><img src="baseline-networks_files/figure-html/bct-robustness-4.png" width="2100" /></p>
<pre class="r"><code>
autEdges &lt;- summary(BCTboot1, statistics = &quot;edge&quot;, rank = TRUE) %&gt;% 
  dplyr::arrange(mean) %&gt;% 
  dplyr::filter(stringr::str_detect(node1, &#39;Autonomous&#39;)) %&gt;% # str_detect(id, &#39;Autonomous|Controlled&#39;) for both
  dplyr::filter(!(node2 == &#39;Controlled&#39;)) %&gt;% 
  data.frame() %&gt;% 
  select(CIlower, mean, CIupper, node2)

contEdges &lt;- summary(BCTboot1, statistics = &quot;edge&quot;, rank = TRUE) %&gt;% 
  dplyr::arrange(mean) %&gt;% 
  dplyr::filter(stringr::str_detect(node1, &#39;Controlled&#39;)) %&gt;% # str_detect(id, &#39;Autonomous|Controlled&#39;) for both
  data.frame() %&gt;% 
  select(CIlower, mean, CIupper, node2)

diamondPlot(autEdges, 
            ciCols = c(&quot;CIlower&quot;, &quot;mean&quot;, &quot;CIupper&quot;), 
            color = viridis(2, end = 0.8)[1], 
            alpha = 0.3, 
            yLabels = autEdges$node2, 
            fixedSize = 0.3, 
            xlab = NULL) +
  userfriendlyscience::diamondPlot(contEdges, 
              ciCols = c(&quot;CIlower&quot;, &quot;mean&quot;, &quot;CIupper&quot;), 
              color = viridis(2, end = 0.8)[2], 
              alpha = 0.3, 
              yLabels = autEdges$node2, 
              fixedSize = 0.3, 
              xlab = NULL, 
              returnLayerOnly = TRUE) +
  geom_rect(aes(xmin=Inf, xmax=Inf, ymin=Inf, ymax=Inf, fill = &quot;Controlled&quot;), 
            colour=NA, alpha=0.05) + # Create invisible rectangle for legend
  geom_rect(aes(xmin=Inf, xmax=Inf, ymin=Inf, ymax=Inf, fill = &quot;Autonomous&quot;), 
            colour=NA, alpha=0.05) + # Create invisible rectangle for legend
  scale_fill_manual(&#39;Connected node&#39;,
                      values = viridis(2, end = 0.8)[1:2],  
                      guide = guide_legend(override.aes = list(alpha = 1))) +
  ggtitle(&quot;Relative strengths of edges containing autonomous \nor controlled motivation (all items)&quot;)</code></pre>
<p><img src="baseline-networks_files/figure-html/bct-robustness-5.png" width="2100" /></p>
<pre class="r"><code>  
# Combined items

autEdges &lt;- summary(BCTboot2, statistics = &quot;edge&quot;, rank = TRUE) %&gt;% 
  dplyr::arrange(mean) %&gt;% 
  dplyr::filter(stringr::str_detect(node1, &#39;Autonomous&#39;)) %&gt;% # str_detect(id, &#39;Autonomous|Controlled&#39;) for both
  dplyr::filter(!(node2 == &#39;Controlled&#39;)) %&gt;% 
  data.frame() %&gt;% 
  select(CIlower, mean, CIupper, node2)

contEdges &lt;- summary(BCTboot2, statistics = &quot;edge&quot;, rank = TRUE) %&gt;% 
  dplyr::arrange(mean) %&gt;% 
  dplyr::filter(stringr::str_detect(node1, &#39;Controlled&#39;)) %&gt;% # str_detect(id, &#39;Autonomous|Controlled&#39;) for both
  data.frame() %&gt;% 
  select(CIlower, mean, CIupper, node2)

diamondPlot(autEdges, 
            ciCols = c(&quot;CIlower&quot;, &quot;mean&quot;, &quot;CIupper&quot;), 
            color = viridis(2, end = 0.8)[1], 
            alpha = 0.3, 
            yLabels = autEdges$node2, 
            fixedSize = 0.3, 
            xlab = NULL) +
  userfriendlyscience::diamondPlot(contEdges, 
              ciCols = c(&quot;CIlower&quot;, &quot;mean&quot;, &quot;CIupper&quot;), 
              color = viridis(2, end = 0.8)[2], 
              alpha = 0.3, 
              yLabels = autEdges$node2, 
              fixedSize = 0.3, 
              xlab = NULL, 
              returnLayerOnly = TRUE) +
  geom_rect(aes(xmin=Inf, xmax=Inf, ymin=Inf, ymax=Inf, fill = &quot;Controlled&quot;), 
            colour=NA, alpha=0.05) + # Create invisible rectangle for legend
  geom_rect(aes(xmin=Inf, xmax=Inf, ymin=Inf, ymax=Inf, fill = &quot;Autonomous&quot;), 
            colour=NA, alpha=0.05) + # Create invisible rectangle for legend
  scale_fill_manual(&#39;Connected node&#39;,
                      values = viridis(2, end = 0.8)[1:2],  
                      guide = guide_legend(override.aes = list(alpha = 1))) +
  ggtitle(&quot;Relative strengths of edges containing autonomous \nor controlled motivation (combined items)&quot;)</code></pre>
<p><img src="baseline-networks_files/figure-html/bct-robustness-6.png" width="2100" /></p>
<pre class="r"><code>
# summary(BCTboot1, statistics = &quot;edge&quot;, rank = TRUE) %&gt;% 
#   dplyr::arrange(mean) %&gt;% 
#   dplyr::filter(stringr::str_detect(id, &#39;Controlled&#39;)) %&gt;%
#   data.frame() %&gt;% 
#   select(CIlower, mean, CIupper, id) %&gt;% 
#   userfriendlyscience::diamondPlot(ciCols = c(&quot;CIlower&quot;, &quot;mean&quot;, &quot;CIupper&quot;), ylabels = id)</code></pre>
</div>
<div id="bct-sdt-regression-analyses" class="section level4">
<h4>BCT-SDT Regression analyses</h4>
<p>Here’s the classical linear model.</p>
<pre class="r"><code>library(broom)

bctdf &lt;- df %&gt;% dplyr::select(id,
  intervention,
  group,
  school,
  girl,
  &#39;Autonomous&#39; = PA_autonomous_T1,
  &#39;Controlled&#39; = PA_controlled_T1,
  &#39;Intrinsic&#39; = PA_intrinsic_T1,
  &#39;Identified&#39; = PA_identified_T1,
  &#39;Integrated&#39; = PA_integrated_T1,
  &#39;Introjected&#39; = PA_introjected_T1,
  &#39;Extrinsic&#39; = PA_extrinsic_T1,
  &#39;goal setting&#39; = PA_agrbct_01_T1,
  &#39;implementation plan&#39; = PA_agrbct_02_T1,
  &#39;plan by other&#39; = PA_agrbct_03_T1,
  &#39;reminder of plan&#39; = PA_agrbct_04_T1,
  &#39;subgoals&#39; = PA_agrbct_05_T1,
  &#39;new PA options&#39; = PA_agrbct_06_T1,
  &#39;barrier identification&#39; = PA_agrbct_07_T1,
  &#39;coping planning&#39; = PA_agrbct_08_T1,
  &#39;PA identity&#39; = PA_agrbct_09_T1,
  &#39;PA life values&#39; = PA_agrbct_10_T1,
  &#39;positive consequences&#39; = PA_frqbct_01_T1,
  &#39;log on paper&#39; = PA_frqbct_02_T1,
  &#39;smartphone&#39; = PA_frqbct_03_T1,
#  &#39;mnemonic cues&#39; = PA_frqbct_04_T1,
  &#39;goal contrast&#39; = PA_frqbct_05_T1,
  &#39;relevance of PA&#39; = PA_frqbct_06_T1,
  &#39;changes at home&#39; = PA_frqbct_07_T1,
  &#39;social support&#39; = PA_frqbct_08_T1,
  &#39;failure contemplated&#39; = PA_frqbct_09_T1) %&gt;%
  rowwise() %&gt;% 
  mutate( 
  #&#39;has plan&#39; = mean(c(`implementation plan`, `plan by other`), na.rm = TRUE),
  &#39;monitored PA&#39; = mean(c(`log on paper`, `smartphone`), na.rm = TRUE)) %&gt;%
  select(-`log on paper`, -`smartphone`) %&gt;% 
  data.frame # %&gt;% 
  # mutate_all(as.numeric)

outcomevars &lt;- c(&#39;Autonomous&#39;, 
  &#39;Controlled&#39;, 
  &#39;Intrinsic&#39;,
  &#39;Identified&#39;, 
  &#39;Integrated&#39;, 
  &#39;Introjected&#39;,
  &#39;Extrinsic&#39;)

for (i in outcomevars) {
m &lt;- lm(paste0(i, &quot; ~ 
  goal.setting +
  implementation.plan +
  plan.by.other +
  reminder.of.plan +
  subgoals +
  new.PA.options +
  barrier.identification +
  coping.planning +
  PA.identity +
  PA.life.values +
  positive.consequences&quot;), 
  data = bctdf)

cat(&quot;\n\nEstimates for&quot;, i, &quot;regulation&quot;, sep = &quot; &quot;)
summary(m) %&gt;% broom::tidy() %&gt;% dplyr::arrange(desc(estimate)) %&gt;% apa_table() 
}
## 
## 
## Estimates for Autonomous regulation&lt;caption&gt;(\#tab:unnamed-chunk-8)&lt;/caption&gt;
## 
## &lt;caption&gt;**&lt;/caption&gt;
## 
## 
## 
## term                     estimate   std.error   statistic   p.value 
## -----------------------  ---------  ----------  ----------  --------
## (Intercept)              1.59       0.07        22.97       0.00    
## positive.consequences    0.12       0.02        6.52        0.00    
## PA.life.values           0.11       0.02        5.05        0.00    
## goal.setting             0.10       0.02        5.23        0.00    
## plan.by.other            0.09       0.02        5.45        0.00    
## new.PA.options           0.08       0.02        4.57        0.00    
## implementation.plan      0.05       0.02        2.48        0.01    
## PA.identity              0.02       0.02        1.03        0.30    
## subgoals                 0.01       0.02        0.27        0.78    
## coping.planning          -0.01      0.02        -0.24       0.81    
## barrier.identification   -0.01      0.02        -0.65       0.51    
## reminder.of.plan         -0.03      0.02        -1.41       0.16    
## 
## 
## Estimates for Controlled regulation&lt;caption&gt;(\#tab:unnamed-chunk-8)&lt;/caption&gt;
## 
## &lt;caption&gt;**&lt;/caption&gt;
## 
## 
## 
## term                     estimate   std.error   statistic   p.value 
## -----------------------  ---------  ----------  ----------  --------
## (Intercept)              1.36       0.07        19.32       0.00    
## PA.identity              0.07       0.02        3.08        0.00    
## barrier.identification   0.06       0.02        2.75        0.01    
## positive.consequences    0.05       0.02        2.69        0.01    
## reminder.of.plan         0.03       0.02        1.54        0.12    
## implementation.plan      0.03       0.02        1.15        0.25    
## subgoals                 0.01       0.02        0.26        0.80    
## coping.planning          0.00       0.02        0.20        0.84    
## plan.by.other            0.00       0.02        0.12        0.91    
## goal.setting             -0.01      0.02        -0.43       0.67    
## new.PA.options           -0.02      0.02        -1.00       0.32    
## PA.life.values           -0.07      0.02        -3.14       0.00    
## 
## 
## Estimates for Intrinsic regulation&lt;caption&gt;(\#tab:unnamed-chunk-8)&lt;/caption&gt;
## 
## &lt;caption&gt;**&lt;/caption&gt;
## 
## 
## 
## term                     estimate   std.error   statistic   p.value 
## -----------------------  ---------  ----------  ----------  --------
## (Intercept)              1.81       0.08        22.81       0.00    
## positive.consequences    0.12       0.02        5.83        0.00    
## goal.setting             0.12       0.02        5.15        0.00    
## PA.life.values           0.12       0.02        4.63        0.00    
## new.PA.options           0.09       0.02        4.49        0.00    
## plan.by.other            0.08       0.02        4.62        0.00    
## implementation.plan      0.06       0.02        2.43        0.02    
## PA.identity              0.02       0.02        0.62        0.53    
## subgoals                 -0.01      0.02        -0.32       0.75    
## barrier.identification   -0.01      0.03        -0.56       0.57    
## coping.planning          -0.02      0.03        -0.71       0.48    
## reminder.of.plan         -0.05      0.02        -2.17       0.03    
## 
## 
## Estimates for Identified regulation&lt;caption&gt;(\#tab:unnamed-chunk-8)&lt;/caption&gt;
## 
## &lt;caption&gt;**&lt;/caption&gt;
## 
## 
## 
## term                     estimate   std.error   statistic   p.value 
## -----------------------  ---------  ----------  ----------  --------
## (Intercept)              1.68       0.08        21.48       0.00    
## positive.consequences    0.13       0.02        6.52        0.00    
## PA.life.values           0.12       0.02        4.87        0.00    
## goal.setting             0.10       0.02        4.30        0.00    
## new.PA.options           0.07       0.02        3.75        0.00    
## plan.by.other            0.05       0.02        2.68        0.01    
## implementation.plan      0.04       0.02        1.84        0.07    
## coping.planning          0.02       0.03        0.61        0.54    
## PA.identity              0.01       0.02        0.58        0.56    
## subgoals                 0.01       0.02        0.34        0.74    
## reminder.of.plan         -0.02      0.02        -0.79       0.43    
## barrier.identification   -0.04      0.02        -1.65       0.10    
## 
## 
## Estimates for Integrated regulation&lt;caption&gt;(\#tab:unnamed-chunk-8)&lt;/caption&gt;
## 
## &lt;caption&gt;**&lt;/caption&gt;
## 
## 
## 
## term                     estimate   std.error   statistic   p.value 
## -----------------------  ---------  ----------  ----------  --------
## (Intercept)              1.30       0.08        16.13       0.00    
## plan.by.other            0.13       0.02        6.97        0.00    
## positive.consequences    0.10       0.02        4.60        0.00    
## goal.setting             0.10       0.02        4.22        0.00    
## PA.life.values           0.08       0.03        3.28        0.00    
## new.PA.options           0.07       0.02        3.62        0.00    
## implementation.plan      0.06       0.03        2.34        0.02    
## PA.identity              0.04       0.02        1.60        0.11    
## subgoals                 0.01       0.03        0.59        0.56    
## barrier.identification   0.01       0.03        0.31        0.76    
## reminder.of.plan         -0.01      0.02        -0.49       0.62    
## coping.planning          -0.01      0.03        -0.43       0.67    
## 
## 
## Estimates for Introjected regulation&lt;caption&gt;(\#tab:unnamed-chunk-8)&lt;/caption&gt;
## 
## &lt;caption&gt;**&lt;/caption&gt;
## 
## 
## 
## term                     estimate   std.error   statistic   p.value 
## -----------------------  ---------  ----------  ----------  --------
## (Intercept)              1.12       0.10        10.73       0.00    
## PA.identity              0.12       0.03        3.66        0.00    
## positive.consequences    0.10       0.03        3.56        0.00    
## barrier.identification   0.07       0.03        2.19        0.03    
## goal.setting             0.06       0.03        1.87        0.06    
## reminder.of.plan         0.04       0.03        1.23        0.22    
## implementation.plan      0.02       0.03        0.62        0.54    
## coping.planning          0.01       0.04        0.36        0.72    
## new.PA.options           -0.01      0.03        -0.42       0.68    
## subgoals                 -0.02      0.03        -0.47       0.64    
## plan.by.other            -0.03      0.02        -1.29       0.20    
## PA.life.values           -0.04      0.03        -1.32       0.19    
## 
## 
## Estimates for Extrinsic regulation&lt;caption&gt;(\#tab:unnamed-chunk-8)&lt;/caption&gt;
## 
## &lt;caption&gt;**&lt;/caption&gt;
## 
## 
## 
## term                     estimate   std.error   statistic   p.value 
## -----------------------  ---------  ----------  ----------  --------
## (Intercept)              1.53       0.07        20.85       0.00    
## barrier.identification   0.05       0.02        2.29        0.02    
## implementation.plan      0.03       0.02        1.35        0.18    
## PA.identity              0.03       0.02        1.30        0.19    
## reminder.of.plan         0.03       0.02        1.33        0.19    
## plan.by.other            0.02       0.02        1.42        0.16    
## positive.consequences    0.02       0.02        0.96        0.34    
## subgoals                 0.02       0.02        0.77        0.44    
## coping.planning          0.00       0.03        0.06        0.95    
## new.PA.options           -0.02      0.02        -1.20       0.23    
## goal.setting             -0.05      0.02        -2.44       0.01    
## PA.life.values           -0.09      0.02        -3.88       0.00</code></pre>
</div>
</div>
</div>
<div id="centrality-stability" class="section level2">
<h2>Centrality stability</h2>
<pre class="r"><code>boot2 &lt;- bootnet::bootnet(Network1, nBoots = 2500, type = &quot;case&quot;)
## Error in is(data, &quot;bootnetResult&quot;): object &#39;Network1&#39; not found
bootnet::corStability(boot2)
## Error in x$type %in% c(&quot;node&quot;, &quot;person&quot;): object &#39;boot2&#39; not found

plot(boot2)
## Error in plot(boot2): object &#39;boot2&#39; not found

differenceTest(boot1, &quot;auton&quot;, &quot;intent&quot;,  measure = c(&quot;strength&quot;, &quot;closeness&quot;, &quot;betweenness&quot;))
## Error in bootobject$type %in% c(&quot;nonparametric&quot;, &quot;parametric&quot;): object &#39;boot1&#39; not found

plot(boot1, &quot;edge&quot;, plot = &quot;difference&quot;, onlyNonZero = TRUE, order = &quot;sample&quot;)
## Error in plot(boot1, &quot;edge&quot;, plot = &quot;difference&quot;, onlyNonZero = TRUE, : object &#39;boot1&#39; not found

plot(boot1, &quot;strength&quot;)
## Error in plot(boot1, &quot;strength&quot;): object &#39;boot1&#39; not found
plot(boot1, &quot;betweenness&quot;)
## Error in plot(boot1, &quot;betweenness&quot;): object &#39;boot1&#39; not found
plot(boot1, &quot;closeness&quot;)
## Error in plot(boot1, &quot;closeness&quot;): object &#39;boot1&#39; not found</code></pre>
</div>
<div id="pa-determinants-unregularised-correlations-visualised" class="section level2">
<h2>PA determinants: unregularised correlations visualised</h2>
<pre class="r"><code># Network without motivation variables
data &lt;- df %&gt;% select(&#39;PA&#39; = paAccelerometer_T1, &#39;SB&#39; = sitLieAccelerometer_T1,
&#39;fat%&#39; = fatpct_T1,&#39;action planning&#39; = PA_actionplan_T1, &#39;coping planning&#39; = PA_copingplan_T1, &#39;frequency-related BCTs&#39; = PA_frqbct_T1, &#39;agreement-related BCTs&#39; = PA_agrbct_T1, &#39;amotivation&#39; = PA_amotivation_T1, &#39;autonomous motivation&#39; = PA_autonomous_T1, &#39;controlled motivation&#39; = PA_controlled_T1, &#39;descriptive norm&#39; = PA_dnorm_T1, &#39;injunctive norm&#39; = PA_inorm_T1, &#39;intention&#39; = PA_intention_T1, &#39;outcome expectations&#39; = PA_oexp_T1, &#39;self-efficacy / PBC&#39; = PA_sePbc_T1, &#39;perceived opportunities&#39; = PA_opportunities_T1) %&gt;% 
  data.frame
## Error in overscope_eval_next(overscope, expr): object &#39;PA_oexp_T1&#39; not found

names &lt;- df %&gt;% select(&#39;PA&#39; = paAccelerometer_T1, &#39;SB&#39; = sitLieAccelerometer_T1,
&#39;fat%&#39; = fatpct_T1,&#39;action planning&#39; = PA_actionplan_T1, &#39;coping planning&#39; = PA_copingplan_T1, &#39;frequency-related BCTs&#39; = PA_frqbct_T1, &#39;agreement-related BCTs&#39; = PA_agrbct_T1, &#39;amotivation&#39; = PA_amotivation_T1, &#39;autonomous motivation&#39; = PA_autonomous_T1, &#39;controlled motivation&#39; = PA_controlled_T1, &#39;descriptive norm&#39; = PA_dnorm_T1, &#39;injunctive norm&#39; = PA_inorm_T1, &#39;intention&#39; = PA_intention_T1, &#39;outcome expectations&#39; = PA_oexp_T1, &#39;self-efficacy / PBC&#39; = PA_sePbc_T1, &#39;perceived opportunities&#39; = PA_opportunities_T1) %&gt;% names
## Error in overscope_eval_next(overscope, expr): object &#39;PA_oexp_T1&#39; not found

# Spinglass algorithm detects communities. Tutorial here: http://psych-networks.com/r-tutorial-identify-communities-items-networks/

cormatrix &lt;- cor_auto(data) 
## Warning in is.na(x): is.na() applied to non-(list or vector) of type
## &#39;symbol&#39;
## Warning in is.na(x): is.na() applied to non-(list or vector) of type
## &#39;language&#39;
## Error in data[, sapply(data, function(x) mean(is.na(x))) != 1]: object of type &#39;closure&#39; is not subsettable

graph1 &lt;- qgraph(cormatrix, layout=&quot;spring&quot;, sampleSize = nrow(data),
              vsize=7, cut=0, maximum=.45, border.width=1.5)
## Error in qgraph(cormatrix, layout = &quot;spring&quot;, sampleSize = nrow(data), : object &#39;cormatrix&#39; not found

g &lt;- as.igraph(graph1, attributes = TRUE)
## Error in as.igraph(graph1, attributes = TRUE): object &#39;graph1&#39; not found

matrix_spinglass &lt;- matrix(NA, nrow=1,ncol=100)
 
for (i in 1:100) {
set.seed(i)
spinglass &lt;- spinglass.community(g)
matrix_spinglass[1,i] &lt;- max(spinglass$membership) 
}
## Error in spinglass.community(g): object &#39;g&#39; not found

set.seed(1)

sgc &lt;- spinglass.community(g)
## Error in &quot;igraph&quot; %in% class(graph): object &#39;g&#39; not found

communities &lt;- data.frame(sgc$membership, &#39;node number&#39; = 1:ncol(data))
## Error in data.frame(sgc$membership, `node number` = 1:ncol(data)): object &#39;sgc&#39; not found

group.spinglass &lt;- list(communities$node.number[communities$sgc.membership == 1], 
                       communities$node.number[communities$sgc.membership == 2])
## Error in communities$node.number: object of type &#39;closure&#39; is not subsettable

piefill &lt;- data %&gt;%
  summarise_all(funs(mean(., na.rm = TRUE))) %&gt;% 
  mutate_at(vars(PA, SB),
            funs(. / (24*60))) %&gt;% # proportion of day used doing the behaviour
  mutate_at(vars(action.planning, coping.planning),
            funs(. / 4)) %&gt;% 
  mutate_at(vars(6:ncol(data)),
            funs(. / 7)) %&gt;% 
  mutate_at(vars(fat.),
            funs(. / 100))  
## Error in UseMethod(&quot;tbl_vars&quot;): no applicable method for &#39;tbl_vars&#39; applied to an object of class &quot;function&quot;

qgraph(graph1, layout = &quot;spring&quot;, labels = TRUE, groups = group.spinglass, 
     color=c(&quot;olivedrab2&quot;, &quot;orange&quot;, &quot;lightblue&quot;),
     label.cex = 0.75,
     label.scale = TRUE,
     pie = piefill, 
     color = &quot;skyblue&quot;,
     nodeNames = names,
     pieBorder = 1,
     legend.cex = 0.4)
## Error in qgraph(graph1, layout = &quot;spring&quot;, labels = TRUE, groups = group.spinglass, : object &#39;graph1&#39; not found


# plot(nwAll, groups = itemGroups, nodeNames = itemNames, legend.cex = 0.25)



lmi %&gt;% select(Kys0016.1, Kys0013.1) %&gt;% group_by(Kys0016.1) %&gt;% summarise(n = n())
## # A tibble: 6 x 2
##   Kys0016.1     n
##   &lt;dbl+lbl&gt; &lt;int&gt;
## 1      0       34
## 2      1.00   163
## 3      2.00   274
## 4      3.00   211
## 5      4.00   402
## 6     NA       81

lmi %&gt;% count(Kys0016.1, Kys0013.1) %&gt;% group_by(Kys0016.1)
## # A tibble: 11 x 3
## # Groups: Kys0016.1 [6]
##    Kys0016.1 Kys0013.1     n
##    &lt;dbl+lbl&gt; &lt;dbl+lbl&gt; &lt;int&gt;
##  1      0         1.00    16
##  2      0         2.00    18
##  3      1.00      1.00   137
##  4      1.00      2.00    26
##  5      2.00      1.00   164
##  6      2.00      2.00   110
##  7      3.00      1.00    83
##  8      3.00      2.00   128
##  9      4.00      1.00    71
## 10      4.00      2.00   331
## 11     NA        NA       81</code></pre>
<!-- Out of a hundred iterations, spinglass algorithm found `  table(matrix_spinglass)[[1]]` instances of ` table(matrix_spinglass)[1] %>% names` communities, `  table(matrix_spinglass)[[2]]` instances of `  table(matrix_spinglass)[2] %>% names` communities, and `  table(matrix_spinglass)[[3]]` instances of `  table(matrix_spinglass)[3] %>% names` communities. Thus, a random seed which found four communities was chosen.   -->
</div>
<div id="symptom-network-all" class="section level2">
<h2>Symptom network: all</h2>
<pre class="r"><code>
sympdf &lt;- df %&gt;% dplyr::select(id,
  intervention,
  group,
  school,
  girl,
  &quot;Neck and shoulder pain&quot; = symptom_neckShoulderPain_T1,
  &quot;Lower back pain&quot; = symptom_lowerBackPain_T1,
  &quot;Stomach ache&quot; = symptom_stomachAche_T1,
  &quot;Tension or nervousness&quot; = symptom_tensionNervousness_T1,
  &quot;Irritability or anger bursts&quot; = symptom_irritabilityAngerbursts_T1,
  &quot;Difficulty with sleep&quot; = symptom_sleepDifficulty_T1,
  &quot;Headache&quot; = symptom_headAche_T1,
  &quot;Tiredness or faintness&quot; = symptom_tirednessFaintness_T1,
  &quot;Fat pct&quot; = fatpct_T1,
  &quot;PA&quot; = paAccelerometer_T1,
  &quot;SB&quot; = sitLieAccelerometer_T1
) %&gt;% 
  mutate(
    &#39;Neck and shoulder pain&#39; = ifelse(`Neck and shoulder pain` == 1, 0, 1),
    &#39;Lower back pain&#39; = ifelse(`Lower back pain` == 1, 0, 1),
    &#39;Stomach ache&#39; = ifelse(`Stomach ache` == 1, 0, 1),
    &#39;Tension or nervousness&#39; = ifelse(`Tension or nervousness` == 1, 0, 1),
    &#39;Irritability or anger bursts&#39; = ifelse(`Irritability or anger bursts` == 1, 0, 1),
    &#39;Difficulty with sleep&#39; = ifelse(`Difficulty with sleep` == 1, 0, 1),
    &#39;Headache&#39; = ifelse(`Headache` == 1, 0, 1),
    &#39;Tiredness or faintness&#39; = ifelse(`Tiredness or faintness` == 1, 0, 1),
    &#39;Fat pct&#39; = `Fat pct` / 100) %&gt;% 
  data.frame

S.all &lt;- sympdf %&gt;% select(6:ncol(sympdf)) %&gt;% na.omit(.) 

nwAll &lt;- bootnet::estimateNetwork(S.all, default=&quot;mgm&quot;)
## Estimating Network. Using package::function:
##   - mgm::mgm for network computation
##     - Using glmnet::glmnet
## &#39;type&#39; argument not assigned. Setting type to &#39;c&#39; for all binary variables and &#39;g&#39; for all other variables.
## &#39;lev&#39; argument not assigned. Setting lev to 1 for all Gaussian/Poisson variables and number of unique values for all categorical variables
## Warning in rep(1, n) * beta_vector: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in rep(1, n) * beta_vector: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in rep(1, n) * beta_vector: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.
## Warning in (function (data, type, lev, tuning = 0.5, missing =
## c(&quot;listwise&quot;, : Bootnet does not support unsigned edges and treats these as
## positive edges.

allmeans &lt;- sympdf %&gt;%  
  summarise_at(vars(6:16),
  funs(mean(., na.rm = TRUE))) %&gt;%  
  mutate_at(vars(PA, SB),
            funs(. / (24*60)))  # proportion of day used doing the behaviour


plot(nwAll, label.scale = FALSE, title = &quot;All&quot;, label.cex = 0.75, 
     pie = allmeans, 
     color = &quot;skyblue&quot;,
     pieBorder = 1)</code></pre>
<p><img src="baseline-networks_files/figure-html/unnamed-chunk-11-1.png" width="2100" /></p>
</div>
<div id="symptom-network-boys-and-girls" class="section level2">
<h2>Symptom network: boys and girls</h2>
<pre class="r"><code>
sympdf &lt;- df %&gt;% dplyr::select(id,
  intervention,
  group,
  school,
  girl,
  &quot;Neck and shoulder pain&quot; = symptom_neckShoulderPain_T1,
  &quot;Lower back pain&quot; = symptom_lowerBackPain_T1,
  &quot;Stomach ache&quot; = symptom_stomachAche_T1,
  &quot;Tension or nervousness&quot; = symptom_tensionNervousness_T1,
  &quot;Irritability or anger bursts&quot; = symptom_irritabilityAngerbursts_T1,
  &quot;Difficulty with sleep&quot; = symptom_sleepDifficulty_T1,
  &quot;Headache&quot; = symptom_headAche_T1,
  &quot;Tiredness or faintness&quot; = symptom_tirednessFaintness_T1,
  &quot;Fat pct&quot; = fatpct_T1,
  &quot;PA&quot; = paAccelerometer_T1,
  &quot;SB&quot; = sitLieAccelerometer_T1
) %&gt;% 
  mutate(
    &#39;Neck and shoulder pain&#39; = ifelse(`Neck and shoulder pain` == 1, 0, 1),
    &#39;Lower back pain&#39; = ifelse(`Lower back pain` == 1, 0, 1),
    &#39;Stomach ache&#39; = ifelse(`Stomach ache` == 1, 0, 1),
    &#39;Tension or nervousness&#39; = ifelse(`Tension or nervousness` == 1, 0, 1),
    &#39;Irritability or anger bursts&#39; = ifelse(`Irritability or anger bursts` == 1, 0, 1),
    &#39;Difficulty with sleep&#39; = ifelse(`Difficulty with sleep` == 1, 0, 1),
    &#39;Headache&#39; = ifelse(`Headache` == 1, 0, 1),
    &#39;Tiredness or faintness&#39; = ifelse(`Tiredness or faintness` == 1, 0, 1),
    &#39;Fat pct&#39; = `Fat pct` / 100) %&gt;% 
  data.frame

S.boys &lt;- sympdf %&gt;% filter(girl == 0) %&gt;% select(6:ncol(sympdf)) %&gt;% na.omit(.) 
S.girls &lt;- sympdf %&gt;% filter(girl == 1) %&gt;% select(6:ncol(sympdf)) %&gt;% na.omit(.)
nwBoys &lt;- bootnet::estimateNetwork(S.boys, default=&quot;mgm&quot;)
## Estimating Network. Using package::function:
##   - mgm::mgm for network computation
##     - Using glmnet::glmnet
## &#39;type&#39; argument not assigned. Setting type to &#39;c&#39; for all binary variables and &#39;g&#39; for all other variables.
## &#39;lev&#39; argument not assigned. Setting lev to 1 for all Gaussian/Poisson variables and number of unique values for all categorical variables
## Warning in rep(1, n) * beta_vector: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in rep(1, n) * beta_vector: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in rep(1, n) * beta_vector: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.
## Warning in (function (data, type, lev, tuning = 0.5, missing =
## c(&quot;listwise&quot;, : Bootnet does not support unsigned edges and treats these as
## positive edges.
nwGirls &lt;- bootnet::estimateNetwork(S.girls, default=&quot;mgm&quot;)
## Estimating Network. Using package::function:
##   - mgm::mgm for network computation
##     - Using glmnet::glmnet
## &#39;type&#39; argument not assigned. Setting type to &#39;c&#39; for all binary variables and &#39;g&#39; for all other variables.
## &#39;lev&#39; argument not assigned. Setting lev to 1 for all Gaussian/Poisson variables and number of unique values for all categorical variables
## Warning in rep(1, n) * beta_vector: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.
## Warning in rep(1, n) * beta_vector: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in rep(1, n) * beta_vector: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.
## Warning in (function (data, type, lev, tuning = 0.5, missing =
## c(&quot;listwise&quot;, : Bootnet does not support unsigned edges and treats these as
## positive edges.

girlmeans &lt;- sympdf %&gt;% group_by(girl) %&gt;% 
  summarise_at(vars(5:15),
  funs(mean(., na.rm = TRUE))) %&gt;% 
  filter(girl == 1) %&gt;% 
  mutate_at(vars(PA, SB),
            funs(. / (24*60))) %&gt;% # proportion of day used doing the behaviour
  select(-1)

boymeans &lt;- sympdf %&gt;% group_by(girl) %&gt;% 
  summarise_at(vars(5:15),
  funs(mean(., na.rm = TRUE))) %&gt;% 
  filter(girl == 0) %&gt;% 
  mutate_at(vars(PA, SB),
            funs(. / (24*60))) %&gt;% # proportion of day used doing the behaviour
  select(-1)


layout(t(1:2))
plot(nwGirls, label.scale = FALSE, title = &quot;Girls&quot;, label.cex = 0.75,
     pie = girlmeans, 
     color = &quot;skyblue&quot;,
     pieBorder = 1)

plot(nwBoys, label.scale = FALSE, title = &quot;Boys&quot;, label.cex = 0.75, 
     pie = boymeans, 
     color = &quot;skyblue&quot;,
     pieBorder = 1)</code></pre>
<p><img src="baseline-networks_files/figure-html/unnamed-chunk-12-1.png" width="2100" /></p>
</div>
<div id="symptom-network-educational-tracks" class="section level2">
<h2>symptom network: educational tracks</h2>
<pre class="r"><code>library(bootnet)
library(qgraph)
library(tidyverse)

sympdf &lt;- df %&gt;% dplyr::select(id,
  intervention,
  track,
  school,
  girl,
  &quot;Neck and shoulder pain&quot; = symptom_neckShoulderPain_T1,
  &quot;Lower back pain&quot; = symptom_lowerBackPain_T1,
  &quot;Stomach ache&quot; = symptom_stomachAche_T1,
  &quot;Tension or nervousness&quot; = symptom_tensionNervousness_T1,
  &quot;Irritability or anger bursts&quot; = symptom_irritabilityAngerbursts_T1,
  &quot;Difficulty with sleep&quot; = symptom_sleepDifficulty_T1,
  &quot;Headache&quot; = symptom_headAche_T1,
  &quot;Tiredness or faintness&quot; = symptom_tirednessFaintness_T1,
  &quot;Fat pct&quot; = fatpct_T1,
  &quot;PA&quot; = paAccelerometer_T1,
  &quot;SB&quot; = sitLieAccelerometer_T1
) %&gt;% 
  mutate(
    &#39;Neck and shoulder pain&#39; = ifelse(`Neck and shoulder pain` == 1, 0, 1),
    &#39;Lower back pain&#39; = ifelse(`Lower back pain` == 1, 0, 1),
    &#39;Stomach ache&#39; = ifelse(`Stomach ache` == 1, 0, 1),
    &#39;Tension or nervousness&#39; = ifelse(`Tension or nervousness` == 1, 0, 1),
    &#39;Irritability or anger bursts&#39; = ifelse(`Irritability or anger bursts` == 1, 0, 1),
    &#39;Difficulty with sleep&#39; = ifelse(`Difficulty with sleep` == 1, 0, 1),
    &#39;Headache&#39; = ifelse(`Headache` == 1, 0, 1),
    &#39;Tiredness or faintness&#39; = ifelse(`Tiredness or faintness` == 1, 0, 1),
    &#39;Fat pct&#39; = `Fat pct` / 100) %&gt;% 
  data.frame

# S.other &lt;- sympdf %&gt;% filter(track == &quot;Other&quot;) %&gt;% select(6:ncol(sympdf)) %&gt;% na.omit(.)
# S.it &lt;- sympdf %&gt;% filter(track == &quot;Business IT&quot;) %&gt;% select(6:ncol(sympdf))
# S.admin &lt;- sympdf %&gt;% filter(track == &quot;Business Admin&quot;) %&gt;% select(6:ncol(sympdf))
# S.hrc &lt;- sympdf %&gt;% filter(track == &quot;HRC&quot;) %&gt;% select(6:ncol(sympdf))
# S.nursing &lt;- sympdf %&gt;% filter(track == &quot;Nursing&quot;) %&gt;% select(6:ncol(sympdf))

# S.other &lt;- sympdf %&gt;% filter(track == 1) %&gt;% select(6:ncol(sympdf))
S.it &lt;- sympdf %&gt;% filter(track == 2) %&gt;% select(6:ncol(sympdf))
S.admin &lt;- sympdf %&gt;% filter(track == 3) %&gt;% select(6:ncol(sympdf))
S.hrc &lt;- sympdf %&gt;% filter(track == 4) %&gt;% select(6:ncol(sympdf))
S.nursing &lt;- sympdf %&gt;% filter(track == 5) %&gt;% select(6:ncol(sympdf))

# nwOther &lt;- bootnet::estimateNetwork(S.other, default=&quot;mgm&quot;)
nwIt &lt;- bootnet::estimateNetwork(S.it, default=&quot;mgm&quot;)
## Estimating Network. Using package::function:
##   - mgm::mgm for network computation
##     - Using glmnet::glmnet
## &#39;type&#39; argument not assigned. Setting type to &#39;c&#39; for all binary variables and &#39;g&#39; for all other variables.
## &#39;lev&#39; argument not assigned. Setting lev to 1 for all Gaussian/Poisson variables and number of unique values for all categorical variables
## Warning in max(weights): no non-missing arguments to max; returning -Inf
## Error in mgm(structure(logical(0), .Dim = c(0L, 11L), .Dimnames = list(: Only integer and numeric values permitted.
nwAdmin &lt;- bootnet::estimateNetwork(S.admin, default=&quot;mgm&quot;)
## Estimating Network. Using package::function:
##   - mgm::mgm for network computation
##     - Using glmnet::glmnet
## &#39;type&#39; argument not assigned. Setting type to &#39;c&#39; for all binary variables and &#39;g&#39; for all other variables.
## &#39;lev&#39; argument not assigned. Setting lev to 1 for all Gaussian/Poisson variables and number of unique values for all categorical variables
## Warning in max(weights): no non-missing arguments to max; returning -Inf
## Error in mgm(structure(logical(0), .Dim = c(0L, 11L), .Dimnames = list(: Only integer and numeric values permitted.
nwHrc &lt;- bootnet::estimateNetwork(S.hrc, default=&quot;mgm&quot;)
## Estimating Network. Using package::function:
##   - mgm::mgm for network computation
##     - Using glmnet::glmnet
## &#39;type&#39; argument not assigned. Setting type to &#39;c&#39; for all binary variables and &#39;g&#39; for all other variables.
## &#39;lev&#39; argument not assigned. Setting lev to 1 for all Gaussian/Poisson variables and number of unique values for all categorical variables
## Warning in max(weights): no non-missing arguments to max; returning -Inf
## Error in mgm(structure(logical(0), .Dim = c(0L, 11L), .Dimnames = list(: Only integer and numeric values permitted.
nwNursing &lt;- bootnet::estimateNetwork(S.nursing, default=&quot;mgm&quot;)
## Estimating Network. Using package::function:
##   - mgm::mgm for network computation
##     - Using glmnet::glmnet
## &#39;type&#39; argument not assigned. Setting type to &#39;c&#39; for all binary variables and &#39;g&#39; for all other variables.
## &#39;lev&#39; argument not assigned. Setting lev to 1 for all Gaussian/Poisson variables and number of unique values for all categorical variables
## Warning in max(weights): no non-missing arguments to max; returning -Inf
## Error in mgm(structure(logical(0), .Dim = c(0L, 11L), .Dimnames = list(: Only integer and numeric values permitted.

# othermeans &lt;- sympdf %&gt;% group_by(track) %&gt;% 
#   summarise_at(vars(5:15),
#   funs(mean(., na.rm = TRUE))) %&gt;% 
#   filter(track == &quot;Other&quot;) %&gt;% 
#   mutate_at(vars(PA, SB),
#             funs(. / (24*60))) %&gt;% # proportion of day used doing the behaviour
#   select(-1)

# itmeans &lt;- sympdf %&gt;% group_by(track) %&gt;% 
#   summarise_at(vars(5:15),
#   funs(mean(., na.rm = TRUE))) %&gt;% 
#   filter(track == &quot;Business IT&quot;) %&gt;% 
#   mutate_at(vars(PA, SB),
#             funs(. / (24*60))) %&gt;% # proportion of day used doing the behaviour
#   select(-1)

itmeans &lt;- sympdf %&gt;% group_by(track) %&gt;% 
  summarise_at(vars(5:15),
  funs(mean(., na.rm = TRUE))) %&gt;% 
  filter(track == 2) %&gt;% 
  mutate_at(vars(PA, SB),
            funs(. / (24*60))) %&gt;% # proportion of day used doing the behaviour
  select(-1)

# adminmeans &lt;- sympdf %&gt;% group_by(track) %&gt;% 
#   summarise_at(vars(5:15),
#   funs(mean(., na.rm = TRUE))) %&gt;% 
#   filter(track == &quot;Business Admin&quot;) %&gt;% 
#   mutate_at(vars(PA, SB),
#             funs(. / (24*60))) %&gt;% # proportion of day used doing the behaviour
#   select(-1)

adminmeans &lt;- sympdf %&gt;% group_by(track) %&gt;% 
  summarise_at(vars(5:15),
  funs(mean(., na.rm = TRUE))) %&gt;% 
  filter(track == 3) %&gt;% 
  mutate_at(vars(PA, SB),
            funs(. / (24*60))) %&gt;% # proportion of day used doing the behaviour
  select(-1)

# hrcmeans &lt;- sympdf %&gt;% group_by(track) %&gt;% 
#   summarise_at(vars(5:15),
#   funs(mean(., na.rm = TRUE))) %&gt;% 
#   filter(track == &quot;HRC&quot;) %&gt;% 
#   mutate_at(vars(PA, SB),
#             funs(. / (24*60))) %&gt;% # proportion of day used doing the behaviour
#   select(-1)

hrcmeans &lt;- sympdf %&gt;% group_by(track) %&gt;% 
  summarise_at(vars(5:15),
  funs(mean(., na.rm = TRUE))) %&gt;% 
  filter(track == 4) %&gt;% 
  mutate_at(vars(PA, SB),
            funs(. / (24*60))) %&gt;% # proportion of day used doing the behaviour
  select(-1)

# nursingmeans &lt;- sympdf %&gt;% group_by(track) %&gt;% 
#   summarise_at(vars(5:15),
#   funs(mean(., na.rm = TRUE))) %&gt;% 
#   filter(track == &quot;Nursing&quot;) %&gt;% 
#   mutate_at(vars(PA, SB),
#             funs(. / (24*60))) %&gt;% # proportion of day used doing the behaviour
#   select(-1)

nursingmeans &lt;- sympdf %&gt;% group_by(track) %&gt;% 
  summarise_at(vars(5:15),
  funs(mean(., na.rm = TRUE))) %&gt;% 
  filter(track == 5) %&gt;% 
  mutate_at(vars(PA, SB),
            funs(. / (24*60))) %&gt;% # proportion of day used doing the behaviour
  select(-1)

averagelayout &lt;- averageLayout(nwIt, nwAdmin, nwHrc, nwNursing)
## Error in averageWmat(...): object &#39;nwIt&#39; not found
# plot(nwOther, label.scale = FALSE, title = &quot;Girls&quot;, label.cex = 0.75,
#      pie = othermeans, 
#      color = &quot;skyblue&quot;,
#      pieBorder = 1)

layout(t(1:4))
plot(nwIt, label.scale = FALSE, title = &quot;Business IT&quot;, layout = averagelayout, label.cex = 0.75, 
     pie = itmeans, 
     color = &quot;skyblue&quot;,
     pieBorder = 1)
## Error in plot(nwIt, label.scale = FALSE, title = &quot;Business IT&quot;, layout = averagelayout, : object &#39;nwIt&#39; not found

plot(nwAdmin, label.scale = FALSE, title = &quot;Business admin&quot;, layout = averagelayout, label.cex = 0.75, 
     pie = adminmeans, 
     color = &quot;skyblue&quot;,
     pieBorder = 1)
## Error in plot(nwAdmin, label.scale = FALSE, title = &quot;Business admin&quot;, : object &#39;nwAdmin&#39; not found

plot(nwHrc, label.scale = FALSE, title = &quot;Hotel, restaurant and catering&quot;, layout = averagelayout, label.cex = 0.75, 
     pie = hrcmeans, 
     color = &quot;skyblue&quot;,
     pieBorder = 1)
## Error in plot(nwHrc, label.scale = FALSE, title = &quot;Hotel, restaurant and catering&quot;, : object &#39;nwHrc&#39; not found

plot(nwNursing, label.scale = FALSE, title = &quot;Nursing&quot;, layout = averagelayout, label.cex = 0.75, 
     pie = nursingmeans, 
     color = &quot;skyblue&quot;,
     pieBorder = 1)
## Error in plot(nwNursing, label.scale = FALSE, title = &quot;Nursing&quot;, layout = averagelayout, : object &#39;nwNursing&#39; not found</code></pre>
<pre class="r"><code>
colfill &lt;- c(1,2,3,4,5)

# Create data frame
densplot &lt;- d
levels(densplot$intervention) &lt;- list(&quot;Intervention&quot; = &quot;1&quot;, &quot;Control&quot; = &quot;0&quot;)
levels(densplot$girl) &lt;- list(&quot;Girl&quot; = &quot;1&quot;, &quot;Boy&quot; = &quot;0&quot;)

# This gives side-by-side plots
layout(t(1:2), 1)

# Intervention vs. control
# Choose only the variables needed and drop NA
dens &lt;- densplot %&gt;% select(fatpct_T1, intervention) %&gt;% 
  filter(complete.cases(.))

# Set random number generator for reproducibility of bootstrap test of equal densities
set.seed(10)

# Make plot
sm.fatpct_T1_1 &lt;- sm.density.compare2(as.numeric(dens$fatpct_T1), as.factor(dens$intervention), xlab=&quot;Percentage&quot;, col=colfill, lty=c(1,2), bandcol=&#39;LightGray&#39;, model=&quot;equal&quot;, lwd=(c(2,2)))
## 
## Test of equal densities:  p-value =  0.23
legend(&quot;topright&quot;, levels(dens$intervention), fill=c(1, 2))

# Girls vs. boys
# Choose only the variables needed and drop NA
dens &lt;- densplot %&gt;% select(fatpct_T1, girl) %&gt;% 
  filter(complete.cases(.))

# Set random number generator for reproducibility of bootstrap test of equal densities
set.seed(10)

# Make plot
sm.fatpct_T1_2 &lt;- sm.density.compare2(as.numeric(dens$fatpct_T1), as.factor(dens$girl), xlab=&quot;Percentage&quot;, col=colfill, lty=c(1,2), bandcol=&#39;LightGray&#39;, model=&quot;equal&quot;, lwd=(c(2,2)))
## 
## Test of equal densities:  p-value =  0
legend(&quot;topright&quot;, levels(dens$girl), fill=c(1, 2))</code></pre>
<p><img src="baseline-networks_files/figure-html/unnamed-chunk-14-1.png" width="2100" /></p>
<pre class="r"><code>
sm.fatpct_T1_2 &lt;- sm.density.compare2(as.numeric(dens$fatpct_T1), as.factor(dens$girl), xlab=&quot;Percentage&quot;, col=colfill, lty=c(1,2), bandcol=&#39;LightGray&#39;, model=&quot;equal&quot;, lwd=(c(2,2)))
## 
## Test of equal densities:  p-value =  0
legend(&quot;topright&quot;, levels(dens$girl), fill=c(1, 2))</code></pre>
<p><img src="baseline-networks_files/figure-html/unnamed-chunk-14-2.png" width="2100" /></p>
</div>
</div>
<div id="physical-activity-network" class="section level1">
<h1>Physical activity network</h1>
<pre class="r"><code>
data &lt;- df %&gt;% select(PA = paAccelerometer_T1, actCop = actcop_T1, BCT = frqbct_T1, amot = amotivation_T1, auton = autonomous_T1, cont = controlled_T1, dnorm = dnorm_T1, fatpct = fatpct_T1, inorm = inorm_T1, intent = intention_T1, oexp = oexp_T1, opp = opportunities_T1, sePbc = sePbc_T1) %&gt;% data.frame() 
## Error in overscope_eval_next(overscope, expr): object &#39;actcop_T1&#39; not found

# Spinglass algorithm detects communities. Tutorial here: http://psych-networks.com/r-tutorial-identify-communities-items-networks/

qgraph(cor_auto(data), layout=&quot;spring&quot;)
## Warning in is.na(x): is.na() applied to non-(list or vector) of type
## &#39;symbol&#39;
## Warning in is.na(x): is.na() applied to non-(list or vector) of type
## &#39;language&#39;
## Error in data[, sapply(data, function(x) mean(is.na(x))) != 1]: object of type &#39;closure&#39; is not subsettable

cormatrix &lt;- cor_auto(data1)
## Error in as.data.frame(data): object &#39;data1&#39; not found

graph1 &lt;- qgraph(cormatrix, graph=&quot;glasso&quot;, layout=&quot;spring&quot;, sampleSize = nrow(data),
              vsize=7, cut=0, maximum=.45, border.width=1.5)
## Error in qgraph(cormatrix, graph = &quot;glasso&quot;, layout = &quot;spring&quot;, sampleSize = nrow(data), : object &#39;cormatrix&#39; not found

g = as.igraph(graph1, attributes=TRUE)
## Error in as.igraph(graph1, attributes = TRUE): object &#39;graph1&#39; not found

sgc &lt;- spinglass.community(g)
## Error in &quot;igraph&quot; %in% class(graph): object &#39;g&#39; not found

sgc$membership
## Error in eval(expr, envir, enclos): object &#39;sgc&#39; not found

group.spinglass&lt;- list(c(1, 2, 3, 5, 10), 
                       c(4, 6, 8), 
                       c(7, 9), 
                       c(11, 12, 13))

set.seed(2)

network1 &lt;- bootnet::estimateNetwork(data1, default=&quot;EBICglasso&quot;)
## Error in is.data.frame(data): object &#39;data1&#39; not found

#bladibla &lt;- averageLayout(network1$graph, network2$graph)

# layout(t(1:2))
# graph1 &lt;- plot(network1, layout=bladibla, cut=0)
# graph2 &lt;- plot(network2, layout=bladibla, cut=0)
# graph1 &lt;- plot(network1, cut=0)
# graph2 &lt;- plot(network2, cut=0)

plot(network1, layout = &quot;spring&quot;, labels = TRUE, groups = group.spinglass, color=c(&quot;olivedrab2&quot;, &quot;orange&quot;, &quot;mediumpurple1&quot;, &quot;lightblue&quot;))
## Error in plot(network1, layout = &quot;spring&quot;, labels = TRUE, groups = group.spinglass, : object &#39;network1&#39; not found</code></pre>
<div id="pa-network-without-sdt-motivations" class="section level3">
<h3>PA network without SDT motivations</h3>
<pre class="r"><code># Network without motivation variables
data &lt;- df %&gt;% select(PA = paAccelerometer_T1, actCop = PA_actcop_T1, BCT = PA_frqbct_T1, amot = PA_amotivation_T1, auton = PA_autonomous_T1, cont = PA_controlled_T1, dnorm = PA_dnorm_T1, fatpct = fatpct_T1, inorm = PA_inorm_T1, intent = PA_intention_T1, oexp = PA_oexp_T1, opp = PA_opportunities_T1, sePbc = PA_sePbc_T1) %&gt;% data.frame() %&gt;% 
  select(-auton, -cont, -amot)
## Error in overscope_eval_next(overscope, expr): object &#39;PA_actcop_T1&#39; not found

# Spinglass algorithm detects communities. Tutorial here: http://psych-networks.com/r-tutorial-identify-communities-items-networks/

cormatrix &lt;- cor_auto(data)
## Warning in is.na(x): is.na() applied to non-(list or vector) of type
## &#39;symbol&#39;
## Warning in is.na(x): is.na() applied to non-(list or vector) of type
## &#39;language&#39;
## Error in data[, sapply(data, function(x) mean(is.na(x))) != 1]: object of type &#39;closure&#39; is not subsettable

graph1&lt;-qgraph(cormatrix, graph=&quot;glasso&quot;, layout=&quot;spring&quot;, sampleSize = nrow(data),
              vsize=7, cut=0, maximum=.45, border.width=1.5)
## Error in qgraph(cormatrix, graph = &quot;glasso&quot;, layout = &quot;spring&quot;, sampleSize = nrow(data), : object &#39;cormatrix&#39; not found

g = as.igraph(graph1, attributes=TRUE)
## Error in as.igraph(graph1, attributes = TRUE): object &#39;graph1&#39; not found

sgc &lt;- spinglass.community(g)
## Error in &quot;igraph&quot; %in% class(graph): object &#39;g&#39; not found

sgc$membership
## Error in eval(expr, envir, enclos): object &#39;sgc&#39; not found

# Without SDT motivations
group.spinglass&lt;- list(c(1, 2, 3, 7), 
                       c(4, 6), 
                       c(5), 
                       c(8, 9, 10))

set.seed(2)

network1 &lt;- bootnet::estimateNetwork(data, default=&quot;EBICglasso&quot;)
## Error in bootnet::estimateNetwork(data, default = &quot;EBICglasso&quot;): &#39;data&#39; argument must be a data frame

plot(network1, layout = &quot;spring&quot;, labels = TRUE, groups = group.spinglass, color=c(&quot;olivedrab2&quot;, &quot;orange&quot;, &quot;mediumpurple1&quot;, &quot;lightblue&quot;))
## Error in plot(network1, layout = &quot;spring&quot;, labels = TRUE, groups = group.spinglass, : object &#39;network1&#39; not found</code></pre>
</div>
<div id="pa-network-without-bcts-and-sdt" class="section level3">
<h3>PA network without BCTs and SDT</h3>
<pre class="r"><code># Network without motivation variables
data &lt;- df %&gt;% select(PA = paAccelerometer_T1, &#39;action and coping planning&#39; = PA_actcop_T1, &#39;Frequency-related BCTs&#39; = PA_frqbct_T1, &#39;amotivation&#39; = PA_amotivation_T1, &#39;autonomous motivation&#39; = PA_autonomous_T1, &#39;controlled motivation&#39; = PA_controlled_T1, &#39;descriptive norm&#39; = PA_dnorm_T1, &#39;injunctive norm&#39; = PA_inorm_T1, &quot;fat pct&quot; = fatpct_T1, &#39;intention&#39; = PA_intention_T1, &#39;outcome expectations&#39; = PA_oexp_T1, &#39;Self-efficacy / PBC&#39; = PA_sePbc_T1, &#39;perceived opportunities&#39; = PA_opportunities_T1) %&gt;% 
            select(-`autonomous motivation`, -`controlled motivation`, -`amotivation`, -`Frequency-related BCTs`) %&gt;% 
  data.frame
## Error in overscope_eval_next(overscope, expr): object &#39;PA_actcop_T1&#39; not found

# Spinglass algorithm detects communities. Tutorial here: http://psych-networks.com/r-tutorial-identify-communities-items-networks/

cormatrix &lt;- cor_auto(data)
## Warning in is.na(x): is.na() applied to non-(list or vector) of type
## &#39;symbol&#39;
## Warning in is.na(x): is.na() applied to non-(list or vector) of type
## &#39;language&#39;
## Error in data[, sapply(data, function(x) mean(is.na(x))) != 1]: object of type &#39;closure&#39; is not subsettable

graph1 &lt;- qgraph(cormatrix, graph=&quot;glasso&quot;, layout=&quot;spring&quot;, sampleSize = nrow(data),
              vsize=7, cut=0, maximum=.45, border.width=1.5)
## Error in qgraph(cormatrix, graph = &quot;glasso&quot;, layout = &quot;spring&quot;, sampleSize = nrow(data), : object &#39;cormatrix&#39; not found

g = as.igraph(graph1, attributes=TRUE)
## Error in as.igraph(graph1, attributes = TRUE): object &#39;graph1&#39; not found

set.seed(4)

sgc &lt;- spinglass.community(g)
## Error in &quot;igraph&quot; %in% class(graph): object &#39;g&#39; not found

sgc$membership
## Error in eval(expr, envir, enclos): object &#39;sgc&#39; not found

# Without SDT motivations

group.spinglass&lt;- list(c(1, 2, 6), 
                       c(3, 4), 
                       c(5),
                       c(7, 8, 9))

network1 &lt;- bootnet::estimateNetwork(data, default=&quot;EBICglasso&quot;)
## Error in bootnet::estimateNetwork(data, default = &quot;EBICglasso&quot;): &#39;data&#39; argument must be a data frame

piefill &lt;- data %&gt;%
  summarise_all(funs(mean(., na.rm = TRUE))) %&gt;% 
  mutate_at(vars(PA),
            funs(. / (24*60))) %&gt;% # proportion of day used doing the behaviour
  mutate_at(vars(action.and.coping.planning),
            funs(. / 4)) %&gt;% 
  mutate_at(vars(3, 4, 6, 7, 8, 9),
            funs(. / 7)) %&gt;% 
  mutate_at(vars(5),
            funs(. / 100))  
## Error in UseMethod(&quot;tbl_vars&quot;): no applicable method for &#39;tbl_vars&#39; applied to an object of class &quot;function&quot;

plot(network1, layout = &quot;spring&quot;, labels = TRUE, groups = group.spinglass, color=c(&quot;olivedrab2&quot;, &quot;orange&quot;, &quot;mediumpurple1&quot;, &quot;lightblue&quot;),
     label.cex = 0.75,
     label.scale = FALSE,
     pie = piefill, 
     color = &quot;skyblue&quot;,
     pieBorder = 1)
## Error in plot(network1, layout = &quot;spring&quot;, labels = TRUE, groups = group.spinglass, : object &#39;network1&#39; not found


plot(nwBoys, label.scale = FALSE, title = &quot;Boys&quot;, label.cex = 0.75, 
     pie = boymeans, 
     color = &quot;skyblue&quot;,
     pieBorder = 1)</code></pre>
<p><img src="baseline-networks_files/figure-html/unnamed-chunk-17-1.png" width="2100" /></p>
</div>
<div id="pa-network-without-bcts-and-sdt-intention-pa-fat" class="section level3">
<h3>PA network without BCTs and SDT, intention, PA, fat%</h3>
<pre class="r"><code># Network without motivation variables
data &lt;- df %&gt;% select(PA = paAccelerometer_T1, &#39;action and coping planning&#39; = PA_actcop_T1, &#39;Frequency-related BCTs&#39; = PA_frqbct_T1, &#39;amotivation&#39; = PA_amotivation_T1, &#39;autonomous motivation&#39; = PA_autonomous_T1, &#39;controlled motivation&#39; = PA_controlled_T1, &#39;descriptive norm&#39; = PA_dnorm_T1, &#39;injunctive norm&#39; = PA_inorm_T1, &quot;fat pct&quot; = fatpct_T1, &#39;intention&#39; = PA_intention_T1, &#39;outcome expectations&#39; = PA_oexp_T1, &#39;Self-efficacy / PBC&#39; = PA_sePbc_T1, &#39;perceived opportunities&#39; = PA_opportunities_T1) %&gt;% 
            select(-`autonomous motivation`, -`controlled motivation`, -`amotivation`, -`Frequency-related BCTs`, -PA, -`intention`, -`fat pct`) %&gt;% 
  data.frame
## Error in overscope_eval_next(overscope, expr): object &#39;PA_actcop_T1&#39; not found

# Spinglass algorithm detects communities. Tutorial here: http://psych-networks.com/r-tutorial-identify-communities-items-networks/

cormatrix &lt;- cor_auto(data)
## Warning in is.na(x): is.na() applied to non-(list or vector) of type
## &#39;symbol&#39;
## Warning in is.na(x): is.na() applied to non-(list or vector) of type
## &#39;language&#39;
## Error in data[, sapply(data, function(x) mean(is.na(x))) != 1]: object of type &#39;closure&#39; is not subsettable

graph1 &lt;- qgraph(cormatrix, graph=&quot;glasso&quot;, layout=&quot;spring&quot;, sampleSize = nrow(data),
              vsize=7, cut=0, maximum=.45, border.width=1.5)
## Error in qgraph(cormatrix, graph = &quot;glasso&quot;, layout = &quot;spring&quot;, sampleSize = nrow(data), : object &#39;cormatrix&#39; not found

g = as.igraph(graph1, attributes=TRUE)
## Error in as.igraph(graph1, attributes = TRUE): object &#39;graph1&#39; not found

set.seed(1)

sgc &lt;- spinglass.community(g)
## Error in &quot;igraph&quot; %in% class(graph): object &#39;g&#39; not found

sgc$membership
## Error in eval(expr, envir, enclos): object &#39;sgc&#39; not found

group.spinglass&lt;- list(c(1, 4:6), 
                       c(2, 3))

# Estimate and plot graph


network1 &lt;- bootnet::estimateNetwork(data, default=&quot;EBICglasso&quot;)
## Error in bootnet::estimateNetwork(data, default = &quot;EBICglasso&quot;): &#39;data&#39; argument must be a data frame

piefill &lt;- data %&gt;%
  summarise_all(funs(mean(., na.rm = TRUE))) %&gt;%
  mutate_at(vars(action.and.coping.planning),
            funs(. / 4)) %&gt;% 
  mutate_at(vars(2:6),
            funs(. / 7))
## Error in UseMethod(&quot;tbl_vars&quot;): no applicable method for &#39;tbl_vars&#39; applied to an object of class &quot;function&quot;

plot(network1, layout = &quot;spring&quot;, labels = TRUE, groups = group.spinglass, color=c(&quot;olivedrab2&quot;, &quot;orange&quot;, &quot;mediumpurple1&quot;, &quot;lightblue&quot;),
     label.cex = 0.75,
     label.scale = FALSE,
     pie = piefill, 
     color = &quot;skyblue&quot;,
     pieBorder = 1)
## Error in plot(network1, layout = &quot;spring&quot;, labels = TRUE, groups = group.spinglass, : object &#39;network1&#39; not found</code></pre>
</div>
<div id="robustness-test" class="section level2">
<h2>Robustness test</h2>
<pre class="r"><code>
Network1 &lt;- bootnet::estimateNetwork(data1, default = &quot;EBICglasso&quot;)
## Error in is.data.frame(data): object &#39;data1&#39; not found
plot(Network1, layout = &quot;spring&quot;, labels = TRUE)
## Error in plot(Network1, layout = &quot;spring&quot;, labels = TRUE): object &#39;Network1&#39; not found

qgraph::centralityPlot(Network1)
## Note: z-scores are shown on x-axis rather than raw centrality indices.
## Error in getWmat(list(...)): object &#39;Network1&#39; not found

boot1 &lt;- bootnet::bootnet(Network1, nBoots = 2500, nCores = 2)
## Error in is(data, &quot;bootnetResult&quot;): object &#39;Network1&#39; not found

plot(boot1, labels = TRUE, order = &quot;sample&quot;)
## Error in plot(boot1, labels = TRUE, order = &quot;sample&quot;): object &#39;boot1&#39; not found

Network2 &lt;- bootnet::estimateNetwork(data1, default = &quot;pcor&quot;)
## Error in is.data.frame(data): object &#39;data1&#39; not found
plot(Network2, layout = &quot;spring&quot;, labels = TRUE)
## Error in plot(Network2, layout = &quot;spring&quot;, labels = TRUE): object &#39;Network2&#39; not found

boot2 &lt;- bootnet::bootnet(Network2, nBoots = 2500, nCores = 2)
## Error in is(data, &quot;bootnetResult&quot;): object &#39;Network2&#39; not found

qgraph::centralityPlot(Network)
## Note: z-scores are shown on x-axis rather than raw centrality indices.
## Error in getWmat(list(...)): object &#39;Network&#39; not found
qgraph::centralityPlot(Network2)
## Note: z-scores are shown on x-axis rather than raw centrality indices.
## Error in getWmat(list(...)): object &#39;Network2&#39; not found</code></pre>
</div>
<div id="centrality-stability-1" class="section level2">
<h2>Centrality stability</h2>
<pre class="r"><code>boot2 &lt;- bootnet::bootnet(Network1, nBoots = 2500, type = &quot;case&quot;, nCores = 2)
## Error in is(data, &quot;bootnetResult&quot;): object &#39;Network1&#39; not found
bootnet::corStability(boot2)
## Error in x$type %in% c(&quot;node&quot;, &quot;person&quot;): object &#39;boot2&#39; not found

plot(boot2)
## Error in plot(boot2): object &#39;boot2&#39; not found

differenceTest(boot1, &quot;auton&quot;, &quot;intent&quot;,  measure = c(&quot;strength&quot;, &quot;closeness&quot;, &quot;betweenness&quot;))
## Error in bootobject$type %in% c(&quot;nonparametric&quot;, &quot;parametric&quot;): object &#39;boot1&#39; not found

plot(boot1, &quot;edge&quot;, plot = &quot;difference&quot;, onlyNonZero = TRUE, order = &quot;sample&quot;)
## Error in plot(boot1, &quot;edge&quot;, plot = &quot;difference&quot;, onlyNonZero = TRUE, : object &#39;boot1&#39; not found

plot(boot1, &quot;strength&quot;)
## Error in plot(boot1, &quot;strength&quot;): object &#39;boot1&#39; not found
plot(boot1, &quot;betweenness&quot;)
## Error in plot(boot1, &quot;betweenness&quot;): object &#39;boot1&#39; not found
plot(boot1, &quot;closeness&quot;)
## Error in plot(boot1, &quot;closeness&quot;): object &#39;boot1&#39; not found</code></pre>
</div>
<div id="network-comparison-test-girls-and-boys" class="section level2">
<h2>Network comparison test: girls and boys</h2>
<pre class="r"><code>
# here goes your data; call it &quot;data&quot;
data &lt;- df %&gt;% select(paT1, girl, actcop_T1, frqbct_T1, amotivation_T1, autonomous_T1, controlled_T1, dnorm_T1, fatpct_T1, inorm_T1, intention_T1, oexp_T1, opportunities_T1, sePbc_T1) 
## Error in overscope_eval_next(overscope, expr): object &#39;paT1&#39; not found

### Split data into girls and boys
data1 &lt;- data %&gt;% filter(girl == 1) %&gt;% select(-girl) %&gt;% as.data.frame
## Error in UseMethod(&quot;filter_&quot;): no applicable method for &#39;filter_&#39; applied to an object of class &quot;function&quot;

data2 &lt;- data %&gt;% filter(girl == 0) %&gt;% select(-girl) %&gt;% as.data.frame
## Error in UseMethod(&quot;filter_&quot;): no applicable method for &#39;filter_&#39; applied to an object of class &quot;function&quot;

# ---------------------------------------------------------------------------------------
# ---------- 3. NCT ------------------------------------------------------------------
# ---------------------------------------------------------------------------------------


### estimate networks and compare visually; use averageLayout function, then plot via layout(t(1:2))
network1 &lt;- bootnet::estimateNetwork(data1, default=&quot;EBICglasso&quot;)
## Error in is.data.frame(data): object &#39;data1&#39; not found
network2 &lt;- bootnet::estimateNetwork(data2, default=&quot;EBICglasso&quot;)
## Error in is.data.frame(data): object &#39;data2&#39; not found

bladibla &lt;- averageLayout(network1$graph, network2$graph)
## Error in averageWmat(...): object &#39;network1&#39; not found

layout(t(1:2))
graph1 &lt;- plot(network1, layout=bladibla, cut=0)
## Error in plot(network1, layout = bladibla, cut = 0): object &#39;network1&#39; not found
graph2 &lt;- plot(network2, layout=bladibla, cut=0)
## Error in plot(network2, layout = bladibla, cut = 0): object &#39;network2&#39; not found

### run NCT 

nct_results &lt;- NetworkComparisonTest::NCT(data1, data2, it=1000, binary.data=FALSE, paired=TRUE, test.edges=TRUE, edges=&#39;all&#39;, progressbar=TRUE)
## Error in is(data1, &quot;bootnetResult&quot;): object &#39;data1&#39; not found

nct_results$nwinv.pval  # p value of network structure diff test
## Error in eval(expr, envir, enclos): object &#39;nct_results&#39; not found
nct_results$glstrinv.pval  # p value of global connectivity diff test
## Error in eval(expr, envir, enclos): object &#39;nct_results&#39; not found
nct_results$einv.pvals     #p values testing diffs for all individual edges
## Error in eval(expr, envir, enclos): object &#39;nct_results&#39; not found
sum(nct_results$einv.pvals$&quot;p-value&quot; &lt; 0.05)  # how many edges are different
## Error in eval(expr, envir, enclos): object &#39;nct_results&#39; not found</code></pre>
</div>
<div id="robustness-test-1" class="section level2">
<h2>Robustness test</h2>
<pre class="r"><code>data &lt;- data %&gt;% select(BCT = agrbct_T1,
    AUT = autonomous_T1,
    Intn = intention_T1,
    PBC = pbc_T1,
    OExp = oexp_T1,
    DNorm = norm_T1)
## Error in UseMethod(&quot;select_&quot;): no applicable method for &#39;select_&#39; applied to an object of class &quot;function&quot;

Network &lt;- bootnet::estimateNetwork(data, default = &quot;EBICglasso&quot;)
## Error in bootnet::estimateNetwork(data, default = &quot;EBICglasso&quot;): &#39;data&#39; argument must be a data frame

boot1 &lt;- bootnet::bootnet(Network, nBoots = 2500, nCores = 2)
## Error in is(data, &quot;bootnetResult&quot;): object &#39;Network&#39; not found

plot(boot1, labels = TRUE, order = &quot;sample&quot;)
## Error in plot(boot1, labels = TRUE, order = &quot;sample&quot;): object &#39;boot1&#39; not found

plot(Network, layout = &quot;spring&quot;, labels = TRUE)
## Error in plot(Network, layout = &quot;spring&quot;, labels = TRUE): object &#39;Network&#39; not found

Network2 &lt;- bootnet::estimateNetwork(data, default = &quot;pcor&quot;)
## Error in bootnet::estimateNetwork(data, default = &quot;pcor&quot;): &#39;data&#39; argument must be a data frame
plot(Network2, layout = &quot;spring&quot;, labels = TRUE)
## Error in plot(Network2, layout = &quot;spring&quot;, labels = TRUE): object &#39;Network2&#39; not found

boot1 &lt;- bootnet::bootnet(Network2, nBoots = 2500, nCores = 2)
## Error in is(data, &quot;bootnetResult&quot;): object &#39;Network2&#39; not found

qgraph::centralityPlot(Network)
## Note: z-scores are shown on x-axis rather than raw centrality indices.
## Error in getWmat(list(...)): object &#39;Network&#39; not found
qgraph::centralityPlot(Network2)
## Note: z-scores are shown on x-axis rather than raw centrality indices.
## Error in getWmat(list(...)): object &#39;Network2&#39; not found</code></pre>
</div>
</div>
<div id="centrality-stability-2" class="section level1">
<h1>Centrality stability</h1>
<pre class="r"><code>boot2 &lt;- bootnet::bootnet(Network, nBoots = 2500, type = &quot;case&quot;, nCores = 2)
## Error in is(data, &quot;bootnetResult&quot;): object &#39;Network&#39; not found
bootnet::corStability(boot2)
## Error in x$type %in% c(&quot;node&quot;, &quot;person&quot;): object &#39;boot2&#39; not found

plot(boot2)
## Error in plot(boot2): object &#39;boot2&#39; not found

differenceTest(boot1, &quot;AUT&quot;, &quot;Intn&quot;,  measure = c(&quot;strength&quot;, &quot;closeness&quot;, &quot;betweenness&quot;))
## Error in bootobject$type %in% c(&quot;nonparametric&quot;, &quot;parametric&quot;): object &#39;boot1&#39; not found

plot(boot1, &quot;edge&quot;, plot = &quot;difference&quot;, onlyNonZero = TRUE, order = &quot;sample&quot;)
## Error in plot(boot1, &quot;edge&quot;, plot = &quot;difference&quot;, onlyNonZero = TRUE, : object &#39;boot1&#39; not found

plot(boot1, &quot;strength&quot;)
## Error in plot(boot1, &quot;strength&quot;): object &#39;boot1&#39; not found
plot(boot1, &quot;betweenness&quot;)
## Error in plot(boot1, &quot;betweenness&quot;): object &#39;boot1&#39; not found
plot(boot1, &quot;closeness&quot;)
## Error in plot(boot1, &quot;closeness&quot;): object &#39;boot1&#39; not found</code></pre>
</div>
<div id="pa-motivation-examined" class="section level1">
<h1>PA motivation examined</h1>
<pre class="r"><code>nItems &lt;- 18
regulations.df &lt;- lmi %&gt;% select(id = ID,
  intervention = ryhmä,
  group = ryhmäkoodi_korjattu,
  school = Aineisto.1,
  girl = Kys0013.1,
  PA_amotivation_02_T1 = Kys0086.1,
  PA_amotivation_01_T1 = Kys0082.1,
  PA_amotivation_03_T1 = Kys0096.1,
  PA_amotivation_04_T1 = Kys0097.1,
  PA_extrinsic_01_T1 = Kys0080.1,
  PA_extrinsic_02_T1 = Kys0081.1,
  PA_extrinsic_03_T1 = Kys0083.1,
  PA_introjected_01_T1 = Kys0084.1,
  PA_introjected_02_T1 = Kys0085.1,
  PA_identified_01_T1 = Kys0087.1,
  PA_identified_02_T1 = Kys0088.1,
  PA_identified_03_T1 = Kys0090.1,
  PA_integrated_01_T1 = Kys0089.1,
  PA_integrated_02_T1 = Kys0092.1,
  PA_integrated_03_T1 = Kys0094.1,
  PA_intrinsic_01_T1 = Kys0091.1,
  PA_intrinsic_02_T1 = Kys0093.1,
  PA_intrinsic_03_T1 = Kys0095.1
)
## Error in overscope_eval_next(overscope, expr): object &#39;ryhmä&#39; not found

regulations.df &lt;- regulations.df %&gt;% dplyr::mutate(group = ifelse(group == &quot;&quot;, NA, group))
## Error in eval(lhs, parent, parent): object &#39;regulations.df&#39; not found

# Fix intervention and gender variables
regulations.df &lt;- regulations.df %&gt;% dplyr::mutate(intervention = ifelse(intervention == 1, 1, 0),
                         intervention = factor(intervention),
            girl = ifelse(girl == 2, 1, 0),
            girl = factor(girl, levels = c(&quot;1&quot;, &quot;0&quot;)),
            school = factor(school, levels = c(&quot;1&quot;, &quot;2&quot;, &quot;3&quot;, &quot;4&quot;, &quot;5&quot;)))
## Error in eval(lhs, parent, parent): object &#39;regulations.df&#39; not found


motiGirls &lt;- regulations.df %&gt;% dplyr::select(id,
  intervention,
  group,
  school,
  girl,
  PA_amotivation_02_T1,
  PA_amotivation_01_T1,
  PA_amotivation_03_T1,
  PA_amotivation_04_T1,
  PA_extrinsic_01_T1,
  PA_extrinsic_02_T1,
  PA_extrinsic_03_T1,
  PA_introjected_01_T1,
  PA_introjected_02_T1,
  PA_identified_01_T1,
  PA_identified_02_T1,
  PA_identified_03_T1,
  PA_integrated_01_T1,
  PA_integrated_02_T1,
  PA_integrated_03_T1,
  PA_intrinsic_01_T1,
  PA_intrinsic_02_T1,
  PA_intrinsic_03_T1) %&gt;%
 tidyr::gather(key = Variable, value = Value, 6:ncol(.)) %&gt;%
  filter(girl == &quot;1&quot;) %&gt;% 
 ggplot(aes(x = Value, y = Variable, group = Variable)) +
  ggridges::geom_density_ridges2(aes(fill = Variable), stat = &quot;binline&quot;, binwidth = 1, scale = 0.95) +
  scale_x_continuous(breaks = c(1:6), expand = c(0, 0),
                     name = &quot;&quot;) +
  scale_y_discrete(expand = c(0.01, 0), name = &quot;&quot;, labels = NULL) +
  ggridges::scale_fill_cyclical(values = c(&quot;darkolivegreen2&quot;, &quot;darkolivegreen4&quot;)) +
  labs(title = &quot;Girls&quot;) +
  guides(y = &quot;none&quot;) +
  ggridges::theme_ridges(grid = FALSE) +
  theme(axis.title.x = element_text(hjust = 0.5),
        axis.title.y = element_text(hjust = 0.5),
        plot.title = element_text(hjust = 0.5),
        axis.text=element_text(size=10)) +
coord_cartesian(xlim = c(0.5, 5.5))
## Error in eval(lhs, parent, parent): object &#39;regulations.df&#39; not found

motiBoys &lt;- regulations.df %&gt;% dplyr::select(id,
  intervention,
  group,
  school,
  girl,
  PA_amotivation_02_T1,
  PA_amotivation_01_T1,
  PA_amotivation_03_T1,
  PA_amotivation_04_T1,
  PA_extrinsic_01_T1,
  PA_extrinsic_02_T1,
  PA_extrinsic_03_T1,
  PA_introjected_01_T1,
  PA_introjected_02_T1,
  PA_identified_01_T1,
  PA_identified_02_T1,
  PA_identified_03_T1,
  PA_integrated_01_T1,
  PA_integrated_02_T1,
  PA_integrated_03_T1,
  PA_intrinsic_01_T1,
  PA_intrinsic_02_T1,
  PA_intrinsic_03_T1) %&gt;%
 tidyr::gather(key = Variable, value = Value, 6:ncol(.)) %&gt;%
  filter(girl == &quot;0&quot;) %&gt;% 
 ggplot(aes(x = Value, y = Variable, group = Variable)) +
  ggridges::geom_density_ridges2(aes(fill = Variable), stat = &quot;binline&quot;, binwidth = 1, scale = 0.95) +
  scale_x_continuous(breaks = c(1:6), expand = c(0, 0),
                     name = &quot;&quot;) +
  scale_y_discrete(expand = c(0.01, 0), name = &quot;&quot;, labels = NULL) +
  ggridges::scale_fill_cyclical(values = c(&quot;darkolivegreen2&quot;, &quot;darkolivegreen4&quot;)) +
  labs(title = &quot;Boys&quot;) +
  guides(y = &quot;none&quot;) +
  ggridges::theme_ridges(grid = FALSE) +
  theme(axis.title.x = element_text(hjust = 0.5),
        axis.title.y = element_text(hjust = 0.5),
        plot.title = element_text(hjust = 0.5),
        axis.text=element_text(size=10)) +
coord_cartesian(xlim = c(0.5, 5.5))
## Error in eval(lhs, parent, parent): object &#39;regulations.df&#39; not found

motiInt &lt;- regulations.df %&gt;% dplyr::select(id,
  intervention,
  group,
  school,
  girl,
  PA_amotivation_02_T1,
  PA_amotivation_01_T1,
  PA_amotivation_03_T1,
  PA_amotivation_04_T1,
  PA_extrinsic_01_T1,
  PA_extrinsic_02_T1,
  PA_extrinsic_03_T1,
  PA_introjected_01_T1,
  PA_introjected_02_T1,
  PA_identified_01_T1,
  PA_identified_02_T1,
  PA_identified_03_T1,
  PA_integrated_01_T1,
  PA_integrated_02_T1,
  PA_integrated_03_T1,
  PA_intrinsic_01_T1,
  PA_intrinsic_02_T1,
  PA_intrinsic_03_T1) %&gt;%
 tidyr::gather(key = Variable, value = Value, 6:ncol(.)) %&gt;%
  filter(intervention == &quot;1&quot;) %&gt;% 
 ggplot(aes(x = Value, y = Variable, group = Variable)) +
  ggridges::geom_density_ridges2(aes(fill = Variable), stat = &quot;binline&quot;, binwidth = 1, scale = 0.95) +
  scale_x_continuous(breaks = c(1:6), expand = c(0, 0),
                     name = &quot;&quot;) +
  scale_y_discrete(expand = c(0.01, 0), name = &quot;&quot;) +
  ggridges::scale_fill_cyclical(values = c(&quot;deepskyblue&quot;, &quot;deepskyblue4&quot;)) +
  labs(title = &quot;Intervention&quot;) +
  guides(y = &quot;none&quot;) +
  ggridges::theme_ridges(grid = FALSE) +
  theme(axis.title.x = element_text(hjust = 0.5),
        axis.title.y = element_text(hjust = 0.5),
        axis.text=element_text(size=10)) +
coord_cartesian(xlim = c(0.5, 5.5))
## Error in eval(lhs, parent, parent): object &#39;regulations.df&#39; not found

motiCont &lt;- regulations.df %&gt;% dplyr::select(id,
  intervention,
  group,
  school,
  girl,
  PA_amotivation_02_T1,
  PA_amotivation_01_T1,
  PA_amotivation_03_T1,
  PA_amotivation_04_T1,
  PA_extrinsic_01_T1,
  PA_extrinsic_02_T1,
  PA_extrinsic_03_T1,
  PA_introjected_01_T1,
  PA_introjected_02_T1,
  PA_identified_01_T1,
  PA_identified_02_T1,
  PA_identified_03_T1,
  PA_integrated_01_T1,
  PA_integrated_02_T1,
  PA_integrated_03_T1,
  PA_intrinsic_01_T1,
  PA_intrinsic_02_T1,
  PA_intrinsic_03_T1) %&gt;%
 tidyr::gather(key = Variable, value = Value, 6:ncol(.)) %&gt;%
  filter(intervention == &quot;0&quot;) %&gt;% 
 ggplot(aes(x = Value, y = Variable, group = Variable)) +
  ggridges::geom_density_ridges2(aes(fill = Variable), stat = &quot;binline&quot;, binwidth = 1, scale = 0.95) +
  scale_x_continuous(breaks = c(1:6), expand = c(0, 0),
                     name = &quot;&quot;) +
  scale_y_discrete(expand = c(0.01, 0), name = &quot;&quot;, labels = NULL) +
  ggridges::scale_fill_cyclical(values = c(&quot;deepskyblue&quot;, &quot;deepskyblue4&quot;)) +
  labs(title = &quot;Control&quot;) +
  guides(y = &quot;none&quot;) +
  ggridges::theme_ridges(grid = FALSE) +
  theme(axis.title.x = element_text(hjust = 0.5),
        axis.title.y = element_text(hjust = 0.5),
        axis.text=element_text(size=10)) +
coord_cartesian(xlim = c(0.5, 5.5))
## Error in eval(lhs, parent, parent): object &#39;regulations.df&#39; not found

#grid.arrange(motiInt, motiGirls, motiCont, motiBoys, ncol = 2)

# (&quot;Seldom or never&quot;, &quot;About once a month&quot;, &quot;About once a week&quot;, &quot;Almost daily&quot;)

# This draws all histograms next to each other:
grid::grid.newpage()
grid::grid.draw(cbind(ggplotGrob(motiInt), ggplotGrob(motiCont), ggplotGrob(motiGirls), ggplotGrob(motiBoys), size = &quot;last&quot;))
## Error in plot_clone(plot): object &#39;motiInt&#39; not found</code></pre>
<div id="motivational-regulations-network" class="section level2">
<h2>Motivational regulations network</h2>
</div>
<div id="tee-tanne-piefill-tummempi-sama-vari-tai-opacity" class="section level2">
<h2>TEE TÄNNE PIEFILL; tummempi sama väri tai opacity?</h2>
<pre class="r"><code># Was going to do fused graphical lasso, but the items not normal...

# s1 &lt;- regulations.df %&gt;% filter(school == 1) %&gt;% select(6:ncol(regulations.df)) # %&gt;% na.omit(.) 
# s2 &lt;- regulations.df %&gt;% filter(school == 2) %&gt;% select(6:ncol(regulations.df)) # %&gt;% na.omit(.)
# s3 &lt;- regulations.df %&gt;% filter(school == 3) %&gt;% select(6:ncol(regulations.df)) # %&gt;% na.omit(.) 
# s4 &lt;- regulations.df %&gt;% filter(school == 4) %&gt;% select(6:ncol(regulations.df)) # %&gt;% na.omit(.)
# s5 &lt;- regulations.df %&gt;% filter(school == 5) %&gt;% select(6:ncol(regulations.df)) # %&gt;% na.omit(.)
# 
# network2 &lt;- EstimateGroupNetwork(list(&quot;1&quot; = s1,
#                                       &quot;2&quot; = s2,
#                                       &quot;3&quot; = s3,
#                                       &quot;4&quot; = s4,
#                                       &quot;5&quot; = s5),
#                                  n = c(nrow(s1), nrow(s2), nrow(s3), nrow(s4), nrow(s5)))
# 
regulations.df &lt;- regulations.df %&gt;% mutate(
PA_amotivation_02_T1 = ifelse(PA_amotivation_02_T1 == 1, 0, 1),
PA_amotivation_01_T1 = ifelse(PA_amotivation_01_T1 == 1, 0, 1),
PA_amotivation_03_T1 = ifelse(PA_amotivation_03_T1 == 1, 0, 1),
PA_amotivation_04_T1 = ifelse(PA_amotivation_04_T1 == 1, 0, 1),
PA_extrinsic_01_T1 = ifelse(PA_extrinsic_01_T1 == 1, 0, 1),
PA_extrinsic_02_T1 = ifelse(PA_extrinsic_02_T1 == 1, 0, 1),
PA_extrinsic_03_T1 = ifelse(PA_extrinsic_03_T1 == 1, 0, 1),
PA_introjected_01_T1 = ifelse(PA_introjected_01_T1 == 1, 0, 1),
PA_introjected_02_T1 = ifelse(PA_introjected_02_T1 == 1, 0, 1),
PA_identified_01_T1 = ifelse(PA_identified_01_T1 == 1, 0, 1),
PA_identified_02_T1 = ifelse(PA_identified_02_T1 == 1, 0, 1),
PA_identified_03_T1 = ifelse(PA_identified_03_T1 == 1, 0, 1),
PA_integrated_01_T1 = ifelse(PA_integrated_01_T1 == 1, 0, 1),
PA_integrated_02_T1 = ifelse(PA_integrated_02_T1 == 1, 0, 1),
PA_integrated_03_T1 = ifelse(PA_integrated_03_T1 == 1, 0, 1),
PA_intrinsic_01_T1 = ifelse(PA_intrinsic_01_T1 == 1, 0, 1),
PA_intrinsic_02_T1 = ifelse(PA_intrinsic_02_T1 == 1, 0, 1),
PA_intrinsic_03_T1 = ifelse(PA_intrinsic_03_T1 == 1, 0, 1))
## Error in eval(lhs, parent, parent): object &#39;regulations.df&#39; not found


### GIRLS AND BOYS

S.boys &lt;- regulations.df %&gt;% filter(girl == 0) %&gt;% select(6:ncol(regulations.df)) # %&gt;% na.omit(.) 
## Error in eval(lhs, parent, parent): object &#39;regulations.df&#39; not found
S.girls &lt;- regulations.df %&gt;% filter(girl == 1) %&gt;% select(6:ncol(regulations.df)) # %&gt;% na.omit(.)
## Error in eval(lhs, parent, parent): object &#39;regulations.df&#39; not found
nwBoys &lt;- bootnet::estimateNetwork(S.boys, default=&quot;IsingFit&quot;)
## Estimating Network. Using package::function:
##   - IsingFit::IsingFit for network computation
##     - Using glmnet::glmnet
## Warning in bootnet::binarize(data, split = split, verbose = verbose):
## Splitting data by median
## Error in y %*% rep(1, nc): non-conformable arguments
nwGirls &lt;- bootnet::estimateNetwork(S.girls, default=&quot;IsingFit&quot;)
## Estimating Network. Using package::function:
##   - IsingFit::IsingFit for network computation
##     - Using glmnet::glmnet
## Warning in bootnet::binarize(data, split = split, verbose = verbose):
## Splitting data by median
## 
  |                                                                       
  |                                                                 |   0%
  |                                                                       
  |======                                                           |   9%
  |                                                                       
  |============                                                     |  18%
  |                                                                       
  |==================                                               |  27%
  |                                                                       
  |========================                                         |  36%
  |                                                                       
  |==============================                                   |  45%
  |                                                                       
  |===================================                              |  55%
  |                                                                       
  |=========================================                        |  64%
  |                                                                       
  |===============================================                  |  73%
  |                                                                       
  |=====================================================            |  82%
  |                                                                       
  |===========================================================      |  91%
  |                                                                       
  |=================================================================| 100%

data1 &lt;- regulations.df %&gt;% select(6:ncol(regulations.df))
## Error in eval(lhs, parent, parent): object &#39;regulations.df&#39; not found
names(data1) &lt;- c(paste0(rep(&quot;Amoti&quot;, 4), 1:4),
                paste0(rep(&quot;Extri&quot;, 3), 1:3),
                paste0(rep(&quot;Intro&quot;, 2), 1:2),
                paste0(rep(&quot;Ident&quot;, 3), 1:3),
                paste0(rep(&quot;Integ&quot;, 3), 1:3),
                paste0(rep(&quot;Intri&quot;, 3), 1:3))
## Error in names(data1) &lt;- c(paste0(rep(&quot;Amoti&quot;, 4), 1:4), paste0(rep(&quot;Extri&quot;, : object &#39;data1&#39; not found
nwAll &lt;- bootnet::estimateNetwork(data1, default=&quot;IsingFit&quot;)
## Error in is.data.frame(data): object &#39;data1&#39; not found

# Create means for filling nodes
girlmeans &lt;- regulations.df %&gt;% group_by(girl) %&gt;% 
  summarise_at(vars(5:(5+nItems-1)),
  funs(mean(., na.rm = TRUE))) %&gt;% 
  filter(girl == 1) %&gt;% 
  select(-1)
## Error in eval(lhs, parent, parent): object &#39;regulations.df&#39; not found

boymeans &lt;- regulations.df %&gt;% group_by(girl) %&gt;% 
  summarise_at(vars(5:(5+nItems-1)),
  funs(mean(., na.rm = TRUE))) %&gt;% 
  filter(girl == 0) %&gt;% 
  select(-1)
## Error in eval(lhs, parent, parent): object &#39;regulations.df&#39; not found

# Find average layout for comparability and plot graphs next to each other

Layout &lt;- averageLayout(nwGirls, nwBoys)


layout(t(1:2))
plot(nwGirls, layout = Layout, label.scale = FALSE, title = &quot;Girls&quot;, label.cex = 0.75,
     pie = girlmeans, 
     color = &quot;skyblue&quot;,
     pieBorder = 1)

plot(nwBoys, layout = Layout, label.scale = FALSE, title = &quot;Boys&quot;, label.cex = 0.75, 
     pie = boymeans, 
     color = &quot;skyblue&quot;,
     pieBorder = 1)</code></pre>
<p><img src="baseline-networks_files/figure-html/unnamed-chunk-25-1.png" width="2100" /></p>
<pre class="r"><code>
itemNames &lt;- c(&#39;I can\&#39;t see why I should bother exercising&#39;,
  &#39;I do not see why I should have to exercise&#39;,
  &#39; I do not see the point in exercising&#39;,
  &#39; I think exercising is a waste of time&#39;,
  &#39; I exercise because other people say I should&#39;,
  &#39; I exercise because others will not be pleased with me if I do not&#39;,
  &#39; I feel under pressure from my friends/family to exercise&#39;,
  &#39; I feel guilty when I do not exercise&#39;,
  &#39; I feel like a failure when I have not exercised in a while&#39;,
  &#39; I think it is important to make the effort to exercise regularly&#39;,
  &#39; I value the benefits of exercise&#39;,
  &#39; it is important to me to exercise regularly&#39;,
  &#39; I exercise because it is consistent with my life goals.&#39;,
  &#39; I consider exercise consistent with my values.&#39;,
  &#39; I consider exercise a fundamental part of who I am.&#39;,
  &#39; I get pleasure and satisfaction from participating in exercise&#39;,
  &#39; I exercise because it is fun&#39;,
  &#39; I enjoy my exercise sessions&#39;)

itemGroups &lt;- c(rep(&quot;Amotivation&quot;, 4),
                rep(&quot;Extrinsic&quot;, 3),
                rep(&quot;Introjected&quot;, 2),
                rep(&quot;Identified&quot;, 3),
                rep(&quot;Integrated&quot;, 3),
                rep(&quot;Intrinsic&quot;, 3))


plot(nwAll, groups = itemGroups, nodeNames = itemNames, legend.cex = 0.25)
## Warning in lcolor[is.na(lcolor)] &lt;- ifelse(vertex.colors == &quot;background&quot;, :
## number of items to replace is not a multiple of replacement length
## Error in layout[groups[[g]], 1]: subscript out of bounds</code></pre>
</div>
<div id="community-detection" class="section level2">
<h2>Community detection</h2>
<pre class="r"><code>
# Find communities
graph1 &lt;- plot(nwBCT)</code></pre>
<p><img src="baseline-networks_files/figure-html/unnamed-chunk-26-1.png" width="2100" /></p>
<pre class="r"><code> 
g = as.igraph(graph1, attributes=TRUE)
 
matrix_spinglass &lt;- matrix(NA, nrow=1,ncol=1000)

set.seed(1)
for (i in 1:100) {
set.seed(i)
spinglass &lt;- spinglass.community(g)
matrix_spinglass[1,i] &lt;- max(spinglass$membership) 
} # 1000 took 8 minutes
 
mean(as.vector(matrix_spinglass)) 
## [1] NA
max(as.vector(matrix_spinglass)) 
## [1] NA
min(as.vector(matrix_spinglass)) 
## [1] NA
median(as.vector(matrix_spinglass)) 
## [1] NA

set.seed(1)
spinglass &lt;- spinglass.community(g)
spinglass$membership
##  [1] 1 3 1 1 1 1 1 1 2 2 2 2 3 3 3 3 3 3 3
spinglassGroups &lt;- list(rep(2, 6), rep(1, 4), rep(3, 9))</code></pre>
<!-- Of all the iterations of the spinglass algorithm, ` sum(table(matrix_spinglass)[1]) / 100`% gave `names(table(matrix_spinglass)[1])` groups, ` sum(table(matrix_spinglass)[2]) / 100`% gave `names(table(matrix_spinglass)[2])` groups, and ` sum(table(matrix_spinglass)[3]) / 100`% gave ` names(table(matrix_spinglass)[1])` groups,  -->
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
